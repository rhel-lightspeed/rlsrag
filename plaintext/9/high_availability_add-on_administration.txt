a b s t r a c t   h i g h   a v a i l a b i l i t y   a d d - o n   a d m i n i s t r a t i o n   s a m p l e   c l u s t e r   c o n f i g u r a t i o n s   u t i l i z e   h i g h   a v a i l a b i l i t y   a d d - o n   r e d   e n t e r p r i s e   l i n u x   7  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   1 .   c r e a t i n g   r e d   h i g h - a v a i l a b i l i t y   c l u s t e r   p a c e m a k e r   c h a p t e r   d e s c r i b e s   p r o c e d u r e   c r e a t i n g   r e d   h i g h   a v a i l a b i l i t y   t w o - n o d e   c l u s t e r   p c s   .   c r e a t e d   c l u s t e r  ,   c o n f i g u r e   r e s o u r c e s   r e s o u r c e   g r o u p s   r e q u i r e   .   c o n f i g u r i n g   c l u s t e r   p r o v i d e d   c h a p t e r   r e q u i r e s   s y s t e m   i n c l u d e   c o m p o n e n t s  :   2   n o d e s  ,   c r e a t e   c l u s t e r   .  ,   n o d e s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   .   n e t w o r k   s w i t c h e s   p r i v a t e   n e t w o r k  ,   r e q u i r e d   c o m m u n i c a t i o n   c l u s t e r   n o d e s   c l u s t e r   h a r d w a r e   n e t w o r k   p o w e r   s w i t c h e s   f i b r e   c h a n n e l   s w i t c h e s   .   p o w e r   f e n c i n g   d e v i c e   n o d e   c l u s t e r   .   p o r t s   a p c   p o w e r   s w i t c h   h o s t   z a p c . e x a m p l e . c o m   .   c h a p t e r   d i v i d e d   s e c t i o n s   .   s e c t i o n   1 . 1  ,   “   c l u s t e r   s o f t w a r e   i n s t a l l a t i o n   ”   p r o c e d u r e   i n s t a l l i n g   c l u s t e r   s o f t w a r e   .   s e c t i o n   1 . 2  ,   “   c l u s t e r   c r e a t i o n   ”   p r o c e d u r e   c o n f i g u r i n g   t w o - n o d e   c l u s t e r   .   s e c t i o n   1 . 3  ,   “   f e n c i n g   c o n f i g u r a t i o n   ”   p r o c e d u r e   c o n f i g u r i n g   f e n c i n g   d e v i c e s   n o d e   c l u s t e r  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 1 .   c l u s t e r   s o f t w a r e   i n s t a l l a t i o n   p r o c e d u r e   i n s t a l l i n g   c o n f i g u r i n g   c l u s t e r   .   n o d e   c l u s t e r  ,   i n s t a l l   r e d   h i g h   a v a i l a b i l i t y   a d d - o n   s o f t w a r e   p a c k a g e s   a v a i l a b l e   f e n c e   a g e n t s   h i g h   a v a i l a b i l i t y   c h a n n e l   .   #  y u m   i n s t a l l   p c s   p a c e m a k e r   f e n c e - a g e n t s - a l l   r u n n i n g   f i r e w a l l d   d a e m o n  ,   e x e c u t e   c o m m a n d s   e n a b l e   p o r t s   r e q u i r e d   r e d   h i g h   a v a i l a b i l i t y   a d d - o n   .   n o t e   #  f i r e w a l l - c m d   - -   p e r m a n e n t   - -   a d d - s e r v i c e = h i g h - a v a i l a b i l i t y   #  f i r e w a l l - c m d   - -   a d d - s e r v i c e = h i g h - a v a i l a b i l i t y   o r d e r   p c s   c o n f i g u r e   c l u s t e r   c o m m u n i c a t e   n o d e s  ,   s e t   p a s s w o r d   n o d e   u s e r   i d   h a c l u s t e r  ,   p c s   a d m i n i s t r a t i o n   a c c o u n t   .   r e c o m m e n d e d   p a s s w o r d   u s e r   h a c l u s t e r   n o d e   .   #  p a s s w d   h a c l u s t e r   c h a n g i n g   p a s s w o r d   u s e r   h a c l u s t e r   .   p a s s w o r d  :   r e t y p e   p a s s w o r d  :   p a s s w d  :   a u t h e n t i c a t i o n   t o k e n s   u p d a t e d   s u c c e s s f u l l y   .   c l u s t e r   c o n f i g u r e d  ,   p c s d   d a e m o n   s t a r t e d   e n a b l e d   b o o t   s t a r t u p   n o d e   .   d a e m o n   w o r k s   p c s   c o m m a n d   m a n a g e   c o n f i g u r a t i o n   n o d e s   c l u s t e r   .   n o d e   c l u s t e r  ,   e x e c u t e   c o m m a n d s   s t a r t   p c s d   s e r v i c e   e n a b l e   p c s d   s y s t e m   s t a r t   .   #  s y s t e m c t l   s t a r t   p c s d . s e r v i c e   #  s y s t e m c t l   e n a b l e   p c s d . s e r v i c e   a u t h e n t i c a t e   p c s   u s e r   h a c l u s t e r   n o d e   c l u s t e r   n o d e   r u n n i n g   p c s   .   c o m m a n d   a u t h e n t i c a t e s   u s e r   h a c l u s t e r   z 1 . e x a m p l e . c o m   n o d e s   t w o - n o d e   c l u s t e r  ,   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   .   [  r o o t   @   z 1   ~  ]   #  p c s   c l u s t e r   a u t h   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   u s e r n a m e  :   h a c l u s t e r   p a s s w o r d  :   z 1 . e x a m p l e . c o m  :   a u t h o r i z e d   z 2 . e x a m p l e . c o m  :   a u t h o r i z e d
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 2 .   c l u s t e r   c r e a t i o n   p r o c e d u r e   c r e a t e s   r e d   h i g h   a v a i l a b i l i t y   a d d - o n   c l u s t e r   c o n s i s t s   n o d e s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   .   e x e c u t e   c o m m a n d   z 1 . e x a m p l e . c o m   c r e a t e   t w o - n o d e   c l u s t e r   m y _ c l u s t e r   c o n s i s t s   n o d e s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   .   p r o p a g a t e   c l u s t e r   c o n f i g u r a t i o n   f i l e s   n o d e s   c l u s t e r   .   c o m m a n d   i n c l u d e s   - -   s t a r t   o p t i o n  ,   s t a r t   c l u s t e r   s e r v i c e s   n o d e s   c l u s t e r   .   [  r o o t   @   z 1   ~  ]   #  p c s   c l u s t e r   s e t u p   - -   s t a r t   - -   m y _ c l u s t e r   \   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   z 1 . e x a m p l e . c o m  :   s u c c e e d e d   z 1 . e x a m p l e . c o m  :   s t a r t i n g   c l u s t e r   . . .   z 2 . e x a m p l e . c o m  :   s u c c e e d e d   z 2 . e x a m p l e . c o m  :   s t a r t i n g   c l u s t e r   . . .   e n a b l e   c l u s t e r   s e r v i c e s   r u n   n o d e   c l u s t e r   n o d e   b o o t e d   .   n o t e   [  r o o t   @   z 1   ~  ]   #  p c s   c l u s t e r   e n a b l e   - -   d i s p l a y   c u r r e n t   s t a t u s   c l u s t e r   p c s   c l u s t e r   s t a t u s   c o m m a n d   .   s l i g h t   d e l a y   c l u s t e r   r u n n i n g   s t a r t   c l u s t e r   s e r v i c e s   - -   s t a r t   o p t i o n   p c s   c l u s t e r   s e t u p   c o m m a n d  ,   e n s u r e   c l u s t e r   r u n n i n g   p e r f o r m i n g   s u b s e q u e n t   a c t i o n s   c l u s t e r   c o n f i g u r a t i o n   .   [  r o o t   @   z 1   ~  ]   #  p c s   c l u s t e r   s t a t u s   c l u s t e r   s t a t u s  :   u p d a t e d  :   t h u   j u l   2 5   1 3: 0 1: 2 6   2 0 1 3   c h a n g e  :   t h u   j u l   2 5   1 3: 0 4: 4 5   2 0 1 3   c r m d   z 2 . e x a m p l e . c o m   s t a c k  :   c o r o s y n c   c u r r e n t   d c  :   z 2 . e x a m p l e . c o m   (  2  )   -   p a r t i t i o n   q u o r u m   v e r s i o n  :   1 . 1 . 1 0 - 5 . e l 7 - 9 a b e 6 8 7   2   n o d e s   c o n f i g u r e d   0   r e s o u r c e s   c o n f i g u r e d
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 3 .   f e n c i n g   c o n f i g u r a t i o n   c o n f i g u r e   f e n c i n g   d e v i c e   n o d e   c l u s t e r   .   i n f o r m a t i o n   f e n c e   c o n f i g u r a t i o n   c o m m a n d s   o p t i o n s  ,   r e d   e n t e r p r i s e   l i n u x   7   h i g h   a v a i l a b i l i t y   a d d - o n   r e f e r e n c e   .   g e n e r a l   i n f o r m a t i o n   f e n c i n g   i m p o r t a n c e   r e d   h i g h   a v a i l a b i l i t y   c l u s t e r  ,   f e n c i n g   r e d   h i g h   a v a i l a b i l i t y   c l u s t e r   .   n o t e   a p c   p o w e r   s w i t c h   h o s t   z a p c . e x a m p l e . c o m   f e n c e   n o d e s  ,   f e n c e _ a p c _ s n m p   f e n c i n g   a g e n t   .   n o d e s   f e n c e d   f e n c i n g   a g e n t  ,   c o n f i g u r e   f e n c i n g   d e v i c e s   s i n g l e   r e s o u r c e  ,   p c m k _ h o s t _ m a p   p c m k _ h o s t _ l i s t   o p t i o n s   .   c r e a t e   f e n c i n g   d e v i c e   c o n f i g u r i n g   d e v i c e   s t o n i t h   r e s o u r c e   p c s   s t o n i t h   c r e a t e   c o m m a n d   .   c o m m a n d   c o n f i g u r e s   s t o n i t h   r e s o u r c e   n a m e d   m y a p c   f e n c e _ a p c _ s n m p   f e n c i n g   a g e n t   n o d e s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   .   p c m k _ h o s t _ m a p   o p t i o n   m a p s   z 1 . e x a m p l e . c o m   p o r t   1  ,   z 2 . e x a m p l e . c o m   p o r t   2 .   l o g i n   v a l u e   p a s s w o r d   a p c   d e v i c e   a p c   .   d e f a u l t  ,   d e v i c e   m o n i t o r   i n t e r v a l   s i x t y   s e c o n d s   n o d e   .   n o t e   i p   a d d r e s s   s p e c i f y i n g   h o s t   n o d e s   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t o n i t h   c r e a t e   m y a p c   f e n c e _ a p c _ s n m p   \   i p a d d r =  ' '   z a p c . e x a m p l e . c o m  ' '   p c m k _ h o s t _ m a p =  ' '   z 1 . e x a m p l e . c o m: 1  ;   z 2 . e x a m p l e . c o m: 2  ' '   \   p c m k _ h o s t _ c h e c k =  ' '   s t a t i c - l i s t  ' '   p c m k _ h o s t _ l i s t =  ' '   z 1 . e x a m p l e . c o m  ,   z 2 . e x a m p l e . c o m  ' '   \   l o g i n =  ' '   a p c  ' '   p a s s w d =  ' '   a p c  ' '   n o t e   c o m m a n d   d i s p l a y s   p a r a m e t e r s   e x i s t i n g   s t o n i t h   d e v i c e   .   [  r o o t   @   r h 7 - 1   ~  ]   #  p c s   s t o n i t h   s h o w   m y a p c   r e s o u r c e  :   m y a p c   (  c l a s s = s t o n i t h   t y p e = f e n c e _ a p c _ s n m p  )   a t t r i b u t e s  :   i p a d d r = z a p c . e x a m p l e . c o m   p c m k _ h o s t _ m a p = z 1 . e x a m p l e . c o m: 1  ;   z 2 . e x a m p l e . c o m: 2   p c m k _ h o s t _ c h e c k = s t a t i c - l i s t   p c m k _ h o s t _ l i s t = z 1 . e x a m p l e . c o m  ,   z 2 . e x a m p l e . c o m   l o g i n = a p c   p a s s w d = a p c   o p e r a t i o n s  :   m o n i t o r   i n t e r v a l = 6 0 s   (  m y a p c - m o n i t o r - i n t e r v a l - 6 0 s  )   c o n f i g u r i n g   f e n c e   d e v i c e  ,   t e s t   d e v i c e   .   i n f o r m a t i o n   t e s t i n g   f e n c e   d e v i c e  ,   f e n c i n g  :   c o n f i g u r i n g   s t o n i t h   h i g h   a v a i l a b i l i t y   a d d - o n   r e f e r e n c e   .   n o t e   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   2 .   a c t i v e / p a s s i v e   a p a c h e   h t t p   s e r v e r   r e d   h i g h   a v a i l a b i l i t y   c l u s t e r   c h a p t e r   d e s c r i b e s   c o n f i g u r e   a c t i v e / p a s s i v e   a p a c h e   h t t p   s e r v e r   t w o - n o d e   r e d   e n t e r p r i s e   l i n u x   h i g h   a v a i l a b i l i t y   a d d - o n   c l u s t e r   p c s   c o n f i g u r e   c l u s t e r   r e s o u r c e s   .   c a s e  ,   c l i e n t s   a c c e s s   a p a c h e   h t t p   s e r v e r   f l o a t i n g   i p   a d d r e s s   .   w e b   s e r v e r   r u n s   n o d e s   c l u s t e r   .   n o d e   w e b   s e r v e r   r u n n i n g   i n o p e r a t i v e  ,   w e b   s e r v e r   s t a r t s   n o d e   c l u s t e r   m i n i m a l   s e r v i c e   i n t e r r u p t i o n   .   f i g u r e   2 . 1  ,   “   a p a c h e   r e d   h i g h   a v a i l a b i l i t y   t w o - n o d e   c l u s t e r   ”   s h o w s   h i g h - l e v e l   o v e r v i e w   c l u s t e r   .   c l u s t e r   t w o - n o d e   r e d   h i g h   a v a i l a b i l i t y   c l u s t e r   c o n f i g u r e d   n e t w o r k   p o w e r   s w i t c h   s h a r e d   s t o r a g e   .   c l u s t e r   n o d e s   c o n n e c t e d   p u b l i c   n e t w o r k  ,   c l i e n t   a c c e s s   a p a c h e   h t t p   s e r v e r   v i r t u a l   i p   .   a p a c h e   s e r v e r   r u n s   n o d e   1   n o d e   2  ,   a c c e s s   s t o r a g e   a p a c h e   d a t a   .   f i g u r e   2 . 1 .   a p a c h e   r e d   h i g h   a v a i l a b i l i t y   t w o - n o d e   c l u s t e r   c a s e   r e q u i r e s   s y s t e m   i n c l u d e   c o m p o n e n t s  :   t w o - n o d e   r e d   h i g h   a v a i l a b i l i t y   c l u s t e r   p o w e r   f e n c i n g   c o n f i g u r e d   n o d e   .   p r o c e d u r e   c l u s t e r   p r o v i d e d   c h a p t e r   1  ,   c r e a t i n g   r e d   h i g h - a v a i l a b i l i t y   c l u s t e r   p a c e m a k e r   .   p u b l i c   v i r t u a l   i p   a d d r e s s  ,   r e q u i r e d   a p a c h e   .   s h a r e d   s t o r a g e   n o d e s   c l u s t e r  ,   i s c s i  ,   f i b r e   c h a n n e l  ,   s h a r e d   n e t w o r k   b l o c k   d e v i c e   .   c l u s t e r   c o n f i g u r e d   a p a c h e   r e s o u r c e   g r o u p  ,   c o n t a i n s   c l u s t e r   c o m p o n e n t s   w e b   s e r v e r   r e q u i r e s  :   l v m   r e s o u r c e  ,   f i l e   s y s t e m   r e s o u r c e  ,   i p   a d d r e s s   r e s o u r c e  ,   w e b   s e r v e r   r e s o u r c e   .   r e s o u r c e   g r o u p   f a i l   n o d e   c l u s t e r  ,   a l l o w i n g   n o d e   r u n   w e b   s e r v e r   .   c r e a t i n g   r e s o u r c e   g r o u p   c l u s t e r  ,   p e r f o r m   p r o c e d u r e s  :   c o n f i g u r e   e x t 4   f i l e   s y s t e m   m o u n t e d   l o g i c a l   v o l u m e   m y _ l v  ,   d e s c r i b e d   s e c t i o n   2 . 1  ,   “   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   ”   .   c o n f i g u r e   w e b   s e r v e r  ,   d e s c r i b e d   s e c t i o n   2 . 2  ,   “   w e b   s e r v e r   c o n f i g u r a t i o n   ”   .   e n s u r e   c l u s t e r   c a p a b l e   a c t i v a t i n g   v o l u m e   g r o u p   c o n t a i n s   m y _ l v  ,   v o l u m e   g r o u p   a c t i v a t e d   c l u s t e r   s t a r t u p  ,   d e s c r i b e d   s e c t i o n   2 . 3  ,   “   e x c l u s i v e   a c t i v a t i o n   v o l u m e   g r o u p   c l u s t e r   ”   .   p e r f o r m i n g   p r o c e d u r e s  ,   c r e a t e   r e s o u r c e   g r o u p   r e s o u r c e s   c o n t a i n s  ,   d e s c r i b e d   s e c t i o n   2 . 4  ,   “   c r e a t i n g   r e s o u r c e s   r e s o u r c e   g r o u p s   p c s   c o m m a n d   ”  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 1 .   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   c a s e   r e q u i r e s   c r e a t e   l v m   l o g i c a l   v o l u m e   s t o r a g e   s h a r e d   n o d e s   c l u s t e r   .   p r o c e d u r e   c r e a t e s   l v m   l o g i c a l   v o l u m e   c r e a t e s   e x t 4   f i l e   s y s t e m   v o l u m e   .  ,   s h a r e d   p a r t i t i o n   / d e v / s d b 1   s t o r e   l v m   p h y s i c a l   v o l u m e   l v m   l o g i c a l   v o l u m e   c r e a t e d   .   n o t e   / d e v / s d b 1   p a r t i t i o n   s t o r a g e   s h a r e d  ,   p e r f o r m   p r o c e d u r e   n o d e  ,   c r e a t e   l v m   p h y s i c a l   v o l u m e   p a r t i t i o n   / d e v / s d b 1   .   #  p v c r e a t e   / d e v / s d b 1   p h y s i c a l   v o l u m e   ` `   / d e v / s d b 1  ' '   s u c c e s s f u l l y   c r e a t e d   c r e a t e   v o l u m e   g r o u p   m y _ v g   c o n s i s t s   p h y s i c a l   v o l u m e   / d e v / s d b 1   .   #  v g c r e a t e   m y _ v g   / d e v / s d b 1   v o l u m e   g r o u p   ` `   m y _ v g  ' '   s u c c e s s f u l l y   c r e a t e d   c r e a t e   l o g i c a l   v o l u m e   v o l u m e   g r o u p   m y _ v g   .   #  l v c r e a t e   - l 4 5 0   - n   m y _ l v   m y _ v g   r o u n d i n g   s i z e   f u l l   p h y s i c a l   e x t e n t   4 5 2 . 0 0   m i b   l o g i c a l   v o l u m e   ` `   m y _ l v  ' '   c r e a t e d   l v s   c o m m a n d   d i s p l a y   l o g i c a l   v o l u m e   .   #  l v s   l v   v g   a t t r   l s i z e   p o o l   o r i g i n   d a t a  %   m o v e   c o p y  %   c o n v e r t   m y _ l v   m y _ v g   - w i - a   - -   - -   4 5 2 . 0 0 m   . . .   c r e a t e   e x t 4   f i l e   s y s t e m   l o g i c a l   v o l u m e   m y _ l v   .   #  m k f s . e x t 4   / d e v / m y _ v g / m y _ l v   m k e 2 f s   1 . 4 2 . 7   (  2 1 - j a n - 2 0 1 3  )   f i l e s y s t e m   l a b e l =   t y p e  :   l i n u x   . . .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 2 .   w e b   s e r v e r   c o n f i g u r a t i o n   p r o c e d u r e   c o n f i g u r e s   a p a c h e   h t t p   s e r v e r   .   e n s u r e   a p a c h e   h t t p   s e r v e r   i n s t a l l e d   n o d e   c l u s t e r   .   w g e t   t o o l   i n s t a l l e d   c l u s t e r   c h e c k   s t a t u s   a p a c h e   h t t p   s e r v e r   .   n o d e  ,   e x e c u t e   c o m m a n d   .   #  y u m   i n s t a l l   - y   h t t p d   w g e t   o r d e r   a p a c h e   r e s o u r c e   a g e n t   s t a t u s   a p a c h e   h t t p   s e r v e r  ,   e n s u r e   t e x t   p r e s e n t   / e t c / h t t p d / c o n f / h t t p d . c o n f   f i l e   n o d e   c l u s t e r  ,   e n s u r e   c o m m e n t e d   .   t e x t   p r e s e n t  ,   a d d   t e x t   f i l e   .   <  l o c a t i o n   / s e r v e r - s t a t u s  >   s e t h a n d l e r   s e r v e r - s t a t u s   r e q u i r e   l o c a l   <  / l o c a t i o n  >   a p a c h e   r e s o u r c e   a g e n t   m a n a g e   a p a c h e  ,   s y s t e m d   .  ,   e d i t   l o g r o t a t e   s c r i p t   s u p p l i e d   a p a c h e   s y s t e m c t l   r e l o a d   a p a c h e   .   r e m o v e   l i n e   / e t c / l o g r o t a t e . d / h t t p d   f i l e   n o d e   c l u s t e r   .   / b i n / s y s t e m c t l   r e l o a d   h t t p d . s e r v i c e  >   / d e v / n u l l   2  >   / d e v / n u l l   | |   r e p l a c e   l i n e   r e m o v e d   l i n e s   .   / u s r / b i n / t e s t   - f   / r u n / h t t p d . p i d  >   / d e v / n u l l   2  >   / d e v / n u l l   &   &   / u s r / b i n / p s   - q   $  (  / u s r / b i n / c a t   / r u n / h t t p d . p i d  )  >   / d e v / n u l l   2  >   / d e v / n u l l   &   &   / u s r / s b i n / h t t p d   - f   / e t c / h t t p d / c o n f / h t t p d . c o n f   - c   ` `   p i d f i l e   / r u n / h t t p d . p i d  ' '   - k   g r a c e f u l  >   / d e v / n u l l   2  >   / d e v / n u l l   | |   c r e a t e   w e b   p a g e   a p a c h e   s e r v e   .   n o d e   c l u s t e r  ,   m o u n t   f i l e   s y s t e m   c r e a t e d   s e c t i o n   2 . 1  ,   “   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   ”  ,   c r e a t e   f i l e   i n d e x . h t m l   f i l e   s y s t e m  ,   u n m o u n t   f i l e   s y s t e m   .   #  m o u n t   / d e v / m y _ v g / m y _ l v   / v a r / w w w /   #  m k d i r   / v a r / w w w / h t m l   #  m k d i r   / v a r / w w w / c g i - b i n   #  m k d i r   / v a r / w w w / e r r o r   #  r e s t o r e c o n   - r   / v a r / w w w   #  <  <  - e n d  >   / v a r / w w w / h t m l / i n d e x . h t m l   <  h t m l  >   <  b o d y  >   <  / b o d y  >   <  / h t m l  >   #  u m o u n t   / v a r / w w w
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 3 .   e x c l u s i v e   a c t i v a t i o n   v o l u m e   g r o u p   c l u s t e r   p r o c e d u r e   c o n f i g u r e s   v o l u m e   g r o u p   e n s u r e   c l u s t e r   c a p a b l e   a c t i v a t i n g   v o l u m e   g r o u p  ,   v o l u m e   g r o u p   a c t i v a t e d   c l u s t e r   s t a r t u p   .   v o l u m e   g r o u p   a c t i v a t e d   s y s t e m   c l u s t e r  ,   r i s k   c o r r u p t i n g   v o l u m e   g r o u p  ' s   m e t a d a t a   .   p r o c e d u r e   m o d i f i e s   v o l u m e _ l i s t   e n t r y   / e t c / l v m / l v m . c o n f   c o n f i g u r a t i o n   f i l e   .   v o l u m e   g r o u p s   l i s t e d   v o l u m e _ l i s t   e n t r y   a l l o w e d   a u t o m a t i c a l l y   a c t i v a t e   l o c a l   n o d e   c l u s t e r   m a n a g e r  ' s   c o n t r o l   .   v o l u m e   g r o u p s   r e l a t e d   n o d e  ' s   l o c a l   r o o t   h o m e   d i r e c t o r i e s   i n c l u d e d   l i s t   .   v o l u m e   g r o u p s   m a n a g e d   c l u s t e r   m a n a g e r   e x c l u d e d   v o l u m e _ l i s t   e n t r y   .   n o t e   p r o c e d u r e   r e q u i r e   c l v m d   .   p e r f o r m   p r o c e d u r e   n o d e   c l u s t e r   .   e x e c u t e   c o m m a n d   e n s u r e   l o c k i n g _ t y p e   s e t   1   u s e _ l v m e t a d   s e t   0   / e t c / l v m / l v m . c o n f   f i l e   .   c o m m a n d   d i s a b l e s   s t o p s   l v m e t a d   p r o c e s s e s   i m m e d i a t e l y   .   #  l v m c o n f   - -   e n a b l e - h a l v m   - -   s e r v i c e s   - -   s t a r t s t o p s e r v i c e s   d e t e r m i n e   v o l u m e   g r o u p s   c u r r e n t l y   c o n f i g u r e d   l o c a l   s t o r a g e   c o m m a n d   .   o u t p u t   l i s t   c u r r e n t l y - c o n f i g u r e d   v o l u m e   g r o u p s   .   s p a c e   a l l o c a t e d   s e p a r a t e   v o l u m e   g r o u p s   r o o t   h o m e   d i r e c t o r y   n o d e  ,   v o l u m e s   o u t p u t  ,   .   #  v g s   - -   n o h e a d i n g s   - o   v g _ n a m e   m y _ v g   r h e l _ h o m e   r h e l _ r o o t   a d d   v o l u m e   g r o u p s   m y _ v g   (  v o l u m e   g r o u p   d e f i n e d   c l u s t e r  )   e n t r i e s   v o l u m e _ l i s t   / e t c / l v m / l v m . c o n f   c o n f i g u r a t i o n   f i l e   .  ,   s p a c e   a l l o c a t e d   s e p a r a t e   v o l u m e   g r o u p s   r o o t   h o m e   d i r e c t o r y  ,   u n c o m m e n t   v o l u m e _ l i s t   l i n e   l v m . c o n f   f i l e   a d d   v o l u m e   g r o u p s   e n t r i e s   v o l u m e _ l i s t   .   n o t e   v o l u m e   g r o u p   d e f i n e d   c l u s t e r   (  m y _ v g  )   l i s t   .   v o l u m e _ l i s t   =   [  ` `   r h e l _ r o o t  ' '  ,   ` `   r h e l _ h o m e  ' '  ]   n o t e   r e b u i l d   i n i t r a m f s   b o o t   i m a g e   g u a r a n t e e   b o o t   i m a g e   a c t i v a t e   v o l u m e   g r o u p   c o n t r o l l e d   c l u s t e r   .   u p d a t e   i n i t r a m f s   d e v i c e   c o m m a n d   .   c o m m a n d   m i n u t e   c o m p l e t e   .   #  d r a c u t   - h   - f   / b o o t / i n i t r a m f s -   $  (  u n a m e   - r  )   . i m g   $  (  u n a m e   - r  )   r e b o o t   n o d e   .   n o t e   n o d e   r e b o o t e d  ,   c h e c k   c l u s t e r   s e r v i c e s   s t a r t e d   n o d e   e x e c u t i n g   p c s   c l u s t e r   s t a t u s   c o m m a n d   n o d e   .   y i e l d s   m e s s a g e   e r r o r  :   c l u s t e r   c u r r e n t l y   r u n n i n g   n o d e   e n t e r   c o m m a n d   .   #  p c s   c l u s t e r   s t a r t   a l t e r n a t e l y  ,   w a i t   r e b o o t e d   n o d e   c l u s t e r   s t a r t   c l u s t e r   s e r v i c e s   n o d e s   c o m m a n d   .   #  p c s   c l u s t e r   s t a r t   - -
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 4 .   c r e a t i n g   r e s o u r c e s   r e s o u r c e   g r o u p s   p c s   c o m m a n d   c a s e   r e q u i r e s   c r e a t e   c l u s t e r   r e s o u r c e s   .   e n s u r e   r e s o u r c e s   r u n   n o d e  ,   c o n f i g u r e d   p a r t   r e s o u r c e   g r o u p   a p a c h e g r o u p   .   r e s o u r c e s   c r e a t e  ,   l i s t e d   o r d e r   s t a r t   .   l v m   r e s o u r c e   n a m e d   m y _ l v m   l v m   v o l u m e   g r o u p   c r e a t e d   s e c t i o n   2 . 1  ,   “   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   ”   .   f i l e s y s t e m   r e s o u r c e   n a m e d   m y _ f s  ,   f i l e   s y s t e m   d e v i c e   / d e v / m y _ v g / m y _ l v   c r e a t e d   s e c t i o n   2 . 1  ,   “   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   ”   .   i p a d d r 2   r e s o u r c e  ,   f l o a t i n g   i p   a d d r e s s   a p a c h e g r o u p   r e s o u r c e   g r o u p   .   i p   a d d r e s s   a s s o c i a t e d   p h y s i c a l   n o d e   .   i p a d d r 2   r e s o u r c e  ' s   n i c   d e v i c e   s p e c i f i e d  ,   f l o a t i n g   i p   r e s i d e   n e t w o r k   s t a t i c a l l y   a s s i g n e d   i p   a d d r e s s e s   c l u s t e r   n o d e s  ,   n i c   d e v i c e   a s s i g n   f l o a t i n g   i p   a d d r e s s   p r o p e r l y   d e t e c t e d   .   a p a c h e   r e s o u r c e   n a m e d   w e b s i t e   i n d e x . h t m l   f i l e   a p a c h e   c o n f i g u r a t i o n   d e f i n e d   s e c t i o n   2 . 2  ,   “   w e b   s e r v e r   c o n f i g u r a t i o n   ”   .   p r o c e d u r e   c r e a t e s   r e s o u r c e   g r o u p   a p a c h e g r o u p   r e s o u r c e s   g r o u p   c o n t a i n s   .   r e s o u r c e s   s t a r t   o r d e r   a d d   g r o u p  ,   s t o p   r e v e r s e   o r d e r   a d d e d   g r o u p   .   r u n   p r o c e d u r e   n o d e   c l u s t e r   .   c o m m a n d   c r e a t e s   l v m   r e s o u r c e   m y _ l v m   .   c o m m a n d   s p e c i f i e s   e x c l u s i v e = t r u e   p a r a m e t e r   e n s u r e   c l u s t e r   c a p a b l e   a c t i v a t i n g   l v m   l o g i c a l   v o l u m e   .   r e s o u r c e   g r o u p   a p a c h e g r o u p   e x i s t  ,   c o m m a n d   c r e a t e s   r e s o u r c e   g r o u p   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   m y _ l v m   l v m   v o l g r p n a m e = m y _ v g   \   e x c l u s i v e = t r u e   - -   g r o u p   a p a c h e g r o u p   c r e a t e   r e s o u r c e  ,   r e s o u r c e   s t a r t e d   a u t o m a t i c a l l y   .   c o m m a n d   c o n f i r m   r e s o u r c e   c r e a t e d   s t a r t e d   .   #  p c s   r e s o u r c e   s h o w   r e s o u r c e   g r o u p  :   a p a c h e g r o u p   m y _ l v m   (  o c f  :  : h e a r t b e a t  :   l v m  )  :   s t a r t e d   m a n u a l l y   s t o p   s t a r t   i n d i v i d u a l   r e s o u r c e   p c s   r e s o u r c e   d i s a b l e   p c s   r e s o u r c e   e n a b l e   c o m m a n d s   .   c o m m a n d s   c r e a t e   r e m a i n i n g   r e s o u r c e s   c o n f i g u r a t i o n  ,   a d d i n g   e x i s t i n g   r e s o u r c e   g r o u p   a p a c h e g r o u p   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   m y _ f s   f i l e s y s t e m   \   d e v i c e =  ' '   / d e v / m y _ v g / m y _ l v  ' '   d i r e c t o r y =  ' '   / v a r / w w w  ' '   f s t y p e =  ' '   e x t 4  ' '   - -   g r o u p   \   a p a c h e g r o u p   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   v i r t u a l i p   i p a d d r 2   i p = 1 9 8 . 5 1 . 1 0 0 . 3   \   c i d r _ n e t m a s k = 2 4   - -   g r o u p   a p a c h e g r o u p   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   w e b s i t e   a p a c h e   \   c o n f i g f i l e =  ' '   / e t c / h t t p d / c o n f / h t t p d . c o n f  ' '   \   s t a t u s u r l =  ' '   h t t p  :   / / 1 2 7 . 0 . 0 . 1 / s e r v e r - s t a t u s  ' '   - -   g r o u p   a p a c h e g r o u p   c r e a t i n g   r e s o u r c e s   r e s o u r c e   g r o u p   c o n t a i n s  ,   c h e c k   s t a t u s   c l u s t e r   .   n o t e   r e s o u r c e s   r u n n i n g   n o d e   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   c l u s t e r  :   m y _ c l u s t e r   u p d a t e d  :   w e d   j u l   3 1   1 6: 3 8: 5 1   2 0 1 3   c h a n g e  :   w e d   j u l   3 1   1 6: 4 2: 1 4   2 0 1 3   c r m _ a t t r i b u t e   z 1 . e x a m p l e . c o m   s t a c k  :   c o r o s y n c   c u r r e n t   d c  :   z 2 . e x a m p l e . c o m   (  2  )   -   p a r t i t i o n   q u o r u m   v e r s i o n  :   1 . 1 . 1 0 - 5 . e l 7 - 9 a b e 6 8 7   2   n o d e s   c o n f i g u r e d   6   r e s o u r c e s   c o n f i g u r e d   o n l i n e  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   f u l l   l i s t   r e s o u r c e s  :   m y a p c   (  s t o n i t h  :   f e n c e _ a p c _ s n m p  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   r e s o u r c e   g r o u p  :   a p a c h e g r o u p   m y _ l v m   (  o c f  :  : h e a r t b e a t  :   l v m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   m y _ f s   (  o c f  :  : h e a r t b e a t  :   f i l e s y s t e m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   v i r t u a l i p   (  o c f  :  : h e a r t b e a t  :   i p a d d r 2  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   w e b s i t e   (  o c f  :  : h e a r t b e a t  :   a p a c h e  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n o t e   c o n f i g u r e d   f e n c i n g   d e v i c e   c l u s t e r  ,   d e s c r i b e d   s e c t i o n   1 . 3  ,   “   f e n c i n g   c o n f i g u r a t i o n   ”  ,   d e f a u l t   r e s o u r c e s   s t a r t   .   c l u s t e r   r u n n i n g  ,   p o i n t   b r o w s e r   i p   a d d r e s s   d e f i n e d   i p a d d r 2   r e s o u r c e   v i e w   s a m p l e   d i s p l a y  ,   c o n s i s t i n g   s i m p l e   w o r d   ` `  ' '   .   f i n d   r e s o u r c e s   c o n f i g u r e d   r u n n i n g  ,   r u n   p c s   r e s o u r c e   d e b u g - s t a r t   r e s o u r c e   c o m m a n d   t e s t   r e s o u r c e   c o n f i g u r a t i o n   .   i n f o r m a t i o n   p c s   r e s o u r c e   d e b u g - s t a r t   c o m m a n d  ,   h i g h   a v a i l a b i l i t y   a d d - o n   r e f e r e n c e   m a n u a l  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 5 .   t e s t i n g   r e s o u r c e   c o n f i g u r a t i o n   c l u s t e r   s t a t u s   d i s p l a y   s h o w n   s e c t i o n   2 . 4  ,   “   c r e a t i n g   r e s o u r c e s   r e s o u r c e   g r o u p s   p c s   c o m m a n d   ”  ,   r e s o u r c e s   r u n n i n g   n o d e   z 1 . e x a m p l e . c o m   .   t e s t   r e s o u r c e   g r o u p   f a i l s   n o d e   z 2 . e x a m p l e . c o m   p r o c e d u r e   p u t   n o d e   s t a n d b y  ,   n o d e   l o n g e r   h o s t   r e s o u r c e s   .   c o m m a n d   p u t s   n o d e   z 1 . e x a m p l e . c o m   s t a n d b y   .   r o o t   @   z 1   ~  ]   #  p c s   n o d e   s t a n d b y   z 1 . e x a m p l e . c o m   p u t t i n g   n o d e   z 1   s t a n d b y  ,   c h e c k   c l u s t e r   s t a t u s   .   n o t e   r e s o u r c e s   r u n n i n g   z 2   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   c l u s t e r  :   m y _ c l u s t e r   u p d a t e d  :   w e d   j u l   3 1   1 7: 1 6: 1 7   2 0 1 3   c h a n g e  :   w e d   j u l   3 1   1 7: 1 8: 3 4   2 0 1 3   c r m _ a t t r i b u t e   z 1 . e x a m p l e . c o m   s t a c k  :   c o r o s y n c   c u r r e n t   d c  :   z 2 . e x a m p l e . c o m   (  2  )   -   p a r t i t i o n   q u o r u m   v e r s i o n  :   1 . 1 . 1 0 - 5 . e l 7 - 9 a b e 6 8 7   2   n o d e s   c o n f i g u r e d   6   r e s o u r c e s   c o n f i g u r e d   n o d e   z 1 . e x a m p l e . c o m   (  1  )  :   s t a n d b y   o n l i n e  :   [  z 2 . e x a m p l e . c o m  ]   f u l l   l i s t   r e s o u r c e s  :   m y a p c   (  s t o n i t h  :   f e n c e _ a p c _ s n m p  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   r e s o u r c e   g r o u p  :   a p a c h e g r o u p   m y _ l v m   (  o c f  :  : h e a r t b e a t  :   l v m  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   m y _ f s   (  o c f  :  : h e a r t b e a t  :   f i l e s y s t e m  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   v i r t u a l i p   (  o c f  :  : h e a r t b e a t  :   i p a d d r 2  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   w e b s i t e   (  o c f  :  : h e a r t b e a t  :   a p a c h e  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   w e b   s i t e   d e f i n e d   i p   a d d r e s s   d i s p l a y  ,   i n t e r r u p t i o n   .   r e m o v e   z 1   s t a n d b y  ,   e n t e r   c o m m a n d   .   r o o t   @   z 1   ~  ]   #  p c s   n o d e   u n s t a n d b y   z 1 . e x a m p l e . c o m   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   3 .   a c t i v e / p a s s i v e   n f s   s e r v e r   r e d   h i g h   a v a i l a b i l i t y   c l u s t e r   c h a p t e r   d e s c r i b e s   c o n f i g u r e   h i g h l y   a v a i l a b l e   a c t i v e / p a s s i v e   n f s   s e r v e r   t w o - n o d e   r e d   e n t e r p r i s e   l i n u x   h i g h   a v a i l a b i l i t y   a d d - o n   c l u s t e r   s h a r e d   s t o r a g e   .   p r o c e d u r e   p c s   c o n f i g u r e   p a c e m a k e r   c l u s t e r   r e s o u r c e s   .   c a s e  ,   c l i e n t s   a c c e s s   n f s   f i l e   s y s t e m   f l o a t i n g   i p   a d d r e s s   .   n f s   s e r v e r   r u n s   n o d e s   c l u s t e r   .   n o d e   n f s   s e r v e r   r u n n i n g   i n o p e r a t i v e  ,   n f s   s e r v e r   s t a r t s   n o d e   c l u s t e r   m i n i m a l   s e r v i c e   i n t e r r u p t i o n   .   c a s e   r e q u i r e s   s y s t e m   i n c l u d e   c o m p o n e n t s  :   n o d e s  ,   c r e a t e   c l u s t e r   r u n n i n g   a p a c h e   h t t p   s e r v e r   .  ,   n o d e s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   .   p o w e r   f e n c i n g   d e v i c e   n o d e   c l u s t e r   .   p o r t s   a p c   p o w e r   s w i t c h   h o s t   z a p c . e x a m p l e . c o m   .   p u b l i c   v i r t u a l   i p   a d d r e s s  ,   r e q u i r e d   n f s   s e r v e r   .   s h a r e d   s t o r a g e   n o d e s   c l u s t e r  ,   i s c s i  ,   f i b r e   c h a n n e l  ,   s h a r e d   n e t w o r k   b l o c k   d e v i c e   .   c o n f i g u r i n g   h i g h l y   a v a i l a b l e   a c t i v e / p a s s i v e   n f s   s e r v e r   t w o - n o d e   r e d   e n t e r p r i s e   l i n u x   h i g h   r e q u i r e s   p e r f o r m   s t e p s   .   c r e a t e   c l u s t e r   r u n   n f s   s e r v e r   c o n f i g u r e   f e n c i n g   n o d e   c l u s t e r  ,   d e s c r i b e d   s e c t i o n   3 . 1  ,   “   c r e a t i n g   n f s   c l u s t e r   ”   .   c o n f i g u r e   e x t 4   f i l e   s y s t e m   m o u n t e d   l v m   l o g i c a l   v o l u m e   m y _ l v   s h a r e d   s t o r a g e   n o d e s   c l u s t e r  ,   d e s c r i b e d   s e c t i o n   3 . 2  ,   “   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   ”   .   c o n f i g u r e   n f s   s h a r e   s h a r e d   s t o r a g e   l v m   l o g i c a l   v o l u m e  ,   d e s c r i b e d   s e c t i o n   3 . 3  ,   “   n f s   s h a r e   s e t u p   ”   .   e n s u r e   c l u s t e r   c a p a b l e   a c t i v a t i n g   l v m   v o l u m e   g r o u p   c o n t a i n s   l o g i c a l   v o l u m e   m y _ l v  ,   v o l u m e   g r o u p   a c t i v a t e d   c l u s t e r   s t a r t u p  ,   d e s c r i b e d   s e c t i o n   3 . 4  ,   “   e x c l u s i v e   a c t i v a t i o n   v o l u m e   g r o u p   c l u s t e r   ”   .   c r e a t e   c l u s t e r   r e s o u r c e s   d e s c r i b e d   s e c t i o n   3 . 5  ,   “   c o n f i g u r i n g   c l u s t e r   r e s o u r c e s   ”   .   t e s t   n f s   s e r v e r   c o n f i g u r e d  ,   d e s c r i b e d   s e c t i o n   3 . 6  ,   “   t e s t i n g   r e s o u r c e   c o n f i g u r a t i o n   ”  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 1 .   c r e a t i n g   n f s   c l u s t e r   p r o c e d u r e   i n s t a l l   c r e a t e   n f s   c l u s t e r   .   i n s t a l l   c l u s t e r   s o f t w a r e   n o d e s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ,   p r o c e d u r e   p r o v i d e d   s e c t i o n   1 . 1  ,   “   c l u s t e r   s o f t w a r e   i n s t a l l a t i o n   ”   .   c r e a t e   t w o - n o d e   c l u s t e r   c o n s i s t s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ,   p r o c e d u r e   p r o v i d e d   s e c t i o n   1 . 2  ,   “   c l u s t e r   c r e a t i o n   ”   .   p r o c e d u r e  ,   c a s e   n a m e s   c l u s t e r   m y _ c l u s t e r   .   c o n f i g u r e   f e n c i n g   d e v i c e s   n o d e   c l u s t e r  ,   p r o c e d u r e   p r o v i d e d   s e c t i o n   1 . 3  ,   “   f e n c i n g   c o n f i g u r a t i o n   ”   .   c o n f i g u r e s   f e n c i n g   p o r t s   a p c   p o w e r   s w i t c h   h o s t   z a p c . e x a m p l e . c o m  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 2 .   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   c a s e   r e q u i r e s   c r e a t e   l v m   l o g i c a l   v o l u m e   s t o r a g e   s h a r e d   n o d e s   c l u s t e r   .   p r o c e d u r e   c r e a t e s   l v m   l o g i c a l   v o l u m e   c r e a t e s   e x t 4   f i l e   s y s t e m   v o l u m e   .  ,   s h a r e d   p a r t i t i o n   / d e v / s d b 1   s t o r e   l v m   p h y s i c a l   v o l u m e   l v m   l o g i c a l   v o l u m e   c r e a t e d   .   n o t e   / d e v / s d b 1   p a r t i t i o n   s t o r a g e   s h a r e d  ,   p e r f o r m   p r o c e d u r e   n o d e  ,   c r e a t e   l v m   p h y s i c a l   v o l u m e   p a r t i t i o n   / d e v / s d b 1   .   [  r o o t   @   z 1   ~  ]   #  p v c r e a t e   / d e v / s d b 1   p h y s i c a l   v o l u m e   ` `   / d e v / s d b 1  ' '   s u c c e s s f u l l y   c r e a t e d   c r e a t e   v o l u m e   g r o u p   m y _ v g   c o n s i s t s   p h y s i c a l   v o l u m e   / d e v / s d b 1   .   [  r o o t   @   z 1   ~  ]   #  v g c r e a t e   m y _ v g   / d e v / s d b 1   v o l u m e   g r o u p   ` `   m y _ v g  ' '   s u c c e s s f u l l y   c r e a t e d   c r e a t e   l o g i c a l   v o l u m e   v o l u m e   g r o u p   m y _ v g   .   [  r o o t   @   z 1   ~  ]   #  l v c r e a t e   - l 4 5 0   - n   m y _ l v   m y _ v g   r o u n d i n g   s i z e   f u l l   p h y s i c a l   e x t e n t   4 5 2 . 0 0   m i b   l o g i c a l   v o l u m e   ` `   m y _ l v  ' '   c r e a t e d   l v s   c o m m a n d   d i s p l a y   l o g i c a l   v o l u m e   .   [  r o o t   @   z 1   ~  ]   #  l v s   l v   v g   a t t r   l s i z e   p o o l   o r i g i n   d a t a  %   m o v e   c o p y  %   c o n v e r t   m y _ l v   m y _ v g   - w i - a   - -   - -   4 5 2 . 0 0 m   . . .   c r e a t e   e x t 4   f i l e   s y s t e m   l o g i c a l   v o l u m e   m y _ l v   .   [  r o o t   @   z 1   ~  ]   #  m k f s . e x t 4   / d e v / m y _ v g / m y _ l v   m k e 2 f s   1 . 4 2 . 7   (  2 1 - j a n - 2 0 1 3  )   f i l e s y s t e m   l a b e l =   t y p e  :   l i n u x   . . .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 3 .   n f s   s h a r e   s e t u p   p r o c e d u r e   c o n f i g u r e s   n f s   s h a r e   n f s   d a e m o n   f a i l o v e r   .   p e r f o r m   p r o c e d u r e   n o d e   c l u s t e r   .   c r e a t e   / n f s s h a r e   d i r e c t o r y   .   [  r o o t   @   z 1   ~  ]   #  m k d i r   / n f s s h a r e   m o u n t   e x t 4   f i l e   s y s t e m   c r e a t e d   s e c t i o n   3 . 2  ,   “   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   ”   / n f s s h a r e   d i r e c t o r y   .   [  r o o t   @   z 1   ~  ]   #  m o u n t   / d e v / m y _ v g / m y _ l v   / n f s s h a r e   c r e a t e   e x p o r t s   d i r e c t o r y   t r e e   / n f s s h a r e   d i r e c t o r y   .   [  r o o t   @   z 1   ~  ]   #  m k d i r   - p   / n f s s h a r e / e x p o r t s   [  r o o t   @   z 1   ~  ]   #  m k d i r   - p   / n f s s h a r e / e x p o r t s / e x p o r t 1   [  r o o t   @   z 1   ~  ]   #  m k d i r   - p   / n f s s h a r e / e x p o r t s / e x p o r t 2   p l a c e   f i l e s   e x p o r t s   d i r e c t o r y   n f s   c l i e n t s   a c c e s s   .  ,   c r e a t i n g   t e s t   f i l e s   n a m e d   c l i e n t d a t a f i l e 1   c l i e n t d a t a f i l e 2   .   [  r o o t   @   z 1   ~  ]   #  t o u c h   / n f s s h a r e / e x p o r t s / e x p o r t 1 / c l i e n t d a t a f i l e 1   [  r o o t   @   z 1   ~  ]   #  t o u c h   / n f s s h a r e / e x p o r t s / e x p o r t 2 / c l i e n t d a t a f i l e 2   u n m o u n t   e x t 4   f i l e   s y s t e m   d e a c t i v a t e   l v m   v o l u m e   g r o u p   .   [  r o o t   @   z 1   ~  ]   #  u m o u n t   / d e v / m y _ v g / m y _ l v   [  r o o t   @   z 1   ~  ]   #  v g c h a n g e   - a n   m y _ v g
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 .   e x c l u s i v e   a c t i v a t i o n   v o l u m e   g r o u p   c l u s t e r   p r o c e d u r e   c o n f i g u r e s   l v m   v o l u m e   g r o u p   e n s u r e   c l u s t e r   c a p a b l e   a c t i v a t i n g   v o l u m e   g r o u p  ,   v o l u m e   g r o u p   a c t i v a t e d   c l u s t e r   s t a r t u p   .   v o l u m e   g r o u p   a c t i v a t e d   s y s t e m   c l u s t e r  ,   r i s k   c o r r u p t i n g   v o l u m e   g r o u p  ' s   m e t a d a t a   .   p r o c e d u r e   m o d i f i e s   v o l u m e _ l i s t   e n t r y   / e t c / l v m / l v m . c o n f   c o n f i g u r a t i o n   f i l e   .   v o l u m e   g r o u p s   l i s t e d   v o l u m e _ l i s t   e n t r y   a l l o w e d   a u t o m a t i c a l l y   a c t i v a t e   l o c a l   n o d e   c l u s t e r   m a n a g e r  ' s   c o n t r o l   .   v o l u m e   g r o u p s   r e l a t e d   n o d e  ' s   l o c a l   r o o t   h o m e   d i r e c t o r i e s   i n c l u d e d   l i s t   .   v o l u m e   g r o u p s   m a n a g e d   c l u s t e r   m a n a g e r   e x c l u d e d   v o l u m e _ l i s t   e n t r y   .   n o t e   p r o c e d u r e   r e q u i r e   c l v m d   .   p e r f o r m   p r o c e d u r e   n o d e   c l u s t e r   .   e x e c u t e   c o m m a n d   e n s u r e   l o c k i n g _ t y p e   s e t   1   u s e _ l v m e t a d   s e t   0   / e t c / l v m / l v m . c o n f   f i l e   .   c o m m a n d   d i s a b l e s   s t o p s   l v m e t a d   p r o c e s s e s   i m m e d i a t e l y   .   #  l v m c o n f   - -   e n a b l e - h a l v m   - -   s e r v i c e s   - -   s t a r t s t o p s e r v i c e s   d e t e r m i n e   v o l u m e   g r o u p s   c u r r e n t l y   c o n f i g u r e d   l o c a l   s t o r a g e   c o m m a n d   .   o u t p u t   l i s t   c u r r e n t l y - c o n f i g u r e d   v o l u m e   g r o u p s   .   s p a c e   a l l o c a t e d   s e p a r a t e   v o l u m e   g r o u p s   r o o t   h o m e   d i r e c t o r y   n o d e  ,   v o l u m e s   o u t p u t  ,   .   #  v g s   - -   n o h e a d i n g s   - o   v g _ n a m e   m y _ v g   r h e l _ h o m e   r h e l _ r o o t   a d d   v o l u m e   g r o u p s   m y _ v g   (  v o l u m e   g r o u p   d e f i n e d   c l u s t e r  )   e n t r i e s   v o l u m e _ l i s t   / e t c / l v m / l v m . c o n f   c o n f i g u r a t i o n   f i l e   .  ,   s p a c e   a l l o c a t e d   s e p a r a t e   v o l u m e   g r o u p s   r o o t   h o m e   d i r e c t o r y  ,   u n c o m m e n t   v o l u m e _ l i s t   l i n e   l v m . c o n f   f i l e   a d d   v o l u m e   g r o u p s   e n t r i e s   v o l u m e _ l i s t  :   v o l u m e _ l i s t   =   [  ` `   r h e l _ r o o t  ' '  ,   ` `   r h e l _ h o m e  ' '  ]   n o t e   r e b u i l d   i n i t r a m f s   b o o t   i m a g e   g u a r a n t e e   b o o t   i m a g e   a c t i v a t e   v o l u m e   g r o u p   c o n t r o l l e d   c l u s t e r   .   u p d a t e   i n i t r a m f s   d e v i c e   c o m m a n d   .   c o m m a n d   m i n u t e   c o m p l e t e   .   #  d r a c u t   - h   - f   / b o o t / i n i t r a m f s -   $  (  u n a m e   - r  )   . i m g   $  (  u n a m e   - r  )   r e b o o t   n o d e   .   n o t e   n o d e   r e b o o t e d  ,   c h e c k   c l u s t e r   s e r v i c e s   s t a r t e d   n o d e   e x e c u t i n g   p c s   c l u s t e r   s t a t u s   c o m m a n d   n o d e   .   y i e l d s   m e s s a g e   e r r o r  :   c l u s t e r   c u r r e n t l y   r u n n i n g   n o d e   e n t e r   c o m m a n d   .   #  p c s   c l u s t e r   s t a r t   a l t e r n a t e l y  ,   w a i t   r e b o o t e d   n o d e   c l u s t e r   s t a r t   c l u s t e r   s e r v i c e s   n o d e s   c l u s t e r   c o m m a n d   .   #  p c s   c l u s t e r   s t a r t   - -
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 5 .   c o n f i g u r i n g   c l u s t e r   r e s o u r c e s   s e c t i o n   p r o c e d u r e   c o n f i g u r i n g   c l u s t e r   r e s o u r c e s   c a s e   .   n o t e   p r o c e d u r e   c o n f i g u r e s   s y s t e m   r e s o u r c e s   .   e n s u r e   r e s o u r c e s   r u n   n o d e  ,   c o n f i g u r e d   p a r t   r e s o u r c e   g r o u p   n f s g r o u p   .   r e s o u r c e s   s t a r t   o r d e r   a d d   g r o u p  ,   s t o p   r e v e r s e   o r d e r   a d d e d   g r o u p   .   r u n   p r o c e d u r e   n o d e   c l u s t e r   .   c o m m a n d   c r e a t e s   l v m   r e s o u r c e   n a m e d   m y _ l v m   .   c o m m a n d   s p e c i f i e s   e x c l u s i v e = t r u e   p a r a m e t e r   e n s u r e   c l u s t e r   c a p a b l e   a c t i v a t i n g   l v m   l o g i c a l   v o l u m e   .   r e s o u r c e   g r o u p   n f s g r o u p   e x i s t  ,   c o m m a n d   c r e a t e s   r e s o u r c e   g r o u p   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   m y _ l v m   l v m   v o l g r p n a m e = m y _ v g   \   e x c l u s i v e = t r u e   - -   g r o u p   n f s g r o u p   c h e c k   s t a t u s   c l u s t e r   v e r i f y   r e s o u r c e   r u n n i n g   .   r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   c l u s t e r  :   m y _ c l u s t e r   u p d a t e d  :   t h u   j a n   8   1 1: 1 3: 1 7   2 0 1 5   c h a n g e  :   t h u   j a n   8   1 1: 1 3: 0 8   2 0 1 5   s t a c k  :   c o r o s y n c   c u r r e n t   d c  :   z 2 . e x a m p l e . c o m   (  2  )   -   p a r t i t i o n   q u o r u m   v e r s i o n  :   1 . 1 . 1 2 - a 1 4 e f a d   2   n o d e s   c o n f i g u r e d   3   r e s o u r c e s   c o n f i g u r e d   o n l i n e  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   f u l l   l i s t   r e s o u r c e s  :   m y a p c   (  s t o n i t h  :   f e n c e _ a p c _ s n m p  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   r e s o u r c e   g r o u p  :   n f s g r o u p   m y _ l v m   (  o c f  :  : h e a r t b e a t  :   l v m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   p c s d   s t a t u s  :   z 1 . e x a m p l e . c o m  :   o n l i n e   z 2 . e x a m p l e . c o m  :   o n l i n e   d a e m o n   s t a t u s  :   c o r o s y n c  :   a c t i v e / e n a b l e d   p a c e m a k e r  :   a c t i v e / e n a b l e d   p c s d  :   a c t i v e / e n a b l e d   c o n f i g u r e   f i l e s y s t e m   r e s o u r c e   c l u s t e r   .   n o t e   c o m m a n d   c o n f i g u r e s   e x t 4   f i l e s y s t e m   r e s o u r c e   n a m e d   n f s s h a r e   p a r t   n f s g r o u p   r e s o u r c e   g r o u p   .   f i l e   s y s t e m   l v m   v o l u m e   g r o u p   e x t 4   f i l e   s y s t e m   c r e a t e d   s e c t i o n   3 . 2  ,   “   c o n f i g u r i n g   l v m   v o l u m e   e x t 4   f i l e   s y s t e m   ”   m o u n t e d   / n f s s h a r e   d i r e c t o r y   c r e a t e d   s e c t i o n   3 . 3  ,   “   n f s   s h a r e   s e t u p   ”   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   n f s s h a r e   f i l e s y s t e m   \   d e v i c e = / d e v / m y _ v g / m y _ l v   d i r e c t o r y = / n f s s h a r e   \   f s t y p e = e x t 4   - -   g r o u p   n f s g r o u p   v e r i f y   m y _ l v m   n f s s h a r e   r e s o u r c e s   r u n n i n g   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   . . .   f u l l   l i s t   r e s o u r c e s  :   m y a p c   (  s t o n i t h  :   f e n c e _ a p c _ s n m p  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   r e s o u r c e   g r o u p  :   n f s g r o u p   m y _ l v m   (  o c f  :  : h e a r t b e a t  :   l v m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s s h a r e   (  o c f  :  : h e a r t b e a t  :   f i l e s y s t e m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   . . .   c r e a t e   n f s s e r v e r   r e s o u r c e   n a m e d   n f s - d a e m o n   p a r t   r e s o u r c e   g r o u p   n f s g r o u p   .   n o t e   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   n f s - d a e m o n   n f s s e r v e r   \   n f s _ s h a r e d _ i n f o d i r = / n f s s h a r e / n f s i n f o   n f s _ n o _ n o t i f y = t r u e   \   - -   g r o u p   n f s g r o u p   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   . . .   a d d   e x p o r t f s   r e s o u r c e s   e x p o r t   / n f s s h a r e / e x p o r t s   d i r e c t o r y   .   r e s o u r c e s   p a r t   r e s o u r c e   g r o u p   n f s g r o u p   .   b u i l d s   v i r t u a l   d i r e c t o r y   n f s v 4   c l i e n t s   .   n f s v 3   c l i e n t s   a c c e s s   e x p o r t s   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   n f s - r o o t   e x p o r t f s   \   c l i e n t s p e c = 1 9 2 . 1 6 8 . 1 2 2 . 0 / 2 5 5 . 2 5 5 . 2 5 5 . 0   \   o p t i o n s = r w  ,   s y n c  ,   n o _ r o o t _ s q u a s h   \   d i r e c t o r y = / n f s s h a r e / e x p o r t s   \   f s i d = 0   - -   g r o u p   n f s g r o u p   [  r o o t   @   z 1   ~  ]   #  #  p c s   r e s o u r c e   c r e a t e   n f s - e x p o r t 1   e x p o r t f s   \   c l i e n t s p e c = 1 9 2 . 1 6 8 . 1 2 2 . 0 / 2 5 5 . 2 5 5 . 2 5 5 . 0   \   o p t i o n s = r w  ,   s y n c  ,   n o _ r o o t _ s q u a s h   d i r e c t o r y = / n f s s h a r e / e x p o r t s / e x p o r t 1   \   f s i d = 1   - -   g r o u p   n f s g r o u p   [  r o o t   @   z 1   ~  ]   #  #  p c s   r e s o u r c e   c r e a t e   n f s - e x p o r t 2   e x p o r t f s   \   c l i e n t s p e c = 1 9 2 . 1 6 8 . 1 2 2 . 0 / 2 5 5 . 2 5 5 . 2 5 5 . 0   \   o p t i o n s = r w  ,   s y n c  ,   n o _ r o o t _ s q u a s h   d i r e c t o r y = / n f s s h a r e / e x p o r t s / e x p o r t 2   \   f s i d = 2   - -   g r o u p   n f s g r o u p   a d d   f l o a t i n g   i p   a d d r e s s   r e s o u r c e   n f s   c l i e n t s   a c c e s s   n f s   s h a r e   .   f l o a t i n g   i p   a d d r e s s   s p e c i f y   r e q u i r e s   r e v e r s e   d n s   l o o k u p   s p e c i f i e d   / e t c / h o s t s   n o d e s   c l u s t e r   .   r e s o u r c e   p a r t   r e s o u r c e   g r o u p   n f s g r o u p   .   d e p l o y m e n t  ,   1 9 2 . 1 6 8 . 1 2 2 . 2 0 0   f l o a t i n g   i p   a d d r e s s   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   n f s _ i p   i p a d d r 2   \   i p = 1 9 2 . 1 6 8 . 1 2 2 . 2 0 0   c i d r _ n e t m a s k = 2 4   - -   g r o u p   n f s g r o u p   a d d   n f s n o t i f y   r e s o u r c e   s e n d i n g   n f s v 3   r e b o o t   n o t i f i c a t i o n s   e n t i r e   n f s   d e p l o y m e n t   i n i t i a l i z e d   .   r e s o u r c e   p a r t   r e s o u r c e   g r o u p   n f s g r o u p   .   n o t e   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   n f s - n o t i f y   n f s n o t i f y   \   s o u r c e _ h o s t = 1 9 2 . 1 6 8 . 1 2 2 . 2 0 0   - -   g r o u p   n f s g r o u p   c r e a t i n g   r e s o u r c e s   r e s o u r c e   c o n s t r a i n t s  ,   c h e c k   s t a t u s   c l u s t e r   .   n o t e   r e s o u r c e s   r u n n i n g   n o d e   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   . . .   f u l l   l i s t   r e s o u r c e s  :   m y a p c   (  s t o n i t h  :   f e n c e _ a p c _ s n m p  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   r e s o u r c e   g r o u p  :   n f s g r o u p   m y _ l v m   (  o c f  :  : h e a r t b e a t  :   l v m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s s h a r e   (  o c f  :  : h e a r t b e a t  :   f i l e s y s t e m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - d a e m o n   (  o c f  :  : h e a r t b e a t  :   n f s s e r v e r  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - r o o t   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - e x p o r t 1   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - e x p o r t 2   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s _ i p   (  o c f  :  : h e a r t b e a t  :   i p a d d r 2  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - n o t i f y   (  o c f  :  : h e a r t b e a t  :   n f s n o t i f y  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   . . .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 6 .   t e s t i n g   r e s o u r c e   c o n f i g u r a t i o n   v a l i d a t e   s y s t e m   c o n f i g u r a t i o n   p r o c e d u r e   .   m o u n t   e x p o r t e d   f i l e   s y s t e m   n f s v 3   n f s v 4   .   n o d e   c l u s t e r  ,   r e s i d i n g   n e t w o r k   d e p l o y m e n t  ,   v e r i f y   n f s   s h a r e   m o u n t i n g   n f s   s h a r e   .  ,   1 9 2 . 1 6 8 . 1 2 2 . 0 / 2 4   n e t w o r k   .   #  s h o w m o u n t   - e   1 9 2 . 1 6 8 . 1 2 2 . 2 0 0   e x p o r t   l i s t   1 9 2 . 1 6 8 . 1 2 2 . 2 0 0  :   / n f s s h a r e / e x p o r t s / e x p o r t 1   1 9 2 . 1 6 8 . 1 2 2 . 0 / 2 5 5 . 2 5 5 . 2 5 5 . 0   / n f s s h a r e / e x p o r t s   1 9 2 . 1 6 8 . 1 2 2 . 0 / 2 5 5 . 2 5 5 . 2 5 5 . 0   / n f s s h a r e / e x p o r t s / e x p o r t 2   1 9 2 . 1 6 8 . 1 2 2 . 0 / 2 5 5 . 2 5 5 . 2 5 5 . 0   v e r i f y   m o u n t   n f s   s h a r e   n f s v 4  ,   m o u n t   n f s   s h a r e   d i r e c t o r y   c l i e n t   n o d e   .   m o u n t i n g  ,   v e r i f y   c o n t e n t s   e x p o r t   d i r e c t o r i e s   v i s i b l e   .   u n m o u n t   s h a r e   t e s t i n g   .   #  m k d i r   n f s s h a r e   #  m o u n t   - o   ` `   v e r s = 4  ' '   1 9 2 . 1 6 8 . 1 2 2 . 2 0 0  :   e x p o r t 1   n f s s h a r e   #  l s   n f s s h a r e   c l i e n t d a t a f i l e 1   #  u m o u n t   n f s s h a r e   v e r i f y   m o u n t   n f s   s h a r e   n f s v 3   .   m o u n t i n g  ,   v e r i f y   t e s t   f i l e   c l i e n t d a t a f i l e 1   v i s i b l e   .   u n l i k e   n f s v 4  ,   n f s v 3   v i r t u a l   f i l e   s y s t e m  ,   m o u n t   s p e c i f i c   e x p o r t   .   u n m o u n t   s h a r e   t e s t i n g   .   #  m k d i r   n f s s h a r e   #  m o u n t   - o   ` `   v e r s = 3  ' '   1 9 2 . 1 6 8 . 1 2 2 . 2 0 0  :   / n f s s h a r e / e x p o r t s / e x p o r t 2   n f s s h a r e   #  l s   n f s s h a r e   c l i e n t d a t a f i l e 2   #  u m o u n t   n f s s h a r e   t e s t   f a i l o v e r  ,   p e r f o r m   s t e p s   .   n o d e   c l u s t e r  ,   m o u n t   n f s   s h a r e   v e r i f y   a c c e s s   c l i e n t d a t a f i l e 1   c r e a t e d   s e c t i o n   3 . 3  ,   “   n f s   s h a r e   s e t u p   ”   .   #  m k d i r   n f s s h a r e   #  m o u n t   - o   ` `   v e r s = 4  ' '   1 9 2 . 1 6 8 . 1 2 2 . 2 0 0  :   e x p o r t 1   n f s s h a r e   #  l s   n f s s h a r e   c l i e n t d a t a f i l e 1   n o d e   c l u s t e r  ,   d e t e r m i n e   n o d e   c l u s t e r   r u n n i n g   n f s g r o u p   .  ,   n f s g r o u p   r u n n i n g   z 1 . e x a m p l e . c o m   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   . . .   f u l l   l i s t   r e s o u r c e s  :   m y a p c   (  s t o n i t h  :   f e n c e _ a p c _ s n m p  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   r e s o u r c e   g r o u p  :   n f s g r o u p   m y _ l v m   (  o c f  :  : h e a r t b e a t  :   l v m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s s h a r e   (  o c f  :  : h e a r t b e a t  :   f i l e s y s t e m  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - d a e m o n   (  o c f  :  : h e a r t b e a t  :   n f s s e r v e r  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - r o o t   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - e x p o r t 1   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - e x p o r t 2   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s _ i p   (  o c f  :  : h e a r t b e a t  :   i p a d d r 2  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   n f s - n o t i f y   (  o c f  :  : h e a r t b e a t  :   n f s n o t i f y  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   . . .   n o d e   c l u s t e r  ,   p u t   n o d e   r u n n i n g   n f s g r o u p   s t a n d b y   .   [  r o o t   @   z 1   ~  ]   #  p c s   n o d e   s t a n d b y   z 1 . e x a m p l e . c o m   v e r i f y   n f s g r o u p   s u c c e s s f u l l y   s t a r t s   c l u s t e r   n o d e   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   . . .   f u l l   l i s t   r e s o u r c e s  :   r e s o u r c e   g r o u p  :   n f s g r o u p   m y _ l v m   (  o c f  :  : h e a r t b e a t  :   l v m  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   n f s s h a r e   (  o c f  :  : h e a r t b e a t  :   f i l e s y s t e m  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   n f s - d a e m o n   (  o c f  :  : h e a r t b e a t  :   n f s s e r v e r  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   n f s - r o o t   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   n f s - e x p o r t 1   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   n f s - e x p o r t 2   (  o c f  :  : h e a r t b e a t  :   e x p o r t f s  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   n f s _ i p   (  o c f  :  : h e a r t b e a t  :   i p a d d r 2  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   n f s - n o t i f y   (  o c f  :  : h e a r t b e a t  :   n f s n o t i f y  )  :   s t a r t e d   z 2 . e x a m p l e . c o m   . . .   n o d e   c l u s t e r   m o u n t e d   n f s   s h a r e  ,   v e r i f y   n o d e   c o n t i n u e s   a c c e s s   t e s t   f i l e   n f s   m o u n t   .   #  l s   n f s s h a r e   c l i e n t d a t a f i l e 1   s e r v i c e   l o s t   b r i e f l y   c l i e n t   f a i l o v e r   b r i e f l y   c l i e n t   r e c o v e r   u s e r   i n t e r v e n t i o n   .   d e f a u l t  ,   c l i e n t s   n f s v 4   9 0   s e c o n d s   r e c o v e r   m o u n t  ;   9 0   s e c o n d s   r e p r e s e n t s   n f s v 4   f i l e   l e a s e   g r a c e   p e r i o d   o b s e r v e d   s e r v e r   s t a r t u p   .   n f s v 3   c l i e n t s   r e c o v e r   a c c e s s   m o u n t   m a t t e r   s e c o n d s   .   n o d e   c l u s t e r  ,   r e m o v e   n o d e   i n i t i a l l y   r u n n i n g   r u n n i n g   n f s g r o u p   s t a n d b y   .   m o v e   c l u s t e r   r e s o u r c e s   b a c k   n o d e   .   [  r o o t   @   z 1   ~  ]   #  p c s   n o d e   u n s t a n d b y   z 1 . e x a m p l e . c o m   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   4 .   a c t i v e / a c t i v e   s a m b a   s e r v e r   r e d   h i g h   a v a i l a b i l i t y   c l u s t e r   (  r e d   e n t e r p r i s e   l i n u x   7 . 4  )   r e d   e n t e r p r i s e   l i n u x   7 . 4   r e l e a s e  ,   r e d   r e s i l i e n t   s t o r a g e   a d d - o n   s u p p o r t   r u n n i n g   s a m b a   a c t i v e / a c t i v e   c l u s t e r   c o n f i g u r a t i o n   p a c e m a k e r   .   r e d   r e s i l i e n t   s t o r a g e   a d d - o n   i n c l u d e s   h i g h   a v a i l a b i l i t y   a d d - o n   .   n o t e   c h a p t e r   d e s c r i b e s   c o n f i g u r e   h i g h l y   a v a i l a b l e   a c t i v e / a c t i v e   s a m b a   s e r v e r   t w o - n o d e   r e d   e n t e r p r i s e   l i n u x   h i g h   a v a i l a b i l i t y   a d d - o n   c l u s t e r   s h a r e d   s t o r a g e   .   p r o c e d u r e   p c s   c o n f i g u r e   p a c e m a k e r   c l u s t e r   r e s o u r c e s   .   c a s e   r e q u i r e s   s y s t e m   i n c l u d e   c o m p o n e n t s  :   n o d e s  ,   c r e a t e   c l u s t e r   r u n n i n g   c l u s t e r e d   s a m b a   .  ,   n o d e s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m   i p   a d d r e s s   1 9 2 . 1 6 8 . 1 . 1 5 1   1 9 2 . 1 6 8 . 1 . 1 5 2 .   p o w e r   f e n c i n g   d e v i c e   n o d e   c l u s t e r   .   p o r t s   a p c   p o w e r   s w i t c h   h o s t   z a p c . e x a m p l e . c o m   .   s h a r e d   s t o r a g e   n o d e s   c l u s t e r  ,   i s c s i   f i b r e   c h a n n e l   .   c o n f i g u r i n g   h i g h l y   a v a i l a b l e   a c t i v e / a c t i v e   s a m b a   s e r v e r   t w o - n o d e   r e d   e n t e r p r i s e   l i n u x   h i g h   a v a i l a b i l i t y   a d d - o n   c l u s t e r   r e q u i r e s   p e r f o r m   s t e p s   .   c r e a t e   c l u s t e r   e x p o r t   s a m b a   s h a r e s   c o n f i g u r e   f e n c i n g   n o d e   c l u s t e r  ,   d e s c r i b e d   s e c t i o n   4 . 1  ,   “   c r e a t i n g   c l u s t e r   ”   .   c o n f i g u r e   g f s 2   f i l e   s y s t e m   m o u n t e d   c l u s t e r e d   l v m   l o g i c a l   v o l u m e   m y _ c l v   s h a r e d   s t o r a g e   n o d e s   c l u s t e r  ,   d e s c r i b e d   s e c t i o n   4 . 2  ,   “   c o n f i g u r i n g   c l u s t e r e d   l v m   v o l u m e   g f s 2   f i l e   s y s t e m   ”   .   c o n f i g u r e   s a m b a   n o d e   c l u s t e r  ,   s e c t i o n   4 . 3  ,   “   c o n f i g u r i n g   s a m b a   ”   .   c r e a t e   s a m b a   c l u s t e r   r e s o u r c e s   d e s c r i b e d   s e c t i o n   4 . 4  ,   “   c o n f i g u r i n g   s a m b a   c l u s t e r   r e s o u r c e s   ”   .   t e s t   s a m b a   s h a r e   c o n f i g u r e d  ,   d e s c r i b e d   s e c t i o n   4 . 5  ,   “   t e s t i n g   r e s o u r c e   c o n f i g u r a t i o n   ”  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 1 .   c r e a t i n g   c l u s t e r   p r o c e d u r e   i n s t a l l   c r e a t e   c l u s t e r   s a m b a   s e r v i c e  :   i n s t a l l   c l u s t e r   s o f t w a r e   n o d e s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ,   p r o c e d u r e   p r o v i d e d   s e c t i o n   1 . 1  ,   “   c l u s t e r   s o f t w a r e   i n s t a l l a t i o n   ”   .   c r e a t e   t w o - n o d e   c l u s t e r   c o n s i s t s   z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ,   p r o c e d u r e   p r o v i d e d   s e c t i o n   1 . 2  ,   “   c l u s t e r   c r e a t i o n   ”   .   p r o c e d u r e  ,   c a s e   n a m e s   c l u s t e r   m y _ c l u s t e r   .   c o n f i g u r e   f e n c i n g   d e v i c e s   n o d e   c l u s t e r  ,   p r o c e d u r e   p r o v i d e d   s e c t i o n   1 . 3  ,   “   f e n c i n g   c o n f i g u r a t i o n   ”   .   c o n f i g u r e s   f e n c i n g   p o r t s   a p c   p o w e r   s w i t c h   h o s t   z a p c . e x a m p l e . c o m  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 2 .   c o n f i g u r i n g   c l u s t e r e d   l v m   v o l u m e   g f s 2   f i l e   s y s t e m   c a s e   r e q u i r e s   c r e a t e   c l u s t e r e d   l v m   l o g i c a l   v o l u m e   s t o r a g e   s h a r e d   n o d e s   c l u s t e r   .   s e c t i o n   d e s c r i b e s   c r e a t e   c l u s t e r e d   l v m   l o g i c a l   v o l u m e   g f s 2   f i l e   s y s t e m   v o l u m e   .  ,   s h a r e d   p a r t i t i o n   / d e v / v d b   s t o r e   l v m   p h y s i c a l   v o l u m e   l v m   l o g i c a l   v o l u m e   c r e a t e d   .   n o t e   s t a r t i n g   p r o c e d u r e  ,   i n s t a l l   l v m 2 - c l u s t e r   g f s 2 - u t i l s   p a c k a g e s  ,   p a r t   r e s i l i e n t   s t o r a g e   c h a n n e l  ,   n o d e s   c l u s t e r   .   #  y u m   i n s t a l l   l v m 2 - c l u s t e r   g f s 2 - u t i l s   / d e v / v d b   p a r t i t i o n   s t o r a g e   s h a r e d  ,   p e r f o r m   p r o c e d u r e   n o d e  ,   s e t   g l o b a l   p a c e m a k e r   p a r a m e t e r   n o _ q u o r u m _ p o l i c y   f r e e z e   .   p r e v e n t s   e n t i r e   c l u s t e r   f e n c e d   t i m e   q u o r u m   l o s t   .   i n f o r m a t i o n   s e t t i n g   p o l i c y  ,   g l o b a l   f i l e   s y s t e m   2   .   [  r o o t   @   z 1   ~  ]   #  p c s   p r o p e r t y   s e t   n o - q u o r u m - p o l i c y = f r e e z e   s e t   d l m   r e s o u r c e   .   r e q u i r e d   d e p e n d e n c y   c l v m d   s e r v i c e   g f s 2   f i l e   s y s t e m   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   d l m   o c f  :   p a c e m a k e r  :   c o n t r o l d   m o n i t o r   i n t e r v a l = 3 0 s   o n - f a i l = f e n c e   c l o n e   i n t e r l e a v e = t r u e   o r d e r e d = t r u e   s e t   c l v m d   c l u s t e r   r e s o u r c e   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   c l v m d   o c f  :   h e a r t b e a t  :   c l v m   m o n i t o r   i n t e r v a l = 3 0 s   o n - f a i l = f e n c e   c l o n e   i n t e r l e a v e = t r u e   o r d e r e d = t r u e   n o t e   o c f  :   h e a r t b e a t  :   c l v m   r e s o u r c e   a g e n t  ,   p a r t   s t a r t   p r o c e d u r e  ,   s e t s   l o c k i n g _ t y p e   p a r a m e t e r   / e t c / l v m / l v m . c o n f   f i l e   3   d i s a b l e s   l v m e t a d   d a e m o n   .   s e t   c l v m d   d l m   d e p e n d e n c y   s t a r t   o r d e r   .   c l v m d   r e s o u r c e   s t a r t   d l m   r e s o u r c e   r u n   n o d e   d l m   r e s o u r c e   .   [  r o o t   @   z 1   ~  ]   #  p c s   c o n s t r a i n t   o r d e r   s t a r t   d l m - c l o n e   c l v m d - c l o n e   a d d i n g   d l m - c l o n e   c l v m d - c l o n e   (  k i n d  :   m a n d a t o r y  )   (  o p t i o n s  :   f i r s t - a c t i o n = s t a r t   t h e n - a c t i o n = s t a r t  )   [  r o o t   @   z 1   ~  ]   #  p c s   c o n s t r a i n t   c o l o c a t i o n   a d d   c l v m d - c l o n e   d l m - c l o n e   v e r i f y   d l m   c l v m d   r e s o u r c e s   r u n n i n g   n o d e s   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   . . .   f u l l   l i s t   r e s o u r c e s  :   . . .   c l o n e   s e t  :   d l m - c l o n e   [  d l m  ]   s t a r t e d  :   [  z 1   z 2  ]   c l o n e   s e t  :   c l v m d - c l o n e   [  c l v m d  ]   s t a r t e d  :   [  z 1   z 2  ]   c r e a t e   c l u s t e r e d   l o g i c a l   v o l u m e   [  r o o t   @   z 1   ~  ]   #  p v c r e a t e   / d e v / v d b   [  r o o t   @   z 1   ~  ]   #  v g c r e a t e   - a y   - c y   c l u s t e r _ v g   / d e v / v d b   [  r o o t   @   z 1   ~  ]   #  l v c r e a t e   - l 4 g   - n   c l u s t e r _ l v   c l u s t e r _ v g   o p t i o n a l l y  ,   v e r i f y   v o l u m e   c r e a t e d   s u c c e s s f u l l y   l v s   c o m m a n d   d i s p l a y   l o g i c a l   v o l u m e   .   [  r o o t   @   z 1   ~  ]   #  l v s   l v   v g   a t t r   l s i z e   . . .   c l u s t e r _ l v   c l u s t e r _ v g   - w i - a o   - -   - -   4 . 0 0 g   . . .   f o r m a t   v o l u m e   g f s 2   f i l e   s y s t e m   .  ,   m y _ c l u s t e r   c l u s t e r   .   s p e c i f i e s   - j   2   i n d i c a t e   j o u r n a l s   n u m b e r   j o u r n a l s   c o n f i g u r e   e q u a l   n u m b e r   n o d e s   c l u s t e r   .   [  r o o t   @   z 1   ~  ]   #  m k f s . g f s 2   - p   l o c k _ d l m   - j   2   - t   m y _ c l u s t e r  :   s a m b a   / d e v / c l u s t e r _ v g / c l u s t e r _ l v   c r e a t e   f i l e s y s t e m   r e s o u r c e  ,   c o n f i g u r e s   p a c e m a k e r   m o u n t   m a n a g e   f i l e   s y s t e m   .   c r e a t e s   f i l e s y s t e m   r e s o u r c e   n a m e d   f s  ,   c r e a t e s   / m n t / g f s 2 s h a r e   n o d e s   c l u s t e r   .   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c r e a t e   f s   o c f  :   h e a r t b e a t  :   f i l e s y s t e m   d e v i c e =  ' '   / d e v / c l u s t e r _ v g / c l u s t e r _ l v  ' '   d i r e c t o r y =  ' '   / m n t / g f s 2 s h a r e  ' '   f s t y p e =  ' '   g f s 2  ' '   - -   c l o n e   c o n f i g u r e   d e p e n d e n c y   s t a r t u p   o r d e r   g f s 2   f i l e   s y s t e m   c l v m d   s e r v i c e   .   g f s 2   s t a r t   c l v m d   r u n   n o d e   c l v m d   .   [  r o o t   @   z 1   ~  ]   #  p c s   c o n s t r a i n t   o r d e r   s t a r t   c l v m d - c l o n e   f s - c l o n e   a d d i n g   c l v m d - c l o n e   f s - c l o n e   (  k i n d  :   m a n d a t o r y  )   (  o p t i o n s  :   f i r s t - a c t i o n = s t a r t   t h e n - a c t i o n = s t a r t  )   [  r o o t   @   z 1   ~  ]   #  p c s   c o n s t r a i n t   c o l o c a t i o n   a d d   f s - c l o n e   c l v m d - c l o n e   v e r i f y   g f s 2   f i l e   s y s t e m   m o u n t e d   e x p e c t e d   .   [  r o o t   @   z 1   ~  ]   #  m o u n t   | g r e p   / m n t / g f s 2 s h a r e   / d e v / m a p p e r / c l u s t e r _ v g - c l u s t e r _ l v   / m n t / g f s 2 s h a r e   t y p e   g f s 2   (  r w  ,   n o a t i m e  ,   s e c l a b e l  )
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 3 .   c o n f i g u r i n g   s a m b a   p r o c e d u r e   i n i t i a l i z e s   s a m b a   e n v i r o n m e n t   c o n f i g u r e s   s a m b a   c l u s t e r   n o d e s   .   n o d e s   c l u s t e r  ,   p e r f o r m   s t e p s  :   i n s t a l l   s a m b a  ,   c t d b  ,   c i f s - u t i l s   p a c k a g e s   .   #  y u m   i n s t a l l   s a m b a   c t d b   c i f s - u t i l s   r u n n i n g   f i r e w a l l d   d a e m o n  ,   r u n   c o m m a n d s   e n a b l e   p o r t s   r e q u i r e d   c t d b   s a m b a   s e r v i c e s   .   #  f i r e w a l l - c m d   - -   a d d - s e r v i c e = c t d b   - -   p e r m a n e n t   #  f i r e w a l l - c m d   - -   a d d - s e r v i c e = s a m b a   - -   p e r m a n e n t   #  f i r e w a l l - c m d   - -   r e l o a d   e n t e r   c o m m a n d s   e n s u r e   d a e m o n s   r u n n i n g   s t a r t   b o o t u p   .   n o t e   d a e m o n s   p r e s e n t   r u n n i n g   s y s t e m   .   #  s y s t e m c t l   d i s a b l e   c t d b   #  s y s t e m c t l   d i s a b l e   s m b   #  s y s t e m c t l   d i s a b l e   n m b   #  s y s t e m c t l   d i s a b l e   w i n b i n d   #  s y s t e m c t l   s t o p   c t d b   #  s y s t e m c t l   s t o p   s m b   #  s y s t e m c t l   s t o p   n m b   #  s y s t e m c t l   s t o p   w i n b i n d   / e t c / s a m b a / s m b . c o n f   f i l e  ,   c o n f i g u r e   s a m b a   s e r v e r   s e t   [  p u b l i c  ]   s h a r e   d e f i n i t i o n   .  :   #  <  < >   / e t c / s a m b a / s m b . c o n f   [  g l o b a l  ]   n e t b i o s   =   l i n u x s e r v e r   w o r k g r o u p   =   w o r k g r o u p   s e r v e r   s t r i n g   =   p u b l i c   f i l e   s e r v e r   s e c u r i t y   =   u s e r   m a p   g u e s t   =   u s e r   g u e s t   a c c o u n t   =   s m b g u e s t   c l u s t e r i n g   =   c t d b d   s o c k e t   =   / t m p / c t d b . s o c k e t   [  p u b l i c  ]   p a t h   =   / m n t / g f s 2 s h a r e / p u b l i c   g u e s t   =   r e a d   =   i n f o r m a t i o n   c o n f i g u r i n g   s a m b a   s t a n d a l o n e   s e r v e r  ,  ,   i n f o r m a t i o n   v e r i f y i n g   s m b . c o n f   f i l e   t e s t p a r m   u t i l i t y  ,   f i l e   p r i n t   s e r v e r s   s e c t i o n   s y s t e m   a d m i n i s t r a t o r  ' s   g u i d e   a d d   i p   a d d r e s s   c l u s t e r   n o d e s   / e t c / c t d b / n o d e s   f i l e   .   #  <  < >   / e t c / c t d b / n o d e s
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 9 2 . 1 6 8 . 1 . 1 5 1
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 9 2 . 1 6 8 . 1 . 1 5 2   l o a d   b a l a n c i n g   n o d e s   c l u s t e r  ,   a d d   i p   a d d r e s s e s   a c c e s s   s a m b a   s h a r e s   e x p o r t e d   c l u s t e r   / e t c / c t d b / p u b l i c _ a d d r e s s e s   f i l e   .   i p   a d d r e s s e s   c o n f i g u r e   d n s   s a m b a   s e r v e r   a d d r e s s e s   s m b   c l i e n t s   c o n n e c t   .   c o n f i g u r e   s a m b a   s e r v e r   d n s   t y p e   r e c o r d   m u l t i p l e   i p   a d d r e s s e s   r o u n d - r o b i n   d n s   d i s t r i b u t e   c l i e n t s   n o d e s   c l u s t e r   .  ,   d n s   e n t r y   l i n u x s e r v e r . e x a m p l e . c o m   d e f i n e d   a d d r e s s e s   l i s t e d   / e t c / c t d b / p u b l i c _ a d d r e s s e s   f i l e   .   p l a c e  ,   d n s   d i s t r i b u t e   s a m b a   c l i e n t s   c l u s t e r   n o d e s   r o u n d - r o b i n   f a s h i o n   .   n o t e   i m p l e m e n t i n g   s c e n a r i o  ,   d n s   e n t r i e s   m a t c h   .   a d d   i p   a d d r e s s e s   a c c e s s   s a m b a   s h a r e s   e x p o r t e d   c l u s t e r   / e t c / c t d b / p u b l i c _ a d d r e s s e s   f i l e   .   #  <  < >   / e t c / c t d b / p u b l i c _ a d d r e s s e s
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 9 2 . 1 6 8 . 1 . 2 0 1 / 2 4   e t h 0
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 9 2 . 1 6 8 . 1 . 2 0 2 / 2 4   e t h 0   c r e a t e   s a m b a   g r o u p  ,   a d d   l o c a l   u s e r   p u b l i c   t e s t   s h a r e   d i r e c t o r y  ,   s e t t i n g   p r e v i o u s l y   c r e a t e d   g r o u p   p r i m a r y   g r o u p   .   #  g r o u p a d d   s m b g u e s t   #  a d d u s e r   s m b g u e s t   - g   s m b g u e s t   m a k e   s e l i n u x   c o n t e x t   c o r r e c t   c t d b - r e l a t e d   d i r e c t o r i e s   .   #  m k d i r   / v a r / c t d b /   #  c h c o n   - r v   - u   s y s t e m _ u   - r   o b j e c t _ r   - t   c t d b d _ v a r _ l i b _ t   / v a r / c t d b /   c h a n g i n g   s e c u r i t y   c o n t e x t   ‘   / v a r / c t d b /   ’   #  c h c o n   - r v   - u   s y s t e m _ u   - r   o b j e c t _ r   - t   c t d b d _ v a r _ l i b _ t   / v a r / l i b / c t d b /   c h a n g i n g   s e c u r i t y   c o n t e x t   ‘   / v a r / l i b / c t d b /   ’   n o d e   c l u s t e r  ,   p e r f o r m   s t e p s  :   s e t   d i r e c t o r i e s   c t d b   l o c k   f i l e   p u b l i c   s h a r e   .   [  r o o t   @   z 1   ~  ]   #  m k d i r   - p   / m n t / g f s 2 s h a r e / c t d b /   [  r o o t   @   z 1   ~  ]   #  m k d i r   - p   / m n t / g f s 2 s h a r e / p u b l i c /   u p d a t e   s e l i n u x   c o n t e x t s   g f s 2   s h a r e   .   [  r o o t   @   z 1   ~  ]   #  c h o w n   s m b g u e s t  :   s m b g u e s t   / m n t / g f s 2 s h a r e / p u b l i c /   [  r o o t   @   z 1   ~  ]   #  c h m o d   7 5 5   / m n t / g f s 2 s h a r e / p u b l i c /   [  r o o t   @   z 1   ~  ]   #  c h c o n   - r v   - t   c t d b d _ v a r _ r u n _ t   / m n t / g f s 2 s h a r e / c t d b /   c h a n g i n g   s e c u r i t y   c o n t e x t   ‘   / m n t / g f s 2 s h a r e / c t d b /   ’   [  r o o t   @   z 1   ~  ]   #  c h c o n   - r v   - u   s y s t e m _ u   - r   o b j e c t _ r   - t   s a m b a _ s h a r e _ t   / m n t / g f s 2 s h a r e / p u b l i c /   c h a n g i n g   s e c u r i t y   c o n t e x t   ‘   / m n t / g f s 2 s h a r e / p u b l i c   ’
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 4 .   c o n f i g u r i n g   s a m b a   c l u s t e r   r e s o u r c e s   s e c t i o n   p r o c e d u r e   c o n f i g u r i n g   s a m b a   c l u s t e r   r e s o u r c e s   c a s e   .   p r o c e d u r e   c r e a t e s   s n a p s h o t   c l u s t e r  ' s   c i b   f i l e   n a m e d   s a m b a . c i b   a d d s   r e s o u r c e s   t e s t   f i l e   c o n f i g u r i n g   d i r e c t l y   r u n n i n g   c l u s t e r   .   r e s o u r c e s   c o n s t r a i n t s   c o n f i g u r e d  ,   p r o c e d u r e   p u s h e s   c o n t e n t s   s a m b a . c i b   r u n n i n g   c l u s t e r   c o n f i g u r a t i o n   f i l e   .   n o d e   c l u s t e r  ,   r u n   p r o c e d u r e   .   c r e a t e   s n a p s h o t   c i b   f i l e  ,   c l u s t e r   c o n f i g u r a t i o n   f i l e   .   [  r o o t   @   z 1   ~  ]   #  p c s   c l u s t e r   c i b   s a m b a . c i b   c r e a t e   c t d b   r e s o u r c e   s a m b a   .   c r e a t e   r e s o u r c e   c l o n e d   r e s o u r c e   r u n   c l u s t e r   n o d e s   .   [  r o o t   @   z 1   ~  ]   #  p c s   - f   s a m b a . c i b   r e s o u r c e   c r e a t e   c t d b   o c f  :   h e a r t b e a t  :   c t d b   \   c t d b _ r e c o v e r y _ l o c k =  ' '   / m n t / g f s 2 s h a r e / c t d b / c t d b . l o c k  ' '   \   c t d b _ d b d i r = / v a r / c t d b   c t d b _ s o c k e t = / t m p / c t d b . s o c k e t   \   c t d b _ l o g f i l e = / v a r / l o g / c t d b . l o g   \   m o n i t o r   i n t e r v a l = 1 0   t i m e o u t = 3 0   s t a r t   t i m e o u t = 9 0   \   s t o p   t i m e o u t = 1 0 0   - -   c l o n e   c r e a t e   c l o n e d   s a m b a   s e r v e r   .   [  r o o t   @   z 1   ~  ]   #  p c s   - f   s a m b a . c i b   r e s o u r c e   c r e a t e   s a m b a   s y s t e m d  :   s m b   - -   c l o n e   c r e a t e   c o l o c a t i o n   o r d e r   c o n s t r a i n t s   c l u s t e r   r e s o u r c e s   .   s t a r t u p   o r d e r   f i l e s y s t e m   r e s o u r c e  ,   c t d b   r e s o u r c e  ,   s a m b a   r e s o u r c e   .   [  r o o t   @   z 1   ~  ]   #  p c s   - f   s a m b a . c i b   c o n s t r a i n t   o r d e r   f s - c l o n e   c t d b - c l o n e   a d d i n g   f s - c l o n e   c t d b - c l o n e   (  k i n d  :   m a n d a t o r y  )   (  o p t i o n s  :   f i r s t - a c t i o n = s t a r t   t h e n - a c t i o n = s t a r t  )   [  r o o t   @   z 1   ~  ]   #  p c s   - f   s a m b a . c i b   c o n s t r a i n t   o r d e r   c t d b - c l o n e   s a m b a - c l o n e   a d d i n g   c t d b - c l o n e   s a m b a - c l o n e   (  k i n d  :   m a n d a t o r y  )   (  o p t i o n s  :   f i r s t - a c t i o n = s t a r t   t h e n - a c t i o n = s t a r t  )   [  r o o t   @   z 1   ~  ]   #  p c s   - f   s a m b a . c i b   c o n s t r a i n t   c o l o c a t i o n   a d d   c t d b - c l o n e   f s - c l o n e   [  r o o t   @   z 1   ~  ]   #  p c s   - f   s a m b a . c i b   c o n s t r a i n t   c o l o c a t i o n   a d d   s a m b a - c l o n e   c t d b - c l o n e   p u s h   c o n t e n t   c i b   s n a p s h o t   c l u s t e r   .   [  r o o t   @   z 1   ~  ]   #  p c s   c l u s t e r   c i b - p u s h   s a m b a . c i b   c i b   u p d a t e d   c h e c k   s t a t u s   c l u s t e r   v e r i f y   r e s o u r c e   r u n n i n g   .   n o t e   r e d   e n t e r p r i s e   l i n u x   7 . 4   c o u p l e   m i n u t e s   c t d b   s t a r t   s a m b a  ,   e x p o r t   s h a r e s  ,   s t a b i l i z e   .   c h e c k   c l u s t e r   s t a t u s   p r o c e s s   c o m p l e t e d  ,   m e s s a g e   c t d b   s t a t u s   c a l l   f a i l e d   .   p r o c e s s   c o m p l e t e d  ,   c l e a r   m e s s a g e   d i s p l a y   r u n n i n g   p c s   r e s o u r c e   c l e a n u p   c t d b - c l o n e   c o m m a n d   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   c l u s t e r  :   m y _ c l u s t e r   s t a c k  :   c o r o s y n c   c u r r e n t   d c  :   z 1 . e x a m p l e . c o m   (  v e r s i o n   1 . 1 . 1 6 - 1 2 . e l 7 _ 4 . 2 - 9 4 f f 4 d f  )   -   p a r t i t i o n   q u o r u m   u p d a t e d  :   t h u   o c t   1 9   1 8: 1 7: 0 7   2 0 1 7   c h a n g e  :   t h u   o c t   1 9   1 8: 1 6: 5 0   2 0 1 7   h a c l u s t e r   c r m d   z 1 . e x a m p l e . c o m   2   n o d e s   c o n f i g u r e d   1 1   r e s o u r c e s   c o n f i g u r e d   o n l i n e  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   f u l l   l i s t   r e s o u r c e s  :   m y a p c   (  s t o n i t h  :   f e n c e _ a p c _ s n m p  )  :   s t a r t e d   z 1 . e x a m p l e . c o m   c l o n e   s e t  :   d l m - c l o n e   [  d l m  ]   s t a r t e d  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   c l o n e   s e t  :   c l v m d - c l o n e   [  c l v m d  ]   s t a r t e d  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   c l o n e   s e t  :   f s - c l o n e   [  f s  ]   s t a r t e d  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   c l o n e   s e t  :   c t d b - c l o n e   [  c t d b  ]   s t a r t e d  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   c l o n e   s e t  :   s a m b a - c l o n e   [  s a m b a  ]   s t a r t e d  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 5 .   t e s t i n g   r e s o u r c e   c o n f i g u r a t i o n   s a m b a   c o n f i g u r a t i o n   s u c c e s s f u l  ,   m o u n t   s a m b a   s h a r e   n o d e   c l u s t e r   .   p r o c e d u r e   m o u n t s   s a m b a   s h a r e   .   a d d   e x i s t i n g   u s e r   c l u s t e r   n o d e   s m b p a s s w d   f i l e   a s s i g n   p a s s w o r d   .  ,   e x i s t i n g   u s e r   s m b u s e r   .   [  r o o t   @   z 1   ~  ]   #  s m b p a s s w d   - a   s m b u s e r   s m b   p a s s w o r d  :   r e t y p e   s m b   p a s s w o r d  :   a d d e d   u s e r   s m b u s e r   m o u n t   s a m b a   s h a r e  :   [  r o o t   @   z 1   ~  ]   #  m k d i r   / m n t / s a m b a s h a r e   [  r o o t   @   z 1   ~  ]   #  m o u n t   - t   c i f s   - o   u s e r = s m b u s e r   / / 1 9 8 . 1 6 2 . 1 . 1 5 1 / p u b l i c   / m n t / s a m b a s h a r e   p a s s w o r d   s m b u s e r   @   / / 1 9 8 . 1 6 2 . 1 . 1 5 1 / p u b l i c  :   *   *   *   *   *   *   *   *   c h e c k   f i l e   s y s t e m   m o u n t e d  :   [  r o o t   @   z 1   ~  ]   #  m o u n t   |   g r e p   / m n t / s a m b a s h a r e   / / 1 9 8 . 1 6 2 . 1 . 1 5 1 / p u b l i c   / m n t / s a m b a s h a r e   t y p e   c i f s   (  r w  ,   r e l a t i m e  ,   v e r s = 1 . 0  ,   c a c h e = s t r i c t  ,   u s e r n a m e = s m b u s e r  ,   d o m a i n = l i n u x s e r v e r  ,   u i d = 0  ,   n o f o r c e u i d  ,   g i d = 0  ,   n o f o r c e g i d  ,   a d d r = 1 0 . 3 7 . 1 6 7 . 2 0 5  ,   u n i x  ,   p o s i x p a t h s  ,   s e r v e r i n o  ,   m a p p o s i x  ,   a c l  ,   r s i z e = 1 0 4 8 5 7 6  ,   w s i z e = 6 5 5 3 6  ,   e c h o _ i n t e r v a l = 6 0  ,   a c t i m e o = 1  )   c h e c k   s a m b a   r e c o v e r y  ,   p e r f o r m   p r o c e d u r e   .   m a n u a l l y   s t o p   c t d b   r e s o u r c e   c o m m a n d  :   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   d e b u g - s t o p   c t d b   s t o p   r e s o u r c e  ,   s y s t e m   r e c o v e r   s e r v i c e   .   c h e c k   c l u s t e r   s t a t u s   p c s   s t a t u s   c o m m a n d   .   c t d b - c l o n e   r e s o u r c e   s t a r t e d  ,   c t d b _ m o n i t o r   f a i l u r e   .   [  r o o t   @   z 1   ~  ]   #  p c s   s t a t u s   . . .   c l o n e   s e t  :   c t d b - c l o n e   [  c t d b  ]   s t a r t e d  :   [  z 1 . e x a m p l e . c o m   z 2 . e x a m p l e . c o m  ]   . . .   f a i l e d   a c t i o n s  :   *   c t d b _ m o n i t o r _ 1 0 0 0 0   z 1 . e x a m p l e . c o m  ' u n k n o w n   e r r o r  '   (  1  )  :   c a l l = 1 2 6  ,   s t a t u s = c o m p l e t e  ,   e x i t r e a s o n =' c t d b   s t a t u s   c a l l   f a i l e d  :   c o n n e c t   ( )   f a i l e d  ,   e r r n o = 1 1 1  '  ,   l a s t - r c - c h a n g e =' t h u   o c t   1 9   1 8: 3 9: 5 1   2 0 1 7  '  ,   q u e u e d = 0 m s  ,   e x e c = 0 m s   . . .   c l e a r   e r r o r   s t a t u s  ,   e n t e r   c o m m a n d   c l u s t e r   n o d e s  :   [  r o o t   @   z 1   ~  ]   #  p c s   r e s o u r c e   c l e a n u p   c t d b - c l o n e   a p p e n d i x   a .   r e v i s i o n   h i s t o r y   r e v i s i o n   h i s t o r y   r e v i s i o n   6 - 1   w e d   a u g   7   2 0 1 9   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 7   p u b l i c a t i o n   .   r e v i s i o n   5 - 2   t h u   o c t   4   2 0 1 8   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 6   p u b l i c a t i o n   .   r e v i s i o n   4 - 2   w e d   1 4   2 0 1 8   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 5   p u b l i c a t i o n   .   r e v i s i o n   4 - 1   t h u   d e c   1 4   2 0 1 7   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 5   b e t a   p u b l i c a t i o n   .   r e v i s i o n   3 - 4   w e d   a u g   1 6   2 0 1 7   s t e v e n   l e v i n e   u p d a t e d   v e r s i o n   7 . 4 .   r e v i s i o n   3 - 3   w e d   j u l   1 9   2 0 1 7   s t e v e n   l e v i n e   d o c u m e n t   v e r s i o n   7 . 4   p u b l i c a t i o n   .   r e v i s i o n   3 - 1   w e d   1 0   2 0 1 7   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 4   b e t a   p u b l i c a t i o n   .   r e v i s i o n   2 - 6   a p r   1 7   2 0 1 7   s t e v e n   l e v i n e   u p d a t e   7 . 3   r e v i s i o n   2 - 4   o c t   1 7   2 0 1 6   s t e v e n   l e v i n e   v e r s i o n   7 . 3   p u b l i c a t i o n   .   r e v i s i o n   2 - 3   f r i   a u g   1 2   2 0 1 6   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 3   b e t a   p u b l i c a t i o n   .   r e v i s i o n   1 . 2 - 3   n o v   9   2 0 1 5   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 2   p u b l i c a t i o n   .   r e v i s i o n   1 . 2 - 2   a u g   1 8   2 0 1 5   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 2   b e t a   p u b l i c a t i o n   .   r e v i s i o n   1 . 1 - 1 9   f e b   1 6   2 0 1 5   s t e v e n   l e v i n e   v e r s i o n   7 . 1   r e l e a s e   r e v i s i o n   1 . 1 - 1 0   t h u   d e c   1 1   2 0 1 4   s t e v e n   l e v i n e   v e r s i o n   7 . 1   b e t a   r e l e a s e   r e v i s i o n   0 . 1 - 3 3   j u n   2   2 0 1 4   s t e v e n   l e v i n e   v e r s i o n   7 . 0   r e l e a s e   l e g a l   n o t i c e   c o p y r i g h t   ©   2 0 1 8   r e d  ,   i n c .   d o c u m e n t   l i c e n s e d   r e d   c r e a t i v e   c o m m o n s   a t t r i b u t i o n - s h a r e a l i k e   3 . 0   u n p o r t e d   l i c e n s e   .   d i s t r i b u t e   d o c u m e n t  ,   m o d i f i e d   v e r s i o n  ,   p r o v i d e   a t t r i b u t i o n   r e d  ,   i n c .   p r o v i d e   l i n k   o r i g i n a l   .   d o c u m e n t   m o d i f i e d  ,   r e d   t r a d e m a r k s   r e m o v e d   .   r e d  ,   l i c e n s o r   d o c u m e n t  ,   w a i v e s   e n f o r c e  ,   a g r e e s   a s s e r t  ,   s e c t i o n   4 d   c c - b y - s a   f u l l e s t   e x t e n t   p e r m i t t e d   a p p l i c a b l e   l a w   .   r e d  ,   r e d   e n t e r p r i s e   l i n u x  ,   s h a d o w m a n   l o g o  ,   r e d   l o g o  ,   j b o s s  ,   o p e n s h i f t  ,   f e d o r a  ,   i n f i n i t y   l o g o  ,   r h c e   t r a d e m a r k s   r e d  ,   i n c .  ,   r e g i s t e r e d   u n i t e d   s t a t e s   c o u n t r i e s   .   l i n u x ®   r e g i s t e r e d   t r a d e m a r k   l i n u s   t o r v a l d s   u n i t e d   s t a t e s   c o u n t r i e s   .   j a v a ®   r e g i s t e r e d   t r a d e m a r k   o r a c l e   a n d / o r   a f f i l i a t e s   .   x f s ®   t r a d e m a r k   s i l i c o n   g r a p h i c s   i n t e r n a t i o n a l   c o r p .   s u b s i d i a r i e s   u n i t e d   s t a t e s   a n d / o r   c o u n t r i e s   .   m y s q l ®   r e g i s t e r e d   t r a d e m a r k   m y s q l   u n i t e d   s t a t e s  ,   e u r o p e a n   u n i o n   c o u n t r i e s   .   n o d e . j s ®   o f f i c i a l   t r a d e m a r k   j o y e n t   .   r e d   f o r m a l l y   r e l a t e d   e n d o r s e d   o f f i c i a l   j o y e n t   n o d e . j s   o p e n   s o u r c e   c o m m e r c i a l   p r o j e c t   .   o p e n s t a c k ®   w o r d   m a r k   o p e n s t a c k   l o g o   r e g i s t e r e d   t r a d e m a r k s / s e r v i c e   m a r k s   t r a d e m a r k s / s e r v i c e   m a r k s   o p e n s t a c k   f o u n d a t i o n  ,   u n i t e d   s t a t e s   c o u n t r i e s   o p e n s t a c k   f o u n d a t i o n  ' s   p e r m i s s i o n   .   a f f i l i a t e d  ,   e n d o r s e d   s p o n s o r e d   o p e n s t a c k   f o u n d a t i o n  ,   o p e n s t a c k   c o m m u n i t y   .   t r a d e m a r k s   p r o p e r t y   r e s p e c t i v e   o w n e r s  .
