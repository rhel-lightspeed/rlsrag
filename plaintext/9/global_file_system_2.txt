a b s t r a c t   b o o k   i n f o r m a t i o n   c o n f i g u r i n g   m a i n t a i n i n g   r e d   g f s 2   (  r e d   g l o b a l   f i l e   s y s t e m   2  )   r e d   e n t e r p r i s e   l i n u x   7  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   1 .   g f s 2   o v e r v i e w   r e d   g f s 2   f i l e   s y s t e m   6 4 - b i t   s y m m e t r i c   c l u s t e r   f i l e   s y s t e m   s h a r e d   n a m e s p a c e   m a n a g e s   c o h e r e n c y   m u l t i p l e   n o d e s   s h a r i n g   c o m m o n   b l o c k   d e v i c e   .   g f s 2   f i l e   s y s t e m   i n t e n d e d   p r o v i d e   f e a t u r e   s e t   c l o s e   p o s s i b l e   l o c a l   f i l e   s y s t e m  ,   t i m e   e n f o r c i n g   f u l l   c l u s t e r   c o h e r e n c y   n o d e s   .   c a s e s  ,   l i n u x   f i l e   s y s t e m   a p i   c l u s t e r e d   n a t u r e   g f s 2   t o t a l l y   t r a n s p a r e n t  ;  ,   p r o g r a m s   p o s i x   l o c k s   g f s 2   a v o i d   g e t l k   f u n c t i o n  ,   c l u s t e r e d   e n v i r o n m e n t  ,   p r o c e s s   i d   d i f f e r e n t   n o d e   c l u s t e r   .   c a s e s  ,   f u n c t i o n a l i t y   g f s 2   f i l e   s y s t e m   i d e n t i c a l   l o c a l   f i l e   s y s t e m   .   r e d   e n t e r p r i s e   l i n u x   (  r h e l  )   r e s i l i e n t   s t o r a g e   a d d - o n   g f s 2  ,   d e p e n d s   r h e l   h i g h   a v a i l a b i l i t y   a d d - o n   p r o v i d e   c l u s t e r   m a n a g e m e n t   r e q u i r e d   g f s 2   .   i n f o r m a t i o n   h i g h   a v a i l a b i l i t y   a d d - o n   c o n f i g u r i n g   m a n a g i n g   r e d   c l u s t e r   .   g f s 2 . k o   k e r n e l   m o d u l e   i m p l e m e n t s   g f s 2   f i l e   s y s t e m   l o a d e d   g f s 2   c l u s t e r   n o d e s   .   p e r f o r m a n c e   g f s 2  ,   i m p o r t a n t   a c c o u n t   p e r f o r m a n c e   c o n s i d e r a t i o n s   s t e m   u n d e r l y i n g   d e s i g n   .   l o c a l   f i l e   s y s t e m  ,   g f s 2   r e l i e s   p a g e   c a c h e   o r d e r   i m p r o v e   p e r f o r m a n c e   l o c a l   c a c h i n g   f r e q u e n t l y   d a t a   .   o r d e r   m a i n t a i n   c o h e r e n c y   n o d e s   c l u s t e r  ,   c a c h e   c o n t r o l   p r o v i d e d   g l o c k   s t a t e   m a c h i n e   .   i n f o r m a t i o n   g l o c k s   p e r f o r m a n c e   i m p l i c a t i o n s  ,   s e c t i o n   2 . 9  ,   “   g f s 2   n o d e   l o c k i n g   ”   .   c h a p t e r   b a s i c  ,   a b b r e v i a t e d   i n f o r m a t i o n   b a c k g r o u n d   u n d e r s t a n d   g f s 2  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 1 .   g f s 2   s u p p o r t   l i m i t s   t a b l e   1 . 1  ,   “   g f s 2   s u p p o r t   l i m i t s   ”   s u m m a r i z e s   c u r r e n t   m a x i m u m   f i l e   s y s t e m   s i z e   n u m b e r   n o d e s   g f s 2   s u p p o r t s   .   g f s 2   b a s e d   6 4 - b i t   a r c h i t e c t u r e  ,   t h e o r e t i c a l l y   a c c o m m o d a t e   8   e b   f i l e   s y s t e m   .   s y s t e m   r e q u i r e s   l a r g e r   g f s 2   f i l e   s y s t e m s   c u r r e n t l y   s u p p o r t e d  ,   c o n t a c t   r e d   s e r v i c e   r e p r e s e n t a t i v e   .   n o t e   d e t e r m i n i n g   s i z e   f i l e   s y s t e m  ,   c o n s i d e r   r e c o v e r y   .   r u n n i n g   f s c k . g f s 2   c o m m a n d   l a r g e   f i l e   s y s t e m   l o n g   t i m e   c o n s u m e   l a r g e   a m o u n t   m e m o r y   .   a d d i t i o n a l l y  ,   e v e n t   d i s k   d i s k   s u b s y s t e m   f a i l u r e  ,   r e c o v e r y   t i m e   l i m i t e d   s p e e d   b a c k u p   m e d i a   .   i n f o r m a t i o n   a m o u n t   m e m o r y   f s c k . g f s 2   c o m m a n d   r e q u i r e s  ,   s e c t i o n   3 . 1 0  ,   “   r e p a i r i n g   g f s 2   f i l e   s y s t e m   ”   .   g f s 2   f i l e   s y s t e m   l v m  ,   r e d   s u p p o r t s   g f s 2   f i l e   s y s t e m s   c r e a t e d   c l v m   l o g i c a l   v o l u m e   .   c l v m   i n c l u d e d   r e s i l i e n t   s t o r a g e   a d d - o n   .   c l u s t e r - w i d e   i m p l e m e n t a t i o n   l v m  ,   e n a b l e d   c l v m   d a e m o n   c l v m d  ,   m a n a g e s   l v m   l o g i c a l   v o l u m e s   c l u s t e r   .   d a e m o n   m a k e s   p o s s i b l e   l v m 2   m a n a g e   l o g i c a l   v o l u m e s   c l u s t e r  ,   a l l o w i n g   n o d e s   c l u s t e r   s h a r e   l o g i c a l   v o l u m e s   .   i n f o r m a t i o n   l v m   v o l u m e   m a n a g e r  ,   l o g i c a l   v o l u m e   m a n a g e r   a d m i n i s t r a t i o n   .   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 2 .   c h a n g e d   f e a t u r e s   s e c t i o n   l i s t s   c h a n g e d   f e a t u r e s   g f s 2   f i l e   s y s t e m   g f s 2   d o c u m e n t a t i o n   i n c l u d e d   i n i t i a l   s u b s e q u e n t   r e l e a s e s   r e d   e n t e r p r i s e   l i n u x   7  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 2 . 1 .   c h a n g e d   f e a t u r e s   r e d   e n t e r p r i s e   l i n u x   7 . 0   r e d   e n t e r p r i s e   l i n u x   7 . 0   i n c l u d e s   d o c u m e n t a t i o n   f e a t u r e   u p d a t e s   c h a n g e s   .   r e d   e n t e r p r i s e   l i n u x   7  ,   c l u s t e r   i n c l u d e s   g f s 2   f i l e   s y s t e m   r e q u i r e s   c o n f i g u r e   c l u s t e r   p a c e m a k e r   p r o c e d u r e   d e s c r i b e d   c h a p t e r   5  ,   c o n f i g u r i n g   g f s 2   f i l e   s y s t e m   c l u s t e r   .   g f s 2 _ t o o l   c o m m a n d   s u p p o r t e d   r e d   e n t e r p r i s e   l i n u x   7 .   r e p l a c e m e n t   f u n c t i o n s   g f s 2 _ t o o l   s u m m a r i z e d   s e c t i o n   1 . 5  ,   “   r e p l a c e m e n t   f u n c t i o n s   g f s 2 _ t o o l   r e d   e n t e r p r i s e   l i n u x   7   ”  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 2 . 2 .   c h a n g e d   f e a t u r e s   r e d   e n t e r p r i s e   l i n u x   7 . 1   r e d   e n t e r p r i s e   l i n u x   7 . 1  ,   a p p e n d i x  ,   g f s 2   p e r f o r m a n c e   a n a l y s i s   p e r f o r m a n c e   c o - p i l o t   u p d a t e d   .   a d d i t i o n  ,   s m a l l   t e c h n i c a l   c o r r e c t i o n s   c l a r i f i c a t i o n s   m a d e   d o c u m e n t  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 2 . 3 .   c h a n g e d   f e a t u r e s   r e d   e n t e r p r i s e   l i n u x   7 . 2   s m a l l   t e c h n i c a l   c o r r e c t i o n s   c l a r i f i c a t i o n s   m a d e   d o c u m e n t  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 2 . 4 .   c h a n g e d   f e a t u r e s   r e d   e n t e r p r i s e   l i n u x   7 . 4   r e d   e n t e r p r i s e   l i n u x   7 . 4  ,   s e c u r i t y   e n h a n c e d   l i n u x   (  s e l i n u x  )   s u p p o r t e d   g f s 2   f i l e   s y s t e m s   .   i n f o r m a t i o n   s e l i n u x   g f s 2  ,   s e c t i o n   2 . 5 . 3  ,   “   s e l i n u x   g f s 2   ”  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 3 .   s e t t i n g   g f s 2   i n s t a l l   s e t   g f s 2  ,   n o t e   k e y   c h a r a c t e r i s t i c s   g f s 2   f i l e   s y s t e m s  :   n o t e   r e c o m m e n d a t i o n s   c r e a t i n g  ,  ,   m a i n t a i n i n g   g f s 2   f i l e   s y s t e m   .   c h a p t e r   2  ,   g f s 2   c o n f i g u r a t i o n   o p e r a t i o n a l   c o n s i d e r a t i o n s  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 4 .   i n s t a l l i n g   g f s 2   a d d i t i o n   p a c k a g e s   r e q u i r e d   r e d   h i g h   a v a i l a b i l i t y   a d d - o n  ,   i n s t a l l   g f s 2 - u t i l s   p a c k a g e   g f s 2   l v m 2 - c l u s t e r   p a c k a g e   c l u s t e r e d   l o g i c a l   v o l u m e   m a n a g e r   (  c l v m  )   .   l v m 2 - c l u s t e r   g f s 2 - u t i l s   p a c k a g e s   p a r t   r e s i l i e n t s t o r a g e   c h a n n e l  ,   e n a b l e d   i n s t a l l i n g   p a c k a g e s   .   y u m   i n s t a l l   c o m m a n d   i n s t a l l   r e d   h i g h   a v a i l a b i l i t y   a d d - o n   s o f t w a r e   p a c k a g e s  :   #  y u m   i n s t a l l   l v m 2 - c l u s t e r   g f s 2 - u t i l s   g e n e r a l   i n f o r m a t i o n   r e d   h i g h   a v a i l a b i l i t y   a d d - o n   c l u s t e r   a d m i n i s t r a t i o n  ,   c l u s t e r   a d m i n i s t r a t i o n   m a n u a l  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1 . 5 .   r e p l a c e m e n t   f u n c t i o n s   g f s 2 _ t o o l   r e d   e n t e r p r i s e   l i n u x   7   g f s 2 _ t o o l   c o m m a n d   s u p p o r t e d   r e d   e n t e r p r i s e   l i n u x   7 .   t a b l e   1 . 2  ,   “   g f s 2 _ t o o l   e q u i v a l e n t   f u n c t i o n s   r e d   e n t e r p r i s e   l i n u x   7   ”   s u m m a r i z e s   e q u i v a l e n t   f u n c t i o n a l i t y   g f s 2 _ t o o l   c o m m a n d   o p t i o n s   r e d   e n t e r p r i s e   l i n u x   7  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   2 .   g f s 2   c o n f i g u r a t i o n   o p e r a t i o n a l   c o n s i d e r a t i o n s   g l o b a l   f i l e   s y s t e m   2   (  g f s 2  )   f i l e   s y s t e m   c o m p u t e r s   (  “   n o d e s   ”  )   c l u s t e r   c o o p e r a t i v e l y   s h a r e   s t o r a g e   .   a c h i e v e   c o o p e r a t i o n   m a i n t a i n   d a t a   c o n s i s t e n c y   n o d e s  ,   n o d e s   e m p l o y   c l u s t e r - w i d e   l o c k i n g   s c h e m e   f i l e   s y s t e m   r e s o u r c e s   .   l o c k i n g   s c h e m e   c o m m u n i c a t i o n   p r o t o c o l s   t c p / i p   e x c h a n g e   l o c k i n g   i n f o r m a t i o n   .   i m p r o v e   p e r f o r m a n c e   r e c o m m e n d a t i o n s   d e s c r i b e d   c h a p t e r  ,   i n c l u d i n g   r e c o m m e n d a t i o n s   c r e a t i n g  ,  ,   m a i n t a i n i n g   g f s 2   f i l e   s y s t e m   .   i m p o r t a n t
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 1 .   f o r m a t t i n g   c o n s i d e r a t i o n s   s e c t i o n   r e c o m m e n d a t i o n s   f o r m a t   g f s 2   f i l e   s y s t e m   o p t i m i z e   p e r f o r m a n c e  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 1 . 1 .   f i l e   s y s t e m   s i z e  :   s m a l l e r   g f s 2   b a s e d   6 4 - b i t   a r c h i t e c t u r e  ,   t h e o r e t i c a l l y   a c c o m m o d a t e   8   e b   f i l e   s y s t e m   .  ,   c u r r e n t   s u p p o r t e d   m a x i m u m   s i z e   g f s 2   f i l e   s y s t e m   6 4 - b i t   h a r d w a r e   1 0 0 t b   .   n o t e   g f s 2   l a r g e   f i l e   s y s t e m s   p o s s i b l e  ,   r e c o m m e n d e d   .   r u l e   t h u m b   g f s 2   s m a l l e r  :   1 0   1 t b   f i l e   s y s t e m s   1 0 t b   f i l e   s y s t e m   .   r e a s o n s   g f s 2   f i l e   s y s t e m s   s m a l l  :   t i m e   r e q u i r e d   b a c k   f i l e   s y s t e m   .   t i m e   r e q u i r e d   c h e c k   f i l e   s y s t e m   f s c k . g f s 2   c o m m a n d   .   m e m o r y   r e q u i r e d   c h e c k   f i l e   s y s t e m   f s c k . g f s 2   c o m m a n d   .   a d d i t i o n  ,   f e w e r   r e s o u r c e   g r o u p s   m a i n t a i n   p e r f o r m a n c e   .   c o u r s e  ,   m a k e   g f s 2   f i l e   s y s t e m   s m a l l  ,   r u n   s p a c e  ,   c o n s e q u e n c e s   .   c o n s i d e r   c a s e s   d e c i d i n g   s i z e  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 1 . 2 .   b l o c k   s i z e  :   d e f a u l t   (  4 k  )   b l o c k s   p r e f e r r e d   m k f s . g f s 2   c o m m a n d   a t t e m p t s   e s t i m a t e   o p t i m a l   b l o c k   s i z e   b a s e d   d e v i c e   t o p o l o g y   .   g e n e r a l  ,   4 k   b l o c k s   p r e f e r r e d   b l o c k   s i z e   4 k   d e f a u l t   p a g e   s i z e   (  m e m o r y  )   l i n u x   .   u n l i k e   f i l e   s y s t e m s  ,   g f s 2   o p e r a t i o n s   4 k   k e r n e l   b u f f e r s   .   b l o c k   s i z e   4 k  ,   k e r n e l   w o r k   m a n i p u l a t e   b u f f e r s   .   r e c o m m e n d e d   d e f a u l t   b l o c k   s i z e  ,   y i e l d   h i g h e s t   p e r f o r m a n c e   .   d i f f e r e n t   b l o c k   s i z e   r e q u i r e   e f f i c i e n t   s t o r a g e   s m a l l   f i l e s  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 1 . 3 .   n u m b e r   j o u r n a l s  :   n o d e   m o u n t s   g f s 2   r e q u i r e s   j o u r n a l   n o d e   c l u s t e r   m o u n t   f i l e   s y s t e m   .  ,   1 6 - n o d e   c l u s t e r   m o u n t   f i l e   s y s t e m   n o d e s  ,   j o u r n a l s   .   m o u n t   n o d e  ,   a d d   j o u r n a l   g f s 2 _ j a d d   c o m m a n d   .   g f s 2  ,   a d d   j o u r n a l s   f l y  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 1 . 4 .   j o u r n a l   s i z e  :   d e f a u l t   (  1 2 8 m b  )   o p t i m a l   r u n   m k f s . g f s 2   c o m m a n d   c r e a t e   g f s 2   f i l e   s y s t e m  ,   s p e c i f y   s i z e   j o u r n a l s   .   s p e c i f y   s i z e  ,   d e f a u l t   1 2 8 m b  ,   o p t i m a l   a p p l i c a t i o n s   .   s y s t e m   a d m i n i s t r a t o r s   1 2 8 m b   e x c e s s i v e   t e m p t e d   r e d u c e   s i z e   j o u r n a l   m i n i m u m   8 m b   c o n s e r v a t i v e   3 2 m b   .   w o r k  ,   s e v e r e l y   i m p a c t   p e r f o r m a n c e   .   j o u r n a l i n g   f i l e   s y s t e m s  ,   t i m e   g f s 2   w r i t e s   m e t a d a t a  ,   m e t a d a t a   c o m m i t t e d   j o u r n a l   p u t   p l a c e   .   e n s u r e s   s y s t e m   c r a s h e s   l o s e s   p o w e r  ,   r e c o v e r   m e t a d a t a   j o u r n a l   a u t o m a t i c a l l y   r e p l a y e d   m o u n t   t i m e   .  ,   f i l e   s y s t e m   a c t i v i t y   f i l l   8 m b   j o u r n a l  ,   j o u r n a l   f u l l  ,   p e r f o r m a n c e   s l o w s   g f s 2   w a i t   w r i t e s   s t o r a g e   .   g e n e r a l l y   r e c o m m e n d e d   d e f a u l t   j o u r n a l   s i z e   1 2 8 m b   .   f i l e   s y s t e m   s m a l l   ( ,   5 g b  )  ,   1 2 8 m b   j o u r n a l   i m p r a c t i c a l   .   l a r g e r   f i l e   s y s t e m   a f f o r d   s p a c e  ,   2 5 6 m b   j o u r n a l s   i m p r o v e   p e r f o r m a n c e  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 1 . 5 .   s i z e   n u m b e r   r e s o u r c e   g r o u p s   g f s 2   f i l e   s y s t e m   c r e a t e d   m k f s . g f s 2   c o m m a n d  ,   d i v i d e s   s t o r a g e   u n i f o r m   s l i c e s   r e s o u r c e   g r o u p s   .   a t t e m p t s   e s t i m a t e   o p t i m a l   r e s o u r c e   g r o u p   s i z e   (  r a n g i n g   3 2 m b   2 g b  )   .   o v e r r i d e   d e f a u l t   - r   o p t i o n   m k f s . g f s 2   c o m m a n d   .   o p t i m a l   r e s o u r c e   g r o u p   s i z e   d e p e n d s   f i l e   s y s t e m   .   c o n s i d e r   f u l l   s e v e r e l y   f r a g m e n t e d   .   e x p e r i m e n t   d i f f e r e n t   r e s o u r c e   g r o u p   s i z e s   r e s u l t s   o p t i m a l   p e r f o r m a n c e   .   p r a c t i c e   e x p e r i m e n t   t e s t   c l u s t e r   d e p l o y i n g   g f s 2   f u l l   p r o d u c t i o n   .   f i l e   s y s t e m   r e s o u r c e   g r o u p s   (  s m a l l  )  ,   b l o c k   a l l o c a t i o n s   w a s t e   t i m e   s e a r c h i n g   t e n s   t h o u s a n d s   (  h u n d r e d s   t h o u s a n d s  )   r e s o u r c e   g r o u p s   f r e e   b l o c k   .   f u l l   f i l e   s y s t e m  ,   r e s o u r c e   g r o u p s   s e a r c h e d  ,   r e q u i r e s   c l u s t e r - w i d e   l o c k   .   l e a d s   s l o w   p e r f o r m a n c e   .  ,  ,   f i l e   s y s t e m   r e s o u r c e   g r o u p s   (  b i g  )  ,   b l o c k   a l l o c a t i o n s   c o n t e n d   r e s o u r c e   g r o u p   l o c k  ,   i m p a c t s   p e r f o r m a n c e   .  ,   1 0 g b   f i l e   s y s t e m   c a r v e d   r e s o u r c e   g r o u p s   2 g b  ,   n o d e s   c l u s t e r   f i g h t   r e s o u r c e   g r o u p s   f i l e   s y s t e m   c a r v e d   3 2 0   r e s o u r c e   g r o u p s   3 2 m b   .   p r o b l e m   e x a c e r b a t e d   f i l e   s y s t e m   f u l l   b l o c k   a l l o c a t i o n   r e s o u r c e   g r o u p s   f i n d s   f r e e   b l o c k   .   g f s 2   m i t i g a t e   p r o b l e m   w a y s  :  ,   r e s o u r c e   g r o u p   c o m p l e t e l y   f u l l  ,   r e m e m b e r s   a v o i d   c h e c k i n g   f u t u r e   a l l o c a t i o n s   (  b l o c k   f r e e d  )   .   d e l e t e   f i l e s  ,   c o n t e n t i o n   s e v e r e   .  ,   a p p l i c a t i o n   c o n s t a n t l y   d e l e t i n g   b l o c k s   a l l o c a t i n g   b l o c k s   f i l e   s y s t e m   f u l l  ,   c o n t e n t i o n   h i g h   s e v e r e l y   i m p a c t   p e r f o r m a n c e   .  ,   b l o c k s   a d d e d   e x i s t i n g   f i l e   ( ,   a p p e n d i n g  )   g f s 2   a t t e m p t   g r o u p   b l o c k s   r e s o u r c e   g r o u p   f i l e   .   i n c r e a s e   p e r f o r m a n c e  :   s p i n n i n g   d i s k  ,   s e e k s   t i m e   p h y s i c a l l y   c l o s e   .   w o r s t   c a s e   s c e n a r i o   c e n t r a l   d i r e c t o r y   n o d e s   c r e a t e   f i l e s   n o d e s   c o n s t a n t l y   f i g h t   l o c k   r e s o u r c e   g r o u p  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 2 .   f i l e   s y s t e m   f r a g m e n t a t i o n   d e f r a g m e n t a t i o n   t o o l   g f s 2   r e d   e n t e r p r i s e   l i n u x  ,   d e f r a g m e n t   i n d i v i d u a l   f i l e s   i d e n t i f y i n g   f i l e f r a g   t o o l  ,   c o p y i n g   t e m p o r a r y   f i l e s  ,   r e n a m i n g   t e m p o r a r y   f i l e s   r e p l a c e   o r i g i n a l s  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 3 .   b l o c k   a l l o c a t i o n   i s s u e s   s e c t i o n   s u m m a r y   i s s u e s   r e l a t e d   b l o c k   a l l o c a t i o n   g f s 2   f i l e   s y s t e m s   .   a p p l i c a t i o n s   w r i t e   d a t a   t y p i c a l l y   b l o c k   a l l o c a t e d  ,   k n o w l e d g e   b l o c k   a l l o c a t i o n   w o r k s   o p t i m i z e   p e r f o r m a n c e  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 3 . 1 .   l e a v e   f r e e   s p a c e   f i l e   s y s t e m   g f s 2   f i l e   s y s t e m   f u l l  ,   b l o c k   a l l o c a t o r   s t a r t s   d i f f i c u l t   t i m e   f i n d i n g   s p a c e   b l o c k s   a l l o c a t e d   .   r e s u l t  ,   b l o c k s   a l l o c a t o r   t e n d   s q u e e z e d   r e s o u r c e   g r o u p   t i n y   s l i c e s   f i l e   f r a g m e n t a t i o n   .   f i l e   f r a g m e n t a t i o n   p e r f o r m a n c e   p r o b l e m s   .   a d d i t i o n  ,   g f s 2   f i l e   s y s t e m   f u l l  ,   g f s 2   b l o c k   a l l o c a t o r   s p e n d s   t i m e   s e a r c h i n g   m u l t i p l e   r e s o u r c e   g r o u p s  ,   a d d s   l o c k   c o n t e n t i o n   n e c e s s a r i l y   f i l e   s y s t e m   a m p l e   f r e e   s p a c e   .   p e r f o r m a n c e   p r o b l e m s   .   r e a s o n s  ,   r e c o m m e n d e d   r u n   f i l e   s y s t e m   8 5   p e r c e n t   f u l l  ,   f i g u r e   v a r y   d e p e n d i n g   w o r k l o a d  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 3 . 2 .   n o d e   a l l o c a t e   f i l e s  ,   p o s s i b l e   d u e   d i s t r i b u t e d   l o c k   m a n a g e r   (  d l m  )   w o r k s  ,   l o c k   c o n t e n t i o n   f i l e s   a l l o c a t e d   n o d e   n o d e s   a d d   b l o c k s   f i l e s   .   g f s   (  v e r s i o n   1  )  ,   l o c k s   m a n a g e d   c e n t r a l   l o c k   m a n a g e r   j o b   c o n t r o l   l o c k i n g   c l u s t e r   .   g r a n d   u n i f i e d   l o c k   m a n a g e r   (  g u l m  )   p r o b l e m a t i c   s i n g l e   p o i n t   f a i l u r e   .   g f s 2   ’   r e p l a c e m e n t   l o c k i n g   s c h e m e  ,   d l m  ,   s p r e a d s   l o c k s   c l u s t e r   .   n o d e   c l u s t e r  ,   l o c k s   r e c o v e r e d   n o d e s   .   d l m  ,   n o d e   l o c k   r e s o u r c e   (  f i l e  )   “   l o c k   m a s t e r   ”   l o c k   .   n o d e s   l o c k   r e s o u r c e  ,   p e r m i s s i o n   l o c k   m a s t e r   .   n o d e   l o c k s   l o c k   m a s t e r  ,   n o d e   n o d e   l e n t   l o c k   .   l o c k i n g   l o c k   m a s t e r   n o d e   f a s t e r   l o c k i n g   n o d e   s t o p   p e r m i s s i o n   l o c k   ’   m a s t e r   .   f i l e   s y s t e m s  ,   g f s 2   a l l o c a t o r   b l o c k s   f i l e   c l o s e   r e d u c e   m o v e m e n t   d i s k   h e a d s   b o o s t   p e r f o r m a n c e   .   n o d e   a l l o c a t e s   b l o c k s   f i l e   l o c k   r e s o u r c e   g r o u p s   b l o c k s   (  b l o c k s   r e s o u r c e   g r o u p  )   .   f i l e   s y s t e m   r u n   f a s t e r   l o c k   m a s t e r   r e s o u r c e   g r o u p   c o n t a i n i n g   f i l e   a l l o c a t e s   d a t a   b l o c k s   (  f a s t e r   n o d e   o p e n e d   f i l e   w r i t i n g   b l o c k s  )  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 3 . 3 .   p r e a l l o c a t e  ,   p o s s i b l e   f i l e s   p r e a l l o c a t e d  ,   b l o c k   a l l o c a t i o n s   a v o i d e d   a l t o g e t h e r   f i l e   s y s t e m   r u n   e f f i c i e n t l y   .   n e w e r   v e r s i o n s   g f s 2   i n c l u d e   f a l l o c a t e   (  1  )   s y s t e m   c a l l  ,   p r e a l l o c a t e   b l o c k s   d a t a  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 4 .   c l u s t e r   c o n s i d e r a t i o n s   d e t e r m i n i n g   n u m b e r   n o d e s   s y s t e m   c o n t a i n  ,   n o t e   t r a d e - o f f   h i g h   a v a i l a b i l i t y   p e r f o r m a n c e   .   l a r g e r   n u m b e r   n o d e s  ,   i n c r e a s i n g l y   d i f f i c u l t   m a k e   w o r k l o a d s   s c a l e   .   r e a s o n  ,   r e d   s u p p o r t   g f s 2   c l u s t e r   f i l e   s y s t e m   d e p l o y m e n t s   g r e a t e r   1 6   n o d e s   .   d e p l o y i n g   c l u s t e r   f i l e   s y s t e m   ` `   d r o p  ' '   r e p l a c e m e n t   s i n g l e   n o d e   d e p l o y m e n t   .   r e d   r e c o m m e n d s   p e r i o d   8 - 1 2   w e e k s   t e s t i n g   i n s t a l l a t i o n s   o r d e r   t e s t   s y s t e m   e n s u r e   w o r k i n g   r e q u i r e d   p e r f o r m a n c e   l e v e l   .   p e r i o d   p e r f o r m a n c e   f u n c t i o n a l   i s s u e s   w o r k e d   q u e r i e s   d i r e c t e d   r e d   s u p p o r t   t e a m   .   r e d   r e c o m m e n d s   c u s t o m e r s   c o n s i d e r i n g   d e p l o y i n g   c l u s t e r s   c o n f i g u r a t i o n s   r e v i e w e d   r e d   s u p p o r t   d e p l o y m e n t   a v o i d   p o s s i b l e   s u p p o r t   i s s u e s  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 5 .   u s a g e   c o n s i d e r a t i o n s   s e c t i o n   g e n e r a l   r e c o m m e n d a t i o n s   g f s 2   u s a g e  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 5 . 1 .   m o u n t   o p t i o n s  :   n o a t i m e   n o d i r a t i m e   g e n e r a l l y   r e c o m m e n d e d   m o u n t   g f s 2   f i l e   s y s t e m s   n o a t i m e   n o d i r a t i m e   a r g u m e n t s   .   g f s 2   s p e n d   t i m e   u p d a t i n g   d i s k   i n o d e s   a c c e s s   .   i n f o r m a t i o n   e f f e c t   a r g u m e n t s   g f s 2   f i l e   s y s t e m   p e r f o r m a n c e  ,   s e c t i o n   2 . 9  ,   “   g f s 2   n o d e   l o c k i n g   ”  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 5 . 2 .   v f s   t u n i n g   o p t i o n s  :   r e s e a r c h   e x p e r i m e n t   l i n u x   f i l e   s y s t e m s  ,   g f s 2   s i t s   t o p   l a y e r   c a l l e d   v i r t u a l   f i l e   s y s t e m   (  v f s  )   .   v f s   l a y e r   i m p r o v e   u n d e r l y i n g   g f s 2   p e r f o r m a n c e   s y s c t l   (  8  )   c o m m a n d   .  ,   v a l u e s   d i r t y _ b a c k g r o u n d _ r a t i o   v f s _ c a c h e _ p r e s s u r e   a d j u s t e d   d e p e n d i n g   s i t u a t i o n   .   f e t c h   c u r r e n t   v a l u e s  ,   c o m m a n d s  :   #  s y s c t l   - n   v m . d i r t y _ b a c k g r o u n d _ r a t i o   #  s y s c t l   - n   v m . v f s _ c a c h e _ p r e s s u r e   c o m m a n d s   a d j u s t   v a l u e s  :   #  s y s c t l   - w   v m . d i r t y _ b a c k g r o u n d _ r a t i o = 2 0   #  s y s c t l   - w   v m . v f s _ c a c h e _ p r e s s u r e = 5 0 0   p e r m a n e n t l y   c h a n g e   v a l u e s   p a r a m e t e r s   e d i t i n g   / e t c / s y s c t l . c o n f   f i l e   .   f i n d   o p t i m a l   v a l u e s   c a s e s  ,   r e s e a r c h   v f s   o p t i o n s   e x p e r i m e n t   t e s t   c l u s t e r   d e p l o y i n g   f u l l   p r o d u c t i o n  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 5 . 3 .   s e l i n u x   g f s 2   r e d   e n t e r p r i s e   l i n u x   7 . 4  ,   s e c u r i t y   e n h a n c e d   l i n u x   (  s e l i n u x  )   s u p p o r t e d   g f s 2   f i l e   s y s t e m s   .   s e l i n u x   g f s 2   i n c u r s   s m a l l   p e r f o r m a n c e   p e n a l t y   .   a v o i d   o v e r h e a d  ,   c h o o s e   s e l i n u x   g f s 2   s y s t e m   s e l i n u x   e n f o r c i n g   .   m o u n t i n g   g f s 2   f i l e   s y s t e m  ,   e n s u r e   s e l i n u x   a t t e m p t   r e a d   s e c l a b e l   e l e m e n t   f i l e   s y s t e m   o b j e c t   c o n t e x t   o p t i o n s   d e s c r i b e d   m o u n t   (  8  )   p a g e  ;   s e l i n u x   a s s u m e   c o n t e n t   f i l e   s y s t e m   l a b e l e d   s e c l a b e l   e l e m e n t   p r o v i d e d   c o n t e x t   m o u n t   o p t i o n s   .   s p e e d   p r o c e s s i n g   a v o i d s   d i s k   r e a d   e x t e n d e d   a t t r i b u t e   b l o c k   c o n t a i n   s e c l a b e l   e l e m e n t s   .  ,   s y s t e m   s e l i n u x   e n f o r c i n g  ,   m o u n t   c o m m a n d   m o u n t   g f s 2   f i l e   s y s t e m   f i l e   s y s t e m   c o n t a i n   a p a c h e   c o n t e n t   .   l a b e l   a p p l y   e n t i r e   f i l e   s y s t e m  ;   r e m a i n s   m e m o r y   w r i t t e n   d i s k   .   #  m o u n t   - t   g f s 2   - o   c o n t e x t = s y s t e m _ u  :   o b j e c t _ r  :   h t t p d _ s y s _ c o n t e n t _ t  :   s 0   / d e v / m a p p e r / x y z / m n t / g f s 2   f i l e   s y s t e m   c o n t a i n   a p a c h e   c o n t e n t  ,   l a b e l s   p u b l i c _ c o n t e n t _ r w _ t   p u b l i c _ c o n t e n t _ t  ,   d e f i n e   l a b e l   a l t o g e t h e r   d e f i n e   p o l i c y   .   n o t e   p a c e m a k e r   c l u s t e r   p a c e m a k e r   m a n a g e   g f s 2   f i l e   s y s t e m   .   s p e c i f y   m o u n t   o p t i o n s   c r e a t e   g f s 2   f i l e   s y s t e m   r e s o u r c e  ,   d e s c r i b e d   c h a p t e r   5  ,   c o n f i g u r i n g   g f s 2   f i l e   s y s t e m   c l u s t e r  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 5 . 4 .   s e t t i n g   n f s   g f s 2   d u e   a d d e d   c o m p l e x i t y   g f s 2   l o c k i n g   s u b s y s t e m   c l u s t e r e d   n a t u r e  ,   s e t t i n g   n f s   g f s 2   r e q u i r e s   t a k i n g   p r e c a u t i o n s   c a r e f u l   c o n f i g u r a t i o n   .   s e c t i o n   d e s c r i b e s   c a v e a t s   a c c o u n t   c o n f i g u r i n g   n f s   s e r v i c e   g f s 2   f i l e   s y s t e m   .   w a r n i n g   a d d i t i o n   l o c k i n g   c o n s i d e r a t i o n s  ,   a c c o u n t   c o n f i g u r i n g   n f s   s e r v i c e   g f s 2   f i l e   s y s t e m   .   r e d   s u p p o r t s   r e d   h i g h   a v a i l a b i l i t y   a d d - o n   c o n f i g u r a t i o n s   n f s v 3   l o c k i n g   a c t i v e / p a s s i v e   c o n f i g u r a t i o n   c h a r a c t e r i s t i c s  :   b a c k - e n d   f i l e   s y s t e m   g f s 2   f i l e   s y s t e m   r u n n i n g   2   1 6   n o d e   c l u s t e r   .   n f s v 3   s e r v e r   d e f i n e d   s e r v i c e   e x p o r t i n g   e n t i r e   g f s 2   f i l e   s y s t e m   s i n g l e   c l u s t e r   n o d e   t i m e   .   n f s   s e r v e r   f a i l   c l u s t e r   n o d e   (  a c t i v e / p a s s i v e   c o n f i g u r a t i o n  )   .   a c c e s s   g f s 2   f i l e   s y s t e m   a l l o w e d   n f s   s e r v e r   .   i n c l u d e s   l o c a l   g f s 2   f i l e   s y s t e m   a c c e s s   a c c e s s   s a m b a   c l u s t e r e d   s a m b a   .   a c c e s s i n g   f i l e   s y s t e m   l o c a l l y   c l u s t e r   n o d e   m o u n t e d   r e s u l t   d a t a   c o r r u p t i o n   .   n f s   q u o t a   s u p p o r t   s y s t e m   .   c o n f i g u r a t i o n   h i g h   a v a i l a b i l i t y   ( )   f i l e   s y s t e m   r e d u c e s   s y s t e m   d o w n t i m e   f a i l e d   n o d e   r e s u l t   r e q u i r e m e n t   e x e c u t e   f s c k   c o m m a n d   f a i l i n g   n f s   s e r v e r   n o d e   .   f s i d =   n f s   o p t i o n   m a n d a t o r y   n f s   e x p o r t s   g f s 2   .   p r o b l e m s   a r i s e   c l u s t e r   ( ,   c l u s t e r   i n q u o r a t e   f e n c i n g   s u c c e s s f u l  )  ,   c l u s t e r e d   l o g i c a l   v o l u m e s   g f s 2   f i l e   s y s t e m   f r o z e n   a c c e s s   p o s s i b l e   c l u s t e r   q u o r a t e   .   c o n s i d e r   p o s s i b i l i t y   d e t e r m i n i n g   s i m p l e   f a i l o v e r   s o l u t i o n   d e f i n e d   p r o c e d u r e   a p p r o p r i a t e   s y s t e m  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 5 . 5 .   s a m b a   (  s m b   w i n d o w s  )   f i l e   s e r v i n g   g f s 2   s a m b a   (  s m b   w i n d o w s  )   f i l e   s e r v i n g   g f s 2   f i l e   s y s t e m   c t d b  ,   a c t i v e / a c t i v e   c o n f i g u r a t i o n s   .   s i m u l t a n e o u s   a c c e s s   d a t a   s a m b a   s h a r e   s a m b a   s u p p o r t e d   .   c u r r e n t l y   s u p p o r t   g f s 2   c l u s t e r   l e a s e s  ,   s l o w s   s a m b a   f i l e   s e r v i n g   .   i n f o r m a t i o n   s u p p o r t   p o l i c i e s   s a m b a  ,   s u p p o r t   p o l i c i e s   r h e l   r e s i l i e n t   s t o r a g e   -   c t d b   g e n e r a l   p o l i c i e s   s u p p o r t   p o l i c i e s   r h e l   r e s i l i e n t   s t o r a g e   -   e x p o r t i n g   g f s 2   c o n t e n t s   p r o t o c o l s   r e d   c u s t o m e r   p o r t a l  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 5 . 6 .   c o n f i g u r i n g   v i r t u a l   m a c h i n e s   g f s 2   g f s 2   f i l e   s y s t e m   v i r t u a l   m a c h i n e  ,   i m p o r t a n t   v m   s t o r a g e   s e t t i n g s   n o d e   c o n f i g u r e d   p r o p e r l y   o r d e r   f o r c e   c a c h e   .  ,   i n c l u d i n g   s e t t i n g s   c a c h e   l i b v i r t   d o m a i n   g f s 2   b e h a v e   e x p e c t e d   .   <  d r i v e r   n a m e =' q e m u  '   t y p e =' r a w  '   c a c h e =' n o n e  '   i o =' n a t i v e' /  >   a l t e r n a t e l y  ,   c o n f i g u r e   s h a r e a b l e   a t t r i b u t e   d e v i c e   e l e m e n t   .   i n d i c a t e s   d e v i c e   e x p e c t e d   s h a r e d   d o m a i n s   (  l o n g   h y p e r v i s o r   s u p p o r t  )   .   s h a r e a b l e  ,   c a c h e =' n o  '   d e v i c e  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 6 .   f i l e   s y s t e m   b a c k u p s   i m p o r t a n t   m a k e   r e g u l a r   b a c k u p s   g f s 2   f i l e   s y s t e m   c a s e   e m e r g e n c y  ,   s i z e   f i l e   s y s t e m   .   s y s t e m   a d m i n i s t r a t o r s   f e e l   s a f e   p r o t e c t e d   r a i d  ,   m u l t i p a t h  ,   m i r r o r i n g  ,   s n a p s h o t s  ,   f o r m s   r e d u n d a n c y  ,   s a f e   .   p r o b l e m   c r e a t e   b a c k u p   p r o c e s s   b a c k i n g   n o d e   s e t   n o d e s   i n v o l v e s   r e a d i n g   e n t i r e   f i l e   s y s t e m   s e q u e n c e   .   s i n g l e   n o d e  ,   n o d e   r e t a i n   i n f o r m a t i o n   c a c h e   n o d e s   c l u s t e r   s t a r t   r e q u e s t i n g   l o c k s   .   r u n n i n g   t y p e   b a c k u p   p r o g r a m   c l u s t e r   o p e r a t i o n   n e g a t i v e l y   i m p a c t   p e r f o r m a n c e   .   d r o p p i n g   c a c h e s   b a c k u p   c o m p l e t e   r e d u c e s   t i m e   r e q u i r e d   n o d e s   r e g a i n   o w n e r s h i p   c l u s t e r   l o c k s / c a c h e s   .   i d e a l  ,  ,   n o d e s   s t o p p e d   c a c h i n g   d a t a   c a c h i n g   b a c k u p   p r o c e s s   b e g a n   .   d r o p   c a c h e s   c o m m a n d   b a c k u p   c o m p l e t e  :   e c h o   - n   3  >   / p r o c / s y s / v m / d r o p _ c a c h e s   f a s t e r   n o d e   c l u s t e r   b a c k s   f i l e s   t a s k   s p l i t   n o d e s   .   a c c o m p l i s h   s c r i p t   r s y n c   c o m m a n d   n o d e - s p e c i f i c   d i r e c t o r i e s   .   r e d   r e c o m m e n d s   m a k i n g   g f s 2   b a c k u p   c r e a t i n g   h a r d w a r e   s n a p s h o t   s a n  ,   p r e s e n t i n g   s n a p s h o t   s y s t e m  ,   b a c k i n g   .   b a c k u p   s y s t e m   m o u n t   s n a p s h o t   - o   l o c k p r o t o = l o c k _ n o l o c k   c l u s t e r  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 7 .   h a r d w a r e   c o n s i d e r a t i o n s   h a r d w a r e   c o n s i d e r a t i o n s   a c c o u n t   d e p l o y i n g   g f s 2   f i l e   s y s t e m   .   h i g h e r   q u a l i t y   s t o r a g e   o p t i o n s   g f s 2   o p e r a t e   c h e a p e r   s h a r e d   s t o r a g e   o p t i o n s  ,   i s c s i   f i b r e   c h a n n e l   e t h e r n e t   (  f c o e  )  ,   p e r f o r m a n c e   b u y   h i g h e r   q u a l i t y   s t o r a g e   l a r g e r   c a c h i n g   c a p a c i t y   .   r e d   p e r f o r m s   q u a l i t y  ,   s a n i t y  ,   p e r f o r m a n c e   t e s t s   s a n   s t o r a g e   f i b r e   c h a n n e l   i n t e r c o n n e c t   .   g e n e r a l   r u l e  ,   d e p l o y   t e s t e d   .   t e s t   n e t w o r k   e q u i p m e n t   d e p l o y i n g   h i g h e r   q u a l i t y  ,   f a s t e r   n e t w o r k   e q u i p m e n t   m a k e s   c l u s t e r   c o m m u n i c a t i o n s   g f s 2   r u n   f a s t e r   r e l i a b i l i t y   .  ,   p u r c h a s e   e x p e n s i v e   h a r d w a r e   .   e x p e n s i v e   n e t w o r k   s w i t c h e s   p r o b l e m s   p a s s i n g   m u l t i c a s t   p a c k e t s  ,   p a s s i n g   f c n t l   l o c k s   (  f l o c k s  )  ,   c h e a p e r   c o m m o d i t y   n e t w o r k   s w i t c h e s   f a s t e r   r e l i a b l e   .   r e d   r e c o m m e n d s   e q u i p m e n t   d e p l o y i n g   f u l l   p r o d u c t i o n  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 8 .   p e r f o r m a n c e   i s s u e s  :   c h e c k   r e d   c u s t o m e r   p o r t a l   i n f o r m a t i o n   r e c o m m e n d a t i o n s   d e p l o y i n g   u p g r a d i n g   r e d   e n t e r p r i s e   l i n u x   c l u s t e r s   h i g h   a v a i l a b i l i t y   a d d - o n   r e d   g l o b a l   f i l e   s y s t e m   2   (  g f s 2  )   a r t i c l e   ` `   r e d   e n t e r p r i s e   l i n u x   c l u s t e r  ,   h i g h   a v a i l a b i l i t y  ,   g f s   d e p l o y m e n t   p r a c t i c e s  ' '   r e d   c u s t o m e r   p o r t a l   h t t p s  :   / / a c c e s s . r e d h a t . c o m / k b / d o c s / d o c - 4 0 8 2 1  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 9 .   g f s 2   n o d e   l o c k i n g   o r d e r   p e r f o r m a n c e   g f s 2   f i l e   s y s t e m  ,   i m p o r t a n t   u n d e r s t a n d   b a s i c   t h e o r y   o p e r a t i o n   .   s i n g l e   n o d e   f i l e   s y s t e m   i m p l e m e n t e d   a l o n g s i d e   c a c h e  ,   p u r p o s e   e l i m i n a t e   l a t e n c y   d i s k   a c c e s s e s   f r e q u e n t l y   r e q u e s t e d   d a t a   .   l i n u x   p a g e   c a c h e   (  h i s t o r i c a l l y   b u f f e r   c a c h e  )   p r o v i d e   c a c h i n g   f u n c t i o n   .   g f s 2  ,   n o d e   p a g e   c a c h e   c o n t a i n   p o r t i o n   o n - d i s k   d a t a   .   g f s 2   l o c k i n g   m e c h a n i s m   c a l l e d   g l o c k s   (  p r o n o u n c e d   g e e - l o c k s  )   m a i n t a i n   i n t e g r i t y   c a c h e   n o d e s   .   g l o c k   s u b s y s t e m   c a c h e   m a n a g e m e n t   f u n c t i o n   i m p l e m e n t e d   d i s t r i b u t e d   l o c k   m a n a g e r   (  d l m  )   u n d e r l y i n g   c o m m u n i c a t i o n   l a y e r   .   g l o c k s   p r o v i d e   p r o t e c t i o n   c a c h e   p e r - i n o d e   b a s i s  ,   l o c k   i n o d e   c o n t r o l l i n g   c a c h i n g   l a y e r   .   g l o c k   g r a n t e d   s h a r e d   (  d l m   l o c k  :   p r  )   d a t a   g l o c k   c a c h e d   n o d e s   t i m e  ,   n o d e s   l o c a l   a c c e s s   d a t a   .   g l o c k   g r a n t e d   e x c l u s i v e   (  d l m   l o c k  :  )   s i n g l e   n o d e   c a c h e   d a t a   g l o c k   .   o p e r a t i o n s   m o d i f y   d a t a   (  w r i t e   s y s t e m   c a l l  )   .   n o d e   r e q u e s t s   g l o c k   g r a n t e d   i m m e d i a t e l y  ,   d l m   s e n d s   m e s s a g e   n o d e   n o d e s   c u r r e n t l y   h o l d   g l o c k s   b l o c k i n g   r e q u e s t   d r o p   l o c k s   .   d r o p p i n g   g l o c k s   (  s t a n d a r d s   f i l e   s y s t e m   o p e r a t i o n s  )   l o n g   p r o c e s s   .   d r o p p i n g   s h a r e d   g l o c k   r e q u i r e s   c a c h e   i n v a l i d a t e d  ,   r e l a t i v e l y   q u i c k   p r o p o r t i o n a l   a m o u n t   c a c h e d   d a t a   .   d r o p p i n g   e x c l u s i v e   g l o c k   r e q u i r e s   f l u s h  ,   w r i t i n g   b a c k   c h a n g e d   d a t a   d i s k  ,   i n v a l i d a t i o n   s h a r e d   g l o c k   .   d i f f e r e n c e   s i n g l e   n o d e   f i l e   s y s t e m   g f s 2  ,  ,   s i n g l e   n o d e   f i l e   s y s t e m   s i n g l e   c a c h e   g f s 2   s e p a r a t e   c a c h e   n o d e   .   c a s e s  ,   l a t e n c y   a c c e s s   c a c h e d   d a t a   s i m i l a r   o r d e r   m a g n i t u d e  ,   l a t e n c y   a c c e s s   u n c a c h e d   d a t a   g r e a t e r   g f s 2   n o d e   p r e v i o u s l y   c a c h e d   d a t a   .   o p e r a t i o n s   r e a d   (  b u f f e r e d  )  ,   s t a t  ,   r e a d d i r   r e q u i r e   s h a r e d   g l o c k   .   o p e r a t i o n s   w r i t e   (  b u f f e r e d  )  ,   m k d i r  ,   r m d i r  ,   u n l i n k   r e q u i r e   e x c l u s i v e   g l o c k   .   d i r e c t   i / o   r e a d / w r i t e   o p e r a t i o n s   r e q u i r e   d e f e r r e d   g l o c k   a l l o c a t i o n   t a k i n g   p l a c e  ,   e x c l u s i v e   g l o c k   w r i t e   r e q u i r e s   a l l o c a t i o n   ( ,   e x t e n d i n g   f i l e  ,   h o l e   f i l l i n g  )   .   p e r f o r m a n c e   c o n s i d e r a t i o n s   f o l l o w   .  ,   r e a d - o n l y   o p e r a t i o n s   p a r a l l e l i z e   e x t r e m e l y   c l u s t e r  ,   r u n   i n d e p e n d e n t l y   n o d e   .  ,   o p e r a t i o n s   r e q u i r i n g   e x c l u s i v e   g l o c k   r e d u c e   p e r f o r m a n c e  ,   m u l t i p l e   n o d e s   c o n t e n d i n g   a c c e s s   i n o d e   ( )   .   c o n s i d e r a t i o n   w o r k i n g   s e t   n o d e   i m p o r t a n t   f a c t o r   g f s 2   f i l e   s y s t e m   p e r f o r m a n c e  ,  ,   p e r f o r m   f i l e   s y s t e m   b a c k u p   d e s c r i b e d   s e c t i o n   2 . 6  ,   “   f i l e   s y s t e m   b a c k u p s   ”   .   c o n s e q u e n c e   r e c o m m e n d   n o a t i m e   n o d i r a t i m e   m o u n t   o p t i o n s   g f s 2   p o s s i b l e   .   p r e v e n t s   r e a d s   r e q u i r i n g   e x c l u s i v e   l o c k s   u p d a t e   a t i m e   t i m e s t a m p   .   u s e r s   c o n c e r n e d   w o r k i n g   s e t   c a c h i n g   e f f i c i e n c y  ,   g f s 2   t o o l s   m o n i t o r   p e r f o r m a n c e   g f s 2   f i l e   s y s t e m  :   p e r f o r m a n c e   c o - p i l o t  ,   d e s c r i b e d   a p p e n d i x  ,   g f s 2   p e r f o r m a n c e   a n a l y s i s   p e r f o r m a n c e   c o - p i l o t  ,   g f s 2   t r a c e p o i n t s  ,   d e s c r i b e d   a p p e n d i x   b  ,   g f s 2   t r a c e p o i n t s   d e b u g f s   g l o c k s   f i l e   .   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 9 . 1 .   i s s u e s   p o s i x   l o c k i n g   p o s i x   l o c k i n g  ,   a c c o u n t  :   f l o c k s   y i e l d   f a s t e r   p r o c e s s i n g   p o s i x   l o c k s   .   p r o g r a m s   p o s i x   l o c k s   g f s 2   a v o i d   g e t l k   f u n c t i o n  ,   c l u s t e r e d   e n v i r o n m e n t  ,   p r o c e s s   i d   d i f f e r e n t   n o d e   c l u s t e r  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 9 . 2 .   p e r f o r m a n c e   t u n i n g   g f s 2   p o s s i b l e   a l t e r   t r o u b l e s o m e   a p p l i c a t i o n   s t o r e s   d a t a   o r d e r   c o n s i d e r a b l e   p e r f o r m a n c e   a d v a n t a g e   .   t y p i c a l   t r o u b l e s o m e   a p p l i c a t i o n   e m a i l   s e r v e r   .   l a i d   s p o o l   d i r e c t o r y   c o n t a i n i n g   f i l e s   u s e r   (  m b o x  )  ,   d i r e c t o r y   u s e r   c o n t a i n i n g   f i l e   m e s s a g e   (  m a i l d i r  )   .   r e q u e s t s   a r r i v e   i m a p  ,   i d e a l   a r r a n g e m e n t   g i v e   u s e r   a f f i n i t y   p a r t i c u l a r   n o d e   .   r e q u e s t s   v i e w   d e l e t e   e m a i l   m e s s a g e s   t e n d   s e r v e d   c a c h e   n o d e   .   n o d e   f a i l s  ,   s e s s i o n   r e s t a r t e d   d i f f e r e n t   n o d e   .   m a i l   a r r i v e s   m e a n s   s m t p  ,   i n d i v i d u a l   n o d e s   s e t   p a s s   u s e r  ' s   m a i l   p a r t i c u l a r   n o d e   d e f a u l t   .   d e f a u l t   n o d e  ,   m e s s a g e   s a v e d   d i r e c t l y   u s e r  ' s   m a i l   s p o o l   r e c e i v i n g   n o d e   .   d e s i g n   i n t e n d e d   p a r t i c u l a r   s e t s   f i l e s   c a c h e d   n o d e   n o r m a l   c a s e  ,   d i r e c t   a c c e s s   c a s e   n o d e   f a i l u r e   .   s e t u p   g f s 2  ' s   p a g e   c a c h e   m a k e s   f a i l u r e s   t r a n s p a r e n t   a p p l i c a t i o n  ,   i m a p   s m t p   .   b a c k u p   t r i c k y   a r e a   .  ,   p o s s i b l e   g r e a t l y   p r e f e r a b l e   b a c k   w o r k i n g   s e t   n o d e   d i r e c t l y   n o d e   c a c h i n g   p a r t i c u l a r   s e t   i n o d e s   .   b a c k u p   s c r i p t   r u n s   r e g u l a r   p o i n t   t i m e  ,   c o i n c i d e   s p i k e   r e s p o n s e   t i m e   a p p l i c a t i o n   r u n n i n g   g f s 2  ,   c h a n c e   c l u s t e r   m a k i n g   e f f i c i e n t   p a g e   c a c h e   .  ,   (  e n v i a b l e  )   p o s i t i o n   s t o p   a p p l i c a t i o n   o r d e r   p e r f o r m   b a c k u p  ,   p r o b l e m   .   h a n d  ,   b a c k u p   r u n   n o d e  ,   c o m p l e t e d   l a r g e   p o r t i o n   f i l e   s y s t e m   c a c h e d   n o d e  ,   p e r f o r m a n c e   p e n a l t y   s u b s e q u e n t   a c c e s s e s   n o d e s   .   m i t i g a t e d   e x t e n t   d r o p p i n g   v f s   p a g e   c a c h e   b a c k u p   n o d e   b a c k u p   c o m p l e t e d   c o m m a n d  :   e c h o   - n   3  >   / p r o c / s y s / v m / d r o p _ c a c h e s   s o l u t i o n   t a k i n g   e n s u r e   w o r k i n g   s e t   n o d e   s h a r e d  ,   r e a d - o n l y   c l u s t e r  ,   a c c e s s e d   l a r g e l y   s i n g l e   n o d e  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
2 . 9 . 3 .   t r o u b l e s h o o t i n g   g f s 2   p e r f o r m a n c e   g f s 2   l o c k   d u m p   c l u s t e r   p e r f o r m a n c e   s u f f e r i n g   i n e f f i c i e n t   g f s 2   c a c h i n g  ,   l a r g e   i n c r e a s i n g   i / o   w a i t   t i m e s   .   m a k e   g f s 2  ' s   l o c k   d u m p   i n f o r m a t i o n   d e t e r m i n e   p r o b l e m   .   s e c t i o n   o v e r v i e w   g f s 2   l o c k   d u m p   .   c o m p l e t e   d e s c r i p t i o n   g f s 2   l o c k   d u m p  ,   a p p e n d i x   b  ,   g f s 2   t r a c e p o i n t s   d e b u g f s   g l o c k s   f i l e   .   g f s 2   l o c k   d u m p   i n f o r m a t i o n   g a t h e r e d   d e b u g f s   f i l e   f o u n d   p a t h  ,   a s s u m i n g   d e b u g f s   m o u n t e d   / s y s / k e r n e l / d e b u g /  :   / s y s / k e r n e l / d e b u g / g f s 2 / f s n a m e / g l o c k s   c o n t e n t   f i l e   s e r i e s   l i n e s   .   l i n e   s t a r t i n g   g  :   r e p r e s e n t s   g l o c k  ,   l i n e s  ,   i n d e n t e d   s i n g l e   s p a c e  ,   r e p r e s e n t   i t e m   i n f o r m a t i o n   r e l a t i n g   g l o c k   i m m e d i a t e l y   f i l e   .   d e b u g f s   f i l e   c o m m a n d   c o p y   c o m p l e t e   c o n t e n t   f i l e   (  l o n g   t i m e   l a r g e   a m o u n t   r a m   l o t   c a c h e d   i n o d e s  )   a p p l i c a t i o n   e x p e r i e n c i n g   p r o b l e m s  ,   r e s u l t i n g   d a t a   d a t e   .   n o t e   l i n e s   d e b u g f s   f i l e   s t a r t i n g  :   (  h o l d e r s  )   r e p r e s e n t   l o c k   r e q u e s t s   g r a n t e d   w a i t i n g   g r a n t e d   .   f l a g s   f i e l d   h o l d e r s   l i n e   f  :   s h o w s  :  '   w  '   f l a g   r e f e r s   w a i t i n g   r e q u e s t  ,  '  '   f l a g   r e f e r s   g r a n t e d   r e q u e s t   .   g l o c k s   l a r g e   n u m b e r s   w a i t i n g   r e q u e s t s   e x p e r i e n c i n g   p a r t i c u l a r   c o n t e n t i o n   .   t a b l e   2 . 1  ,   “   g l o c k   f l a g s   ”   s h o w s   m e a n i n g s   d i f f e r e n t   g l o c k   f l a g s   t a b l e   2 . 2  ,   “   g l o c k   h o l d e r   f l a g s   ”   s h o w s   m e a n i n g s   d i f f e r e n t   g l o c k   h o l d e r   f l a g s   .   i d e n t i f i e d   g l o c k   c a u s i n g   p r o b l e m  ,   s t e p   f i n d   i n o d e   r e l a t e s   .   g l o c k   n u m b e r   ( :   g  :   l i n e  )   i n d i c a t e s   .   f o r m   t y p e / n u m b e r   t y p e   2  ,   g l o c k   i n o d e   g l o c k   n u m b e r   i n o d e   n u m b e r   .   t r a c k   i n o d e  ,   r u n   f i n d   - i n u m   n u m b e r   n u m b e r   i n o d e   n u m b e r   c o n v e r t e d   h e x   f o r m a t   g l o c k s   f i l e   d e c i m a l   .   w a r n i n g   t a b l e   2 . 3  ,   “   g l o c k   t y p e s   ”   s h o w s   m e a n i n g s   d i f f e r e n t   g l o c k   t y p e s   .   g l o c k   i d e n t i f i e d   d i f f e r e n t   t y p e  ,   t y p e   3  :   (  r e s o u r c e   g r o u p  )   .   s i g n i f i c a n t   n u m b e r s   p r o c e s s e s   w a i t i n g   t y p e s   g l o c k   n o r m a l   l o a d s  ,   r e p o r t   r e d   s u p p o r t   .   n u m b e r   w a i t i n g   r e q u e s t s   q u e u e d   r e s o u r c e   g r o u p   l o c k   n u m b e r   r e a s o n s   .   l a r g e   n u m b e r   n o d e s   c o m p a r e d   n u m b e r   r e s o u r c e   g r o u p s   f i l e   s y s t e m   .   f i l e   s y s t e m   f u l l   (  r e q u i r i n g  ,   a v e r a g e  ,   l o n g e r   s e a r c h e s   f r e e   b l o c k s  )   .   s i t u a t i o n   c a s e s   i m p r o v e d   a d d i n g   s t o r a g e   g f s 2 _ g r o w   c o m m a n d   e x p a n d   f i l e   s y s t e m  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   3 .   m a n a g i n g   g f s 2   c h a p t e r   d e s c r i b e s   t a s k s   c o m m a n d s   m a n a g i n g   g f s 2   c o n s i s t s   s e c t i o n s  :   s e c t i o n   3 . 1  ,   “   c r e a t i n g   g f s 2   f i l e   s y s t e m   ”   s e c t i o n   3 . 2  ,   “   m o u n t i n g   g f s 2   f i l e   s y s t e m   ”   s e c t i o n   3 . 3  ,   “   u n m o u n t i n g   g f s 2   f i l e   s y s t e m   ”   s e c t i o n   3 . 4  ,   “   g f s 2   q u o t a   m a n a g e m e n t   ”   s e c t i o n   3 . 5  ,   “   g r o w i n g   g f s 2   f i l e   s y s t e m   ”   s e c t i o n   3 . 6  ,   “   a d d i n g   j o u r n a l s   g f s 2   f i l e   s y s t e m   ”   s e c t i o n   3 . 7  ,   “   d a t a   j o u r n a l i n g   ”   s e c t i o n   3 . 8  ,   “   c o n f i g u r i n g   a t i m e   u p d a t e s   ”   s e c t i o n   3 . 9  ,   “   s u s p e n d i n g   a c t i v i t y   g f s 2   f i l e   s y s t e m   ”   s e c t i o n   3 . 1 0  ,   “   r e p a i r i n g   g f s 2   f i l e   s y s t e m   ”   s e c t i o n   3 . 1 1  ,   “   g f s 2   w i t h d r a w   f u n c t i o n   ”
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 1 .   c r e a t i n g   g f s 2   f i l e   s y s t e m   c r e a t e   g f s 2   f i l e   s y s t e m   m k f s . g f s 2   c o m m a n d   .   m k f s   c o m m a n d   - t   g f s 2   o p t i o n   s p e c i f i e d   .   f i l e   s y s t e m   c r e a t e d   a c t i v a t e d   l v m   v o l u m e   .   i n f o r m a t i o n   r e q u i r e d   r u n   m k f s . g f s 2   c o m m a n d  :   l o c k   p r o t o c o l / m o d u l e   (  l o c k   p r o t o c o l   c l u s t e r   l o c k _ d l m  )   c l u s t e r   (  n e e d e d   s p e c i f y i n g   l o c k t a b l e n a m e   p a r a m e t e r  )   n u m b e r   j o u r n a l s   (  j o u r n a l   r e q u i r e d   n o d e   m o u n t i n g   f i l e   s y s t e m  )   c r e a t i n g   g f s 2   f i l e   s y s t e m  ,   m k f s . g f s 2   c o m m a n d   d i r e c t l y  ,   m k f s   c o m m a n d   - t   p a r a m e t e r   s p e c i f y i n g   f i l e   s y s t e m   t y p e   g f s 2  ,   g f s 2   f i l e   s y s t e m   o p t i o n s   .   n o t e   u s a g e   c r e a t i n g   c l u s t e r e d   g f s 2   f i l e   s y s t e m  ,   f o r m a t s  :   m k f s . g f s 2   - p   l o c k p r o t o n a m e   - t   l o c k t a b l e n a m e   - j   n u m b e r j o u r n a l s   b l o c k d e v i c e   m k f s   - t   g f s 2   - p   l o c k p r o t o n a m e   - t   l o c k t a b l e n a m e   - j   n u m b e r j o u r n a l s   b l o c k d e v i c e   c r e a t i n g   l o c a l   g f s 2   f i l e   s y s t e m  ,   f o r m a t s  :   n o t e   m k f s . g f s 2   - p   l o c k p r o t o n a m e   - j   n u m b e r j o u r n a l s   b l o c k d e v i c e   m k f s   - t   g f s 2   - p   l o c k p r o t o n a m e   - j   n u m b e r j o u r n a l s   b l o c k d e v i c e   w a r n i n g   e x a m p l e s   e x a m p l e s  ,   l o c k _ d l m   l o c k i n g   p r o t o c o l   f i l e   s y s t e m  ,   c l u s t e r e d   f i l e   s y s t e m   .   c l u s t e r   a l p h a  ,   f i l e   s y s t e m   m y d a t a 1   .   f i l e   s y s t e m   c o n t a i n s   j o u r n a l s   c r e a t e d   / d e v / v g 0 1 / l v o l 0   .   #  m k f s . g f s 2   - p   l o c k _ d l m   - t   a l p h a  :   m y d a t a 1   - j   8   / d e v / v g 0 1 / l v o l 0   #  m k f s   - t   g f s 2   - p   l o c k _ d l m   - t   a l p h a  :   m y d a t a 1   - j   8   / d e v / v g 0 1 / l v o l 0   e x a m p l e s  ,   l o c k _ d l m   f i l e   s y s t e m   m a d e  ,   c l u s t e r   a l p h a   .   f i l e   s y s t e m   m y d a t a 2   .   f i l e   s y s t e m   c o n t a i n s   j o u r n a l s   c r e a t e d   / d e v / v g 0 1 / l v o l 1   .   m k f s . g f s 2   - p   l o c k _ d l m   - t   a l p h a  :   m y d a t a 2   - j   8   / d e v / v g 0 1 / l v o l 1   m k f s   - t   g f s 2   - p   l o c k _ d l m   - t   a l p h a  :   m y d a t a 2   - j   8   / d e v / v g 0 1 / l v o l 1   c o m p l e t e   o p t i o n s   t a b l e   3 . 1  ,   “   c o m m a n d   o p t i o n s  :   m k f s . g f s 2   ”   d e s c r i b e s   m k f s . g f s 2   c o m m a n d   o p t i o n s   (  f l a g s   p a r a m e t e r s  )  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 2 .   m o u n t i n g   g f s 2   f i l e   s y s t e m   n o t e   m o u n t   g f s 2   f i l e   s y s t e m  ,   f i l e   s y s t e m   e x i s t   (  s e c t i o n   3 . 1  ,   “   c r e a t i n g   g f s 2   f i l e   s y s t e m   ”  )  ,   v o l u m e   f i l e   s y s t e m   e x i s t s   a c t i v a t e d  ,   s u p p o r t i n g   c l u s t e r i n g   l o c k i n g   s y s t e m s   s t a r t e d   (  c o n f i g u r i n g   m a n a g i n g   r e d   c l u s t e r  )   .   r e q u i r e m e n t s  ,   m o u n t   g f s 2   f i l e   s y s t e m   l i n u x   f i l e   s y s t e m   .   p r o p e r   o p e r a t i o n   g f s 2   f i l e   s y s t e m  ,   g f s 2 - u t i l s   p a c k a g e   i n s t a l l e d   n o d e s   m o u n t   g f s 2   f i l e   s y s t e m   .   g f s 2 - u t i l s   p a c k a g e   p a r t   r e s i l i e n t   s t o r a g e   c h a n n e l   .   m a n i p u l a t e   f i l e   a c l s  ,   m o u n t   f i l e   s y s t e m   - o   a c l   m o u n t   o p t i o n   .   f i l e   s y s t e m   m o u n t e d   - o   a c l   m o u n t   o p t i o n  ,   u s e r s   a l l o w e d   v i e w   a c l s   (  g e t f a c l  )  ,   a l l o w e d   s e t   (  s e t f a c l  )   .   u s a g e   m o u n t i n g   a c l   m a n i p u l a t i o n   m o u n t   b l o c k d e v i c e   m o u n t p o i n t   m o u n t i n g   a c l   m a n i p u l a t i o n   m o u n t   - o   a c l   b l o c k d e v i c e   m o u n t p o i n t  ,   g f s 2   f i l e   s y s t e m   / d e v / v g 0 1 / l v o l 0   m o u n t e d   / m y g f s 2   d i r e c t o r y   .   #  m o u n t   / d e v / v g 0 1 / l v o l 0   / m y g f s 2   c o m p l e t e   u s a g e   m o u n t   b l o c k d e v i c e   m o u n t p o i n t   - o   o p t i o n   - o   o p t i o n   a r g u m e n t   c o n s i s t s   g f s 2 - s p e c i f i c   o p t i o n s   (  t a b l e   3 . 2  ,   “   g f s 2 - s p e c i f i c   m o u n t   o p t i o n s   ”  )   a c c e p t a b l e   s t a n d a r d   l i n u x   m o u n t   - o   o p t i o n s  ,   c o m b i n a t i o n   .   m u l t i p l e   o p t i o n   p a r a m e t e r s   s e p a r a t e d   c o m m a   s p a c e s   .   n o t e   t a b l e   3 . 2  ,   “   g f s 2 - s p e c i f i c   m o u n t   o p t i o n s   ”   d e s c r i b e s   a v a i l a b l e   g f s 2 - s p e c i f i c   - o   o p t i o n   v a l u e s   p a s s e d   g f s 2   m o u n t   t i m e   .   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 3 .   u n m o u n t i n g   g f s 2   f i l e   s y s t e m   g f s 2   f i l e   s y s t e m s   m o u n t e d   m a n u a l l y   a u t o m a t i c a l l y   p a c e m a k e r   s y s t e m   f i l e   s y s t e m s   u n m o u n t e d   s y s t e m   s h u t d o w n   .   r e s u l t  ,   g f s 2   s c r i p t   u n m o u n t   g f s 2   f i l e   s y s t e m   .   g f s 2   s h u t d o w n   s c r i p t   r u n  ,   s t a n d a r d   s h u t d o w n   p r o c e s s   k i l l s   r e m a i n i n g   u s e r   p r o c e s s e s  ,   i n c l u d i n g   c l u s t e r   i n f r a s t r u c t u r e  ,   u n m o u n t   f i l e   s y s t e m   .   u n m o u n t   f a i l   c l u s t e r   i n f r a s t r u c t u r e   s y s t e m   h a n g   .   p r e v e n t   s y s t e m   h a n g i n g   g f s 2   f i l e   s y s t e m s   u n m o u n t e d  ,  :   p a c e m a k e r   m a n a g e   g f s 2   f i l e   s y s t e m   .   i n f o r m a t i o n   c o n f i g u r i n g   g f s 2   f i l e   s y s t e m   p a c e m a k e r   c l u s t e r  ,   c h a p t e r   5  ,   c o n f i g u r i n g   g f s 2   f i l e   s y s t e m   c l u s t e r   .   g f s 2   f i l e   s y s t e m   m o u n t e d   m a n u a l l y   m o u n t   c o m m a n d  ,   u n m o u n t   f i l e   s y s t e m   m a n u a l l y   u m o u n t   c o m m a n d   r e b o o t i n g   s h u t t i n g   s y s t e m   .   f i l e   s y s t e m   h a n g s   u n m o u n t e d   s y s t e m   s h u t d o w n   c i r c u m s t a n c e s  ,   p e r f o r m   h a r d w a r e   r e b o o t   .   d a t a   l o s t   f i l e   s y s t e m   s y n c e d   e a r l i e r   s h u t d o w n   p r o c e s s   .   g f s 2   f i l e   s y s t e m   u n m o u n t e d   l i n u x   f i l e   s y s t e m  ,   u m o u n t   c o m m a n d   .   n o t e   u s a g e   u m o u n t   m o u n t p o i n t
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 .   g f s 2   q u o t a   m a n a g e m e n t   f i l e   s y s t e m   q u o t a s   l i m i t   a m o u n t   f i l e   s y s t e m   s p a c e   u s e r   g r o u p   .   u s e r   g r o u p   q u o t a   l i m i t   s e t   .   g f s 2   f i l e   s y s t e m   m o u n t e d   q u o t a = o n   q u o t a = a c c o u n t   o p t i o n  ,   g f s 2   t r a c k   s p a c e   u s e r   g r o u p   l i m i t s   p l a c e   .   g f s 2   u p d a t e s   q u o t a   i n f o r m a t i o n   t r a n s a c t i o n a l   s y s t e m   c r a s h e s   r e q u i r e   q u o t a   u s a g e s   r e c o n s t r u c t e d   .   p r e v e n t   p e r f o r m a n c e   s l o w d o w n  ,   g f s 2   n o d e   s y n c h r o n i z e s   u p d a t e s   q u o t a   f i l e   p e r i o d i c a l l y   .   f u z z y   q u o t a   a c c o u n t i n g   u s e r s   g r o u p s   s l i g h t l y   e x c e e d   s e t   l i m i t   .   m i n i m i z e  ,   g f s 2   d y n a m i c a l l y   r e d u c e s   s y n c h r o n i z a t i o n   p e r i o d   h a r d   q u o t a   l i m i t   a p p r o a c h e d   .   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 1 .   c o n f i g u r i n g   d i s k   q u o t a s   i m p l e m e n t   d i s k   q u o t a s  ,   s t e p s  :   s e t   q u o t a s   e n f o r c e m e n t   a c c o u n t i n g   .   i n i t i a l i z e   q u o t a   d a t a b a s e   f i l e   c u r r e n t   b l o c k   u s a g e   i n f o r m a t i o n   .   a s s i g n   q u o t a   p o l i c i e s   .   (  a c c o u n t i n g  ,   p o l i c i e s   e n f o r c e d   .  )   s t e p s   d i s c u s s e d   d e t a i l   s e c t i o n s  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 1 . 1 .   s e t t i n g   q u o t a s   e n f o r c e m e n t   a c c o u n t i n g   g f s 2   f i l e   s y s t e m s  ,   q u o t a s   d i s a b l e d   d e f a u l t   .   e n a b l e   q u o t a s   f i l e   s y s t e m  ,   m o u n t   f i l e   s y s t e m   q u o t a = o n   o p t i o n   s p e c i f i e d   .   p o s s i b l e   t r a c k   d i s k   u s a g e   m a i n t a i n   q u o t a   a c c o u n t i n g   u s e r   g r o u p   e n f o r c i n g   l i m i t   w a r n   v a l u e s   .  ,   m o u n t   f i l e   s y s t e m   q u o t a = a c c o u n t   o p t i o n   s p e c i f i e d   .   m o u n t   f i l e   s y s t e m   q u o t a s   e n a b l e d  ,   s p e c i f y   q u o t a = o n   o p t i o n s   a r g u m e n t   c r e a t i n g   g f s 2   f i l e   s y s t e m   r e s o u r c e   c l u s t e r   .  ,   c o m m a n d   s p e c i f i e s   g f s 2   f i l e s y s t e m   r e s o u r c e   c r e a t e d   m o u n t e d   q u o t a s   e n a b l e d   .   #  p c s   r e s o u r c e   c r e a t e   g f s 2 m o u n t   f i l e s y s t e m   o p t i o n s =  ' '   q u o t a = o n  ' '   d e v i c e = b l o c k d e v i c e   d i r e c t o r y = m o u n t p o i n t   f s t y p e = g f s 2   c l o n e   i n f o r m a t i o n   c o n f i g u r i n g   g f s 2   f i l e   s y s t e m   p a c e m a k e r   c l u s t e r  ,   c h a p t e r   5  ,   c o n f i g u r i n g   g f s 2   f i l e   s y s t e m   c l u s t e r   .   m o u n t   f i l e   s y s t e m   q u o t a   a c c o u n t i n g   m a i n t a i n e d  ,   q u o t a   l i m i t s   e n f o r c e d  ,   s p e c i f y   q u o t a = a c c o u n t   o p t i o n s   a r g u m e n t   c r e a t i n g   g f s 2   f i l e   s y s t e m   r e s o u r c e   c l u s t e r   .   m o u n t   f i l e   s y s t e m   q u o t a s   d i s a b l e d  ,   s p e c i f y   q u o t a = o f f   o p t i o n s   a r g u m e n t   c r e a t i n g   g f s 2   f i l e   s y s t e m   r e s o u r c e   c l u s t e r  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 1 . 2 .   c r e a t i n g   q u o t a   d a t a b a s e   f i l e s   q u o t a - e n a b l e d   f i l e   s y s t e m   m o u n t e d  ,   s y s t e m   c a p a b l e   w o r k i n g   d i s k   q u o t a s   .  ,   f i l e   s y s t e m   r e a d y   s u p p o r t   q u o t a s   .   s t e p   r u n   q u o t a c h e c k   c o m m a n d   .   q u o t a c h e c k   c o m m a n d   e x a m i n e s   q u o t a - e n a b l e d   f i l e   s y s t e m s   b u i l d s   t a b l e   c u r r e n t   d i s k   u s a g e   f i l e   s y s t e m   .   t a b l e   u p d a t e   o p e r a t i n g   s y s t e m  ' s   c o p y   d i s k   u s a g e   .   a d d i t i o n  ,   f i l e   s y s t e m  ' s   d i s k   q u o t a   f i l e s   u p d a t e d   .   c r e a t e   q u o t a   f i l e s   f i l e   s y s t e m  ,   - u   - g   o p t i o n s   q u o t a c h e c k   c o m m a n d  ;   o p t i o n s   s p e c i f i e d   u s e r   g r o u p   q u o t a s   i n i t i a l i z e d   .  ,   q u o t a s   e n a b l e d   / h o m e   f i l e   s y s t e m  ,   c r e a t e   f i l e s   / h o m e   d i r e c t o r y  :   q u o t a c h e c k   - u g   / h o m e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 1 . 3 .   a s s i g n i n g   q u o t a s   u s e r   s t e p   a s s i g n i n g   d i s k   q u o t a s   e d q u o t a   c o m m a n d   .   n o t e   m o u n t e d   f i l e   s y s t e m   a c c o u n t i n g   (  q u o t a = a c c o u n t   o p t i o n   s p e c i f i e d  )  ,   q u o t a s   e n f o r c e d   .   c o n f i g u r e   q u o t a   u s e r  ,   r o o t   s h e l l   p r o m p t  ,   e x e c u t e   c o m m a n d  :   #  e d q u o t a   u s e r n a m e   p e r f o r m   s t e p   u s e r   q u o t a   .  ,   q u o t a   e n a b l e d   / h o m e   p a r t i t i o n   (  / d e v / v o l g r o u p 0 0 / l o g v o l 0 2  )   c o m m a n d   e d q u o t a   t e s t u s e r   e x e c u t e d  ,   s h o w n   e d i t o r   c o n f i g u r e d   d e f a u l t   s y s t e m  :   d i s k   q u o t a s   u s e r   t e s t u s e r   (  u i d   5 0 1  )  :   f i l e s y s t e m   b l o c k s   s o f t   h a r d   i n o d e s   s o f t   h a r d   / d e v / v o l g r o u p 0 0 / l o g v o l 0 2   4 4 0 4 3 6   0   0   n o t e   c o l u m n   f i l e   s y s t e m   q u o t a   e n a b l e d   .   c o l u m n   s h o w s   b l o c k s   u s e r   c u r r e n t l y   .   c o l u m n s   s e t   s o f t   h a r d   b l o c k   l i m i t s   u s e r   f i l e   s y s t e m   .   s o f t   b l o c k   l i m i t   d e f i n e s   m a x i m u m   a m o u n t   d i s k   s p a c e   .   h a r d   b l o c k   l i m i t   a b s o l u t e   m a x i m u m   a m o u n t   d i s k   s p a c e   u s e r   g r o u p   .   l i m i t   r e a c h e d  ,   d i s k   s p a c e   .   g f s 2   f i l e   s y s t e m   m a i n t a i n   q u o t a s   i n o d e s  ,   c o l u m n s   a p p l y   g f s 2   f i l e   s y s t e m s   b l a n k   .   v a l u e s   s e t   0  ,   l i m i t   s e t   .   t e x t   e d i t o r  ,   c h a n g e   l i m i t s   .  :   d i s k   q u o t a s   u s e r   t e s t u s e r   (  u i d   5 0 1  )  :   f i l e s y s t e m   b l o c k s   s o f t   h a r d   i n o d e s   s o f t   h a r d   / d e v / v o l g r o u p 0 0 / l o g v o l 0 2   4 4 0 4 3 6   5 0 0 0 0 0   5 5 0 0 0 0   v e r i f y   q u o t a   u s e r   s e t  ,   c o m m a n d  :   q u o t a   t e s t u s e r
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 1 . 4 .   a s s i g n i n g   q u o t a s   g r o u p   q u o t a s   a s s i g n e d   p e r - g r o u p   b a s i s   .   n o t e   m o u n t e d   f i l e   s y s t e m   a c c o u n t i n g   (  a c c o u n t = o n   o p t i o n   s p e c i f i e d  )  ,   q u o t a s   e n f o r c e d   .   s e t   g r o u p   q u o t a   d e v e l   g r o u p   (  g r o u p   e x i s t   p r i o r   s e t t i n g   g r o u p   q u o t a  )  ,   c o m m a n d  :   e d q u o t a   - g   d e v e l   c o m m a n d   d i s p l a y s   e x i s t i n g   q u o t a   g r o u p   t e x t   e d i t o r  :   d i s k   q u o t a s   g r o u p   d e v e l   (  g i d   5 0 5  )  :   f i l e s y s t e m   b l o c k s   s o f t   h a r d   i n o d e s   s o f t   h a r d   / d e v / v o l g r o u p 0 0 / l o g v o l 0 2   4 4 0 4 0 0   0   0   g f s 2   f i l e   s y s t e m   m a i n t a i n   q u o t a s   i n o d e s  ,   c o l u m n s   a p p l y   g f s 2   f i l e   s y s t e m s   b l a n k   .   m o d i f y   l i m i t s  ,   s a v e   f i l e   .   v e r i f y   g r o u p   q u o t a   s e t  ,   c o m m a n d  :   $  q u o t a   - g   d e v e l
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 2 .   m a n a g i n g   d i s k   q u o t a s   q u o t a s   i m p l e m e n t e d  ,   m a i n t e n a n c e   —   f o r m   w a t c h i n g   q u o t a s   e x c e e d e d   m a k i n g   q u o t a s   a c c u r a t e   .   c o u r s e  ,   u s e r s   r e p e a t e d l y   e x c e e d   q u o t a s   c o n s i s t e n t l y   r e a c h   s o f t   l i m i t s  ,   s y s t e m   a d m i n i s t r a t o r   c h o i c e s   m a k e   d e p e n d i n g   t y p e   u s e r s   d i s k   s p a c e   i m p a c t s   w o r k   .   a d m i n i s t r a t o r   u s e r   d e t e r m i n e   d i s k   s p a c e   i n c r e a s e   u s e r  ' s   d i s k   q u o t a   .   c r e a t e   d i s k   u s a g e   r e p o r t   r u n n i n g   r e p q u o t a   u t i l i t y   .  ,   c o m m a n d   r e p q u o t a   / h o m e   p r o d u c e s   o u t p u t  :   *   *   *   r e p o r t   u s e r   q u o t a s   d e v i c e   / d e v / m a p p e r / v o l g r o u p 0 0 - l o g v o l 0 2   b l o c k   g r a c e   t i m e  :   7 d a y s  ;   i n o d e   g r a c e   t i m e  :   7 d a y s   b l o c k   l i m i t s   f i l e   l i m i t s   u s e r   s o f t   h a r d   g r a c e   s o f t   h a r d   g r a c e   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   - -   r o o t   - -   3 6   0   0   4   0   0   k r i s t i n   - -   5 4 0   0   0   1 2 5   0   0   t e s t u s e r   - -   4 4 0 4 0 0   5 0 0 0 0 0   5 5 0 0 0 0   3 7 4 1 8   0   0   v i e w   d i s k   u s a g e   r e p o r t   (  o p t i o n   - a  )   q u o t a - e n a b l e d   f i l e   s y s t e m s  ,   c o m m a n d  :   #  r e p q u o t a   - a   r e p o r t   e a s y   r e a d  ,   p o i n t s   e x p l a i n e d   .   - -   d i s p l a y e d   u s e r   q u i c k   d e t e r m i n e   b l o c k   l i m i t s   e x c e e d e d   .   b l o c k   s o f t   l i m i t   e x c e e d e d  ,   +   a p p e a r s   p l a c e   -   o u t p u t   .   -   i n d i c a t e s   i n o d e   l i m i t  ,   g f s 2   f i l e   s y s t e m s   s u p p o r t   i n o d e   l i m i t s   c h a r a c t e r   r e m a i n   -   .   g f s 2   f i l e   s y s t e m s   s u p p o r t   g r a c e   p e r i o d  ,   g r a c e   c o l u m n   r e m a i n   b l a n k   .   n o t e   r e p q u o t a   c o m m a n d   s u p p o r t e d   n f s  ,   i r r e s p e c t i v e   u n d e r l y i n g   f i l e   s y s t e m  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 3 .   k e e p i n g   q u o t a s   a c c u r a t e   e n a b l e   q u o t a s   f i l e   s y s t e m   p e r i o d   t i m e   r u n n i n g   q u o t a s   d i s a b l e d  ,   r u n   q u o t a c h e c k   c o m m a n d   c r e a t e  ,   c h e c k  ,   r e p a i r   q u o t a   f i l e s   .   a d d i t i o n a l l y  ,   r u n   q u o t a c h e c k   c o m m a n d   q u o t a   f i l e s   a c c u r a t e  ,   o c c u r   f i l e   s y s t e m   u n m o u n t e d   c l e a n l y   s y s t e m   c r a s h   .   i n f o r m a t i o n   q u o t a c h e c k   c o m m a n d  ,   q u o t a c h e c k   p a g e   .   n o t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 4 .   s y n c h r o n i z i n g   q u o t a s   q u o t a s y n c   c o m m a n d   g f s 2   s t o r e s   q u o t a   i n f o r m a t i o n   i n t e r n a l   f i l e   d i s k   .   g f s 2   n o d e   u p d a t e   q u o t a   f i l e   f i l e   s y s t e m   w r i t e  ;  ,   d e f a u l t   u p d a t e s   q u o t a   f i l e   6 0   s e c o n d s   .   a v o i d   c o n t e n t i o n   n o d e s   w r i t i n g   q u o t a   f i l e  ,   s l o w d o w n   p e r f o r m a n c e   .   u s e r   g r o u p   a p p r o a c h e s   q u o t a   l i m i t  ,   g f s 2   d y n a m i c a l l y   r e d u c e s   t i m e   q u o t a - f i l e   u p d a t e s   p r e v e n t   l i m i t   e x c e e d e d   .   n o r m a l   t i m e   p e r i o d   q u o t a   s y n c h r o n i z a t i o n s   t u n a b l e   p a r a m e t e r  ,   q u o t a _ q u a n t u m   .   c h a n g e   d e f a u l t   v a l u e   6 0   s e c o n d s   q u o t a _ q u a n t u m =   m o u n t   o p t i o n  ,   d e s c r i b e d   t a b l e   3 . 2  ,   “   g f s 2 - s p e c i f i c   m o u n t   o p t i o n s   ”   .   q u o t a _ q u a n t u m   p a r a m e t e r   s e t   n o d e   t i m e   f i l e   s y s t e m   m o u n t e d   .   c h a n g e s   q u o t a _ q u a n t u m   p a r a m e t e r   p e r s i s t e n t   u n m o u n t s   .   u p d a t e   q u o t a _ q u a n t u m   v a l u e   m o u n t   - o   r e m o u n t   .   q u o t a s y n c   c o m m a n d   s y n c h r o n i z e   q u o t a   i n f o r m a t i o n   n o d e   o n - d i s k   q u o t a   f i l e   a u t o m a t i c   u p d a t e s   p e r f o r m e d   g f s 2   .   u s a g e   s y n c h r o n i z i n g   q u o t a   i n f o r m a t i o n   q u o t a s y n c   [  - u g  ]   - a | m n t p n t   . . .   t u n i n g   t i m e   s y n c h r o n i z a t i o n s   m o u n t   - o   q u o t a _ q u a n t u m = s e c s  ,   r e m o u n t   b l o c k d e v i c e   m o u n t p o i n t   e x a m p l e s   s y n c h r o n i z e s   c a c h e d   d i r t y   q u o t a s   n o d e   r u n   o n - d i s k   q u o t a   f i l e   f i l e   s y s t e m   / m n t / m y g f s 2   .   #  q u o t a s y n c   - u g   / m n t / m y g f s 2   c h a n g e s   d e f a u l t   t i m e   p e r i o d   r e g u l a r   q u o t a - f i l e   u p d a t e s   h o u r   (  3 6 0 0   s e c o n d s  )   f i l e   s y s t e m   / m n t / m y g f s 2   r e m o u n t i n g   f i l e   s y s t e m   l o g i c a l   v o l u m e   / d e v / v o l g r o u p / l o g i c a l _ v o l u m e   .   #  m o u n t   - o   q u o t a _ q u a n t u m = 3 6 0 0  ,   r e m o u n t   / d e v / v o l g r o u p / l o g i c a l _ v o l u m e   / m n t / m y g f s 2
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 4 . 5 .   r e f e r e n c e s   i n f o r m a t i o n   d i s k   q u o t a s  ,   p a g e s   c o m m a n d s  :   q u o t a c h e c k   e d q u o t a   r e p q u o t a   q u o t a
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 5 .   g r o w i n g   g f s 2   f i l e   s y s t e m   g f s 2 _ g r o w   c o m m a n d   e x p a n d   g f s 2   f i l e   s y s t e m   d e v i c e   f i l e   s y s t e m   r e s i d e s   e x p a n d e d   .   r u n n i n g   g f s 2 _ g r o w   c o m m a n d   e x i s t i n g   g f s 2   f i l e   s y s t e m   f i l l s   s p a r e   s p a c e   c u r r e n t   f i l e   s y s t e m   d e v i c e   n e w l y   i n i t i a l i z e d   g f s 2   f i l e   s y s t e m   e x t e n s i o n   .   f i l l   o p e r a t i o n   c o m p l e t e d  ,   r e s o u r c e   i n d e x   f i l e   s y s t e m   u p d a t e d   .   n o d e s   c l u s t e r   e x t r a   s t o r a g e   s p a c e   a d d e d   .   g f s 2 _ g r o w   c o m m a n d   r u n   m o u n t e d   f i l e   s y s t e m  ,   r u n   n o d e   c l u s t e r   .   n o d e s   e x p a n s i o n   o c c u r r e d   a u t o m a t i c a l l y   s t a r t   s p a c e   .   n o t e   u s a g e   g f s 2 _ g r o w   m o u n t p o i n t   c o m m e n t s   r u n n i n g   g f s 2 _ g r o w   c o m m a n d  :   b a c k   i m p o r t a n t   d a t a   f i l e   s y s t e m   .   d e t e r m i n e   v o l u m e   f i l e   s y s t e m   e x p a n d e d   r u n n i n g   d f   m o u n t p o i n t   c o m m a n d   .   e x p a n d   u n d e r l y i n g   c l u s t e r   v o l u m e   l v m   .   i n f o r m a t i o n   a d m i n i s t e r i n g   l v m   v o l u m e s  ,   l o g i c a l   v o l u m e   m a n a g e r   a d m i n i s t r a t i o n   .   r u n n i n g   g f s 2 _ g r o w   c o m m a n d  ,   r u n   d f   c o m m a n d   c h e c k   s p a c e   a v a i l a b l e   f i l e   s y s t e m   .   e x a m p l e s  ,   f i l e   s y s t e m   / m y g f s 2 f s   d i r e c t o r y   e x p a n d e d   .   #  g f s 2 _ g r o w   / m y g f s 2 f s   f s  :   m o u n t   p o i n t  :   / m y g f s 2 f s   f s  :   d e v i c e  :   / d e v / m a p p e r / g f s 2 t e s t v g - g f s 2 t e s t l v   f s  :   s i z e  :   5 2 4 2 8 8   (  0 x 8 0 0 0 0  )   f s  :   r g   s i z e  :   6 5 5 3 3   (  0 x f f f d  )   d e v  :   s i z e  :   6 5 5 3 6 0   (  0 x a 0 0 0 0  )   f i l e   s y s t e m   g r e w   5 1 2 m b   .   g f s 2 _ g r o w   c o m p l e t e   .   c o m p l e t e   u s a g e   g f s 2 _ g r o w   [  o p t i o n s  ]   {  m o u n t p o i n t   |   d e v i c e  }   [  m o u n t p o i n t   |   d e v i c e  ]   t a b l e   3 . 3  ,   “   g f s 2 - s p e c i f i c   o p t i o n s   a v a i l a b l e   e x p a n d i n g   f i l e   s y s t e m   ”   d e s c r i b e s   g f s 2 - s p e c i f i c   o p t i o n s   e x p a n d i n g   g f s 2   f i l e   s y s t e m  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 6 .   a d d i n g   j o u r n a l s   g f s 2   f i l e   s y s t e m   g f s 2 _ j a d d   c o m m a n d   a d d   j o u r n a l s   g f s 2   f i l e   s y s t e m   .   a d d   j o u r n a l s   g f s 2   f i l e   s y s t e m   d y n a m i c a l l y   p o i n t   e x p a n d i n g   u n d e r l y i n g   l o g i c a l   v o l u m e   .   g f s 2 _ j a d d   c o m m a n d   r u n   m o u n t e d   f i l e   s y s t e m  ,   r u n   n o d e   c l u s t e r   .   n o d e s   e x p a n s i o n   o c c u r r e d   .   n o t e   a d d i n g   j o u r n a l s   g f s 2   f i l e   s y s t e m  ,   f i n d   j o u r n a l s   g f s 2   f i l e   s y s t e m   c u r r e n t l y   c o n t a i n s   g f s 2 _ e d i t   - p   j i n d e x   c o m m a n d  ,  :   #  g f s 2 _ e d i t   - p   j i n d e x   / d e v / s a s d r i v e s / s c r a t c h | g r e p   j o u r n a l   3 / 3   [  f c 7 7 4 5 e b  ]   4 / 2 5   (  0 x 4 / 0 x 1 9  )  :   f i l e   j o u r n a l 0   4 / 4   [  8 b 7 0 7 5 7 d  ]   5 / 3 2 8 5 9   (  0 x 5 / 0 x 8 0 5 b  )  :   f i l e   j o u r n a l 1   5 / 5   [  1 2 7 9 2 4 c 7  ]   6 / 6 5 7 0 1   (  0 x 6 / 0 x 1 0 0 a 5  )  :   f i l e   j o u r n a l 2   u s a g e   g f s 2 _ j a d d   - j   n u m b e r   m o u n t p o i n t   e x a m p l e s  ,   j o u r n a l   a d d e d   f i l e   s y s t e m   / m y g f s 2   d i r e c t o r y   .   g f s 2 _ j a d d   - j   1   / m y g f s 2  ,   j o u r n a l s   a d d e d   f i l e   s y s t e m   / m y g f s 2   d i r e c t o r y   .   g f s 2 _ j a d d   - j   2   / m y g f s 2   c o m p l e t e   u s a g e   g f s 2 _ j a d d   [  o p t i o n s  ]   {  m o u n t p o i n t   |   d e v i c e  }   [  m o u n t p o i n t   |   d e v i c e  ]   t a b l e   3 . 4  ,   “   g f s 2 - s p e c i f i c   o p t i o n s   a v a i l a b l e   a d d i n g   j o u r n a l s   ”   d e s c r i b e s   g f s 2 - s p e c i f i c   o p t i o n s   a d d i n g   j o u r n a l s   g f s 2   f i l e   s y s t e m  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 7 .   d a t a   j o u r n a l i n g   o r d i n a r i l y  ,   g f s 2   w r i t e s   m e t a d a t a   j o u r n a l   .   f i l e   c o n t e n t s   s u b s e q u e n t l y   w r i t t e n   d i s k   k e r n e l  ' s   p e r i o d i c   s y n c   f l u s h e s   f i l e   s y s t e m   b u f f e r s   .   f s y n c   ( )   c a l l   f i l e   f i l e  ' s   d a t a   w r i t t e n   d i s k   i m m e d i a t e l y   .   c a l l   r e t u r n s   d i s k   r e p o r t s   d a t a   s a f e l y   w r i t t e n   .   d a t a   j o u r n a l i n g   r e s u l t   r e d u c e d   f s y n c   ( )   t i m e   s m a l l   f i l e s   f i l e   d a t a   w r i t t e n   j o u r n a l   a d d i t i o n   m e t a d a t a   .   a d v a n t a g e   r a p i d l y   r e d u c e s   f i l e   s i z e   i n c r e a s e s   .   w r i t i n g   m e d i u m   l a r g e r   f i l e s   s l o w e r   d a t a   j o u r n a l i n g   t u r n e d   .   a p p l i c a t i o n s   r e l y   f s y n c   ( )   s y n c   f i l e   d a t a   i m p r o v e d   p e r f o r m a n c e   d a t a   j o u r n a l i n g   .   d a t a   j o u r n a l i n g   e n a b l e d   a u t o m a t i c a l l y   g f s 2   f i l e s   c r e a t e d   f l a g g e d   d i r e c t o r y   (  s u b d i r e c t o r i e s  )   .   e x i s t i n g   f i l e s   z e r o   l e n g t h   d a t a   j o u r n a l i n g   t u r n e d   .   e n a b l i n g   d a t a   j o u r n a l i n g   d i r e c t o r y   s e t s   d i r e c t o r y   ` `   i n h e r i t   j d a t a  ' '  ,   i n d i c a t e s   f i l e s   d i r e c t o r i e s   s u b s e q u e n t l y   c r e a t e d   d i r e c t o r y   j o u r n a l e d   .   e n a b l e   d i s a b l e   d a t a   j o u r n a l i n g   f i l e   c h a t t r   c o m m a n d   .   c o m m a n d s   e n a b l e   d a t a   j o u r n a l i n g   / m n t / g f s 2 / g f s 2 _ d i r / n e w f i l e   f i l e   c h e c k   f l a g   s e t   p r o p e r l y   .   #  c h a t t r   + j   / m n t / g f s 2 / g f s 2 _ d i r / n e w f i l e   #  l s a t t r   / m n t / g f s 2 / g f s 2 _ d i r   - -   - -   - -   - -   - j   - -   -   / m n t / g f s 2 / g f s 2 _ d i r / n e w f i l e   c o m m a n d s   d i s a b l e   d a t a   j o u r n a l i n g   / m n t / g f s 2 / g f s 2 _ d i r / n e w f i l e   f i l e   c h e c k   f l a g   s e t   p r o p e r l y   .   #  c h a t t r   - j   / m n t / g f s 2 / g f s 2 _ d i r / n e w f i l e   #  l s a t t r   / m n t / g f s 2 / g f s 2 _ d i r   - -   - -   - -   - -   - -   - -   -   / m n t / g f s 2 / g f s 2 _ d i r / n e w f i l e   c h a t t r   c o m m a n d   s e t   f l a g   d i r e c t o r y   .   s e t   f l a g   d i r e c t o r y  ,   f i l e s   d i r e c t o r i e s   s u b s e q u e n t l y   c r e a t e d   d i r e c t o r y   j o u r n a l e d   .   s e t   c o m m a n d s   s e t s   f l a g   g f s 2 _ d i r   d i r e c t o r y  ,   c h e c k s   f l a g   s e t   p r o p e r l y   .  ,   c o m m a n d s   c r e a t e   f i l e   c a l l e d   n e w f i l e   / m n t / g f s 2 / g f s 2 _ d i r   d i r e c t o r y   c h e c k   f l a g   s e t   f i l e   .   f l a g   s e t   d i r e c t o r y  ,   n e w f i l e   j o u r n a l i n g   e n a b l e d   .   #  c h a t t r   - j   / m n t / g f s 2 / g f s 2 _ d i r   #  l s a t t r   / m n t / g f s 2   - -   - -   - -   - -   - j   - -   -   / m n t / g f s 2 / g f s 2 _ d i r   #  t o u c h   / m n t / g f s 2 / g f s 2 _ d i r / n e w f i l e   #  l s a t t r   / m n t / g f s 2 / g f s 2 _ d i r   - -   - -   - -   - -   - j   - -   -   / m n t / g f s 2 / g f s 2 _ d i r / n e w f i l e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 8 .   c o n f i g u r i n g   a t i m e   u p d a t e s   f i l e   i n o d e   d i r e c t o r y   i n o d e   t i m e   s t a m p s   a s s o c i a t e d  :   c t i m e   —   t i m e   i n o d e   s t a t u s   c h a n g e d   m t i m e   —   t i m e   f i l e   (  d i r e c t o r y  )   d a t a   m o d i f i e d   a t i m e   —   t i m e   f i l e   (  d i r e c t o r y  )   d a t a   a c c e s s e d   a t i m e   u p d a t e s   e n a b l e d   d e f a u l t   g f s 2   l i n u x   f i l e   s y s t e m s   t i m e   f i l e   r e a d  ,   i n o d e   u p d a t e d   .   a p p l i c a t i o n s   i n f o r m a t i o n   p r o v i d e d   a t i m e  ,   u p d a t e s   r e q u i r e   s i g n i f i c a n t   a m o u n t   u n n e c e s s a r y   w r i t e   t r a f f i c   f i l e   l o c k i n g   t r a f f i c   .   t r a f f i c   d e g r a d e   p e r f o r m a n c e  ;  ,   p r e f e r a b l e   t u r n   r e d u c e   f r e q u e n c y   a t i m e   u p d a t e s   .   m e t h o d s   r e d u c i n g   e f f e c t s   a t i m e   u p d a t i n g   a v a i l a b l e  :   m o u n t   r e l a t i m e   (  r e l a t i v e   a t i m e  )  ,   u p d a t e s   a t i m e   p r e v i o u s   a t i m e   u p d a t e   o l d e r   m t i m e   c t i m e   u p d a t e   .   m o u n t   n o a t i m e  ,   d i s a b l e s   a t i m e   u p d a t e s   f i l e   s y s t e m  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 8 . 1 .   m o u n t   r e l a t i m e   r e l a t i m e   (  r e l a t i v e   a t i m e  )   l i n u x   m o u n t   o p t i o n   s p e c i f i e d   f i l e   s y s t e m   m o u n t e d   .   s p e c i f i e s   a t i m e   u p d a t e d   p r e v i o u s   a t i m e   u p d a t e   o l d e r   m t i m e   c t i m e   u p d a t e   .   u s a g e   m o u n t   b l o c k d e v i c e   m o u n t p o i n t   - o   r e l a t i m e  ,   g f s 2   f i l e   s y s t e m   r e s i d e s   / d e v / v g 0 1 / l v o l 0   m o u n t e d   d i r e c t o r y   / m y g f s 2   .   a t i m e   u p d a t e s   p l a c e   p r e v i o u s   a t i m e   u p d a t e   o l d e r   m t i m e   c t i m e   u p d a t e   .   #  m o u n t   / d e v / v g 0 1 / l v o l 0   / m y g f s 2   - o   r e l a t i m e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 8 . 2 .   m o u n t   n o a t i m e   n o a t i m e   l i n u x   m o u n t   o p t i o n   s p e c i f i e d   f i l e   s y s t e m   m o u n t e d  ,   d i s a b l e s   a t i m e   u p d a t e s   f i l e   s y s t e m   .   u s a g e   m o u n t   b l o c k d e v i c e   m o u n t p o i n t   - o   n o a t i m e  ,   g f s 2   f i l e   s y s t e m   r e s i d e s   / d e v / v g 0 1 / l v o l 0   m o u n t e d   d i r e c t o r y   / m y g f s 2   a t i m e   u p d a t e s   t u r n e d   .   #  m o u n t   / d e v / v g 0 1 / l v o l 0   / m y g f s 2   - o   n o a t i m e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 9 .   s u s p e n d i n g   a c t i v i t y   g f s 2   f i l e   s y s t e m   s u s p e n d   w r i t e   a c t i v i t y   f i l e   s y s t e m   d m s e t u p   s u s p e n d   c o m m a n d   .   s u s p e n d i n g   w r i t e   a c t i v i t y   h a r d w a r e - b a s e d   d e v i c e   s n a p s h o t s   c a p t u r e   f i l e   s y s t e m   c o n s i s t e n t   s t a t e   .   d m s e t u p   r e s u m e   c o m m a n d   e n d s   s u s p e n s i o n   .   u s a g e   s t a r t   s u s p e n s i o n   d m s e t u p   s u s p e n d   m o u n t p o i n t   s u s p e n s i o n   d m s e t u p   r e s u m e   m o u n t p o i n t   e x a m p l e s   s u s p e n d s   w r i t e s   f i l e   s y s t e m   / m y g f s 2   .   #  d m s e t u p   s u s p e n d   / m y g f s 2   e n d s   s u s p e n s i o n   w r i t e s   f i l e   s y s t e m   / m y g f s 2   .   #  d m s e t u p   r e s u m e   / m y g f s 2
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 1 0 .   r e p a i r i n g   g f s 2   f i l e   s y s t e m   n o d e s   f a i l   f i l e   s y s t e m   m o u n t e d  ,   f i l e   s y s t e m   j o u r n a l i n g   f a s t   r e c o v e r y   .  ,   s t o r a g e   d e v i c e   l o s e s   p o w e r   p h y s i c a l l y   d i s c o n n e c t e d  ,   f i l e   s y s t e m   c o r r u p t i o n   o c c u r   .   (  j o u r n a l i n g   r e c o v e r   s t o r a g e   s u b s y s t e m   f a i l u r e s   .  )   t y p e   c o r r u p t i o n   o c c u r s  ,   r e c o v e r   g f s 2   f i l e   s y s t e m   f s c k . g f s 2   c o m m a n d   .   i m p o r t a n t   n o t e   r u n n i n g   f s c k . g f s 2   c o m m a n d   r e q u i r e s   s y s t e m   m e m o r y   m e m o r y   o p e r a t i n g   s y s t e m   k e r n e l   .   b l o c k   m e m o r y   g f s 2   f i l e   s y s t e m   r e q u i r e s   a p p r o x i m a t e l y   b i t s   a d d i t i o n a l   m e m o r y  ,   5 / 8   b y t e   .   e s t i m a t e   b y t e s   m e m o r y   r u n   f s c k . g f s 2   c o m m a n d   f i l e   s y s t e m  ,   d e t e r m i n e   b l o c k s   f i l e   s y s t e m   c o n t a i n s   m u l t i p l y   n u m b e r   5 / 8   .  ,   d e t e r m i n e   a p p r o x i m a t e l y   m e m o r y   r e q u i r e d   r u n   f s c k . g f s 2   c o m m a n d   g f s 2   f i l e   s y s t e m   1 6 t b   b l o c k   s i z e   4 k  ,   d e t e r m i n e   b l o c k s   m e m o r y   f i l e   s y s t e m   c o n t a i n s   d i v i d i n g   1 6 t b   4 k  :   1 7 5 9 2 1 8 6 0 4 4 4 1 6   /   4 0 9 6   =   4 2 9 4 9 6 7 2 9 6   f i l e   s y s t e m   c o n t a i n s   4 2 9 4 9 6 7 2 9 6   b l o c k s  ,   m u l t i p l y   n u m b e r   5 / 8   d e t e r m i n e   b y t e s   m e m o r y   r e q u i r e d  :   4 2 9 4 9 6 7 2 9 6   *   5 / 8   =   2 6 8 4 3 5 4 5 6 0   f i l e   s y s t e m   r e q u i r e s   a p p r o x i m a t e l y   2 . 6 g b   f r e e   m e m o r y   r u n   f s c k . g f s 2   c o m m a n d   .   n o t e   b l o c k   s i z e   1 k  ,   r u n n i n g   f s c k . g f s 2   c o m m a n d   r e q u i r e   t i m e s   m e m o r y  ,   a p p r o x i m a t e l y   1 1 g b   .   u s a g e   f s c k . g f s 2   - y   b l o c k d e v i c e  ,   g f s 2   f i l e   s y s t e m   r e s i d i n g   b l o c k   d e v i c e   / d e v / t e s t v g / t e s t l v   r e p a i r e d   .   q u e r i e s   r e p a i r   a u t o m a t i c a l l y   a n s w e r e d   .   #  f s c k . g f s 2   - y   / d e v / t e s t v g / t e s t l v   i n i t i a l i z i n g   f s c k   v a l i d a t i n g   r e s o u r c e   g r o u p   i n d e x   .   l e v e l   1   r g   c h e c k   .   (  l e v e l   1   p a s s e d  )   c l e a r i n g   j o u r n a l s   ( )   . . .   j o u r n a l s   c l e a r e d   .   s t a r t i n g   p a s s 1   p a s s 1   c o m p l e t e   s t a r t i n g   p a s s 1 b   p a s s 1 b   c o m p l e t e   s t a r t i n g   p a s s 1 c   p a s s 1 c   c o m p l e t e   s t a r t i n g   p a s s 2   p a s s 2   c o m p l e t e   s t a r t i n g   p a s s 3   p a s s 3   c o m p l e t e   s t a r t i n g   p a s s 4   p a s s 4   c o m p l e t e   s t a r t i n g   p a s s 5   p a s s 5   c o m p l e t e   w r i t i n g   c h a n g e s   d i s k   f s c k . g f s 2   c o m p l e t e
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
3 . 1 1 .   g f s 2   w i t h d r a w   f u n c t i o n   g f s 2   w i t h d r a w   f u n c t i o n   d a t a   i n t e g r i t y   f e a t u r e   g f s 2   f i l e   s y s t e m   p r e v e n t s   p o t e n t i a l   f i l e   s y s t e m   d a m a g e   d u e   f a u l t y   h a r d w a r e   k e r n e l   s o f t w a r e   .   g f s 2   k e r n e l   m o d u l e   d e t e c t s   i n c o n s i s t e n c y   g f s 2   f i l e   s y s t e m   c l u s t e r   n o d e  ,   w i t h d r a w s   f i l e   s y s t e m  ,   l e a v i n g   u n a v a i l a b l e   n o d e   u n m o u n t e d   r e m o u n t e d   (  m a c h i n e   d e t e c t i n g   p r o b l e m   r e b o o t e d  )   .   m o u n t e d   g f s 2   f i l e   s y s t e m s   r e m a i n   f u l l y   f u n c t i o n a l   n o d e   .   (  g f s 2   w i t h d r a w   f u n c t i o n   s e v e r e   k e r n e l   p a n i c  ,   n o d e   f e n c e d   .  )   c a t e g o r i e s   i n c o n s i s t e n c y   g f s 2   w i t h d r a w  :   i n o d e   c o n s i s t e n c y   e r r o r   r e s o u r c e   g r o u p   c o n s i s t e n c y   e r r o r   j o u r n a l   c o n s i s t e n c y   e r r o r   m a g i c   n u m b e r   m e t a d a t a   c o n s i s t e n c y   e r r o r   m e t a d a t a   t y p e   c o n s i s t e n c y   e r r o r   i n c o n s i s t e n c y   g f s 2   w i t h d r a w   i n c o r r e c t   b l o c k   c o u n t   f i l e   ’   i n o d e   .   g f s 2   d e l e t e s   f i l e  ,   s y s t e m a t i c a l l y   r e m o v e s   d a t a   m e t a d a t a   b l o c k s   r e f e r e n c e d   f i l e   .  ,   c h e c k s   i n o d e   ’   b l o c k   c o u n t   .   b l o c k   c o u n t   1   (  m e a n i n g   l e f t   d i s k   i n o d e  )  ,   i n d i c a t e s   f i l e   s y s t e m   i n c o n s i s t e n c y  ,   i n o d e   ’   b l o c k   c o u n t   m a t c h   a c t u a l   b l o c k s   f i l e   .   c a s e s  ,   p r o b l e m   c a u s e d   f a u l t y   h a r d w a r e   (  f a u l t y   m e m o r y  ,   m o t h e r b o a r d  ,   h b a  ,   d i s k   d r i v e s  ,   c a b l e s  ,  )   .   c a u s e d   k e r n e l   b u g   (  k e r n e l   m o d u l e   a c c i d e n t a l l y   o v e r w r i t i n g   g f s 2   ’   m e m o r y  )  ,   a c t u a l   f i l e   s y s t e m   d a m a g e   (  c a u s e d   g f s 2   b u g  )   .   c a s e s  ,   g f s 2   i n c o n s i s t e n c y   f i x e d   r e b o o t i n g   c l u s t e r   n o d e   .   r e b o o t i n g   c l u s t e r   n o d e  ,   d i s a b l e   g f s 2   f i l e   s y s t e m   “   c l o n e   ”   s e r v i c e   p a c e m a k e r  ,   u n m o u n t s   f i l e   s y s t e m   n o d e   .   #  p c s   r e s o u r c e   d i s a b l e   - -   w a i t = 1 0 0   m y d a t a _ f s _ c l o n e   #  / s b i n / r e b o o t   w a r n i n g   c o n s i s t e n c y   p r o b l e m   c a u s e d   w i t h d r a w   m a k e   s t o p p i n g   f i l e   s y s t e m   s e r v i c e   i m p o s s i b l e   s y s t e m   h a n g   .   p r o b l e m   p e r s i s t s   r e m o u n t  ,   s t o p   f i l e   s y s t e m   s e r v i c e   u n m o u n t   f i l e   s y s t e m   n o d e s   c l u s t e r  ,   p e r f o r m   f i l e   s y s t e m   c h e c k   f s c k . g f s 2   c o m m a n d   r e s t a r t i n g   s e r v i c e   p r o c e d u r e   .   r e b o o t   a f f e c t e d   n o d e   .   d i s a b l e   n o n - c l o n e   f i l e   s y s t e m   s e r v i c e   p a c e m a k e r   u n m o u n t   f i l e   s y s t e m   n o d e   c l u s t e r   .   #  p c s   r e s o u r c e   d i s a b l e   - -   w a i t = 1 0 0   m y d a t a _ f s   n o d e   c l u s t e r  ,   r u n   f s c k . g f s 2   c o m m a n d   f i l e   s y s t e m   d e v i c e   c h e c k   r e p a i r   f i l e   s y s t e m   d a m a g e   .   #  f s c k . g f s 2   - y   / d e v / v g _ m y d a t a / m y d a t a  >   / t m p / f s c k . o u t   r e m o u n t   g f s 2   f i l e   s y s t e m   n o d e s   r e - e n a b l i n g   f i l e   s y s t e m   s e r v i c e  :   #  p c s   r e s o u r c e   e n a b l e   - -   w a i t = 1 0 0   m y d a t a _ f s   o v e r r i d e   g f s 2   w i t h d r a w   f u n c t i o n   m o u n t i n g   f i l e   s y s t e m   - o   e r r o r s = p a n i c   o p t i o n   s p e c i f i e d   f i l e   s y s t e m   s e r v i c e   .   #  p c s   r e s o u r c e   u p d a t e   m y d a t a _ f s   “   o p t i o n s = n o a t i m e  ,   e r r o r s = p a n i c   ”   o p t i o n   s p e c i f i e d  ,   e r r o r s   s y s t e m   w i t h d r a w   f o r c e   k e r n e l   p a n i c   i n s t e a d   .   s t o p s   n o d e  ' s   c o m m u n i c a t i o n s  ,   n o d e   f e n c e d   .   e s p e c i a l l y   c l u s t e r s   l e f t   u n a t t e n d e d   l o n g   p e r i o d s   t i m e   m o n i t o r i n g   i n t e r v e n t i o n   .   i n t e r n a l l y  ,   g f s 2   w i t h d r a w   f u n c t i o n   w o r k s   d i s c o n n e c t i n g   l o c k i n g   p r o t o c o l   e n s u r e   f i l e   s y s t e m   o p e r a t i o n s   r e s u l t   i / o   e r r o r s   .   r e s u l t  ,   w i t h d r a w   o c c u r s  ,   n o r m a l   n u m b e r   i / o   e r r o r s   d e v i c e   m a p p e r   d e v i c e   r e p o r t e d   s y s t e m   l o g s  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   4 .   d i a g n o s i n g   c o r r e c t i n g   p r o b l e m s   g f s 2   f i l e   s y s t e m s   c h a p t e r   i n f o r m a t i o n   c o m m o n   g f s 2   i s s u e s   a d d r e s s  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 1 .   g f s 2   f i l e   s y s t e m   s h o w s   s l o w   p e r f o r m a n c e   f i n d   g f s 2   f i l e   s y s t e m   s h o w s   s l o w e r   p e r f o r m a n c e   e x t 3   f i l e   s y s t e m   .   g f s 2   p e r f o r m a n c e   a f f e c t e d   n u m b e r   i n f l u e n c e s   c a s e s   .   i n f o r m a t i o n   a d d r e s s e s   g f s 2   p e r f o r m a n c e   i s s u e s   f o u n d   d o c u m e n t  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 2 .   g f s 2   f i l e   s y s t e m   h a n g s   r e q u i r e s   r e b o o t   n o d e   g f s 2   f i l e   s y s t e m   h a n g s   r e t u r n   c o m m a n d s   r u n  ,   r e b o o t i n g   s p e c i f i c   n o d e   r e t u r n s   s y s t e m   n o r m a l  ,   i n d i c a t i v e   l o c k i n g   p r o b l e m   b u g   .   o c c u r  ,   g a t h e r   d a t a  :   g f s 2   l o c k   d u m p   f i l e   s y s t e m   n o d e  :   / s y s / k e r n e l / d e b u g / g f s 2 / f s n a m e / g l o c k s  >   g l o c k s . f s n a m e . n o d e n a m e   d l m   l o c k   d u m p   f i l e   s y s t e m   n o d e  :   i n f o r m a t i o n   d l m _ t o o l  :   d l m _ t o o l   l o c k d e b u g   - s v   l s n a m e   .   c o m m a n d  ,   l s n a m e   l o c k s p a c e   d l m   f i l e   s y s t e m   q u e s t i o n   .   f i n d   v a l u e   o u t p u t   g r o u p _ t o o l   c o m m a n d   .   o u t p u t   s y s r q   - t   c o m m a n d   .   c o n t e n t s   / v a r / l o g / m e s s a g e s   f i l e   .   g a t h e r e d   d a t a  ,   o p e n   t i c k e t   r e d   s u p p o r t   p r o v i d e   d a t a   c o l l e c t e d  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 3 .   g f s 2   f i l e   s y s t e m   h a n g s   r e q u i r e s   r e b o o t   n o d e s   g f s 2   f i l e   s y s t e m   h a n g s   r e t u r n   c o m m a n d s   r u n  ,   r e q u i r i n g   r e b o o t   n o d e s   c l u s t e r  ,   c h e c k   i s s u e s   .   f a i l e d   f e n c e   .   g f s 2   f i l e   s y s t e m s   f r e e z e   e n s u r e   d a t a   i n t e g r i t y   e v e n t   f a i l e d   f e n c e   .   c h e c k   m e s s a g e s   l o g s   f a i l e d   f e n c e s   t i m e   h a n g   .   e n s u r e   f e n c i n g   c o n f i g u r e d   c o r r e c t l y   .   g f s 2   f i l e   s y s t e m   w i t h d r a w n   .   c h e c k   m e s s a g e s   l o g s   w o r d   w i t h d r a w   c h e c k   m e s s a g e s   c a l l   t r a c e s   g f s 2   i n d i c a t i n g   f i l e   s y s t e m   w i t h d r a w n   .   w i t h d r a w   i n d i c a t i v e   f i l e   s y s t e m   c o r r u p t i o n  ,   s t o r a g e   f a i l u r e  ,   b u g   .   e a r l i e s t   t i m e   c o n v e n i e n t   u n m o u n t   f i l e   s y s t e m  ,   p e r f o r m   p r o c e d u r e  :   r e b o o t   n o d e   w i t h d r a w   o c c u r r e d   .   #  / s b i n / r e b o o t   s t o p   f i l e   s y s t e m   r e s o u r c e   u n m o u n t   g f s 2   f i l e   s y s t e m   n o d e s   .   #  p c s   r e s o u r c e   d i s a b l e   - -   w a i t = 1 0 0   m y d a t a _ f s   c a p t u r e   m e t a d a t a   g f s 2 _ e d i t   s a v e m e t a   . . .   c o m m a n d   .   e n s u r e   s u f f i c i e n t   s p a c e   f i l e  ,   c a s e s   l a r g e   .  ,   m e t a d a t a   s a v e d   f i l e   / r o o t   d i r e c t o r y   .   #  g f s 2 _ e d i t   s a v e m e t a   / d e v / v g _ m y d a t a / m y d a t a   / r o o t / g f s 2 m e t a d a t a . g z   u p d a t e   g f s 2 - u t i l s   p a c k a g e   .   #  s u d o   y u m   u p d a t e   g f s 2 - u t i l s   n o d e  ,   r u n   f s c k . g f s 2   c o m m a n d   f i l e   s y s t e m   e n s u r e   f i l e   s y s t e m   i n t e g r i t y   r e p a i r   d a m a g e   .   #  f s c k . g f s 2   - y   / d e v / v g _ m y d a t a / m y d a t a  >   / t m p / f s c k . o u t   f s c k . g f s 2   c o m m a n d   c o m p l e t e d  ,   r e - e n a b l e   f i l e   s y s t e m   r e s o u r c e   r e t u r n   s e r v i c e  :   #  p c s   r e s o u r c e   e n a b l e   - -   w a i t = 1 0 0   m y d a t a _ f s   o p e n   s u p p o r t   t i c k e t   r e d   s u p p o r t   .   i n f o r m   e x p e r i e n c e d   g f s 2   w i t h d r a w   p r o v i d e   l o g s   d e b u g g i n g   i n f o r m a t i o n   g e n e r a t e d   s o s r e p o r t s   g f s 2 _ e d i t   s a v e m e t a   c o m m a n d s   .   i n s t a n c e s   g f s 2   w i t h d r a w  ,   c o m m a n d s   h a n g   a c c e s s   f i l e   s y s t e m   b l o c k   d e v i c e   .   c a s e s   h a r d   r e b o o t   r e q u i r e d   r e b o o t   c l u s t e r   .   i n f o r m a t i o n   g f s 2   w i t h d r a w   f u n c t i o n  ,   s e c t i o n   3 . 1 1  ,   “   g f s 2   w i t h d r a w   f u n c t i o n   ”   .   e r r o r   i n d i c a t i v e   l o c k i n g   p r o b l e m   b u g   .   g a t h e r   d a t a   o c c u r r e n c e s   o p e n   s u p p o r t   t i c k e t   r e d   s u p p o r t  ,   d e s c r i b e d   s e c t i o n   4 . 2  ,   “   g f s 2   f i l e   s y s t e m   h a n g s   r e q u i r e s   r e b o o t   n o d e   ”  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 4 .   g f s 2   f i l e   s y s t e m   m o u n t   n e w l y   a d d e d   c l u s t e r   n o d e   a d d   n o d e   c l u s t e r   f i n d   m o u n t   g f s 2   f i l e   s y s t e m   n o d e  ,   f e w e r   j o u r n a l s   g f s 2   f i l e   s y s t e m   n o d e s   a t t e m p t i n g   a c c e s s   g f s 2   f i l e   s y s t e m   .   j o u r n a l   g f s 2   h o s t   i n t e n d   m o u n t   f i l e   s y s t e m   (  e x c e p t i o n   g f s 2   f i l e   s y s t e m s   m o u n t e d   s p e c t a t o r   m o u n t   o p t i o n   s e t  ,   r e q u i r e   j o u r n a l  )   .   a d d   j o u r n a l s   g f s 2   f i l e   s y s t e m   g f s 2 _ j a d d   c o m m a n d  ,   d e s c r i b e d   s e c t i o n   3 . 6  ,   “   a d d i n g   j o u r n a l s   g f s 2   f i l e   s y s t e m   ”  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
4 . 5 .   s p a c e   i n d i c a t e d   e m p t y   f i l e   s y s t e m   e m p t y   g f s 2   f i l e   s y s t e m  ,   d f   c o m m a n d   s h o w   s p a c e   .   g f s 2   f i l e   s y s t e m   j o u r n a l s   c o n s u m e   s p a c e   (  n u m b e r   j o u r n a l s   *   j o u r n a l   s i z e  )   d i s k   .   c r e a t e d   g f s 2   f i l e   s y s t e m   l a r g e   n u m b e r   j o u r n a l s   s p e c i f i e d   l a r g e   j o u r n a l   s i z e   (  n u m b e r   j o u r n a l s   *   j o u r n a l   s i z e  )   e x e c u t e   d f   c o m m a n d   .   s p e c i f y   l a r g e   n u m b e r   j o u r n a l s   l a r g e   j o u r n a l s  ,   s m a l l   g f s 2   f i l e   s y s t e m s   (  1 g b   r a n g e  )   s h o w   l a r g e   a m o u n t   s p a c e   d e f a u l t   g f s 2   j o u r n a l   s i z e  .
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
c h a p t e r   5 .   c o n f i g u r i n g   g f s 2   f i l e   s y s t e m   c l u s t e r   p r o c e d u r e   o u t l i n e   s t e p s   r e q u i r e d   s e t   p a c e m a k e r   c l u s t e r   i n c l u d e s   g f s 2   f i l e   s y s t e m   .   i n s t a l l i n g   s t a r t i n g   c l u s t e r   s o f t w a r e   n o d e s  ,   c r e a t e   c l u s t e r   .   c o n f i g u r e   f e n c i n g   c l u s t e r   .   i n f o r m a t i o n   c r e a t i n g   p a c e m a k e r   c l u s t e r   c o n f i g u r i n g   f e n c i n g   c l u s t e r  ,   c r e a t i n g   r e d   h i g h - a v a i l a b i l i t y   c l u s t e r   p a c e m a k e r   h i g h   a v a i l a b i l i t y   a d d - o n   a d m i n i s t r a t i o n   .  ,   p e r f o r m   p r o c e d u r e   .   n o d e s   c l u s t e r  ,   i n s t a l l   l v m 2 - c l u s t e r   g f s 2 - u t i l s   p a c k a g e s  ,   p a r t   r e s i l i e n t   s t o r a g e   c h a n n e l   .   #  y u m   i n s t a l l   l v m 2 - c l u s t e r   g f s 2 - u t i l s   s e t   g l o b a l   p a c e m a k e r   p a r a m e t e r   n o _ q u o r u m _ p o l i c y   f r e e z e   .   n o t e   #  p c s   p r o p e r t y   s e t   n o - q u o r u m - p o l i c y = f r e e z e   s e t   d l m   r e s o u r c e   .   r e q u i r e d   d e p e n d e n c y   c l v m d   g f s 2   .   #  p c s   r e s o u r c e   c r e a t e   d l m   o c f  :   p a c e m a k e r  :   c o n t r o l d   m o n i t o r   i n t e r v a l = 3 0 s   o n - f a i l = f e n c e   c l o n e   i n t e r l e a v e = t r u e   o r d e r e d = t r u e   e x e c u t e   c o m m a n d   n o d e   c l u s t e r   e n a b l e   c l u s t e r e d   l o c k i n g   .   c o m m a n d   s e t s   l o c k i n g _ t y p e   p a r a m e t e r   / e t c / l v m / l v m . c o n f   f i l e   3   .   #  / s b i n / l v m c o n f   - -   e n a b l e - c l u s t e r   s e t   c l v m d   c l u s t e r   r e s o u r c e   .   #  p c s   r e s o u r c e   c r e a t e   c l v m d   o c f  :   h e a r t b e a t  :   c l v m   m o n i t o r   i n t e r v a l = 3 0 s   o n - f a i l = f e n c e   c l o n e   i n t e r l e a v e = t r u e   o r d e r e d = t r u e   n o t e   c l v m d   c m i r r o r d   d e a m o n s   s t a r t e d   m a n a g e d   p a c e m a k e r   o c f  :   h e a r t b e a t  :   c l v m   r e s o u r c e   a g e n t   s t a r t e d   b o o t   s y s t e m d   .   a d d i t i o n a l l y  ,   o c f  :   h e a r t b e a t  :   c l v m   r e s o u r c e   a g e n t  ,   p a r t   s t a r t   p r o c e d u r e  ,   s e t s   l o c k i n g _ t y p e   p a r a m e t e r   / e t c / l v m / l v m . c o n f   f i l e   3   d i s a b l e s   l v m e t a d   d a e m o n   .   s e t   c l v m d   d l m   d e p e n d e n c y   s t a r t   o r d e r   .   c l v m d   s t a r t   d l m   r u n   n o d e   d l m   .   #  p c s   c o n s t r a i n t   o r d e r   s t a r t   d l m - c l o n e   c l v m d - c l o n e   #  p c s   c o n s t r a i n t   c o l o c a t i o n   a d d   c l v m d - c l o n e   d l m - c l o n e   c r e a t e   c l u s t e r e d   l o g i c a l   v o l u m e   .   #  p v c r e a t e   / d e v / v d b   #  v g c r e a t e   - a y   - c y   s a s b i n _ v g   / d e v / v d b   #  l v c r e a t e   - l 5 g   - n   s a s b i n _ l v   s a s b i n _ v g   w a r n i n g   f o r m a t   l o g i c a l   v o l u m e   g f s 2   f i l e   s y s t e m   .   j o u r n a l   r e q u i r e d   n o d e   m o u n t s   f i l e   s y s t e m   .   e n s u r e   c r e a t e   j o u r n a l s   n o d e s   c l u s t e r   .   #  m k f s . g f s 2   - j 2   - p   l o c k _ d l m   - t   r h e l 7 - d e m o  :   s a s b i n   / d e v / s a s b i n _ v g / s a s b i n _ l v   w a r n i n g   c o n f i g u r e   c l u s t e r f s   r e s o u r c e   .   a d d   f i l e   s y s t e m   / e t c / f s t a b   f i l e   m a n a g e d   p a c e m a k e r   c l u s t e r   r e s o u r c e   .   m o u n t   o p t i o n s   s p e c i f i e d   p a r t   r e s o u r c e   c o n f i g u r a t i o n   o p t i o n s = o p t i o n s   .   r u n   p c s   r e s o u r c e   d e s c r i b e   f i l e s y s t e m   c o m m a n d   f u l l   c o n f i g u r a t i o n   o p t i o n s   .   c l u s t e r   r e s o u r c e   c r e a t i o n   c o m m a n d   s p e c i f i e s   n o a t i m e   m o u n t   o p t i o n  ,   r e c o m m e n d e d   g f s 2   f i l e   s y s t e m s   a p p l i c a t i o n   .  ,   f i l e   s y s t e m   m o u n t   p o i n t   .   r e q u i r e m e n t  ,   r e c o m m e n d e d   f i l e   s y s t e m   r e l a t e   a c t u a l   m o u n t   p o i n t   t r o u b l e s h o o t i n g   f i l e   s y s t e m   e n c o u n t e r   p r o b l e m   .   #  #  p c s   r e s o u r c e   c r e a t e   c l u s t e r f s   f i l e s y s t e m   d e v i c e =  ' '   / d e v / s a s b i n _ v g / s a s b i n _ l v  ' '   d i r e c t o r y =  ' '   / u s r / l o c a l / s a s b i n  ' '   f s t y p e =  ' '   g f s 2  ' '   o p t i o n s =  ' '   n o a t i m e  ' '   m o n i t o r   i n t e r v a l = 1 0 s   o n - f a i l = f e n c e   c l o n e   i n t e r l e a v e = t r u e   s e t   g f s 2   c l v m d   d e p e n d e n c y   s t a r t u p   o r d e r   .   g f s 2   s t a r t   c l v m d   r u n   n o d e   c l v m d   .   #  p c s   c o n s t r a i n t   o r d e r   s t a r t   c l v m d - c l o n e   c l u s t e r f s - c l o n e   #  p c s   c o n s t r a i n t   c o l o c a t i o n   a d d   c l u s t e r f s - c l o n e   c l v m d - c l o n e   v e r i f y   g f s 2   m o u n t e d   e x p e c t e d   .   #  m o u n t   | g r e p   s a s   / d e v / m a p p e r / s a s b i n _ v g - s a s b i n _ l v   / u s r / l o c a l / s a s b i n   t y p e   g f s 2   (  r w  ,   n o a t i m e  ,   s e c l a b e l  )   a p p e n d i x   a .   g f s 2   p e r f o r m a n c e   a n a l y s i s   p e r f o r m a n c e   c o - p i l o t   r e d   e n t e r p r i s e   l i n u x   7   s u p p o r t s   p e r f o r m a n c e   c o - p i l o t   (  p c p  )   g f s 2   p e r f o r m a n c e   m e t r i c s   .   m o n i t o r   p e r f o r m a n c e   g f s 2   f i l e   s y s t e m   .   a p p e n d i x   d e s c r i b e s   g f s 2   p e r f o r m a n c e   m e t r i c s   .   a . 1   .   o v e r v i e w   p e r f o r m a n c e   c o - p i l o t   p e r f o r m a n c e   c o - p i l o t   (  p c p  )   o p e n   s o u r c e   t o o l k i t   m o n i t o r i n g  ,   v i s u a l i z i n g  ,   r e c o r d i n g  ,   c o n t r o l l i n g   s t a t u s  ,   a c t i v i t i e s   p e r f o r m a n c e   c o m p u t e r s  ,   a p p l i c a t i o n s   s e r v e r s   .   p c p   m o n i t o r i n g   m a n a g e m e n t   r e a l - t i m e   d a t a   l o g g i n g   r e t r i e v a l   h i s t o r i c a l   d a t a   .   h i s t o r i c a l   d a t a   a n a l y z e   p a t t e r n s   i s s u e s   c o m p a r i n g   l i v e   r e s u l t s   a r c h i v e d   d a t a   .   p c p   d e s i g n e d   c l i e n t - s e r v e r   a r c h i t e c t u r e   .   p c p   c o l l e c t o r   s e r v i c e   p e r f o r m a n c e   m e t r i c   c o l l e c t o r   d a e m o n   (  p m c d  )  ,   i n s t a l l e d   r u n   s e r v e r   .   s t a r t e d  ,   p c m d   b e g i n s   c o l l e c t i n g   p e r f o r m a n c e   d a t a   i n s t a l l e d   p e r f o r m a n c e   m e t r i c   d o m a i n   a g e n t s   (  p m d a s  )   .   p m d a s   i n d i v i d u a l l y   l o a d e d   u n l o a d e d   s y s t e m   c o n t r o l l e d   p m c d   h o s t   .   g f s 2   p m d a  ,   p a r t   d e f a u l t   p c p   i n s t a l l a t i o n  ,   .   g a t h e r   p e r f o r m a n c e   m e t r i c   d a t a   g f s 2   f i l e   s y s t e m s   p c p   .   t a b l e   a . 1  ,   “   p c p   t o o l s   ”   l i s t   p c p   t o o l s   p c p   t o o l k i t   c h a p t e r   d e s c r i b e s   .   i n f o r m a t i o n   a d d i t i o n a l   p c p   t o o l s  ,   p c p i n t r o   (  1  )   p a g e   a d d i t i o n a l   p c p   p a g e s   .   a . 2   .   p c p   d e p l o y m e n t   m o n i t o r   e n t i r e   c l u s t e r  ,   r e c o m m e n d e d   a p p r o a c h   i n s t a l l   c o n f i g u r e   p c p   g f s 2   p m d a   e n a b l e d   l o a d e d   n o d e   c l u s t e r   p c p   s e r v i c e s   .   m o n i t o r   n o d e s   l o c a l l y   r e m o t e l y   m a c h i n e   p c p   i n s t a l l e d   c o r r e s p o n d i n g   p m d a s   l o a d e d   m o n i t o r   .   i n s t a l l   o p t i o n a l   p c p - g u i   p a c k a g e   g r a p h i c a l   r e p r e s e n t a t i o n   t r a c e   d a t a   p m c h a r t   t o o l   a d d i t i o n a l   i n f o r m a t i o n  ,   p c p - d o c   p a c k a g e  ,   i n s t a l l e d   / u s r / s h a r e / d o c / p c p - d o c   d e f a u l t   .   p c p   p a g e   t o o l   .   a . 3   .   p c p   i n s t a l l a t i o n   r e c e n t   t e s t e d   v e r s i o n   p c p   a v a i l a b l e   d o w n l o a d   r e d   e n t e r p r i s e   l i n u x   7   r e p o s i t o r i e s   .   d e b u g f s   f i l e   s y s t e m   m o u n t e d   o r d e r   g f s 2   p m d a   o p e r a t e   c o r r e c t l y   .   d e b u g f s   f i l e   s y s t e m   m o u n t e d  ,   r u n   c o m m a n d s   c o m m a n d s   i n s t a l l i n g   g f s 2   p m d a   .   #  m k d i r   / s y s / k e r n e l / d e b u g   #  m o u n t   - t   d e b u g f s   / s y s / k e r n e l / d e b u g   g f s 2   p m d a   e n a b l e d   d e f a u l t   i n s t a l l a t i o n   .   o r d e r   g f s 2   m e t r i c   m o n i t o r i n g   p c p  ,   e n a b l e   g f s 2   d o m a i n   a g e n t   .   c o m m a n d s   i n s t a l l   p c p   g f s 2   p m d a   m o d u l e   e n a b l e   g f s 2   p m d a   .   n o t e   p m d a   i n s t a l l   s c r i p t   r u n   r o o t   .   #  y u m   i n s t a l l   p c p   p c p - g u i   p c p - p m d a - g f s 2   #  c d   / v a r / l i b / p c p / p m d a s / g f s 2   #  . / i n s t a l l   r u n n i n g   p m d a   i n s t a l l a t i o n   s c r i p t  ,   p r o m p t e d   r o l e   p m d a  :   c o l l e c t o r   c o l l e c t i o n   p e r f o r m a n c e   m e t r i c s   c u r r e n t   s y s t e m   m o n i t o r   s y s t e m   m o n i t o r   l o c a l   s y s t e m   r e m o t e   s y s t e m s   l o c a l   r e m o t e   s y s t e m   e n a b l e s   c o l l e c t o r   m o n i t o r   c o n f i g u r a t i o n s   c a s e s   d e f a u l t   c h o i c e   (  c o l l e c t o r   m o n i t o r  )   s u f f i c i e n t   p m d a   o p e r a t e   c o r r e c t l y   .   #  . / i n s t a l l   c h o o s e   a p p r o p r i a t e   c o n f i g u r a t i o n   i n s t a l l a t i o n   ` `   g f s 2  ' '   p e r f o r m a n c e   m e t r i c s   d o m a i n   a g e n t   (  p m d a  )   .   c o l l e c t o r   c o l l e c t   p e r f o r m a n c e   s t a t i s t i c s   s y s t e m   m o n i t o r   s y s t e m   m o n i t o r   l o c a l   a n d / o r   r e m o t e   s y s t e m s   c o l l e c t o r   m o n i t o r   c o n f i g u r a t i o n   s y s t e m   e n t e r   (  o l l e c t o r  )   (  o n i t o r  )   b   (  o t h  )   [  b  ]   u p d a t i n g   p e r f o r m a n c e   m e t r i c s   s p a c e   (  p m n s  )   . . .   t e r m i n a t e   p m d a   i n s t a l l e d   . . .   u p d a t i n g   p m c d   c o n t r o l   f i l e  ,   n o t i f y i n g   p m c d   . . .   w a i t i n g   p m c d   t e r m i n a t e   . . .   s t a r t i n g   p m c d   . . .   s t a r t i n g   p m l o g g e r   . . .   c h e c k   g f s 2   m e t r i c s   a p p e a r e d   . . .   3 1 6   m e t r i c s   2 0 5   v a l u e s   e r r o r s   w a r n i n g   i n s t a l l a t i o n   g f s 2   p m d a  ,   m a k e   p m c d   s t a r t e d   r u n n i n g   d e b u g f s   m o u n t e d   (  w a r n i n g s   e v e n t   g f s 2   f i l e   s y s t e m   l o a d e d   s y s t e m  )   .   n o t e   a . 4   .   t r a c i n g   g f s 2   p e r f o r m a n c e   d a t a   p c p   i n s t a l l e d   g f s 2   p m d a   e n a b l e d  ,   e a s i e s t   s t a r t   p e r f o r m a n c e   m e t r i c s   a v a i l a b l e   p c p   g f s 2   m a k e   p m i n f o   t o o l   .   p m i n f o   c o m m a n d   l i n e   t o o l   d i s p l a y s   i n f o r m a t i o n   a v a i l a b l e   p e r f o r m a n c e   m e t r i c s   .   p m i n f o   o p e r a t e s   l o c a l   m e t r i c   n a m e s p a c e   c h a n g e   v i e w   m e t r i c s   r e m o t e   h o s t   - h   f l a g  ,   i n f o r m a t i o n   p m i n f o   t o o l  ,   p m i n f o   (  1  )   p a g e   .   c o m m a n d   d i s p l a y s   l i s t   a v a i l a b l e   g f s 2   m e t r i c s   p r o v i d e d   g f s 2   p m d a   .   #  p m i n f o   g f s 2   s p e c i f y   - t   f l a g   o r d e r   o b t a i n   i n f o r m a t i o n   d e s c r i p t i o n s   m e t r i c   - f   f l a g   o b t a i n   c u r r e n t   r e a d i n g   p e r f o r m a n c e   v a l u e   c o r r e s p o n d s   m e t r i c   .   g r o u p   m e t r i c s   i n d i v i d u a l   m e t r i c   .   m e t r i c   d a t a   p r o v i d e d   m o u n t e d   g f s 2   f i l e   s y s t e m   s y s t e m   t i m e   p r o b i n g   .   #  p m i n f o   - t   g f s 2 . g l o c k s   g f s 2 . g l o c k s . t o t a l   [  c o u n t   t o t a l   o b s e r v e d   i n c o r e   g f s 2   g l o b a l   l o c k s  ]   g f s 2 . g l o c k s . s h a r e d   [  g f s 2   g l o b a l   l o c k s   s h a r e d   s t a t e  ]   g f s 2 . g l o c k s . u n l o c k e d   [  g f s 2   g l o b a l   l o c k s   u n l o c k e d   s t a t e  ]   g f s 2 . g l o c k s . d e f e r r e d   [  g f s 2   g l o b a l   l o c k s   d e f e r r e d   s t a t e  ]   g f s 2 . g l o c k s . e x c l u s i v e   [  g f s 2   g l o b a l   l o c k s   e x c l u s i v e   s t a t e  ]   #  p m i n f o   - t   g f s 2 . g l o c k s . t o t a l   g f s 2 . g l o c k s . t o t a l  :   c o u n t   t o t a l   i n c o r e   g f s 2   g l o c k   d a t a   s t r u c t u r e s   b a s e d   p a r s i n g   c o n t e n t s   / s y s / k e r n e l / d e b u g / g f s 2 / b d e v / g l o c k s   f i l e s   .   #  p m i n f o   - f   g f s 2 . g l o c k s . t o t a l   g f s 2 . g l o c k s . t o t a l   i n s t   [  0   ` `   t e s t c l u s t e r  :   c l v m d _ g f s 2  ' '  ]   v a l u e   7 4   d i f f e r e n t   g r o u p s   g f s 2   m e t r i c s  ,   a r r a n g e d   d i f f e r e n t   g r o u p   l e a f   n o d e   r o o t   g f s 2   m e t r i c  '   .  '   s e p a r a t o r  ;   p c p   m e t r i c s   .   t a b l e   a . 2  ,   “   p c p   m e t r i c   g r o u p s   g f s 2   ”   o u t l i n e s   t y p e s   m e t r i c s   a v a i l a b l e   g r o u p s   .   m e t r i c  ,   a d d i t i o n a l   i n f o r m a t i o n   f o u n d   p m i n f o   t o o l   - t   f l a g   .   a . 5   .   m e t r i c   c o n f i g u r a t i o n   (  p m s t o r e  )   m e t r i c s   p c p   m o d i f i c a t i o n   v a l u e s  ,   e s p e c i a l l y   c a s e   m e t r i c   a c t s   c o n t r o l   v a r i a b l e   .   c a s e   g s f 2 . c o n t r o l   .   *   m e t r i c s   g f s 2   p m d a   .   a c h i e v e d   p m s t o r e   c o m m a n d   l i n e   t o o l   .   p c p   t o o l s  ,   p m s t o r e   t o o l   c h a n g e s   c u r r e n t   v a l u e   s p e c i f i e d   m e t r i c   l o c a l   s y s t e m  ,   - h   s w i t c h   c h a n g e   m e t r i c   v a l u e s   s p e c i f i e d   r e m o t e   s y s t e m s   .   i n f o r m a t i o n  ,   p m s t o r e   (  3  )   p a g e   .  ,   c o m m a n d   e n a b l e s   g s f 2   t r a c e p o i n t s   l o c a l   m a c h i n e   s y s t e m   g f s 2   p m d a   i n s t a l l e d   l o a d e d   .   c o m m a n d   r u n  ,   p m d a   s w i t c h   g f s 2   t r a c e p o i n t s   d e b u g f s   f i l e   s y s t e m   .   #  p m s t o r e   g f s 2 . c o n t r o l . t r a c e p o i n t s . a l l   1   g f s 2 . c o n t r o l . t r a c e p o i n t s . a l l   v a l u e = 0   v a l u e = 1   t a b l e   a . 3  ,   “   c o n t r o l   t r a c e p o i n t s   ”   d e s c r i b e s   c o n t r o l   t r a c e p o i n t s   u s a g e   .   e x p l a n a t i o n   e f f e c t   c o n t r o l   t r a c e p o i n t   a v a i l a b l e   o p t i o n s   a v a i l a b l e   s w i t c h   p m i n f o   t o o l   .   a . 6   .   l o g g i n g   p e r f o r m a n c e   d a t a   (  p m l o g g e r  )   p c p   p e r f o r m a n c e   m e t r i c   v a l u e s   r e p l a y e d   d a t e   c r e a t i n g   a r c h i v e d   l o g s   s e l e c t e d   m e t r i c s   s y s t e m   p m l o g g e r   t o o l   .   m e t r i c   a r c h i v e s   p l a y e d   b a c k   d a t e   g i v e   r e t r o s p e c t i v e   p e r f o r m a n c e   a n a l y s i s   .   p m l o g g e r   t o o l   f l e x i b i l i t y   c o n t r o l   l o g g e d   m e t r i c s   a l l o w i n g   s p e c i f y   m e t r i c s   r e c o r d e d   s y s t e m   f r e q u e n c y   .   d e f a u l t  ,   c o n f i g u r a t i o n   f i l e   p m l o g g e r   s t o r e d   / v a r / l i b / p c p / c o n f i g / p m l o g g e r / c o n f i g . d e f a u l t  ;   c o n f i g u r a t i o n   f i l e   o u t l i n e s   m e t r i c s   l o g g e d   p r i m a r y   l o g g i n g   i n s t a n c e   .   o r d e r   p m l o g g e r   m e t r i c   v a l u e s   l o c a l   m a c h i n e  ,   p r i m a r y   l o g g i n g   i n s t a n c e   s t a r t e d   .   s y s t e m c t l   e n s u r e   p m l o g g e r   s t a r t e d   s e r v i c e   m a c h i n e   s t a r t s   .   s h o w s   e x t r a c t   p m l o g g e r   c o n f i g u r a t i o n   f i l e   e n a b l e s   r e c o r d i n g   g f s 2   p e r f o r m a n c e   m e t r i c s   .   e x t r a c t   s h o w s   p m l o g g e r   p e r f o r m a n c e   m e t r i c   v a l u e s   p c p   g f s 2   l a t e n c y   m e t r i c s   1 0   s e c o n d s  ,   t o p   1 0   w o r s t   g l o c k   m e t r i c   3 0   s e c o n d s  ,   t r a c e p o i n t   d a t a   m i n u t e  ,   d a t a   g l o c k  ,   g l s t a t s   s b s t a t s   m e t r i c s   1 0   m i n u t e s   .   #  s a f e   m a k e   a d d i t i o n s   . . .   #  m a n d a t o r y   5   s e c o n d s   {  g f s 2 . l a t e n c y . g r a n t   g f s 2 . l a t e n c y . q u e u e   g f s 2 . l a t e n c y . d e m o t e   g f s 2 . g l o c k s  }   m a n d a t o r y   1 0   s e c o n d s   {  g f s 2 . w o r s t _ g l o c k  }   m a n d a t o r y   3 0   s e c o n d s   {  g f s 2 . t r a c e p o i n t s  }   m a n d a t o r y   5   m i n u t e s   {  g f s 2 . g l s t a t s   g f s 2 . s b s t a t s  }   [  a c c e s s  ]   d i s a l l o w   *  :  ;   l o c a l h o s t  :   e n q u i r e  ;   n o t e   r e c o r d i n g   m e t r i c   d a t a  ,   m u l t i p l e   o p t i o n s   r e p l a y i n g   p c p   a r c h i v e s   s y s t e m   .   e x p o r t   l o g s   t e x t   f i l e s   i m p o r t   s p r e a d s h e e t s  ,   r e p l a y   p c p - g u i   a p p l i c a t i o n   g r a p h s   v i s u a l i z e   r e t r o s p e c t i v e   d a t a   a l o n g s i d e   l i v e   d a t a   s y s t e m   .   t o o l s   a v a i l a b l e   p c p   v i e w i n g   f i l e s   p m d u m p t e x t   .   t o o l   u s e r   p a r s e   s e l e c t e d   p c p   a r c h i v e   e x p o r t   v a l u e s   a s c i i   t a b l e   .   p m d u m p t e x t   d u m p   e n t i r e   a r c h i v e   s e l e c t   m e t r i c   v a l u e s   s p e c i f y i n g   i n d i v i d u a l   m e t r i c s   c o m m a n d   l i n e   .   i n f o r m a t i o n   p m d u m p t e x t  ,   p m d u m p t e x t   (  1  )   p a g e   .   a . 7   .   v i s u a l   t r a c i n g   (  p c p - g u i   p m c h a r t  )   p c p - g u i   p a c k a g e  ,   p m c h a r t   g r a p h i c a l   u t i l i t y   p l o t   p e r f o r m a n c e   m e t r i c   v a l u e s   g r a p h s   .   p m c h a r t   u t i l i t y   m u l t i p l e   c h a r t s   d i s p l a y e d   s i m u l t a n e o u s l y  ,   m e t r i c s   s o u r c e d   l i v e   h o s t s   a l t e r n a t i v e   o p t i o n s   m e t r i c   d a t a   p c p   a r c h i v e s   s o u r c e   h i s t o r i c a l   d a t a   .   o p e n   p m c h a r t  ,   p c p   c h a r t s   g u i   d i s p l a y s   .   b o t t o m   d i s p l a y   p m t i m e   v c r - l i k e   c o n t r o l s   .   s t a r t / p a u s e   b u t t o n   c o n t r o l   i n t e r v a l   m e t r i c   d a t a   p o l l e d   e v e n t   h i s t o r i c a l   d a t a  ,   d a t e   t i m e   m e t r i c s   .   f i l e   -  >   c h a r t   o p t i o n   t o o l b a r  ,   s e l e c t   m e t r i c   l o c a l   m a c h i n e   r e m o t e   m a c h i n e s   s p e c i f y i n g   h o s t   a d d r e s s   s e l e c t i n g   p e r f o r m a n c e   m e t r i c s   r e m o t e   h o s t s   .   a d v a n c e d   c o n f i g u r a t i o n   o p t i o n s   i n c l u d e   a b i l i t y   m a n u a l l y   s e t   a x i s   v a l u e s   c h a r t   m a n u a l l y   c h o o s e   c o l o r   p l o t s   .   m u l t i p l e   o p t i o n s   i m a g e s   r e c o r d   v i e w s   c r e a t e d   p m c h a r t   .   s a v e   i m a g e   c u r r e n t   v i e w   f i l e   -  >   e x p o r t   o p t i o n   t o o l b a r   .   r e c o r d i n g   m a d e   a v a i l a b l e   r e c o r d   -  >   s t a r t   o p t i o n   t o o l b a r   r e c o r d i n g s   s t o p p e d   t i m e   r e c o r d   -  >   s t o p   .   r e c o r d i n g   t e r m i n a t e d  ,   r e c o r d e d   m e t r i c s   a r c h i v e d   v i e w e d   d a t e   .   c u s t o m i z e   p m c h a r t   i n t e r f a c e   d i s p l a y   d a t a   p e r f o r m a n c e   m e t r i c s   m u l t i p l e   w a y s  ,   i n c l u d i n g   l i n e   p l o t  ,   b a r   g r a p h s   u t i l i z a t i o n   g r a p h s   .   p m c h a r t  ,   c o n f i g u r a t i o n   f i l e   “   v i e w   ”   m e t a d a t a   a s s o c i a t e d   c h a r t s   s a v e d   .   m e t a d a t a   d e s c r i b e s   c h a r t  ' s   a s p e c t s   i n c l u d i n g   m e t r i c s   c h a r t   c o l u m n s   .   c r e a t e   c u s t o m   “   v i e w   ”   c o n f i g u r a t i o n   s a v e d   f i l e   -  >   s a v e   v i e w   l o a d e d   t i m e   .   i n f o r m a t i o n   v i e w   c o n f i g u r a t i o n   f i l e s   s y n t a x  ,   p m c h a r t   (  1  )   p a g e   .   p m c h a r t   v i e w   c o n f i g u r a t i o n   d e s c r i b e s   s t a c k i n g   c h a r t   g r a p h   s h o w i n g   t o t a l   n u m b e r   g l o c k s   m o u n t e d   g f s 2   f i l e   s y s t e m   l o o p 1   g f s 2 . g l o c k s   m e t r i c   .   p l o t   g r a p h   u n d e r n e a t h   p l o t s   a v e r a g e   l a t e n c y   g l o c k   g r a n t  ,   d e m o t e   q u e u e   r e q u e s t s   f i l e   s y s t e m   i n s t a n c e   “   l o o p 1   ”   .   #  k m c h a r t   v e r s i o n   1   c h a r t   t i t l e   ` `   t o t a l   n u m b e r   g l o c k s   / l o o p 1  ' '   s t y l e   s t a c k i n g   a n t i a l i a s i n g   p l o t   l e g e n d   ` `   s h a r e d  ' '   m e t r i c   g f s 2 . g l o c k s . s h a r e d   i n s t a n c e   ` `   l o o p 1  ' '   p l o t   l e g e n d   ` `   u n l o c k e d  ' '   m e t r i c   g f s 2 . g l o c k s . u n l o c k e d   i n s t a n c e   ` `   l o o p 1  ' '   p l o t   l e g e n d   ` `   d e f e r r e d  ' '   m e t r i c   g f s 2 . g l o c k s . d e f e r r e d   i n s t a n c e   ` `   l o o p 1  ' '   p l o t   l e g e n d   ` `   e x c l u s i v e  ' '   m e t r i c   g f s 2 . g l o c k s . e x c l u s i v e   i n s t a n c e   ` `   l o o p 1  ' '   c h a r t   t i t l e   ` `   a v e r a g e   g l o c k   l a t e n c y   (  u s e c s  )   / l o o p 1  ' '   s t y l e   p l o t   a n t i a l i a s i n g   p l o t   l e g e n d   ` `   d e m o t e  ' '   m e t r i c   g f s 2 . l a t e n c y . d e m o t e . a l l   i n s t a n c e   ` `   l o o p 1  ' '   p l o t   l e g e n d   ` `   g r a n t  ' '   m e t r i c   g f s 2 . l a t e n c y . g r a n t . a l l   i n s t a n c e   ` `   l o o p 1  ' '   p l o t   l e g e n d   ` `   q u e u e  ' '   m e t r i c   g f s 2 . l a t e n c y . q u e u e . a l l   i n s t a n c e   ` `   l o o p 1  ' '   a p p e n d i x   b .   g f s 2   t r a c e p o i n t s   d e b u g f s   g l o c k s   f i l e   a p p e n d i x   d e s c r i b e s   g l o c k   d e b u g f s   i n t e r f a c e   g f s 2   t r a c e p o i n t s   .   i n t e n d e d   a d v a n c e d   u s e r s   f a m i l i a r   f i l e   s y s t e m   i n t e r n a l s   l e a r n   d e s i g n   g f s 2   d e b u g   g f s 2 - s p e c i f i c   i s s u e s   .   b . 1   .   g f s 2   t r a c e p o i n t   t y p e s   c u r r e n t l y   t y p e s   g f s 2   t r a c e p o i n t s  :   g l o c k   (  p r o n o u n c e d   ` `   g e e - l o c k  ' '  )   t r a c e p o i n t s  ,   b m a p   t r a c e p o i n t s   t r a c e p o i n t s   .   m o n i t o r   r u n n i n g   g f s 2   f i l e   s y s t e m   g i v e   a d d i t i o n a l   i n f o r m a t i o n   o b t a i n e d   d e b u g g i n g   o p t i o n s   s u p p o r t e d   p r e v i o u s   r e l e a s e s   r e d   e n t e r p r i s e   l i n u x   .   t r a c e p o i n t s   p a r t i c u l a r l y   p r o b l e m  ,   h a n g   p e r f o r m a n c e   i s s u e  ,   r e p r o d u c i b l e   t r a c e p o i n t   o u t p u t   o b t a i n e d   p r o b l e m a t i c   o p e r a t i o n   .   g f s 2  ,   g l o c k s   p r i m a r y   c a c h e   c o n t r o l   m e c h a n i s m   k e y   u n d e r s t a n d i n g   p e r f o r m a n c e   c o r e   g f s 2   .   b m a p   (  b l o c k   m a p  )   t r a c e p o i n t s   m o n i t o r   b l o c k   a l l o c a t i o n s   b l o c k   m a p p i n g   (  l o o k u p   a l l o c a t e d   b l o c k s   o n - d i s k   m e t a d a t a   t r e e  )   h a p p e n   c h e c k   i s s u e s   r e l a t i n g   l o c a l i t y   a c c e s s   .   t r a c e p o i n t s   t r a c k   d a t a   w r i t t e n   r e l e a s e d   j o u r n a l   p r o v i d e   i n f o r m a t i o n   p a r t   g f s 2   .   t r a c e p o i n t s   d e s i g n e d   g e n e r i c   p o s s i b l e   .   c h a n g e   a p i   c o u r s e   r e d   e n t e r p r i s e   l i n u x   7 .   h a n d  ,   u s e r s   i n t e r f a c e   a w a r e   d e b u g g i n g   i n t e r f a c e   p a r t   n o r m a l   r e d   e n t e r p r i s e   l i n u x   7   a p i   s e t  ,   r e d   m a k e s   g u a r a n t e e s   c h a n g e s   g f s 2   t r a c e p o i n t s   i n t e r f a c e   o c c u r   .   t r a c e p o i n t s   g e n e r i c   f e a t u r e   r e d   e n t e r p r i s e   l i n u x   7   s c o p e   g f s 2   .   p a r t i c u l a r   i m p l e m e n t   b l k t r a c e   i n f r a s t r u c t u r e   b l k t r a c e   t r a c e p o i n t s   c o m b i n a t i o n   g f s 2   f u l l e r   p i c t u r e   s y s t e m   p e r f o r m a n c e   .   d u e   l e v e l   t r a c e p o i n t s   o p e r a t e  ,   p r o d u c e   l a r g e   v o l u m e s   d a t a   s h o r t   p e r i o d   t i m e   .   d e s i g n e d   p u t   m i n i m u m   l o a d   s y s t e m   e n a b l e d  ,   i n e v i t a b l e   e f f e c t   .   f i l t e r i n g   e v e n t s   v a r i e t y   m e a n s   r e d u c e   v o l u m e   d a t a   f o c u s   o b t a i n i n g   i n f o r m a t i o n   u n d e r s t a n d i n g   p a r t i c u l a r   s i t u a t i o n   .   b . 2   .   t r a c e p o i n t s   t r a c e p o i n t s   f o u n d   / s y s / k e r n e l / d e b u g / t r a c i n g /   d i r e c t o r y   a s s u m i n g   d e b u g f s   m o u n t e d   s t a n d a r d   p l a c e   / s y s / k e r n e l / d e b u g   d i r e c t o r y   .   e v e n t s   s u b d i r e c t o r y   c o n t a i n s   t r a c i n g   e v e n t s   s p e c i f i e d  ,   p r o v i d e d   g f s 2   m o d u l e   l o a d e d  ,   g f s 2   s u b d i r e c t o r y   c o n t a i n i n g   s u b d i r e c t o r i e s  ,   g f s 2   e v e n t   .   c o n t e n t s   / s y s / k e r n e l / d e b u g / t r a c i n g / e v e n t s / g f s 2   d i r e c t o r y   r o u g h l y  :   [  r o o t   @   c h y w o o n   g f s 2  ]   #  l s   e n a b l e   g f s 2 _ b m a p   g f s 2 _ g l o c k _ q u e u e   g f s 2 _ l o g _ f l u s h   f i l t e r   g f s 2 _ d e m o t e _ r q   g f s 2 _ g l o c k _ s t a t e _ c h a n g e   g f s 2 _ p i n   g f s 2 _ b l o c k _ a l l o c   g f s 2 _ g l o c k _ p u t   g f s 2 _ l o g _ b l o c k s   g f s 2 _ p r o m o t e   e n a b l e   g f s 2   t r a c e p o i n t s  ,   e n t e r   c o m m a n d  :   [  r o o t   @   c h y w o o n   g f s 2  ]   #  e c h o   - n   1  >   / s y s / k e r n e l / d e b u g / t r a c i n g / e v e n t s / g f s 2 / e n a b l e   e n a b l e   s p e c i f i c   t r a c e p o i n t  ,   e n a b l e   f i l e   i n d i v i d u a l   e v e n t   s u b d i r e c t o r i e s   .   f i l t e r   f i l e   s e t   e v e n t   f i l t e r   e v e n t   s e t   e v e n t s   .   m e a n i n g   i n d i v i d u a l   e v e n t s   e x p l a i n e d   d e t a i l   .   o u t p u t   t r a c e p o i n t s   a v a i l a b l e   a s c i i   b i n a r y   f o r m a t   .   a p p e n d i x   c u r r e n t l y   c o v e r   b i n a r y   i n t e r f a c e   .   a s c i i   i n t e r f a c e   a v a i l a b l e   w a y s   .   l i s t   c u r r e n t   c o n t e n t   r i n g   b u f f e r  ,   e n t e r   c o m m a n d  :   [  r o o t   @   c h y w o o n   g f s 2  ]   #  / s y s / k e r n e l / d e b u g / t r a c i n g / t r a c e   i n t e r f a c e   c a s e s   l o n g - r u n n i n g   p r o c e s s   p e r i o d   t i m e  ,   e v e n t  ,   b a c k   l a t e s t   c a p t u r e d   i n f o r m a t i o n   b u f f e r   .   a l t e r n a t i v e   i n t e r f a c e  ,   / s y s / k e r n e l / d e b u g / t r a c i n g / t r a c e _ p i p e  ,   o u t p u t   r e q u i r e d   .   e v e n t s   r e a d   f i l e   o c c u r  ;   h i s t o r i c a l   i n f o r m a t i o n   a v a i l a b l e   i n t e r f a c e   .   f o r m a t   o u t p u t   i n t e r f a c e s   d e s c r i b e d   g f s 2   e v e n t s   s e c t i o n s   a p p e n d i x   .   u t i l i t y   c a l l e d   t r a c e - c m d   a v a i l a b l e   r e a d i n g   t r a c e p o i n t   d a t a   .   i n f o r m a t i o n   u t i l i t y  ,   l i n k   s e c t i o n   b . 1 0  ,   “   r e f e r e n c e s   ”   .   t r a c e - c m d   u t i l i t y   s i m i l a r   s t r a c e   u t i l i t y  ,   r u n   c o m m a n d   g a t h e r i n g   t r a c e   d a t a   s o u r c e s   .   b . 3   .   g l o c k s   u n d e r s t a n d   g f s 2  ,   i m p o r t a n t   c o n c e p t   u n d e r s t a n d  ,   s e t s   f i l e   s y s t e m s  ,   c o n c e p t   g l o c k s   .   t e r m s   s o u r c e   c o d e  ,   g l o c k   d a t a   s t r u c t u r e   b r i n g s   d l m   c a c h i n g   s i n g l e   s t a t e   m a c h i n e   .   g l o c k   1: 1   r e l a t i o n s h i p   s i n g l e   d l m   l o c k  ,   c a c h i n g   l o c k   s t a t e   r e p e t i t i v e   o p e r a t i o n s   c a r r i e d   s i n g l e   n o d e   f i l e   s y s t e m   r e p e a t e d l y   c a l l   d l m  ,   a v o i d   u n n e c e s s a r y   n e t w o r k   t r a f f i c   .   b r o a d   c a t e g o r i e s   g l o c k s  ,   c a c h e   m e t a d a t a   .   i n o d e   g l o c k s   r e s o u r c e   g r o u p   g l o c k s   c a c h e   m e t a d a t a  ,   t y p e s   g l o c k s   c a c h e   m e t a d a t a   .   i n o d e   g l o c k   i n v o l v e d   c a c h i n g   d a t a   a d d i t i o n   m e t a d a t a   c o m p l e x   l o g i c   g l o c k s   .   g l o c k s   r e m a i n   m e m o r y   u n l o c k e d   (  r e q u e s t   n o d e   r e q u e s t   v m  )   l o c a l   u s e r s   .   p o i n t   r e m o v e d   g l o c k   h a s h   t a b l e   f r e e d   .   g l o c k   c r e a t e d  ,   d l m   l o c k   a s s o c i a t e d   g l o c k   i m m e d i a t e l y   .   d l m   l o c k   a s s o c i a t e d   g l o c k   r e q u e s t   d l m  ,   r e q u e s t   s u c c e s s f u l  '  '   (  i n i t i a l  )   f l a g   s e t   g l o c k   .   t a b l e   b . 4  ,   “   g l o c k   f l a g s   ”   s h o w s   m e a n i n g s   d i f f e r e n t   g l o c k   f l a g s   .   d l m   a s s o c i a t e d   g l o c k  ,   d l m   l o c k   r e m a i n   n l   (  n u l l  )   l o c k   g l o c k   f r e e d   .   d e m o t i o n   d l m   l o c k   n l   u n l o c k e d   o p e r a t i o n   l i f e   g l o c k   .   g l o c k   n u m b e r   ` `   h o l d e r s  ' '   a s s o c i a t e d  ,   r e p r e s e n t s   l o c k   r e q u e s t   h i g h e r   l a y e r s   .   s y s t e m   c a l l s   r e l a t i n g   g f s 2   q u e u e   d e q u e u e   h o l d e r s   g l o c k   p r o t e c t   c r i t i c a l   s e c t i o n   c o d e   .   g l o c k   s t a t e   m a c h i n e   b a s e d   w o r k   q u e u e   .   p e r f o r m a n c e   r e a s o n s  ,   t a s k l e t s   p r e f e r a b l e  ;  ,   c u r r e n t   i m p l e m e n t a t i o n   s u b m i t   i / o   c o n t e x t   p r o h i b i t s   .   n o t e   t a b l e   b . 2  ,   “   g l o c k   m o d e s   d a t a   t y p e s   ”   s h o w s   s t a t e   c a c h e d   g l o c k   m o d e s   c a c h e d   s t a t e   d i r t y   .   a p p l i e s   i n o d e   r e s o u r c e   g r o u p   l o c k s  ,   d a t a   c o m p o n e n t   r e s o u r c e   g r o u p   l o c k s  ,   m e t a d a t a   .   b . 4   .   g l o c k   d e b u g f s   i n t e r f a c e   g l o c k   d e b u g f s   i n t e r f a c e   v i s u a l i z a t i o n   i n t e r n a l   s t a t e   g l o c k s   h o l d e r s   i n c l u d e s   s u m m a r y   d e t a i l s   o b j e c t s   l o c k e d   c a s e s   .   l i n e   f i l e   b e g i n s   g  :   i n d e n t a t i o n   (  r e f e r s   g l o c k  )   b e g i n s   d i f f e r e n t   l e t t e r  ,   i n d e n t e d   s i n g l e   s p a c e  ,   r e f e r s   s t r u c t u r e s   a s s o c i a t e d   g l o c k   i m m e d i a t e l y   f i l e   ( :   h o l d e r  ,  :   i n o d e  ,   r  :   r e s o u r c e   g r o u p  )   .   c o n t e n t   f i l e  :   g  :  :   s h   n: 5 / 7 5 3 2 0   f  :  :   s h  :   e x / 0   a: 0   r: 3  :  :   s h   f  :   e: 0   p: 4 4 6 6   [  p o s t m a r k  ]   g f s 2 _ i n o d e _ l o o k u p + 0 x 1 4 e / 0 x 2 6 0   [  g f s 2  ]   g  :  :   n: 3 / 2 5 8 0 2 8   f  :   y i  :  :   e x / 0   a: 3   r: 4  :  :   f  :   e: 0   p: 4 4 6 6   [  p o s t m a r k  ]   g f s 2 _ i n p l a c e _ r e s e r v e _ i + 0 x 1 7 7 / 0 x 7 8 0   [  g f s 2  ]   r  :   n: 2 5 8 0 2 8   f: 0 5   b: 2 2 2 5 6 / 2 2 2 5 6   i: 1 6 8 0 0   g  :  :   n: 2 / 2 1 9 9 1 6   f  :   y f i  :  :   e x / 0   a: 0   r: 3  :   n: 7 5 6 6 1 / 2 1 9 9 1 6   t: 8   f: 0 x 1 0   d: 0 x 0 0 0 0 0 0 0 0   s: 7 5 2 2 / 7 5 2 2   g  :  :   s h   n: 5 / 1 2 7 2 0 5   f  :  :   s h  :   e x / 0   a: 0   r: 3  :  :   s h   f  :   e: 0   p: 4 4 6 6   [  p o s t m a r k  ]   g f s 2 _ i n o d e _ l o o k u p + 0 x 1 4 e / 0 x 2 6 0   [  g f s 2  ]   g  :  :   n: 2 / 5 0 3 8 2   f  :   y f i  :  :   e x / 0   a: 0   r: 2   g  :  :   s h   n: 5 / 3 0 2 5 1 9   f  :  :   s h  :   e x / 0   a: 0   r: 3  :  :   s h   f  :   e: 0   p: 4 4 6 6   [  p o s t m a r k  ]   g f s 2 _ i n o d e _ l o o k u p + 0 x 1 4 e / 0 x 2 6 0   [  g f s 2  ]   g  :  :   s h   n: 5 / 3 1 3 8 7 4   f  :  :   s h  :   e x / 0   a: 0   r: 3  :  :   s h   f  :   e: 0   p: 4 4 6 6   [  p o s t m a r k  ]   g f s 2 _ i n o d e _ l o o k u p + 0 x 1 4 e / 0 x 2 6 0   [  g f s 2  ]   g  :  :   s h   n: 5 / 2 7 1 9 1 6   f  :  :   s h  :   e x / 0   a: 0   r: 3  :  :   s h   f  :   e: 0   p: 4 4 6 6   [  p o s t m a r k  ]   g f s 2 _ i n o d e _ l o o k u p + 0 x 1 4 e / 0 x 2 6 0   [  g f s 2  ]   g  :  :   s h   n: 5 / 3 1 2 7 3 2   f  :  :   s h  :   e x / 0   a: 0   r: 3  :  :   s h   f  :   e: 0   p: 4 4 6 6   [  p o s t m a r k  ]   g f s 2 _ i n o d e _ l o o k u p + 0 x 1 4 e / 0 x 2 6 0   [  g f s 2  ]   s e r i e s   e x c e r p t s   (  a p p r o x i m a t e l y   1 8 m b   f i l e  )   g e n e r a t e d   c o m m a n d   / s y s / k e r n e l / d e b u g / g f s 2 / u n i t y  :   m y f s / g l o c k s  >   m y . l o c k   r u n   p o s t m a r k   b e n c h m a r k   s i n g l e   n o d e   g f s 2   f i l e   s y s t e m   .   g l o c k s   f i g u r e   s e l e c t e d   o r d e r   s h o w   i n t e r e s t i n g   f e a t u r e s   g l o c k   d u m p s   .   g l o c k   s t a t e s   (  e x c l u s i v e  )  ,   d f   (  d e f e r r e d  )  ,   s h   (  s h a r e d  )   (  u n l o c k e d  )   .   s t a t e s   c o r r e s p o n d   d i r e c t l y   d l m   l o c k   m o d e s   r e p r e s e n t   d l m   n u l l   l o c k   s t a t e  ,   g f s 2   h o l d   d l m   l o c k   (  d e p e n d i n g   f l a g   e x p l a i n e d  )   .  :   f i e l d   g l o c k   i n d i c a t e s   c u r r e n t   s t a t e   l o c k   f i e l d   h o l d e r   i n d i c a t e s   r e q u e s t e d   .   l o c k   g r a n t e d  ,   h o l d e r   b i t   s e t   f l a g s   (  f  :   f i e l d  )   .  ,   w   w a i t   b i t   s e t   .  :   f i e l d   (  n u m b e r  )   i n d i c a t e s   n u m b e r   a s s o c i a t e d   i t e m   .   g l o c k s  ,   t y p e   n u m b e r   g l o c k   n u m b e r  ,   g l o c k   n: 5 / 7 5 3 2 0  ;   i n d i c a t e s   i o p e n   g l o c k   r e l a t e s   i n o d e   7 5 3 2 0 .   c a s e   i n o d e   i o p e n   g l o c k s  ,   g l o c k   n u m b e r   i d e n t i c a l   i n o d e  ' s   d i s k   b l o c k   n u m b e r   .   n o t e   f u l l   l i s t i n g   f l a g s   h o l d e r   g l o c k   s e t   t a b l e   b . 4  ,   “   g l o c k   f l a g s   ”   t a b l e   b . 5  ,   “   g l o c k   h o l d e r   f l a g s   ”   .   c o n t e n t   l o c k   v a l u e   b l o c k s   c u r r e n t l y   a v a i l a b l e   g l o c k   d e b u g f s   i n t e r f a c e   .   t a b l e   b . 3  ,   “   g l o c k   t y p e s   ”   s h o w s   m e a n i n g s   d i f f e r e n t   g l o c k   t y p e s   .   i m p o r t a n t   g l o c k   f l a g s   (  l o c k e d  )   f l a g   .   b i t   l o c k   a r b i t r a t e   a c c e s s   g l o c k   s t a t e   s t a t e   c h a n g e   p e r f o r m e d   .   s e t   s t a t e   m a c h i n e   s e n d   r e m o t e   l o c k   r e q u e s t   d l m  ,   c l e a r e d   c o m p l e t e   o p e r a t i o n   p e r f o r m e d   .   l o c k   r e q u e s t  ,   i n v a l i d a t i o n s   o c c u r r i n g   t i m e s   .   t a b l e   b . 4  ,   “   g l o c k   f l a g s   ”   s h o w s   m e a n i n g s   d i f f e r e n t   g l o c k   f l a g s   .   r e m o t e   c a l l b a c k   r e c e i v e d   n o d e   l o c k   c o n f l i c t s   h e l d   l o c a l   n o d e  ,   f l a g s   (  d e m o t e  )   (  d e m o t e   p e n d i n g  )   s e t   .   o r d e r   p r e v e n t   s t a r v a t i o n   c o n d i t i o n s   c o n t e n t i o n   p a r t i c u l a r   l o c k  ,   l o c k   a s s i g n e d   m i n i m u m   h o l d   t i m e   .   n o d e   l o c k   m i n i m u m   h o l d   t i m e   a l l o w e d   r e t a i n   l o c k   t i m e   i n t e r v a l   e x p i r e d   .   t i m e   i n t e r v a l   e x p i r e d  ,   (  d e m o t e  )   f l a g   s e t   s t a t e   r e q u i r e d   r e c o r d e d   .   c a s e   t i m e   g r a n t e d   l o c k s   h o l d e r s   q u e u e  ,   l o c k   d e m o t e d   .   t i m e   i n t e r v a l   e x p i r e d  ,   (  d e m o t e   p e n d i n g  )   f l a g   s e t   i n s t e a d   .   s c h e d u l e s   s t a t e   m a c h i n e   c l e a r   (  d e m o t e   p e n d i n g  )   s e t   (  d e m o t e  )   m i n i m u m   h o l d   t i m e   e x p i r e d   .   (  i n i t i a l  )   f l a g   s e t   g l o c k   a s s i g n e d   d l m   l o c k   .   g l o c k   f l a g   r e m a i n   s e t   g l o c k   f i n a l l y   f r e e d   (  d l m   l o c k   u n l o c k e d  )   .   b . 5   .   g l o c k   h o l d e r s   t a b l e   b . 5  ,   “   g l o c k   h o l d e r   f l a g s   ”   s h o w s   m e a n i n g s   d i f f e r e n t   g l o c k   h o l d e r   f l a g s   .   i m p o r t a n t   h o l d e r   f l a g s   (  h o l d e r  )   w   (  w a i t  )   m e n t i o n e d   e a r l i e r  ,   s e t   g r a n t e d   l o c k   r e q u e s t s   q u e u e d   l o c k   r e q u e s t s   r e s p e c t i v e l y   .   o r d e r i n g   h o l d e r s   l i s t   i m p o r t a n t   .   g r a n t e d   h o l d e r s  ,   h e a d   q u e u e  ,   q u e u e d   h o l d e r s   .   g r a n t e d   h o l d e r s  ,   h o l d e r   l i s t   t r i g g e r s   s t a t e   c h a n g e   .   d e m o t e   r e q u e s t s   c o n s i d e r e d   h i g h e r   p r i o r i t y   r e q u e s t s   f i l e   s y s t e m  ,   d i r e c t l y   r e s u l t   c h a n g e   s t a t e   r e q u e s t e d   .   g l o c k   s u b s y s t e m   s u p p o r t s   k i n d s   ` `  ' '   l o c k   .   t a k i n g   l o c k s   n o r m a l   o r d e r   (  s u i t a b l e   b a c k - o f f   r e t r y  )   a v o i d   r e s o u r c e s   n o d e s   .   n o r m a l   ( )   l o c k   i n d i c a t e s  ;   ` `  ' '   l o c k   s p e c i a l   .   (  1 c b  )   l o c k  ,   h a n d  ,   i d e n t i c a l   l o c k   d l m   s e n d   s i n g l e   c a l l b a c k   c u r r e n t   i n c o m p a t i b l e   l o c k   h o l d e r s   .   (  1 c b  )   l o c k   i o p e n   l o c k s  ,   a r b i t r a t e   n o d e s   i n o d e  ' s   i _ n l i n k   c o u n t   z e r o  ,   d e t e r m i n e   n o d e s   r e s p o n s i b l e   d e a l l o c a t i n g   i n o d e   .   i o p e n   g l o c k   h e l d   s h a r e d   s t a t e  ,   i _ n l i n k   c o u n t   z e r o   -  >   e v i c t _ i n o d e   ( )   c a l l e d  ,   r e q u e s t   e x c l u s i v e   l o c k   (  1 c b  )   s e t   .   c o n t i n u e   d e a l l o c a t e   i n o d e   l o c k   g r a n t e d   .   l o c k   g r a n t e d   r e s u l t   n o d e   ( )   p r e v e n t i n g   g r a n t   l o c k   m a r k i n g   g l o c k   ( )   (  d e m o t e  )   f l a g  ,   c h e c k e d   -  >   d r o p _ i n o d e   ( )   t i m e   o r d e r   e n s u r e   d e a l l o c a t i o n   f o r g o t t e n   .   m e a n s   i n o d e s   z e r o   l i n k   c o u n t   o p e n   d e a l l o c a t e d   n o d e   f i n a l   c l o s e   ( )   o c c u r s   .  ,   t i m e   i n o d e  ' s   l i n k   c o u n t   d e c r e m e n t e d   z e r o   i n o d e   m a r k e d   s p e c i a l   s t a t e   z e r o   l i n k   c o u n t   r e s o u r c e   g r o u p   b i t m a p   .   f u n c t i o n s   e x t 3   f i l e   s y s t e m 3  ' s   o r p h a n   l i s t   s u b s e q u e n t   r e a d e r   b i t m a p   p o t e n t i a l l y   s p a c e   r e c l a i m e d  ,   a t t e m p t   r e c l a i m   .   b . 6   .   g l o c k   t r a c e p o i n t s   t r a c e p o i n t s   d e s i g n e d   c o n f i r m   c o r r e c t n e s s   c a c h e   c o n t r o l   c o m b i n i n g   b l k t r a c e   o u t p u t   k n o w l e d g e   o n - d i s k   l a y o u t   .   p o s s i b l e   c h e c k   i / o   i s s u e d   c o m p l e t e d   c o r r e c t   l o c k  ,   r a c e s   p r e s e n t   .   g f s 2 _ g l o c k _ s t a t e _ c h a n g e   t r a c e p o i n t   i m p o r t a n t   u n d e r s t a n d   .   t r a c k s   s t a t e   c h a n g e   g l o c k   i n i t i a l   c r e a t i o n   f i n a l   d e m o t i o n   e n d s   g f s 2 _ g l o c k _ p u t   f i n a l   n l   u n l o c k e d   t r a n s i t i o n   .   (  l o c k e d  )   g l o c k   f l a g   s e t   s t a t e   c h a n g e   o c c u r s   c l e a r e d   f i n i s h e d   .   g r a n t e d   h o l d e r s   (  g l o c k   h o l d e r   f l a g  )   s t a t e   c h a n g e   .   q u e u e d   h o l d e r s  ,   w   (  w a i t i n g  )   s t a t e   .   s t a t e   c h a n g e   c o m p l e t e   h o l d e r s   g r a n t e d   f i n a l   o p e r a t i o n   g l o c k   f l a g   c l e a r e d   .   g f s 2 _ d e m o t e _ r q   t r a c e p o i n t   t r a c k   d e m o t e   r e q u e s t s  ,   l o c a l   r e m o t e   .   a s s u m i n g   m e m o r y   n o d e  ,   l o c a l   d e m o t e   r e q u e s t s   r a r e l y  ,   c r e a t e d   u m o u n t   o c c a s i o n a l   m e m o r y   r e c l a i m   .   n u m b e r   r e m o t e   d e m o t e   r e q u e s t s   m e a s u r e   c o n t e n t i o n   n o d e s   p a r t i c u l a r   i n o d e   r e s o u r c e   g r o u p   .   g f s 2 _ g l o c k _ l o c k _ t i m e   t r a c e p o i n t   i n f o r m a t i o n   t i m e   r e q u e s t s   d l m   .   b l o c k i n g   (  b  )   f l a g   i n t r o d u c e d   g l o c k   s p e c i f i c a l l y   c o m b i n a t i o n   t r a c e p o i n t   .   h o l d e r   g r a n t e d   l o c k  ,   g f s 2 _ p r o m o t e   c a l l e d  ,   o c c u r s   f i n a l   s t a g e s   s t a t e   c h a n g e   l o c k   r e q u e s t e d   g r a n t e d   i m m e d i a t e l y   d u e   g l o c k   s t a t e   c a c h i n g   l o c k   s u i t a b l e   .   h o l d e r   g r a n t e d   g l o c k  ,   f   ( )   f l a g   s e t   h o l d e r   .   c u r r e n t l y   r e s o u r c e   g r o u p s   .   b . 7   .   b m a p   t r a c e p o i n t s   b l o c k   m a p p i n g   t a s k   c e n t r a l   f i l e   s y s t e m   .   g f s 2   t r a d i t i o n a l   b i t m a p - b a s e d   s y s t e m   b i t s   b l o c k   .   p u r p o s e   t r a c e p o i n t s   s u b s y s t e m   m o n i t o r i n g   t i m e   a l l o c a t e   m a p   b l o c k s   .   g f s 2 _ b m a p   t r a c e p o i n t   c a l l e d   b m a p   o p e r a t i o n  :   s t a r t   d i s p l a y   b m a p   r e q u e s t  ,   d i s p l a y   r e s u l t   .   m a k e s   e a s y   m a t c h   r e q u e s t s   r e s u l t s   m e a s u r e   t i m e   m a p   b l o c k s   d i f f e r e n t   p a r t s   f i l e   s y s t e m  ,   d i f f e r e n t   f i l e   o f f s e t s  ,   d i f f e r e n t   f i l e s   .   p o s s i b l e   a v e r a g e   e x t e n t   s i z e s   r e t u r n e d   c o m p a r i s o n   r e q u e s t e d   .   g f s 2 _ r s   t r a c e p o i n t   t r a c e s   b l o c k   r e s e r v a t i o n s   c r e a t e d  ,  ,   d e s t r o y e d   b l o c k   a l l o c a t o r   .   t r a c k   a l l o c a t e d   b l o c k s  ,   g f s 2 _ b l o c k _ a l l o c   c a l l e d   a l l o c a t i o n s  ,   f r e e i n g   b l o c k s   .   a l l o c a t i o n s   r e f e r e n c e d   i n o d e   b l o c k   i n t e n d e d  ,   t r a c k   p h y s i c a l   b l o c k s   b e l o n g   f i l e s   l i v e   f i l e   s y s t e m   .   p a r t i c u l a r l y   c o m b i n e d   b l k t r a c e  ,   s h o w   p r o b l e m a t i c   i / o   p a t t e r n s   r e f e r r e d   b a c k   r e l e v a n t   i n o d e s   m a p p i n g   g a i n e d   m e a n s   t r a c e p o i n t   .   b . 8   .   t r a c e p o i n t s   t r a c e p o i n t s   s u b s y s t e m   t r a c k   b l o c k s   a d d e d   r e m o v e d   j o u r n a l   (  g f s 2 _ p i n  )  ,   t i m e   c o m m i t   t r a n s a c t i o n s   (  g f s 2 _ l o g _ f l u s h  )   .   d e b u g   j o u r n a l i n g   p e r f o r m a n c e   i s s u e s   .   g f s 2 _ l o g _ b l o c k s   t r a c e p o i n t   t r a c k   r e s e r v e d   b l o c k s  ,   s h o w   s m a l l   w o r k l o a d  ,   .   g f s 2 _ a i l _ f l u s h   t r a c e p o i n t   s i m i l a r   g f s 2 _ l o g _ f l u s h   t r a c e p o i n t   t r a c k   s t a r t   f l u s h e s   a i l   l i s t   .   a i l   l i s t   c o n t a i n s   b u f f e r s  ,   w r i t t e n   b a c k   p l a c e   p e r i o d i c a l l y   f l u s h e d   o r d e r   r e l e a s e   s p a c e   f i l e   s y s t e m  ,   p r o c e s s   r e q u e s t s   s y n c   f s y n c   .   b . 9   .   g l o c k   s t a t i s t i c s   g f s 2   m a i n t a i n s   s t a t i s t i c s   t r a c k   f i l e   s y s t e m   .   s p o t   p e r f o r m a n c e   i s s u e s   .   g f s 2   m a i n t a i n s   c o u n t e r s  :   d c o u n t  ,   c o u n t s   n u m b e r   d l m   o p e r a t i o n s   r e q u e s t e d   .   s h o w s   d a t a   m e a n / v a r i a n c e   c a l c u l a t i o n s   .   q c o u n t  ,   c o u n t s   n u m b e r   s y s c a l l   l e v e l   o p e r a t i o n s   r e q u e s t e d   .   g e n e r a l l y   q c o u n t   e q u a l   g r e a t e r   d c o u n t   .   a d d i t i o n  ,   g f s 2   m a i n t a i n s   m e a n / v a r i a n c e   p a i r s   .   m e a n / v a r i a n c e   p a i r s   s m o o t h e d   e x p o n e n t i a l   e s t i m a t e s   a l g o r i t h m   c a l c u l a t e   r o u n d   t r i p   t i m e s   n e t w o r k   c o d e   .   v a r i a n c e   p a i r s   m a i n t a i n e d   g f s 2   s c a l e d  ,   u n i t s   i n t e g e r   n a n o s e c o n d s   .   s r t t / s r t t v a r  :   s m o o t h e d   r o u n d   t r i p   t i m e   n o n - b l o c k i n g   o p e r a t i o n s   s r t t b / s r t t v a r b  :   s m o o t h e d   r o u n d   t r i p   t i m e   b l o c k i n g   o p e r a t i o n s   i r t t / i r t t v a r  :   i n t e r - r e q u e s t   t i m e   ( ,   t i m e   d l m   r e q u e s t s  )   n o n - b l o c k i n g   r e q u e s t   c o m p l e t e   a w a y  ,   s t a t e   d l m   l o c k   q u e s t i o n   .   c u r r e n t l y   m e a n s   r e q u e s t s   ( )   c u r r e n t   s t a t e   l o c k   e x c l u s i v e   (  b  )   r e q u e s t e d   s t a t e   n u l l   u n l o c k e d   ( )   ` `   l o c k  ' '   f l a g   s e t   .   b l o c k i n g   r e q u e s t   c o v e r s   l o c k   r e q u e s t s   .   l a r g e r   t i m e s   i r t t s  ,   s m a l l e r   t i m e s   r t t s   .   s t a t i s t i c s   s y s f s   f i l e s  :   g l s t a t s   f i l e   .   f i l e   s i m i l a r   g l o c k s   f i l e  ,   c o n t a i n s   s t a t i s t i c s  ,   g l o c k   l i n e   .   d a t a   i n i t i a l i z e d   ` `   c p u  ' '   d a t a   g l o c k   t y p e   g l o c k   c r e a t e d   (  c o u n t e r s  ,   z e r o e d  )   .   f i l e   l a r g e   .   l k s t a t s   f i l e   .   c o n t a i n s   ` `   c p u  ' '   s t a t s   g l o c k   t y p e   .   c o n t a i n s   s t a t i s t i c   l i n e  ,   c o l u m n   c p u   c o r e   .   l i n e s   g l o c k   t y p e  ,   t y p e s   .   b . 1 0   .   r e f e r e n c e s   i n f o r m a t i o n   t r a c e p o i n t s   g f s 2   g l o c k s   f i l e  ,   r e s o u r c e s  :   i n f o r m a t i o n   g l o c k   i n t e r n a l   l o c k i n g   r u l e s  ,   h t t p s  :   / / g i t . k e r n e l . o r g / p u b / s c m / l i n u x / k e r n e l / g i t / t o r v a l d s / l i n u x . g i t / t r e e / d o c u m e n t a t i o n / f i l e s y s t e m s / g f s 2 - g l o c k s . r s t   .   i n f o r m a t i o n   e v e n t   t r a c i n g  ,   h t t p s  :   / / g i t . k e r n e l . o r g / p u b / s c m / l i n u x / k e r n e l / g i t / t o r v a l d s / l i n u x . g i t / t r e e / d o c u m e n t a t i o n / t r a c e / e v e n t s . r s t .   `   i n f o r m a t i o n   t r a c e - c m d   u t i l i t y  ,   h t t p  :   / / l w n . n e t / a r t i c l e s / 3 4 1 9 0 2 /   .   a p p e n d i x   c .   r e v i s i o n   h i s t o r y   r e v i s i o n   h i s t o r y   r e v i s i o n   4 . 1 - 1   w e d   a u g   7   2 0 1 9   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 7   p u b l i c a t i o n   .   r e v i s i o n   3 . 1 - 1   t h u   o c t   4   2 0 1 8   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 6   p u b l i c a t i o n   .   r e v i s i o n   2 . 1 - 1   t h u   1 5   2 0 1 8   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 5   p u b l i c a t i o n   .   r e v i s i o n   2 . 1 - 0   t h u   d e c   1 4   2 0 1 7   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 5   b e t a   p u b l i c a t i o n   .   r e v i s i o n   1 . 3 - 6   w e d   n o v   8   2 0 1 7   s t e v e n   l e v i n e   u p d a t e d   v e r s i o n   7 . 4 .   r e v i s i o n   1 . 3 - 3   t h u   j u l   2 7   2 0 1 7   s t e v e n   l e v i n e   d o c u m e n t   v e r s i o n   7 . 4   p u b l i c a t i o n   .   r e v i s i o n   1 . 3 - 1   w e d   1 0   2 0 1 7   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 4   b e t a   p u b l i c a t i o n   .   r e v i s i o n   1 . 2 - 5   t h u   2 3   2 0 1 7   s t e v e n   l e v i n e   u p d a t e   7 . 3   p u b l i c a t i o n   .   r e v i s i o n   1 . 2 - 4   o c t   1 7   2 0 1 6   s t e v e n   l e v i n e   v e r s i o n   7 . 3   p u b l i c a t i o n   .   r e v i s i o n   1 . 2 - 3   w e d   a u g   1 7   2 0 1 6   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 3   b e t a   p u b l i c a t i o n   .   r e v i s i o n   0 . 3 - 5   n o v   9   2 0 1 5   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 2   p u b l i c a t i o n   r e v i s i o n   0 . 3 - 2   w e d   a u g   1 9   2 0 1 5   s t e v e n   l e v i n e   p r e p a r i n g   d o c u m e n t   7 . 2   b e t a   p u b l i c a t i o n   .   r e v i s i o n   0 . 2 - 1 3   w e d   f e b   1 8   2 0 1 5   s t e v e n   l e v i n e   v e r s i o n   7 . 1   r e l e a s e   r e v i s i o n   0 . 2 - 8   t h u   d e c   1 1   2 0 1 4   s t e v e n   l e v i n e   v e r s i o n   7 . 0   b e t a   r e l e a s e   r e v i s i o n   0 . 1 - 2 9   w e d   j u n   1 1   2 0 1 4   s t e v e n   l e v i n e   v e r s i o n   7 . 0   r e l e a s e   r e v i s i o n   0 . 1 - 1 1   d e c   9   2 0 1 3   s t e v e n   l e v i n e   7 . 0   b e t a   r e l e a s e   r e v i s i o n   0 . 1 - 1   w e d   j a n   1 6   2 0 1 3   s t e v e n   l e v i n e   b r a n c h e d   r e d   e n t e r p r i s e   l i n u x   6   v e r s i o n   d o c u m e n t   i n d e x   f   g   p   r   w   l e g a l   n o t i c e   c o p y r i g h t   ©   2 0 1 8   r e d  ,   i n c .   d o c u m e n t   l i c e n s e d   r e d   c r e a t i v e   c o m m o n s   a t t r i b u t i o n - s h a r e a l i k e   3 . 0   u n p o r t e d   l i c e n s e   .   d i s t r i b u t e   d o c u m e n t  ,   m o d i f i e d   v e r s i o n  ,   p r o v i d e   a t t r i b u t i o n   r e d  ,   i n c .   p r o v i d e   l i n k   o r i g i n a l   .   d o c u m e n t   m o d i f i e d  ,   r e d   t r a d e m a r k s   r e m o v e d   .   r e d  ,   l i c e n s o r   d o c u m e n t  ,   w a i v e s   e n f o r c e  ,   a g r e e s   a s s e r t  ,   s e c t i o n   4 d   c c - b y - s a   f u l l e s t   e x t e n t   p e r m i t t e d   a p p l i c a b l e   l a w   .   r e d  ,   r e d   e n t e r p r i s e   l i n u x  ,   s h a d o w m a n   l o g o  ,   r e d   l o g o  ,   j b o s s  ,   o p e n s h i f t  ,   f e d o r a  ,   i n f i n i t y   l o g o  ,   r h c e   t r a d e m a r k s   r e d  ,   i n c .  ,   r e g i s t e r e d   u n i t e d   s t a t e s   c o u n t r i e s   .   l i n u x ®   r e g i s t e r e d   t r a d e m a r k   l i n u s   t o r v a l d s   u n i t e d   s t a t e s   c o u n t r i e s   .   j a v a ®   r e g i s t e r e d   t r a d e m a r k   o r a c l e   a n d / o r   a f f i l i a t e s   .   x f s ®   t r a d e m a r k   s i l i c o n   g r a p h i c s   i n t e r n a t i o n a l   c o r p .   s u b s i d i a r i e s   u n i t e d   s t a t e s   a n d / o r   c o u n t r i e s   .   m y s q l ®   r e g i s t e r e d   t r a d e m a r k   m y s q l   u n i t e d   s t a t e s  ,   e u r o p e a n   u n i o n   c o u n t r i e s   .   n o d e . j s ®   o f f i c i a l   t r a d e m a r k   j o y e n t   .   r e d   f o r m a l l y   r e l a t e d   e n d o r s e d   o f f i c i a l   j o y e n t   n o d e . j s   o p e n   s o u r c e   c o m m e r c i a l   p r o j e c t   .   o p e n s t a c k ®   w o r d   m a r k   o p e n s t a c k   l o g o   r e g i s t e r e d   t r a d e m a r k s / s e r v i c e   m a r k s   t r a d e m a r k s / s e r v i c e   m a r k s   o p e n s t a c k   f o u n d a t i o n  ,   u n i t e d   s t a t e s   c o u n t r i e s   o p e n s t a c k   f o u n d a t i o n  ' s   p e r m i s s i o n   .   a f f i l i a t e d  ,   e n d o r s e d   s p o n s o r e d   o p e n s t a c k   f o u n d a t i o n  ,   o p e n s t a c k   c o m m u n i t y   .   t r a d e m a r k s   p r o p e r t y   r e s p e c t i v e   o w n e r s  .
