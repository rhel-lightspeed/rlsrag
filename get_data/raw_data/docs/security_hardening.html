<!DOCTYPE html><html  data-capo=""><head><script type="importmap">
  {
    "imports": {
      "@patternfly/elements/": "/scripts/v1/@patternfly/elements/",
      "@patternfly/pfe-clipboard/": "/scripts/v1/@patternfly/pfe-clipboard/",
      "@rhds/elements/": "/scripts/v1/@rhds/elements/elements/",
      "@cpelements/elements/": "/scripts/v1/@cpelements/elements/elements/"
    },
    "scopes": {
      "/": {
        "@floating-ui/core": "/scripts/v1/@floating-ui/core/dist/floating-ui.core.mjs",
        "@floating-ui/dom": "/scripts/v1/@floating-ui/dom/dist/floating-ui.dom.mjs",
        "@floating-ui/utils": "/scripts/v1/@floating-ui/utils/dist/floating-ui.utils.mjs",
        "@floating-ui/utils/dom": "/scripts/v1/@floating-ui/utils/dom/dist/floating-ui.utils.dom.mjs",
        "@lit/reactive-element": "/scripts/v1/@lit/reactive-element/reactive-element.js",
        "@lit/reactive-element/decorators/": "/scripts/v1/@lit/reactive-element/decorators/",
        "@patternfly/pfe-core": "/scripts/v1/@patternfly/pfe-core/core.js",
        "@patternfly/pfe-core/": "/scripts/v1/@patternfly/pfe-core/",
        "@rhds/tokens/media.js": "/scripts/v1/@rhds/tokens/js/media.js",
        "lit": "/scripts/v1/lit/index.js",
        "lit-element/lit-element.js": "/scripts/v1/lit-element/lit-element.js",
        "lit-html": "/scripts/v1/lit-html/lit-html.js",
        "lit-html/": "/scripts/v1/lit-html/",
        "lit/": "/scripts/v1/lit/",
        "tslib": "/scripts/v1/tslib/tslib.es6.mjs",
        "@cpelements/rh-table/dist/rh-table.js": "/scripts/v1/@cpelements/rh-table/dist/rh-table.js"
      }
    }
  }
</script><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Security hardening | Red Hat Product Documentation</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<script type="text/javascript" id="trustarc" src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
<script src="//www.redhat.com/dtm.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@400;500;700&family=Red+Hat+Text:wght@400;500;700&display=swap">
<link rel="stylesheet" href="/styles/rh-table--lightdom.min.css">
<style>.section .titlepage{gap:.75rem}.section .titlepage,div.edit{align-items:center;display:flex}div.edit{font-size:.9rem;margin-bottom:8px}div.edit>a{align-items:center;display:flex}.edit pf-icon{margin-right:4px}</style>
<style>#error[data-v-df31ff14]{align-items:center;display:flex;flex-direction:column;justify-content:center;min-height:80vh}h1[data-v-df31ff14]{font-size:calc(var(--rh-font-size-body-text-md, 1rem)*4);font-weight:700;margin-bottom:0}h1[data-v-df31ff14],h1 span[data-v-df31ff14]{line-height:var(--rh-line-height-heading,1.3)}h1 span[data-v-df31ff14]{color:var(--rh-color-text-brand-on-light,#e00);display:block;text-transform:uppercase}h1 span[data-v-df31ff14],p[data-v-df31ff14]{font-size:var(--rh-font-size-body-text-lg,1.125rem)}aside[data-v-df31ff14]{align-items:center;background:var(--rh-color-surface-lightest,#fff);border:var(--rh-border-width-sm,1px) solid var(--rh-color-border-subtle-on-light,#c7c7c7);border-radius:var(--rh-border-radius-default,3px);border-top:calc(var(--rh-border-width-md, 2px)*2) solid var(--rh-color-text-brand-on-light,#e00);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2));display:flex;flex-direction:column;justify-content:space-between;margin-top:var(--rh-space-2xl,32px);padding:var(--rh-space-xl,24px)}aside[data-v-df31ff14],aside>div[data-v-df31ff14]{width:100%}.text-container[data-v-df31ff14]{margin:auto;max-width:442px;text-align:center}.desktop[data-v-df31ff14]{display:none}.sr-only[data-v-df31ff14]{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;clip-path:inset(50%);white-space:nowrap}form[data-v-df31ff14]{display:flex}button[data-v-df31ff14],input[data-v-df31ff14]{border:1px solid var(--rh-color-black-500,#8a8d90);box-sizing:border-box;height:40px}input[data-v-df31ff14]{border-right:none;flex:1;font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);padding-left:var(--rh-space-md,8px);width:100%}button[data-v-df31ff14]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border-left:none;display:flex;width:var(--rh-size-icon-04,40px)}button[data-v-df31ff14]:before{background:var(--rh-context-light-color-text-link,#06c);content:"";cursor:pointer;display:block;height:28px;margin:auto;width:28px}.search-icon[data-v-df31ff14]{margin:auto}ul[data-v-df31ff14]{max-width:275px;padding:0}ul li[data-v-df31ff14]{display:inline-block;list-style:none;margin-right:var(--rh-space-xl,24px);padding:var(--rh-space-xs,4px) 0}ul li a[data-v-df31ff14]{color:var(--rh-context-light-color-text-link,#06c);text-decoration:none}@media (min-width:992px){aside[data-v-df31ff14]{flex-direction:row}.mobile[data-v-df31ff14]{display:none}.desktop[data-v-df31ff14]{display:block}input[data-v-df31ff14]{width:auto}}</style>
<style>@keyframes fade-in{0%{opacity:0;visibility:hidden}1%{visibility:visible}to{opacity:1;visibility:visible}}@media (min-height:48em){.rhdocs{--rh-table--maxHeight:calc(100vh - 12.5rem)}}*,.rhdocs *,.rhdocs :after,.rhdocs :before,:after,:before{box-sizing:border-box}.rhdocs img,.rhdocs object,.rhdocs svg,img,object,svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs hr{border:0;border-top:.0625rem solid #d2d2d2;clear:both;margin:1rem 0}.rhdocs a{color:#06c;text-decoration:underline}.rhdocs a:focus,.rhdocs a:hover{color:#036}.rhdocs a.anchor-heading{color:#151515;cursor:pointer;text-decoration:none;word-break:break-all}.rhdocs p{margin:1.49963rem 0}.rhdocs li>p{margin:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:500;margin:0 0 .625rem}.rhdocs h1{font-size:2.25rem;margin:2rem 0}.rhdocs h2{font-size:1.625rem;margin:2rem 0}.rhdocs h3{font-size:1.5rem;font-weight:400}.rhdocs h4,.rhdocs h5{font-size:1.25rem}.rhdocs h5{font-weight:400}.rhdocs h6{font-size:1.125rem;font-weight:500;line-height:1.6667}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ol ::marker,.rhdocs ul ::marker{font:inherit}.rhdocs li{margin:0 0 .5em;padding:0}.rhdocs li>p{margin:.5rem 0}.rhdocs li>ol,.rhdocs li>ul{margin:0}.rhdocs dl dd{margin:.5rem 0 .5rem 1rem}.rhdocs dl dd>p{margin:.5rem 0}.rhdocs .informaltable,.rhdocs .table-contents,.rhdocs .table-wrapper{max-height:var(--rh-table--maxHeight);overflow:auto}.rhdocs table{border:0;font-size:1rem;line-height:1.6667;table-layout:fixed}.rhdocs table caption{color:#585858;margin-bottom:.5rem;margin-top:.5rem;text-align:left}.rhdocs table td,.rhdocs table th{border:0;border-bottom:.0625rem solid #d2d2d2;border-bottom:.0625rem solid var(--pfe-table--Border,#d2d2d2);padding:.5em 1rem}.rhdocs table td.halign-left,.rhdocs table th.halign-left{text-align:left}.rhdocs table td.halign-center,.rhdocs table th.halign-center,table td.halign-center,table th.halign-center{text-align:center}.rhdocs table td.halign-right,.rhdocs table th.halign-right{text-align:right}.rhdocs table td.valign-top,.rhdocs table th.valign-top{vertical-align:top}.rhdocs table td.valign-middle,.rhdocs table th.valign-middle{vertical-align:middle}.rhdocs table td.valign-bottom,.rhdocs table th.valign-bottom{vertical-align:bottom}.rhdocs table thead td,.rhdocs table thead th{background:#f5f5f5;font-weight:600}.rhdocs rh-table table,.rhdocs rh-table.rh-table--expanded-vertically{max-height:-moz-max-content;max-height:max-content}.rhdocs pre.nowrap{overflow:auto;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs .codeblock__wrapper pre{background:transparent}.rh-table--full-screen code,.rhdocs .content--md code,.rhdocs .content--sm code,.rhdocs .rh-table--full-screen code{overflow-wrap:normal;word-break:normal}.rhdocs[class] pre code,[class] pre code{background:inherit;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.rhdocs .keycap,.rhdocs kbd{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.keycap strong,.rhdocs .keycap strong{font-weight:inherit}.rhdocs kbd.keyseq,kbd.keyseq{background:transparent;border:0;box-shadow:none;padding:0}.rhdocs kbd.keyseq kbd,kbd.keyseq kbd{display:inline-block;margin:0 .375rem}.rhdocs kbd.keyseq kbd:first-child,kbd.keyseq kbd:first-child{margin-left:0}.rhdocs b.button{font-size:90%;font-weight:700;padding:.1875rem}.rhdocs b.button:before{content:"["}.rhdocs b.button:after{content:"]"}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}.rhdocs audio,.rhdocs canvas,.rhdocs progress,.rhdocs video{display:inline-block;vertical-align:baseline}.rhdocs audio:not([controls]){display:none;height:0}[hidden],template{display:none}.rhdocs a{background:transparent}.rhdocs a:active,.rhdocs a:hover{outline:0}.rhdocs a.anchor-heading:hover:before{color:#151515;content:"#";margin-left:-1.6rem;position:absolute}.rhdocs a.anchor-heading:focus-visible{color:#151515}@media screen and (max-width:990px){.rhdocs a.anchor-heading:hover:before{font-size:16px;margin-left:-1rem;padding-top:8px}.rhdocs h1 a.anchor-heading:hover:before{padding-top:12px}.rhdocs h4 a.anchor-heading:hover:before,.rhdocs h5 a.anchor-heading:hover:before{padding-top:4px}.rhdocs h6 a.anchor-heading:hover:before{padding-top:2px}}.rhdocs abbr[title]{border-bottom:.0625rem dotted}.rhdocs dfn{font-style:italic}.rhdocs h1{font-size:2em;margin:.67em 0}.rhdocs mark{background:#ff0;color:#000}.rhdocs small{font-size:80%}.rhdocs sub,.rhdocs sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.rhdocs sup{top:-.5em}.rhdocs sub{bottom:-.25em}.rhdocs img{border:0}.rhdocs svg:not(:root){overflow:hidden}.rhdocs figure{margin:1em 2.5rem}.rhdocs hr{box-sizing:content-box;height:0}.rhdocs code,.rhdocs kbd,.rhdocs pre,.rhdocs samp{font-family:monospace,monospace;font-size:1em}.rhdocs button,.rhdocs optgroup,.rhdocs select,.rhdocs textarea,.rhdocsinput{color:inherit;font:inherit;margin:0}.rhdocs button.copy-link-btn{background:none;border:2px solid #fff;font:1px Red Hat Text}.rhdocs button.copy-link-btn:hover{border-bottom:2px solid #06c}.rhdocs button.copy-link-btn .link-icon{padding-bottom:4px}.rhdocs button{overflow:visible}.rhdocs button,.rhdocs select{text-transform:none}.rhdocs button,.rhdocs html input[type=button],.rhdocs input[type=reset],.rhdocs input[type=submit]{-moz-appearance:button;appearance:button;-webkit-appearance:button;cursor:pointer}.rhdocs button[disabled],.rhdocs html input[disabled]{cursor:default}.rhdocs button::-moz-focus-inner,.rhdocs input::-moz-focus-inner{border:0;padding:0}.rhdocs input{line-height:normal}.rhdocs input[type=checkbox],.rhdocs input[type=radio]{box-sizing:border-box;padding:0}.rhdocs input[type=number]::-webkit-inner-spin-button,.rhdocs input[type=number]::-webkit-outer-spin-button{height:auto}.rhdocs input[type=search]{-moz-appearance:textfield;appearance:textfield;-webkit-appearance:textfield;box-sizing:content-box}.rhdocs input[type=search]::-webkit-search-cancel-button,.rhdocs input[type=search]::-webkit-search-decoration{-webkit-appearance:none}.rhdocs fieldset{border:.0625rem solid silver;margin:0 .125rem;padding:.35em .625em .75em}.rhdocs legend{border:0;padding:0}.rhdocs textarea{overflow:auto}.rhdocs optgroup{font-weight:700}.rhdocs table{border-collapse:collapse;border-spacing:0}.rhdocs td,.rhdocs th{padding:0}.rhdocs ._additional-resources[class][class][id]:last-child{margin-top:-2rem}.rhdocs ._additional-resources[class][class]:only-child{grid-column:1/-1}._additional-resources[class][class] .additional-resources__heading,._additional-resources[class][class] .heading,._additional-resources[class][class] h1,._additional-resources[class][class] h2,._additional-resources[class][class] h3,._additional-resources[class][class] h4,._additional-resources[class][class] h5,._additional-resources[class][class] h6,._additional-resources[class][class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper ._additional-resources[class][class] ul{display:block}._additional-resources[class][class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}._additional-resources[class][class] li:only-child{grid-column:1/-1}._additional-resources[class][class] li:last-child{border:0}@media (min-width:1100px){._additional-resources[class][class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}._additional-resources[class][class] li p:only-child{margin:0;padding:0}._additional-resources[class][class] li a{text-decoration:none}._additional-resources[class][class] li a:focus,._additional-resources[class][class] li a:hover{text-decoration:underline}.rhdocs table .admonitionblock>div:nth-child(2),.rhdocs table .caution>div:nth-child(2),.rhdocs table .important>div:nth-child(2),.rhdocs table .note>div:nth-child(2),.rhdocs table .tip>div:nth-child(2),.rhdocs table .warning>div:nth-child(2){margin:.5rem 0}.rhdocs table .admonitionblock>div:nth-child(2)>:first-child,.rhdocs table .caution>div:nth-child(2)>:first-child,.rhdocs table .important>div:nth-child(2)>:first-child,.rhdocs table .note>div:nth-child(2)>:first-child,.rhdocs table .tip>div:nth-child(2)>:first-child,.rhdocs table .warning>div:nth-child(2)>:first-child{margin-top:0}.rhdocs table .admonitionblock>div:nth-child(2)>:last-child,.rhdocs table .caution>div:nth-child(2)>:last-child,.rhdocs table .important>div:nth-child(2)>:last-child,.rhdocs table .note>div:nth-child(2)>:last-child,.rhdocs table .tip>div:nth-child(2)>:last-child,.rhdocs table .warning>div:nth-child(2)>:last-child{margin-bottom:0}.rhdocs .codeblock__wrapper+.codeblock__wrapper,.rhdocs pre+pre,.rhdocs pre[class]+pre[class]{margin-top:2rem}.rhdocs .codeblock__wrapper{background:#f8f8f8;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__wrapper:before{background-repeat:no-repeat;background-size:6.25rem 100%;bottom:var(--scrollbar__height,1px);content:"";display:block;height:7.125rem;max-height:100%;max-height:calc(100% - var(--scrollbar__height, 2px));position:absolute;right:var(--scrollbar__width,6px);top:.0625rem;width:4.0625rem;z-index:1}.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 6.25rem)}@media (min-height:48em){.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 12.5rem)}}.rhdocs .codeblock__inner-wrapper{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs .codeblock__wrapper--expanded .codeblock__inner-wrapper{max-height:-moz-max-content;max-height:max-content}.codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.codeblock__copy:focus{outline:.0625rem dashed currentcolor}.codeblock__copy svg#icon--copy{height:1rem;width:1rem}.codeblock__expand{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;border:0;cursor:pointer;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));position:absolute;text-indent:-9999em;top:3.25rem;width:1.75rem;z-index:2}.codeblock__expand:before{background:#6a6e73;content:"";height:100%;left:0;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:auto 1rem;mask-size:auto 1rem;position:absolute;top:0;width:100%}.codeblock__wrapper--expanded .codeblock__expand{background:#2b9af3}.codeblock__wrapper--expanded .codeblock__expand:before{background:#fff}.codeblock__expand:focus:before,.codeblock__expand:hover:before{background:#06c}.codeblock__wrapper--expanded .codeblock__expand:focus:before,.codeblock__wrapper--expanded .codeblock__expand:hover:before{background:#fff}.codeblock__expand:focus{outline:.0625rem dashed currentcolor}.rhdocs .calloutlist>ol,.rhdocs .colist>ol{counter-reset:colist;list-style:none;margin:1rem 0 2rem;padding:0}.rhdocs .calloutlist>ol>li,.rhdocs .colist>ol>li{counter-increment:colist;font-size:1rem;margin:.5rem 0;padding-left:1.75rem;position:relative}.rhdocs .calloutlist>ol>li .colist-num,.rhdocs .colist>ol>li .colist-num{display:none}.calloutlist>ol>li:before,.colist>ol>li:before{content:counter(colist);left:0;position:absolute;top:.1875rem}.calloutlist dt{clear:left;float:left;margin:0;padding:0 .5rem 0 0}.included-in-guides[class],.included-in-guides[class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.included-in-guides[class][id]:last-child{margin-top:-2rem}.included-in-guides[class]:only-child{grid-column:1/-1}.included-in-guides[class] .additional-resources__heading,.included-in-guides[class] .heading,.included-in-guides[class] h1,.included-in-guides[class] h2,.included-in-guides[class] h3,.included-in-guides[class] h4,.included-in-guides[class] h5,.included-in-guides[class] h6,.included-in-guides[class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.included-in-guides[class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper .included-in-guides[class] ul{display:block}.included-in-guides[class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}.included-in-guides[class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.included-in-guides[class] li:only-child{grid-column:1/-1}.included-in-guides[class] li:last-child{border:0}@media (min-width:1100px){.included-in-guides[class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}.included-in-guides[class] li p:only-child{margin:0;padding:0}.included-in-guides[class] li a{text-decoration:none}.included-in-guides[class] li a:focus,.included-in-guides[class] li a:hover{text-decoration:underline}.menuseq{display:inline-flex;overflow:hidden;text-indent:-9999em}.menuseq .menu,.menuseq .menuitem,.menuseq .submenu{display:block;position:relative;text-indent:0}.menuseq .menu+.menu:before,.menuseq .menu+.menuitem:before,.menuseq .menu+.submenu:before,.menuseq .menuitem+.menu:before,.menuseq .menuitem+.menuitem:before,.menuseq .menuitem+.submenu:before,.menuseq .submenu+.menu:before,.menuseq .submenu+.menuitem:before,.menuseq .submenu+.submenu:before{content:">";display:inline-block;font-weight:700;padding:0 .25em}.related-topic-content__wrapper{margin:2em 0}.related-topic-content__wrapper--for-guide{margin-bottom:-2.5rem;padding-bottom:.0625rem;position:relative;z-index:1}.related-topic-content__wrapper--for-guide:before{background:#f0f0f0;content:"";display:block;height:100%;left:-3rem;position:absolute;right:-4.5rem;top:0;width:auto;z-index:-1}@media (min-width:1100px){.related-topic-content__wrapper--for-guide:before{left:-2.5rem;right:-3.625rem}}.related-topic-content__wrapper--for-guide summary{padding:1em 2em 1em 2.1875rem}@media (min-width:950px){.related-topic-content__inner-wrapper{display:grid;gap:2em;grid-template-columns:repeat(2,minmax(0,1fr))}}.local-render .rhdocs-content{margin:0 auto}.rhdocs cp-documentation{display:block;padding-bottom:2.5rem}.rhdocs cp-documentation.PFElement,.rhdocs cp-documentation[pfelement]{padding:0}rh-table{display:block}::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar{height:.625rem;width:.625rem}::-webkit-scrollbar,::-webkit-scrollbar-track,:host .rhdocs ::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar-track{background-color:#d6d6d6}::-webkit-scrollbar-thumb,:host .rhdocs ::-webkit-scrollbar-thumb{background-color:#8e8e8e}*,:host .rhdocs *{scrollbar-color:#8e8e8e #d6d6d6}.rhdocs p:empty,p:empty{display:none}.rhdocs[class] h1 code,.rhdocs[class] h2 code,.rhdocs[class] h3 code,.rhdocs[class] h4 code,.rhdocs[class] h5 code,.rhdocs[class] h6 code,[class] h1 code,[class] h2 code,[class] h3 code,[class] h4 code,[class] h5 code,[class] h6 code{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.pane-page-title h1,.rhdocs__header__primary-wrapper h1{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:2.25rem;line-height:1.333}.rhdocs details[class]{list-style:none;margin:1rem 0 3rem;padding:0}.rhdocs-toc[class]{background:#f2f2f2;margin:1rem 0 2rem;padding:1rem}.rhdocs-toc[class]>:last-child{margin-bottom:0}.rhdocs-toc[class] .rhdocs-toctitle{font-size:1.25rem;font-weight:400;line-height:1.6667;margin-top:0;text-transform:none}.rhdocs-toc[class] li{margin-bottom:.25em;padding-left:.5em}.preamble{margin:0 0 2rem}.sect1{margin:2rem 0 1rem}:host .sect1,cp-documentation .sect1{margin:0 0 2rem;padding:.0625rem 0 0}:host(.cp-documentation--has-external-header) .sect1:first-child>h2:first-child,:host(.cp-documentation--has-external-header) .sect1:first-child>h3:first-child{margin-top:0}.listingblock,.literalblock{margin:1rem 0}.quoteblock,.verseblock{border-left:.25rem solid #d2d2d2;margin:1rem 0;padding:1rem 1rem 1rem 2rem}.quoteblock.pullleft,.verseblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.quoteblock.pullleft,.verseblock.pullleft{margin-left:-1rem}}.quoteblock.pullright,.verseblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.quoteblock.pullright,.verseblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.quoteblock.pullright,.verseblock.pullright{margin-right:-10rem}}.quoteblock>:first-child,.verseblock>:first-child{margin-top:0}.quoteblock .content,.verseblock .content{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.25rem;line-height:1.6667}.quoteblock .attribution,.verseblock .attribution{font-size:.875rem;font-style:italic;font-weight:600;line-height:1.6667;text-transform:uppercase}.quoteblock .attribution .citetitle,.verseblock .attribution .citetitle{color:#585858}.quoteblock .attribution cite,.verseblock .attribution cite{font-size:1em}.quoteblock blockquote{font-style:italic;margin:0;padding:0}.quoteblock blockquote .content>:first-child{margin-top:0}.quoteblock blockquote .content>:first-child:before{color:#e00;content:"â€œ";display:block;float:left;font-size:2.75rem;font-style:normal;line-height:1.125em;margin-right:.5rem}.quoteblock blockquote .content>:first-child .content>:first-child:before{content:none}.imageblock{margin:1rem 0}.imageblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.imageblock.pullleft{margin-left:-1rem}}.imageblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.imageblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.imageblock.pullright{margin-right:-10rem}}.imageblock.interrupter{margin:2rem 0}@media (min-width:768px){.imageblock.interrupter{margin-left:-1rem;margin-right:-2rem}.imageblock.interrupter .caption{margin-left:1rem;margin-right:2rem}}@media (min-width:1100px){.imageblock.interrupter{margin-right:-10rem}.imageblock.interrupter .caption{margin-right:10rem}}.imageblock.interrupter img{max-width:100%}.imageblock .caption{color:#585858;display:block;font-size:.875rem;line-height:1.6667;margin:.5rem 0 0}.rhdocs-footnotes{border-top:.0625rem solid #d2d2d2;margin:3rem 0 1rem;padding:1rem 0 0}.rhdocs-footnotes>ol{margin:0;padding:0 0 0 1.5rem}@supports (counter-reset:footnotenum){.rhdocs-footnotes>ol{counter-reset:footnotenum;list-style:none;padding:0}.rhdocs-footnotes>ol>li{counter-increment:footnotenum}.rhdocs-footnotes>ol>li:before{color:#585858;content:"[" counter(footnotenum) "]";display:inline-block;margin-right:.25rem}}.rhdocs-footer{background:#ededed;color:#151515;font-size:.875rem;line-height:1.6667;margin:3rem 0 0;padding:1rem}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.visually-hidden{overflow:hidden;position:absolute;clip:rect(0,0,0,0);border:0;height:.0625rem;margin:-.0625rem;padding:0;width:.0625rem}.rh-docs-legal-notice{margin-top:4em}pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}code.language-none,code.language-text,code.language-txt,pre.language-none,pre.language-text,pre.language-txt{color:#151515}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#cceae7;color:#263238}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#cceae7;color:#263238}:not(pre)>code[class*=language-]{border-radius:.2em;padding:.1em;white-space:normal}.token.atrule{color:#40199a}.token.attr-name{color:#06c}.token.attr-value,.token.attribute{color:#b300b3}.token.boolean{color:#40199a}.token.builtin,.token.cdata,.token.char,.token.class,.token.class-name{color:#06c}.token.comment{color:#6a6e73}.token.constant{color:#40199a}.token.deleted{color:#c9190b}.token.doctype{color:#6a6e73}.token.entity{color:#c9190b}.token.function{color:#40199a}.token.hexcode{color:#b300b3}.token.id,.token.important{color:#40199a;font-weight:700}.token.inserted{color:#06c}.token.keyword{color:#40199a}.token.number{color:#b300b3}.token.operator{color:#06c}.token.prolog{color:#6a6e73}.token.property{color:#06c}.token.pseudo-class,.token.pseudo-element{color:#b300b3}.token.punctuation,.token.regex{color:#06c}.token.selector{color:#c9190b}.token.string{color:#b300b3}.token.symbol{color:#40199a}.token.unit{color:#b300b3}.token.url,.token.variable{color:#c9190b}.rhdocs.local-render{margin:0 auto;max-width:45.8125rem;padding:0 1.5rem}@media print{.field code,.field pre,code[class*=language-],pre,pre[class*=language-]{white-space:pre-wrap!important;word-wrap:break-word!important;overflow-wrap:break-word!important;word-break:break-word!important}}.book-nav__list[class]{display:flex;justify-content:space-between;line-height:var(--jupiter__lineHeight--xs,1.3333);list-style:none;margin:5rem 0 0;padding:0}@media (min-width:1200px){.book-nav__list[class]{display:grid;gap:2rem;grid-template-columns:repeat(2,minmax(0,1fr))}}.book-nav__item a{display:inline-block;font-size:.875rem;font-weight:500;padding-left:1.25rem;position:relative;text-transform:uppercase}.book-nav__item a:before{background:url(/sites/dxp-docs/penumbra-dist/jupiter/images/arrow-down-solid.svg) no-repeat;background-size:contain;content:"";display:block;height:.875rem;left:0;position:absolute;top:.125rem;transform:rotate(90deg);width:.875rem}.book>.titlepage:not(:last-child),.rhdocs .chapter,section[id]{padding-bottom:3.75rem}.book>.titlepage .chapter:last-child,.book>.titlepage section[id]:last-child,.chapter .chapter:last-child,.chapter section[id]:last-child,section[id] .chapter:last-child,section[id] section[id]:last-child{margin-bottom:-3.75rem}.rhdocs .codeblock__wrapper+section[id],pre+section[id]{padding-top:3.75rem}.rhdocs .cta-link{font-size:inherit}.rhdocs a{word-wrap:break-word;overflow-wrap:break-word}.rhdocs .caution,.rhdocs .important,.rhdocs .note,.rhdocs .tip,.rhdocs .warning{padding:.8888888889em;position:relative}.rhdocs .QSIPopOver{bottom:18.75rem!important;top:auto!important}.rhdocs .alert{position:relative}.rhdocs button.dismiss-button{background:none;border:0;cursor:pointer;height:2.5rem;margin-top:-1.25rem;padding:0;position:absolute;right:.3125rem;text-align:center;top:50%;width:2.5rem;z-index:50}.rhdocs button.dismiss-button:after{content:"\f109";display:inline-block;filter:alpha(opacity=30);font-family:rh-web-iconfont;font-size:1.3125rem;font-style:normal;font-variant:normal;font-weight:400;line-height:1;line-height:2.5rem;opacity:.3;text-decoration:inherit;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs .book>.titlepage,.rhdocs .chapter,.rhdocs section[id]{padding-bottom:var(--rh-space-4xl,64px)}.rhdocs .alert{border:0;border-radius:0}.rhdocs .alert>h2:first-child,.rhdocs .alert>h3:first-child,.rhdocs .alert>h4:first-child,.rhdocs .alert>h5:first-child,.rhdocs .alert>h6:first-child,.rhdocs .alert>p:first-child{margin-top:0!important}.rhdocs .alert>p:last-child{margin-bottom:0!important}.rhdocs .alert-w-icon[class]{padding-left:2.8125rem}.rhdocs .alert-w-icon .alert-icon{float:left;font-size:1.125rem;margin-left:-1.875rem;margin-right:.625rem}.rhdocs .alert-w-icon .alert-icon[class*=" rh-icon-"],.rhdocs .alert-w-icon .alert-icon[class^=rh-icon-]{font-size:2.25rem;line-height:1em;margin-left:-2.5rem;margin-top:-.375rem}.rhdocs .alert-w-icon .alert-icon[class*=" icon-innov-prev"],.rhdocs .alert-w-icon .alert-icon[class^=icon-innov-prev]{font-size:1.3125rem;margin-top:.25rem}.rhdocs .alert-w-icon.alert-plain{background:none;color:#151515;padding-left:5rem}.rhdocs .alert-w-icon.alert-plain .alert-icon{font-size:3rem;margin-left:-4.375rem;margin-right:0}.rhdocs .alert-w-icon.alert-plain.alert-success .alert-icon{color:#3f9c35}.rhdocs .alert-w-icon.alert-plain.alert-info .alert-icon{color:#0088ce}.rhdocs .alert-w-icon.alert-plain.alert-warning .alert-icon{color:#f0ab00}.rhdocs .alert-w-icon.alert-plain.alert-danger .alert-icon{color:#e00}#target_banner .copy-url{float:right;margin-top:0}#target_banner .dropdown-menu{font-size:inherit}.titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.para{margin:1.49963rem 0}.para[class]{margin-bottom:1.49963rem}dd{margin-bottom:2.5rem}.rhdocs .card-light,.rhdocs .card-light-gray,.rhdocs .card-light-grey{background:#f0f0f0;border:.0625rem solid #f0f0f0;color:#151515}.rhdocs .card-light-gray.push-bottom:first-child,.rhdocs .card-light-grey.push-bottom:first-child,.rhdocs .card-light.push-bottom:first-child{margin-bottom:3.125rem!important}.rhdocs .card-light a.card-link,.rhdocs .card-light h1,.rhdocs .card-light h2,.rhdocs .card-light h3,.rhdocs .card-light h4,.rhdocs .card-light h5,.rhdocs .card-light h6,.rhdocs .card-light-gray a.card-link,.rhdocs .card-light-gray h1,.rhdocs .card-light-gray h2,.rhdocs .card-light-gray h3,.rhdocs .card-light-gray h4,.rhdocs .card-light-gray h5,.rhdocs .card-light-gray h6,.rhdocs .card-light-grey a.card-link,.rhdocs .card-light-grey h1,.rhdocs .card-light-grey h2,.rhdocs .card-light-grey h3,.rhdocs .card-light-grey h4,.rhdocs .card-light-grey h5,.rhdocs .card-light-grey h6{color:#151515}.rhdocs .card-light-gray.card-active:after,.rhdocs .card-light-grey.card-active:after,.rhdocs .card-light.card-active:after{border-top-color:#f0f0f0}.rhdocs .card-md,.rhdocs .card-narrow{display:block;padding:1.1875rem;white-space:normal;word-wrap:break-word}.rhdocs .card .card-heading.card-heading-sm,.rhdocs .card-sm .card .card-heading{font-size:1.0625em;font-weight:500;line-height:1.5}.rhdocs .card .card-heading.card-heading-flush{margin-bottom:.25rem}.rhdocs .card .card-heading.card-heading-red{color:#d10000}.rhdocs .card>p{margin-top:0}.rhdocs .card>p:last-child{margin-bottom:0}.rhdocs .new-experience{background-color:#e7f1fa;border:.0625rem solid #bee1f4;font-size:1rem;margin:1.5rem;padding:1.5rem;position:relative;z-index:1}@media (min-width:48rem){.new-experience{display:flex}.new-experience--contained{left:50%;position:relative;transform:translateX(-50%);width:calc(100vw - 2.5rem)}}.new-experience__primary-content{flex-grow:1}@media (min-width:48rem){.new-experience__primary-content{margin-right:1.25rem}}.new-experience__title{font-size:inherit;font-weight:inherit;line-height:1.6;margin:0;padding:0}.new-experience__title+a,.new-experience__title+pfe-cta{display:inline-block;margin-top:1.5em}.new-experience__secondary-content{min-width:12.5rem}@media (min-width:48rem){.new-experience__secondary-content{text-align:right}}.example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:min-content 1fr}dl.calloutlist[class] dt{float:none;margin:0;padding:0}dl.calloutlist[class] dd{margin:0;padding:0}dl.calloutlist[class] dd>:first-child{margin-top:0}dl.calloutlist[class] dd>:last-child{margin-bottom:0}.toast{background-color:#000;background-color:rgba(0,0,0,.9);bottom:.9375rem;box-shadow:0 .125rem .3125rem 0 rgba(0,0,0,.26);color:#fff;left:.9375rem;max-width:32.8125rem;min-width:6.25rem;padding:.9375rem;position:fixed;right:.9375rem;transform:translate3d(0,150%,0);transition:transform .2s cubic-bezier(.465,.183,.153,.946);will-change:transform;z-index:999}.toast.show{transform:translateZ(0)}.toast a{color:#fff;text-decoration:underline}.toast a:focus,.toast a:hover{color:#2b9af3}.toast a.btn{text-decoration:none}.toast .btn.btn-link{color:#fff}.toast .close{color:#fff;opacity:.3;text-decoration:none}.toast .close:focus,.toast .close:hover{color:#fff;opacity:.5}.no-csstransforms3d.csstransitions .toast{transition:all .2s cubic-bezier(.465,.183,.153,.946)}.no-csstransforms3d .toast{opacity:0;visibility:hidden}.no-csstransforms3d .toast.show{opacity:1;visibility:visible}.annotator-outer[class][class]{display:none;flex-direction:column;flex-grow:1;height:auto;margin:0;position:static;width:auto}@media (min-width:1400px){.annotator-outer[class][class]{display:flex}}.annotator-frame[class] *{height:auto}@media (min-width:1400px){.annotator-frame .h-sidebar-iframe[class]{position:static;width:calc(100% + 1.5rem)}}.annotator-toolbar[class][class]{position:static;width:auto}.annotator-toolbar>ul,.annotator-toolbar>ul>li{display:block;height:auto;list-style:none;margin:0;padding:0;width:auto}.annotator-toolbar>ul>li{display:flex;justify-content:flex-end}.annotator-frame[class] .annotator-frame-button--sidebar_toggle,.annotator-outer .annotator-frame-button[class][class],.app-content-wrapper *{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif!important}.annotator-outer .annotator-frame-button[class][class]{font-size:.9375rem;font-weight:500;height:auto;line-height:1.333;margin-right:1.875rem;padding:.75em 1em;position:static}@media (min-width:1400px){.annotator-outer .annotator-frame-button[class][class]{margin-right:0}}.annotator-outer iframe{flex-grow:1;margin-bottom:1.25rem}@media (min-width:1400px){.annotator-outer iframe{min-height:37.5rem}}.producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.producttitle .productnumber{color:var(--jupiter__palette__red--50,#e00)}.cp-modal-open,.zoom-open{overflow:hidden}.cp-modal,.cp-video-modal,.zoom-modal{bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;outline:0;overflow:hidden;position:fixed;right:0;top:0;transition:all .2s cubic-bezier(.465,.183,.153,.946);z-index:1040;z-index:1050;-webkit-overflow-scrolling:touch}.rhdocs .in.cp-modal,.rhdocs .in.cp-video-modal,.rhdocs .in.zoom-modal{display:block;filter:alpha(opacity=100);opacity:1;overflow-x:hidden;overflow-y:auto}.rhdocs .cp-modal .close,.rhdocs .cp-video-modal .close,.rhdocs .zoom-modal .close{background-color:#fff;border-radius:50%;color:#1a1a1a;font-size:1.75rem;height:28px;height:1.75rem;line-height:1.75rem;margin-bottom:.375rem;margin-top:0;opacity:.9;position:absolute;right:-.5rem;text-shadow:none;top:0;width:28px;width:1.75rem}.cp-modal .close:after,.cp-video-modal .close:after,.zoom-modal .close:after{line-height:1.75rem}.cp-modal-wrap,.zoom-wrap{margin:.625rem;padding-top:.5rem;position:relative}@media (min-width:48rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{margin:2.8125rem auto;width:38.4375rem}}@media (min-width:62rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:49.8958rem}}@media (min-width:75rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:60.3125rem}}.rhdocs .cp-modal-body :last-child{margin-bottom:0}.rhdocs .cp-modal-backdrop,.rhdocs .zoom-backdrop{background-color:#000;bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;position:fixed;right:0;top:0;transition:opacity .2s cubic-bezier(.465,.183,.153,.946);z-index:1040}.rhdocs .in.cp-modal-backdrop,.rhdocs .in.zoom-backdrop{display:block;filter:alpha(opacity=80);opacity:.8}.rhdocs .cp-modal-body{background:#fff;padding:1.875rem}.rhdocs .cp-modal[data-cp-modal-video=true] .cp-modal-body,.rhdocs .cp-video-modal .cp-modal-body{padding:0}.rhdocs [data-action=zoom]{position:relative}.rhdocs [data-action=zoom]:after{background:rgba(0,0,0,.4);bottom:0;color:#fff;display:inline-block;font-family:rh-web-iconfont;font-style:normal;font-variant:normal;font-weight:400;line-height:1;padding:.375rem;position:absolute;right:0;text-decoration:inherit;text-decoration:none!important;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs [data-action=zoom]:focus:after,.rhdocs [data-action=zoom]:hover:after{background:rgba(0,0,0,.9)}.rhdocs .zoom-wrap .zoom-larger{text-align:center}.rhdocs .zoom-wrap .zoom-larger a{color:#fff}.rhdocs .zoom-wrap .zoom-larger a:focus,.rhdocs .zoom-wrap .zoom-larger a:hover{color:#fff;text-decoration:underline}.rhdocs .zoom-wrap .zoom-larger a:after{content:"â¿»";display:inline-block;margin-left:.25rem}.rhdocs .zoom-body{background:#fff;border-radius:.5rem;margin:0 0 1rem;padding:1rem;text-align:center}.rhdocs .zoom-body .video-wrapper{height:0;overflow:hidden;padding-bottom:56.25%;position:relative}.rhdocs .zoom-body .video-wrapper[data-aspect-ratio="4:3"]{padding-bottom:75%}.rhdocs .zoom-body iframe{height:100%;left:0;position:absolute;top:0;width:100%}.rhdocs .para>.title[class],.rhdocs p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0;text-transform:none}.rhdocs .para>.title[class]+.content>:first-child,.rhdocs .para>.title[class]+p,.rhdocs p.title[class]+.content>:first-child,.rhdocs p.title[class]+p{margin-top:0}.rhdocs [class] pre .caution,.rhdocs [class] pre .important,.rhdocs [class] pre .note,.rhdocs [class] pre .tip,.rhdocs [class] pre .warning{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.rhdocs [class] pre .caution:after,.rhdocs [class] pre .important:after,.rhdocs [class] pre .note:after,.rhdocs [class] pre .tip:after,.rhdocs [class] pre .warning:after{content:none}.rhdocs [class] code.email{background-color:transparent;font:inherit;padding:0}.rhdocs [class] .author{margin-bottom:1.5rem}.rhdocs [class] .author .author{margin-bottom:0}.rhdocs table{margin:2rem 0}.rhdocs [class] table{width:auto}.rhdocs table .table-contents table{max-width:100%;overflow:auto}.rhdocs rh-table table{margin:0;max-width:9999em;overflow:visible}.rhdocs td,.rhdocs th{border-left:0;padding:.5em 1rem;transition:background .25s ease-out}.rhdocs td.content--md[class][class],.rhdocs th.content--md[class][class]{min-width:13em}.rhdocs td.content--lg[class][class],.rhdocs th.content--lg[class][class]{min-width:20em}.rhdocs thead th{padding-top:1.5em}.rhdocs caption{color:currentColor;color:var(--pfe-table__caption--Color,currentColor);font-weight:700;margin-bottom:.5rem;margin-top:.5rem;text-align:center}.rhdocs .revhistory table td,.rhdocs .revhistory table th{border-color:transparent}.rhdocs .revhistory table td{padding:.625rem .875rem}.rhdocs .revhistory table.simplelist{margin:0}@media print{#masthead{display:none!important}}.rh-table--is-full-screen #to-top{display:none}.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:var(--rh-font-family-body-text,RedHatText,"Red Hat Text","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-body-copy-lage,1.125rem);line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs rh-codeblock::slotted(#content){border-radius:.25rem;padding:var (--rh-space-lg,16px)}.rhdocs rh-codeblock .screen{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs rh-codeblock[class][class][class][class][class]{max-width:99999em}.rhdocs .codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.rhdocs .codeblock__copy:focus{outline:.0625rem dashed currentcolor}.rhdocs .codeblock__copy svg#icon--copy{height:1rem;width:1rem}.rhdocs pre{border:0;max-height:-moz-max-content;max-height:max-content}.rhdocs pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre,.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre[class]{margin:0;padding:0;position:relative}.rhdocs code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs code.literal{background:#eee;border-radius:.25rem;color:#000;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs code.literal,.rhdocs kbd,.rhdocs span.keycap{font-family:RedHatMono,Red Hat Mono,Consolas,monospace}.rhdocs kbd,.rhdocs span.keycap{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ._additional-resources[class][class],.rhdocs ._additional-resources[class][class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.rhdocs ._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.rhdocs ._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.rhdocs ._additional-resources[class][class] li:last-child{border:0}.rhdocs section.section#additional_resource .additional-resources__heading,.rhdocs section.section#additional_resource .heading,.rhdocs section.section#additional_resource h1,.rhdocs section.section#additional_resource h2,.rhdocs section.section#additional_resource h3,.rhdocs section.section#additional_resource h4,.rhdocs section.section#additional_resource h5,.rhdocs section.section#additional_resource h6,.rhdocs section.section#additional_resource p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.rhdocs section.section:first-of-type{margin-top:var(--rh-space-4xl,64px)}.rhdocs section.section p{margin-bottom:var(--rh-space-lg,16px);margin-top:0;word-wrap:break-word}.rhdocs .section.section h1,.rhdocs .section.section h2,.rhdocs .section.section h3,.rhdocs .section.section h4,.rhdocs .section.section h5,.rhdocs .section.section h6,.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h1:first-of-type,.rhdocs h2:first-of-type,.rhdocs h3:first-of-type,.rhdocs h4:first-of-type,.rhdocs h5:first-of-type,.rhdocs h6:first-of-type{margin-top:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h2,.rhdocs section.section h2{font-size:var(--rh-font-size-heading-md,1.75rem)}.rhdocs h3,.rhdocs section.section h3{font-size:1.5rem;font-weight:400}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs dl{display:block;margin-block-end:1em;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.rhdocs .para{margin:1.49963rem 0}.rhdocs dl.calloutlist[class] dt{float:none;margin:0;padding:0}.rhdocs dl.calloutlist[class] dd>:last-child{margin-bottom:0}.rhdocs dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:fit-content(40%) 1fr}.rhdocs .calloutlist dt{clear:left;display:flex;flex-wrap:wrap;float:left;margin:0;padding:0 .5rem 0 0}.rhdocs .calloutlist dt a:not(:first-child){padding-left:4px}.rhdocs dl.calloutlist[class] dd{margin:0;padding:0}.rhdocs .callout,.rhdocs .colist>ol>li:before,.rhdocs .conum{background:#06c;border-radius:50%;color:#fff;display:inline-block;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:.75rem;font-style:normal;font-weight:600;height:1.25rem;line-height:1.35rem;padding:0;position:relative;text-align:center;top:-.125em;vertical-align:middle;width:1.25rem}.rhdocs img,.rhdocs object,.rhdocs svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs .titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.rhdocs[class] .author{margin-bottom:1.5rem}.rhdocs[class] .author .author{margin-bottom:0}.rhdocs .para>.title[class],p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0}.rhdocs .example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}.rhdocs code{background:#eee;color:#000;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs .para[class]{margin-bottom:1.49963rem}.rhdocs[class] code.email{background-color:transparent;font:inherit;padding:0}rh-alert.admonition #description,rh-alert.admonition p{font-size:var(--rh-font-size-body-text-md,1rem)}rh-alert{width:-moz-fit-content;width:fit-content}.rhdocs .producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.rhdocs dl{margin:1rem 0}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs ol ol{list-style:lower-roman}.rhdocs .codeblock--processed pf-clipboard-copy::part(input),.rhdocs .codeblock--processed pf-clipboard-copy::part(span){display:none}.token.tag{color:#c9190b}.calloutlist div.para{margin:0}rh-alert.admonition{margin-bottom:var(--rh-space-lg,1rem)}.guibutton,.guimenu,.guimenuitem{font-weight:700}.guibutton{font-size:90%;padding:.1875rem}.guibutton:before{content:"["}.guibutton:after{content:"]"}.docs-content-container,.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}pre[hidden]{display:none}.codeblock[class][class][class][class][class]{max-width:99999em}.codeblock__wrapper{background:var(--rh-color-surface-lighter,#f2f2f2);margin:1rem 0;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__inner-wrapper:after{content:"";display:block;min-height:.625rem;width:4.375rem}.codeblock__copy{--pfe-clipboard--icon--Color--hover:#06c;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));padding:.3125rem .375rem;position:absolute;top:1rem;width:1.75rem;z-index:2}.codeblock__inner-wrapper pre{border:0;max-height:-moz-max-content;max-height:max-content}.pfe-clipboard:not([copied]) .pfe-clipboard__text--success,:host(:not([copied])) .pfe-clipboard__text--success{display:none!important}.codeblock[class]{margin:0;overflow:visible;padding-right:0}pre{display:block;font-size:.8125rem;line-height:1.42857;margin:0 0 .625rem;word-break:break-all;word-wrap:break-word;background-color:var(--rh-color-surface-lighter,#f2f2f2);border:.0625rem solid #ccc;border-radius:.25rem;color:#333}.docs-content-container pre,.rhdocs pre{background:var(--rh-color-surface-lighter,#f2f2f2);color:#151515;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs pre[class]{line-height:1.6667;overflow-x:auto}rh-codeblock pre[class][class]{overflow-x:auto}.pfe-clipboard__text--success{background-color:#ddd;border:1px solid #000;border-radius:2px}*,:after,:before{box-sizing:border-box}:root{--rh-space-xs:4px;--rh-space-sm:6px;--rh-space-md:8px;--rh-space-lg:16px;--rh-space-xl:24px;--rh-space-2xl:32px;--rh-space-3xl:48px;--rh-space-4xl:64px;--rh-space-5xl:80px;--rh-space-6xl:96px;--rh-space-7xl:128px;--rh-font-size-body-text-xs:.75rem;--rh-font-size-body-text-sm:.875rem;--rh-font-size-body-text-md:1rem;--rh-font-size-body-text-lg:1.125rem;--rh-font-size-body-text-xl:1.25rem;--rh-font-size-body-text-2xl:1.5rem;--rh-font-size-heading-xs:1.25rem;--rh-font-size-heading-sm:1.5rem;--rh-font-size-heading-md:1.75rem;--rh-font-size-heading-lg:2.25rem;--rh-font-size-heading-xl:2.5rem;--rh-font-size-heading-2xl:3rem;--pfe-navigation--logo--maxWidth:200px;--pfe-navigation__logo--height:40px;--pfe-navigation--fade-transition-delay:500ms;--pfe-navigation__nav-bar--highlight-color:var(--rh-color-brand-red-on-dark,#e00);--pf-global--icon--FontSize--sm:.75rem}body,html{font-family:Red Hat Text,sans-serif;font-size:var(--rh-font-size-body-text-md,1rem);line-height:var(--rh-line-height-body-text,1.5);margin:0}h1,h2,h3,h4,h5,h6{font-family:Red Hat Display,sans-serif;font-weight:400;line-height:var(--rh-line-height-heading,1.3)}h1{font-size:var(--rh-font-size-heading-2xl,3rem);line-height:62px}h2{font-size:var(--rh-font-size-heading-xl,2.5rem);line-height:48px}h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}h4{font-size:var(--rh-font-size-heading-md,2.25rem)}h5{font-size:var(--rh-font-size-heading-sm,2.25rem)}h6{font-size:var(--rh-font-size-heading-xs,2.25rem)}main{line-height:30px}section{padding-bottom:3rem;padding-top:3rem}img{height:auto;max-width:100%}a{color:var(--rh-color-interactive-blue-darker,#06c);text-decoration:none}a:hover{color:var(--rh-color-interactive-blue-darkest,#004080)}rh-alert.html-container a{text-decoration:underline}.container{padding-left:12px;padding-right:12px}.container,.container-fluid{margin-left:auto;margin-right:auto;width:100%}.container-fluid{padding:12px}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{min-width:1140px}}@media (min-width:1400px){.container{min-width:1320px}}.grid{display:grid;gap:var(--rh-space-xl,24px)}.grid-center{margin:auto}.grid.grid-col-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-12{grid-template-columns:repeat(12,1fr)}@media (min-width:768px){.grid.grid-col-md-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-md-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-md-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-md-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-md-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-md-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-md-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-md-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-md-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-md-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-md-12{grid-template-columns:repeat(12,1fr)}}@media (min-width:992px){.grid.grid-col-lg-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-lg-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-lg-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-lg-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-lg-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-lg-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-lg-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-lg-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-lg-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-lg-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-lg-12{grid-template-columns:repeat(12,1fr)}}.span-1{grid-column:span 1}.span-2{grid-column:span 2}.span-3{grid-column:span 3}.span-4{grid-column:span 4}.span-5{grid-column:span 5}.span-6{grid-column:span 6}.span-7{grid-column:span 7}.span-8{grid-column:span 8}.span-9{grid-column:span 9}.span-10{grid-column:span 10}.span-11{grid-column:span 11}.span-12{grid-column:span 12}@media (min-width:399px){.span-xs-1{grid-column:span 1}.span-xs-2{grid-column:span 2}.span-xs-3{grid-column:span 3}.span-xs-4{grid-column:span 4}.span-xs-5{grid-column:span 5}.span-xs-6{grid-column:span 6}.span-xs-7{grid-column:span 7}.span-xs-8{grid-column:span 8}.span-xs-9{grid-column:span 9}.span-xs-10{grid-column:span 10}.span-xs-11{grid-column:span 11}.span-xs-12{grid-column:span 12}}@media (min-width:768px){.span-md-1{grid-column:span 1}.span-md-2{grid-column:span 2}.span-md-3{grid-column:span 3}.span-md-4{grid-column:span 4}.span-md-5{grid-column:span 5}.span-md-6{grid-column:span 6}.span-md-7{grid-column:span 7}.span-md-8{grid-column:span 8}.span-md-9{grid-column:span 9}.span-md-10{grid-column:span 10}.span-md-11{grid-column:span 11}.span-md-12{grid-column:span 12}}@media (min-width:992px){.span-lg-1{grid-column:span 1}.span-lg-2{grid-column:span 2}.span-lg-3{grid-column:span 3}.span-lg-4{grid-column:span 4}.span-lg-5{grid-column:span 5}.span-lg-6{grid-column:span 6}.span-lg-7{grid-column:span 7}.span-lg-8{grid-column:span 8}.span-lg-9{grid-column:span 9}.span-lg-10{grid-column:span 10}.span-lg-11{grid-column:span 11}.span-lg-12{grid-column:span 12}}@media (min-width:1025px){.span-xl-1{grid-column:span 1}.span-xl-2{grid-column:span 2}.span-xl-3{grid-column:span 3}.span-xl-4{grid-column:span 4}.span-xl-5{grid-column:span 5}.span-xl-6{grid-column:span 6}.span-xl-7{grid-column:span 7}.span-xl-8{grid-column:span 8}.span-xl-9{grid-column:span 9}.span-xl-10{grid-column:span 10}.span-xl-11{grid-column:span 11}.span-xl-12{grid-column:span 12}}@media (min-width:1200px){.span-2xl-1{grid-column:span 1}.span-2xl-2{grid-column:span 2}.span-2xl-3{grid-column:span 3}.span-2xl-4{grid-column:span 4}.span-2xl-5{grid-column:span 5}.span-2xl-6{grid-column:span 6}.span-2xl-7{grid-column:span 7}.span-2xl-8{grid-column:span 8}.span-2xl-9{grid-column:span 9}.span-2xl-10{grid-column:span 10}.span-2xl-11{grid-column:span 11}.span-2xl-12{grid-column:span 12}}.flex{display:flex;flex-direction:column;gap:var(--rh-space-lg,16px)}.flex-row{flex-direction:row}.flex-column{flex-direction:column}@media (min-width:768px){.flex-md-row{flex-direction:row}.flex-md-column{flex-direction:column}}.typography-h1{font-size:var(--rh-font-size-heading-2xl,3rem)}.typography-h2{font-size:var(--rh-font-size-heading-xl,2.5rem)}.typography-h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}.typography-h4{font-size:var(--rh-font-size-heading-md,1.75rem)}.typography-h5{font-size:var(--rh-font-size-heading-sm,1.5rem)}.typography-h6{font-size:var(--rh-font-size-heading-xs,1.25rem)}.content section{padding:0}.content h1,.content h2,.content h3,.content h4,.content h5,.content h6{margin:var(--rh-space-lg,16px) 0}.sr-only{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0}.list-unstyled{list-style:none;padding-left:0}.tooltip-content{align-items:center;display:flex;font-family:Red Hat Text;justify-content:center;text-transform:none}.tooltip-content .check-icon{margin-left:var(--rh-space-md,8px)}.doc-image-link{display:inline-block;text-decoration:none}.modal-img{display:block;width:100%}.modal-helper-text{margin-top:.5rem;text-align:center}.modal-helper-text a{color:#000;cursor:pointer}.modal-helper-text a:hover{text-decoration:underline}.modal-helper-text a:after{content:"⿻";margin-left:.25rem}pf-modal.pf-img-modal{--pf-c-modal-box--MaxHeight:90vh;overflow-y:scroll}pf-modal.pf-img-modal::part(close-button){background-color:#fff;border-radius:50%;color:#000;margin-right:-2rem;margin-top:-2rem}pf-modal.pf-img-modal::part(close-button):hover{opacity:.7}h2.truste-title{line-height:normal;margin-top:0}rh-alert p[slot=header]{color:#002952}@media (width < 992px){html:has(nav.mobile-nav .mobile-nav-wrapper){scroll-behavior:smooth;scroll-padding-top:4rem}html:has(nav.mobile-nav .mobile-jump-links){scroll-padding-top:7rem}html:has(nav.mobile-nav.hide-mobile-nav){scroll-padding-top:2rem}}.highlight{background:#fff4cc;color:#000}</style>
<style>rh-alert[data-v-84359384]{width:100%}</style>
<style>.search-btn[data-v-edc0d12c]{align-items:center;background-color:var(--rh-color-canvas-black,#151515);border:3px solid var(--rh-color-canvas-black,#151515);cursor:pointer;display:flex;flex-direction:column;height:100%;justify-content:center;outline:none;padding:14px var(--rh-space-md,8px)}.search-btn[data-v-edc0d12c]:focus{border-top:3px solid var(--rh-color-accent-brand-on-light,#e00);outline:2px dotted var(--rh-color-white,#fff)}.search-btn .search-icon[data-v-edc0d12c]{height:26px;padding:2px 0 var(--rh-space-xs,4px);width:20px}.search-btn .search-icon[data-v-edc0d12c],.search-icon-helper-text[data-v-edc0d12c]{color:var(--rh-color-white,#fff)}.search-mobile[data-v-edc0d12c]{margin-bottom:var(--rh-space-2xl,32px)}.search-mobile form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto}.search-box[data-v-edc0d12c]{width:35rem}nav[data-v-edc0d12c]{background-color:#151515;justify-content:space-between;width:100%}a[data-v-edc0d12c],a[data-v-edc0d12c]:visited{color:#fff;display:inline-block;font-size:var(--rh-font-size-body-text-md,1rem)}.skip-link[class][class][data-v-edc0d12c]{font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class][data-v-edc0d12c]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}.visually-hidden[data-v-edc0d12c]{border:1px solid #06c;height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);white-space:nowrap}h3[data-v-edc0d12c]{color:#464646;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-lg,1.125rem)}.language-picker[data-v-edc0d12c]{align-items:center;background-color:#fff;display:flex;flex-direction:column;padding:var(--rh-space-xl,24px);width:100%}.language-picker h3[data-v-edc0d12c]{margin:0;padding:0 1rem 1rem}.language-picker ul[data-v-edc0d12c]{margin:0;padding:0}.language-picker a[data-v-edc0d12c]{color:#06c}.language-picker li[data-v-edc0d12c]{list-style:none}.language-dropdown[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:block!important;position:absolute;right:0;width:100%;z-index:104}.pfe-navigation.pfe-navigation--processed>[slot=secondary-links][data-v-edc0d12c]{height:auto;overflow:visible;visibility:visible;width:auto}.upper-navigation[data-v-edc0d12c]{padding:0 var(--rh-space-2xl,32px)}.upper-nav-container[data-v-edc0d12c]{border-bottom:1px solid #404040;margin:0}.upper-nav-hidden[data-v-edc0d12c]:not(:focus):not(:active){clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.upper-nav-menu[data-v-edc0d12c]{align-items:center;display:flex;justify-content:flex-end;line-height:1.444;list-style:none;margin-bottom:0;margin-top:0;padding-left:0}.upper-nav-menu[data-v-edc0d12c],.upper-nav-menu>li[data-v-edc0d12c]{position:relative}.upper-nav-menu>li:not(:first-child)>a[data-v-edc0d12c]:before,.upper-nav-menu>li:not(:first-child)>button[data-v-edc0d12c]:before{background-color:#404040;content:"";height:40%;left:0;position:absolute;top:30%;width:1px}li[data-v-edc0d12c]{display:list-item;margin:0;padding:0;text-align:-webkit-match-parent}.upper-nav-menu button.upper-nav-links[data-v-edc0d12c]{border:0;border-top:3px solid transparent;cursor:pointer;line-height:1.444}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]{outline-color:#151515}.upper-nav-menu button.upper-nav-links[aria-expanded=true] .upper-nav-arrow[data-v-edc0d12c]{filter:invert(0) sepia(2%) saturate(21%) hue-rotate(257deg) brightness(108%) contrast(100%);transform:rotate(270deg)}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]:before{display:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]{background-color:var(--pfe-navigation--BackgroundColor,var(--pfe-theme--color--surface--darkest,#151515));border-top:3px solid transparent;color:#fff;display:block;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);outline:none;padding:12px 12px 14px;text-decoration:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:hover{border-top-color:#b8bbbe}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within{outline:1px dashed var(--rh-color-white,#fff);outline-offset:-1px}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within:before{display:none}.upper-nav-dropdown-container[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:none;padding:5px 30px 24px;position:absolute;right:0;top:100%;width:500px;z-index:105}.upper-nav-dropdown-container>ul[data-v-edc0d12c]{-moz-column-count:2;column-count:2;list-style-type:none;padding:0;width:auto}.upper-nav-dropdown-container>ul li[data-v-edc0d12c]{color:#151515;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);list-style-type:none;margin-bottom:0}.upper-nav-dropdown-container>ul li span[data-v-edc0d12c]{font-weight:var(--rh-font-weight-body-text-medium,500)}.upper-nav-dropdown-container>ul ul[data-v-edc0d12c]{padding-left:0;padding-top:9px}.upper-nav-dropdown-container>ul>li[data-v-edc0d12c]{padding-top:19px;-moz-column-break-inside:avoid;break-inside:avoid}.upper-nav-dropdown-container>ul>li>ul>li[data-v-edc0d12c]{line-height:1.45;padding:4px 0}.upper-nav-menu .upper-nav-arrow[data-v-edc0d12c]{display:inline-block;filter:invert(100%) sepia(8%) saturate(7%) hue-rotate(1turn) brightness(100%) contrast(93%);height:18px;margin-left:5px;transform:rotate(90deg);vertical-align:middle;width:8px}#pfe-navigation__secondary-links .show[data-v-edc0d12c],.upper-navigation .show[data-v-edc0d12c]{display:block}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:active,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:focus,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:hover{background-color:#fff;color:#151515}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]{background-color:#fff;border-top-color:#b8bbbe;color:#000;position:relative;z-index:1}.upper-nav-dropdown-container>ul a[data-v-edc0d12c]{color:var(--rh-color-accent-base-on-light,#06c);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;text-decoration:none}.pfe-navigation__search[data-v-edc0d12c]{background-color:var(--rh-color-white,#fff)}.pfe-navigation__search form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto;max-width:992px}pfe-navigation [slot=secondary-links] .buttons[data-v-edc0d12c]{display:flex;flex-wrap:wrap;gap:var(--rh-space-md,8px);margin-top:4px}pfe-navigation [slot=secondary-links] .buttons a[data-v-edc0d12c]{border:1px solid #d2d2d2;border-radius:3px;color:#06c;cursor:pointer;flex-basis:calc(50% - 5px);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-weight:var(--rh-font-weight-code-regular,400);padding:1em;text-align:center;text-decoration:none}pfe-navigation [slot=secondary-links] .mobile-lang-select[data-v-edc0d12c]{border:1px solid #d2d2d2;border-bottom-color:#3c3f42;cursor:pointer;display:flex;margin:3rem 0;position:relative}pfe-navigation [slot=secondary-links] .mobile-lang-select label[data-v-edc0d12c]{bottom:100%;color:#000;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;font-weight:500;margin-bottom:5px;position:absolute}pfe-navigation [slot=secondary-links] .mobile-lang-select select[data-v-edc0d12c]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-style:none;color:#000;flex-basis:100%;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:16px;line-height:24px;padding:6px 24px 6px 8px}select[data-v-edc0d12c]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position:98% 50%;background-repeat:no-repeat}#inputLabel[data-v-edc0d12c]{align-items:center;display:flex;position:relative}#inputLabel form[data-v-edc0d12c]{width:100%}.input-box[data-v-edc0d12c]{font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 8px;width:100%}.input-box[data-v-edc0d12c]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-box[data-v-edc0d12c]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}@media(max-width:960px){.search-box[data-v-edc0d12c]{width:28rem}}@media (max-width:768px){.right-navigation[data-v-edc0d12c],.upper-navigation[data-v-edc0d12c]{display:none}}@media (min-width:767px){.pfe-navigation__search form[data-v-edc0d12c]{padding:var(--rh-space-2xl,32px) 0}}</style>
<style>.element-invisible,.sr-only,.visually-hidden{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;white-space:nowrap}@keyframes reveal-nav{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@keyframes reveal-nav-parts{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}1%{visibility:visible}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@media print{.pfe-navigation__menu,pfe-navigation [slot]{display:none!important}}pfe-navigation{--pfe-broadcasted--text:var(--pfe-theme--color--text,#151515);--pfe-broadcasted--text--muted:var(--pfe-theme--color--text--muted,#6a6e73);--pfe-broadcasted--link:var(--pfe-theme--color--link,#06c);--pfe-broadcasted--link--hover:var(--pfe-theme--color--link--hover,#004080);--pfe-broadcasted--link--focus:var(--pfe-theme--color--link--focus,#004080);--pfe-broadcasted--link--visited:var(--pfe-theme--color--link--visited,#6753ac);--pfe-broadcasted--link-decoration:var(--pfe-theme--link-decoration,none);--pfe-broadcasted--link-decoration--hover:var(--pfe-theme--link-decoration--hover,underline);--pfe-broadcasted--link-decoration--focus:var(--pfe-theme--link-decoration--focus,underline);--pfe-broadcasted--link-decoration--visited:var(--pfe-theme--link-decoration--visited,none)}@supports (display:grid){pfe-navigation{animation:reveal-nav .1618s 4s 1 forwards;max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}pfe-navigation>*{animation:reveal-nav-parts .1618s 4s 1 forwards;opacity:0;transition:opacity .1618s ease-in-out;transition:opacity var(--pfe-reveal-duration,.1618s) ease-in-out;visibility:hidden}}pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed>*{animation:none;opacity:1;visibility:visible}pfe-navigation pfe-primary-detail{display:none}pfe-navigation[pfelement]{display:block}pfe-navigation-dropdown{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515)}#pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],#pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],#pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class],pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class]{display:none}#pfe-navigation,#pfe-navigation *,pfe-navigation,pfe-navigation *{box-sizing:border-box}#pfe-navigation [pfelement] .pfe-navigation__log-in-link,pfe-navigation [pfelement] .pfe-navigation__log-in-link{display:none}#pfe-navigation,pfe-navigation{align-items:stretch;background:#151515;background:var(--pfe-navigation__nav-bar--Background,#151515);color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;font-family:Red Hat Text,RedHatText,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamily,Red Hat Text,RedHatText,Arial,Helvetica,sans-serif);font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);height:auto;line-height:1.5;margin:0;max-width:9999em;min-height:72px;min-height:var(--pfe-navigation__nav-bar--Height,72px);padding:0 16px;position:relative;z-index:95;z-index:var(--pfe-navigation--ZIndex,var(--pfe-theme--zindex--navigation,95))}@media (min-width:768px){#pfe-navigation,pfe-navigation{flex-wrap:wrap;margin:0;max-width:9999em;padding:0 16px}}@media (min-width:1200px){#pfe-navigation,pfe-navigation{margin:0 auto;padding:0 32px}}#pfe-navigation .pfe-navigation__dropdown,#pfe-navigation pfe-navigation-dropdown,pfe-navigation .pfe-navigation__dropdown,pfe-navigation pfe-navigation-dropdown{display:none}#pfe-navigation>[slot=account],#pfe-navigation>[slot=search],#pfe-navigation>[slot=secondary-links],pfe-navigation>[slot=account],pfe-navigation>[slot=search],pfe-navigation>[slot=secondary-links]{height:0;overflow:hidden;visibility:hidden;width:0}@media (min-width:768px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{align-items:stretch;display:flex;flex-wrap:wrap}}@media (min-width:992px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{flex-wrap:nowrap}}#pfe-navigation .pfe-navigation__logo-wrapper,pfe-navigation .pfe-navigation__logo-wrapper{align-items:center;display:flex;justify-content:flex-start;margin:0;min-width:150px;padding:10px 16px 10px 0}@media (min-width:768px){.pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:auto}}.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:0}#pfe-navigation .pfe-navigation__logo-link,pfe-navigation .pfe-navigation__logo-link{border-radius:3px;display:block;margin-left:-8px;outline:0;padding:6px 8px;position:relative}#pfe-navigation .pfe-navigation__logo-link:focus,pfe-navigation .pfe-navigation__logo-link:focus{outline:0}#pfe-navigation .pfe-navigation__logo-link:focus:after,pfe-navigation .pfe-navigation__logo-link:focus:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:block;height:auto;width:100%}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{height:40px;height:var(--pfe-navigation__logo--height,40px);width:auto}}@media print{#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:none}}#pfe-navigation .pfe-navigation__logo-image:only-child,pfe-navigation .pfe-navigation__logo-image:only-child{display:block}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small{height:32px;height:var(--pfe-navigation__logo--height,32px)}}@media print{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen{display:none!important}}@media screen{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print{display:none!important}}#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print{display:inline-block!important}#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;justify-content:center;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{display:none!important}}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__fallback-links a[class]:focus,#pfe-navigation .pfe-navigation__fallback-links a[class]:hover,#pfe-navigation .pfe-navigation__log-in-link[class]:focus,#pfe-navigation .pfe-navigation__log-in-link[class]:hover,#pfe-navigation .pfe-navigation__menu-link[class]:focus,#pfe-navigation .pfe-navigation__menu-link[class]:hover,#pfe-navigation .pfe-navigation__secondary-link[class]:focus,#pfe-navigation .pfe-navigation__secondary-link[class]:hover,pfe-navigation .pfe-navigation__fallback-links a[class]:focus,pfe-navigation .pfe-navigation__fallback-links a[class]:hover,pfe-navigation .pfe-navigation__log-in-link[class]:focus,pfe-navigation .pfe-navigation__log-in-link[class]:hover,pfe-navigation .pfe-navigation__menu-link[class]:focus,pfe-navigation .pfe-navigation__menu-link[class]:hover,pfe-navigation .pfe-navigation__secondary-link[class]:focus,pfe-navigation .pfe-navigation__secondary-link[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__secondary-link:focus{outline:0}#pfe-navigation .pfe-navigation__fallback-links a:focus:after,#pfe-navigation .pfe-navigation__log-in-link:focus:after,#pfe-navigation .pfe-navigation__menu-link:focus:after,#pfe-navigation .pfe-navigation__secondary-link:focus:after,pfe-navigation .pfe-navigation__fallback-links a:focus:after,pfe-navigation .pfe-navigation__log-in-link:focus:after,pfe-navigation .pfe-navigation__menu-link:focus:after,pfe-navigation .pfe-navigation__secondary-link:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{pointer-events:none}#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding:0 16px 0 0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{display:block;height:18px}#pfe-navigation .pfe-navigation__fallback-links a[class],#pfe-navigation .pfe-navigation__fallback-links a[href],#pfe-navigation .pfe-navigation__log-in-link[class],#pfe-navigation .pfe-navigation__log-in-link[href],#pfe-navigation .pfe-navigation__menu-link[class],#pfe-navigation .pfe-navigation__menu-link[href],#pfe-navigation .pfe-navigation__secondary-link[class],#pfe-navigation .pfe-navigation__secondary-link[href],pfe-navigation .pfe-navigation__fallback-links a[class],pfe-navigation .pfe-navigation__fallback-links a[href],pfe-navigation .pfe-navigation__log-in-link[class],pfe-navigation .pfe-navigation__log-in-link[href],pfe-navigation .pfe-navigation__menu-link[class],pfe-navigation .pfe-navigation__menu-link[href],pfe-navigation .pfe-navigation__secondary-link[class],pfe-navigation .pfe-navigation__secondary-link[href]{align-items:center;justify-content:center}#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%;--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none!important}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation [slot=account]>a[href]:focus,#pfe-navigation [slot=account]>a[href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation [slot=account]>a[href]:focus,pfe-navigation [slot=account]>a[href]:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation [slot=account]>a[href]:focus,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation [slot=account]>a[href]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle:focus:after,#pfe-navigation [slot=account]>a[href]:focus:after,pfe-navigation .pfe-navigation__account-toggle:focus:after,pfe-navigation [slot=account]>a[href]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{pointer-events:none}@supports (display:grid){#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__account-toggle[class]:focus,#pfe-navigation .pfe-navigation__account-toggle[class]:hover,#pfe-navigation [slot=account]>a[href][class]:focus,#pfe-navigation [slot=account]>a[href][class]:hover,pfe-navigation .pfe-navigation__account-toggle[class]:focus,pfe-navigation .pfe-navigation__account-toggle[class]:hover,pfe-navigation [slot=account]>a[href][class]:focus,pfe-navigation [slot=account]>a[href][class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none}}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{--pfe-icon--size:18px;padding:2px 0 4px}@media (min-width:768px){#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{padding-right:0}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],#pfe-navigation [slot=account]>a[href][href]:focus,#pfe-navigation [slot=account]>a[href][href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation [slot=account]>a[href][href]:focus,pfe-navigation [slot=account]>a[href][href]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after{border:1px dashed #151515;border:1px dashed var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{font-size:inherit;list-style:none;margin:0;padding:0}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{align-items:stretch;display:flex}}#pfe-navigation .pfe-navigation__fallback-links li,#pfe-navigation .pfe-navigation__menu li,pfe-navigation .pfe-navigation__fallback-links li,pfe-navigation .pfe-navigation__menu li{font-size:inherit;margin:0;padding:0}#pfe-navigation .pfe-navigation__fallback-links li:before,#pfe-navigation .pfe-navigation__menu li:before,pfe-navigation .pfe-navigation__fallback-links li:before,pfe-navigation .pfe-navigation__menu li:before{content:none}#pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__fallback-links{margin-left:auto}#pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__menu-link{display:flex;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);white-space:nowrap}#pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed{display:block;padding:0}#pfe-navigation.pfe-navigation--processed:before,pfe-navigation.pfe-navigation--processed:before{content:none}#pfe-navigation.pfe-navigation--processed>[slot=account],#pfe-navigation.pfe-navigation--processed>[slot=search],#pfe-navigation.pfe-navigation--processed>[slot=secondary-links],pfe-navigation.pfe-navigation--processed>[slot=account],pfe-navigation.pfe-navigation--processed>[slot=search],pfe-navigation.pfe-navigation--processed>[slot=secondary-links]{height:auto;overflow:visible;visibility:visible;width:auto}#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,#pfe-navigation.pfe-navigation--processed>[slot],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed>[slot]{animation:none;opacity:1}#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{display:block;height:auto;list-style:none;margin:0 0 8px;padding:0;width:auto}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0 0 8px}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{display:none!important}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{pointer-events:none}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding:0 16px 0 0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{display:block;height:18px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed #fff;border:1px dashed var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{box-shadow:none}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{background:0 0;box-shadow:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column{position:relative}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper{display:block}#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{height:0;transition:height .25s ease-in-out;transition:var(--pfe-navigation--accordion-transition,height .25s ease-in-out)}@media (prefers-reduced-motion){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{transition:none}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:absolute;right:0;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:auto}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:0}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper{left:100vw;left:calc(100vw - 32px);left:calc(100vw - var(--pfe-navigation__mobile-dropdown--PaddingHorizontal,32px));position:absolute;top:0;width:100vw}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false],pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false]{height:100vh;height:calc(100vh - 72px);height:calc(100vh - var(--pfe-navigation__nav-bar--Height,72px));overflow-y:scroll}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 64px24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px) var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a{border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));display:inline-block}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6{margin:32px 0 .75em;margin:var(--pfe-navigation--gutter,32px) 0 .75em;padding:0;-moz-column-break-inside:avoid;break-inside:avoid;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);font-family:Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamilyHeadline,Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif);font-size:1.125rem;font-size:var(--pf-global--FontSize--lg,1.125rem);font-weight:500}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a{border:1px solid transparent;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li{margin:0 0 16px;-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--BackgroundColor,#e00);--pfe-cta--BackgroundColor--hover:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00);--pfe-theme--ui--border-width:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00)}pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul{list-style:none;margin:0;padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515);-moz-column-count:auto;column-count:auto;display:block;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);gap:0;margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:flex;flex-wrap:wrap;padding-bottom:32px;padding-top:32px}@supports (display:grid){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{display:grid;gap:32px;gap:var(--pfe-navigation--gutter,32px);grid-auto-flow:row;grid-template-columns:repeat(4,minmax(0,1fr))}}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:block;gap:0;margin-left:-16px;margin-right:-16px;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{transition-delay:0s;visibility:visible}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px;-moz-column-break-inside:avoid;break-inside:avoid}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid{max-width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown{background:#fff}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:32px 64px;padding:32px var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px)}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container{margin:0;padding:0;width:auto}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class]{padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown{visibility:hidden}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{padding:0}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:0 1px 2px rgba(0,0,0,.12);box-shadow:var(--pfe-navigation__dropdown--BoxShadow,0 1px 2px rgba(0,0,0,.12));max-width:100%;min-width:13em;padding:0 32px;position:absolute;top:100%}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:none;max-width:100%;position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{right:0}}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{width:100%}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{left:0;position:absolute;right:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{position:static}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown{width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles{padding-left:16px;padding-right:16px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form{align-items:center;display:flex}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{padding:10px;transition:box-shadow .2s}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{border:1px solid #f0f0f0;border-bottom-color:#8b8e91;color:#717579;flex-basis:0%;flex-grow:1;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);margin-right:8px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button{background-color:#e00;border:1px solid #e00;border-radius:2px;color:#fff;flex-basis:auto;flex-grow:0;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after{border:1px dashed #000;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{border-bottom:1px solid #d2d2d2;border-bottom:var(--pfe-navigation__dropdown--separator--Border,1px solid var(--pfe-theme--color--ui--border--lighter,#d2d2d2));display:block}@media (min-width:768px){#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:none}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__site-switcher__back-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:block}#pfe-navigation .pfe-navigation__site-switcher__back-button,pfe-navigation .pfe-navigation__site-switcher__back-button{background-color:transparent;border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);padding:21px 21px 21px 45px;position:relative;text-align:left;width:100%}#pfe-navigation .pfe-navigation__site-switcher__back-button:before,pfe-navigation .pfe-navigation__site-switcher__back-button:before{border:2px solid #06c;border:2px solid var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));border-right:0;border-top:0;content:"";display:block;height:8px;left:35px;position:absolute;right:auto;top:27px;transform:rotate(45deg);transform-origin:left top;width:8px}#pfe-navigation .pfe-navigation__site-switcher__back-button:focus,#pfe-navigation .pfe-navigation__site-switcher__back-button:hover,pfe-navigation .pfe-navigation__site-switcher__back-button:focus,pfe-navigation .pfe-navigation__site-switcher__back-button:hover{border:1px dashed #151515;border-top:1px dashed #151515;border:1px dashed var(--pfe-navigation__dropdown--Color,#151515);color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);outline:0}#pfe-navigation.pfe-navigation--processed site-switcher,pfe-navigation.pfe-navigation--processed site-switcher{-moz-columns:auto;columns:auto;display:block}#pfe-navigation.pfe-navigation--stuck,pfe-navigation.pfe-navigation--stuck{left:0;position:fixed;top:0;width:100%;z-index:95;z-index:var(--pfe-theme--zindex--navigation,95)}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner{opacity:1!important}#pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown{display:none!important}#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown{display:block!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item{display:block}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus{outline:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown{display:flex;flex-wrap:wrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope{flex-basis:25%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope{flex-basis:100%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope{margin-right:16px}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{display:flex;flex-direction:column;flex-wrap:nowrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{flex-basis:auto}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a{color:#fff!important;justify-content:center!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true]{color:#151515!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon{display:none!important}[id=pfe-navigation__account-dropdown][class][class]{display:block;height:auto;left:0;padding:0;position:absolute;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px);width:100%}[id=pfe-navigation__account-dropdown].pfe-navigation__dropdown-wrapper--invisible[class]{display:none}.pfe-navigation__dropdown-wrapper{overflow:hidden}@media (min-width:768px){.pfe-navigation__custom-dropdown--single-column{min-width:25em}}.pfe-navigation--collapse-secondary-links .pfe-navigation__custom-dropdown--single-column{min-width:0}.secondary-link__icon-wrapper{align-items:center;display:flex;justify-content:center}.secondary-link__alert-count{background:#06c;background:var(--pfe-navigation__nav-bar--alert-color,var(--pfe-theme--color--link,#06c));border-radius:20px;color:#fff;color:var(--pfe-navigation__nav-bar--Color--on-highlight,var(--pfe-theme--color--text--on-saturated,#fff));display:block;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);line-height:20px;margin:0 4px 0 2px;min-width:23px;overflow:hidden;padding:0 8px}.secondary-link__alert-count:empty{display:none}#pfe-navigation__1x-skip-links{left:0;position:absolute;top:0}#pfe-navigation__1x-skip-links,#pfe-navigation__1x-skip-links li{height:0;list-style:none;margin:0;padding:0;width:0}.skip-link[class][class]{font-size:.875rem;font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}pfe-navigation pfe-navigation-account[slot=account]{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));width:100%}</style>
<style>:host([size=sm]) #container[data-v-8589d091]{--_size:var(--pf-global--icon--FontSize--sm,12px)}.content-wrapper[data-v-8589d091]{height:auto;margin:0 auto;min-height:46vh}.content[data-v-8589d091]{max-width:1000px}#left-content[data-v-8589d091]{max-width:330px;z-index:1}.line-below-chp[data-v-8589d091]{margin:var(--rh-space-xl,24px) 0 var(--rh-space-3xl,48px)}.toc-container[data-v-8589d091]{border-right:1px solid var(--rh-color-gray-30,#c7c7c7);min-height:100vh;position:sticky;top:0;transition:transform .3s ease-in-out}nav#toc[data-v-8589d091]{height:auto;overflow-y:auto;padding-bottom:var(--rh-space-2xl,32px)}.max-height-85[data-v-8589d091]{max-height:85vh}.max-height-75[data-v-8589d091]{max-height:75vh}.toc-filter[data-v-8589d091]{background-color:#fff;padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px);position:sticky;top:-1px;width:100%;z-index:1}#text[data-v-8589d091],.toc-filter[data-v-8589d091]{align-items:center;display:flex}#text[data-v-8589d091]{flex:1;flex-direction:row}#search-icon[data-v-8589d091]{color:#151515;left:2.5rem;position:absolute;top:55%;transform:translateY(-50%)}pf-icon[data-v-8589d091]{--pf-icon--size:16px}#text:focus-within #icon[data-v-8589d091],#text:hover #icon[data-v-8589d091]{color:#151515}#text[data-v-8589d091]:after,#text[data-v-8589d091]:before{content:"";inset:0;pointer-events:none;position:absolute}#text-input[data-v-8589d091]:focus,#text-input:focus+#utilities[data-v-8589d091]{border-bottom:2px solid #06c;outline:none}#text-input[data-v-8589d091]{background-color:transparent;border:1px solid #f0f0f0;border-bottom-color:#8a8d90;color:#151515;font-family:inherit;font-size:100%;grid-area:text-input;line-height:1.5;overflow:hidden;padding:.375rem .25rem .375rem 2rem;position:relative;text-overflow:ellipsis;white-space:nowrap;width:100%}#utilities[data-v-8589d091]{align-items:center;border:1px solid #f0f0f0;border-bottom:1px solid #8a8d90;border-left:0;display:flex}#utilities rh-badge[data-v-8589d091]{border-radius:80px;font-weight:var(--rh-font-weight-heading-medium,500);--_background-color:#e0e0e0;margin-right:8px}#clear-button[data-v-8589d091]{--pf-c-button--PaddingTop:0.625rem;--pf-c-button--PaddingRight:.25rem;--pf-c-button--PaddingBottom:0.625rem;--pf-c-button--PaddingLeft:.25rem;margin-right:8px}#text-input.no-right-border[data-v-8589d091]{border-right:0}.btn-container[data-v-8589d091]{bottom:0;display:flex;justify-content:flex-end;padding:1rem;pointer-events:none;position:fixed;right:0;z-index:2}.top-scroll-btn[data-v-8589d091]{--pf-c-button--BorderRadius:64px;pointer-events:all}.focusable[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-interactive-blue,#06c)}.mobile-nav-wrapper[data-v-8589d091]{align-items:center;border-bottom:1px solid #c7c7c7;display:flex;height:auto;justify-content:space-between;padding:var(--rh-space-sm,.5rem)}.mobile-nav[data-v-8589d091]{align-items:center;background-color:var(--rh-color-bg-page,#fff);min-height:51px;position:sticky;top:0;z-index:5}.active-mobile-menu[data-v-8589d091]{color:#151515;padding-left:.5rem}.hidden[data-v-8589d091]{display:none}.mobile-nav-btn[data-v-8589d091]{background-color:transparent;border:none;font-family:inherit;font-size:.875rem;font-weight:500;margin:0;min-height:40px;min-width:40px}.border-right[data-v-8589d091]{border-right:1px solid #c7c7c7}.toc-focus-container[data-v-8589d091]{position:sticky;top:0;z-index:2}.toc-focus-btn[data-v-8589d091]{align-items:center;background-color:var(--rh-color-white,#fff);border:1px solid var(--rh-color-blue-50,#06c);border-radius:50%;cursor:pointer;display:flex;height:40px;justify-content:center;position:absolute;right:-20px;top:15px;width:40px}.toc-focus-btn[data-v-8589d091]:focus-visible,.toc-focus-btn[data-v-8589d091]:hover{background-color:var(--rh-color-blue-10,#e0f0ff);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2))}.toc-focus-btn[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-blue-50,#06c)}.toc-focus-btn-icon[data-v-8589d091]{color:var(--rh-color-blue-50,#06c)}.toc-wrapper[data-v-8589d091]{padding:0}.product-container[data-v-8589d091]{border-bottom:1px solid var(--rh-color-gray-30,#c7c7c7);padding:var(--rh-space-xl,24px) var(--rh-space-2xl,32px)}.product-container h1.product-title[data-v-8589d091]{font-size:var(--rh-font-size-code-xl,1.25rem);line-height:30px;margin-bottom:0;margin-top:0}.product-container .product-version[data-v-8589d091]{align-items:center;display:flex;flex-wrap:wrap;margin-top:var(--rh-space-lg,16px)}.product-version .version-label[data-v-8589d091]{color:var(--rh-color-canvas-black,#151515);font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:500}.product-version .version-select-dropdown[data-v-8589d091]{margin:var(--rh-space-md,8px) var(--rh-space-sm,6px);max-width:9.75rem;min-height:2rem;min-width:3rem;overflow:hidden;width:-moz-min-content;width:min-content;word-wrap:nowrap;-webkit-appearance:none;-moz-appearance:none;background:var(--rh-color-white,#fff);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position-x:85%;background-position-y:50%;background-repeat:no-repeat;border:1px solid var(--rh-color-gray-30,#c7c7c7);border-bottom:0;box-shadow:0 -1px 0 0 var(--rh-color-gray-60,#4d4d4d) inset;cursor:pointer;font-size:var(--rh-font-size-body-text-md,1rem);padding:var(--rh-space-md,8px);padding-right:24px;text-overflow:ellipsis}pf-popover[data-v-8589d091]{margin-top:var(--rh-space-md,8px);--pf-c-popover__arrow--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover__content--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover--BoxShadow:0px 4px 8px 0px #15151540;--pf-c-popover__title-text--Color:var(--rh-color-white,#fff);--pf-c-popover--MaxWidth:300px;--pf-c-popover--MinWidth:300px;--pf-c-popover--c-button--Top:20px;--pf-c-popover--c-button--Right:4px;--pf-c-button--m-plain--hover--Color:var(--rh-color-white,#fff)}pf-popover[data-v-8589d091]::part(content){padding:var(--rh-space-2xl,32px)}pf-popover[data-v-8589d091]::part(body){margin-top:var(--rh-space-lg,16px)}pf-popover[data-v-8589d091]::part(close-button){--pf-c-button--m-plain--focus--Color:var(--rh-color-gray-30,#c7c7c7);--pf-c-button--m-plain--Color:var(--rh-color-gray-30,#c7c7c7)}.popover-header-text[data-v-8589d091]{color:var(--rh-color-white,#fff);font-size:var(--rh-font-size-code-md,1rem);margin:0;max-width:80%;padding:0}.popover-body-link[data-v-8589d091]{color:var(--rh-color-blue-30,#92c5f9);text-decoration:none}.popover-trigger-btn[data-v-8589d091]{align-items:center;background:none;border:none;cursor:pointer;display:flex;justify-content:center}#first-button[data-v-8589d091]{width:80%}#second-button[data-v-8589d091]{text-align:right;width:20%}#toc-btn[data-v-8589d091]{text-align:left;width:100%}.toc-error[data-v-8589d091]{margin:0;max-width:100%}#layout label[data-v-8589d091]{font-weight:500}.page-layout-options[data-v-8589d091]{background-color:#fff;display:flex;flex-direction:column;padding-bottom:var(--rh-space-lg,16px)}.sticky-top[data-v-8589d091]{position:sticky;top:0}summary[data-v-8589d091]{cursor:pointer;list-style:none;position:relative}summary[data-v-8589d091]::-webkit-details-marker{display:none}details#jump-links-details .jump-links-heading[data-v-8589d091]{background-color:var(--rh-color-white,#fff);display:block;margin-top:var(--rh-space-lg,16px);padding:var(--rh-space-lg,16px) 0 0 var(--rh-space-xl,24px);position:sticky;top:0}details#jump-links-details .jump-links-heading[data-v-8589d091]:before{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;height:9px;left:2px;position:absolute;top:26px;transform:rotate(-135deg);width:9px}details#jump-links-details[open] .jump-links-heading[data-v-8589d091]:before{transform:rotate(135deg)}.table-of-contents>ol[data-v-8589d091]{list-style:none;margin:0;padding:0}nav.table-of-contents[data-v-8589d091]{z-index:1}nav.table-of-contents ol[data-v-8589d091]{list-style:none;margin:0;padding:0}#mobile-browse-docs[data-v-8589d091]{font-weight:var(--rh-font-weight-body-text-medium,500);padding-left:var(--rh-space-2xl,32px)}.docs-content-container[data-v-8589d091]{font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:1.6667;padding-left:6rem;padding-right:6rem;padding-top:var(--rh-space-3xl,4rem)}.chapter-title[data-v-8589d091]{font-family:Red Hat Display}h1.chapter-title[data-v-8589d091]{font-size:var(--rh-fontsize-heading-xl,2.25rem);line-height:46.8px;margin:0;padding:0}.chapter .section h4[data-v-8589d091]{font-size:24px;font-weight:400}.banner-wrapper[data-v-8589d091]{padding:3rem 6rem 0}.page-format-dropdown[data-v-8589d091]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#fff;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABtSURBVHgBhc4xCoAwDAXQxE6li0K76w0cPZqjHsEb6AlcHb2BR9ADdG7GmIKTWv0QSOAFPjrndgAo4TtHxszTD4JoVAhh1VoXiNgkUO+971Q8iGgxxlSy1jc3CGof39baWTrzNSOkkksEbG/oBGEJIn6gD3jAAAAAAElFTkSuQmCC");background-position:8.5rem;background-repeat:no-repeat;background-size:auto;border:1px solid #c7c7c7;box-shadow:inset 0 -1px 0 0 #4d4d4d;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-md,1rem);margin-top:var(--rh-space-xs,4px);max-width:168px;min-height:36px;min-width:168px;overflow:hidden;padding:0 var(--rh-space-xl,24px) 0 var(--rh-space-md,8px);text-overflow:ellipsis;white-space:nowrap}.content-format-selectors[data-v-8589d091]{color:#151515;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:var(--rh-font-weight-body-text-medium,500);margin-right:var(--rh-space-2xl,32px);max-width:250px;min-width:250px;padding-top:var(--rh-space-2xl,32px)}.chapter .section .simpara[data-v-8589d091],.chapter .section p[data-v-8589d091]{font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:30px}#toggle-focus-mode[data-v-8589d091]{padding-right:var(--rh-space-lg,1rem)}@keyframes slideaway-left-8589d091{0%{display:block}to{opacity:0;transform:translateX(-40px)}}@keyframes slideaway-right-8589d091{0%{display:block}to{opacity:0;transform:translateX(40px)}}@keyframes enter-left-8589d091{0%{display:none;transform:translateX(-40px)}to{opacity:1}}@keyframes enter-right-8589d091{0%{display:none;transform:translateX(40px)}to{opacity:1}}.hide-left[data-v-8589d091]{animation:slideaway-left-8589d091 .2s;display:none}.enter-left[data-v-8589d091]{animation:enter-left-8589d091 .3s;border-right:none;display:block}.enter-right[data-v-8589d091]{animation:enter-right-8589d091 .3s;display:block}.hide-right[data-v-8589d091]{animation:slideaway-right-8589d091 .2s;display:none}.toc-container.enter-toc-container-left[data-v-8589d091]{transform:translateX(-85%)}.alert-section[data-v-8589d091]{padding-bottom:3rem}rh-alert[data-v-8589d091]{width:auto}@media (min-width:992px){#mobile-nav[data-v-8589d091],#toc-list-mobile[data-v-8589d091]{display:none}}@media (min-width:992px) and (max-width:1400px){.docs-ocp-content-container[data-v-8589d091]{padding:var(--rh-space-4xl,64px) var(--rh-space-lg,16px) 0}}@media (width < 992px){#breadcrumbs[data-v-8589d091],.content-format-selectors[data-v-8589d091],.toc-container[data-v-8589d091]{display:none}#mobile-nav-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7}#toc-wrapper-mobile[data-v-8589d091]{padding:var(--rh-space-md,1.5rem)}.product-container[data-v-8589d091]{padding:var(--rh-space-2xl,32px) var(--rh-space-lg,16px)}.product-container.shrink-product-padding[data-v-8589d091]{padding:var(--rh-space-lg,16px)}.product-version .version-select-dropdown[data-v-8589d091]{margin:0 var(--rh-space-lg,16px)}#page-content-options-mobile[data-v-8589d091]{padding:var(--rh-space-lg,2rem)}label[for=page-format][data-v-8589d091],label[for=toggle-focus-mode][data-v-8589d091]{display:block}.page-format-dropdown[data-v-8589d091]{background-position:97%;max-width:100%}nav#mobile-toc-menu[data-v-8589d091]{max-height:50vh;overflow-y:scroll}.mobile-jump-links #first-button[data-v-8589d091]{width:100%}#jump-links-btn[data-v-8589d091]{text-align:left;width:100%}#mobile-jump-links-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7;padding:0 var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}.table-of-contents #browse-docs[data-v-8589d091]{margin-top:1rem;padding-top:var(--rh-space-md,1.5rem)}.mobile-nav[data-v-8589d091]{display:block}.hide-mobile-nav[data-v-8589d091],.mobile-nav[data-v-8589d091]{transition:transform .3s ease-in-out}.hide-mobile-nav[data-v-8589d091]{transform:translateY(-100%)}.docs-content-container[data-v-8589d091]{padding-left:1.25rem;padding-right:1.25rem;padding-top:var(--rh-space-xl,24px)}.banner-wrapper[data-v-8589d091]{padding:0 1rem}.toc-filter-mobile[data-v-8589d091]{align-items:center;display:flex;padding:var(--rh-space-lg,16px);width:100%}#text-input[data-v-8589d091]{padding-left:.5rem}.toc-filter[data-v-8589d091]{display:none}}@media (width <=576px){.content-format-selectors[data-v-8589d091]{display:none}}.informaltable[data-v-8589d091],.rhdocs .informaltable[data-v-8589d091],.rhdocs .table-contents[data-v-8589d091],.rhdocs .table-wrapper[data-v-8589d091],.table-contents[data-v-8589d091],.table-wrapper[data-v-8589d091]{max-height:var(--rh-table--maxHeight);overflow:auto}rh-table[data-v-8589d091]{display:block;margin:2rem 0;max-width:100%}.pvof-doc__wrapper[data-v-8589d091],.rhdocs[data-v-8589d091]{--rh-table--maxHeight:calc(100vh - 12.5rem)}</style>
<style>:is(rh-footer-block) a[data-v-97dd2752]{text-decoration:underline}</style>
<style>:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a{color:var(--rh-color-link-inline-on-dark,var(--rh-color-interactive-blue-lighter,#92c5f9));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:hover{color:var(--rh-color-link-inline-hover-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:is(:focus,:focus-within){color:var(--rh-color-link-inline-focus-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:visited{color:var(--rh-color-link-inline-visited-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a[slot^=logo]{display:block}:is(rh-footer) a[slot^=logo]>img{display:block;height:100%;height:var(--rh-size-icon-04,40px);width:auto}:is(rh-footer,rh-footer-universal,rh-global-footer) :is(h1,h2,h3,h4,h5,h6){font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);line-height:var(--rh-line-height-heading,1.3)}rh-footer [slot=links]:is(h1,h2,h3,h4,h5):nth-of-type(n+5){--_link-header-margin:calc(var(--rh-space-2xl, 32px) - var(--rh-space-lg, 16px))}rh-footer [slot^=links] a{gap:var(--rh-footer-links-gap,var(--rh-space-md,8px))}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] li{display:contents;margin:0;padding:0}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] a{color:var(--rh-color-text-primary-on-dark,#fff)!important;display:block;font-size:var(--rh-footer-link-font-size,var(--rh-font-size-body-text-sm,.875rem));width:-moz-fit-content;width:fit-content}:is(rh-footer-universal,rh-global-footer) [slot^=links] a{font-size:inherit}:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-lg,16px)}@media screen and (min-width:768px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-2xl,32px)}}@media screen and (min-width:1440px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-4xl,64px)}}rh-footer:not(:defined){background-color:var(--rh-color-surface-darker,#1f1f1f);display:grid;grid-template-areas:"footer" "global";grid-template-rows:1fr auto;min-height:var(--rh-footer-nojs-min-height,750px);width:100%}:is(rh-footer-universal,rh-global-footer):not(:defined):before{grid-area:global}rh-footer:not(:defined)>[slot=logo]{padding:var(--rh-space-2xl,32px) var(--_section-side-gap)}:is(rh-footer-universal,rh-global-footer):not(:defined)>*,rh-footer:not(:defined)>:not([slot=logo],:is(rh-footer-universal,rh-global-footer)){border:0;clip:rect(1px,1px,1px,1px);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}:is(rh-footer-universal,rh-global-footer):not(:defined){background-color:var(--rh-color-surface-darkest,#151515);display:block;min-height:176px;width:100%}rh-footer-universal rh-footer-copyright{grid-column:-1/1}</style>
<style>.status-legal .status-page-widget[data-v-5f538988]{display:block;margin:.5rem 0;width:11.3125rem;width:-moz-max-content;width:max-content}.status-page-widget[data-v-5f538988]{align-items:center;display:flex;flex-direction:row}.status-legal .status-page-widget .status-description[data-v-5f538988]{color:#ccc;font-weight:600;letter-spacing:.0125rem;line-height:1.5;margin-right:.5rem}.status-good[data-v-5f538988]{background-color:#3e8536}.status-critical[data-v-5f538988]{background-color:#a30100}.status-partial[data-v-5f538988]{background-color:#f5c12d}.status-maintentance[data-v-5f538988]{background-color:#316dc1}.status-minor[data-v-5f538988]{background-color:#b85c00}.status-description[data-v-5f538988]{color:#ccc;font-weight:500;letter-spacing:.2px;line-height:1.5}.current-status-indicator[data-v-5f538988]{border-radius:6px;display:inline-block;height:12px;margin:0 0 0 5px;width:12px}.current-status-indicator.small[data-v-5f538988]{border-radius:4px;display:inline-block;height:8px;margin:0 0 0 5px;width:8px}</style>
<style>.breadcrumbs[data-v-798f280c]{align-items:center;background-color:#f6f6f6;display:flex;gap:var(--rh-space-xl,24px);padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}nav[data-v-798f280c]{flex:1}ol[data-v-798f280c]{background-color:#f6f6f6;font-size:.875rem;list-style:none;margin:0;padding:0}li[data-v-798f280c]{color:#151515;display:inline}a[data-v-798f280c]:after{border-bottom-color:transparent;border-left-color:transparent;box-shadow:inset .25rem .25rem 0 .0625rem #8a8d8d;content:"";display:inline-block;height:1.07143em;margin:0 .5em;position:relative;right:0;top:.75em;transform:translateY(-.5em) rotate(135deg) scale(.5);width:1.07143em}</style>
<style>ol[data-v-fa0dae77]{margin:0;padding:0}li[data-v-fa0dae77],ol[data-v-fa0dae77],ul[data-v-fa0dae77]{list-style:none;margin:0}.chapter-title[data-v-fa0dae77]{font-size:1em}.sub-chapter-title[data-v-fa0dae77],.sub-chapter-title a[data-v-fa0dae77]{font-size:.875rem}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77],.heading[data-v-fa0dae77],.sub-nav .link[data-v-fa0dae77],.sub-nav .link .link[data-v-fa0dae77]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-fa0dae77]:hover,.link[data-v-fa0dae77]:hover,.sub-nav .link[data-v-fa0dae77]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}details[open]:first-of-type>.heading[data-v-fa0dae77]:after{transform:rotate(135deg)}.item[data-v-fa0dae77]{line-height:22px}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77]{color:var(--rh-color-text-primary-on-light,#151515)}.sub-nav[data-v-fa0dae77],.toc-wrapper[data-v-fa0dae77]{list-style:none;margin:0}.toc-wrapper[data-v-fa0dae77]{min-width:100%;padding:0}.sub-nav[data-v-fa0dae77]{font-size:1em;line-height:24px;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-fa0dae77]:hover{color:#151515}.active[data-v-fa0dae77]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.chapter-landing-page[data-v-fa0dae77]{font-weight:500}summary[data-v-fa0dae77]{cursor:pointer;list-style:none;position:relative}summary[data-v-fa0dae77]::-webkit-details-marker{display:none}@keyframes slideDown-fa0dae77{0%{height:0;opacity:0}to{height:var(--details-height-open,"100%");opacity:1}}html[data-v-fa0dae77]{--details-transition-time:400ms}details[data-v-fa0dae77]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-fa0dae77]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-fa0dae77]:after,details .heading[data-v-fa0dae77]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-fa0dae77]:after{height:8px;width:8px}</style>
<style>.item[data-v-b883c74f]{line-height:22px}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f]{color:var(--rh-color-text-primary-on-light,#151515)}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f],.heading[data-v-b883c74f],.sub-nav .link[data-v-b883c74f],.sub-nav .link .link[data-v-b883c74f]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-b883c74f]:hover,.link[data-v-b883c74f]:hover,.sub-nav .link[data-v-b883c74f]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}ol[data-v-b883c74f]{margin:0;padding:0}li[data-v-b883c74f],ol[data-v-b883c74f],ul[data-v-b883c74f]{list-style:none;margin:0}.chapter-title[data-v-b883c74f]{font-size:1em}.sub-nav[data-v-b883c74f]{font-size:1em;line-height:24px;list-style:none;margin:0;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-b883c74f]:hover{color:#151515}.active[data-v-b883c74f]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.sub-chapter-title[data-v-b883c74f],.sub-chapter-title a[data-v-b883c74f]{font-size:.875rem}summary[data-v-b883c74f]{cursor:pointer;list-style:none;position:relative}summary[data-v-b883c74f]::-webkit-details-marker{display:none}html[data-v-b883c74f]{--details-transition-time:400ms}.chapter-landing-page[data-v-b883c74f]{font-weight:500}details[open]:first-of-type>.heading[data-v-b883c74f]:after{transform:rotate(135deg)}details[data-v-b883c74f]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-b883c74f]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-b883c74f]:after,details .heading[data-v-b883c74f]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-b883c74f]:after{height:8px;width:8px}</style>
<style>.html-container[data-v-9c2a9ddb]{padding:2rem 1.5rem 0}rh-alert[data-v-9c2a9ddb]{color:#151515}@media (max-width:772px){.html-container[data-v-9c2a9ddb]{padding:3rem 1rem 0}}</style>
<style>.search-container[data-v-69710f44]{height:100%}.form-box[data-v-69710f44],.search-container[data-v-69710f44]{justify-content:center}.form-box[data-v-69710f44],.search-box[data-v-69710f44],.search-container[data-v-69710f44]{align-items:center;display:flex;width:100%}.search-box[data-v-69710f44]{justify-content:space-between;position:relative}ul[data-v-69710f44]{list-style-type:none}#search-list[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;box-shadow:0 4px 4px 0 #00000040;color:#151515;display:block;left:0;margin:0;padding:0;position:absolute;top:37px;width:100%;z-index:200}#search-list li[data-v-69710f44]{align-items:center;display:flex;justify-content:space-between;padding:.75rem}#search-list .active[data-v-69710f44],#search-list li[data-v-69710f44]:hover{background:#f0f0f0}.group-title[data-v-69710f44]{border-top:1px solid #4d4d4d;color:#4d4d4d;cursor:default;font-size:12px;font-weight:400;pointer-events:none}.group-title[data-v-69710f44],.group-title[data-v-69710f44]:hover{background:#fff}.search-item-text-elipsis[data-v-69710f44]{display:inline-block;max-width:48%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.search-item-text[data-v-69710f44]{padding-left:1.75rem}.search-item-chip[data-v-69710f44]{float:right}.search-product-version[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;border-radius:3px;font-size:1rem;font-weight:400;line-height:24px}.search-icon-form[data-v-69710f44]{color:var(--rh-color-gray-50,#707070);left:12px;position:absolute}.input-search-box[data-v-69710f44]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 40px;width:100%}.input-clear-btn[data-v-69710f44]{align-items:center;background-color:transparent;border:none;display:flex;height:36px;justify-content:center;margin-right:-30px;outline:none;transform:translateX(-30px)}.input-clear-btn[data-v-69710f44]:focus{border:1px solid var(--rh-color-accent-base-on-light,#06c)}.input-clear-btn:focus .input-clear-icon[data-v-69710f44]{color:var(--rh-color-canvas-black,#151515)}.input-clear-icon[data-v-69710f44]{color:#6b6e72;cursor:pointer}.input-clear-icon[data-v-69710f44]:hover{color:var(--rh-color-canvas-black,#151515)}.form-submit-btn[data-v-69710f44]::part(button){align-items:center;background-color:var(--rh-color-gray-20,#e0e0e0);border-radius:0;display:flex;height:36px;justify-content:center;--_default-border-color:var(--rh-color-gray-20,#e0e0e0)}.input-close-btn[data-v-69710f44]{background:none;border:none;cursor:pointer;margin:0 var(--rh-space-lg,16px)}.input-close-icon[data-v-69710f44]{color:var(--rh-color-white,#fff)}@media (max-width:992px){.form-box[data-v-69710f44]{gap:var(--rh-space-md,8px);margin:auto;width:100%}.input-search-box[data-v-69710f44]{border:1px solid var(--rh-color-gray-30,#c7c7c7)}.input-search-box[data-v-69710f44]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-search-box[data-v-69710f44]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.search-item-text-elipsis[data-v-69710f44]{max-width:60%}}@media (max-width:767px){.input-close-btn[data-v-69710f44]{display:none}.search-container[data-v-69710f44]{border:1px solid #f0f0f0}}</style>
<link rel="stylesheet" href="/_nuxt/entry.DNAluCmw.css" integrity="sha384-FnrZajt9k3u4tri3ClqikI96k+jP7kyrvgKKgdzBr5Y8CQEi3gusKE0+eMSLvGxm">
<link rel="stylesheet" href="/_nuxt/SearchAutocomplete.DkrJaF8R.css" integrity="sha384-Zw8gf6w7SrpWDmknvrab5QanIN+DSJRS/bPB9/lgDkhR7JhDmG/VF++MTMKU8mKB">
<link rel="stylesheet" href="/_nuxt/Breadcrumbs.BLkLxUMB.css" integrity="sha384-f6iEfCywVoZB0/hIKTRaxywtS21KzhBx2JOI/uVjjU9aqFcP7X9cqLH29w2HQvLe">
<link rel="stylesheet" href="/_nuxt/Alert.fTkXFs3h.css" integrity="sha384-yFMpT5E64LAQi3qJ10AJJ1oOH3DrI68OvLSjSivjNCQXZ25pmFxlPavPQ0TEyEpq">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C3PvZR0C.js" integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ds9UYxCD.js" integrity="sha384-PFyBx6Pvk48yXM+prD4CDErW/3HFtPEqORVyAch5qDvJSyubA93+vR4jsWGRQKZs">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BUXK7nH-.js" integrity="sha384-Kqf3r1QrD7+NOn9EuK/ba9sTBZjn7vLAjnCoRtq7IKz+QV0JUUBFf1Snf1yVkkgr">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BxBriHwM.js" integrity="sha384-bejD6BN5N1iVRo5Ymn+LdVN0jvrnJTzgqgFD9xQ5+Yi46U6ff+s5W2AISzRWvJaM">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DB5Lt3x5.js" integrity="sha384-Ae/gV/4Dt4jnJApC0CWbckKJ7omq+W9Hb4jjdMyhxGJpwk6FlO7pGYMD3bPO/h1y">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D8BFaW0S.js" integrity="sha384-/m09v/yYk14L9Hra6/9jYtMTn2IdkKQvzpFPRQ5P/baRKwdZQN98873hqvwuYXFS">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/_58Q44fW.js" integrity="sha384-EdSd8jpnetO/BWDAc8C4SpQExZ7pYjMygNPvbLmiA1TaYsNUdVOqIIyOIzaErEeU">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DOCUiUcq.js" integrity="sha384-9H868K5q7MLzC8TSRXT3pVqDzsOVxZLYvUQ8cLGpHPZCFEyEJjnwSHE+/7FWrJPV">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CiTVMRA7.js" integrity="sha384-xBIJ2xO0t62/oREKqSxPtW1tRxKY+5YYXbGcJ0QR9IRM28JhL+53NOiAvVFn3rmF">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CR3F0y4K.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Bn-QuJwp.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/T_zvNmZe.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Ciddaed-.js">
<link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/Footer_Cloud.DpSdW8MR.svg">
<script type="module">
      import "@rhds/elements/rh-cta/rh-cta.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@cpelements/pfe-navigation/dist/pfe-navigation.min.js";
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">import "@rhds/elements/rh-footer/rh-footer.js"</script>
<link rel="canonical" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/security_hardening/index">
<script type="module">
      import "@rhds/elements/rh-alert/rh-alert.js";
      import "@rhds/elements/rh-code-block/rh-code-block.js";
      import '@rhds/elements/rh-cta/rh-cta.js';
      import '@patternfly/elements/pf-switch/pf-switch.js';
      import '@cpelements/rh-table/dist/rh-table.js';
      import '@patternfly/pfe-clipboard/dist/pfe-clipboard.min.js';
      import '@patternfly/elements/pf-button/pf-button.js';
      import '@patternfly/elements/pf-modal/pf-modal.js';
      import '@patternfly/elements/pf-icon/pf-icon.js';
      import '@patternfly/elements/pf-popover/pf-popover.js';
      import '@patternfly/elements/pf-tooltip/pf-tooltip.js';
      import '@rhds/elements/rh-badge/rh-badge.js';
      </script>
<meta name="description" content="Security hardening | Red Hat Documentation">
<meta name="app-version" content="v0.0.1">
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
        import "@patternfly/elements/pf-badge/pf-badge.js";
      </script>
<script type="module" src="/_nuxt/C3PvZR0C.js" crossorigin integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c"></script></head><body><div id="__nuxt"><!--[--><!--[--><!----><header data-v-edc0d12c><a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden" data-v-edc0d12c>Skip to navigation</a><a href="#main-content" class="skip-link visually-hidden" data-v-edc0d12c>Skip to content</a><nav id="upper-navigation" class="upper-navigation" aria-labelledby="upper-navigation-label" data-analytics-region="upper-navigation" data-v-edc0d12c><p id="upper-navigation-label" class="upper-nav-hidden" data-v-edc0d12c>Featured links</p><div class="upper-nav-container" data-v-edc0d12c><ul class="upper-nav-menu" data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/" class="upper-nav-links" data-analytics-text="Support" data-analytics-category="Featured Links" data-v-edc0d12c>Support</a></li><li data-v-edc0d12c><a href="https://console.redhat.com/" class="upper-nav-links" data-analytics-text="Console" data-analytics-category="Featured Links" data-v-edc0d12c>Console</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" class="upper-nav-links" data-analytics-text="Developers" data-analytics-category="Featured Links" data-v-edc0d12c>Developers</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" class="upper-nav-links" data-analytics-text="Start a trial" data-analytics-category="Featured Links" data-v-edc0d12c>Start a trial</a></li><li data-v-edc0d12c><button id="all-red-hat" class="upper-nav-links" data-analytics-text="All Red Hat" data-analytics-category="Featured Links" aria-expanded="false" data-analytics-linktype="tab" data-v-edc0d12c>All Red Hat<svg class="upper-nav-arrow" xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024" aria-hidden="true" data-v-edc0d12c=""><path d="M810.642 511.557c0 8.905-3.447 16.776-10.284 23.613L322.31 1013.216c-6.835 6.837-14.706 10.284-23.61 10.284s-16.776-3.447-23.613-10.284l-51.303-51.303c-6.837-6.837-10.284-14.707-10.284-23.612s3.447-16.775 10.284-23.61L626.972 511.5 223.784 108.31c-6.837-6.835-10.284-14.706-10.284-23.61s3.447-16.776 10.284-23.613l51.303-51.303C281.924 2.947 289.794-.5 298.7-.5s16.775 3.447 23.61 10.284L800.36 487.83c6.837 6.837 10.284 14.708 10.284 23.613v.114" data-v-edc0d12c=""/></svg></button><div class="upper-nav-dropdown-container" data-v-edc0d12c><ul data-v-edc0d12c><li data-v-edc0d12c><span data-v-edc0d12c>For customers</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/support" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Customer support" data-v-edc0d12c>Customer support</a></li><li data-v-edc0d12c><a href="/products" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Documentation" data-v-edc0d12c>Documentation</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/support/cases" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Support cases" data-v-edc0d12c>Support Cases</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/management" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Subscription management" data-v-edc0d12c>Subscription management</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/" data-analytics-category="All Red Hat|For customers" data-analytics-text="Red Hat Ecosystem Catalog" data-v-edc0d12c>Red Hat Ecosystem Catalog</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/partners" data-analytics-category="All Red Hat|For customers" data-analytics-text="Find a partner" data-v-edc0d12c>Find a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>For partners</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://connect.redhat.com/login" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner login" data-v-edc0d12c>Partner login</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/en/support" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner support" data-v-edc0d12c>Partner support</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Become a partner " data-v-edc0d12c>Become a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Try, buy, &amp; sell</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://marketplace.redhat.com/en-us" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Marketplace" data-v-edc0d12c>Red Hat Marketplace</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/store" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Store" data-v-edc0d12c>Red Hat Store</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/contact" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Contact sales" data-v-edc0d12c>Contact Sales</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Learning resources</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.redhat.com/en/services/training-and-certification" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Training and certification " data-v-edc0d12c>Training and certification</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" data-pzn-audience="developers|community" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="For developers" data-v-edc0d12c>For developers</a></li><li data-v-edc0d12c><a href="https://cloud.redhat.com/learn" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Hybrid cloud learning hub" data-v-edc0d12c>Hybrid cloud learning hub</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Interactive labs" data-v-edc0d12c>Interactive labs</a></li><li data-v-edc0d12c><a href="https://learn.redhat.com/" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Learning community" data-v-edc0d12c>Learning community</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/tv" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Red Hat TV" data-v-edc0d12c>Red Hat TV</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Open source communities</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.ansible.com/community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="Ansible" data-v-edc0d12c>Ansible</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/sysadmin/" id="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For system administrators" data-v-edc0d12c>For system administrators</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/architect/" data-pzn-audience="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For architects" data-v-edc0d12c>For architects</a></li></ul></li></ul></div></li></ul></div></nav><pfe-navigation full-width id="pfe-navigation" pf-sticky="true" lang="en" data-v-edc0d12c><nav class="pfe-navigation" aria-label="Main Navigation" data-v-edc0d12c><div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper" data-v-edc0d12c><a href="/en" class="pfe-navigation__logo-link" data-v-edc0d12c><img class="pfe-navigation__logo-image pfe-navigation__logo-image--screen pfe-navigation__logo-image--small" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" width="240" height="40" alt="Red Hat Documentation" data-v-edc0d12c></a></div></nav><span data-v-edc0d12c></span><div slot="secondary-links" data-v-edc0d12c><div class="hidden-at-desktop hidden-at-tablet search-mobile" data-v-edc0d12c><div id="search-form" class="search-container" opensearchbox="true" data-v-edc0d12c data-v-69710f44><form role="search" class="form-box" autocomplete="off" data-v-69710f44><div class="search-box" data-v-69710f44><pf-icon icon="search" size="md" class="search-icon-form" data-v-69710f44></pf-icon><input type="text" id="input-search" class="input-search-box" placeholder="Search documentation" value aria-autocomplete="list" data-v-69710f44><!----><!----><!----><rh-button disabled variant="tertiary" class="form-submit-btn" data-v-69710f44><img src="data:image/svg+xml,%3csvg%20width=&#39;14&#39;%20height=&#39;14&#39;%20viewBox=&#39;0%200%2014%2014&#39;%20fill=&#39;none&#39;%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3cpath%20d=&#39;M7%200L5.6%201.4L10.3%206H0V8H10.3L5.6%2012.6L7%2014L14%207L7%200Z&#39;%20fill=&#39;%23707070&#39;/%3e%3c/svg%3e" alt="Submit button" data-v-69710f44></rh-button></div></form><!----></div></div><div class="hidden-at-desktop hidden-at-tablet buttons" data-v-edc0d12c><a href="https://access.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Support" data-v-edc0d12c>Support</a><a href="https://console.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Console" data-v-edc0d12c>Console</a><a href="https://developers.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Developers" data-v-edc0d12c>Developers</a><a href="https://www.redhat.com/en/products/trials" data-analytics-category="More Red Hat" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a><a href="https://www.redhat.com/en/contact" data-analytics-category="More Red Hat" data-analytics-text="Contact" data-v-edc0d12c>Contact</a></div><div class="hidden-at-desktop hidden-at-tablet mobile-lang-select" data-v-edc0d12c><label for="lang_selection" data-v-edc0d12c>Select your language</label><select id="lang_selection" data-v-edc0d12c><!--[--><option value="en" xml:lang="en" hreflang="en" data-v-edc0d12c>English</option><option value="fr" xml:lang="fr" hreflang="fr" data-v-edc0d12c>Français</option><option value="ko" xml:lang="ko" hreflang="ko" data-v-edc0d12c>한국어</option><option value="ja" xml:lang="ja" hreflang="ja" data-v-edc0d12c>日本語</option><option value="zh-cn" xml:lang="zh-cn" hreflang="zh-cn" data-v-edc0d12c>中文 (中国)</option><option value="de" xml:lang="de" hreflang="de" data-v-edc0d12c>Deutsch</option><option value="it" xml:lang="it" hreflang="it" data-v-edc0d12c>Italiano</option><option value="pt-br" xml:lang="pt-br" hreflang="pt-br" data-v-edc0d12c>Português</option><option value="es" xml:lang="es" hreflang="es" data-v-edc0d12c>Español</option><!--]--></select></div></div></pfe-navigation></header><main id="main-content"><!--[--><!--[--><!--[--><!----><!----><!--]--><div class="breadcrumbs" id="breadcrumbs" data-v-8589d091 data-v-798f280c><nav aria-label="Breadcrumb" class="breadcrumb" data-v-798f280c><ol data-v-798f280c><li data-v-798f280c><a href="/" data-v-798f280c>Home</a></li><li data-v-798f280c><a href="/en/products" data-v-798f280c>Products</a></li><!--[--><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/" data-v-798f280c>Red Hat Enterprise Linux</a></li><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/9/" data-v-798f280c>9</a></li><li data-v-798f280c><!--[-->Security hardening<!--]--></li><!--]--></ol></nav><span data-v-798f280c></span></div><!----><nav id="mobile-nav" class="mobile-nav" aria-label="mobile menu" data-v-8589d091><div class="mobile-nav-wrapper" data-v-8589d091><div id="first-button" data-v-8589d091><button id="toc-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><span class="sr-only" data-v-8589d091>Open </span>Table of contents</button></div><div id="second-button" data-v-8589d091><button id="settings-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><pf-icon icon="cog" size="md" data-v-8589d091></pf-icon><span class="sr-only" data-v-8589d091>Open page settings</span></button></div></div><div id="mobile-nav-content-wrapper" class="hidden" role="navigation" tabindex="0" data-v-8589d091><div id="toc-mobile" class="hidden" aria-labelledby="toc-btn" data-v-8589d091><div class="shrink-product-padding product-container" id="product-container-mobile" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter-mobile" data-v-8589d091><span id="text" part="text" data-v-8589d091><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper-mobile" class="span-xs-12 span-sm-4 span-md-3" lang="en" data-v-8589d091><nav id="mobile-toc-menu" class="table-of-contents" aria-label="table of content - mobile" data-v-8589d091><!----></nav></div><!----></div><div id="page-content-options-mobile" class="hidden" aria-labelledby="settings-btn" data-v-8589d091><div class="page-layout-options" data-v-8589d091><label for="page-format-mobile" data-v-8589d091>Format</label><select id="page-format-mobile" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div></div></div><!----><!----></nav><div class="grid grid-col-12 content-wrapper" data-v-8589d091><aside id="left-content" class="span-xs-12 span-sm-4 span-md-3" lang="en-us" aria-label="left navigation" xml:lang="en-us" data-v-8589d091><div class="toc-container" id="toc-container" visible="true" data-v-8589d091><div class="toc-focus-container" id="toc-focus-container" data-v-8589d091><button class="toc-focus-btn" aria-label="toggle left menu" aria-controls="toc-container" aria-expanded="true" data-v-8589d091><pf-icon size="md" icon="angle-left" class="toc-focus-btn-icon" data-v-8589d091></pf-icon></button></div><div class="product-container" id="product-container-desktop" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter" id="toc-filter" data-v-8589d091><span id="text" part="text" data-v-8589d091><span id="search-icon" part="search-icon" data-v-8589d091><pf-icon icon="filter" size="md" data-v-8589d091></pf-icon></span><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper" class="toc-wrapper" data-v-8589d091><nav id="toc" class="max-height-85 table-of-contents" aria-label="Table of contents" data-v-8589d091><ol id="toc-list" data-v-8589d091><!--[--><li class="item chapter" data-v-fa0dae77><a class="link active" href id="chapter-index" data-v-fa0dae77>Security hardening</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_providing-feedback-on-red-hat-documentation_security-hardening" id="chapter-landing--security_hardening-proc_providing-feedback-on-red-hat-documentation_security-hardening" data-v-fa0dae77>Providing feedback on Red Hat documentation</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_securing-rhel-during-installation-security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_securing-rhel-during-installation-security-hardening--summary" data-v-fa0dae77>1. Securing RHEL during and right after installation</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_securing-rhel-during-installation-security-hardening" id="chapter-landing--security_hardening-assembly_securing-rhel-during-installation-security-hardening" data-v-fa0dae77>Securing RHEL during and right after installation</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#Disk_partitioning_securing-rhel-during-installation" id="sub-link-to-security_hardening-Disk_partitioning_securing-rhel-during-installation" data-v-b883c74f>1.1. Disk partitioning</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#Restricting_network_during_installation_securing-rhel-during-installation" id="sub-link-to-security_hardening-Restricting_network_during_installation_securing-rhel-during-installation" data-v-b883c74f>1.2. Restricting network connectivity during the installation process</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#Minimal_install_securing-rhel-during-installation" id="sub-link-to-security_hardening-Minimal_install_securing-rhel-during-installation" data-v-b883c74f>1.3. Installing the minimum amount of packages required</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#Post-installation_procedures_securing-rhel-during-installation" id="sub-link-to-security_hardening-Post-installation_procedures_securing-rhel-during-installation" data-v-b883c74f>1.4. Post-installation procedures</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#disabling-simultaneous-multithreading-to-prevent-cpu-security-issues_configuring-system-settings-in-the-web-console" id="sub-link-to-security_hardening-disabling-simultaneous-multithreading-to-prevent-cpu-security-issues_configuring-system-settings-in-the-web-console" data-v-b883c74f>1.5. Disabling SMT to prevent CPU security issues by using the web console</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--switching-rhel-to-fips-mode_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="switching-rhel-to-fips-mode_security-hardening--summary" data-v-fa0dae77>2. Switching RHEL to FIPS mode</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#switching-rhel-to-fips-mode_security-hardening" id="chapter-landing--security_hardening-switching-rhel-to-fips-mode_security-hardening" data-v-fa0dae77>Switching RHEL to FIPS mode</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#federal-information-processing-standards-140-and-fips-mode_switching-rhel-to-fips-mode" id="sub-link-to-security_hardening-federal-information-processing-standards-140-and-fips-mode_switching-rhel-to-fips-mode" data-v-b883c74f>2.1. Federal Information Processing Standards 140 and FIPS mode</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_installing-the-system-with-fips-mode-enabled_switching-rhel-to-fips-mode" id="sub-link-to-security_hardening-proc_installing-the-system-with-fips-mode-enabled_switching-rhel-to-fips-mode" data-v-b883c74f>2.2. Installing the system with FIPS mode enabled</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies" data-v-b883c74f>2.3. Switching the system to FIPS mode</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#enabling-fips-mode-in-a-container_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-enabling-fips-mode-in-a-container_using-the-system-wide-cryptographic-policies" data-v-b883c74f>2.4. Enabling FIPS mode in a container</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_list-of-rhel-applications-using-cryptography-that-is-not-compliant-with-fips-140-3_switching-rhel-to-fips-mode" id="sub-link-to-security_hardening-ref_list-of-rhel-applications-using-cryptography-that-is-not-compliant-with-fips-140-3_switching-rhel-to-fips-mode" data-v-b883c74f>2.5. List of RHEL applications using cryptography that is not compliant with FIPS 140-3</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-the-system-wide-cryptographic-policies_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="using-the-system-wide-cryptographic-policies_security-hardening--summary" data-v-fa0dae77>3. Using system-wide cryptographic policies</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-the-system-wide-cryptographic-policies_security-hardening" id="chapter-landing--security_hardening-using-the-system-wide-cryptographic-policies_security-hardening" data-v-fa0dae77>Using system-wide cryptographic policies</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.1. System-wide cryptographic policies</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-the-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-changing-the-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.2. Changing the system-wide cryptographic policy</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#switching-the-system-wide-crypto-policy-to-mode-compatible-with-previous-systems_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-switching-the-system-wide-crypto-policy-to-mode-compatible-with-previous-systems_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.3. Switching the system-wide cryptographic policy to mode compatible with earlier releases</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_re-enabling-sha-1_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-proc_re-enabling-sha-1_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.4. Re-enabling SHA-1</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-up-system-wide-crypto-policies-in-the-web-console_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-setting-up-system-wide-crypto-policies-in-the-web-console_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.5. Setting up system-wide cryptographic policies in the web console</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" data-v-b883c74f><summary class="heading sub-chapter-title" id="excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies--summary" data-v-b883c74f>3.6. Excluding an application from following system-wide crypto policies</summary><ol id="sub-nav--excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" id="chapter-landing--security_hardening-excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" data-v-b883c74f>Excluding an application from following system-wide crypto policies</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#examples-of-opting-out-of-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-examples-of-opting-out-of-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.6.1. Examples of opting out of system-wide crypto policies</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#customizing-system-wide-cryptographic-policies-with-subpolicies_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-customizing-system-wide-cryptographic-policies-with-subpolicies_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.7. Customizing system-wide cryptographic policies with subpolicies</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.8. Creating and setting a custom system-wide cryptographic policy</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_using-the-system-wide-cryptographic-policies" id="sub-link-to-security_hardening-proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_using-the-system-wide-cryptographic-policies" data-v-b883c74f>3.9. Enhancing security with the FUTURE cryptographic policy using the crypto_policies RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening--summary" data-v-fa0dae77>4. Configuring applications to use cryptographic hardware through PKCS #11</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening" id="chapter-landing--security_hardening-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening" data-v-fa0dae77>Configuring applications to use cryptographic hardware through PKCS #11</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#cryptographic-hardware-support-through-pkcs-11_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" id="sub-link-to-security_hardening-cryptographic-hardware-support-through-pkcs-11_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" data-v-b883c74f>4.1. Cryptographic hardware support through PKCS #11</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ssh-keys-stored-on-a-smart-card_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" id="sub-link-to-security_hardening-using-ssh-keys-stored-on-a-smart-card_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" data-v-b883c74f>4.2. Authenticating by SSH keys stored on a smart card</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-applications-to-authenticate-using-certificates-from-smart-cards_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" id="sub-link-to-security_hardening-configuring-applications-to-authenticate-using-certificates-from-smart-cards_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" data-v-b883c74f>4.3. Configuring applications for authentication with certificates on smart cards</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_using-hsms-protecting-private-keys-in-apache_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" id="sub-link-to-security_hardening-ref_using-hsms-protecting-private-keys-in-apache_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" data-v-b883c74f>4.4. Using HSMs protecting private keys in Apache</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_using-hsms-protecting-private-keys-in-nginx_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" id="sub-link-to-security_hardening-ref_using-hsms-protecting-private-keys-in-nginx_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" data-v-b883c74f>4.5. Using HSMs protecting private keys in Nginx</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#related-information-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" id="sub-link-to-security_hardening-related-information-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11" data-v-b883c74f>4.6. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_controlling-access-to-smart-cards-using-polkit_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_controlling-access-to-smart-cards-using-polkit_security-hardening--summary" data-v-fa0dae77>5. Controlling access to smart cards by using polkit</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_controlling-access-to-smart-cards-using-polkit_security-hardening" id="chapter-landing--security_hardening-assembly_controlling-access-to-smart-cards-using-polkit_security-hardening" data-v-fa0dae77>Controlling access to smart cards by using polkit</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_smart-card-access-control-through-polkit_assembly_controlling-access-to-smart-cards-using-polkit" id="sub-link-to-security_hardening-con_smart-card-access-control-through-polkit_assembly_controlling-access-to-smart-cards-using-polkit" data-v-b883c74f>5.1. Smart-card access control through polkit</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_troubleshooting-problems-related-to-pc-sc-and-polkit_assembly_controlling-access-to-smart-cards-using-polkit" id="sub-link-to-security_hardening-ref_troubleshooting-problems-related-to-pc-sc-and-polkit_assembly_controlling-access-to-smart-cards-using-polkit" data-v-b883c74f>5.2. Troubleshooting problems related to PC/SC and polkit</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_displaying-more-detailed-information-about-polkit-authorization-to-pc-sc_assembly_controlling-access-to-smart-cards-using-polkit" id="sub-link-to-security_hardening-proc_displaying-more-detailed-information-about-polkit-authorization-to-pc-sc_assembly_controlling-access-to-smart-cards-using-polkit" data-v-b883c74f>5.3. Displaying more detailed information about polkit authorization to PC/SC</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources" id="sub-link-to-security_hardening-additional_resources" data-v-b883c74f>5.4. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening--summary" data-v-fa0dae77>6. Scanning the system for configuration compliance and vulnerabilities</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening" id="chapter-landing--security_hardening-scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening" data-v-fa0dae77>Scanning the system for configuration compliance and vulnerabilities</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.1. Configuration compliance tools in RHEL</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f><summary class="heading sub-chapter-title" id="vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities--summary" data-v-b883c74f>6.2. Vulnerability scanning</summary><ol id="sub-nav--vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="chapter-landing--security_hardening-vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>Vulnerability scanning</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#red-hat-security-advisories-oval-feed_vulnerability-scanning" id="sub-link-to-security_hardening-red-hat-security-advisories-oval-feed_vulnerability-scanning" data-v-b883c74f>6.2.1. Red Hat Security Advisories OVAL feed</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#scanning-the-system-for-vulnerabilities_vulnerability-scanning" id="sub-link-to-security_hardening-scanning-the-system-for-vulnerabilities_vulnerability-scanning" data-v-b883c74f>6.2.2. Scanning the system for vulnerabilities</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#scanning-remote-systems-for-vulnerabilities_vulnerability-scanning" id="sub-link-to-security_hardening-scanning-remote-systems-for-vulnerabilities_vulnerability-scanning" data-v-b883c74f>6.2.3. Scanning remote systems for vulnerabilities</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f><summary class="heading sub-chapter-title" id="configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities--summary" data-v-b883c74f>6.3. Configuration compliance scanning</summary><ol id="sub-nav--configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="chapter-landing--security_hardening-configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>Configuration compliance scanning</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuration-compliance-in-rhel-8_configuration-compliance-scanning" id="sub-link-to-security_hardening-configuration-compliance-in-rhel-8_configuration-compliance-scanning" data-v-b883c74f>6.3.1. Configuration compliance in RHEL</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#possible-results-of-an-openscap-scan_configuration-compliance-scanning" id="sub-link-to-security_hardening-possible-results-of-an-openscap-scan_configuration-compliance-scanning" data-v-b883c74f>6.3.2. Possible results of an OpenSCAP scan</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#viewing-profiles-for-configuration-compliance_configuration-compliance-scanning" id="sub-link-to-security_hardening-viewing-profiles-for-configuration-compliance_configuration-compliance-scanning" data-v-b883c74f>6.3.3. Viewing profiles for configuration compliance</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#assessing-configuration-compliance-with-a-specific-baseline_configuration-compliance-scanning" id="sub-link-to-security_hardening-assessing-configuration-compliance-with-a-specific-baseline_configuration-compliance-scanning" data-v-b883c74f>6.3.4. Assessing configuration compliance with a specific baseline</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#remediating-the-system-to-align-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-remediating-the-system-to-align-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.4. Remediating the system to align with a specific baseline</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#remediating-the-system-to-align-with-a-specific-baseline-using-the-ssg-ansible-playbook_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-remediating-the-system-to-align-with-a-specific-baseline-using-the-ssg-ansible-playbook_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.5. Remediating the system to align with a specific baseline using an SSG Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-remediation-ansible-playbook-to-align-the-system-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-creating-a-remediation-ansible-playbook-to-align-the-system-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.6. Creating a remediation Ansible playbook to align the system with a specific baseline</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-remediation-bash-script-for-a-later-application_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-creating-a-remediation-bash-script-for-a-later-application_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.7. Creating a remediation Bash script for a later application</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f><summary class="heading sub-chapter-title" id="scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities--summary" data-v-b883c74f>6.8. Scanning the system with a customized profile using SCAP Workbench</summary><ol id="sub-nav--scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="chapter-landing--security_hardening-scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>Scanning the system with a customized profile using SCAP Workbench</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-scap-workbench-to-scan-and-remediate-the-system_scanning-the-system-with-a-customized-profile-using-scap-workbench" id="sub-link-to-security_hardening-using-scap-workbench-to-scan-and-remediate-the-system_scanning-the-system-with-a-customized-profile-using-scap-workbench" data-v-b883c74f>6.8.1. Using SCAP Workbench to scan and remediate the system</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench" id="sub-link-to-security_hardening-customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench" data-v-b883c74f>6.8.2. Customizing a security profile with SCAP Workbench</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#related-information-scanning-the-system-with-a-customized-profile-using-scap-workbench" id="sub-link-to-security_hardening-related-information-scanning-the-system-with-a-customized-profile-using-scap-workbench" data-v-b883c74f>6.8.3. Additional resources</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f><summary class="heading sub-chapter-title" id="deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities--summary" data-v-b883c74f>6.9. Deploying systems that are compliant with a security profile immediately after an installation</summary><ol id="sub-nav--deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="chapter-landing--security_hardening-deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>Deploying systems that are compliant with a security profile immediately after an installation</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_profiles-not-compatible-with-server-with-gui_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation" id="sub-link-to-security_hardening-ref_profiles-not-compatible-with-server-with-gui_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation" data-v-b883c74f>6.9.1. Profiles not compatible with Server with GUI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-baseline-compliant-rhel-systems-using-the-graphical-installation_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation" id="sub-link-to-security_hardening-deploying-baseline-compliant-rhel-systems-using-the-graphical-installation_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation" data-v-b883c74f>6.9.2. Deploying baseline-compliant RHEL systems using the graphical installation</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-baseline-compliant-rhel-systems-using-kickstart_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation" id="sub-link-to-security_hardening-deploying-baseline-compliant-rhel-systems-using-kickstart_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation" data-v-b883c74f>6.9.3. Deploying baseline-compliant RHEL systems using Kickstart</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.10. Scanning container and container images for vulnerabilities</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#assessing-security-compliance-of-a-container-or-a-container-image-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-assessing-security-compliance-of-a-container-or-a-container-image-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.11. Assessing security compliance of a container or a container image with a specific baseline</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#scap-security-guide-profiles-supported-in-rhel-9_scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-scap-security-guide-profiles-supported-in-rhel-9_scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.12. SCAP Security Guide profiles supported in RHEL 9</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#related-information-scanning-the-system-for-configuration-compliance-and-vulnerabilities" id="sub-link-to-security_hardening-related-information-scanning-the-system-for-configuration-compliance-and-vulnerabilities" data-v-b883c74f>6.13. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_ensuring-system-integrity-with-keylime_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_ensuring-system-integrity-with-keylime_security-hardening--summary" data-v-fa0dae77>7. Ensuring system integrity with Keylime</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_ensuring-system-integrity-with-keylime_security-hardening" id="chapter-landing--security_hardening-assembly_ensuring-system-integrity-with-keylime_security-hardening" data-v-fa0dae77>Ensuring system integrity with Keylime</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.1. How Keylime works</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.2. Deploying Keylime verifier from a package</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-keylime-verifier-as-a-container_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-configuring-keylime-verifier-as-a-container_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.3. Deploying Keylime verifier as a container</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.4. Deploying Keylime registrar from a package</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-keylime-registrar-as-a-container_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-configuring-keylime-registrar-as-a-container_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.5. Deploying Keylime registrar as a container</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_setting-keylime-server-using-system-roles_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-proc_setting-keylime-server-using-system-roles_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.6. Deploying a Keylime server by using RHEL system roles</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_variables-for-keylime-server-system-role_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-ref_variables-for-keylime-server-system-role_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.7. Variables for the keylime_server RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.8. Deploying Keylime tenant from a package</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.9. Deploying Keylime agent from a package</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_deploying-keylime-for-runtime-monitoring_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-proc_deploying-keylime-for-runtime-monitoring_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.10. Configuring Keylime for runtime monitoring</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_deploying-keylime-for-measured-boot-attestation_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-proc_deploying-keylime-for-measured-boot-attestation_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.11. Configuring Keylime for measured boot attestation</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime" id="sub-link-to-security_hardening-keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime" data-v-b883c74f>7.12. Keylime environment variables</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--checking-integrity-with-aide_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="checking-integrity-with-aide_security-hardening--summary" data-v-fa0dae77>8. Checking integrity with AIDE</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#checking-integrity-with-aide_security-hardening" id="chapter-landing--security_hardening-checking-integrity-with-aide_security-hardening" data-v-fa0dae77>Checking integrity with AIDE</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-aide_checking-integrity-with-aide" id="sub-link-to-security_hardening-installing-aide_checking-integrity-with-aide" data-v-b883c74f>8.1. Installing AIDE</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#performing-integrity-checks-with-aide_checking-integrity-with-aide" id="sub-link-to-security_hardening-performing-integrity-checks-with-aide_checking-integrity-with-aide" data-v-b883c74f>8.2. Performing integrity checks with AIDE</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#updating-an-aide-database_checking-integrity-with-aide" id="sub-link-to-security_hardening-updating-an-aide-database_checking-integrity-with-aide" data-v-b883c74f>8.3. Updating an AIDE database</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#file-integrity-tools-aide-and-ima_checking-integrity-with-aide" id="sub-link-to-security_hardening-file-integrity-tools-aide-and-ima_checking-integrity-with-aide" data-v-b883c74f>8.4. File-integrity tools: AIDE and IMA</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#related-information-checking-integrity-with-aide" id="sub-link-to-security_hardening-related-information-checking-integrity-with-aide" data-v-b883c74f>8.5. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--encrypting-block-devices-using-luks_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="encrypting-block-devices-using-luks_security-hardening--summary" data-v-fa0dae77>9. Encrypting block devices using LUKS</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#encrypting-block-devices-using-luks_security-hardening" id="chapter-landing--security_hardening-encrypting-block-devices-using-luks_security-hardening" data-v-fa0dae77>Encrypting block devices using LUKS</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#luks-disk-encryption_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-luks-disk-encryption_encrypting-block-devices-using-luks" data-v-b883c74f>9.1. LUKS disk encryption</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#luks-versions-in-rhel_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-luks-versions-in-rhel_encrypting-block-devices-using-luks" data-v-b883c74f>9.2. LUKS versions in RHEL</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#options-for-data-protection-during-luks2-re-encryption_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-options-for-data-protection-during-luks2-re-encryption_encrypting-block-devices-using-luks" data-v-b883c74f>9.3. Options for data protection during LUKS2 re-encryption</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#encrypting-existing-data-on-a-block-device-using-luks2_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-encrypting-existing-data-on-a-block-device-using-luks2_encrypting-block-devices-using-luks" data-v-b883c74f>9.4. Encrypting existing data on a block device using LUKS2</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#encrypting-existing-data-on-a-block-device-using-luks2-with-a-detached-header_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-encrypting-existing-data-on-a-block-device-using-luks2-with-a-detached-header_encrypting-block-devices-using-luks" data-v-b883c74f>9.5. Encrypting existing data on a block device using LUKS2 with a detached header</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#encrypting-a-blank-block-device-using-luks2_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-encrypting-a-blank-block-device-using-luks2_encrypting-block-devices-using-luks" data-v-b883c74f>9.6. Encrypting a blank block device using LUKS2</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-configuring-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks" data-v-b883c74f>9.7. Configuring the LUKS passphrase in the web console</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-changing-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks" data-v-b883c74f>9.8. Changing the LUKS passphrase in the web console</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-luks2-encrypted-volume-using-the-storage-role_encrypting-block-devices-using-luks" id="sub-link-to-security_hardening-creating-a-luks2-encrypted-volume-using-the-storage-role_encrypting-block-devices-using-luks" data-v-b883c74f>9.9. Creating a LUKS2 encrypted volume by using the storage RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening--summary" data-v-fa0dae77>10. Configuring automated unlocking of encrypted volumes by using policy-based decryption</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening" id="chapter-landing--security_hardening-configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening" data-v-fa0dae77>Configuring automated unlocking of encrypted volumes by using policy-based decryption</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#network-bound-disk-encryption_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-network-bound-disk-encryption_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.1. Network-bound disk encryption</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.2. Deploying a Tang server with SELinux in enforcing mode</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#rotating-tang-keys_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-rotating-tang-keys_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.3. Rotating Tang server keys and updating bindings on clients</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-automated-unlocking-using-a-tang-key-in-the-web-console_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-configuring-automated-unlocking-using-a-tang-key-in-the-web-console_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.4. Configuring automated unlocking by using a Tang key in the web console</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#basic-nbde-and-tpm2-encryption-client-operations_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-basic-nbde-and-tpm2-encryption-client-operations_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.5. Basic NBDE and TPM2 encryption-client operations</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-nbde-clients-with-static-ip-configuration_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-configuring-nbde-clients-with-static-ip-configuration_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.7. Configuring NBDE clients with static IP configuration</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-manual-enrollment-of-volumes-using-tpm2_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-configuring-manual-enrollment-of-volumes-using-tpm2_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.8. Configuring manual enrollment of LUKS-encrypted volumes by using a TPM 2.0 policy</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#removing-a-clevis-pin-from-a-luks-encrypted-volume-manually_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-removing-a-clevis-pin-from-a-luks-encrypted-volume-manually_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.9. Removing a Clevis pin from a LUKS-encrypted volume manually</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.10. Configuring automated enrollment of LUKS-encrypted volumes by using Kickstart</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-automated-unlocking-of-a-luks-encrypted-removable-storage-device_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-configuring-automated-unlocking-of-a-luks-encrypted-removable-storage-device_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.11. Configuring automated unlocking of a LUKS-encrypted removable storage device</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-high-availability-nbde-systems_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-deploying-high-availability-nbde-systems_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.12. Deploying high-availability NBDE systems</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deployment-of-virtual-machines-in-a-nbde-network_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-deployment-of-virtual-machines-in-a-nbde-network_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.13. Deployment of virtual machines in a NBDE network</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#building-automatically-enrollable-vm-images-for-cloud-environments_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-building-automatically-enrollable-vm-images-for-cloud-environments_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.14. Building automatically-enrollable VM images for cloud environments by using NBDE</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_deploying-tang-as-a-container_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="sub-link-to-security_hardening-proc_deploying-tang-as-a-container_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>10.15. Deploying Tang as a container</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f><summary class="heading sub-chapter-title" id="configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption--summary" data-v-b883c74f>10.16. Configuring NBDE by using RHEL system roles</summary><ol id="sub-nav--configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" id="chapter-landing--security_hardening-configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" data-v-b883c74f>Configuring NBDE by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles" id="sub-link-to-security_hardening-using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles" data-v-b883c74f>10.16.1. Using the nbde_server RHEL system role for setting up multiple Tang servers</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles" id="sub-link-to-security_hardening-using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles" data-v-b883c74f>10.16.2. Setting up Clevis clients with DHCP by using the nbde_client RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles" id="sub-link-to-security_hardening-setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles" data-v-b883c74f>10.16.3. Setting up static-IP Clevis clients by using the nbde_client RHEL system role</a></li><!--]--><!--]--></ol></details></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--auditing-the-system_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="auditing-the-system_security-hardening--summary" data-v-fa0dae77>11. Auditing the system</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#auditing-the-system_security-hardening" id="chapter-landing--security_hardening-auditing-the-system_security-hardening" data-v-fa0dae77>Auditing the system</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#linux-audit_auditing-the-system" id="sub-link-to-security_hardening-linux-audit_auditing-the-system" data-v-b883c74f>11.1. Linux Audit</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#audit-system-architecture_auditing-the-system" id="sub-link-to-security_hardening-audit-system-architecture_auditing-the-system" data-v-b883c74f>11.2. Audit system architecture</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-auditd-for-a-secure-environment_auditing-the-system" id="sub-link-to-security_hardening-configuring-auditd-for-a-secure-environment_auditing-the-system" data-v-b883c74f>11.3. Configuring auditd for a secure environment</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#starting-the-audit-service_auditing-the-system" id="sub-link-to-security_hardening-starting-the-audit-service_auditing-the-system" data-v-b883c74f>11.4. Starting and controlling auditd</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#understanding-audit-log-files_auditing-the-system" id="sub-link-to-security_hardening-understanding-audit-log-files_auditing-the-system" data-v-b883c74f>11.5. Understanding Audit log files</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-auditctl-for-defining-and-executing-audit-rules_auditing-the-system" id="sub-link-to-security_hardening-using-auditctl-for-defining-and-executing-audit-rules_auditing-the-system" data-v-b883c74f>11.6. Using auditctl for defining and executing Audit rules</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#defining-persistent-audit-rules_auditing-the-system" id="sub-link-to-security_hardening-defining-persistent-audit-rules_auditing-the-system" data-v-b883c74f>11.7. Defining persistent Audit rules</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#pre-configured-audit-rules-files-for-compliance-with-standards_auditing-the-system" id="sub-link-to-security_hardening-pre-configured-audit-rules-files-for-compliance-with-standards_auditing-the-system" data-v-b883c74f>11.8. Pre-configured Audit rules files for compliance with standards</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-augenrules-to-define-persistent-rules_auditing-the-system" id="sub-link-to-security_hardening-using-augenrules-to-define-persistent-rules_auditing-the-system" data-v-b883c74f>11.9. Using augenrules to define persistent rules</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#disabling-augenrules_auditing-the-system" id="sub-link-to-security_hardening-disabling-augenrules_auditing-the-system" data-v-b883c74f>11.10. Disabling augenrules</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_setting-up-audit-to-monitor-software-updates_auditing-the-system" id="sub-link-to-security_hardening-proc_setting-up-audit-to-monitor-software-updates_auditing-the-system" data-v-b883c74f>11.11. Setting up Audit to monitor software updates</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_monitoring-user-login-times-with-audit_auditing-the-system" id="sub-link-to-security_hardening-proc_monitoring-user-login-times-with-audit_auditing-the-system" data-v-b883c74f>11.12. Monitoring user login times with Audit</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#related-information-auditing-the-system" id="sub-link-to-security_hardening-related-information-auditing-the-system" data-v-b883c74f>11.13. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening--summary" data-v-fa0dae77>12. Blocking and allowing applications by using fapolicyd</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening" id="chapter-landing--security_hardening-assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening" data-v-fa0dae77>Blocking and allowing applications by using fapolicyd</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#introduction-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" id="sub-link-to-security_hardening-introduction-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" data-v-b883c74f>12.1. Introduction to fapolicyd</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_deploying-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" id="sub-link-to-security_hardening-proc_deploying-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" data-v-b883c74f>12.2. Deploying fapolicyd</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#marking-files-as-trusted-using-an-additional-source-of-trust_assembly_blocking-and-allowing-applications-using-fapolicyd" id="sub-link-to-security_hardening-marking-files-as-trusted-using-an-additional-source-of-trust_assembly_blocking-and-allowing-applications-using-fapolicyd" data-v-b883c74f>12.3. Marking files as trusted using an additional source of trust</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_adding-custom-allow-and-deny-rules-for-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" id="sub-link-to-security_hardening-proc_adding-custom-allow-and-deny-rules-for-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" data-v-b883c74f>12.4. Adding custom allow and deny rules for fapolicyd</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_enabling-fapolicyd-integrity-checks_assembly_blocking-and-allowing-applications-using-fapolicyd" id="sub-link-to-security_hardening-proc_enabling-fapolicyd-integrity-checks_assembly_blocking-and-allowing-applications-using-fapolicyd" data-v-b883c74f>12.5. Enabling fapolicyd integrity checks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_troubleshooting-problems-related-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" id="sub-link-to-security_hardening-ref_troubleshooting-problems-related-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" data-v-b883c74f>12.6. Troubleshooting problems related to fapolicyd</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_assembly_blocking-and-allowing-applications-using-fapolicyd" id="sub-link-to-security_hardening-preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_assembly_blocking-and-allowing-applications-using-fapolicyd" data-v-b883c74f>12.7. Preventing users from executing untrustworthy code by using the fapolicyd RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_2" id="sub-link-to-security_hardening-additional_resources_2" data-v-b883c74f>12.8. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--protecting-systems-against-intrusive-usb-devices_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="protecting-systems-against-intrusive-usb-devices_security-hardening--summary" data-v-fa0dae77>13. Protecting systems against intrusive USB devices</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#protecting-systems-against-intrusive-usb-devices_security-hardening" id="chapter-landing--security_hardening-protecting-systems-against-intrusive-usb-devices_security-hardening" data-v-fa0dae77>Protecting systems against intrusive USB devices</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#usbguard_protecting-systems-against-intrusive-usb-devices" id="sub-link-to-security_hardening-usbguard_protecting-systems-against-intrusive-usb-devices" data-v-b883c74f>13.1. USBGuard</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-usbguard_protecting-systems-against-intrusive-usb-devices" id="sub-link-to-security_hardening-installing-usbguard_protecting-systems-against-intrusive-usb-devices" data-v-b883c74f>13.2. Installing USBGuard</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#blocking-and-authorizing-a-usb-device-using-cli_protecting-systems-against-intrusive-usb-devices" id="sub-link-to-security_hardening-blocking-and-authorizing-a-usb-device-using-cli_protecting-systems-against-intrusive-usb-devices" data-v-b883c74f>13.3. Blocking and authorizing a USB device by using CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#permanently-blocking-and-authorizing-a-usb-device_protecting-systems-against-intrusive-usb-devices" id="sub-link-to-security_hardening-permanently-blocking-and-authorizing-a-usb-device_protecting-systems-against-intrusive-usb-devices" data-v-b883c74f>13.4. Permanently blocking and authorizing a USB device</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices" id="sub-link-to-security_hardening-creating-a-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices" data-v-b883c74f>13.5. Creating a custom policy for USB devices</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-structured-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices" id="sub-link-to-security_hardening-creating-a-structured-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices" data-v-b883c74f>13.6. Creating a structured custom policy for USB devices</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#authorizing-users-and-groups-to-use-the-usbguard-ipc-interface_protecting-systems-against-intrusive-usb-devices" id="sub-link-to-security_hardening-authorizing-users-and-groups-to-use-the-usbguard-ipc-interface_protecting-systems-against-intrusive-usb-devices" data-v-b883c74f>13.7. Authorizing users and groups to use the USBGuard IPC interface</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#logging-usbguard-authorization-events-to-the-linux-audit-log_protecting-systems-against-intrusive-usb-devices" id="sub-link-to-security_hardening-logging-usbguard-authorization-events-to-the-linux-audit-log_protecting-systems-against-intrusive-usb-devices" data-v-b883c74f>13.8. Logging USBguard authorization events to the Linux Audit log</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_3" id="sub-link-to-security_hardening-additional_resources_3" data-v-b883c74f>13.9. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_configuring-a-remote-logging-solution_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_configuring-a-remote-logging-solution_security-hardening--summary" data-v-fa0dae77>14. Configuring a remote logging solution</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_configuring-a-remote-logging-solution_security-hardening" id="chapter-landing--security_hardening-assembly_configuring-a-remote-logging-solution_security-hardening" data-v-fa0dae77>Configuring a remote logging solution</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#the-rsyslog-logging-service_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-the-rsyslog-logging-service_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.1. The Rsyslog logging service</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-rsyslog-documentation_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-installing-rsyslog-documentation_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.2. Installing Rsyslog documentation</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-server-for-remote-logging-over-tcp_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-configuring-a-server-for-remote-logging-over-tcp_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.3. Configuring a server for remote logging over TCP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-remote-logging-to-a-server-over-tcp_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-configuring-remote-logging-to-a-server-over-tcp_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.4. Configuring remote logging to a server over TCP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-tls-encrypted-remote-logging_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-proc_configuring-tls-encrypted-remote-logging_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.5. Configuring TLS-encrypted remote logging</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-server-for-receiving-remote-logging-information-over-udp_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-configuring-a-server-for-receiving-remote-logging-information-over-udp_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.6. Configuring a server for receiving remote logging information over UDP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-remote-logging-to-a-server-over-udp_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-configuring-remote-logging-to-a-server-over-udp_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.7. Configuring remote logging to a server over UDP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_load-balancing-helper-in-rsyslog_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-con_load-balancing-helper-in-rsyslog_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.8. Load balancing helper in Rsyslog</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-reliable-remote-logging_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-configuring-reliable-remote-logging_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.9. Configuring reliable remote logging</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#supported-rsyslog-modules_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-supported-rsyslog-modules_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.10. Supported Rsyslog modules</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-netconsole-service-to-log-kernel-messages-to-a-remote-host_assembly_configuring-a-remote-logging-solution" id="sub-link-to-security_hardening-configuring-the-netconsole-service-to-log-kernel-messages-to-a-remote-host_assembly_configuring-a-remote-logging-solution" data-v-b883c74f>14.11. Configuring the netconsole service to log kernel messages to a remote host</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_4" id="sub-link-to-security_hardening-additional_resources_4" data-v-b883c74f>14.12. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_using-the-logging-system-role_security-hardening" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_using-the-logging-system-role_security-hardening--summary" data-v-fa0dae77>15. Using the logging system role</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-the-logging-system-role_security-hardening" id="chapter-landing--security_hardening-assembly_using-the-logging-system-role_security-hardening" data-v-fa0dae77>Using the logging system role</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_filtering-logs-in-a-local-logging-system-role_assembly_using-the-logging-system-role" id="sub-link-to-security_hardening-proc_filtering-logs-in-a-local-logging-system-role_assembly_using-the-logging-system-role" data-v-b883c74f>15.1. Filtering local log messages by using the logging RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#applying-a-remote-logging-solution-using-the-logging-system-role_assembly_using-the-logging-system-role" id="sub-link-to-security_hardening-applying-a-remote-logging-solution-using-the-logging-system-role_assembly_using-the-logging-system-role" data-v-b883c74f>15.2. Applying a remote logging solution by using the logging RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role" data-v-b883c74f><summary class="heading sub-chapter-title" id="assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role--summary" data-v-b883c74f>15.3. Using the logging RHEL system role with TLS</summary><ol id="sub-nav--assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role" id="chapter-landing--security_hardening-assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role" data-v-b883c74f>Using the logging RHEL system role with TLS</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls" id="sub-link-to-security_hardening-configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls" data-v-b883c74f>15.3.1. Configuring client logging with TLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls" id="sub-link-to-security_hardening-configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls" data-v-b883c74f>15.3.2. Configuring server logging with TLS</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--assembly_using-the-logging-system-roles-with-relp" data-v-b883c74f><summary class="heading sub-chapter-title" id="assembly_using-the-logging-system-roles-with-relp--summary" data-v-b883c74f>15.4. Using the logging RHEL system roles with RELP</summary><ol id="sub-nav--assembly_using-the-logging-system-roles-with-relp" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-the-logging-system-roles-with-relp" id="chapter-landing--security_hardening-assembly_using-the-logging-system-roles-with-relp" data-v-b883c74f>Using the logging RHEL system roles with RELP</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" id="sub-link-to-security_hardening-configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" data-v-b883c74f>15.4.1. Configuring client logging with RELP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" id="sub-link-to-security_hardening-configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" data-v-b883c74f>15.4.2. Configuring server logging with RELP</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_5" id="sub-link-to-security_hardening-additional_resources_5" data-v-b883c74f>15.5. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#idm140081355003760" id="chapter-landing--security_hardening-idm140081355003760" data-v-fa0dae77>Legal Notice</a></li><!--]--></ol></nav><!----></div></div></aside><article class="content span-xs-12 span-sm-6 span-md-12 span-lg-7" aria-live="polite" data-v-8589d091><!----><div lang="en-us" xml:lang="en-us" class="docs-content-container" data-v-8589d091><!----><!----><h1 data-id="content_chapter" class="chapter-title" data-v-8589d091>Security hardening</h1><hr class="line-below-chp" data-v-8589d091><section class="rhdocs" data-v-8589d091><body><div xml:lang="en-US" class="book" id="idm140081374029808"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">9</span></div><div><h3 class="subtitle">Enhancing security of Red Hat Enterprise Linux 9 systems</h3></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="#idm140081355003760">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				Learn the processes and practices for securing Red Hat Enterprise Linux servers and workstations against local and remote intrusion, exploitation, and malicious activity. By using these approaches and tools, you can create a more secure computing environment for the data center, workplace, and home.
			</div></div></div></div><hr></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_security-hardening"><div class="titlepage"><div><div><h2 class="title">Providing feedback on Red Hat documentation</h2></div></div></div><p class="_abstract _abstract">
			We appreciate your feedback on our documentation. Let us know how we can improve it.
		</p><div class="orderedlist"><p class="title"><strong>Submitting feedback through Jira (account required)</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in to the <a class="link" href="https://issues.redhat.com/projects/RHELDOCS/issues">Jira</a> website.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> in the top navigation bar
				</li><li class="listitem">
					Enter a descriptive title in the <span class="strong strong"><strong>Summary</strong></span> field.
				</li><li class="listitem">
					Enter your suggestion for improvement in the <span class="strong strong"><strong>Description</strong></span> field. Include links to the relevant parts of the documentation.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> at the bottom of the dialogue.
				</li></ol></div></section><section class="chapter" id="assembly_securing-rhel-during-installation-security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Securing RHEL during and right after installation</h2></div></div></div><p class="_abstract _abstract">
			Security begins even before you start the installation of Red Hat Enterprise Linux. Configuring your system securely from the beginning makes it easier to implement additional security settings later.
		</p><section class="section" id="Disk_partitioning_securing-rhel-during-installation"><div class="titlepage"><div><div><h3 class="title">1.1. Disk partitioning</h3></div></div></div><p>
				The recommended practices for disk partitioning differ for installations on bare-metal machines and for virtualized or cloud environments that support adjusting virtual disk hardware and file systems containing already-installed operating systems.
			</p><p>
				To ensure separation and protection of data on <span class="strong strong"><strong>bare-metal installations</strong></span>, create separate partitions for the <code class="literal">/boot</code>, <code class="literal">/</code>, <code class="literal">/home</code>, <code class="literal">/tmp</code>, and <code class="literal">/var/tmp/</code> directories:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">/boot</code></span></dt><dd>
							This partition is the first partition that is read by the system during boot up. The boot loader and kernel images that are used to boot your system into Red Hat Enterprise Linux 9 are stored in this partition. This partition should not be encrypted. If this partition is included in <code class="literal">/</code> and that partition is encrypted or otherwise becomes unavailable then your system is not able to boot.
						</dd><dt><span class="term"><code class="literal">/home</code></span></dt><dd>
							When user data (<code class="literal">/home</code>) is stored in <code class="literal">/</code> instead of in a separate partition, the partition can fill up causing the operating system to become unstable. Also, when upgrading your system to the next version of Red Hat Enterprise Linux 9 it is a lot easier when you can keep your data in the <code class="literal">/home</code> partition as it is not be overwritten during installation. If the root partition (<code class="literal">/</code>) becomes corrupt your data could be lost forever. By using a separate partition there is slightly more protection against data loss. You can also target this partition for frequent backups.
						</dd><dt><span class="term"><code class="literal">/tmp</code> and <code class="literal">/var/tmp/</code></span></dt><dd>
							Both the <code class="literal">/tmp</code> and <code class="literal">/var/tmp/</code> directories are used to store data that does not need to be stored for a long period of time. However, if a lot of data floods one of these directories it can consume all of your storage space. If this happens and these directories are stored within <code class="literal">/</code> then your system could become unstable and crash. For this reason, moving these directories into their own partitions is a good idea.
						</dd></dl></div><p>
				For <span class="strong strong"><strong>virtual machines or cloud instances</strong></span>, the separate <code class="literal">/boot</code>, <code class="literal">/home</code>, <code class="literal">/tmp</code>, and <code class="literal">/var/tmp</code> partitions are optional because you can increase the virtual disk size and the <code class="literal">/</code> partition if it begins to fill up. Set up monitoring to regularly check the <code class="literal">/</code> partition usage so that it does not fill up before you increase the virtual disk size accordingly.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					During the installation process, you have an option to encrypt partitions. You must supply a passphrase. This passphrase serves as a key to unlock the bulk encryption key, which is used to secure the partition’s data.
				</p></div></rh-alert></section><section class="section" id="Restricting_network_during_installation_securing-rhel-during-installation"><div class="titlepage"><div><div><h3 class="title">1.2. Restricting network connectivity during the installation process</h3></div></div></div><p class="_abstract _abstract">
				When installing Red Hat Enterprise Linux 9, the installation medium represents a snapshot of the system at a particular time. Because of this, it may not be up-to-date with the latest security fixes and may be vulnerable to certain issues that were fixed only after the system provided by the installation medium was released.
			</p><p>
				When installing a potentially vulnerable operating system, always limit exposure only to the closest necessary network zone. The safest choice is the “no network” zone, which means to leave your machine disconnected during the installation process. In some cases, a LAN or intranet connection is sufficient while the Internet connection is the riskiest. To follow the best security practices, choose the closest zone with your repository while installing Red Hat Enterprise Linux 9 from a network.
			</p></section><section class="section" id="Minimal_install_securing-rhel-during-installation"><div class="titlepage"><div><div><h3 class="title">1.3. Installing the minimum amount of packages required</h3></div></div></div><p class="_abstract _abstract">
				It is best practice to install only the packages you will use because each piece of software on your computer could possibly contain a vulnerability. If you are installing from the DVD media, take the opportunity to select exactly what packages you want to install during the installation. If you find you need another package, you can always add it to the system later.
			</p></section><section class="section" id="Post-installation_procedures_securing-rhel-during-installation"><div class="titlepage"><div><div><h3 class="title">1.4. Post-installation procedures</h3></div></div></div><p class="_abstract _abstract">
				The following steps are the security-related procedures that should be performed immediately after installation of Red Hat Enterprise Linux 9.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Update your system. Enter the following command as root:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf update</strong></span></pre></li><li class="listitem"><p class="simpara">
						Even though the firewall service, <code class="literal">firewalld</code>, is automatically enabled with the installation of Red Hat Enterprise Linux, it might be explicitly disabled, for example, in the Kickstart configuration. In such a case, re-enable the firewall.
					</p><p class="simpara">
						To start <code class="literal">firewalld</code> enter the following commands as root:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start firewalld</strong></span>
# <span class="strong strong"><strong>systemctl enable firewalld</strong></span></pre></li><li class="listitem"><p class="simpara">
						To enhance security, disable services you do not need. For example, if no printers are installed on your computer, disable the <code class="literal command">cups</code> service by using the following command:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl disable cups</strong></span></pre><p class="simpara">
						To review active services, enter the following command:
					</p><pre class="screen">$ <span class="strong strong"><strong>systemctl list-units | grep service</strong></span></pre></li></ul></div></section><section class="section" id="disabling-simultaneous-multithreading-to-prevent-cpu-security-issues_configuring-system-settings-in-the-web-console"><div class="titlepage"><div><div><h3 class="title">1.5. Disabling SMT to prevent CPU security issues by using the web console</h3></div></div></div><p class="_abstract _abstract">
				Disable Simultaneous Multi Threading (SMT) in case of attacks that misuse CPU SMT. Disabling SMT can mitigate security vulnerabilities, such as L1TF or MDS.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Disabling SMT might lower the system performance.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have installed the RHEL 9 web console.
					</p><p class="simpara">
						For instructions, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console">Installing and enabling the web console</a>.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the RHEL 9 web console.
					</p><p class="simpara">
						For details, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console">Logging in to the web console</a>.
					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>Overview</strong></span> tab find the <span class="strong strong"><strong>System information</strong></span> field and click <span class="strong strong"><strong>View hardware details</strong></span>.
					</li><li class="listitem"><p class="simpara">
						On the <span class="strong strong"><strong>CPU Security</strong></span> line, click <span class="strong strong"><strong>Mitigations</strong></span>.
					</p><p class="simpara">
						If this link is not present, it means that your system does not support SMT, and therefore is not vulnerable.
					</p></li><li class="listitem">
						In the <span class="strong strong"><strong>CPU Security Toggles</strong></span> table, turn on the <span class="strong strong"><strong>Disable simultaneous multithreading (nosmt)</strong></span> option.
					</li><li class="listitem">
						Click the <span class="guibutton">Save and reboot</span> button.
					</li></ol></div><p>
				After the system restart, the CPU no longer uses SMT.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/security/vulnerabilities/L1TF">L1TF - L1 Terminal Fault Attack - CVE-2018-3620 &amp; CVE-2018-3646</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/security/vulnerabilities/mds">MDS - Microarchitectural Data Sampling - CVE-2018-12130, CVE-2018-12126, CVE-2018-12127, and CVE-2019-11091</a>
					</li></ul></div></section></section><section class="chapter" id="switching-rhel-to-fips-mode_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Switching RHEL to FIPS mode</h2></div></div></div><p id="assembly_installing-the-system-in-fips-mode_security-hardening">
			To enable the cryptographic module self-checks mandated by the Federal Information Processing Standard (FIPS) 140-3, you must operate RHEL 9 in FIPS mode. Starting the installation in FIPS mode is the recommended method if you aim for FIPS compliance.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				The cryptographic modules of RHEL 9 are not yet certified for the FIPS 140-3 requirements.
			</p></div></rh-alert><section class="section" id="federal-information-processing-standards-140-and-fips-mode_switching-rhel-to-fips-mode"><div class="titlepage"><div><div><h3 class="title">2.1. Federal Information Processing Standards 140 and FIPS mode</h3></div></div></div><p>
				The Federal Information Processing Standards (FIPS) Publication 140 is a series of computer security standards developed by the National Institute of Standards and Technology (NIST) to ensure the quality of cryptographic modules. The FIPS 140 standard ensures that cryptographic tools implement their algorithms correctly. Runtime cryptographic algorithm and integrity self-tests are some of the mechanisms to ensure a system uses cryptography that meets the requirements of the standard.
			</p><p>
				To ensure that your RHEL system generates and uses all cryptographic keys only with FIPS-approved algorithms, you must switch RHEL to FIPS mode.
			</p><p>
				You can enable FIPS mode by using one of the following methods:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Starting the installation in FIPS mode
					</li><li class="listitem">
						Switching the system into FIPS mode after the installation
					</li></ul></div><p>
				If you aim for FIPS compliance, start the installation in FIPS mode. This avoids cryptographic key material regeneration and reevaluation of the compliance of the resulting system associated with converting already deployed systems.
			</p><p>
				To operate a FIPS-compliant system, create all cryptographic key material in FIPS mode. Furthermore, the cryptographic key material must never leave the FIPS environment unless it is securely wrapped and never unwrapped in non-FIPS environments.
			</p><p>
				Switching the system to FIPS mode by using the <code class="literal">fips-mode-setup</code> tool does not guarantee compliance with the FIPS 140 standard. Re-generating all cryptographic keys after setting the system to FIPS mode may not be possible. For example, in the case of an existing IdM realm with users' cryptographic keys you cannot re-generate all the keys. If you cannot start the installation in FIPS mode, always enable FIPS mode as the first step after the installation, before you make any post-installation configuration steps or install any workloads.
			</p><p>
				The <code class="literal">fips-mode-setup</code> tool also uses the <code class="literal">FIPS</code> system-wide cryptographic policy internally. But on top of what the <code class="literal">update-crypto-policies --set FIPS</code> command does, <code class="literal">fips-mode-setup</code> ensures the installation of the FIPS dracut module by using the <code class="literal">fips-finish-install</code> tool, it also adds the <code class="literal">fips=1</code> boot option to the kernel command line and regenerates the initial RAM disk.
			</p><p>
				Furthermore, enforcement of restrictions required in FIPS mode depends on the contents of the <code class="literal">/proc/sys/crypto/fips_enabled</code> file. If the file contains <code class="literal">1</code>, RHEL core cryptographic components switch to mode, in which they use only FIPS-approved implementations of cryptographic algorithms. If <code class="literal">/proc/sys/crypto/fips_enabled</code> contains <code class="literal">0</code>, the cryptographic components do not enable their FIPS mode.
			</p><p>
				The <code class="literal">FIPS</code> system-wide cryptographic policy helps to configure higher-level restrictions. Therefore, communication protocols supporting cryptographic agility do not announce ciphers that the system refuses when selected. For example, the ChaCha20 algorithm is not FIPS-approved, and the <code class="literal">FIPS</code> cryptographic policy ensures that TLS servers and clients do not announce the TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 TLS cipher suite, because any attempt to use such a cipher fails.
			</p><p>
				If you operate RHEL in FIPS mode and use an application providing its own FIPS-mode-related configuration options, ignore these options and the corresponding application guidance. The system running in FIPS mode and the system-wide cryptographic policies enforce only FIPS-compliant cryptography. For example, the Node.js configuration option <code class="literal">--enable-fips</code> is ignored if the system runs in FIPS mode. If you use the <code class="literal">--enable-fips</code> option on a system not running in FIPS mode, you do not meet the FIPS-140 compliance requirements.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The cryptographic modules of RHEL 9 are not yet certified for the FIPS 140-3 requirements by the National Institute of Standards and Technology (NIST) Cryptographic Module Validation Program (CMVP). You can see the validation status of cryptographic modules <a class="link" href="https://access.redhat.com/articles/2918071#fips-140-2-and-fips-140-3-2">FIPS 140-2 and FIPS 140-3</a> section in the <a class="link" href="https://access.redhat.com/articles/2918071">Compliance Activities and Government Standards</a> Knowledgebase article.
				</p></div></rh-alert><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					A RHEL 9.2 and later system running in FIPS mode enforces that any TLS 1.2 connection must use the Extended Master Secret (EMS) extension (RFC 7627) as requires the FIPS 140-3 standard. Thus, legacy clients not supporting EMS or TLS 1.3 cannot connect to RHEL 9 servers running in FIPS mode, RHEL 9 clients in FIPS mode cannot connect to servers that support only TLS 1.2 without EMS. See the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS Extension "Extended Master Secret" enforced with Red Hat Enterprise Linux 9.2</a> solution article.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/2918071#fips-140-2-and-fips-140-3-2">FIPS 140-2 and FIPS 140-3</a> section in the <a class="link" href="https://access.redhat.com/articles/2918071">Compliance Activities and Government Standards</a> Knowledgebase article.
					</li><li class="listitem">
						<a class="link" href="#using-the-system-wide-cryptographic-policies_security-hardening" title="Chapter 3. Using system-wide cryptographic policies">RHEL system-wide cryptographic policies</a>
					</li><li class="listitem">
						<a class="link" href="https://csrc.nist.gov/publications/fips">FIPS publications at NIST Computer Security Resource Center</a>.
					</li><li class="listitem">
						<a class="link" href="https://doi.org/10.6028/NIST.FIPS.140-3">Federal Information Processing Standards Publication: FIPS 140-3</a>
					</li></ul></div></section><section class="section" id="proc_installing-the-system-with-fips-mode-enabled_switching-rhel-to-fips-mode"><div class="titlepage"><div><div><h3 class="title">2.2. Installing the system with FIPS mode enabled</h3></div></div></div><p id="proc_installing-the-system-with-fips-mode-enabled_assembly_installing-the-system-in-fips-mode">
				To enable the cryptographic module self-checks mandated by the Federal Information Processing Standard (FIPS) 140, enable FIPS mode during the system installation.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Only enabling FIPS mode during the RHEL installation ensures that the system generates all keys with FIPS-approved algorithms and continuous monitoring tests in place.
				</p></div></rh-alert><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					After you complete the setup of FIPS mode, you cannot switch off FIPS mode without putting the system into an inconsistent state. If your scenario requires this change, the only correct way is a complete re-installation of the system.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Add the <code class="literal">fips=1</code> option to the kernel command line during the system installation.
					</li><li class="listitem">
						During the software selection stage, do not install any third-party software.
					</li><li class="listitem">
						After the installation, the system starts in FIPS mode automatically.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						After the system starts, check that FIPS mode is enabled:
					</p><pre class="screen">$ <span class="strong strong"><strong>fips-mode-setup --check</strong></span>
FIPS mode is enabled.</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/boot_options_for_rhel_installer/kickstart-and-advanced-boot-options_boot-options-for-rhel-installer#proc_editing-the-boot-prompt-in-bios_assembly_editing-boot-options">Editing boot options</a>
					</li></ul></div></section><section class="section" id="switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">2.3. Switching the system to FIPS mode</h3></div></div></div><p>
				The system-wide cryptographic policies contain a policy level that enables cryptographic algorithms in accordance with the requirements by the Federal Information Processing Standard (FIPS) Publication 140. The <code class="literal">fips-mode-setup</code> tool that enables or disables FIPS mode internally uses the <code class="literal">FIPS</code> system-wide cryptographic policy.
			</p><p>
				Switching the system to FIPS mode by using the <code class="literal">FIPS</code> system-wide cryptographic policy does not guarantee compliance with the FIPS 140 standard. Re-generating all cryptographic keys after setting the system to FIPS mode may not be possible. For example, in the case of an existing IdM realm with users' cryptographic keys you cannot re-generate all the keys.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Only enabling <a class="link" href="#proc_installing-the-system-with-fips-mode-enabled_assembly_installing-the-system-in-fips-mode">FIPS mode during the RHEL installation</a> ensures that the system generates all keys with FIPS-approved algorithms and continuous monitoring tests in place.
				</p></div></rh-alert><p>
				The <code class="literal">fips-mode-setup</code> tool uses the <code class="literal">FIPS</code> policy internally. But on top of what the <code class="literal">update-crypto-policies</code> command with the <code class="literal">--set FIPS</code> option does, <code class="literal">fips-mode-setup</code> ensures the installation of the FIPS dracut module by using the <code class="literal">fips-finish-install</code> tool, it also adds the <code class="literal">fips=1</code> boot option to the kernel command line and regenerates the initial RAM disk.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					After you complete the setup of FIPS mode, you cannot switch off FIPS mode without putting the system into an inconsistent state. If your scenario requires this change, the only correct way is a complete re-installation of the system.
				</p></div></rh-alert><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The cryptographic modules of RHEL 9 are not yet certified for the FIPS 140-3 requirements.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To switch the system to FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>fips-mode-setup --enable</strong></span>
Kernel initramdisks are being regenerated. This might take some time.
Setting system policy to FIPS
Note: System-wide crypto policies are applied on application start-up.
It is recommended to restart the system for the change of policies
to fully take place.
FIPS mode will be enabled.
Please reboot the system for the setting to take effect.</pre></li><li class="listitem"><p class="simpara">
						Restart your system to allow the kernel to switch to FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						After the restart, you can check the current state of FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>fips-mode-setup --check</strong></span>
FIPS mode is enabled.</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">fips-mode-setup(8)</code> man page on your system
					</li><li class="listitem">
						<a class="link" href="https://csrc.nist.gov/publications/detail/fips/140/3/final">Security Requirements for Cryptographic Modules</a> on the National Institute of Standards and Technology (NIST) web site.
					</li></ul></div></section><section class="section" id="enabling-fips-mode-in-a-container_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">2.4. Enabling FIPS mode in a container</h3></div></div></div><p>
				To enable the full set of cryptographic module self-checks mandated by the Federal Information Processing Standard Publication 140-2 (FIPS mode), the host system kernel must be running in FIPS mode. The <code class="literal">podman</code> utility automatically enables FIPS mode on supported containers.
			</p><p>
				The <code class="literal">fips-mode-setup</code> command does not work correctly in containers, and it cannot be used to enable or check FIPS mode in this scenario.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The cryptographic modules of RHEL 9 are not yet certified for the FIPS 140-3 requirements.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The host system must be in FIPS mode.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						On systems with FIPS mode enabled, the <code class="literal">podman</code> utility automatically enables FIPS mode on supported containers.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies" title="2.3. Switching the system to FIPS mode">Switching the system to FIPS mode</a>.
					</li><li class="listitem">
						<a class="link" href="#proc_installing-the-system-with-fips-mode-enabled_assembly_installing-the-system-in-fips-mode">Installing the system in FIPS mode</a>
					</li></ul></div></section><section class="section" id="ref_list-of-rhel-applications-using-cryptography-that-is-not-compliant-with-fips-140-3_switching-rhel-to-fips-mode"><div class="titlepage"><div><div><h3 class="title">2.5. List of RHEL applications using cryptography that is not compliant with FIPS 140-3</h3></div></div></div><p>
				To pass all relevant cryptographic certifications, such as FIPS 140-3, use libraries from the core cryptographic components set. These libraries, except from <code class="literal">libgcrypt</code>, also follow the RHEL system-wide cryptographic policies.
			</p><p>
				See the <a class="link" href="https://access.redhat.com/articles/3655361">RHEL core cryptographic components</a> article for an overview of the core cryptographic components, the information on how are they selected, how are they integrated into the operating system, how do they support hardware security modules and smart cards, and how do cryptographic certifications apply to them.
			</p><div class="variablelist"><p class="title"><strong>List of RHEL 9 applications using cryptography that is not compliant with FIPS 140-3</strong></p><dl class="variablelist"><dt><span class="term">Bacula</span></dt><dd>
							Implements the CRAM-MD5 authentication protocol.
						</dd><dt><span class="term">Cyrus SASL</span></dt><dd>
							Uses the SCRAM-SHA-1 authentication method.
						</dd><dt><span class="term">Dovecot</span></dt><dd>
							Uses SCRAM-SHA-1.
						</dd><dt><span class="term">Emacs</span></dt><dd>
							Uses SCRAM-SHA-1.
						</dd><dt><span class="term">FreeRADIUS</span></dt><dd>
							Uses MD5 and SHA-1 for authentication protocols.
						</dd><dt><span class="term">Ghostscript</span></dt><dd>
							Custom cryptography implementation (MD5, RC4, SHA-2, AES) to encrypt and decrypt documents.
						</dd><dt><span class="term">GRUB2</span></dt><dd>
							Supports legacy firmware protocols requiring SHA-1 and includes the <code class="literal">libgcrypt</code> library.
						</dd><dt><span class="term">iPXE</span></dt><dd>
							Implements TLS stack.
						</dd><dt><span class="term">Kerberos</span></dt><dd>
							Preserves support for SHA-1 (interoperability with Windows).
						</dd><dt><span class="term">Lasso</span></dt><dd>
							The <code class="literal">lasso_wsse_username_token_derive_key()</code> key derivation function (KDF) uses SHA-1.
						</dd><dt><span class="term">MariaDB, MariaDB Connector</span></dt><dd>
							The <code class="literal">mysql_native_password</code> authentication plugin uses SHA-1.
						</dd><dt><span class="term">MySQL</span></dt><dd>
							<code class="literal">mysql_native_password</code> uses SHA-1.
						</dd><dt><span class="term">OpenIPMI</span></dt><dd>
							The RAKP-HMAC-MD5 authentication method is not approved for FIPS usage and does not work in FIPS mode.
						</dd><dt><span class="term">Ovmf (UEFI firmware), Edk2, shim</span></dt><dd>
							Full cryptographic stack (an embedded copy of the OpenSSL library).
						</dd><dt><span class="term">Perl</span></dt><dd>
							Uses HMAC, HMAC-SHA1, HMAC-MD5, SHA-1, SHA-224,….
						</dd><dt><span class="term">Pidgin</span></dt><dd>
							Implements DES and RC4 ciphers.
						</dd><dt><span class="term">PKCS #12 file processing (OpenSSL, GnuTLS, NSS, Firefox, Java)</span></dt><dd>
							All uses of PKCS #12 are not FIPS-compliant, because the Key Derivation Function (KDF) used for calculating the whole-file HMAC is not FIPS-approved. As such, PKCS #12 files are considered to be plain text for the purposes of FIPS compliance. For key-transport purposes, wrap PKCS #12 (.p12) files using a FIPS-approved encryption scheme.
						</dd><dt><span class="term">Poppler</span></dt><dd>
							Can save PDFs with signatures, passwords, and encryption based on non-allowed algorithms if they are present in the original PDF (for example MD5, RC4, and SHA-1).
						</dd><dt><span class="term">PostgreSQL</span></dt><dd>
							Implements Blowfish, DES, and MD5. A KDF uses SHA-1.
						</dd><dt><span class="term">QAT Engine</span></dt><dd>
							Mixed hardware and software implementation of cryptographic primitives (RSA, EC, DH, AES,…)
						</dd><dt><span class="term">Ruby</span></dt><dd>
							Provides insecure MD5 and SHA-1 library functions.
						</dd><dt><span class="term">Samba</span></dt><dd>
							Preserves support for RC4 and DES (interoperability with Windows).
						</dd><dt><span class="term">Syslinux</span></dt><dd>
							BIOS passwords use SHA-1.
						</dd><dt><span class="term">SWTPM</span></dt><dd>
							Explicitly disables FIPS mode in its OpenSSL usage.
						</dd><dt><span class="term">Unbound</span></dt><dd>
							DNS specification requires that DNSSEC resolvers use a SHA-1-based algorithm in DNSKEY records for validation.
						</dd><dt><span class="term">Valgrind</span></dt><dd>
							AES, SHA hashes.<a href="#ftn.idm140081378418480" class="footnote"><sup class="footnote" id="idm140081378418480">[1]</sup></a>
						</dd><dt><span class="term">zip</span></dt><dd>
							Custom cryptography implementation (insecure PKWARE encryption algorithm) to encrypt and decrypt archives using a password.
						</dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/2918071#fips-140-2-and-fips-140-3-2">FIPS 140-2 and FIPS 140-3</a> section in the <a class="link" href="https://access.redhat.com/articles/2918071">Compliance Activities and Government Standards</a> Knowledgebase article
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/3655361">RHEL core cryptographic components</a> Knowledgebase article
					</li></ul></div><div class="footnotes"><br><hr width="100" align="left"><div id="ftn.idm140081378418480" class="footnote"><div class="para"><a href="#idm140081378418480" class="simpara"><sup class="simpara">[1] </sup></a>
								Re-implements in software hardware-offload operations, such as AES-NI or SHA-1 and SHA-2 on ARM.
							</div></div></div></section></section><section class="chapter" id="using-the-system-wide-cryptographic-policies_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Using system-wide cryptographic policies</h2></div></div></div><p class="_abstract _abstract">
			The system-wide cryptographic policies is a system component that configures the core cryptographic subsystems, covering the TLS, IPsec, SSH, DNSSec, and Kerberos protocols. It provides a small set of policies, which the administrator can select.
		</p><section class="section" id="system-wide-crypto-policies_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.1. System-wide cryptographic policies</h3></div></div></div><p>
				When a system-wide policy is set up, applications in RHEL follow it and refuse to use algorithms and protocols that do not meet the policy, unless you explicitly request the application to do so. That is, the policy applies to the default behavior of applications when running with the system-provided configuration but you can override it if required.
			</p><p>
				RHEL 9 contains the following predefined policies:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">DEFAULT</code></span></dt><dd>
							The default system-wide cryptographic policy level offers secure settings for current threat models. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 2048 bits long.
						</dd><dt><span class="term"><code class="literal">LEGACY</code></span></dt><dd>
							Ensures maximum compatibility with Red Hat Enterprise Linux 6 and earlier; it is less secure due to an increased attack surface. SHA-1 is allowed to be used as TLS hash, signature, and algorithm. CBC-mode ciphers are allowed to be used with SSH. Applications using GnuTLS allow certificates signed with SHA-1. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 2048 bits long.
						</dd><dt><span class="term"><code class="literal">FUTURE</code></span></dt><dd><p class="simpara">
							A stricter forward-looking security level intended for testing a possible future policy. This policy does not allow the use of SHA-1 in DNSSec or as an HMAC. SHA2-224 and SHA3-224 hashes are rejected. 128-bit ciphers are disabled. CBC-mode ciphers are disabled except in Kerberos. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 3072 bits long. If your system communicates on the public internet, you might face interoperability problems.
						</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
								Because a cryptographic key used by a certificate on the Customer Portal API does not meet the requirements by the <code class="literal">FUTURE</code> system-wide cryptographic policy, the <code class="literal">redhat-support-tool</code> utility does not work with this policy level at the moment.
							</p><p>
								To work around this problem, use the <code class="literal">DEFAULT</code> cryptographic policy while connecting to the Customer Portal API.
							</p></div></rh-alert></dd><dt><span class="term"><code class="literal">FIPS</code></span></dt><dd><p class="simpara">
							Conforms with the FIPS 140 requirements. The <code class="literal">fips-mode-setup</code> tool, which switches the RHEL system into FIPS mode, uses this policy internally. Switching to the <code class="literal">FIPS</code> policy does not guarantee compliance with the FIPS 140 standard. You also must re-generate all cryptographic keys after you set the system to FIPS mode. This is not possible in many scenarios.
						</p><p class="simpara">
							RHEL also provides the <code class="literal">FIPS:OSPP</code> system-wide subpolicy, which contains further restrictions for cryptographic algorithms required by the Common Criteria (CC) certification. The system becomes less interoperable after you set this subpolicy. For example, you cannot use RSA and DH keys shorter than 3072 bits, additional SSH algorithms, and several TLS groups. Setting <code class="literal">FIPS:OSPP</code> also prevents connecting to Red Hat Content Delivery Network (CDN) structure. Furthermore, you cannot integrate Active Directory (AD) into the IdM deployments that use <code class="literal">FIPS:OSPP</code>, communication between RHEL hosts using <code class="literal">FIPS:OSPP</code> and AD domains might not work, or some AD accounts might not be able to authenticate.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								Your system is not CC-compliant after you set the <code class="literal">FIPS:OSPP</code> cryptographic subpolicy. The only correct way to make your RHEL system compliant with the CC standard is by following the guidance provided in the <code class="literal">cc-config</code> package. See the <a class="link" href="https://access.redhat.com/articles/compliance_activities_and_gov_standards#common-criteria-1">Common Criteria</a> section in the Compliance Activities and Government Standards Knowledgebase article for a list of certified RHEL versions, validation reports, and links to CC guides.
							</p></div></rh-alert></dd></dl></div><p>
				Red Hat continuously adjusts all policy levels so that all libraries provide secure defaults, except when using the <code class="literal">LEGACY</code> policy. Even though the <code class="literal">LEGACY</code> profile does not provide secure defaults, it does not include any algorithms that are easily exploitable. As such, the set of enabled algorithms or acceptable key sizes in any provided policy may change during the lifetime of Red Hat Enterprise Linux.
			</p><p>
				Such changes reflect new security standards and new security research. If you must ensure interoperability with a specific system for the whole lifetime of Red Hat Enterprise Linux, you should opt-out from the system-wide cryptographic policies for components that interact with that system or re-enable specific algorithms using custom cryptographic policies.
			</p><p>
				The specific algorithms and ciphers described as allowed in the policy levels are available only if an application supports them:
			</p><rh-table id="idm140081372148448"><table class="gt-4-cols lt-7-rows"><caption>Table 3.1. Cipher suites and protocols enabled in the cryptographic policies</caption><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 20%; " class="col_2"><!--Empty--><col style="width: 20%; " class="col_3"><!--Empty--><col style="width: 20%; " class="col_4"><!--Empty--><col style="width: 20%; " class="col_5"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081373212448" scope="col"> </th><th align="left" valign="top" id="idm140081373211520" scope="col"><code class="literal">LEGACY</code></th><th align="left" valign="top" id="idm140081366656448" scope="col"><code class="literal">DEFAULT</code></th><th align="left" valign="top" id="idm140081366655200" scope="col"><code class="literal">FIPS</code></th><th align="left" valign="top" id="idm140081366653952" scope="col"><code class="literal">FUTURE</code></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>IKEv1</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>3DES</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>RC4</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>DH</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								min. 3072-bit
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>RSA</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								min. 2048-bit
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								min. 3072-bit
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>DSA</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>TLS v1.1 and older</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>TLS v1.2 and newer</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								yes
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>SHA-1 in digital signatures and certificates</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								no
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								no
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>CBC mode ciphers</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								no<a href="#ftn.idm140081375189616" class="footnote"><sup class="footnote" id="idm140081375189616">[a]</sup></a>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								no<a href="#ftn.idm140081377495488" class="footnote"><sup class="footnote" id="idm140081377495488">[b]</sup></a>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								no<a href="#ftn.idm140081377492992" class="footnote"><sup class="footnote" id="idm140081377492992">[c]</sup></a>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081373212448"> <p>
								<span class="strong strong"><strong>Symmetric ciphers with keys &lt; 256 bits</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140081373211520"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140081366656448"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140081366655200"> <p>
								yes
							</p>
							 </td><td align="left" valign="top" headers="idm140081366653952"> <p>
								no
							</p>
							 </td></tr></tbody><tbody class="footnotes"><tr><td colspan="5"><div id="ftn.idm140081375189616" class="footnote"><div class="para"><a href="#idm140081375189616" class="simpara"><sup class="simpara">[a] </sup></a>
									CBC ciphers are disabled for SSH
								</div></div><div id="ftn.idm140081377495488" class="footnote"><div class="para"><a href="#idm140081377495488" class="simpara"><sup class="simpara">[b] </sup></a>
									CBC ciphers are disabled for all protocols except Kerberos
								</div></div><div id="ftn.idm140081377492992" class="footnote"><div class="para"><a href="#idm140081377492992" class="simpara"><sup class="simpara">[c] </sup></a>
									CBC ciphers are disabled for all protocols except Kerberos
								</div></div></td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">crypto-policies(7)</code> and <code class="literal">update-crypto-policies(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="changing-the-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.2. Changing the system-wide cryptographic policy</h3></div></div></div><p>
				You can change the system-wide cryptographic policy on your system by using the <code class="literal">update-crypto-policies</code> tool and restarting your system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have root privileges on the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Display the current cryptographic policy:
					</p><pre class="screen">$ <span class="strong strong"><strong>update-crypto-policies --show</strong></span>
DEFAULT</pre></li><li class="listitem"><p class="simpara">
						Set the new cryptographic policy:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set <span class="emphasis"><em>&lt;POLICY&gt;</em></span></strong></span>
<span class="emphasis"><em>&lt;POLICY&gt;</em></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;POLICY&gt;</em></span></code> with the policy or subpolicy you want to set, for example <code class="literal">FUTURE</code>, <code class="literal">LEGACY</code> or <code class="literal">FIPS:OSPP</code>.
					</p></li><li class="listitem"><p class="simpara">
						Restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the current cryptographic policy:
					</p><pre class="screen">$ <span class="strong strong"><strong>update-crypto-policies --show</strong></span>
<code class="literal"><span class="emphasis"><em>&lt;POLICY&gt;</em></span></code></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information on system-wide cryptographic policies, see <a class="link" href="#system-wide-crypto-policies_using-the-system-wide-cryptographic-policies" title="3.1. System-wide cryptographic policies">System-wide cryptographic policies</a>
					</li></ul></div></section><section class="section" id="switching-the-system-wide-crypto-policy-to-mode-compatible-with-previous-systems_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.3. Switching the system-wide cryptographic policy to mode compatible with earlier releases</h3></div></div></div><p class="_abstract _abstract">
				The default system-wide cryptographic policy in Red Hat Enterprise Linux 9 does not allow communication using older, insecure protocols. For environments that require to be compatible with Red Hat Enterprise Linux 6 and in some cases also with earlier releases, the less secure <code class="literal">LEGACY</code> policy level is available.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Switching to the <code class="literal">LEGACY</code> policy level results in a less secure system and applications.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To switch the system-wide cryptographic policy to the <code class="literal">LEGACY</code> level, enter the following command as <code class="literal">root</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set LEGACY</strong></span>
Setting system policy to LEGACY</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For the list of available cryptographic policy levels, see the <code class="literal">update-crypto-policies(8)</code> man page on your system.
					</li><li class="listitem">
						For defining custom cryptographic policies, see the <code class="literal">Custom Policies</code> section in the <code class="literal">update-crypto-policies(8)</code> man page and the <code class="literal">Crypto Policy Definition Format</code> section in the <code class="literal">crypto-policies(7)</code> man page on your system.
					</li></ul></div></section><section class="section" id="proc_re-enabling-sha-1_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.4. Re-enabling SHA-1</h3></div></div></div><p>
				The use of the SHA-1 algorithm for creating and verifying signatures is restricted in the <code class="literal">DEFAULT</code> cryptographic policy. If your scenario requires the use of SHA-1 for verifying existing or third-party cryptographic signatures, you can enable it by applying the <code class="literal">SHA1</code> subpolicy, which RHEL 9 provides by default. Note that it weakens the security of the system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system uses the <code class="literal">DEFAULT</code> system-wide cryptographic policy.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Apply the <code class="literal">SHA1</code> subpolicy to the <code class="literal">DEFAULT</code> cryptographic policy:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set DEFAULT:SHA1</strong></span>
Setting system policy to DEFAULT:SHA1
Note: System-wide crypto policies are applied on application start-up.
It is recommended to restart the system for the change of policies
to fully take place.</pre></li><li class="listitem"><p class="simpara">
						Restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the current cryptographic policy:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --show</strong></span>
DEFAULT:SHA1</pre></li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Switching to the <code class="literal">LEGACY</code> cryptographic policy by using the <code class="literal">update-crypto-policies --set LEGACY</code> command also enables SHA-1 for signatures. However, the <code class="literal">LEGACY</code> cryptographic policy makes your system much more vulnerable by also enabling other weak cryptographic algorithms. Use this workaround only for scenarios that require the enablement of other legacy cryptographic algorithms than SHA-1 signatures.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/6816771">SSH from RHEL 9 to RHEL 6 systems does not work</a> (Red Hat Knowledgebase)
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/6868611">Packages signed with SHA-1 cannot be installed or upgraded</a> (Red Hat Knowledgebase)
					</li></ul></div></section><section class="section" id="setting-up-system-wide-crypto-policies-in-the-web-console_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.5. Setting up system-wide cryptographic policies in the web console</h3></div></div></div><p>
				You can set one of system-wide cryptographic policies and subpolicies directly in the RHEL web console interface. Besides the four predefined system-wide cryptographic policies, you can also apply the following combinations of policies and subpolicies through the graphical interface now:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">DEFAULT:SHA1</code></span></dt><dd>
							The <code class="literal">DEFAULT</code> policy with the <code class="literal">SHA-1</code> algorithm enabled.
						</dd><dt><span class="term"><code class="literal">LEGACY:AD-SUPPORT</code></span></dt><dd>
							The <code class="literal">LEGACY</code> policy with less secure settings that improve interoperability for Active Directory services.
						</dd><dt><span class="term"><code class="literal">FIPS:OSPP</code></span></dt><dd>
							The <code class="literal">FIPS</code> policy with further restrictions required by the Common Criteria for Information Technology Security Evaluation standard.
						</dd></dl></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Because the <code class="literal">FIPS:OSPP</code> system-wide subpolicy contains further restrictions for cryptographic algorithms required by the Common Criteria (CC) certification, the system is less interoperable after you set it. For example, you cannot use RSA and DH keys shorter than 3072 bits, additional SSH algorithms, and several TLS groups. Setting <code class="literal">FIPS:OSPP</code> also prevents connecting to Red Hat Content Delivery Network (CDN) structure. Furthermore, you cannot integrate Active Directory (AD) into the IdM deployments that use <code class="literal">FIPS:OSPP</code>, communication between RHEL hosts using <code class="literal">FIPS:OSPP</code> and AD domains might not work, or some AD accounts might not be able to authenticate.
				</p><p>
					Note that your <span class="strong strong"><strong>system is not CC-compliant</strong></span> after you set the <code class="literal">FIPS:OSPP</code> cryptographic subpolicy. The only correct way to make your RHEL system compliant with the CC standard is by following the guidance provided in the <code class="literal">cc-config</code> package. See the <a class="link" href="https://access.redhat.com/articles/compliance_activities_and_gov_standards#common-criteria-1">Common Criteria</a> section in the Compliance Activities and Government Standards Knowledgebase article for a list of certified RHEL versions, validation reports, and links to CC guides hosted at the <a class="link" href="https://www.niap-ccevs.org/">National Information Assurance Partnership (NIAP)</a> website.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have installed the RHEL 9 web console.
					</p><p class="simpara">
						For instructions, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console">Installing and enabling the web console</a>.
					</p></li><li class="listitem">
						You have <code class="literal">root</code> privileges or permissions to enter administrative commands with <code class="literal">sudo</code>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the RHEL 9 web console.
					</p><p class="simpara">
						For details, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console">Logging in to the web console</a>.
					</p></li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Configuration</strong></span> card of the <span class="strong strong"><strong>Overview</strong></span> page, click your current policy value next to <span class="strong strong"><strong>Crypto policy</strong></span>.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/ab541c5145a88c27bb0de37f9df77636/web-console-crypto-policies-overview.png" alt="The web console: Overview"></span>

					</p></li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Change crypto policy</strong></span> dialog window, click on the policy you want to start using on your system.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/8a53db0d2f25719abcfe2a44cf898235/web-console-crypto-policies-select.png" alt="The web console: Change the system-wide cryptographic policy"></span>

					</p></li><li class="listitem">
						Click the <span class="guibutton">Apply and reboot</span> button.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						After the restart, log back in to web console, and check that the <span class="strong strong"><strong>Crypto policy</strong></span> value corresponds to the one you selected.
					</p><p class="simpara">
						Alternatively, you can enter the <code class="literal">update-crypto-policies --show</code> command to display the current system-wide cryptographic policy in your terminal.
					</p></li></ul></div></section><section class="section" id="excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.6. Excluding an application from following system-wide crypto policies</h3></div></div></div><p>
				You can customize cryptographic settings used by your application preferably by configuring supported cipher suites and protocols directly in the application.
			</p><p>
				You can also remove a symlink related to your application from the <code class="literal">/etc/crypto-policies/back-ends</code> directory and replace it with your customized cryptographic settings. This configuration prevents the use of system-wide cryptographic policies for applications that use the excluded back end. Furthermore, this modification is not supported by Red Hat.
			</p><section class="section" id="examples-of-opting-out-of-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h4 class="title">3.6.1. Examples of opting out of system-wide crypto policies</h4></div></div></div><div class="formalpara"><p class="title"><strong>wget</strong></p><p>
						To customize cryptographic settings used by the <code class="literal">wget</code> network downloader, use <code class="literal">--secure-protocol</code> and <code class="literal">--ciphers</code> options. For example:
					</p></div><pre class="screen">$ <span class="strong strong"><strong>wget --secure-protocol=<span class="emphasis"><em>TLSv1_1</em></span> --ciphers="<span class="emphasis"><em>SECURE128</em></span>" <span class="emphasis"><em>https://example.com</em></span></strong></span></pre><p>
					See the HTTPS (SSL/TLS) Options section of the <code class="literal">wget(1)</code> man page for more information.
				</p><div class="formalpara"><p class="title"><strong>curl</strong></p><p>
						To specify ciphers used by the <code class="literal">curl</code> tool, use the <code class="literal">--ciphers</code> option and provide a colon-separated list of ciphers as a value. For example:
					</p></div><pre class="screen">$ <span class="strong strong"><strong>curl <span class="emphasis"><em>https://example.com</em></span> --ciphers <span class="emphasis"><em>'@SECLEVEL=0:DES-CBC3-SHA:RSA-DES-CBC3-SHA'</em></span></strong></span></pre><p>
					See the <code class="literal">curl(1)</code> man page for more information.
				</p><div class="formalpara"><p class="title"><strong>Firefox</strong></p><p>
						Even though you cannot opt out of system-wide cryptographic policies in the <code class="literal">Firefox</code> web browser, you can further restrict supported ciphers and TLS versions in Firefox’s Configuration Editor. Type <code class="literal">about:config</code> in the address bar and change the value of the <code class="literal">security.tls.version.min</code> option as required. Setting <code class="literal">security.tls.version.min</code> to <code class="literal">1</code> allows TLS 1.0 as the minimum required, <code class="literal">security.tls.version.min 2</code> enables TLS 1.1, and so on.
					</p></div><div class="formalpara"><p class="title"><strong>OpenSSH</strong></p><p>
						To opt out of the system-wide cryptographic policies for your OpenSSH server, specify the cryptographic policy in a drop-in configuration file located in the <code class="literal">/etc/ssh/sshd_config.d/</code> directory, with a two-digit number prefix smaller than 50, so that it lexicographically precedes the <code class="literal">50-redhat.conf</code> file, and with a <code class="literal">.conf</code> suffix, for example, <code class="literal">49-crypto-policy-override.conf</code>.
					</p></div><p>
					See the <code class="literal">sshd_config(5)</code> man page for more information.
				</p><p>
					To opt out of system-wide cryptographic policies for your OpenSSH client, perform one of the following tasks:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							For a given user, override the global <code class="literal">ssh_config</code> with a user-specific configuration in the <code class="literal">~/.ssh/config</code> file.
						</li><li class="listitem">
							For the entire system, specify the cryptographic policy in a drop-in configuration file located in the <code class="literal">/etc/ssh/ssh_config.d/</code> directory, with a two-digit number prefix smaller than 50, so that it lexicographically precedes the <code class="literal">50-redhat.conf</code> file, and with a <code class="literal">.conf</code> suffix, for example, <code class="literal">49-crypto-policy-override.conf</code>.
						</li></ul></div><p>
					See the <code class="literal">ssh_config(5)</code> man page for more information.
				</p><div class="formalpara"><p class="title"><strong>Libreswan</strong></p><p>
						See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/configuring-a-vpn-with-ipsec_securing-networks#configuring-ipsec-connections-that-opt-out-of-the-system-wide-crypto-policies_configuring-a-vpn-with-ipsec">Configuring IPsec connections that opt out of the system-wide crypto policies</a> in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/">Securing networks</a> document for detailed information.
					</p></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">update-crypto-policies(8)</code> man page on your system
						</li></ul></div></section></section><section class="section" id="customizing-system-wide-cryptographic-policies-with-subpolicies_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.7. Customizing system-wide cryptographic policies with subpolicies</h3></div></div></div><p class="_abstract _abstract">
				Use this procedure to adjust the set of enabled cryptographic algorithms or protocols.
			</p><p>
				You can either apply custom subpolicies on top of an existing system-wide cryptographic policy or define such a policy from scratch.
			</p><p>
				The concept of scoped policies allows enabling different sets of algorithms for different back ends. You can limit each configuration directive to specific protocols, libraries, or services.
			</p><p>
				Furthermore, directives can use asterisks for specifying multiple values using wildcards.
			</p><p>
				The <code class="literal">/etc/crypto-policies/state/CURRENT.pol</code> file lists all settings in the currently applied system-wide cryptographic policy after wildcard expansion. To make your cryptographic policy more strict, consider using values listed in the <code class="literal">/usr/share/crypto-policies/policies/FUTURE.pol</code> file.
			</p><p>
				You can find example subpolicies in the <code class="literal">/usr/share/crypto-policies/policies/modules/</code> directory. The subpolicy files in this directory contain also descriptions in lines that are commented out.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Checkout to the <code class="literal">/etc/crypto-policies/policies/modules/</code> directory:
					</p><pre class="screen"># <span class="strong strong"><strong>cd /etc/crypto-policies/policies/modules/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create subpolicies for your adjustments, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>touch <span class="emphasis"><em>MYCRYPTO-1</em></span>.pmod</strong></span>
# <span class="strong strong"><strong>touch <span class="emphasis"><em>SCOPES-AND-WILDCARDS</em></span>.pmod</strong></span></pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Use upper-case letters in file names of policy modules.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Open the policy modules in a text editor of your choice and insert options that modify the system-wide cryptographic policy, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi <span class="emphasis"><em>MYCRYPTO-1</em></span>.pmod</strong></span></pre><pre class="screen">min_rsa_size = 3072
hash = SHA2-384 SHA2-512 SHA3-384 SHA3-512</pre><pre class="screen"># <span class="strong strong"><strong>vi <span class="emphasis"><em>SCOPES-AND-WILDCARDS</em></span>.pmod</strong></span></pre><pre class="screen"># Disable the AES-128 cipher, all modes
cipher = -AES-128-*

# Disable CHACHA20-POLY1305 for the TLS protocol (OpenSSL, GnuTLS, NSS, and OpenJDK)
cipher@TLS = -CHACHA20-POLY1305

# Allow using the FFDHE-1024 group with the SSH protocol (libssh and OpenSSH)
group@SSH = FFDHE-1024+

# Disable all CBC mode ciphers for the SSH protocol (libssh and OpenSSH)
cipher@SSH = -*-CBC

# Allow the AES-256-CBC cipher in applications using libssh
cipher@libssh = AES-256-CBC+</pre></li><li class="listitem">
						Save the changes in the module files.
					</li><li class="listitem"><p class="simpara">
						Apply your policy adjustments to the <code class="literal">DEFAULT</code> system-wide cryptographic policy level:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set DEFAULT:<span class="emphasis"><em>MYCRYPTO-1</em></span>:<span class="emphasis"><em>SCOPES-AND-WILDCARDS</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To make your cryptographic settings effective for already running services and applications, restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">/etc/crypto-policies/state/CURRENT.pol</code> file contains your changes, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>cat /etc/crypto-policies/state/CURRENT.pol | grep rsa_size</strong></span>
min_rsa_size = 3072</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">Custom Policies</code> section in the <code class="literal">update-crypto-policies(8)</code> man page on your system
					</li><li class="listitem">
						<code class="literal">Crypto Policy Definition Format</code> section in the <code class="literal">crypto-policies(7)</code> man page on your system
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/blog/how-customize-crypto-policies-rhel-82">How to customize crypto policies in RHEL 8.2</a> Red Hat blog article
					</li></ul></div></section><section class="section" id="creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.8. Creating and setting a custom system-wide cryptographic policy</h3></div></div></div><p>
				For specific scenarios, you can customize the system-wide cryptographic policy by creating and using a complete policy file.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a policy file for your customizations:
					</p><pre class="screen"># <span class="strong strong"><strong>cd /etc/crypto-policies/policies/</strong></span>
# <span class="strong strong"><strong>touch <span class="emphasis"><em>MYPOLICY</em></span>.pol</strong></span></pre><p class="simpara">
						Alternatively, start by copying one of the four predefined policy levels:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /usr/share/crypto-policies/policies/<span class="emphasis"><em>DEFAULT</em></span>.pol /etc/crypto-policies/policies/<span class="emphasis"><em>MYPOLICY</em></span>.pol</strong></span></pre></li><li class="listitem"><p class="simpara">
						Edit the file with your custom cryptographic policy in a text editor of your choice to fit your requirements, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/crypto-policies/policies/<span class="emphasis"><em>MYPOLICY</em></span>.pol</strong></span></pre></li><li class="listitem"><p class="simpara">
						Switch the system-wide cryptographic policy to your custom level:
					</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set <span class="emphasis"><em>MYPOLICY</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To make your cryptographic settings effective for already running services and applications, restart the system:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">Custom Policies</code> section in the <code class="literal">update-crypto-policies(8)</code> man page and the <code class="literal">Crypto Policy Definition Format</code> section in the <code class="literal">crypto-policies(7)</code> man page on your system
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/blog/how-customize-crypto-policies-rhel-82">How to customize crypto policies in RHEL</a> Red Hat blog article
					</li></ul></div></section><section class="section" id="proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_using-the-system-wide-cryptographic-policies"><div class="titlepage"><div><div><h3 class="title">3.9. Enhancing security with the <code class="literal">FUTURE</code> cryptographic policy using the <code class="literal">crypto_policies</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">crypto_policies</code> RHEL system role to configure the <code class="literal">FUTURE</code> policy on your managed nodes. This policy helps to achieve for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Future-proofing against emerging threats: anticipates advancements in computational power.
					</li><li class="listitem">
						Enhanced security: stronger encryption standards require longer key lengths and more secure algorithms.
					</li><li class="listitem">
						Compliance with high-security standards: for example in healthcare, telco, and finance the data sensitivity is high, and availability of strong cryptography is critical.
					</li></ul></div><p>
				Typically, <code class="literal">FUTURE</code> is suitable for environments handling highly sensitive data, preparing for future regulations, or adopting long-term security strategies.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Legacy systems or software does not have to support the more modern and stricter algorithms and protocols enforced by the <code class="literal">FUTURE</code> policy. For example, older systems might not support TLS 1.3 or larger key sizes. This could lead to compatibility problems.
				</p><p>
					Also, using strong algorithms usually increases the computational workload, which could negatively affect your system performance.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure cryptographic policies
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure the FUTURE cryptographic security policy on the managed node
      ansible.builtin.include_role:
        name: rhel-system-roles.crypto_policies
      vars:
        - crypto_policies_policy: <span class="emphasis"><em>FUTURE</em></span>
        - crypto_policies_reboot_ok: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">crypto_policies_policy: <span class="emphasis"><em>FUTURE</em></span></code></span></dt><dd>
									Configures the required cryptographic policy (<code class="literal">FUTURE</code>) on the managed node. It can be either the base policy or a base policy with some sub-policies. The specified base policy and sub-policies have to be available on the managed node. The default value is <code class="literal">null</code>. It means that the configuration is not changed and the <code class="literal">crypto_policies</code> RHEL system role will only collect the Ansible facts.
								</dd><dt><span class="term"><code class="literal">crypto_policies_reboot_ok: <span class="emphasis"><em>true</em></span></code></span></dt><dd>
									Causes the system to reboot after the cryptographic policy change to make sure all of the services and applications will read the new configuration files. The default value is <code class="literal">false</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Because the <code class="literal">FIPS:OSPP</code> system-wide subpolicy contains further restrictions for cryptographic algorithms required by the Common Criteria (CC) certification, the system is less interoperable after you set it. For example, you cannot use RSA and DH keys shorter than 3072 bits, additional SSH algorithms, and several TLS groups. Setting <code class="literal">FIPS:OSPP</code> also prevents connecting to Red Hat Content Delivery Network (CDN) structure. Furthermore, you cannot integrate Active Directory (AD) into the IdM deployments that use <code class="literal">FIPS:OSPP</code>, communication between RHEL hosts using <code class="literal">FIPS:OSPP</code> and AD domains might not work, or some AD accounts might not be able to authenticate.
				</p><p>
					Note that your <span class="strong strong"><strong>system is not CC-compliant</strong></span> after you set the <code class="literal">FIPS:OSPP</code> cryptographic subpolicy. The only correct way to make your RHEL system compliant with the CC standard is by following the guidance provided in the <code class="literal">cc-config</code> package. See the <a class="link" href="https://access.redhat.com/articles/compliance_activities_and_gov_standards#common-criteria-1">Common Criteria</a> section in the Compliance Activities and Government Standards Knowledgebase article for a list of certified RHEL versions, validation reports, and links to CC guides hosted at the <a class="link" href="https://www.niap-ccevs.org/">National Information Assurance Partnership (NIAP)</a> website.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the control node, create another playbook named, for example, <code class="literal">verify_playbook.yml</code>:
					</p><pre class="programlisting language-yaml">---
- name: Verification
  hosts: managed-node-01.example.com
  tasks:
    - name: Verify active cryptographic policy
      ansible.builtin.include_role:
        name: rhel-system-roles.crypto_policies
    - name: Display the currently active cryptographic policy
      ansible.builtin.debug:
        var: crypto_policies_active</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">crypto_policies_active</code></span></dt><dd>
									An exported Ansible fact that contains the currently active policy name in the format as accepted by the <code class="literal">crypto_policies_policy</code> variable.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/verify_playbook.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/verify_playbook.yml</strong></span>
TASK [debug] **************************
ok: [host] =&gt; {
    "crypto_policies_active": "FUTURE"
}</pre><p class="simpara">
						The <code class="literal">crypto_policies_active</code> variable shows the active policy on the managed node.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/crypto_policies/</code> directory
					</li><li class="listitem">
						<code class="literal">update-crypto-policies(8)</code> and <code class="literal">crypto-policies(7)</code> manual pages
					</li></ul></div></section></section><section class="chapter" id="configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Configuring applications to use cryptographic hardware through PKCS #11</h2></div></div></div><p class="_abstract _abstract">
			Separating parts of your secret information about dedicated cryptographic devices, such as smart cards and cryptographic tokens for end-user authentication and hardware security modules (HSM) for server applications, provides an additional layer of security. In RHEL, support for cryptographic hardware through the PKCS #11 API is consistent across different applications, and the isolation of secrets on cryptographic hardware is not a complicated task.
		</p><section class="section" id="cryptographic-hardware-support-through-pkcs-11_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h3 class="title">4.1. Cryptographic hardware support through PKCS #11</h3></div></div></div><p>
				Public-Key Cryptography Standard (PKCS) #11 defines an application programming interface (API) to cryptographic devices that hold cryptographic information and perform cryptographic functions.
			</p><p>
				PKCS #11 introduces the <span class="emphasis"><em>cryptographic token</em></span>, an object that presents each hardware or software device to applications in a unified manner. Therefore, applications view devices such as smart cards, which are typically used by persons, and hardware security modules, which are typically used by computers, as PKCS #11 cryptographic tokens.
			</p><p>
				A PKCS #11 token can store various object types including a certificate; a data object; and a public, private, or secret key. These objects are uniquely identifiable through the PKCS #11 Uniform Resource Identifier (URI) scheme.
			</p><p>
				A PKCS #11 URI is a standard way to identify a specific object in a PKCS #11 module according to the object attributes. This enables you to configure all libraries and applications with the same configuration string in the form of a URI.
			</p><p>
				RHEL provides the OpenSC PKCS #11 driver for smart cards by default. However, hardware tokens and HSMs can have their own PKCS #11 modules that do not have their counterpart in the system. You can register such PKCS #11 modules with the <code class="literal">p11-kit</code> tool, which acts as a wrapper over the registered smart-card drivers in the system.
			</p><p>
				To make your own PKCS #11 module work on the system, add a new text file to the <code class="literal filename">/etc/pkcs11/modules/</code> directory
			</p><p>
				You can add your own PKCS #11 module into the system by creating a new text file in the <code class="literal filename">/etc/pkcs11/modules/</code> directory. For example, the OpenSC configuration file in <code class="literal">p11-kit</code> looks as follows:
			</p><pre class="screen">$ <span class="strong strong"><strong>cat /usr/share/p11-kit/modules/opensc.module</strong></span>
module: opensc-pkcs11.so</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://tools.ietf.org/html/rfc7512">The PKCS #11 URI Scheme</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/blogs/766093/posts/1976313">Controlling access to smart cards</a>
					</li></ul></div></section><section class="section" id="using-ssh-keys-stored-on-a-smart-card_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h3 class="title">4.2. Authenticating by SSH keys stored on a smart card</h3></div></div></div><p>
				You can create and store ECDSA and RSA keys on a smart card and authenticate by the smart card on an OpenSSH client. Smart-card authentication replaces the default password authentication.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						On the client side, the <code class="literal">opensc</code> package is installed and the <code class="literal">pcscd</code> service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List all keys provided by the OpenSC PKCS #11 module including their PKCS #11 URIs and save the output to the <code class="literal">keys.pub</code> file:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh-keygen -D pkcs11: &gt; keys.pub</strong></span></pre></li><li class="listitem"><p class="simpara">
						Transfer the public key to the remote server. Use the <code class="literal">ssh-copy-id</code> command with the <code class="literal">keys.pub</code> file created in the previous step:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh-copy-id -f -i keys.pub <span class="emphasis"><em>&lt;username@ssh-server-example.com&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Connect to <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span> by using the ECDSA key. You can use just a subset of the URI, which uniquely references your key, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i "pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so" <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
Enter PIN for 'SSH key':
[ssh-server-example.com] $</pre><p class="simpara">
						Because OpenSSH uses the <code class="literal">p11-kit-proxy</code> wrapper and the OpenSC PKCS #11 module is registered to the <code class="literal">p11-kit</code> tool, you can simplify the previous command:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i "pkcs11:id=%01" <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
Enter PIN for 'SSH key':
[ssh-server-example.com] $</pre><p class="simpara">
						If you skip the <code class="literal">id=</code> part of a PKCS #11 URI, OpenSSH loads all keys that are available in the proxy module. This can reduce the amount of typing required:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i pkcs11: <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
Enter PIN for 'SSH key':
[ssh-server-example.com] $</pre></li><li class="listitem"><p class="simpara">
						Optional: You can use the same URI string in the <code class="literal">~/.ssh/config</code> file to make the configuration permanent:
					</p><pre class="screen">$ <span class="strong strong"><strong>cat ~/.ssh/config</strong></span>
IdentityFile "pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so"
$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
Enter PIN for 'SSH key':
[ssh-server-example.com] $</pre><p class="simpara">
						The <code class="literal">ssh</code> client utility now automatically uses this URI and the key from the smart card.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">p11-kit(8)</code>, <code class="literal">opensc.conf(5)</code>, <code class="literal">pcscd(8)</code>, <code class="literal">ssh(1)</code>, and <code class="literal">ssh-keygen(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="configuring-applications-to-authenticate-using-certificates-from-smart-cards_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h3 class="title">4.3. Configuring applications for authentication with certificates on smart cards</h3></div></div></div><p class="_abstract _abstract">
				Authentication by using smart cards in applications may increase security and simplify automation. You can integrate the Public Key Cryptography Standard (PKCS) #11 URIs into your application by using the following methods:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">Firefox</code> web browser automatically loads the <code class="literal">p11-kit-proxy</code> PKCS #11 module. This means that every supported smart card in the system is automatically detected. For using TLS client authentication, no additional setup is required and keys and certificates from a smart card are automatically used when a server requests them.
					</li><li class="listitem">
						If your application uses the <code class="literal">GnuTLS</code> or <code class="literal">NSS</code> library, it already supports PKCS #11 URIs. Also, applications that rely on the <code class="literal">OpenSSL</code> library can access cryptographic hardware modules, including smart cards, through the <code class="literal">pkcs11</code> engine provided by the <code class="literal">openssl-pkcs11</code> package.
					</li><li class="listitem">
						Applications that require working with private keys on smart cards and that do not use <code class="literal">NSS</code>, <code class="literal">GnuTLS</code>, nor <code class="literal">OpenSSL</code> can use the <code class="literal">p11-kit</code> API directly to work with cryptographic hardware modules, including smart cards, rather than using the PKCS #11 API of specific PKCS #11 modules.
					</li><li class="listitem"><p class="simpara">
						With the the <code class="literal">wget</code> network downloader, you can specify PKCS #11 URIs instead of paths to locally stored private keys and certificates. This might simplify creation of scripts for tasks that require safely stored private keys and certificates. For example:
					</p><pre class="screen">$ <span class="strong strong"><strong>wget --private-key 'pkcs11:token=softhsm;id=%01;type=private?pin-value=111111' --certificate 'pkcs11:token=softhsm;id=%01;type=cert' https://example.com/</strong></span></pre></li><li class="listitem"><p class="simpara">
						You can also specify PKCS #11 URI when using the <code class="literal">curl</code> tool:
					</p><pre class="screen">$ <span class="strong strong"><strong>curl --key 'pkcs11:token=softhsm;id=%01;type=private?pin-value=111111' --cert 'pkcs11:token=softhsm;id=%01;type=cert' https://example.com/</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Because a PIN is a security measure that controls access to keys stored on a smart card and the configuration file contains the PIN in the plain-text form, consider additional protection to prevent an attacker from reading the PIN. For example, you can use the <code class="literal">pin-source</code> attribute and provide a <code class="literal">file:</code> URI for reading the PIN from a file. See <a class="link" href="https://datatracker.ietf.org/doc/html/rfc7512#section-2.4">RFC 7512: PKCS #11 URI Scheme Query Attribute Semantics</a> for more information. Note that using a command path as a value of the <code class="literal">pin-source</code> attribute is not supported.
						</p></div></rh-alert></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">curl(1)</code>, <code class="literal">wget(1)</code>, and <code class="literal">p11-kit(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="ref_using-hsms-protecting-private-keys-in-apache_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h3 class="title">4.4. Using HSMs protecting private keys in Apache</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">Apache</code> HTTP server can work with private keys stored on hardware security modules (HSMs), which helps to prevent the keys' disclosure and man-in-the-middle attacks. Note that this usually requires high-performance HSMs for busy servers.
			</p><p>
				For secure communication in the form of the HTTPS protocol, the <code class="literal">Apache</code> HTTP server (<code class="literal">httpd</code>) uses the OpenSSL library. OpenSSL does not support PKCS #11 natively. To use HSMs, you have to install the <code class="literal package">openssl-pkcs11</code> package, which provides access to PKCS #11 modules through the engine interface. You can use a PKCS #11 URI instead of a regular file name to specify a server key and a certificate in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> configuration file, for example:
			</p><pre class="screen">SSLCertificateFile    "pkcs11:id=%01;token=softhsm;type=cert"
SSLCertificateKeyFile "pkcs11:id=%01;token=softhsm;type=private?pin-value=111111"</pre><p>
				Install the <code class="literal package">httpd-manual</code> package to obtain complete documentation for the <code class="literal">Apache</code> HTTP Server, including TLS configuration. The directives available in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> configuration file are described in detail in the <code class="literal">/usr/share/httpd/manual/mod/mod_ssl.html</code> file.
			</p></section><section class="section" id="ref_using-hsms-protecting-private-keys-in-nginx_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h3 class="title">4.5. Using HSMs protecting private keys in Nginx</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">Nginx</code> HTTP server can work with private keys stored on hardware security modules (HSMs), which helps to prevent the keys' disclosure and man-in-the-middle attacks. Note that this usually requires high-performance HSMs for busy servers.
			</p><p>
				Because <code class="literal">Nginx</code> also uses the OpenSSL for cryptographic operations, support for PKCS #11 must go through the <code class="literal">openssl-pkcs11</code> engine. <code class="literal">Nginx</code> currently supports only loading private keys from an HSM, and a certificate must be provided separately as a regular file. Modify the <code class="literal">ssl_certificate</code> and <code class="literal">ssl_certificate_key</code> options in the <code class="literal">server</code> section of the <code class="literal">/etc/nginx/nginx.conf</code> configuration file:
			</p><pre class="screen">ssl_certificate     /path/to/cert.pem
ssl_certificate_key "engine:pkcs11:pkcs11:token=softhsm;id=%01;type=private?pin-value=111111";</pre><p>
				Note that the <code class="literal">engine:pkcs11:</code> prefix is needed for the PKCS #11 URI in the <code class="literal">Nginx</code> configuration file. This is because the other <code class="literal">pkcs11</code> prefix refers to the engine name.
			</p></section><section class="section _additional-resources" id="related-information-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11"><div class="titlepage"><div><div><h3 class="title">4.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">pkcs11.conf(5)</code> man page on your system
					</li></ul></div></section></section><section class="chapter" id="assembly_controlling-access-to-smart-cards-using-polkit_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Controlling access to smart cards by using polkit</h2></div></div></div><p class="_abstract _abstract">
			To cover possible threats that cannot be prevented by mechanisms built into smart cards, such as PINs, PIN pads, and biometrics, and for more fine-grained control, RHEL uses the <code class="literal">polkit</code> framework for controlling access control to smart cards.
		</p><p>
			System administrators can configure <code class="literal">polkit</code> to fit specific scenarios, such as smart-card access for non-privileged or non-local users or services.
		</p><section class="section" id="con_smart-card-access-control-through-polkit_assembly_controlling-access-to-smart-cards-using-polkit"><div class="titlepage"><div><div><h3 class="title">5.1. Smart-card access control through polkit</h3></div></div></div><p class="_abstract _abstract">
				The Personal Computer/Smart Card (PC/SC) protocol specifies a standard for integrating smart cards and their readers into computing systems. In RHEL, the <code class="literal">pcsc-lite</code> package provides middleware to access smart cards that use the PC/SC API. A part of this package, the <code class="literal">pcscd</code> (PC/SC Smart Card) daemon, ensures that the system can access a smart card using the PC/SC protocol.
			</p><p>
				Because access-control mechanisms built into smart cards, such as PINs, PIN pads, and biometrics, do not cover all possible threats, RHEL uses the <code class="literal">polkit</code> framework for more robust access control. The <code class="literal">polkit</code> authorization manager can grant access to privileged operations. In addition to granting access to disks, you can use <code class="literal">polkit</code> also to specify policies for securing smart cards. For example, you can define which users can perform which operations with a smart card.
			</p><p>
				After installing the <code class="literal">pcsc-lite</code> package and starting the <code class="literal">pcscd</code> daemon, the system enforces policies defined in the <code class="literal">/usr/share/polkit-1/actions/</code> directory. The default system-wide policy is in the <code class="literal">/usr/share/polkit-1/actions/org.debian.pcsc-lite.policy</code> file. Polkit policy files use the XML format and the syntax is described in the <code class="literal">polkit(8)</code> man page on your system.
			</p><p>
				The <code class="literal">polkitd</code> service monitors the <code class="literal">/etc/polkit-1/rules.d/</code> and <code class="literal">/usr/share/polkit-1/rules.d/</code> directories for any changes in rule files stored in these directories. The files contain authorization rules in JavaScript format. System administrators can add custom rule files in both directories, and <code class="literal">polkitd</code> reads them in lexical order based on their file name. If two files have the same names, then the file in <code class="literal">/etc/polkit-1/rules.d/</code> is read first.
			</p><p>
				If you need to enable smart-card support when the system security services daemon (SSSD) does not run as <code class="literal">root</code>, you must install the <code class="literal">sssd-polkit-rules</code> package. The package provides <code class="literal">polkit</code> integration with SSSD.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">polkit(8)</code>, <code class="literal">polkitd(8)</code>, and <code class="literal">pcscd(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="ref_troubleshooting-problems-related-to-pc-sc-and-polkit_assembly_controlling-access-to-smart-cards-using-polkit"><div class="titlepage"><div><div><h3 class="title">5.2. Troubleshooting problems related to PC/SC and polkit</h3></div></div></div><p>
				Polkit policies that are automatically enforced after you install the <code class="literal">pcsc-lite</code> package and start the <code class="literal">pcscd</code> daemon may ask for authentication in the user’s session even if the user does not directly interact with a smart card. In GNOME, you can see the following error message:
			</p><pre class="screen">Authentication is required to access the PC/SC daemon</pre><p>
				Note that the system can install the <code class="literal">pcsc-lite</code> package as a dependency when you install other packages related to smart cards such as <code class="literal">opensc</code>.
			</p><p>
				If your scenario does not require any interaction with smart cards and you want to prevent displaying authorization requests for the PC/SC daemon, you can remove the <code class="literal">pcsc-lite</code> package. Keeping the minimum of necessary packages is a good security practice anyway.
			</p><p>
				If you use smart cards, start troubleshooting by checking the rules in the system-provided policy file at <code class="literal">/usr/share/polkit-1/actions/org.debian.pcsc-lite.policy</code>. You can add your custom rule files to the policy in the <code class="literal">/etc/polkit-1/rules.d/</code> directory, for example, <code class="literal">03-allow-pcscd.rules</code>. Note that the rule files use the JavaScript syntax, the policy file is in the XML format.
			</p><p>
				To understand what authorization requests the system displays, check the Journal log, for example:
			</p><pre class="screen">$ <span class="strong strong"><strong>journalctl -b | grep pcsc</strong></span>
...
Process 3087 (user: 1001) is NOT authorized for action: access_pcsc
...</pre><p>
				The previous log entry means that the user is not authorized to perform an action by the policy. You can solve this denial by adding a corresponding rule to <code class="literal">/etc/polkit-1/rules.d/</code>.
			</p><p>
				You can search also for log entries related to the <code class="literal">polkitd</code> unit, for example:
			</p><pre class="screen">$ <span class="strong strong"><strong>journalctl -u polkit</strong></span>
...
polkitd[NNN]: Error compiling script /etc/polkit-1/rules.d/00-debug-pcscd.rules
...
polkitd[NNN]: Operator of unix-session:c2 FAILED to authenticate to gain authorization for action org.debian.pcsc-lite.access_pcsc for unix-process:4800:14441 [/usr/libexec/gsd-smartcard] (owned by unix-user:group)
...</pre><p>
				In the previous output, the first entry means that the rule file contains some syntax error. The second entry means that the user failed to gain the access to <code class="literal">pcscd</code>.
			</p><p>
				You can also list all applications that use the PC/SC protocol by a short script. Create an executable file, for example, <code class="literal">pcsc-apps.sh</code>, and insert the following code:
			</p><pre class="screen">#!/bin/bash

cd /proc

for p in [0-9]*
do
	if grep libpcsclite.so.1.0.0 $p/maps &amp;&gt; /dev/null
	then
		echo -n "process: "
		cat $p/cmdline
		echo " ($p)"
	fi
done</pre><p>
				Run the script as <code class="literal">root</code>:
			</p><pre class="screen"># <span class="strong strong"><strong>./pcsc-apps.sh</strong></span>
process: /usr/libexec/gsd-smartcard (3048)
enable-sync --auto-ssl-client-auth --enable-crashpad (4828)
...</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">journalctl</code>, <code class="literal">polkit(8)</code>, <code class="literal">polkitd(8)</code>, and <code class="literal">pcscd(8)</code> man pages.
					</li></ul></div></section><section class="section" id="proc_displaying-more-detailed-information-about-polkit-authorization-to-pc-sc_assembly_controlling-access-to-smart-cards-using-polkit"><div class="titlepage"><div><div><h3 class="title">5.3. Displaying more detailed information about polkit authorization to PC/SC</h3></div></div></div><p class="_abstract _abstract">
				In the default configuration, the <code class="literal">polkit</code> authorization framework sends only limited information to the Journal log. You can extend <code class="literal">polkit</code> log entries related to the PC/SC protocol by adding new rules.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the <code class="literal">pcsc-lite</code> package on your system.
					</li><li class="listitem">
						The <code class="literal">pcscd</code> daemon is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new file in the <code class="literal">/etc/polkit-1/rules.d/</code> directory:
					</p><pre class="screen"># <span class="strong strong"><strong>touch /etc/polkit-1/rules.d/00-test.rules</strong></span></pre></li><li class="listitem"><p class="simpara">
						Edit the file in an editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/polkit-1/rules.d/00-test.rules</strong></span></pre></li><li class="listitem"><p class="simpara">
						Insert the following lines:
					</p><pre class="screen">polkit.addRule(function(action, subject) {
  if (action.id == "org.debian.pcsc-lite.access_pcsc" ||
  	action.id == "org.debian.pcsc-lite.access_card") {
	polkit.log("action=" + action);
	polkit.log("subject=" + subject);
  }
});</pre><p class="simpara">
						Save the file, and exit the editor.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">pcscd</code> and <code class="literal">polkit</code> services:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart pcscd.service pcscd.socket polkit.service</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Make an authorization request for <code class="literal">pcscd</code>. For example, open the Firefox web browser or use the <code class="literal">pkcs11-tool -L</code> command provided by the <code class="literal">opensc</code> package.
					</li><li class="listitem"><p class="simpara">
						Display the extended log entries, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>journalctl -u polkit --since "1 hour ago"</strong></span>
polkitd[1224]: &lt;no filename&gt;:4: action=[Action id='org.debian.pcsc-lite.access_pcsc']
polkitd[1224]: &lt;no filename&gt;:5: subject=[Subject pid=2020481 user=user' groups=user,wheel,mock,wireshark seat=null session=null local=true active=true]</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">polkit(8)</code> and <code class="literal">polkitd(8)</code> man pages.
					</li></ul></div></section><section class="section _additional-resources" id="additional_resources"><div class="titlepage"><div><div><h3 class="title">5.4. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/blog/controlling-access-smart-cards">Controlling access to smart cards</a> Red Hat Blog article.
					</li></ul></div></section></section><section class="chapter" id="scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Scanning the system for configuration compliance and vulnerabilities</h2></div></div></div><p class="_abstract _abstract">
			A compliance audit is a process of determining whether a given object follows all the rules specified in a compliance policy. The compliance policy is defined by security professionals who specify the required settings, often in the form of a checklist, that a computing environment should use.
		</p><p>
			Compliance policies can vary substantially across organizations and even across different systems within the same organization. Differences among these policies are based on the purpose of each system and its importance for the organization. Custom software settings and deployment characteristics also raise a need for custom policy checklists.
		</p><section class="section" id="configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.1. Configuration compliance tools in RHEL</h3></div></div></div><p class="_abstract _abstract">
				You can perform a fully automated compliance audit in Red Hat Enterprise Linux by using the following configuration compliance tools. These tools are based on the Security Content Automation Protocol (SCAP) standard and are designed for automated tailoring of compliance policies.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">SCAP Workbench</span></dt><dd>
							The <code class="literal">scap-workbench</code> graphical utility is designed to perform configuration and vulnerability scans on a single local or remote system. You can also use it to generate security reports based on these scans and evaluations.
						</dd><dt><span class="term">OpenSCAP</span></dt><dd><p class="simpara">
							The <code class="literal">OpenSCAP</code> library, with the accompanying <code class="literal">oscap</code> command-line utility, is designed to perform configuration and vulnerability scans on a local system, to validate configuration compliance content, and to generate reports and guides based on these scans and evaluations.
						</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
								You can experience memory-consumption problems while using <span class="strong strong"><strong>OpenSCAP</strong></span>, which can cause stopping the program prematurely and prevent generating any result files. See the <a class="link" href="https://access.redhat.com/articles/6999111">OpenSCAP memory-consumption problems</a> Knowledgebase article for details.
							</p></div></rh-alert></dd><dt><span class="term">SCAP Security Guide (SSG)</span></dt><dd>
							The <code class="literal package">scap-security-guide</code> package provides collections of security policies for Linux systems. The guidance consists of a catalog of practical hardening advice, linked to government requirements where applicable. The project bridges the gap between generalized policy requirements and specific implementation guidelines.
						</dd><dt><span class="term">Script Check Engine (SCE)</span></dt><dd>
							With SCE, which is an extension to the SCAP protocol, administrators can write their security content by using a scripting language, such as Bash, Python, and Ruby. The SCE extension is provided in the <code class="literal package">openscap-engine-sce</code> package. The SCE itself is not part of the SCAP standard.
						</dd></dl></div><p>
				To perform automated compliance audits on multiple systems remotely, you can use the OpenSCAP solution for Red Hat Satellite.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">oscap(8)</code>, <code class="literal">scap-workbench(8)</code>, and <code class="literal">scap-security-guide(8)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://2020-summit-labs.gitlab.io/rhel-custom-security-content/">Red Hat Security Demos: Creating Customized Security Policy Content to Automate Security Compliance</a>
					</li><li class="listitem">
						<a class="link" href="https://github.com/RedHatDemos/SecurityDemos/blob/master/2020Labs/RHELSecurity/documentation/README.adoc">Red Hat Security Demos: Defend Yourself with RHEL Security Technologies</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.15/html/managing_security_compliance/index">Managing security compliance in Red Hat Satellite</a>
					</li></ul></div></section><section class="section" id="vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.2. Vulnerability scanning</h3></div></div></div><section class="section" id="red-hat-security-advisories-oval-feed_vulnerability-scanning"><div class="titlepage"><div><div><h4 class="title">6.2.1. Red Hat Security Advisories OVAL feed</h4></div></div></div><p>
					Red Hat Enterprise Linux security auditing capabilities are based on the Security Content Automation Protocol (SCAP) standard. SCAP is a multi-purpose framework of specifications that supports automated configuration, vulnerability and patch checking, technical control compliance activities, and security measurement.
				</p><p>
					SCAP specifications create an ecosystem where the format of security content is well-known and standardized although the implementation of the scanner or policy editor is not mandated. This enables organizations to build their security policy (SCAP content) once, no matter how many security vendors they employ.
				</p><p>
					The Open Vulnerability Assessment Language (OVAL) is the essential and oldest component of SCAP. Unlike other tools and custom scripts, OVAL describes a required state of resources in a declarative manner. OVAL code is never executed directly but using an OVAL interpreter tool called scanner. The declarative nature of OVAL ensures that the state of the assessed system is not accidentally modified.
				</p><p>
					Like all other SCAP components, OVAL is based on XML. The SCAP standard defines several document formats. Each of them includes a different kind of information and serves a different purpose.
				</p><p>
					<a class="link" href="https://access.redhat.com/security/team/">Red Hat Product Security</a> helps customers evaluate and manage risk by tracking and investigating all security issues affecting Red Hat customers. It provides timely and concise patches and security advisories on the Red Hat Customer Portal. Red Hat creates and supports OVAL patch definitions, providing machine-readable versions of our security advisories.
				</p><p>
					Because of differences between platforms, versions, and other factors, Red Hat Product Security qualitative severity ratings of vulnerabilities do not directly align with the Common Vulnerability Scoring System (CVSS) baseline ratings provided by third parties. Therefore, we recommend that you use the RHSA OVAL definitions instead of those provided by third parties.
				</p><p>
					The <a class="link" href="https://www.redhat.com/security/data/oval/v2/">RHSA OVAL definitions</a> are available individually and as a complete package, and are updated within an hour of a new security advisory being made available on the Red Hat Customer Portal.
				</p><p>
					Each OVAL patch definition maps one-to-one to a Red Hat Security Advisory (RHSA). Because an RHSA can contain fixes for multiple vulnerabilities, each vulnerability is listed separately by its Common Vulnerabilities and Exposures (CVE) name and has a link to its entry in our public bug database.
				</p><p>
					The RHSA OVAL definitions are designed to check for vulnerable versions of RPM packages installed on a system. It is possible to extend these definitions to include further checks, for example, to find out if the packages are being used in a vulnerable configuration. These definitions are designed to cover software and updates shipped by Red Hat. Additional definitions are required to detect the patch status of third-party software.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						The <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_insights/1-latest/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/intro-compliance">Red Hat Insights for Red Hat Enterprise Linux compliance service</a> helps IT security and compliance administrators to assess, monitor, and report on the security policy compliance of Red Hat Enterprise Linux systems. You can also create and manage your SCAP security policies entirely within the compliance service UI.
					</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/articles/221883">Red Hat and OVAL compatibility</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/articles/2123171">Red Hat and CVE compatibility</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/security/updates/advisory">Notifications and Advisories</a> in the <a class="link" href="https://access.redhat.com/security/overview">Product Security Overview</a>
						</li><li class="listitem">
							<a class="link" href="https://www.redhat.com/security/data/metrics/">Security Data Metrics</a>
						</li></ul></div></section><section class="section" id="scanning-the-system-for-vulnerabilities_vulnerability-scanning"><div class="titlepage"><div><div><h4 class="title">6.2.2. Scanning the system for vulnerabilities</h4></div></div></div><p class="_abstract _abstract">
					The <code class="literal">oscap</code> command-line utility enables you to scan local systems, validate configuration compliance content, and generate reports and guides based on these scans and evaluations. This utility serves as a front end to the OpenSCAP library and groups its functionalities to modules (sub-commands) based on the type of SCAP content it processes.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">openscap-scanner</code> and <code class="literal">bzip2</code> packages are installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Download the latest RHSA OVAL definitions for your system:
						</p><pre class="screen"># <span class="strong strong"><strong>wget -O - https://www.redhat.com/security/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2 | bzip2 --decompress &gt; rhel-9.oval.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
							Scan the system for vulnerabilities and save results to the <span class="emphasis"><em>vulnerability.html</em></span> file:
						</p><pre class="screen"># <span class="strong strong"><strong>oscap oval eval --report <span class="emphasis"><em>vulnerability.html</em></span> rhel-9.oval.xml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Check the results in a browser of your choice, for example:
						</p><pre class="screen">$ <span class="strong strong"><strong>firefox <span class="emphasis"><em>vulnerability.html</em></span> &amp;</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">oscap(8)</code> man page on your system
						</li><li class="listitem">
							<a class="link" href="https://www.redhat.com/security/data/oval/v2/RHEL9/">Red Hat OVAL definitions</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/articles/6999111">OpenSCAP memory consumption problems</a>
						</li></ul></div></section><section class="section" id="scanning-remote-systems-for-vulnerabilities_vulnerability-scanning"><div class="titlepage"><div><div><h4 class="title">6.2.3. Scanning remote systems for vulnerabilities</h4></div></div></div><p>
					You can check remote systems for vulnerabilities with the OpenSCAP scanner by using the <code class="literal">oscap-ssh</code> tool over the SSH protocol.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">openscap-utils</code> and <code class="literal">bzip2</code> packages are installed on the system you use for scanning.
						</li><li class="listitem">
							The <code class="literal">openscap-scanner</code> package is installed on the remote systems.
						</li><li class="listitem">
							The SSH server is running on the remote systems.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Download the latest RHSA OVAL definitions for your system:
						</p><pre class="screen"># <span class="strong strong"><strong>wget -O - https://www.redhat.com/security/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2 | bzip2 --decompress &gt; rhel-9.oval.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
							Scan a remote system for vulnerabilities and save the results to a file:
						</p><pre class="screen"># <span class="strong strong"><strong>oscap-ssh <span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;hostname&gt;</em></span> <span class="emphasis"><em>&lt;port&gt;</em></span> oval eval --report <span class="emphasis"><em>&lt;scan-report.html&gt;</em></span> rhel-9.oval.xml</strong></span></pre><p class="simpara">
							Replace:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;hostname&gt;</em></span></code> with the user name and host name of the remote system.
								</li><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;port&gt;</em></span></code> with the port number through which you can access the remote system, for example, <code class="literal">22</code>.
								</li><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;scan-report.html&gt;</em></span></code> with the file name where <code class="literal">oscap</code> saves the scan results.
								</li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">oscap-ssh(8)</code>
						</li><li class="listitem">
							<a class="link" href="https://www.redhat.com/security/data/oval/v2/RHEL9/">Red Hat OVAL definitions</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/articles/6999111">OpenSCAP memory consumption problems</a>
						</li></ul></div></section></section><section class="section" id="configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.3. Configuration compliance scanning</h3></div></div></div><section class="section" id="configuration-compliance-in-rhel-8_configuration-compliance-scanning"><div class="titlepage"><div><div><h4 class="title">6.3.1. Configuration compliance in RHEL</h4></div></div></div><p>
					You can use configuration compliance scanning to conform to a baseline defined by a specific organization. For example, if you work with the US government, you might have to align your systems with the Operating System Protection Profile (OSPP), and if you are a payment processor, you might have to align your systems with the Payment Card Industry Data Security Standard (PCI-DSS). You can also perform configuration compliance scanning to harden your system security.
				</p><p>
					Red Hat recommends you follow the Security Content Automation Protocol (SCAP) content provided in the SCAP Security Guide package because it is in line with Red Hat best practices for affected components.
				</p><p>
					The SCAP Security Guide package provides content which conforms to the SCAP 1.2 and SCAP 1.3 standards. The <code class="literal">openscap scanner</code> utility is compatible with both SCAP 1.2 and SCAP 1.3 content provided in the SCAP Security Guide package.
				</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
						Performing a configuration compliance scanning does not guarantee the system is compliant.
					</p></div></rh-alert><p>
					The SCAP Security Guide suite provides profiles for several platforms in a form of data stream documents. A data stream is a file that contains definitions, benchmarks, profiles, and individual rules. Each rule specifies the applicability and requirements for compliance. RHEL provides several profiles for compliance with security policies. In addition to the industry standard, Red Hat data streams also contain information for remediation of failed rules.
				</p><div class="formalpara"><p class="title"><strong>Structure of compliance scanning resources</strong></p><p>

</p><pre class="screen">Data stream
   ├── xccdf
   |      ├── benchmark
   |            ├── profile
   |            |    ├──rule reference
   |            |    └──variable
   |            ├── rule
   |                 ├── human readable data
   |                 ├── oval reference
   ├── oval          ├── ocil reference
   ├── ocil          ├── cpe reference
   └── cpe           └── remediation</pre>

					<p></p></div><p>
					A profile is a set of rules based on a security policy, such as OSPP, PCI-DSS, and Health Insurance Portability and Accountability Act (HIPAA). This enables you to audit the system in an automated way for compliance with security standards.
				</p><p>
					You can modify (tailor) a profile to customize certain rules, for example, password length. For more information about profile tailoring, see <a class="link" href="#customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench" title="6.8.2. Customizing a security profile with SCAP Workbench">Customizing a security profile with SCAP Workbench</a>.
				</p></section><section class="section" id="possible-results-of-an-openscap-scan_configuration-compliance-scanning"><div class="titlepage"><div><div><h4 class="title">6.3.2. Possible results of an OpenSCAP scan</h4></div></div></div><p class="_abstract _abstract">
					Depending on the data stream and profile applied to an OpenSCAP scan, as well as various properties of your system, each rule may produce a specific result. These are the possible results with brief explanations of their meanings:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Pass</span></dt><dd>
								The scan did not find any conflicts with this rule.
							</dd><dt><span class="term">Fail</span></dt><dd>
								The scan found a conflict with this rule.
							</dd><dt><span class="term">Not checked</span></dt><dd>
								OpenSCAP does not perform an automatic evaluation of this rule. Check whether your system conforms to this rule manually.
							</dd><dt><span class="term">Not applicable</span></dt><dd>
								This rule does not apply to the current configuration.
							</dd><dt><span class="term">Not selected</span></dt><dd>
								This rule is not part of the profile. OpenSCAP does not evaluate this rule and does not display these rules in the results.
							</dd><dt><span class="term">Error</span></dt><dd>
								The scan encountered an error. For additional information, you can enter the <code class="literal">oscap</code> command with the <code class="literal">--verbose DEVEL</code> option. File a support case on the <a class="link" href="https://access.redhat.com/support/cases/">Red Hat customer portal</a> or open a ticket in the <a class="link" href="https://issues.redhat.com/projects/RHEL/issues">RHEL project in Red Hat Jira</a>.
							</dd><dt><span class="term">Unknown</span></dt><dd>
								The scan encountered an unexpected situation. For additional information, you can enter the <code class="literal">oscap</code> command with the <code class="literal">`--verbose DEVEL</code> option. File a support case on the <a class="link" href="https://access.redhat.com/support/cases/">Red Hat customer portal</a> or open a ticket in the <a class="link" href="https://issues.redhat.com/projects/RHEL/issues">RHEL project in Red Hat Jira</a>.
							</dd></dl></div></section><section class="section" id="viewing-profiles-for-configuration-compliance_configuration-compliance-scanning"><div class="titlepage"><div><div><h4 class="title">6.3.3. Viewing profiles for configuration compliance</h4></div></div></div><p>
					Before you decide to use profiles for scanning or remediation, you can list them and check their detailed descriptions using the <code class="literal">oscap info</code> subcommand.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">openscap-scanner</code> and <code class="literal">scap-security-guide</code> packages are installed.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							List all available files with security compliance profiles provided by the SCAP Security Guide project:
						</p><pre class="screen">$ <span class="strong strong"><strong>ls /usr/share/xml/scap/ssg/content/</strong></span>
ssg-rhel9-ds.xml</pre></li><li class="listitem"><p class="simpara">
							Display detailed information about a selected data stream using the <code class="literal command">oscap info</code> subcommand. XML files containing data streams are indicated by the <code class="literal">-ds</code> string in their names. In the <code class="literal">Profiles</code> section, you can find a list of available profiles and their IDs:
						</p><pre class="screen">$ <span class="strong strong"><strong>oscap info /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span>
Profiles:
…
  Title: Australian Cyber Security Centre (ACSC) Essential Eight
    Id: xccdf_org.ssgproject.content_profile_e8
  Title: Health Insurance Portability and Accountability Act (HIPAA)
    Id: xccdf_org.ssgproject.content_profile_hipaa
  Title: PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9
    Id: xccdf_org.ssgproject.content_profile_pci-dss
…</pre></li><li class="listitem"><p class="simpara">
							Select a profile from the data stream file and display additional details about the selected profile. To do so, use <code class="literal command">oscap info</code> with the <code class="literal">--profile</code> option followed by the last section of the ID displayed in the output of the previous command. For example, the ID of the HIPPA profile is <code class="literal">xccdf_org.ssgproject.content_profile_hipaa</code>, and the value for the <code class="literal option">--profile</code> option is <code class="literal">hipaa</code>:
						</p><pre class="screen">$ <span class="strong strong"><strong>oscap info --profile hipaa /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span>
…
Profile
	Title: Health Insurance Portability and Accountability Act (HIPAA)

	Description: The HIPAA Security Rule establishes U.S. national standards to protect individuals’ electronic personal health information that is created, received, used, or maintained by a covered entity.
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">scap-security-guide(8)</code> man page on your system
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/articles/6999111">OpenSCAP memory consumption problems</a>
						</li></ul></div></section><section class="section" id="assessing-configuration-compliance-with-a-specific-baseline_configuration-compliance-scanning"><div class="titlepage"><div><div><h4 class="title">6.3.4. Assessing configuration compliance with a specific baseline</h4></div></div></div><p class="_abstract _abstract">
					You can determine whether your system or a remote system conforms to a specific baseline, and save the results in a report by using the <code class="literal">oscap</code> command-line tool.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal package">openscap-scanner</code> and <code class="literal package">scap-security-guide</code> packages are installed.
						</li><li class="listitem">
							You know the ID of the profile within the baseline with which the system should comply. To find the ID, see the <a class="link" href="#viewing-profiles-for-configuration-compliance_configuration-compliance-scanning" title="6.3.3. Viewing profiles for configuration compliance">Viewing profiles for configuration compliance</a> section.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Scan the local system for compliance with the selected profile and save the scan results to a file:
						</p><pre class="screen">$ <span class="strong strong"><strong>oscap xccdf eval --report <span class="emphasis"><em>&lt;scan-report.html&gt;</em></span> --profile <span class="emphasis"><em>&lt;profileID&gt;</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre><p class="simpara">
							Replace:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;scan-report.html&gt;</em></span></code> with the file name where <code class="literal">oscap</code> saves the scan results.
								</li><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;profileID&gt;</em></span></code> with the profile ID with which the system should comply, for example, <code class="literal">hipaa</code>.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Optional: Scan a remote system for compliance with the selected profile and save the scan results to a file:
						</p><pre class="screen">$ <span class="strong strong"><strong>oscap-ssh <span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;hostname&gt;</em></span> <span class="emphasis"><em>&lt;port&gt;</em></span> xccdf eval --report <span class="emphasis"><em>&lt;scan-report.html&gt;</em></span> --profile <span class="emphasis"><em>&lt;profileID&gt;</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre><p class="simpara">
							Replace:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;hostname&gt;</em></span></code> with the user name and host name of the remote system.
								</li><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;port&gt;</em></span></code> with the port number through which you can access the remote system.
								</li><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;scan-report.html&gt;</em></span></code> with the file name where <code class="literal">oscap</code> saves the scan results.
								</li><li class="listitem">
									<code class="literal"><span class="emphasis"><em>&lt;profileID&gt;</em></span></code> with the profile ID with which the system should comply, for example, <code class="literal">hipaa</code>.
								</li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">scap-security-guide(8)</code> man page on your system
						</li><li class="listitem">
							<code class="literal">SCAP Security Guide</code> documentation in the <code class="literal">/usr/share/doc/scap-security-guide/</code> directory
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/scap-security-guide/guides/ssg-rhel9-guide-index.html</code> - [Guide to the Secure Configuration of Red Hat Enterprise Linux 9] installed with the <code class="literal package">scap-security-guide-doc</code> package
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/articles/6999111">OpenSCAP memory consumption problems</a>
						</li></ul></div></section></section><section class="section" id="remediating-the-system-to-align-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.4. Remediating the system to align with a specific baseline</h3></div></div></div><p>
				You can remediate the RHEL system to align with a specific baseline. You can remediate the system to align with any profile provided by the SCAP Security Guide. For the details on listing the available profiles, see the <a class="link" href="#viewing-profiles-for-configuration-compliance_configuration-compliance-scanning" title="6.3.3. Viewing profiles for configuration compliance">Viewing profiles for configuration compliance</a> section.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					If not used carefully, running the system evaluation with the <code class="literal">Remediate</code> option enabled might render the system non-functional. Red Hat does not provide any automated method to revert changes made by security-hardening remediations. Remediations are supported on RHEL systems in the default configuration. If your system has been altered after the installation, running remediation might not make it compliant with the required security profile.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">scap-security-guide</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Remediate the system by using the <code class="literal">oscap</code> command with the <code class="literal">--remediate</code> option:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile <span class="emphasis"><em>&lt;profileID&gt;</em></span> --remediate /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;profileID&gt;</em></span></code> with the profile ID with which the system should comply, for example, <code class="literal">hipaa</code>.
					</p></li><li class="listitem">
						Restart your system.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Evaluate compliance of the system with the profile, and save the scan results to a file:
					</p><pre class="screen">$ <span class="strong strong"><strong>oscap xccdf eval --report <span class="emphasis"><em>&lt;scan-report.html&gt;</em></span> --profile <span class="emphasis"><em>&lt;profileID&gt;</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre><p class="simpara">
						Replace:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal"><span class="emphasis"><em>&lt;scan-report.html&gt;</em></span></code> with the file name where <code class="literal">oscap</code> saves the scan results.
							</li><li class="listitem">
								<code class="literal"><span class="emphasis"><em>&lt;profileID&gt;</em></span></code> with the profile ID with which the system should comply, for example, <code class="literal">hipaa</code>.
							</li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> and <code class="literal">oscap(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="remediating-the-system-to-align-with-a-specific-baseline-using-the-ssg-ansible-playbook_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.5. Remediating the system to align with a specific baseline using an SSG Ansible playbook</h3></div></div></div><p>
				You can remediate your system to align with a specific baseline by using an Ansible playbook file from the SCAP Security Guide project. This example uses the Health Insurance Portability and Accountability Act (HIPAA) profile, but you can remediate to align with any other profile provided by the SCAP Security Guide. For the details on listing the available profiles, see the <a class="link" href="#viewing-profiles-for-configuration-compliance_configuration-compliance-scanning" title="6.3.3. Viewing profiles for configuration compliance">Viewing profiles for configuration compliance</a> section.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					If not used carefully, running the system evaluation with the <code class="literal">Remediate</code> option enabled might render the system non-functional. Red Hat does not provide any automated method to revert changes made by security-hardening remediations. Remediations are supported on RHEL systems in the default configuration. If your system has been altered after the installation, running remediation might not make it compliant with the required security profile.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">scap-security-guide</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">ansible-core</code> package is installed. See the <a class="link" href="https://docs.ansible.com/ansible/latest/installation_guide/">Ansible Installation Guide</a> for more information.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Remediate your system to align with HIPAA by using Ansible:
					</p><pre class="screen"># <span class="strong strong"><strong>ansible-playbook -i localhost, -c local /usr/share/scap-security-guide/ansible/rhel9-playbook-hipaa.yml</strong></span></pre></li><li class="listitem">
						Restart the system.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Evaluate the compliance of the system with the HIPAA profile, and save the scan results to a file:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile hipaa --report <span class="emphasis"><em>&lt;scan-report.html&gt;</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;scan-report.html&gt;</em></span></code> with the file name where <code class="literal">oscap</code> saves the scan results.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> and <code class="literal">oscap(8)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/">Ansible Documentation</a>
					</li></ul></div></section><section class="section" id="creating-a-remediation-ansible-playbook-to-align-the-system-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.6. Creating a remediation Ansible playbook to align the system with a specific baseline</h3></div></div></div><p>
				You can create an Ansible playbook containing only the remediations that are required to align your system with a specific baseline. This playbook is smaller because it does not cover already satisfied requirements. Creating the playbook does not modify your system in any way, you only prepare a file for later application. This example uses the Health Insurance Portability and Accountability Act (HIPAA) profile.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In RHEL 9, Ansible Engine is replaced by the <code class="literal">ansible-core</code> package, which contains only built-in modules. Note that many Ansible remediations use modules from the community and Portable Operating System Interface (POSIX) collections, which are not included in the built-in modules. In this case, you can use Bash remediations as a substitute for Ansible remediations. The Red Hat Connector in RHEL 9.0 includes the Ansible modules necessary for the remediation playbooks to function with Ansible Core.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">scap-security-guide</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Scan the system and save the results:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile hipaa --results <span class="emphasis"><em>&lt;hipaa-results.xml&gt;</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Find the value of the result ID in the file with the results:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap info <span class="emphasis"><em>&lt;hipaa-results.xml&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate an Ansible playbook based on the file generated in step 1:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf generate fix --fix-type ansible --result-id <span class="emphasis"><em>&lt;xccdf_org.open-scap_testresult_xccdf_org.ssgproject.content_profile_hipaa&gt;</em></span> --output <span class="emphasis"><em>&lt;hipaa-remediations.yml&gt;</em></span> <span class="emphasis"><em>&lt;hipaa-results.xml&gt;</em></span></strong></span></pre></li><li class="listitem">
						Review the generated file, which contains the Ansible remediations for rules that failed during the scan performed in step 1. After reviewing this generated file, you can apply it by using the <code class="literal">ansible-playbook <span class="emphasis"><em>&lt;hipaa-remediations.yml&gt;</em></span></code> command.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						In a text editor of your choice, review that the generated <code class="literal"><span class="emphasis"><em>&lt;hipaa-remediations.yml&gt;</em></span></code> file contains rules that failed in the scan performed in step 1.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code> and <code class="literal">oscap(8)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/">Ansible Documentation</a>
					</li></ul></div></section><section class="section" id="creating-a-remediation-bash-script-for-a-later-application_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.7. Creating a remediation Bash script for a later application</h3></div></div></div><p class="_abstract _abstract">
				Use this procedure to create a Bash script containing remediations that align your system with a security profile such as HIPAA. Using the following steps, you do not do any modifications to your system, you only prepare a file for later application.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">scap-security-guide</code> package is installed on your RHEL system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use the <code class="literal">oscap</code> command to scan the system and to save the results to an XML file. In the following example, <code class="literal">oscap</code> evaluates the system against the <code class="literal">hipaa</code> profile:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile hipaa --results <span class="emphasis"><em>&lt;hipaa-results.xml&gt;</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Find the value of the result ID in the file with the results:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap info <span class="emphasis"><em>&lt;hipaa-results.xml&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate a Bash script based on the results file generated in step 1:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf generate fix --fix-type bash --result-id <span class="emphasis"><em>&lt;xccdf_org.open-scap_testresult_xccdf_org.ssgproject.content_profile_hipaa&gt;</em></span> --output <span class="emphasis"><em>&lt;hipaa-remediations.sh&gt;</em></span> <span class="emphasis"><em>&lt;hipaa-results.xml&gt;</em></span></strong></span></pre></li><li class="listitem">
						The <code class="literal"><span class="emphasis"><em>&lt;hipaa-remediations.sh&gt;</em></span></code> file contains remediations for rules that failed during the scan performed in step 1. After reviewing this generated file, you can apply it with the <code class="literal">./<span class="emphasis"><em>&lt;hipaa-remediations.sh&gt;</em></span></code> command when you are in the same directory as this file.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						In a text editor of your choice, review that the <code class="literal"><span class="emphasis"><em>&lt;hipaa-remediations.sh&gt;</em></span></code> file contains rules that failed in the scan performed in step 1.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">scap-security-guide(8)</code>, <code class="literal">oscap(8)</code>, and <code class="literal">bash(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.8. Scanning the system with a customized profile using SCAP Workbench</h3></div></div></div><p>
				<code class="literal application">SCAP Workbench</code>, which is contained in the <code class="literal package">scap-workbench</code> package, is a graphical utility that enables users to perform configuration and vulnerability scans on a single local or a remote system, perform remediation of the system, and generate reports based on scan evaluations. Note that <code class="literal application">SCAP Workbench</code> has limited functionality compared with the <code class="literal application">oscap</code> command-line utility. <code class="literal application">SCAP Workbench</code> processes security content in the form of data stream files.
			</p><section class="section" id="using-scap-workbench-to-scan-and-remediate-the-system_scanning-the-system-with-a-customized-profile-using-scap-workbench"><div class="titlepage"><div><div><h4 class="title">6.8.1. Using SCAP Workbench to scan and remediate the system</h4></div></div></div><p class="_abstract _abstract">
					To evaluate your system against the selected security policy, use the following procedure.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">scap-workbench</code> package is installed on your system.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							To run <code class="literal application">SCAP Workbench</code> from the <code class="literal application">GNOME Classic</code> desktop environment, press the <kbd class="keycap">Super</kbd> key to enter the <code class="literal">Activities Overview</code>, type <code class="literal command">scap-workbench</code>, and then press <kbd class="keycap">Enter</kbd>. Alternatively, use:
						</p><pre class="screen">$ <span class="strong strong"><strong>scap-workbench</strong></span> &amp;</pre></li><li class="listitem"><p class="simpara">
							Select a security policy using either of the following options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal option">Load Content</code> button on the starting window
								</li><li class="listitem">
									<code class="literal option">Open content from SCAP Security Guide</code>
								</li><li class="listitem"><p class="simpara">
									<code class="literal option">Open Other Content</code> in the <code class="literal">File</code> menu, and search the respective XCCDF, SCAP RPM, or data stream file.
								</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/0f9eeb2312fe90ee8ec24db4d46c31e1/scap-workbench-start.png" alt="scap workbench start"></div></div></li></ul></div></li><li class="listitem"><p class="simpara">
							You can allow automatic correction of the system configuration by selecting the <span class="guibutton">Remediate</span> check box. With this option enabled, <code class="literal application">SCAP Workbench</code> attempts to change the system configuration in accordance with the security rules applied by the policy. This process should fix the related checks that fail during the system scan.
						</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
								If not used carefully, running the system evaluation with the <code class="literal option">Remediate</code> option enabled might render the system non-functional. Red Hat does not provide any automated method to revert changes made by security-hardening remediations. Remediations are supported on RHEL systems in the default configuration. If your system has been altered after the installation, running remediation might not make it compliant with the required security profile.
							</p></div></rh-alert></li><li class="listitem"><p class="simpara">
							Scan your system with the selected profile by clicking the <span class="guibutton">Scan</span> button.
						</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/9664b64567d257b481dda88e7737edc7/scap-workbench-results.png" alt="scap workbench results"></div></div></li><li class="listitem">
							To store the scan results in form of an XCCDF, ARF, or HTML file, click the <span class="guibutton">Save Results</span> combo box. Choose the <code class="literal option">HTML Report</code> option to generate the scan report in human-readable format. The XCCDF and ARF (data stream) formats are suitable for further automatic processing. You can repeatedly choose all three options.
						</li><li class="listitem">
							To export results-based remediations to a file, use the <span class="guibutton">Generate remediation role</span> pop-up menu.
						</li></ol></div></section><section class="section" id="customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench"><div class="titlepage"><div><div><h4 class="title">6.8.2. Customizing a security profile with SCAP Workbench</h4></div></div></div><p class="_abstract _abstract">
					You can customize a security profile by changing parameters in certain rules (for example, minimum password length), removing rules that you cover in a different way, and selecting additional rules, to implement internal policies. You cannot define new rules by customizing a profile.
				</p><p>
					The following procedure demonstrates the use of <code class="literal application">SCAP Workbench</code> for customizing (tailoring) a profile. You can also save the tailored profile for use with the <code class="literal application">oscap</code> command-line utility.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">scap-workbench</code> package is installed on your system.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Run <code class="literal application">SCAP Workbench</code>, and select the profile to customize by using either <code class="literal option">Open content from SCAP Security Guide</code> or <code class="literal option">Open Other Content</code> in the <code class="literal">File</code> menu.
						</li><li class="listitem"><p class="simpara">
							To adjust the selected security profile according to your needs, click the <span class="guibutton">Customize</span> button.
						</p><p class="simpara">
							This opens the new Customization window that enables you to modify the currently selected profile without changing the original data stream file. Choose a new profile ID.
						</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/19d27fa7989305554414c334d5d76e3a/scap-new-profile-id.png" alt="Choosing the ID of your new profile"></div></div></li><li class="listitem">
							Find a rule to modify using either the tree structure with rules organized into logical groups or the <span class="guibutton">Search</span> field.
						</li><li class="listitem"><p class="simpara">
							Include or exclude rules using check boxes in the tree structure, or modify values in rules where applicable.
						</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/4a52e7daf700132237fb0712802b0b79/scap-workbench-customizing-profile.png" alt="Customizing a rule in the OSPP profile"></div></div></li><li class="listitem">
							Confirm the changes by clicking the <span class="guibutton">OK</span> button.
						</li><li class="listitem"><p class="simpara">
							To store your changes permanently, use one of the following options:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Save a customization file separately by using <code class="literal option">Save Customization Only</code> in the <code class="literal">File</code> menu.
								</li><li class="listitem"><p class="simpara">
									Save all security content at once by <code class="literal option">Save All</code> in the <code class="literal">File</code> menu.
								</p><p class="simpara">
									If you select the <code class="literal option">Into a directory</code> option, <code class="literal application">SCAP Workbench</code> saves both the data stream file and the customization file to the specified location. You can use this as a backup solution.
								</p><p class="simpara">
									By selecting the <code class="literal option">As RPM</code> option, you can instruct <code class="literal application">SCAP Workbench</code> to create an RPM package containing the data stream file and the customization file. This is useful for distributing the security content to systems that cannot be scanned remotely, and for delivering the content for further processing.
								</p></li></ul></div></li><li class="listitem">
							Because <code class="literal application">SCAP Workbench</code> does not support results-based remediations for tailored profiles, use the exported remediations with the <code class="literal application">oscap</code> command-line utility.
						</li></ol></div></section><section class="section _additional-resources" id="related-information-scanning-the-system-with-a-customized-profile-using-scap-workbench"><div class="titlepage"><div><div><h4 class="title">6.8.3. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">scap-workbench(8)</code> man page on your system
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/scap-workbench/user_manual.html</code> file provided by the <code class="literal">scap-workbench</code> package
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/solutions/2377951">Deploy customized SCAP policies with Satellite 6.x</a> (Red Hat Knowledgebase)
						</li></ul></div></section></section><section class="section" id="deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.9. Deploying systems that are compliant with a security profile immediately after an installation</h3></div></div></div><p class="_abstract _abstract">
				You can use the OpenSCAP suite to deploy RHEL systems that are compliant with a security profile, such as OSPP, PCI-DSS, and HIPAA profile, immediately after the installation process. Using this deployment method, you can apply specific rules that cannot be applied later using remediation scripts, for example, a rule for password strength and partitioning.
			</p><section class="section" id="ref_profiles-not-compatible-with-server-with-gui_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation"><div class="titlepage"><div><div><h4 class="title">6.9.1. Profiles not compatible with Server with GUI</h4></div></div></div><p class="_abstract _abstract">
					Certain security profiles provided as part of the <span class="strong strong"><strong>SCAP Security Guide</strong></span> are not compatible with the extended package set included in the <span class="strong strong"><strong>Server with GUI</strong></span> base environment. Therefore, do not select <span class="strong strong"><strong>Server with GUI</strong></span> when installing systems compliant with one of the following profiles:
				</p><rh-table id="idm140081373242944"><table class="gt-4-cols lt-7-rows"><caption>Table 6.1. Profiles not compatible with Server with GUI</caption><colgroup><col style="width: 25%; " class="col_1"><!--Empty--><col style="width: 25%; " class="col_2"><!--Empty--><col style="width: 25%; " class="col_3"><!--Empty--><col style="width: 25%; " class="col_4"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081373765040" scope="col">Profile name</th><th align="left" valign="top" id="idm140081373763952" scope="col">Profile ID</th><th align="left" valign="top" id="idm140081373762864" scope="col">Justification</th><th align="left" valign="top" id="idm140081373761776" scope="col">Notes</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081373765040"> <p>
									[DRAFT] CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server
								</p>
								 </td><td align="left" valign="top" headers="idm140081373763952"> <p>
									<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis</strong></span></code>
								</p>
								 </td><td align="left" valign="top" headers="idm140081373762864"> <p>
									Packages <code class="literal">xorg-x11-server-Xorg</code>, <code class="literal">xorg-x11-server-common</code>, <code class="literal">xorg-x11-server-utils</code>, and <code class="literal">xorg-x11-server-Xwayland</code> are part of the <span class="strong strong"><strong>Server with GUI</strong></span> package set, but the policy requires their removal.
								</p>
								 </td><td align="left" valign="top" headers="idm140081373761776"> </td></tr><tr><td align="left" valign="top" headers="idm140081373765040"> <p>
									[DRAFT] CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server
								</p>
								 </td><td align="left" valign="top" headers="idm140081373763952"> <p>
									<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_server_l1</strong></span></code>
								</p>
								 </td><td align="left" valign="top" headers="idm140081373762864"> <p>
									Packages <code class="literal">xorg-x11-server-Xorg</code>, <code class="literal">xorg-x11-server-common</code>, <code class="literal">xorg-x11-server-utils</code>, and <code class="literal">xorg-x11-server-Xwayland</code> are part of the <span class="strong strong"><strong>Server with GUI</strong></span> package set, but the policy requires their removal.
								</p>
								 </td><td align="left" valign="top" headers="idm140081373761776"> </td></tr><tr><td align="left" valign="top" headers="idm140081373765040"> <p>
									DISA STIG for Red Hat Enterprise Linux 9
								</p>
								 </td><td align="left" valign="top" headers="idm140081373763952"> <p>
									<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig</strong></span></code>
								</p>
								 </td><td align="left" valign="top" headers="idm140081373762864"> <p>
									Packages <code class="literal">xorg-x11-server-Xorg</code>, <code class="literal">xorg-x11-server-common</code>, <code class="literal">xorg-x11-server-utils</code>, and <code class="literal">xorg-x11-server-Xwayland</code> are part of the <span class="strong strong"><strong>Server with GUI</strong></span> package set, but the policy requires their removal.
								</p>
								 </td><td align="left" valign="top" headers="idm140081373761776"> <p>
									To install a RHEL system as a <span class="strong strong"><strong>Server with GUI</strong></span> aligned with DISA STIG, you can use the <span class="strong strong"><strong>DISA STIG with GUI</strong></span> profile <a class="link" href="https://bugzilla.redhat.com/show_bug.cgi?id=1648162">BZ#1648162</a>
								</p>
								 </td></tr></tbody></table></rh-table></section><section class="section" id="deploying-baseline-compliant-rhel-systems-using-the-graphical-installation_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation"><div class="titlepage"><div><div><h4 class="title">6.9.2. Deploying baseline-compliant RHEL systems using the graphical installation</h4></div></div></div><p class="_abstract _abstract">
					Use this procedure to deploy a RHEL system that is aligned with a specific baseline. This example uses Protection Profile for General Purpose Operating System (OSPP).
				</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
						Certain security profiles provided as part of the <span class="strong strong"><strong>SCAP Security Guide</strong></span> are not compatible with the extended package set included in the <span class="strong strong"><strong>Server with GUI</strong></span> base environment. For additional details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening#ref_profiles-not-compatible-with-server-with-gui_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation">Profiles not compatible with a GUI server</a>.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							You have booted into the <code class="literal">graphical</code> installation program. Note that the <span class="strong strong"><strong>OSCAP Anaconda Add-on</strong></span> does not support interactive text-only installation.
						</li><li class="listitem">
							You have accessed the <code class="literal">Installation Summary</code> window.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							From the <code class="literal">Installation Summary</code> window, click <code class="literal">Software Selection</code>. The <code class="literal">Software Selection</code> window opens.
						</li><li class="listitem">
							From the <code class="literal">Base Environment</code> pane, select the <code class="literal">Server</code> environment. You can select only one base environment.
						</li><li class="listitem">
							Click <code class="literal">Done</code> to apply the setting and return to the <code class="literal">Installation Summary</code> window.
						</li><li class="listitem">
							Because OSPP has strict partitioning requirements that must be met, create separate partitions for <code class="literal">/boot</code>, <code class="literal">/home</code>, <code class="literal">/var</code>, <code class="literal">/tmp</code>, <code class="literal">/var/log</code>, <code class="literal">/var/tmp</code>, and <code class="literal">/var/log/audit</code>.
						</li><li class="listitem">
							Click <code class="literal">Security Policy</code>. The <code class="literal">Security Policy</code> window opens.
						</li><li class="listitem">
							To enable security policies on the system, toggle the <code class="literal">Apply security policy</code> switch to <code class="literal">ON</code>.
						</li><li class="listitem">
							Select <code class="literal">Protection Profile for General Purpose Operating Systems</code> from the profile pane.
						</li><li class="listitem">
							Click <code class="literal">Select Profile</code> to confirm the selection.
						</li><li class="listitem">
							Confirm the changes in the <code class="literal">Changes that were done or need to be done</code> pane that is displayed at the bottom of the window. Complete any remaining manual changes.
						</li><li class="listitem"><p class="simpara">
							Complete the graphical installation process.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								The graphical installation program automatically creates a corresponding Kickstart file after a successful installation. You can use the <code class="literal">/root/anaconda-ks.cfg</code> file to automatically install OSPP-compliant systems.
							</p></div></rh-alert></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To check the current status of the system after installation is complete, reboot the system and start a new scan:
						</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile ospp --report eval_postinstall_report.html /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/interactively_installing_rhel_from_installation_media/index#storage-devices_customizing-the-system-in-the-installer">Configuring manual partitioning</a>
						</li></ul></div></section><section class="section" id="deploying-baseline-compliant-rhel-systems-using-kickstart_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation"><div class="titlepage"><div><div><h4 class="title">6.9.3. Deploying baseline-compliant RHEL systems using Kickstart</h4></div></div></div><p>
					You can deploy RHEL systems that are aligned with a specific baseline. This example uses Protection Profile for General Purpose Operating System (OSPP).
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">scap-security-guide</code> package is installed on your RHEL 9 system.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open the <code class="literal">/usr/share/scap-security-guide/kickstart/ssg-rhel9-ospp-ks.cfg</code> Kickstart file in an editor of your choice.
						</li><li class="listitem">
							Update the partitioning scheme to fit your configuration requirements. For OSPP compliance, the separate partitions for <code class="literal">/boot</code>, <code class="literal">/home</code>, <code class="literal">/var</code>, <code class="literal">/tmp</code>, <code class="literal">/var/log</code>, <code class="literal">/var/tmp</code>, and <code class="literal">/var/log/audit</code> must be preserved, and you can only change the size of the partitions.
						</li><li class="listitem">
							Start a Kickstart installation as described in <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automatically_installing_rhel/index#starting-kickstart-installations_rhel-installer">Performing an automated installation using Kickstart</a>.
						</li></ol></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
						Passwords in Kickstart files are not checked for OSPP requirements.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To check the current status of the system after installation is complete, reboot the system and start a new scan:
						</p><pre class="screen"># <span class="strong strong"><strong>oscap xccdf eval --profile ospp --report eval_postinstall_report.html /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://www.open-scap.org/tools/oscap-anaconda-addon/">OSCAP Anaconda Add-on</a>
						</li><li class="listitem">
							<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automatically_installing_rhel/index#addon-com_redhat_oscap_kickstart-commands-for-addons-supplied-with-the-rhel-installation-program">Kickstart commands and options reference: %addon org_fedora_oscap</a>
						</li></ul></div></section></section><section class="section" id="scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.10. Scanning container and container images for vulnerabilities</h3></div></div></div><p class="_abstract _abstract">
				Use this procedure to find security vulnerabilities in a container or a container image.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">openscap-utils</code> and <code class="literal">bzip2</code> packages are installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Download the latest RHSA OVAL definitions for your system:
					</p><pre class="screen"># <span class="strong strong"><strong>wget -O - https://www.redhat.com/security/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2 | bzip2 --decompress &gt; rhel-9.oval.xml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Get the ID of a container or a container image, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>podman images</strong></span>
REPOSITORY                            TAG      IMAGE ID       CREATED       SIZE
registry.access.redhat.com/ubi9/ubi   latest   096cae65a207   7 weeks ago   239 MB</pre></li><li class="listitem"><p class="simpara">
						Scan the container or the container image for vulnerabilities and save results to the <span class="emphasis"><em>vulnerability.html</em></span> file:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap-podman <span class="emphasis"><em>096cae65a207</em></span> oval eval --report <span class="emphasis"><em>vulnerability.html</em></span> rhel-9.oval.xml</strong></span></pre><p class="simpara">
						Note that the <code class="literal">oscap-podman</code> command requires root privileges, and the ID of a container is the first argument.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check the results in a browser of your choice, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>firefox <span class="emphasis"><em>vulnerability.html</em></span> &amp;</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information, see the <code class="literal">oscap-podman(8)</code> and <code class="literal">oscap(8)</code> man pages.
					</li></ul></div></section><section class="section" id="assessing-security-compliance-of-a-container-or-a-container-image-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.11. Assessing security compliance of a container or a container image with a specific baseline</h3></div></div></div><p>
				You can assess the compliance of your container or a container image with a specific security baseline, such as Operating System Protection Profile (OSPP), Payment Card Industry Data Security Standard (PCI-DSS), and Health Insurance Portability and Accountability Act (HIPAA).
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">openscap-utils</code> and <code class="literal">scap-security-guide</code> packages are installed.
					</li><li class="listitem">
						You have root access to the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Find the ID of a container or a container image:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								To find the ID of a container, enter the <code class="literal">podman ps -a</code> command.
							</li><li class="listitem">
								To find the ID of a container image, enter the <code class="literal">podman images</code> command.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Evaluate the compliance of the container or container image with a profile and save the scan results into a file:
					</p><pre class="screen"># <span class="strong strong"><strong>oscap-podman <span class="emphasis"><em>&lt;ID&gt;</em></span> xccdf eval --report <span class="emphasis"><em>&lt;scan-report.html&gt;</em></span> --profile <span class="emphasis"><em>&lt;profileID&gt;</em></span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml</strong></span></pre><p class="simpara">
						Replace:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal"><span class="emphasis"><em>&lt;ID&gt;</em></span></code> with the ID of your container or container image
							</li><li class="listitem">
								<code class="literal"><span class="emphasis"><em>&lt;scan-report.html&gt;</em></span></code> with the file name where <code class="literal">oscap</code> saves the scan results
							</li><li class="listitem">
								<code class="literal"><span class="emphasis"><em>&lt;profileID&gt;</em></span></code> with the profile ID with which the system should comply, for example, <code class="literal">hipaa</code>, <code class="literal">ospp</code>, or <code class="literal">pci-dss</code>
							</li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check the results in a browser of your choice, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>firefox <span class="emphasis"><em>&lt;scan-report.html&gt;</em></span> &amp;amp;</strong></span></pre></li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The rules marked as <code class="literal">notapplicable</code> apply only to bare-metal and virtualized systems and not to containers or container images.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">oscap-podman(8)</code> and <code class="literal">scap-security-guide(8)</code> man pages.
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/scap-security-guide/</code> directory.
					</li></ul></div></section><section class="section" id="scap-security-guide-profiles-supported-in-rhel-9_scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.12. SCAP Security Guide profiles supported in RHEL 9</h3></div></div></div><p>
				Use only the SCAP content provided in the particular minor release of RHEL. This is because components that participate in hardening are sometimes updated with new capabilities. SCAP content changes to reflect these updates, but it is not always backward compatible.
			</p><p>
				In the following tables, you can find the profiles provided in RHEL 9, together with the version of the policy with which the profile aligns.
			</p><rh-table id="idm140081370176928"><table class="lt-4-cols lt-7-rows"><caption>Table 6.2. SCAP Security Guide profiles supported in RHEL 9.4</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081366697472" scope="col">Profile name</th><th align="left" valign="top" id="idm140081366696384" scope="col">Profile ID</th><th align="left" valign="top" id="idm140081366695296" scope="col">Policy version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_enhanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 High Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_high</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_intermediary</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_minimal</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CCN Red Hat Enterprise Linux 9 - Advanced
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_advanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CCN Red Hat Enterprise Linux 9 - Basic
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_basic</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CCN Red Hat Enterprise Linux 9 - Intermediate
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_intermediate</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								RHEL 9.4.0 to RHEL 9.4.2:1.0.0<br> RHEL 9.4.3 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_server_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								RHEL 9.4.0 to RHEL 9.4.2:1.0.0<br> RHEL 9.4.3 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								RHEL 9.4.0 to RHEL 9.4.2:1.0.0<br> RHEL 9.4.3 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l2</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								RHEL 9.4.0 to RHEL 9.4.2:1.0.0<br> RHEL 9.4.3 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								r2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								Australian Cyber Security Centre (ACSC) Essential Eight
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>e8</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								Health Insurance Portability and Accountability Act (HIPAA)
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>hipaa</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								Australian Cyber Security Centre (ACSC) ISM Official
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ism_o</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								Protection Profile for General Purpose Operating Systems
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ospp</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								4.3
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>pci-dss</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								4.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								RHEL 9.4.0:V1R2<br> RHEL 9.4.1 and later:V1R3
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig_gui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								RHEL 9.4.0:V1R2<br> RHEL 9.4.1 and later:V1R3
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CCN Red Hat Enterprise Linux 9 - Basic
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_basic</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CCN Red Hat Enterprise Linux 9 - Intermediate
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_intermediate</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081366697472"> <p>
								CCN Red Hat Enterprise Linux 9 - Advanced
							</p>
							 </td><td align="left" valign="top" headers="idm140081366696384"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_advanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081366695296"> <p>
								2022-10
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081371194032"><table class="lt-4-cols lt-7-rows"><caption>Table 6.3. SCAP Security Guide profiles supported in RHEL 9.3</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081367683872" scope="col">Profile name</th><th align="left" valign="top" id="idm140081367682784" scope="col">Profile ID</th><th align="left" valign="top" id="idm140081369874672" scope="col">Policy version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_enhanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 High Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_high</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_intermediary</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_minimal</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CCN Red Hat Enterprise Linux 9 - Advanced
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_advanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CCN Red Hat Enterprise Linux 9 - Basic
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_basic</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CCN Red Hat Enterprise Linux 9 - Intermediate
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_intermediate</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								1.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_server_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								1.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								1.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l2</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								1.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								r2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								Australian Cyber Security Centre (ACSC) Essential Eight
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>e8</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								Health Insurance Portability and Accountability Act (HIPAA)
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>hipaa</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								Australian Cyber Security Centre (ACSC) ISM Official
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ism_o</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								Protection Profile for General Purpose Operating Systems
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ospp</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								4.3
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>pci-dss</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								RHEL 9.3.0 to RHEL 9.3.2:3.2.1<br> RHEL 9.3.3:4.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								RHEL 9.3.0: DRAFT<a href="#ftn.stig" class="footnote"><sup class="footnote" id="stig">[a]</sup></a><br> RHEL 9.3.2:V1R1<br> RHEL 9.3.3 and later:V1R2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig_gui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								RHEL 9.3.0: DRAFT<a href="#ftn.stig" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.3.2:V1R1<br> RHEL 9.3.3 and later:V1R2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CCN Red Hat Enterprise Linux 9 - Basic
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_basic</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CCN Red Hat Enterprise Linux 9 - Intermediate
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_intermediate</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081367683872"> <p>
								CCN Red Hat Enterprise Linux 9 - Advanced
							</p>
							 </td><td align="left" valign="top" headers="idm140081367682784"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_advanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369874672"> <p>
								2022-10
							</p>
							 </td></tr></tbody><tbody class="footnotes"><tr><td colspan="3"><div id="ftn.stig" class="footnote"><div class="para"><a href="#stig" class="simpara"><sup class="simpara">[a] </sup></a>
									DISA has not yet published an official benchmark for RHEL 9
								</div></div></td></tr></tbody></table></rh-table><rh-table id="idm140081372927424"><table class="lt-4-cols lt-7-rows"><caption>Table 6.4. SCAP Security Guide profiles supported in RHEL 9.2</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081362891840" scope="col">Profile name</th><th align="left" valign="top" id="idm140081362890752" scope="col">Profile ID</th><th align="left" valign="top" id="idm140081367290496" scope="col">Policy version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_enhanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.2:1.2<br> RHEL 9.2.3 and later:2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 High Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_high</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.2:1.2<br> RHEL 9.2.3 and later:2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_intermediary</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.2:1.2<br> RHEL 9.2.3 and later:2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_minimal</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.2:1.2<br> RHEL 9.2.3 and later:2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.10:1.0.0<br> RHEL 9.2.11 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_server_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.10:1.0.0<br> RHEL 9.2.11 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.10:1.0.0<br> RHEL 9.2.11 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l2</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.10:1.0.0<br> RHEL 9.2.11 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								r2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								Australian Cyber Security Centre (ACSC) Essential Eight
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>e8</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								Health Insurance Portability and Accountability Act (HIPAA)
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>hipaa</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								Australian Cyber Security Centre (ACSC) ISM Official
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ism_o</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								Protection Profile for General Purpose Operating Systems
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ospp</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								4.2.1
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>pci-dss</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.5:3.2.1<br> RHEL 9.2.6 and later:4.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to RHEL 9.2.4: DRAFT<a href="#ftn.stig" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.2.5:V1R1<br> RHEL 9.2.6 to RHEL 9.2.8:V1R2<br> RHEL 9.2.9 and later:V1R3
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig_gui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								RHEL 9.2.0 to 9.2.4: DRAFT<a href="#ftn.stig" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.2.5:V1R1<br> RHEL 9.2.6 to RHEL 9.2.8:V1R2<br> RHEL 9.2.9 and later:V1R3
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								CCN Red Hat Enterprise Linux 9 - Basic
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_basic</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								CCN Red Hat Enterprise Linux 9 - Intermediate
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_intermediate</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081362891840"> <p>
								CCN Red Hat Enterprise Linux 9 - Advanced
							</p>
							 </td><td align="left" valign="top" headers="idm140081362890752"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_advanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081367290496"> <p>
								2022-10
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081368669728"><table class="lt-4-cols lt-7-rows"><caption>Table 6.5. SCAP Security Guide profiles supported in RHEL 9.1</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081368664000" scope="col">Profile name</th><th align="left" valign="top" id="idm140081369021760" scope="col">Profile ID</th><th align="left" valign="top" id="idm140081369020672" scope="col">Policy version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_enhanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								1.2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 High Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_high</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								1.2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_intermediary</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								1.2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_minimal</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								1.2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								RHEL 9.1.0 and RHEL 9.1.1:DRAFT<a href="#ftn.cis" class="footnote"><sup class="footnote" id="cis">[a]</sup></a><br> RHEL 9.1.2 and later:1.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_server_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								RHEL 9.1.0 and RHEL 9.1.1:DRAFT<a href="#ftn.cis" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.1.2 and later:1.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								RHEL 9.1.0 and RHEL 9.1.1:DRAFT<a href="#ftn.cis" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.1.2 and later:1.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l2</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								RHEL 9.1.0 and RHEL 9.1.1:DRAFT<a href="#ftn.cis" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.1.2 and later:1.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								r2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								Australian Cyber Security Centre (ACSC) Essential Eight
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>e8</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								Health Insurance Portability and Accountability Act (HIPAA)
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>hipaa</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								Australian Cyber Security Centre (ACSC) ISM Official
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ism_o</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								Protection Profile for General Purpose Operating Systems
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ospp</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								4.2.1
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>pci-dss</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								3.2.1
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								[DRAFT] The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								DRAFT<a href="#ftn.stig" class="footnoteref"><sup class="footnoteref">[a]</sup></a>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081368664000"> <p>
								[DRAFT] The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081369021760"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig_gui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369020672"> <p>
								DRAFT<a href="#ftn.stig" class="footnoteref"><sup class="footnoteref">[a]</sup></a>
							</p>
							 </td></tr></tbody><tbody class="footnotes"><tr><td colspan="3"><div id="ftn.cis" class="footnote"><div class="para"><a href="#cis" class="simpara"><sup class="simpara">[a] </sup></a>
									CIS has not yet published an official benchmark for RHEL 9
								</div></div></td></tr></tbody></table></rh-table><rh-table id="idm140081372174960"><table class="lt-4-cols lt-7-rows"><caption>Table 6.6. SCAP Security Guide profiles supported in RHEL 9.0</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081372169232" scope="col">Profile name</th><th align="left" valign="top" id="idm140081369415728" scope="col">Profile ID</th><th align="left" valign="top" id="idm140081369414640" scope="col">Policy version</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_enhanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.10:1.2<br> RHEL 9.0.11 and later:2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 High Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_high</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.10:1.2<br> RHEL 9.0.11 and later:2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_intermediary</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.10:1.2<br> RHEL 9.0.11 and later:2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								French National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>anssi_bp28_minimal</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.10:1.2<br> RHEL 9.0.11 and later:2.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.6:DRAFT<a href="#ftn.cis" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.0.7 to RHEL 9.0.19:1.0.0<br> RHEL 9.0.20 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_server_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.6:DRAFT<a href="#ftn.cis" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.0.7 to RHEL 9.0.19:1.0.0<br> RHEL 9.0.20 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l1</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.6:DRAFT<a href="#ftn.cis" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.0.7 to RHEL 9.0.19:1.0.0<br> RHEL 9.0.20 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cis_workstation_l2</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.6:DRAFT<a href="#ftn.cis" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.0.7 to RHEL 9.0.19:1.0.0<br> RHEL 9.0.20 and later:2.0.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>cui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								r2
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								Australian Cyber Security Centre (ACSC) Essential Eight
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>e8</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								Health Insurance Portability and Accountability Act (HIPAA)
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>hipaa</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								Australian Cyber Security Centre (ACSC) ISM Official
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ism_o</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								not versioned
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								Protection Profile for General Purpose Operating Systems
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ospp</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.2:DRAFT<br> RHEL 9.0.3 and later:4.2.1
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>pci-dss</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.14:3.2.1<br> RHEL 9.0.15:4.0
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.13: DRAFT<a href="#ftn.stig" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.0.14:V1R1<br> RHEL 9.0.15 to 9.0.17:V1R2<br> RHEL 9.0.18 and later:V1R3
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>stig_gui</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.0 to RHEL 9.0.13: DRAFT<a href="#ftn.stig" class="footnoteref"><sup class="footnoteref">[a]</sup></a><br> RHEL 9.0.14:V1R1<br> RHEL 9.0.15 to 9.0.17:V1R2<br> RHEL 9.0.18 and later:V1R3
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								CCN Red Hat Enterprise Linux 9 - Basic
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_basic</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.11 and later:2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								CCN Red Hat Enterprise Linux 9 - Intermediate
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_intermediate</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.11 and later:2022-10
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081372169232"> <p>
								CCN Red Hat Enterprise Linux 9 - Advanced
							</p>
							 </td><td align="left" valign="top" headers="idm140081369415728"> <p>
								<code class="literal">xccdf_org.ssgproject.content_profile_<span class="strong strong"><strong>ccn_advanced</strong></span></code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081369414640"> <p>
								RHEL 9.0.11 and later:2022-10
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section _additional-resources" id="related-information-scanning-the-system-for-configuration-compliance-and-vulnerabilities"><div class="titlepage"><div><div><h3 class="title">6.13. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/6337261">Supported versions of the SCAP Security Guide in RHEL</a>
					</li><li class="listitem">
						<a class="link" href="http://www.open-scap.org">The OpenSCAP project page</a> provides detailed information about the <code class="literal">oscap</code> utility and other components and projects related to SCAP.
					</li><li class="listitem">
						<a class="link" href="https://www.open-scap.org/tools/scap-workbench/">The SCAP Workbench project page</a> provides detailed information about the <code class="literal">scap-workbench</code> application.
					</li><li class="listitem">
						<a class="link" href="https://www.open-scap.org/security-policies/scap-security-guide/">The SCAP Security Guide (SSG) project page</a> provides the latest security content for Red Hat Enterprise Linux.
					</li><li class="listitem">
						<a class="link" href="https://lab.redhat.com/tracks/openscap">Using OpenSCAP for security compliance and vulnerability scanning</a> - A hands-on lab on running tools based on the Security Content Automation Protocol (SCAP) standard for compliance and vulnerability scanning in RHEL.
					</li><li class="listitem">
						<a class="link" href="https://2020-summit-labs.gitlab.io/rhel-custom-security-content/">Red Hat Security Demos: Creating Customized Security Policy Content to Automate Security Compliance</a> - A hands-on lab to get initial experience in automating security compliance using the tools that are included in RHEL to comply with both industry standard security policies and custom security policies. If you want training or access to these lab exercises for your team, contact your Red Hat account team for additional details.
					</li><li class="listitem">
						<a class="link" href="https://github.com/RedHatDemos/SecurityDemos/blob/master/2020Labs/RHELSecurity/documentation/README.adoc">Red Hat Security Demos: Defend Yourself with RHEL Security Technologies</a> - A hands-on lab to learn how to implement security at all levels of your RHEL system, using the key security technologies available to you in RHEL, including OpenSCAP. If you want training or access to these lab exercises for your team, contact your Red Hat account team for additional details.
					</li><li class="listitem">
						<a class="link" href="http://scap.nist.gov/">National Institute of Standards and Technology (NIST) SCAP page</a> has a vast collection of SCAP-related materials, including SCAP publications, specifications, and the SCAP Validation Program.
					</li><li class="listitem">
						<a class="link" href="http://nvd.nist.gov/">National Vulnerability Database (NVD)</a> has the largest repository of SCAP content and other SCAP standards-based vulnerability management data.
					</li><li class="listitem">
						<a class="link" href="http://www.redhat.com/security/data/oval/">Red Hat OVAL content repository</a> contains OVAL definitions for vulnerabilities of RHEL systems. This is the recommended source of vulnerability content.
					</li><li class="listitem">
						<a class="link" href="http://cve.mitre.org/">MITRE CVE</a> - This is a database of publicly known security vulnerabilities provided by the MITRE corporation. For RHEL, using OVAL CVE content provided by Red Hat is recommended.
					</li><li class="listitem">
						<a class="link" href="http://oval.mitre.org/">MITRE OVAL</a> - This is an OVAL-related project provided by the MITRE corporation. Among other OVAL-related information, these pages contain the OVAL language and a repository of OVAL content with thousands of OVAL definitions. Note that for scanning RHEL, using OVAL CVE content provided by Red Hat is recommended.
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_satellite/6.15/html/managing_security_compliance/index">Managing security compliance in Red Hat Satellite</a> - This set of guides describes, among other topics, how to maintain system security on multiple systems by using OpenSCAP.
					</li></ul></div></section></section><section class="chapter" id="assembly_ensuring-system-integrity-with-keylime_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Ensuring system integrity with Keylime</h2></div></div></div><p>
			With Keylime, you can continuously monitor the integrity of remote systems and verify the state of systems at boot. You can also send encrypted files to the monitored systems, and specify automated actions triggered whenever a monitored system fails the integrity test.
		</p><section class="section" id="con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.1. How Keylime works</h3></div></div></div><p>
				You can configure Keylime agents to perform one or more of the following actions:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Runtime integrity monitoring</span></dt><dd>
							Keylime runtime integrity monitoring continuously monitors the system on which the agent is deployed and measures the integrity of the files included in the allowlist and not included in the excludelist.
						</dd><dt><span class="term">Measured boot</span></dt><dd>
							Keylime measured boot verifies the system state at boot.
						</dd></dl></div><p>
				Keylime’s concept of trust is based on the Trusted Platform Module (TPM) technology. A TPM is a hardware, firmware, or virtual component with integrated cryptographic keys. By polling TPM quotes and comparing the hashes of objects, Keylime provides initial and runtime monitoring of remote systems.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Keylime running in a virtual machine or using a virtual TPM depends upon the integrity of the underlying host. Ensure you trust the host environment before relying upon Keylime measurements in a virtual environment.
				</p></div></rh-alert><p>
				Keylime consists of three main components:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Verifier</span></dt><dd>
							Initially and continuously verifies the integrity of the systems that run the agent. You can deploy the verifier from a package, as a container, or by usign the <code class="literal">keylime_server</code> RHEL system role.
						</dd><dt><span class="term">Registrar</span></dt><dd>
							Contains a database of all agents and it hosts the public keys of the TPM vendors. You can deploy the registrar from a package, as a container, or by usign the <code class="literal">keylime_server</code> RHEL system role.
						</dd><dt><span class="term">Agent</span></dt><dd>
							Deployed to remote systems measured by the verifier.
						</dd></dl></div><p>
				In addition, Keylime uses the <code class="literal">keylime_tenant</code> utility for many functions, including provisioning the agents on the target systems.
			</p><div class="figure" id="idm140081371716128"><p class="title"><strong>Figure 7.1. Connections between Keylime components through configurations</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/100eed5bc2bbc3a8b24265dda8d072f6/sec-keylime_conf_connections.png" alt="The Keylime components are connected through their configuration options."></div></div></div><p>
				Keylime ensures the integrity of the monitored systems in a chain of trust by using keys and certificates exchanged between the components and the tenant. For a secure foundation of this chain, use a certificate authority (CA) that you can trust.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If the agent receives no key and certificate, it generates a key and a self-signed certificate with no involvement from the CA.
				</p></div></rh-alert><div class="figure" id="idm140081370442144"><p class="title"><strong>Figure 7.2. Connections between Keylime components certificates and keys</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/e695e1a133c9234d5df07fbf5fc912c5/sec-keylime_cert_connections.png" alt="The Keylime components are connected through the keys and certificates."></div></div></div></section><section class="section" id="configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.2. Deploying Keylime verifier from a package</h3></div></div></div><p>
				The verifier is the most important component in Keylime. It performs initial and periodic checks of system integrity and supports bootstrapping a cryptographic key securely with the agent. The verifier uses mutual TLS encryption for its control interface.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					To maintain the chain of trust, keep the system that runs the verifier secure and under your control.
				</p></div></rh-alert><p>
				You can install the verifier on a separate system or on the same system as the Keylime registrar, depending on your requirements. Running the verifier and registrar on separate systems provides better performance.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To keep the configuration files organized within the drop-in directories, use file names with a two-digit number prefix, for example <code class="literal">/etc/keylime/verifier.conf.d/00-verifier-ip.conf</code>. The configuration processing reads the files inside the drop-in directory in lexicographic order and sets each option to the last value it reads.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> permissions and network connection to the system or systems on which you want to install Keylime components.
					</li><li class="listitem">
						You have valid keys and certificates from your certificate authority.
					</li><li class="listitem"><p class="simpara">
						Optional: You have access to the databases where Keylime saves data from the verifier. You can use any of the following database management systems:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								SQLite (default)
							</li><li class="listitem">
								PostgreSQL
							</li><li class="listitem">
								MySQL
							</li><li class="listitem">
								MariaDB
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the Keylime verifier:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install keylime-verifier</strong></span></pre></li><li class="listitem"><p class="simpara">
						Define the IP address and port of verifier by creating a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/verifier.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/verifier.conf.d/00-verifier-ip.conf</code>, with the following content:
					</p><pre class="screen"><span class="strong strong"><strong>[verifier]</strong></span>
<span class="strong strong"><strong>ip = <span class="emphasis"><em>&lt;verifier_IP_address&gt;</em></span></strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;verifier_IP_address&gt;</em></span></code> with the verifier’s IP address. Alternatively, use <code class="literal">ip = *</code> or <code class="literal">ip = 0.0.0.0</code> to bind the verifier to all available IP addresses.
							</li><li class="listitem">
								Optionally, you can also change the verifier’s port from the default value <code class="literal">8881</code> by using the <code class="literal">port</code> option.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: Configure the verifier’s database for the list of agents. The default configuration uses an SQLite database in the verifier’s <code class="literal">/var/lib/keylime/cv_data.sqlite/</code> directory. You can define a different database by creating a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/verifier.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/verifier.conf.d/00-db-url.conf</code>, with the following content:
					</p><pre class="screen">[verifier]
database_url = <span class="emphasis"><em>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;</em></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;</em></span></code> with the URL of the database, for example, <code class="literal">postgresql://verifier:UQ?nRNY9g7GZzN7@198.51.100.1/verifierdb</code>.
					</p><p class="simpara">
						Ensure that the credentials you use provide the permissions for Keylime to create the database structure.
					</p></li><li class="listitem"><p class="simpara">
						Add certificates and keys to the verifier. You can either let Keylime generate them, or use existing keys and certificates:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								With the default <code class="literal">tls_dir = generate</code> option, Keylime generates new certificates for the verifier, registrar, and tenant in the <code class="literal">/var/lib/keylime/cv_ca/</code> directory.
							</li><li class="listitem"><p class="simpara">
								To load existing keys and certificates in the configuration, define their location in the verifier configuration. The certificates must be accessible by the <code class="literal">keylime</code> user, under which the Keylime services are running.
							</p><p class="simpara">
								Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/verifier.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/verifier.conf.d/00-keys-and-certs.conf</code>, with the following content:
							</p><pre class="screen">[verifier]
tls_dir = /var/lib/keylime/cv_ca
server_key = <span class="emphasis"><em>&lt;/path/to/server_key&gt;</em></span>
server_key_password = <span class="emphasis"><em>&lt;passphrase1&gt;</em></span>
server_cert = <span class="emphasis"><em>&lt;/path/to/server_cert&gt;</em></span>
trusted_client_ca = ['<span class="emphasis"><em>&lt;/path/to/ca/cert1&gt;</em></span>', '<span class="emphasis"><em>&lt;/path/to/ca/cert2&gt;</em></span>']
client_key = <span class="emphasis"><em>&lt;/path/to/client_key&gt;</em></span>
client_key_password = <span class="emphasis"><em>&lt;passphrase2&gt;</em></span>
client_cert = <span class="emphasis"><em>&lt;/path/to/client_cert&gt;</em></span>
trusted_server_ca = ['<span class="emphasis"><em>&lt;/path/to/ca/cert3&gt;</em></span>', '<span class="emphasis"><em>&lt;/path/to/ca/cert4&gt;</em></span>']</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Use absolute paths to define key and certificate locations. Alternatively, relative paths are resolved from the directory defined in the <code class="literal">tls_dir</code> option.
								</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
						Open the port in firewall:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-port 8881/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre><p class="simpara">
						If you use a different port, replace <code class="literal">8881</code> with the port number defined in the <code class="literal">.conf</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Start the verifier service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now keylime_verifier</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							In the default configuration, start the <code class="literal">keylime_verifier</code> before starting the <code class="literal">keylime_registrar</code> service because the verifier creates the CA and certificates for the other Keylime components. This order is not necessary when you use custom certificates.
						</p></div></rh-alert></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">keylime_verifier</code> service is active and running:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status keylime_verifier</strong></span>
● keylime_verifier.service - The Keylime verifier
     Loaded: loaded (/usr/lib/systemd/system/keylime_verifier.service; disabled; vendor preset: disabled)
     Active: active (running) since Wed 2022-11-09 10:10:08 EST; 1min 45s ago</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime" title="7.4. Deploying Keylime registrar from a package">Section 7.4, “Deploying Keylime registrar from a package”</a>.
					</li></ul></div></section><section class="section" id="configuring-keylime-verifier-as-a-container_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.3. Deploying Keylime verifier as a container</h3></div></div></div><p>
				The Keylime verifier performs initial and periodic checks of system integrity and supports bootstrapping a cryptographic key securely with the agent. You can configure the Keylime verifier as a container instead of the RPM method, without any binaries or packages on the host. The container deployment provides better isolation, modularity, and reproducibility of Keylime components.
			</p><p>
				After you start the container, the Keylime verifier is deployed with default configuration files. You can customize the configuration by using one or more of following methods:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Mounting the host’s directories that contain the configuration files to the container. This is available in all versions of RHEL 9.
					</li><li class="listitem">
						Modifying the environment variables directly on the container. This is available in RHEL 9.3 and later versions. Modifying the environment variables overrides the values from the configuration files.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">podman</code> package and its dependencies are installed on the system.
					</li><li class="listitem"><p class="simpara">
						Optional: You have access to a database where Keylime saves data from the verifier. You can use any of the following database management systems:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								SQLite (default)
							</li><li class="listitem">
								PostgreSQL
							</li><li class="listitem">
								MySQL
							</li><li class="listitem">
								MariaDB
							</li></ul></div></li><li class="listitem">
						You have valid keys and certificates from your certificate authority.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Install the <code class="literal">keylime-verifier</code> package to access the configuration files. You can configure the container without this package, but it might be easier to modify the configuration files provided with the package.
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install keylime-verifier</strong></span></pre></li><li class="listitem"><p class="simpara">
						Bind the verifier to all available IP addresses by creating a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/verifier.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/verifier.conf.d/00-verifier-ip.conf</code>, with the following content:
					</p><pre class="screen">[verifier]
ip = *</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Optionally, you can also change the verifier’s port from the default value <code class="literal">8881</code> by using the <code class="literal">port</code> option.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: Configure the verifier’s database for the list of agents. The default configuration uses an SQLite database in the verifier’s <code class="literal">/var/lib/keylime/cv_data.sqlite/</code> directory. You can define a different database by creating a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/verifier.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/verifier.conf.d/00-db-url.conf</code>, with the following content:
					</p><pre class="screen">[verifier]
database_url = <span class="emphasis"><em>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;</em></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;</em></span></code> with the URL of the database, for example, <code class="literal">postgresql://verifier:UQ?nRNY9g7GZzN7@198.51.100.1/verifierdb</code>.
					</p><p class="simpara">
						Ensure that the credentials you use have the permissions for Keylime to create the database structure.
					</p></li><li class="listitem"><p class="simpara">
						Add certificates and keys to the verifier. You can either let Keylime generate them, or use existing keys and certificates:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								With the default <code class="literal">tls_dir = generate</code> option, Keylime generates new certificates for the verifier, registrar, and tenant in the <code class="literal">/var/lib/keylime/cv_ca/</code> directory.
							</li><li class="listitem"><p class="simpara">
								To load existing keys and certificates in the configuration, define their location in the verifier configuration. The certificates must be accessible by the <code class="literal">keylime</code> user, under which the Keylime processes are running.
							</p><p class="simpara">
								Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/verifier.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/verifier.conf.d/00-keys-and-certs.conf</code>, with the following content:
							</p><pre class="screen">[verifier]
tls_dir = /var/lib/keylime/cv_ca
server_key = <span class="emphasis"><em>&lt;/path/to/server_key&gt;</em></span>
server_cert = <span class="emphasis"><em>&lt;/path/to/server_cert&gt;</em></span>
trusted_client_ca = ['<span class="emphasis"><em>&lt;/path/to/ca/cert1&gt;</em></span>', '<span class="emphasis"><em>&lt;/path/to/ca/cert2&gt;</em></span>']
client_key = <span class="emphasis"><em>&lt;/path/to/client_key&gt;</em></span>
client_cert = <span class="emphasis"><em>&lt;/path/to/client_cert&gt;</em></span>
trusted_server_ca = ['<span class="emphasis"><em>&lt;/path/to/ca/cert3&gt;</em></span>', '<span class="emphasis"><em>&lt;/path/to/ca/cert4&gt;</em></span>']</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Use absolute paths to define key and certificate locations. Alternatively, relative paths are resolved from the directory defined in the <code class="literal">tls_dir</code> option.
								</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
						Open the port in firewall:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-port 8881/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre><p class="simpara">
						If you use a different port, replace <code class="literal">8881</code> with the port number defined in the <code class="literal">.conf</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Run the container:
					</p><pre class="screen">$ <span class="strong strong"><strong>podman run --name keylime-verifier \</strong></span>
  <span class="strong strong"><strong>-p 8881:8881 \</strong></span>
  <span class="strong strong"><strong>-v /etc/keylime/verifier.conf.d:/etc/keylime/verifier.conf.d:Z \</strong></span>
  <span class="strong strong"><strong>-v /var/lib/keylime/cv_ca:/var/lib/keylime/cv_ca:Z \</strong></span>
  <span class="strong strong"><strong>-d \</strong></span>
  <span class="strong strong"><strong>-e KEYLIME_VERIFIER_SERVER_KEY_PASSWORD=<span class="emphasis"><em>&lt;passphrase1&gt;</em></span> \</strong></span>
  <span class="strong strong"><strong>-e KEYLIME_VERIFIER_CLIENT_KEY_PASSWORD=<span class="emphasis"><em>&lt;passphrase2&gt;</em></span> \</strong></span>
  <span class="strong strong"><strong>registry.access.redhat.com/rhel9/keylime-verifier</strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">-p</code> option opens the default port <code class="literal">8881</code> on the host and on the container.
							</li><li class="listitem"><p class="simpara">
								The <code class="literal">-v</code> option creates a bind mount for the directory to the container.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										With the <code class="literal">Z</code> option, Podman marks the content with a private unshared label. This means only the current container can use the private volume.
									</li></ul></div></li><li class="listitem">
								The <code class="literal">-d</code> option runs the container detached and in the background.
							</li><li class="listitem">
								The option <code class="literal">-e KEYLIME_VERIFIER_SERVER_KEY_PASSWORD=<span class="emphasis"><em>&lt;passphrase1&gt;</em></span></code> defines the server key passphrase.
							</li><li class="listitem">
								The option <code class="literal">-e KEYLIME_VERIFIER_CLIENT_KEY_PASSWORD=<span class="emphasis"><em>&lt;passphrase2&gt;</em></span></code> defines the client key passphrase.
							</li><li class="listitem">
								You can override configuration options with environment variables by using the option <code class="literal">-e KEYLIME_VERIFIER<span class="emphasis"><em>_&lt;ENVIRONMENT_VARIABLE&gt;</em></span>=<span class="emphasis"><em>&lt;value&gt;</em></span></code>. To modify additional options, insert the <code class="literal">-e</code> option separately for each environment variable. For a complete list of environment variables and their default values, see <a class="link" href="#keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime" title="7.12. Keylime environment variables">Keylime environment variables</a>.
							</li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that the container is running:
					</p><pre class="screen white-space-pre white-space-pre">$ <span class="strong strong"><strong>podman ps -a</strong></span>
CONTAINER ID  IMAGE                                                     COMMAND           CREATED         STATUS         PORTS                   NAMES
80b6b9dbf57c  registry.access.redhat.com/rhel9/keylime-verifier:latest  keylime_verifier  14 seconds ago  Up 14 seconds  0.0.0.0:8881-&gt;8881/tcp  keylime-verifier</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#configuring-keylime-registrar-as-a-container_assembly_ensuring-system-integrity-with-keylime" title="7.5. Deploying Keylime registrar as a container">Install the Keylime registrar as a container</a>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information about Keylime components, see <a class="link" href="#con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime" title="7.1. How Keylime works">How Keylime works</a>.
					</li><li class="listitem">
						For more information about configuring the Keylime verifier, see <a class="link" href="#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime" title="7.2. Deploying Keylime verifier from a package">Configuring Keylime verifier</a>.
					</li><li class="listitem">
						For more information about the <code class="literal">podman run</code> command, see the <code class="literal">podman-run(1)</code> man page on your system.
					</li></ul></div></section><section class="section" id="configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.4. Deploying Keylime registrar from a package</h3></div></div></div><p>
				The registrar is the Keylime component that contains a database of all agents, and it hosts the public keys of the TPM vendors. After the registrar’s HTTPS service accepts trusted platform module (TPM) public keys, it presents an interface to obtain these public keys for checking quotes.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					To maintain the chain of trust, keep the system that runs the registrar secure and under your control.
				</p></div></rh-alert><p>
				You can install the registrar on a separate system or on the same system as the Keylime verifier, depending on your requirements. Running the verifier and registrar on separate systems provides better performance.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To keep the configuration files organized within the drop-in directories, use file names with a two-digit number prefix, for example <code class="literal">/etc/keylime/registrar.conf.d/00-registrar-ip.conf</code>. The configuration processing reads the files inside the drop-in directory in lexicographic order and sets each option to the last value it reads.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have network access to the systems where the Keylime verifier is installed and running. For more information, see <a class="xref" href="#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime" title="7.2. Deploying Keylime verifier from a package">Section 7.2, “Deploying Keylime verifier from a package”</a>.
					</li><li class="listitem">
						You have <code class="literal">root</code> permissions and network connection to the system or systems on which you want to install Keylime components.
					</li><li class="listitem"><p class="simpara">
						You have access to the database where Keylime saves data from the registrar. You can use any of the following database management systems:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								SQLite (default)
							</li><li class="listitem">
								PostgreSQL
							</li><li class="listitem">
								MySQL
							</li><li class="listitem">
								MariaDB
							</li></ul></div></li><li class="listitem">
						You have valid keys and certificates from your certificate authority.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the Keylime registrar:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install keylime-registrar</strong></span></pre></li><li class="listitem"><p class="simpara">
						Define the IP address and port of the registrar by creating a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/registrar.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/registrar.conf.d/00-registrar-ip.conf</code>, with the following content:
					</p><pre class="screen">[registrar]
ip = <span class="emphasis"><em>&lt;registrar_IP_address&gt;</em></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;registrar_IP_address&gt;</em></span></code> with the registrar’s IP address. Alternatively, use <code class="literal">ip = *</code> or <code class="literal">ip = 0.0.0.0</code> to bind the registrar to all available IP addresses.
							</li><li class="listitem">
								Optionally, change the port to which the Keylime agents connect by using the <code class="literal">port</code> option. The default value is <code class="literal">8890</code>.
							</li><li class="listitem">
								Optionally, change the TLS port to which the Keylime verifier and tenant connect by using the <code class="literal">tls_port</code> option. The default value is <code class="literal">8891</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: Configure the registrar’s database for the list of agents. The default configuration uses an SQLite database in the registrar’s <code class="literal">/var/lib/keylime/reg_data.sqlite</code> directory. You can create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/registrar.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/registrar.conf.d/00-db-url.conf</code>, with the following content:
					</p><pre class="screen">[registrar]
database_url = <span class="emphasis"><em>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;</em></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;</em></span></code> with the URL of the database, for example, <code class="literal">postgresql://registrar:EKYYX-bqY2?#raXm@198.51.100.1/registrardb</code>.
					</p><p class="simpara">
						Ensure that the credentials you use have the permissions for Keylime to create the database structure.
					</p></li><li class="listitem"><p class="simpara">
						Add certificates and keys to the registrar:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								You can use the default configuration and load the keys and certificates to the <code class="literal">/var/lib/keylime/reg_ca/</code> directory.
							</li><li class="listitem"><p class="simpara">
								Alternatively, you can define the location of the keys and certificates in the configuration. Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/registrar.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/registrar.conf.d/00-keys-and-certs.conf</code>, with the following content:
							</p><pre class="screen">[registrar]
tls_dir = /var/lib/keylime/reg_ca
server_key = <span class="emphasis"><em>&lt;/path/to/server_key&gt;</em></span>
server_key_password = <span class="emphasis"><em>&lt;passphrase1&gt;</em></span>
server_cert = <span class="emphasis"><em>&lt;/path/to/server_cert&gt;</em></span>
trusted_client_ca = ['<span class="emphasis"><em>&lt;/path/to/ca/cert1&gt;</em></span>', '<span class="emphasis"><em>&lt;/path/to/ca/cert2&gt;</em></span>']</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Use absolute paths to define key and certificate locations. Alternatively, you can define a directory in the <code class="literal">tls_dir</code> option and use paths relative to that directory.
								</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
						Open the ports in firewall:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-port 8890/tcp --add-port 8891/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre><p class="simpara">
						If you use a different port, replace <code class="literal">8890</code> or <code class="literal">8891</code> with the port number defined in the <code class="literal">.conf</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">keylime_registrar</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now keylime_registrar</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							In the default configuration, start the <code class="literal">keylime_verifier</code> before starting the <code class="literal">keylime_registrar</code> service because the verifier creates the CA and certificates for the other Keylime components. This order is not necessary when you use custom certificates.
						</p></div></rh-alert></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">keylime_registrar</code> service is active and running:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status keylime_registrar</strong></span>
● keylime_registrar.service - The Keylime registrar service
     Loaded: loaded (/usr/lib/systemd/system/keylime_registrar.service; disabled; vendor preset: disabled)
     Active: active (running) since Wed 2022-11-09 10:10:17 EST; 1min 42s ago
...</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime" title="7.8. Deploying Keylime tenant from a package">Section 7.8, “Deploying Keylime tenant from a package”</a>
					</li></ul></div></section><section class="section" id="configuring-keylime-registrar-as-a-container_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.5. Deploying Keylime registrar as a container</h3></div></div></div><p>
				The registrar is the Keylime component that contains a database of all agents, and it hosts the public keys of the trusted platform module (TPM) vendors. After the registrar’s HTTPS service accepts TPM public keys, it presents an interface to obtain these public keys for checking quotes. You can configure the Keylime registrar as a container instead of the RPM method, without any binaries or packages on the host. The container deployment provides better isolation, modularity, and reproducibility of Keylime components.
			</p><p>
				After you start the container, the Keylime registrar is deployed with default configuration files. You can customize the configuration by using one or more of following methods:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Mounting the host’s directories that contain the configuration files to the container. This is available in all versions of RHEL 9.
					</li><li class="listitem">
						Modifying the environment variables directly on the container. This is available in RHEL 9.3 and later versions. Modifying the environment variables overrides the values from the configuration files.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">podman</code> package and its dependencies are installed on the system.
					</li><li class="listitem"><p class="simpara">
						Optional: You have access to a database where Keylime saves data from the registrar. You can use any of the following database management systems:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								SQLite (default)
							</li><li class="listitem">
								PostgreSQL
							</li><li class="listitem">
								MySQL
							</li><li class="listitem">
								MariaDB
							</li></ul></div></li><li class="listitem">
						You have valid keys and certificates from your certificate authority.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Install the <code class="literal">keylime-registrar</code> package to access the configuration files. You can configure the container without this package, but it might be easier to modify the configuration files provided with the package.
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install keylime-registrar</strong></span></pre></li><li class="listitem"><p class="simpara">
						Bind the registrar to all available IP addresses by creating a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/registrar.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/registrar.conf.d/00-registrar-ip.conf</code>, with the following content:
					</p><pre class="screen">[registrar]
ip = *</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Optionally, change the port to which the Keylime agents connect by using the <code class="literal">port</code> option. The default value is <code class="literal">8890</code>.
							</li><li class="listitem">
								Optionally, change the TLS port to which the Keylime tenant connects by using the <code class="literal">tls_port</code> option. The default value is <code class="literal">8891</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: Configure the registrar’s database for the list of agents. The default configuration uses an SQLite database in the registrar’s <code class="literal">/var/lib/keylime/reg_data.sqlite</code> directory. You can create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/registrar.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/registrar.conf.d/00-db-url.conf</code>, with the following content:
					</p><pre class="screen">[registrar]
database_url = <span class="emphasis"><em>&amp;lt;protocol&amp;gt;://&amp;lt;name&amp;gt;:&amp;lt;password&amp;gt;@&amp;lt;ip_address_or_hostname&amp;gt;/&amp;lt;properties&amp;gt;</em></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;</em></span></code> with the URL of the database, for example, <code class="literal">postgresql://registrar:EKYYX-bqY2?#raXm@198.51.100.1/registrardb</code>.
					</p><p class="simpara">
						Ensure that the credentials you use have the permissions for Keylime to create the database structure.
					</p></li><li class="listitem"><p class="simpara">
						Add certificates and keys to the registrar:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								You can use the default configuration and load the keys and certificates to the <code class="literal">/var/lib/keylime/reg_ca/</code> directory.
							</li><li class="listitem"><p class="simpara">
								Alternatively, you can define the location of the keys and certificates in the configuration. Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/registrar.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/registrar.conf.d/00-keys-and-certs.conf</code>, with the following content:
							</p><pre class="screen">[registrar]
tls_dir = /var/lib/keylime/reg_ca
server_key = <span class="emphasis"><em>&amp;lt;/path/to/server_key&amp;gt;</em></span>
server_cert = <span class="emphasis"><em>&amp;lt;/path/to/server_cert&amp;gt;</em></span>
trusted_client_ca = ['<span class="emphasis"><em>&amp;lt;/path/to/ca/cert1&amp;gt;</em></span>', '<span class="emphasis"><em>&amp;lt;/path/to/ca/cert2&amp;gt;</em></span>']</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Use absolute paths to define key and certificate locations. Alternatively, you can define a directory in the <code class="literal">tls_dir</code> option and use paths relative to that directory.
								</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
						Open the ports in firewall:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-port 8890/tcp --add-port 8891/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre><p class="simpara">
						If you use a different port, replace <code class="literal">8890</code> or <code class="literal">8891</code> with the port number defined in the <code class="literal">.conf</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Run the container:
					</p><pre class="screen">$ <span class="strong strong"><strong>podman run --name keylime-registrar \</strong></span>
  <span class="strong strong"><strong>-p 8890:8890 \</strong></span>
  <span class="strong strong"><strong>-p 8891:8891 \</strong></span>
  <span class="strong strong"><strong>-v /etc/keylime/registrar.conf.d:/etc/keylime/registrar.conf.d:Z \</strong></span>
  <span class="strong strong"><strong>-v /var/lib/keylime/reg_ca:/var/lib/keylime/reg_ca:Z \</strong></span>
  <span class="strong strong"><strong>-d \</strong></span>
  <span class="strong strong"><strong>-e KEYLIME_REGISTRAR_SERVER_KEY_PASSWORD=<span class="emphasis"><em>&amp;lt;passphrase1&amp;gt;</em></span> \</strong></span>
  <span class="strong strong"><strong>registry.access.redhat.com/rhel9/keylime-registrar</strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">-p</code> option opens the default ports <code class="literal">8890</code> and <code class="literal">8881</code> on the host and on the container.
							</li><li class="listitem"><p class="simpara">
								The <code class="literal">-v</code> option creates a bind mount for the directory to the container.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										With the <code class="literal">Z</code> option, Podman marks the content with a private unshared label. This means only the current container can use the private volume.
									</li></ul></div></li><li class="listitem">
								The <code class="literal">-d</code> option runs the container detached and in the background.
							</li><li class="listitem">
								The option <code class="literal">-e KEYLIME_VERIFIER_SERVER_KEY_PASSWORD=<span class="emphasis"><em>&lt;passphrase1&gt;</em></span></code> defines the server key passphrase.
							</li><li class="listitem">
								You can override configuration options with environment variables by using the option <code class="literal">-e KEYLIME_REGISTRAR<span class="emphasis"><em>_&lt;ENVIRONMENT_VARIABLE&gt;</em></span>=<span class="emphasis"><em>&lt;value&gt;</em></span></code>. To modify additional options, insert the <code class="literal">-e</code> option separately for each environment variable. For a complete list of environment variables and their default values, see <a class="xref" href="#keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime" title="7.12. Keylime environment variables">Section 7.12, “Keylime environment variables”</a>.
							</li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that the container is running:
					</p><pre class="screen">$ <span class="strong strong"><strong>podman ps -a</strong></span>
CONTAINER ID  IMAGE                               COMMAND            CREATED             STATUS             PORTS                                           NAMES
07d4b4bff1b6  localhost/keylime-registrar:latest  keylime_registrar  12 seconds ago      Up 12 seconds      0.0.0.0:8881-&gt;8881/tcp, 0.0.0.0:8891-&gt;8891/tcp  keylime-registrar</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="xref" href="#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime" title="7.8. Deploying Keylime tenant from a package">Section 7.8, “Deploying Keylime tenant from a package”</a>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information about Keylime components, see <a class="xref" href="#con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime" title="7.1. How Keylime works">Section 7.1, “How Keylime works”</a>.
					</li><li class="listitem">
						For more information about configuring the Keylime registrar, see <a class="xref" href="#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime" title="7.4. Deploying Keylime registrar from a package">Section 7.4, “Deploying Keylime registrar from a package”</a>.
					</li><li class="listitem">
						For more information about the <code class="literal">podman run</code> command, see the <code class="literal">podman-run(1)</code> man page on your system.
					</li></ul></div></section><section class="section" id="proc_setting-keylime-server-using-system-roles_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.6. Deploying a Keylime server by using RHEL system roles</h3></div></div></div><p>
				You can set up the verifier and registrar, which are the Keylime server components, by using the <code class="literal">keylime_server</code> RHEL system role. The <code class="literal">keylime_server</code> role installs and configures both the verifier and registrar components together on each node.
			</p><p>
				Perform this procedure on the Ansible control node.
			</p><p>
				For more information about Keylime, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/assembly_ensuring-system-integrity-with-keylime_security-hardening#con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime">8.1. How Keylime works</a>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes or groups of managed nodes on which you want to run this playbook are listed in the Ansible inventory file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook that defines the required role:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a new YAML file and open it in a text editor, for example:
							</p><pre class="screen"># <span class="strong strong"><strong>vi keylime-playbook.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
								Insert the following content:
							</p><pre class="screen">---
- name: Manage keylime servers
  hosts: all
  vars:
    keylime_server_verifier_ip: "{{ ansible_host }}"
    keylime_server_registrar_ip: "{{ ansible_host }}"
    keylime_server_verifier_tls_dir: <span class="emphasis"><em>&lt;ver_tls_directory</em></span>&gt;
    keylime_server_verifier_server_cert: <span class="emphasis"><em>&lt;ver_server_certfile</em></span>&gt;
    keylime_server_verifier_server_key: <span class="emphasis"><em>&lt;ver_server_key</em></span>&gt;
    keylime_server_verifier_server_key_passphrase: <span class="emphasis"><em>&lt;ver_server_key_passphrase</em></span>&gt;
    keylime_server_verifier_trusted_client_ca: <span class="emphasis"><em>&lt;ver_trusted_client_ca_list</em></span>&gt;
    keylime_server_verifier_client_cert: <span class="emphasis"><em>&lt;ver_client_certfile</em></span>&gt;
    keylime_server_verifier_client_key: <span class="emphasis"><em>&lt;ver_client_key</em></span>&gt;
    keylime_server_verifier_client_key_passphrase: <span class="emphasis"><em>&lt;ver_client_key_passphrase</em></span>&gt;
    keylime_server_verifier_trusted_server_ca: <span class="emphasis"><em>&lt;ver_trusted_server_ca_list</em></span>&gt;
    keylime_server_registrar_tls_dir: <span class="emphasis"><em>&lt;reg_tls_directory</em></span>&gt;
    keylime_server_registrar_server_cert: <span class="emphasis"><em>&lt;reg_server_certfile</em></span>&gt;
    keylime_server_registrar_server_key: <span class="emphasis"><em>&lt;reg_server_key</em></span>&gt;
    keylime_server_registrar_server_key_passphrase: <span class="emphasis"><em>&lt;reg_server_key_passphrase</em></span>&gt;
    keylime_server_registrar_trusted_client_ca: <span class="emphasis"><em>&lt;reg_trusted_client_ca_list</em></span>&gt;
  roles:
    - rhel-system-roles.keylime_server</pre><p class="simpara">
								You can find out more about the variables in <a class="link" href="#ref_variables-for-keylime-server-system-role_assembly_ensuring-system-integrity-with-keylime" title="7.7. Variables for the keylime_server RHEL system role">Variables for the keylime_server RHEL system role</a>.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>&lt;keylime-playbook.yml&gt;</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">keylime_verifier</code> service is active and running on the managed host:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status keylime_verifier</strong></span>
● keylime_verifier.service - The Keylime verifier
     Loaded: loaded (/usr/lib/systemd/system/keylime_verifier.service; disabled; vendor preset: disabled)
     Active: active (running) since Wed 2022-11-09 10:10:08 EST; 1min 45s ago</pre></li><li class="listitem"><p class="simpara">
						Check that the <code class="literal">keylime_registrar</code> service is active and running:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status keylime_registrar</strong></span>
● keylime_registrar.service - The Keylime registrar service
     Loaded: loaded (/usr/lib/systemd/system/keylime_registrar.service; disabled; vendor preset: disabled)
     Active: active (running) since Wed 2022-11-09 10:10:17 EST; 1min 42s ago
...</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
					<a class="xref" href="#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime" title="7.8. Deploying Keylime tenant from a package">Section 7.8, “Deploying Keylime tenant from a package”</a>
				</p></div></section><section class="section" id="ref_variables-for-keylime-server-system-role_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.7. Variables for the keylime_server RHEL system role</h3></div></div></div><p>
				When setting up a Keylime server by using the <code class="literal">keylime_server</code> RHEL system role, you can customize the following variables for registrar and verifier.
			</p><div class="variablelist"><p class="title"><strong>List of <code class="literal">keylime_server</code> RHEL system role variables for configuring the Keylime verifier</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">keylime_server_verifier_ip</code></span></dt><dd>
							Defines the IP address of the verifier.
						</dd><dt><span class="term"><code class="literal">keylime_server_verifier_tls_dir</code></span></dt><dd>
							Specifies the directory where the keys and certificates are stored. If set to default, the verifier uses the <code class="literal">/var/lib/keylime/cv_ca</code> directory.
						</dd><dt><span class="term"><code class="literal">keylime_server_verifier_server_key_passphrase</code></span></dt><dd>
							Specifies a passphrase to decrypt the server private key. If the value is empty, the private key is not encrypted.
						</dd></dl></div><p>
				<code class="literal">keylime_server_verifier_server_cert</code>: Specifies the Keylime verifier server certificate file.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">keylime_server_verifier_trusted_client_ca</code></span></dt><dd>
							Defines the list of trusted client CA certificates. You must store the files in the directory set in the <code class="literal">keylime_server_verifier_tls_dir</code> option.
						</dd><dt><span class="term"><code class="literal">keylime_server_verifier_client_key</code></span></dt><dd>
							Defines the file containing the Keylime verifier private client key.
						</dd><dt><span class="term"><code class="literal">keylime_server_verifier_client_key_passphrase</code></span></dt><dd>
							Defines the passphrase to decrypt the client private key file. If the value is empty, the private key is not encrypted.
						</dd><dt><span class="term"><code class="literal">keylime_server_verifier_client_cert</code></span></dt><dd>
							Defines the Keylime verifier client certificate file.
						</dd><dt><span class="term"><code class="literal">keylime_server_verifier_trusted_server_ca</code></span></dt><dd>
							Defines the list of trusted server CA certificates. You must store the files in the directory set in the <code class="literal">keylime_server_verifier_tls_dir</code> option.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>List of registrar variables for setting up keylime_server RHEL system role</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">keylime_server_registrar_ip</code></span></dt><dd>
							Defines the IP address of the registrar.
						</dd><dt><span class="term"><code class="literal">keylime_server_registrar_tls_dir</code></span></dt><dd>
							Specifies the directory where you store the keys and certificates for the registrar. If you set it to default, the registrar uses the <code class="literal">/var/lib/keylime/reg_ca</code> directory.
						</dd><dt><span class="term"><code class="literal">keylime_server_registrar_server_key</code></span></dt><dd>
							Defines the Keylime registrar private server key file.
						</dd><dt><span class="term"><code class="literal">keylime_server_registrar_server_key_passphrase</code></span></dt><dd>
							Specifies the passphrase to decrypt the server private key of the registrar. If the value is empty, the private key is not encrypted.
						</dd><dt><span class="term"><code class="literal">keylime_server_registrar_server_cert</code></span></dt><dd>
							Specifies the Keylime registrar server certificate file.
						</dd><dt><span class="term"><code class="literal">keylime_server_registrar_trusted_client_ca</code></span></dt><dd>
							Defines the list of trusted client CA certificates. You must store the files in the directory set in the <code class="literal">keylime_server_registrar_tls_dir</code> option.
						</dd></dl></div></section><section class="section" id="configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.8. Deploying Keylime tenant from a package</h3></div></div></div><p>
				Keylime uses the <code class="literal">keylime_tenant</code> utility for many functions, including provisioning the agents on the target systems. You can install <code class="literal">keylime_tenant</code> on any system, including the systems that run other Keylime components, or on a separate system, depending on your requirements.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> permissions and network connection to the system or systems on which you want to install Keylime components.
					</li><li class="listitem"><p class="simpara">
						You have network access to the systems where the other Keylime components are configured:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Verifier</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime" title="7.2. Deploying Keylime verifier from a package">Section 7.2, “Deploying Keylime verifier from a package”</a>.
								</dd><dt><span class="term">Registrar</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime" title="7.4. Deploying Keylime registrar from a package">Section 7.4, “Deploying Keylime registrar from a package”</a>.
								</dd></dl></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the Keylime tenant:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install keylime-tenant</strong></span></pre></li><li class="listitem"><p class="simpara">
						Define the tenant’s connection to the Keylime verifier by editing the <code class="literal">/etc/keylime/tenant.conf.d/00-verifier-ip.conf</code> file:
					</p><pre class="screen">[tenant]
verifier_ip = <span class="emphasis"><em>&lt;verifier_ip&gt;</em></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;verifier_ip&gt;</em></span></code> with the IP address to the verifier’s system.
							</li><li class="listitem">
								If the verifier uses a different port than the default value <code class="literal">8881</code>, add the <code class="literal">verifier_port = <span class="emphasis"><em>&lt;verifier_port&gt;</em></span></code> setting.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Define the tenant’s connection to the Keylime registrar by editing the <code class="literal">/etc/keylime/tenant.conf.d/00-registrar-ip.conf</code> file:
					</p><pre class="screen">[tenant]
registrar_ip = <span class="emphasis"><em>&lt;registrar_ip&gt;</em></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;registrar_ip&gt;</em></span></code> with the IP address to the registrar’s system.
							</li><li class="listitem">
								If the registrar uses a different port than the default value <code class="literal">8891</code>, add the <code class="literal">registrar_port = <span class="emphasis"><em>&lt;registrar_port&gt;</em></span></code> setting.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Add certificates and keys to the tenant:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								You can use the default configuration and load the keys and certificates to the <code class="literal">/var/lib/keylime/cv_ca</code> directory.
							</li><li class="listitem"><p class="simpara">
								Alternatively, you can define the location of the keys and certificates in the configuration. Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/tenant.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/tenant.conf.d/00-keys-and-certs.conf</code>, with the following content:
							</p><pre class="screen">[tenant]
tls_dir = /var/lib/keylime/cv_ca
client_key = tenant-key.pem
client_key_password = <span class="emphasis"><em>&lt;passphrase1&gt;</em></span>
client_cert = tenant-cert.pem
trusted_server_ca = ['<span class="emphasis"><em>&lt;/path/to/ca/cert&gt;</em></span>']</pre><p class="simpara">
								The <code class="literal">trusted_server_ca</code> parameter accepts paths to the verifier and registrar server CA certificate. You can provide multiple comma-separated paths, for example if the verifier and registrar use different CAs.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Use absolute paths to define key and certificate locations. Alternatively, you can define a directory in the <code class="literal">tls_dir</code> option and use paths relative to that directory.
								</p></div></rh-alert></li></ol></div></li><li class="listitem">
						Optional: If the trusted platform module (TPM) endorsement key (EK) cannot be verified by using certificates in the <code class="literal">/var/lib/keylime/tpm_cert_store</code> directory, add the certificate to that directory. This can occur particularly when using virtual machines with emulated TPMs.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the status of the verifier:
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_tenant -c cvstatus</strong></span>
Reading configuration from ['/etc/keylime/logging.conf']
2022-10-14 12:56:08.155 - keylime.tpm - INFO - TPM2-TOOLS Version: 5.2
Reading configuration from ['/etc/keylime/tenant.conf']
2022-10-14 12:56:08.157 - keylime.tenant - INFO - Setting up client TLS...
2022-10-14 12:56:08.158 - keylime.tenant - INFO - Using default client_cert option for tenant
2022-10-14 12:56:08.158 - keylime.tenant - INFO - Using default client_key option for tenant
2022-10-14 12:56:08.178 - keylime.tenant - INFO - TLS is enabled.
2022-10-14 12:56:08.178 - keylime.tenant - WARNING - Using default UUID d432fbb3-d2f1-4a97-9ef7-75bd81c00000
2022-10-14 12:56:08.221 - keylime.tenant - INFO - Verifier at 127.0.0.1 with Port 8881 does not have agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000.</pre><p class="simpara">
						If correctly set up, and if no agent is configured, the verifier responds that it does not recognize the default agent UUID.
					</p></li><li class="listitem"><p class="simpara">
						Check the status of the registrar:
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_tenant -c regstatus</strong></span>
Reading configuration from ['/etc/keylime/logging.conf']
2022-10-14 12:56:02.114 - keylime.tpm - INFO - TPM2-TOOLS Version: 5.2
Reading configuration from ['/etc/keylime/tenant.conf']
2022-10-14 12:56:02.116 - keylime.tenant - INFO - Setting up client TLS...
2022-10-14 12:56:02.116 - keylime.tenant - INFO - Using default client_cert option for tenant
2022-10-14 12:56:02.116 - keylime.tenant - INFO - Using default client_key option for tenant
2022-10-14 12:56:02.137 - keylime.tenant - INFO - TLS is enabled.
2022-10-14 12:56:02.137 - keylime.tenant - WARNING - Using default UUID d432fbb3-d2f1-4a97-9ef7-75bd81c00000
2022-10-14 12:56:02.171 - keylime.registrar_client - CRITICAL - Error: could not get agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000 data from Registrar Server: 404
2022-10-14 12:56:02.172 - keylime.registrar_client - CRITICAL - Response code 404: agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000 not found
2022-10-14 12:56:02.172 - keylime.tenant - INFO - Agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000 does not exist on the registrar. Please register the agent with the registrar.
2022-10-14 12:56:02.172 - keylime.tenant - INFO - {"code": 404, "status": "Agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000 does not exist on registrar 127.0.0.1 port 8891.", "results": {}}</pre><p class="simpara">
						If correctly set up, and if no agent is configured, the registrar responds that it does not recognize the default agent UUID.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For additional advanced options for the <code class="literal">keylime_tenant</code> utility, enter the <code class="literal">keylime_tenant -h</code> command.
					</li></ul></div></section><section class="section" id="configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.9. Deploying Keylime agent from a package</h3></div></div></div><p>
				The Keylime agent is the component deployed to all systems to be monitored by Keylime.
			</p><p>
				By default, the Keylime agent stores all its data in the <code class="literal">/var/lib/keylime/</code> directory of the monitored system.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To keep the configuration files organized within the drop-in directories, use file names with a two-digit number prefix, for example <code class="literal">/etc/keylime/agent.conf.d/00-registrar-ip.conf</code>. The configuration processing reads the files inside the drop-in directory in lexicographic order and sets each option to the last value it reads.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> permissions to the monitored system.
					</li><li class="listitem">
						The monitored system has a Trusted Platform Module (TPM). To verify, enter the <code class="literal">tpm2_pcrread</code> command. If the output returns several hashes, a TPM is available.
					</li><li class="listitem"><p class="simpara">
						You have network access to the systems where the other Keylime components are configured:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Verifier</span></dt><dd>
									For more information, see <a class="link" href="#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime" title="7.2. Deploying Keylime verifier from a package">Configuring Keylime verifier</a>.
								</dd><dt><span class="term">Registrar</span></dt><dd>
									For more information, see <a class="link" href="#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime" title="7.4. Deploying Keylime registrar from a package">Configuring Keylime registrar</a>.
								</dd><dt><span class="term">Tenant</span></dt><dd>
									For more information, see <a class="link" href="#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime" title="7.8. Deploying Keylime tenant from a package">Configuring Keylime tenant</a>.
								</dd></dl></div></li><li class="listitem">
						Integrity measurement architecture (IMA) is enabled on the monitored system. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel#enabling-integrity-measurement-architecture-and-extended-verification-module_enhancing-security-with-the-kernel-integrity-subsystem">Enabling integrity measurement architecture and extended verification module</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the Keylime agent:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install keylime-agent</strong></span></pre><p class="simpara">
						This command installs the <code class="literal">keylime-agent-rust</code> package.
					</p></li><li class="listitem"><p class="simpara">
						Define the agent’s IP address and port in the configuration files. Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/agent.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/agent.conf.d/00-agent-ip.conf</code>, with the following content:
					</p><pre class="screen">[agent]
ip = '<span class="emphasis"><em>&lt;agent_ip&gt;</em></span>'</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							The Keylime agent configuration uses the TOML format, which is different from the INI format used for configuration of the other components. Therefore, enter values in valid TOML syntax, for example, paths in single quotation marks and arrays of multiple paths in square brackets.
						</p></div></rh-alert><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;agent_IP_address&gt;</em></span></code> with the agent’s IP address. Alternatively, use <code class="literal">ip = '*'</code> or <code class="literal">ip = '0.0.0.0'</code> to bind the agent to all available IP addresses.
							</li><li class="listitem">
								Optionally, you can also change the agent’s port from the default value <code class="literal">9002</code> by using the <code class="literal">port = '<span class="emphasis"><em>&lt;agent_port&gt;</em></span>'</code> option.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Define the registrar’s IP address and port in the configuration files. Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/agent.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/agent.conf.d/00-registrar-ip.conf</code>, with the following content:
					</p><pre class="screen">[agent]
registrar_ip = '<span class="emphasis"><em>&lt;registrar_IP_address&gt;</em></span>'</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;registrar_IP_address&gt;</em></span></code> with the registrar’s IP address.
							</li><li class="listitem">
								Optionally, you can also change the registrar’s port from the default value <code class="literal">8890</code> by using the <code class="literal">registrar_port = '<span class="emphasis"><em>&lt;registrar_port&gt;</em></span>'</code> option.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: Define the agent’s universally unique identifier (UUID). If it is not defined, the default UUID is used. Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/agent.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/agent.conf.d/00-agent-uuid.conf</code>, with the following content:
					</p><pre class="screen">[agent]
uuid = '<span class="emphasis"><em>&lt;agent_UUID&gt;</em></span>'</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;agent_UUID&gt;</em></span></code> with the agent’s UUID, for example <code class="literal">d432fbb3-d2f1-4a97-9ef7-abcdef012345</code>. You can use the <code class="literal">uuidgen</code> utility to generate a UUID.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: Load existing keys and certificates for the agent. If the agent receives no <code class="literal">server_key</code> and <code class="literal">server_cert</code>, it generates its own key and a self-signed certificate.
					</p><p class="simpara">
						Define the location of the keys and certificates in the configuration. Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/keylime/agent.conf.d/</code> directory, for example, <code class="literal">/etc/keylime/agent.conf.d/00-keys-and-certs.conf</code>, with the following content:
					</p><pre class="screen">[agent]
server_key = '<span class="emphasis"><em>&lt;/path/to/server_key&gt;</em></span>'
server_key_password = '<span class="emphasis"><em>&lt;passphrase1&gt;</em></span>'
server_cert = '<span class="emphasis"><em>&lt;/path/to/server_cert&gt;</em></span>'
trusted_client_ca = '[<span class="emphasis"><em>&lt;/path/to/ca/cert3&gt;</em></span>, <span class="emphasis"><em>&lt;/path/to/ca/cert4&gt;</em></span>]'</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Use absolute paths to define key and certificate locations. The Keylime agent does not accept relative paths.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Open the port in firewall:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-port 9002/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre><p class="simpara">
						If you use a different port, replace <code class="literal">9002</code> with the port number defined in the <code class="literal">.conf</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal">keylime_agent</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now keylime_agent</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: From the system where the Keylime tenant is configured, verify that the agent is correctly configured and can connect to the registrar.
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_tenant -c regstatus --uuid <span class="emphasis"><em>&lt;agent_uuid&gt;</em></span></strong></span>
Reading configuration from ['/etc/keylime/logging.conf']
...
==\n-----END CERTIFICATE-----\n", "ip": "127.0.0.1", "port": 9002, "regcount": 1, "operational_state": "Registered"}}}</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Replace <code class="literal"><span class="emphasis"><em>&lt;agent_uuid&gt;</em></span></code> with the agent’s UUID.
							</p><p class="simpara">
								If the registrar and agent are correctly configured, the output displays the agent’s IP address and port, followed by <code class="literal">"operational_state": "Registered"</code>.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Create a new IMA policy by entering the following content into the <code class="literal">/etc/ima/ima-policy</code> file:
					</p><pre class="screen"># PROC_SUPER_MAGIC = 0x9fa0
dont_measure fsmagic=0x9fa0
# SYSFS_MAGIC = 0x62656572
dont_measure fsmagic=0x62656572
# DEBUGFS_MAGIC = 0x64626720
dont_measure fsmagic=0x64626720
# TMPFS_MAGIC = 0x01021994
dont_measure fsmagic=0x1021994
# RAMFS_MAGIC
dont_measure fsmagic=0x858458f6
# DEVPTS_SUPER_MAGIC=0x1cd1
dont_measure fsmagic=0x1cd1
# BINFMTFS_MAGIC=0x42494e4d
dont_measure fsmagic=0x42494e4d
# SECURITYFS_MAGIC=0x73636673
dont_measure fsmagic=0x73636673
# SELINUX_MAGIC=0xf97cff8c
dont_measure fsmagic=0xf97cff8c
# SMACK_MAGIC=0x43415d53
dont_measure fsmagic=0x43415d53
# NSFS_MAGIC=0x6e736673
dont_measure fsmagic=0x6e736673
# EFIVARFS_MAGIC
dont_measure fsmagic=0xde5e81e4
# CGROUP_SUPER_MAGIC=0x27e0eb
dont_measure fsmagic=0x27e0eb
# CGROUP2_SUPER_MAGIC=0x63677270
dont_measure fsmagic=0x63677270
# OVERLAYFS_MAGIC
# when containers are used we almost always want to ignore them
dont_measure fsmagic=0x794c7630
# MEASUREMENTS
measure func=BPRM_CHECK
measure func=FILE_MMAP mask=MAY_EXEC
measure func=MODULE_CHECK uid=0</pre><p class="simpara">
						This policy targets runtime monitoring of executed applications. You can adjust this policy according to your scenario. You can find the MAGIC constants in the <code class="literal">statfs(2)</code> man page on your system.
					</p></li><li class="listitem"><p class="simpara">
						Update kernel parameters:
					</p><pre class="screen"># <span class="strong strong"><strong>grubby --update-kernel DEFAULT --args 'ima_appraise=fix ima_canonical_fmt ima_policy=tcb ima_template=ima-ng'</strong></span></pre></li><li class="listitem">
						Reboot the system to apply the new IMA policy.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the agent is running:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status keylime_agent</strong></span>
● keylime_agent.service - The Keylime compute agent
     Loaded: loaded (/usr/lib/systemd/system/keylime_agent.service; enabled; preset: disabled)
     Active: active (running) since ...</pre></li></ol></div><div class="formalpara"><p class="title"><strong>Next steps</strong></p><p>
					After the agent is configured on all systems you want to monitor, you can deploy Keylime to perform one or both of the following functions:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#proc_deploying-keylime-for-runtime-monitoring_assembly_ensuring-system-integrity-with-keylime" title="7.10. Configuring Keylime for runtime monitoring">Deploying Keylime for runtime monitoring</a>
					</li><li class="listitem">
						<a class="link" href="#proc_deploying-keylime-for-measured-boot-attestation_assembly_ensuring-system-integrity-with-keylime" title="7.11. Configuring Keylime for measured boot attestation">Deploying Keylime for measured boot attestation</a>
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://sourceforge.net/p/linux-ima/wiki/Home/">Integrity Measurement Architecture (IMA) Wiki</a>
					</li></ul></div></section><section class="section" id="proc_deploying-keylime-for-runtime-monitoring_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.10. Configuring Keylime for runtime monitoring</h3></div></div></div><p>
				To verify that the state of monitored systems is correct, the Keylime agent must be running on the monitored systems.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Because Keylime runtime monitoring uses integrity measurement architecture (IMA) to measure large numbers of files, it might have a significant impact on the performance of your system.
				</p></div></rh-alert><p>
				When provisioning the agent, you can also define a file that Keylime sends to the monitored system. Keylime encrypts the file sent to the agent, and decrypts it only if the agent’s system complies with the TPM policy and with the IMA allowlist.
			</p><p>
				You can make Keylime ignore changes of specific files or within specific directories by configuring a Keylime excludelist. The excluded files are still measured by IMA.
			</p><p>
				From Keylime version 7.3.0, provided in RHEL 9.3, the allowlist and excludelist are combined into the Keylime runtime policy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have network access to the systems where the Keylime components are configured:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Verifier</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime" title="7.2. Deploying Keylime verifier from a package">Section 7.2, “Deploying Keylime verifier from a package”</a>.
								</dd><dt><span class="term">Registrar</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime" title="7.4. Deploying Keylime registrar from a package">Section 7.4, “Deploying Keylime registrar from a package”</a>.
								</dd><dt><span class="term">Tenant</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime" title="7.8. Deploying Keylime tenant from a package">Section 7.8, “Deploying Keylime tenant from a package”</a>.
								</dd><dt><span class="term">Agent</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime" title="7.9. Deploying Keylime agent from a package">Section 7.9, “Deploying Keylime agent from a package”</a>.
								</dd></dl></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the monitored system where the Keylime agent is configured and running, generate an allowlist from the current state of the system:
					</p><pre class="screen"># <span class="strong strong"><strong>/usr/share/keylime/scripts/create_allowlist.sh -o <span class="emphasis"><em>&lt;allowlist.txt&gt;</em></span> -h sha256sum</strong></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;allowlist.txt&gt;</em></span></code> with the file name of the allowlist.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Use the SHA-256 hash function. SHA-1 is not secure and has been deprecated in RHEL 9. For additional information, see <a class="link" href="https://access.redhat.com/articles/6846411">SHA-1 deprecation in Red Hat Enterprise Linux 9</a>.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Copy the generated allowlist to the system where the <code class="literal">keylime_tenant</code> utility is configured, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>scp <span class="emphasis"><em>&lt;allowlist.txt&gt;</em></span> root@<span class="emphasis"><em>&lt;tenant</em></span>.<span class="emphasis"><em>ip&gt;</em></span>:/root/<span class="emphasis"><em>&lt;allowlist.txt&gt;</em></span></strong></span></pre></li><li class="listitem">
						Optional: You can define a list of files or directories excluded from Keylime measurements by creating a file on the tenant system and entering the paths of files and directories to exclude. The excludelist accepts Python regular expressions with one regular expression per line. See <a class="link" href="https://docs.python.org/3/library/re.html#regular-expression-syntax">Regular expression operations at docs.python.org</a> for the complete list of special characters. Save the excludelist on the tenant system.
					</li><li class="listitem"><p class="simpara">
						Combine the allowlist and excludelist into the Keylime runtime policy:
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_create_policy -a <span class="emphasis"><em>&lt;allowlist.txt&gt;</em></span> -e <span class="emphasis"><em>&lt;excludelist.txt&gt;</em></span> -o <span class="emphasis"><em>&lt;policy.json&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						On the system where the Keylime tenant is configured, provision the agent by using the <code class="literal">keylime_tenant</code> utility:
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_tenant -c add -t <span class="emphasis"><em>&lt;agent_ip&gt;</em></span> -u <span class="emphasis"><em>&lt;agent_uuid&gt;</em></span> --runtime-policy <span class="emphasis"><em>&lt;policy.json&gt;</em></span> --cert default</strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;agent_ip&gt;</em></span></code> with the agent’s IP address.
							</li><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;agent_uuid&gt;</em></span></code> with the agent’s UUID.
							</li><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;policy.json&gt;</em></span></code> with the path to the Keylime runtime policy file.
							</li><li class="listitem"><p class="simpara">
								With the <code class="literal">--cert</code> option, the tenant generates and signs a certificate for the agent by using the CA certificates and keys located in the specified directory, or the default <code class="literal">/var/lib/keylime/ca/</code> directory. If the directory contains no CA certificates and keys, the tenant will generate them automatically according to the configuration in the <code class="literal">/etc/keylime/ca.conf</code> file and save them to the specified directory. The tenant then sends these keys and certificates to the agent.
							</p><p class="simpara">
								When generating CA certificates or signing agent certificates, you might be prompted for the password to access the CA private key: <code class="literal">Please enter the password to decrypt your keystore:</code>.
							</p><p class="simpara">
								If you do not want to use a certificate, use the <code class="literal">-f</code> option instead for delivering a file to the agent. Provisioning an agent requires sending any file, even an empty file.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Keylime encrypts the file sent to the agent, and decrypts it only if the agent’s system complies with the TPM policy and the IMA allowlist. By default, Keylime decompresses sent <code class="literal">.zip</code> files.
								</p></div></rh-alert></li></ul></div><p class="simpara">
						As an example, with the following command, <code class="literal">keylime_tenant</code> provisions a new Keylime agent at <code class="literal">127.0.0.1</code> with UUID <code class="literal">d432fbb3-d2f1-4a97-9ef7-75bd81c00000</code> and loads a runtime policy <code class="literal">policy.json</code>. It also generates a certificate in the default directory and sends the certificate file to the agent. Keylime decrypts the file only if the TPM policy configured in <code class="literal">/etc/keylime/verifier.conf</code> is satisfied:
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_tenant -c add -t 127.0.0.1 -u d432fbb3-d2f1-4a97-9ef7-75bd81c00000 --runtime-policy policy.json --cert default</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							You can stop Keylime from monitoring a node by using the <code class="literal"># keylime_tenant -c delete -u <span class="emphasis"><em>&lt;agent_uuid&gt;</em></span></code> command.
						</p><p>
							You can modify the configuration of an already registered agent by using the <code class="literal">keylime_tenant -c update</code> command.
						</p></div></rh-alert></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Optional: Reboot the monitored system to verify that the settings are persistent.
					</li><li class="listitem"><p class="simpara">
						Verify a successful attestation of the agent:
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_tenant -c cvstatus -u <span class="emphasis"><em>&lt;agent.uuid&gt;</em></span></strong></span>
...
{"<span class="emphasis"><em>&lt;agent.uuid&gt;</em></span>": {"operational_state": "Get Quote"..."attestation_count": 5
...</pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;agent.uuid&gt;</em></span></code> with the agent’s UUID.
					</p><p class="simpara">
						If the value of <code class="literal">operational_state</code> is <code class="literal">Get Quote</code> and <code class="literal">attestation_count</code> is nonzero, the attestation of this agent is successful.
					</p><p class="simpara">
						If the value of <code class="literal">operational_state</code> is <code class="literal">Invalid Quote</code> or <code class="literal">Failed</code> attestation fails, the command displays output similar to the following:
					</p><pre class="screen">{"<span class="emphasis"><em>&lt;agent.uuid&gt;</em></span>": {"operational_state": "Invalid Quote", ... "ima.validation.ima-ng.not_in_allowlist", "attestation_count": 5, "last_received_quote": 1684150329, "last_successful_attestation": 1684150327}}</pre></li><li class="listitem"><p class="simpara">
						If the attestation fails, display more details in the verifier log:
					</p><pre class="screen"># <span class="strong strong"><strong>journalctl -u keylime_verifier</strong></span>
keylime.tpm - INFO - Checking IMA measurement list...
keylime.ima - WARNING - File not found in allowlist: /root/bad-script.sh
keylime.ima - ERROR - IMA ERRORS: template-hash 0 fnf 1 hash 0 good 781
keylime.cloudverifier - WARNING - agent D432FBB3-D2F1-4A97-9EF7-75BD81C00000 failed, stopping polling</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information about IMA, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel">Enhancing security with the kernel integrity subsystem</a>.
					</li></ul></div></section><section class="section" id="proc_deploying-keylime-for-measured-boot-attestation_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.11. Configuring Keylime for measured boot attestation</h3></div></div></div><p>
				When you configure Keylime for measured boot attestation, Keylime checks that the boot process on the measured system corresponds to the state you defined.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have network access to the systems where the Keylime components are configured:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Verifier</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime" title="7.2. Deploying Keylime verifier from a package">Section 7.2, “Deploying Keylime verifier from a package”</a>.
								</dd><dt><span class="term">Registrar</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime" title="7.4. Deploying Keylime registrar from a package">Section 7.4, “Deploying Keylime registrar from a package”</a>.
								</dd><dt><span class="term">Tenant</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime" title="7.8. Deploying Keylime tenant from a package">Section 7.8, “Deploying Keylime tenant from a package”</a>.
								</dd><dt><span class="term">Agent</span></dt><dd>
									For more information, see <a class="xref" href="#configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime" title="7.9. Deploying Keylime agent from a package">Section 7.9, “Deploying Keylime agent from a package”</a>.
								</dd></dl></div></li><li class="listitem">
						Unified Extensible Firmware Interface (UEFI) is enabled on the agent system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the monitored system where the Keylime agent is configured and running, install the <code class="literal">python3-keylime</code> package, which contains the <code class="literal">create_mb_refstate</code> script:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf -y install python3-keylime</strong></span></pre></li><li class="listitem"><p class="simpara">
						On the monitored system, generate a policy from the measured boot log of the current state of the system by using the <code class="literal">create_mb_refstate</code> script:
					</p><pre class="screen"># <span class="strong strong"><strong>/usr/share/keylime/scripts/create_mb_refstate /sys/kernel/security/tpm0/binary_bios_measurements <span class="emphasis"><em>&lt;./measured_boot_reference_state.json&gt;</em></span></strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;./measured_boot_reference_state.json&gt;</em></span></code> with the path where the script saves the generated policy.
							</li><li class="listitem"><p class="simpara">
								If your UEFI system does not have Secure Boot enabled, pass the <code class="literal">--without-secureboot</code> argument.
							</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
									The policy generated with the <code class="literal">create_mb_refstate</code> script is based on the current state of the system and is very strict. Any modifications of the system including kernel updates and system updates will change the boot process and the system will fail the attestation.
								</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
						Copy the generated policy to the system where the <code class="literal">keylime_tenant</code> utility is configured, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>scp root@<span class="emphasis"><em>&lt;agent_ip&gt;</em></span>:<span class="emphasis"><em>&lt;./measured_boot_reference_state.json&gt;</em></span> <span class="emphasis"><em>&lt;./measured_boot_reference_state.json&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						On the system where the Keylime tenant is configured, provision the agent by using the <code class="literal">keylime_tenant</code> utility:
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_tenant -c add -t <span class="emphasis"><em>&lt;agent_ip&gt;</em></span> -u <span class="emphasis"><em>&lt;agent_uuid&gt;</em></span> --mb_refstate <span class="emphasis"><em>&lt;./measured_boot_reference_state.json&gt;</em></span> --cert default</strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;agent_ip&gt;</em></span></code> with the agent’s IP address.
							</li><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;agent_uuid&gt;</em></span></code> with the agent’s UUID.
							</li><li class="listitem">
								Replace <code class="literal"><span class="emphasis"><em>&lt;./measured_boot_reference_state.json&gt;</em></span></code> with the path to the measured boot policy.
							</li></ul></div><p class="simpara">
						If you configure measured boot in combination with runtime monitoring, provide all the options from both use cases when entering the <code class="literal">keylime_tenant -c add</code> command.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							You can stop Keylime from monitoring a node by using the <code class="literal"># keylime_tenant -c delete -t <span class="emphasis"><em>&lt;agent_ip&gt;</em></span> -u <span class="emphasis"><em>&lt;agent_uuid&gt;</em></span></code> command.
						</p><p>
							You can modify the configuration of an already registered agent by using the <code class="literal">keylime_tenant -c update</code> command.
						</p></div></rh-alert></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Reboot the monitored system and verify a successful attestation of the agent:
					</p><pre class="screen"># <span class="strong strong"><strong>keylime_tenant -c cvstatus -u <span class="emphasis"><em>&lt;agent_uuid&gt;</em></span></strong></span>
...
{"<span class="emphasis"><em>&lt;agent.uuid&gt;</em></span>": {"operational_state": "Get Quote"..."attestation_count": 5
...</pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;agent_uuid&gt;</em></span></code> with the agent’s UUID.
					</p><p class="simpara">
						If the value of <code class="literal">operational_state</code> is <code class="literal">Get Quote</code> and <code class="literal">attestation_count</code> is nonzero, the attestation of this agent is successful.
					</p><p class="simpara">
						If the value of <code class="literal">operational_state</code> is <code class="literal">Invalid Quote</code> or <code class="literal">Failed</code> attestation fails, the command displays output similar to the following:
					</p><pre class="screen">{"<span class="emphasis"><em>&lt;agent.uuid&gt;</em></span>": {"operational_state": "Invalid Quote", ... "ima.validation.ima-ng.not_in_allowlist", "attestation_count": 5, "last_received_quote": 1684150329, "last_successful_attestation": 1684150327}}</pre></li><li class="listitem"><p class="simpara">
						If the attestation fails, display more details in the verifier log:
					</p><pre class="screen"># <span class="strong strong"><strong>journalctl -u keylime_verifier</strong></span>
{"d432fbb3-d2f1-4a97-9ef7-75bd81c00000": {"operational_state": "Tenant Quote Failed", ... "last_event_id": "measured_boot.invalid_pcr_0", "attestation_count": 0, "last_received_quote": 1684487093, "last_successful_attestation": 0}}</pre></li></ol></div></section><section class="section" id="keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime"><div class="titlepage"><div><div><h3 class="title">7.12. Keylime environment variables</h3></div></div></div><p>
				You can set Keylime environment variables to override the values from the configuration files, for example, when starting a container with the <code class="literal">podman run</code> command by using the <code class="literal">-e</code> option.
			</p><p>
				The environment variables have the following syntax:
			</p><pre class="screen">KEYLIME<span class="emphasis"><em>_&lt;SECTION&gt;_&lt;ENVIRONMENT_VARIABLE&gt;</em></span>=<span class="emphasis"><em>&lt;value&gt;</em></span></pre><p>
				Where:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal"><span class="emphasis"><em>&lt;SECTION&gt;</em></span></code> is the section of the Keylime configuration file.
					</li><li class="listitem">
						<code class="literal"><span class="emphasis"><em>&lt;ENVIRONMENT_VARIABLE&gt;</em></span></code> is the environment variable.
					</li><li class="listitem">
						<code class="literal"><span class="emphasis"><em>&lt;value&gt;</em></span></code> is the value to which you want to set the environment variable.
					</li></ul></div><p>
				For example, <code class="literal">-e KEYLIME_VERIFIER_MAX_RETRIES=6</code> sets the <code class="literal">max_retries</code> configuration option in the <code class="literal">[verifier]</code> section to <code class="literal">6</code>.
			</p><h5 id="verifier_configuration">Verifier configuration</h5><rh-table id="idm140081359024800"><table class="lt-4-cols lt-7-rows"><caption>Table 7.1. [verifier] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081358602880" scope="col">Configuration option</th><th align="left" valign="top" id="idm140081358601792" scope="col">Environment variable</th><th align="left" valign="top" id="idm140081358600704" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">auto_migrate_db</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_AUTO_MIGRATE_DB</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">True</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">client_cert</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_CLIENT_CERT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">client_key_password</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_CLIENT_KEY_PASSWORD</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">client_key</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_CLIENT_KEY</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">database_pool_sz_ovfl</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_DATABASE_POOL_SZ_OVFL</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">5,10</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">database_url</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_DATABASE_URL</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">sqlite</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">durable_attestation_import</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_DURABLE_ATTESTATION_IMPORT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">enable_agent_mtls</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_ENABLE_AGENT_MTLS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">True</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">exponential_backoff</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_EXPONENTIAL_BACKOFF</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">True</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">ignore_tomtou_errors</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_IGNORE_TOMTOU_ERRORS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">False</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">ip</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_IP</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">max_retries</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_MAX_RETRIES</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">5</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">max_upload_size</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_MAX_UPLOAD_SIZE</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">104857600</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">measured_boot_evaluate</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_MEASURED_BOOT_EVALUATE</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">once</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">measured_boot_imports</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_MEASURED_BOOT_IMPORTS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">[]</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">measured_boot_policy_name</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_MEASURED_BOOT_POLICY_NAME</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">accept-all</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">num_workers</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_NUM_WORKERS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">0</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">persistent_store_encoding</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_PERSISTENT_STORE_ENCODING</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">persistent_store_format</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_PERSISTENT_STORE_FORMAT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">json</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">persistent_store_url</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_PERSISTENT_STORE_URL</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">port</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_PORT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">8881</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">quote_interval</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_QUOTE_INTERVAL</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">2</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">registrar_ip</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_REGISTRAR_IP</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">registrar_port</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_REGISTRAR_PORT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">8891</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">request_timeout</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_REQUEST_TIMEOUT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">60.0</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">require_allow_list_signatures</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_REQUIRE_ALLOW_LIST_SIGNATURES</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">True</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">retry_interval</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_RETRY_INTERVAL</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">2</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">server_cert</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_SERVER_CERT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">server_key_password</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_SERVER_KEY_PASSWORD</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">server_key</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_SERVER_KEY</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">severity_labels</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_SEVERITY_LABELS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">["info", "notice", "warning", "error", "critical", "alert", "emergency"]</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">severity_policy</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_SEVERITY_POLICY</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">[{"event_id": ".*", "severity_label" : "emergency"}]</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">signed_attributes</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_SIGNED_ATTRIBUTES</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">time_stamp_authority_certs_path</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_TIME_STAMP_AUTHORITY_CERTS_PATH</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">time_stamp_authority_url</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_TIME_STAMP_AUTHORITY_URL</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">tls_dir</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_TLS_DIR</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">generate</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">transparency_log_sign_algo</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_TRANSPARENCY_LOG_SIGN_ALGO</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">sha256</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">transparency_log_url</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_TRANSPARENCY_LOG_URL</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">trusted_client_ca</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_TRUSTED_CLIENT_CA</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">trusted_server_ca</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_TRUSTED_SERVER_CA</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">uuid</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_UUID</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358602880"> <p>
								<code class="literal">version</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358601792"> <p>
								<code class="literal">KEYLIME_VERIFIER_VERSION</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358600704"> <p>
								<code class="literal">2.0</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081357114064"><table class="lt-4-cols lt-7-rows"><caption>Table 7.2. [revocations] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">enabled_revocation_notifications</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_VERIFIER_REVOCATIONS_ENABLED_REVOCATION_NOTIFICATIONS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">[agent]</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">webhook_url</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_VERIFIER_REVOCATIONS_WEBHOOK_URL</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr></tbody></table></rh-table><h5 id="registrar_configuration">Registrar configuration</h5><rh-table id="idm140081380651392"><table class="lt-4-cols lt-7-rows"><caption>Table 7.3. [registrar] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">auto_migrate_db</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_AUTO_MIGRATE_DB</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">True</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">database_pool_sz_ovfl</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_DATABASE_POOL_SZ_OVFL</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">5,10</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">database_url</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_DATABASE_URL</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">sqlite</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">durable_attestation_import</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_DURABLE_ATTESTATION_IMPORT</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">ip</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_IP</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">persistent_store_encoding</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_PERSISTENT_STORE_ENCODING</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">persistent_store_format</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_PERSISTENT_STORE_FORMAT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">json</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">persistent_store_url</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_PERSISTENT_STORE_URL</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">port</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_PORT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">8890</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">prov_db_filename</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_PROV_DB_FILENAME</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">provider_reg_data.sqlite</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">server_cert</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_SERVER_CERT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">server_key_password</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_SERVER_KEY_PASSWORD</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">server_key</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_SERVER_KEY</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">signed_attributes</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_SIGNED_ATTRIBUTES</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">ek_tpm,aik_tpm,ekcert</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">time_stamp_authority_certs_path</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_TIME_STAMP_AUTHORITY_CERTS_PATH</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">time_stamp_authority_url</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_TIME_STAMP_AUTHORITY_URL</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">tls_dir</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_TLS_DIR</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">tls_port</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_TLS_PORT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">8891</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">transparency_log_sign_algo</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_TRANSPARENCY_LOG_SIGN_ALGO</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">sha256</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">transparency_log_url</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_TRANSPARENCY_LOG_URL</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">trusted_client_ca</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_TRUSTED_CLIENT_CA</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">version</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_REGISTRAR_VERSION</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">2.0</code>
							</p>
							 </td></tr></tbody></table></rh-table><h5 id="tenant_configuration">Tenant configuration</h5><rh-table id="idm140081358995264"><table class="lt-4-cols lt-7-rows"><caption>Table 7.4. [tenant] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">accept_tpm_encryption_algs</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_ACCEPT_TPM_ENCRYPTION_ALGS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">ecc, rsa</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">accept_tpm_hash_algs</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_ACCEPT_TPM_HASH_ALGS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">sha512, sha384, sha256</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">accept_tpm_signing_algs</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_ACCEPT_TPM_SIGNING_ALGS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">ecschnorr, rsassa</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">client_cert</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_CLIENT_CERT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">client_key_password</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_CLIENT_KEY_PASSWORD</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">client_key</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_CLIENT_KEY</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">ek_check_script</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_EK_CHECK_SCRIPT</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">enable_agent_mtls</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_ENABLE_AGENT_MTLS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">True</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">exponential_backoff</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_EXPONENTIAL_BACKOFF</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">True</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">max_payload_size</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_MAX_PAYLOAD_SIZE</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">1048576</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">max_retries</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_MAX_RETRIES</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">5</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">mb_refstate</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_MB_REFSTATE</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">registrar_ip</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_REGISTRAR_IP</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">registrar_port</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_REGISTRAR_PORT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">8891</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">request_timeout</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_REQUEST_TIMEOUT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">60</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">require_ek_cert</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_REQUIRE_EK_CERT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">True</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">retry_interval</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_RETRY_INTERVAL</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">2</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">tls_dir</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_TLS_DIR</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">tpm_cert_store</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_TPM_CERT_STORE</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">/var/lib/keylime/tpm_cert_store</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">trusted_server_ca</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_TRUSTED_SERVER_CA</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">verifier_ip</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_VERIFIER_IP</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">verifier_port</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_VERIFIER_PORT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">8881</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">version</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_TENANT_VERSION</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">2.0</code>
							</p>
							 </td></tr></tbody></table></rh-table><h5 id="ca_configuration">CA configuration</h5><rh-table id="idm140081354688368"><table class="lt-4-cols lt-7-rows"><caption>Table 7.5. [ca] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_bits</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_BITS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">2048</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_ca_lifetime</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_CA_LIFETIME</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">3650</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_ca_name</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_CA_NAME</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">Keylime Certificate Authority</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_country</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_COUNTRY</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">US</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_crl_dist</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_CRL_DIST</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">http://localhost:38080/crl</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_lifetime</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_LIFETIME</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">365</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_locality</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_LOCALITY</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">Lexington</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_org_unit</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_ORG_UNIT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">53</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_organization</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_ORGANIZATION</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">MITLL</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">cert_state</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_CERT_STATE</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">MA</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">password</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_PASSWORD</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">version</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_CA_VERSION</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">2.0</code>
							</p>
							 </td></tr></tbody></table></rh-table><h5 id="agent_configuration">Agent configuration</h5><rh-table id="idm140081364413456"><table class="lt-4-cols lt-7-rows"><caption>Table 7.6. [agent] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081364407376" scope="col">Configuration option</th><th align="left" valign="top" id="idm140081358043216" scope="col">Environment variable</th><th align="left" valign="top" id="idm140081358042128" scope="col">Default value</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">contact_ip</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_CONTACT_IP</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">contact_port</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_CONTACT_PORT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">9002</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">dec_payload_file</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_DEC_PAYLOAD_FILE</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">decrypted_payload</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">ek_handle</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_EK_HANDLE</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">generate</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">enable_agent_mtls</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_ENABLE_AGENT_MTLS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">true</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">enable_insecure_payload</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_ENABLE_INSECURE_PAYLOAD</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">false</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">enable_revocation_notifications</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_ENABLE_REVOCATION_NOTIFICATIONS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">true</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">enc_keyname</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_ENC_KEYNAME</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">derived_tci_key</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">exponential_backoff</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_EXPONENTIAL_BACKOFF</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">true</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">extract_payload_zip</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_EXTRACT_PAYLOAD_ZIP</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">true</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">ip</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_IP</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">max_retries</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_MAX_RETRIES</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">4</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">measure_payload_pcr</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_MEASURE_PAYLOAD_PCR</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">-1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">payload_script</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_PAYLOAD_SCRIPT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">autorun.sh</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">port</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_PORT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">9002</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">registrar_ip</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_REGISTRAR_IP</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">registrar_port</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_REGISTRAR_PORT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">8890</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">retry_interval</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_RETRY_INTERVAL</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">2</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">revocation_actions</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_REVOCATION_ACTIONS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">[]</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">revocation_cert</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_REVOCATION_CERT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">revocation_notification_ip</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_REVOCATION_NOTIFICATION_IP</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">127.0.0.1</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">revocation_notification_port</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_REVOCATION_NOTIFICATION_PORT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">8992</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">run_as</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_RUN_AS</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">keylime:tss</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">secure_size</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_SECURE_SIZE</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">1m</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">server_cert</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_SERVER_CERT</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">server_key_password</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_SERVER_KEY_PASSWORD</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">server_key</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_SERVER_KEY</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">tls_dir</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_TLS_DIR</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">tpm_encryption_alg</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_TPM_ENCRYPTION_ALG</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">rsa</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">tpm_hash_alg</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_TPM_HASH_ALG</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">sha256</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">tpm_ownerpassword</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_TPM_OWNERPASSWORD</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">tpm_signing_alg</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_TPM_SIGNING_ALG</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">rsassa</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">trusted_client_ca</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_TRUSTED_CLIENT_CA</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">default</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">uuid</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_UUID</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">d432fbb3-d2f1-4a97-9ef7-75bd81c00000</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081364407376"> <p>
								<code class="literal">version</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358043216"> <p>
								<code class="literal">KEYLIME_AGENT_VERSION</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140081358042128"> <p>
								<code class="literal">2.0</code>
							</p>
							 </td></tr></tbody></table></rh-table><h5 id="logging_configuration">Logging configuration</h5><rh-table id="idm140081357109696"><table class="lt-4-cols lt-7-rows"><caption>Table 7.7. [logging] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">version</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_VERSION</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">2.0</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081357091600"><table class="lt-4-cols lt-7-rows"><caption>Table 7.8. [loggers] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">keys</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_LOGGERS_KEYS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">root,keylime</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081354768096"><table class="lt-4-cols lt-7-rows"><caption>Table 7.9. [handlers] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">keys</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_HANDLERS_KEYS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">consoleHandler</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081354749984"><table class="lt-4-cols lt-7-rows"><caption>Table 7.10. [formatters] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">keys</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_FORMATTERS_KEYS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">formatter</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081359151952"><table class="lt-4-cols lt-7-rows"><caption>Table 7.11. [formatter_formatter] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">datefmt</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_FORMATTER_FORMATTER_DATEFMT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">%Y-%m-%d %H:%M:%S</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">format</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_FORMATTER_FORMATTER_FORMAT</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">%(asctime)s.%(msecs)03d - %(name)s - %(levelname)s - %(message)s</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081362844576"><table class="lt-4-cols lt-7-rows"><caption>Table 7.12. [logger_root] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">handlers</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_LOGGER_ROOT_HANDLERS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">consoleHandler</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">level</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_LOGGER_ROOT_LEVEL</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">INFO</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081359510992"><table class="lt-4-cols lt-7-rows"><caption>Table 7.13. [handler_consoleHandler] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">args</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_HANDLER_CONSOLEHANDLER_ARGS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">(sys.stdout,)</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">class</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_HANDLER_CONSOLEHANDLER_CLASS</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">StreamHandler</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">formatter</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_HANDLER_CONSOLEHANDLER_FORMATTER</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">formatter</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">level</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_HANDLER_CONSOLEHANDLER_LEVEL</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">INFO</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140081359211888"><table class="lt-4-cols lt-7-rows"><caption>Table 7.14. [logger_keylime] section</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Configuration option
							</p>
							 </td><td align="left" valign="top"> <p>
								Environment variable
							</p>
							 </td><td align="left" valign="top"> <p>
								Default value
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">handlers</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_LOGGER_KEYLIME_HANDLERS</code>
							</p>
							 </td><td align="left" valign="top"> </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">level</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_LOGGER_KEYLIME_LEVEL</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">INFO</code>
							</p>
							 </td></tr><tr><td align="left" valign="top"> <p>
								<code class="literal">qualname</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">KEYLIME_LOGGING_LOGGER_KEYLIME_QUALNAME</code>
							</p>
							 </td><td align="left" valign="top"> <p>
								<code class="literal">keylime</code>
							</p>
							 </td></tr></tbody></table></rh-table></section></section><section class="chapter" id="checking-integrity-with-aide_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Checking integrity with AIDE</h2></div></div></div><p class="_abstract _abstract">
			Advanced Intrusion Detection Environment (AIDE) is a utility that creates a database of files on the system, and then uses that database to ensure file integrity and detect system intrusions.
		</p><section class="section" id="installing-aide_checking-integrity-with-aide"><div class="titlepage"><div><div><h3 class="title">8.1. Installing AIDE</h3></div></div></div><p>
				To start file-integrity checking with AIDE, you must install the corresponding package and initiate the AIDE database.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">AppStream</code> repository is enabled.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">aide</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install aide</strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate an initial database:
					</p><pre class="screen"># <span class="strong strong"><strong>aide --init</strong></span>
Start timestamp: 2024-07-08 10:39:23 -0400 (AIDE 0.16)
AIDE initialized database at /var/lib/aide/aide.db.new.gz

Number of entries:	55856

---------------------------------------------------
The attributes of the (uncompressed) database(s):
---------------------------------------------------

/var/lib/aide/aide.db.new.gz
…
  SHA512   : mZaWoGzL2m6ZcyyZ/AXTIowliEXWSZqx
             IFYImY4f7id4u+Bq8WeuSE2jasZur/A4
             FPBFaBkoCFHdoE/FW/V94Q==</pre></li><li class="listitem">
						Optional: In the default configuration, the <code class="literal">aide --init</code> command checks just a set of directories and files defined in the <code class="literal">/etc/aide.conf</code> file. To include additional directories or files in the AIDE database, and to change their watched parameters, edit <code class="literal">/etc/aide.conf</code> accordingly.
					</li><li class="listitem"><p class="simpara">
						To start using the database, remove the <code class="literal">.new</code> substring from the initial database file name:
					</p><pre class="screen"># <span class="strong strong"><strong>mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</strong></span></pre></li><li class="listitem">
						Optional: To change the location of the AIDE database, edit the <code class="literal">/etc/aide.conf</code> file and modify the <code class="literal">DBDIR</code> value. For additional security, store the database, configuration, and the <code class="literal">/usr/sbin/aide</code> binary file in a secure location such as a read-only media.
					</li></ol></div></section><section class="section" id="performing-integrity-checks-with-aide_checking-integrity-with-aide"><div class="titlepage"><div><div><h3 class="title">8.2. Performing integrity checks with AIDE</h3></div></div></div><p>
				You can use the <code class="literal">crond</code> service to schedule regular file-integrity checks with AIDE.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						AIDE is properly installed and its database is initialized. See <a class="link" href="#installing-aide_checking-integrity-with-aide" title="8.1. Installing AIDE">Installing AIDE</a>
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To initiate a manual check:
					</p><pre class="screen"># <span class="strong strong"><strong>aide --check</strong></span>
Start timestamp: 2024-07-08 10:43:46 -0400 (AIDE 0.16)
AIDE found differences between database and filesystem!!

Summary:
  Total number of entries:	55856
  Added entries:		0
  Removed entries:		0
  Changed entries:		1

---------------------------------------------------
Changed entries:
---------------------------------------------------

f   ...      ..S : /root/.viminfo

---------------------------------------------------
Detailed information about changes:
---------------------------------------------------

File: /root/.viminfo
  SELinux  : system_u:object_r:admin_home_t:s | unconfined_u:object_r:admin_home
             0                                | _t:s0
…</pre></li><li class="listitem"><p class="simpara">
						At a minimum, configure the system to run AIDE weekly. Optimally, run AIDE daily. For example, to schedule a daily execution of AIDE at <span class="emphasis"><em>04:05</em></span> a.m. by using the <code class="literal">cron</code> command, add the following line to the <code class="literal">/etc/crontab</code> file:
					</p><pre class="screen"> 05 4 * * * root /usr/sbin/aide --check</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">cron(8)</code> man page on your system
					</li></ul></div></section><section class="section" id="updating-an-aide-database_checking-integrity-with-aide"><div class="titlepage"><div><div><h3 class="title">8.3. Updating an AIDE database</h3></div></div></div><p>
				After verifying the changes of your system, such as package updates or configuration files adjustments, update also your baseline AIDE database.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						AIDE is properly installed and its database is initialized. See <a class="link" href="#installing-aide_checking-integrity-with-aide" title="8.1. Installing AIDE">Installing AIDE</a>
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Update your baseline AIDE database:
					</p><pre class="screen"># <span class="strong strong"><strong>aide --update</strong></span></pre><p class="simpara">
						The <code class="literal">aide --update</code> command creates the <code class="literal">/var/lib/aide/aide.db.new.gz</code> database file.
					</p></li><li class="listitem">
						To start using the updated database for integrity checks, remove the <code class="literal">.new</code> substring from the file name.
					</li></ol></div></section><section class="section" id="file-integrity-tools-aide-and-ima_checking-integrity-with-aide"><div class="titlepage"><div><div><h3 class="title">8.4. File-integrity tools: AIDE and IMA</h3></div></div></div><p>
				Red Hat Enterprise Linux provides several tools for checking and preserving the integrity of files and directories on your system. The following table helps you decide which tool better fits your scenario.
			</p><rh-table id="idm140081358697120"><table class="lt-4-cols lt-7-rows"><caption>Table 8.1. Comparison between AIDE and IMA</caption><colgroup><col style="width: 14%; " class="col_1"><!--Empty--><col style="width: 43%; " class="col_2"><!--Empty--><col style="width: 43%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140081358691344" scope="col">Question</th><th align="left" valign="top" id="idm140081358690256" scope="col">Advanced Intrusion Detection Environment (AIDE)</th><th align="left" valign="top" id="idm140081358689136" scope="col">Integrity Measurement Architecture (IMA)</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140081358691344"> <p>
								What
							</p>
							 </td><td align="left" valign="top" headers="idm140081358690256"> <p>
								AIDE is a utility that creates a database of files and directories on the system. This database serves for checking file integrity and detect intrusion detection.
							</p>
							 </td><td align="left" valign="top" headers="idm140081358689136"> <p>
								IMA detects if a file is altered by checking file measurement (hash values) compared to previously stored extended attributes.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358691344"> <p>
								How
							</p>
							 </td><td align="left" valign="top" headers="idm140081358690256"> <p>
								AIDE uses rules to compare the integrity state of the files and directories.
							</p>
							 </td><td align="left" valign="top" headers="idm140081358689136"> <p>
								IMA uses file hash values to detect the intrusion.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358691344"> <p>
								Why
							</p>
							 </td><td align="left" valign="top" headers="idm140081358690256"> <p>
								Detection - AIDE detects if a file is modified by verifying the rules.
							</p>
							 </td><td align="left" valign="top" headers="idm140081358689136"> <p>
								Detection and Prevention - IMA detects and prevents an attack by replacing the extended attribute of a file.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358691344"> <p>
								Usage
							</p>
							 </td><td align="left" valign="top" headers="idm140081358690256"> <p>
								AIDE detects a threat when the file or directory is modified.
							</p>
							 </td><td align="left" valign="top" headers="idm140081358689136"> <p>
								IMA detects a threat when someone tries to alter the entire file.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140081358691344"> <p>
								Extension
							</p>
							 </td><td align="left" valign="top" headers="idm140081358690256"> <p>
								AIDE checks the integrity of files and directories on the local system.
							</p>
							 </td><td align="left" valign="top" headers="idm140081358689136"> <p>
								IMA ensures security on the local and remote systems.
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section _additional-resources" id="related-information-checking-integrity-with-aide"><div class="titlepage"><div><div><h3 class="title">8.5. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">aide(1)</code> man page on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel">Kernel integrity subsystem</a>
					</li></ul></div></section></section><section class="chapter" id="encrypting-block-devices-using-luks_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Encrypting block devices using LUKS</h2></div></div></div><p>
			By using the disk encryption, you can protect the data on a block device by encrypting it. To access the device’s decrypted contents, enter a passphrase or key as authentication. This is important for mobile computers and removable media because it helps to protect the device’s contents even if it has been physically removed from the system. The LUKS format is a default implementation of block device encryption in Red Hat Enterprise Linux.
		</p><section class="section" id="luks-disk-encryption_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.1. LUKS disk encryption</h3></div></div></div><p>
				Linux Unified Key Setup-on-disk-format (LUKS) provides a set of tools that simplifies managing the encrypted devices. With LUKS, you can encrypt block devices and enable multiple user keys to decrypt a master key. For bulk encryption of the partition, use this master key.
			</p><p>
				Red Hat Enterprise Linux uses LUKS to perform block device encryption. By default, the option to encrypt the block device is unchecked during the installation. If you select the option to encrypt your disk, the system prompts you for a passphrase every time you boot the computer. This passphrase unlocks the bulk encryption key that decrypts your partition. If you want to modify the default partition table, you can select the partitions that you want to encrypt. This is set in the partition table settings.
			</p><div class="formalpara"><p class="title"><strong>Ciphers</strong></p><p>
					The default cipher used for LUKS is <code class="literal">aes-xts-plain64</code>. The default key size for LUKS is 512 bits. The default key size for LUKS with <span class="strong strong"><strong>Anaconda</strong></span> XTS mode is 512 bits. The following are the available ciphers:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Advanced Encryption Standard (AES)
					</li><li class="listitem">
						Twofish
					</li><li class="listitem">
						Serpent
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Operations performed by LUKS</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						LUKS encrypts entire block devices and is therefore well-suited for protecting contents of mobile devices such as removable storage media or laptop disk drives.
					</li><li class="listitem">
						The underlying contents of the encrypted block device are arbitrary, which makes it useful for encrypting swap devices. This can also be useful with certain databases that use specially formatted block devices for data storage.
					</li><li class="listitem">
						LUKS uses the existing device mapper kernel subsystem.
					</li><li class="listitem">
						LUKS provides passphrase strengthening, which protects against dictionary attacks.
					</li><li class="listitem">
						LUKS devices contain multiple key slots, which means you can add backup keys or passphrases.
					</li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					LUKS is not recommended for the following scenarios:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Disk-encryption solutions such as LUKS protect the data only when your system is off. After the system is on and LUKS has decrypted the disk, the files on that disk are available to anyone who have access to them.
						</li><li class="listitem">
							Scenarios that require multiple users to have distinct access keys to the same device. The LUKS1 format provides eight key slots and LUKS2 provides up to 32 key slots.
						</li><li class="listitem">
							Applications that require file-level encryption.
						</li></ul></div></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://gitlab.com/cryptsetup/cryptsetup/blob/master/README.md">LUKS Project Home Page</a>
					</li><li class="listitem">
						<a class="link" href="https://gitlab.com/cryptsetup/LUKS2-docs/blob/master/luks2_doc_wip.pdf">LUKS On-Disk Format Specification</a>
					</li><li class="listitem">
						<a class="link" href="https://doi.org/10.6028/NIST.FIPS.197-upd1">FIPS 197: Advanced Encryption Standard (AES)</a>
					</li></ul></div></section><section class="section" id="luks-versions-in-rhel_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.2. LUKS versions in RHEL</h3></div></div></div><p>
				In Red Hat Enterprise Linux, the default format for LUKS encryption is LUKS2. The old LUKS1 format remains fully supported and it is provided as a format compatible with earlier Red Hat Enterprise Linux releases. LUKS2 re-encryption is considered more robust and safe to use as compared to LUKS1 re-encryption.
			</p><p>
				The LUKS2 format enables future updates of various parts without a need to modify binary structures. Internally it uses JSON text format for metadata, provides redundancy of metadata, detects metadata corruption, and automatically repairs from a metadata copy.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Do not use LUKS2 in systems that support only LUKS1.
				</p></div></rh-alert><p>
				Since Red Hat Enterprise Linux 9.2, you can use the <code class="literal">cryptsetup reencrypt</code> command for both the LUKS versions to encrypt the disk.
			</p><div class="formalpara"><p class="title"><strong>Online re-encryption</strong></p><p>
					The LUKS2 format supports re-encrypting encrypted devices while the devices are in use. For example, you do not have to unmount the file system on the device to perform the following tasks:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Changing the volume key
					</li><li class="listitem"><p class="simpara">
						Changing the encryption algorithm
					</p><p class="simpara">
						When encrypting a non-encrypted device, you must still unmount the file system. You can remount the file system after a short initialization of the encryption.
					</p><p class="simpara">
						The LUKS1 format does not support online re-encryption.
					</p></li></ul></div><div class="formalpara"><p class="title"><strong>Conversion</strong></p><p>
					In certain situations, you can convert LUKS1 to LUKS2. The conversion is not possible specifically in the following scenarios:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A LUKS1 device is marked as being used by a Policy-Based Decryption (PBD) Clevis solution. The <code class="literal">cryptsetup</code> tool does not convert the device when some <code class="literal">luksmeta</code> metadata are detected.
					</li><li class="listitem">
						A device is active. The device must be in an inactive state before any conversion is possible.
					</li></ul></div></section><section class="section" id="options-for-data-protection-during-luks2-re-encryption_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.3. Options for data protection during LUKS2 re-encryption</h3></div></div></div><p>
				LUKS2 provides several options that prioritize performance or data protection during the re-encryption process. It provides the following modes for the <code class="literal">resilience</code> option, and you can select any of these modes by using the <code class="literal">cryptsetup reencrypt --resilience resilience-mode <span class="emphasis"><em>/dev/sdx</em></span></code> command:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">checksum</code></span></dt><dd><p class="simpara">
							The default mode. It balances data protection and performance.
						</p><p class="simpara">
							This mode stores individual checksums of the sectors in the re-encryption area, which the recovery process can detect for the sectors that were re-encrypted by LUKS2. The mode requires that the block device sector write is atomic.
						</p></dd><dt><span class="term"><code class="literal">journal</code></span></dt><dd>
							The safest mode but also the slowest. Since this mode journals the re-encryption area in the binary area, the LUKS2 writes the data twice.
						</dd><dt><span class="term"><code class="literal">none</code></span></dt><dd>
							The <code class="literal">none</code> mode prioritizes performance and provides no data protection. It protects the data only against safe process termination, such as the <code class="literal">SIGTERM</code> signal or the user pressing <kbd class="keycap">Ctrl</kbd>+<kbd class="keycap">C</kbd> key. Any unexpected system failure or application failure might result in data corruption.
						</dd></dl></div><p>
				If a LUKS2 re-encryption process terminates unexpectedly by force, LUKS2 can perform the recovery in one of the following ways:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Automatically</span></dt><dd><p class="simpara">
							By performing any one of the following actions triggers the automatic recovery action during the next LUKS2 device open action:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Executing the <code class="literal">cryptsetup open</code> command.
								</li><li class="listitem">
									Attaching the device with the <code class="literal">systemd-cryptsetup</code> command.
								</li></ul></div></dd><dt><span class="term">Manually</span></dt><dd>
							By using the <code class="literal">cryptsetup repair <span class="emphasis"><em>/dev/sdx</em></span></code> command on the LUKS2 device.
						</dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">cryptsetup-reencrypt(8)</code> and <code class="literal">cryptsetup-repair(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="encrypting-existing-data-on-a-block-device-using-luks2_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.4. Encrypting existing data on a block device using LUKS2</h3></div></div></div><p>
				You can encrypt the existing data on a not yet encrypted device by using the LUKS2 format. A new LUKS header is stored in the head of the device.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The block device has a file system.
					</li><li class="listitem"><p class="simpara">
						You have backed up your data.
					</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							You might lose your data during the encryption process due to a hardware, kernel, or human failure. Ensure that you have a reliable backup before you start encrypting the data.
						</p></div></rh-alert></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Unmount all file systems on the device that you plan to encrypt, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>umount <span class="emphasis"><em>/dev/mapper/vg00-lv00</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Make free space for storing a LUKS header. Use one of the following options that suits your scenario:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								In the case of encrypting a logical volume, you can extend the logical volume without resizing the file system. For example:
							</p><pre class="screen"># <span class="strong strong"><strong>lvextend -L+<span class="emphasis"><em>32M /dev/mapper/vg00-lv00</em></span></strong></span></pre></li><li class="listitem">
								Extend the partition by using partition management tools, such as <code class="literal">parted</code>.
							</li><li class="listitem">
								Shrink the file system on the device. You can use the <code class="literal">resize2fs</code> utility for the ext2, ext3, or ext4 file systems. Note that you cannot shrink the XFS file system.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Initialize the encryption:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup reencrypt --encrypt --init-only --reduce-device-size <span class="emphasis"><em>32M</em></span> /dev/mapper/<span class="emphasis"><em>vg00-lv00 lv00_encrypted</em></span></strong></span>

/dev/mapper/<span class="emphasis"><em>lv00_encrypted</em></span> is now active and ready for online encryption.</pre></li><li class="listitem"><p class="simpara">
						Mount the device:
					</p><pre class="screen"># <span class="strong strong"><strong>mount /dev/mapper/<span class="emphasis"><em>lv00_encrypted /mnt/lv00_encrypted</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Add an entry for a persistent mapping to the <code class="literal">/etc/crypttab</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Find the <code class="literal">luksUUID</code>:
							</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksUUID /dev/mapper/<span class="emphasis"><em>vg00-lv00</em></span></strong></span>

a52e2cc9-a5be-47b8-a95d-6bdf4f2d9325</pre></li><li class="listitem"><p class="simpara">
								Open <code class="literal">/etc/crypttab</code> in a text editor of your choice and add a device in this file:
							</p><pre class="screen">$ <span class="strong strong"><strong>vi /etc/crypttab</strong></span>

lv00_encrypted UUID=<span class="emphasis"><em>a52e2cc9-a5be-47b8-a95d-6bdf4f2d9325</em></span> none</pre><p class="simpara">
								Replace <span class="emphasis"><em>a52e2cc9-a5be-47b8-a95d-6bdf4f2d9325</em></span> with your device’s <code class="literal">luksUUID</code>.
							</p></li><li class="listitem"><p class="simpara">
								Refresh initramfs with <code class="literal">dracut</code>:
							</p><pre class="screen">$ <span class="strong strong"><strong>dracut -f --regenerate-all</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Add an entry for a persistent mounting to the <code class="literal">/etc/fstab</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Find the file system’s UUID of the active LUKS block device:
							</p><pre class="screen">$ <span class="strong strong"><strong>blkid -p /dev/mapper/<span class="emphasis"><em>lv00_encrypted</em></span></strong></span>

/dev/mapper/<span class="emphasis"><em>lv00-encrypted</em></span>: UUID="<span class="emphasis"><em>37bc2492-d8fa-4969-9d9b-bb64d3685aa9</em></span>" BLOCK_SIZE="4096" TYPE="xfs" USAGE="filesystem"</pre></li><li class="listitem"><p class="simpara">
								Open <code class="literal">/etc/fstab</code> in a text editor of your choice and add a device in this file, for example:
							</p><pre class="screen">$ <span class="strong strong"><strong>vi /etc/fstab</strong></span>

UUID=<span class="emphasis"><em>37bc2492-d8fa-4969-9d9b-bb64d3685aa9</em></span> /home auto rw,user,auto 0</pre><p class="simpara">
								Replace <span class="emphasis"><em>37bc2492-d8fa-4969-9d9b-bb64d3685aa9</em></span> with your file system’s UUID.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Resume the online encryption:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup reencrypt --resume-only /dev/mapper/<span class="emphasis"><em>vg00-lv00</em></span></strong></span>

Enter passphrase for /dev/mapper/<span class="emphasis"><em>vg00-lv00</em></span>:
Auto-detected active dm device '<span class="emphasis"><em>lv00_encrypted</em></span>' for data device /dev/mapper/<span class="emphasis"><em>vg00-lv00</em></span>.
Finished, time 00:31.130, 10272 MiB written, speed 330.0 MiB/s</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify if the existing data was encrypted:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksDump /dev/mapper/<span class="emphasis"><em>vg00-lv00</em></span></strong></span>

LUKS header information
Version: 2
Epoch: 4
Metadata area: 16384 [bytes]
Keyslots area: 16744448 [bytes]
UUID: a52e2cc9-a5be-47b8-a95d-6bdf4f2d9325
Label: (no label)
Subsystem: (no subsystem)
Flags: (no flags)

Data segments:
  0: crypt
	offset: 33554432 [bytes]
	length: (whole device)
	cipher: aes-xts-plain64
[...]</pre></li><li class="listitem"><p class="simpara">
						View the status of the encrypted blank block device:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup status <span class="emphasis"><em>lv00_encrypted</em></span></strong></span>

/dev/mapper/<span class="emphasis"><em>lv00_encrypted</em></span> is active and is in use.
  type:    LUKS2
  cipher:  aes-xts-plain64
  keysize: 512 bits
  key location: keyring
  device:  /dev/mapper/<span class="emphasis"><em>vg00-lv00</em></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">cryptsetup(8)</code>, <code class="literal">cryptsetup-reencrypt(8)</code>, <code class="literal">lvextend(8)</code>, <code class="literal">resize2fs(8)</code>, and <code class="literal">parted(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="encrypting-existing-data-on-a-block-device-using-luks2-with-a-detached-header_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.5. Encrypting existing data on a block device using LUKS2 with a detached header</h3></div></div></div><p>
				You can encrypt existing data on a block device without creating free space for storing a LUKS header. The header is stored in a detached location, which also serves as an additional layer of security. The procedure uses the LUKS2 encryption format.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The block device has a file system.
					</li><li class="listitem"><p class="simpara">
						You have backed up your data.
					</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							You might lose your data during the encryption process due to a hardware, kernel, or human failure. Ensure that you have a reliable backup before you start encrypting the data.
						</p></div></rh-alert></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Unmount all file systems on the device, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>umount /dev/<span class="emphasis"><em>nvme0n1p1</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Initialize the encryption:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup reencrypt --encrypt --init-only --header <span class="emphasis"><em>/home/header</em></span> /dev/<span class="emphasis"><em>nvme0n1p1 nvme_encrypted</em></span></strong></span>

WARNING!
========
Header file does not exist, do you want to create it?

Are you sure? (Type 'yes' in capital letters): YES
Enter passphrase for <span class="emphasis"><em>/home/header</em></span>:
Verify passphrase:
/dev/mapper/<span class="emphasis"><em>nvme_encrypted</em></span> is now active and ready for online encryption.</pre><p class="simpara">
						Replace <span class="emphasis"><em>/home/header</em></span> with a path to the file with a detached LUKS header. The detached LUKS header has to be accessible to unlock the encrypted device later.
					</p></li><li class="listitem"><p class="simpara">
						Mount the device:
					</p><pre class="screen"># <span class="strong strong"><strong>mount /dev/mapper/<span class="emphasis"><em>nvme_encrypted /mnt/nvme_encrypted</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Resume the online encryption:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup reencrypt --resume-only --header <span class="emphasis"><em>/home/header</em></span> /dev/<span class="emphasis"><em>nvme0n1p1</em></span></strong></span>

Enter passphrase for /dev/<span class="emphasis"><em>nvme0n1p1</em></span>:
Auto-detected active dm device 'nvme_encrypted' for data device /dev/<span class="emphasis"><em>nvme0n1p1</em></span>.
Finished, time 00m51s,   10 GiB written, speed 198.2 MiB/s</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify if the existing data on a block device using LUKS2 with a detached header is encrypted:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksDump <span class="emphasis"><em>/home/header</em></span></strong></span>

LUKS header information
Version:       	2
Epoch:         	88
Metadata area: 	16384 [bytes]
Keyslots area: 	16744448 [bytes]
UUID:          	c4f5d274-f4c0-41e3-ac36-22a917ab0386
Label:         	(no label)
Subsystem:     	(no subsystem)
Flags:       	(no flags)

Data segments:
  0: crypt
	offset: 0 [bytes]
	length: (whole device)
	cipher: aes-xts-plain64
	sector: 512 [bytes]
[...]</pre></li><li class="listitem"><p class="simpara">
						View the status of the encrypted blank block device:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup status <span class="emphasis"><em>nvme_encrypted</em></span></strong></span>

/dev/mapper/<span class="emphasis"><em>nvme_encrypted</em></span> is active and is in use.
  type:    LUKS2
  cipher:  aes-xts-plain64
  keysize: 512 bits
  key location: keyring
  device:  /dev/<span class="emphasis"><em>nvme0n1p1</em></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">cryptsetup(8)</code> and <code class="literal">cryptsetup-reencrypt(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="encrypting-a-blank-block-device-using-luks2_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.6. Encrypting a blank block device using LUKS2</h3></div></div></div><p>
				You can encrypt a blank block device, which you can use for an encrypted storage by using the LUKS2 format.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A blank block device. You can use commands such as <code class="literal">lsblk</code> to find if there is no real data on that device, for example, a file system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Setup a partition as an encrypted LUKS partition:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksFormat /dev/<span class="emphasis"><em>nvme0n1p1</em></span></strong></span>

WARNING!
========
This will overwrite data on <span class="emphasis"><em>/dev/nvme0n1p1</em></span> irrevocably.
Are you sure? (Type 'yes' in capital letters): YES
Enter passphrase for /dev/<span class="emphasis"><em>nvme0n1p1</em></span>:
Verify passphrase:</pre></li><li class="listitem"><p class="simpara">
						Open an encrypted LUKS partition:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup open /dev/<span class="emphasis"><em>nvme0n1p1 nvme0n1p1_encrypted</em></span></strong></span>

Enter passphrase for /dev/<span class="emphasis"><em>nvme0n1p1</em></span>:</pre><p class="simpara">
						This unlocks the partition and maps it to a new device by using the device mapper. To not overwrite the encrypted data, this command alerts the kernel that the device is an encrypted device and addressed through LUKS by using the <code class="literal">/dev/mapper/<span class="emphasis"><em>device_mapped_name</em></span></code> path.
					</p></li><li class="listitem"><p class="simpara">
						Create a file system to write encrypted data to the partition, which must be accessed through the device mapped name:
					</p><pre class="screen"># <span class="strong strong"><strong>mkfs -t ext4 /dev/mapper/<span class="emphasis"><em>nvme0n1p1_encrypted</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Mount the device:
					</p><pre class="screen"># <span class="strong strong"><strong>mount /dev/mapper/<span class="emphasis"><em>nvme0n1p1_encrypted mount-point</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify if the blank block device is encrypted:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksDump /dev/<span class="emphasis"><em>nvme0n1p1</em></span></strong></span>

LUKS header information
Version:       	2
Epoch:         	3
Metadata area: 	16384 [bytes]
Keyslots area: 	16744448 [bytes]
UUID:          	34ce4870-ffdf-467c-9a9e-345a53ed8a25
Label:         	(no label)
Subsystem:     	(no subsystem)
Flags:       	(no flags)

Data segments:
  0: crypt
	offset: 16777216 [bytes]
	length: (whole device)
	cipher: aes-xts-plain64
	sector: 512 [bytes]
[...]</pre></li><li class="listitem"><p class="simpara">
						View the status of the encrypted blank block device:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup status <span class="emphasis"><em>nvme0n1p1_encrypted</em></span></strong></span>

/dev/mapper/<span class="emphasis"><em>nvme0n1p1_encrypted</em></span> is active and is in use.
  type:    LUKS2
  cipher:  aes-xts-plain64
  keysize: 512 bits
  key location: keyring
  device:  /dev/<span class="emphasis"><em>nvme0n1p1</em></span>
  sector size:  512
  offset:  32768 sectors
  size:    20938752 sectors
  mode:    read/write</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">cryptsetup(8)</code>, <code class="literal">cryptsetup-open (8)</code>, and <code class="literal">cryptsetup-lusFormat(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="configuring-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.7. Configuring the LUKS passphrase in the web console</h3></div></div></div><p class="_abstract _abstract">
				If you want to add encryption to an existing logical volume on your system, you can only do so through formatting the volume.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have installed the RHEL 9 web console.
					</p><p class="simpara">
						For instructions, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console">Installing and enabling the web console</a>.
					</p></li><li class="listitem">
						The <code class="literal">cockpit-storaged</code> package is installed on your system.
					</li><li class="listitem">
						Available existing logical volume without encryption.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the RHEL 9 web console.
					</p><p class="simpara">
						For details, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console">Logging in to the web console</a>.
					</p></li><li class="listitem">
						Click <span class="strong strong"><strong>Storage</strong></span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Storage</strong></span> table, click the menu button, <span class="guibutton">⋮</span>, next to the storage device you want to encrypt.
					</li><li class="listitem">
						From the drop-down menu, select <span class="guibutton">Format</span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Encryption field</strong></span>, select the encryption specification, <span class="strong strong"><strong>LUKS1</strong></span> or <span class="strong strong"><strong>LUKS2</strong></span>.
					</li><li class="listitem">
						Set and confirm your new passphrase.
					</li><li class="listitem">
						Optional: Modify further encryption options.
					</li><li class="listitem">
						Finalize formatting settings.
					</li><li class="listitem">
						Click <span class="strong strong"><strong>Format</strong></span>.
					</li></ol></div></section><section class="section" id="changing-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.8. Changing the LUKS passphrase in the web console</h3></div></div></div><p class="_abstract _abstract">
				Change a LUKS passphrase on an encrypted disk or partition in the web console.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have installed the RHEL 9 web console.
					</p><p class="simpara">
						For instructions, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console">Installing and enabling the web console</a>.
					</p></li><li class="listitem">
						The <code class="literal">cockpit-storaged</code> package is installed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the RHEL 9 web console.
					</p><p class="simpara">
						For details, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console">Logging in to the web console</a>.
					</p></li><li class="listitem">
						Click <span class="strong strong"><strong>Storage</strong></span>
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Storage</strong></span> table, select the disk with encrypted data.
					</li><li class="listitem"><p class="simpara">
						On the disk page, scroll to the <span class="strong strong"><strong>Keys</strong></span> section and click the edit button.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/cfaf0f76552b0b0e79c9e3f01f8ef688/cockpit-LUKS-edit.png" alt="cockpit LUKS edit"></span>

					</p></li><li class="listitem"><p class="simpara">
						In the <span class="strong strong"><strong>Change passphrase</strong></span> dialog window:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Enter your current passphrase.
							</li><li class="listitem">
								Enter your new passphrase.
							</li><li class="listitem"><p class="simpara">
								Confirm your new passphrase.
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/901a308feba70ad35b232e9179f0f81a/cockpit-change-pwd.png" alt="cockpit change pwd"></span>

							</p></li></ol></div></li><li class="listitem">
						Click <span class="strong strong"><strong>Save</strong></span>
					</li></ol></div></section><section class="section" id="creating-a-luks2-encrypted-volume-using-the-storage-role_encrypting-block-devices-using-luks"><div class="titlepage"><div><div><h3 class="title">9.9. Creating a LUKS2 encrypted volume by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">storage</code> role to create and configure a volume encrypted with LUKS by running an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create and configure a volume encrypted with LUKS
  hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.storage
  vars:
    storage_volumes:
      - name: barefs
        type: disk
        disks:
         <span class="emphasis"><em>- sdb</em></span>
        fs_type: xfs
        fs_label: label-name
        mount_point: /mnt/data
        encryption: true
        encryption_password: <span class="emphasis"><em>&lt;password&gt;</em></span></pre><p class="simpara">
						You can also add other encryption parameters, such as <code class="literal">encryption_key</code>, <code class="literal">encryption_cipher</code>, <code class="literal">encryption_key_size</code>, and <code class="literal">encryption_luks</code>, to the playbook file.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						View the encryption status:
					</p><pre class="literallayout"># <span class="strong strong"><strong>cryptsetup status sdb</strong></span>

/dev/mapper/sdb is active and is in use.
type: LUKS2
cipher: aes-xts-plain64
keysize: 512 bits
key location: keyring
device: /dev/sdb
...</pre></li><li class="listitem"><p class="simpara">
						Verify the created LUKS encrypted volume:
					</p><pre class="literallayout"># <span class="strong strong"><strong>cryptsetup luksDump /dev/sdb</strong></span>

Version:        2
Epoch:          6
Metadata area:  16384 [bytes]
Keyslots area:  33521664 [bytes]
UUID:           a4c6be82-7347-4a91-a8ad-9479b72c9426
Label:          (no label)
Subsystem:      (no subsystem)
Flags:          allow-discards

Data segments:
  0: crypt
        offset: 33554432 [bytes]
        length: (whole device)
        cipher: aes-xts-plain64
        sector: 4096 [bytes]
...</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_storage_devices/encrypting-block-devices-using-luks_managing-storage-devices">Encrypting block devices by using LUKS</a>
					</li></ul></div></section></section><section class="chapter" id="configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Configuring automated unlocking of encrypted volumes by using policy-based decryption</h2></div></div></div><p class="_abstract _abstract">
			Policy-Based Decryption (PBD) is a collection of technologies that enable unlocking encrypted root and secondary volumes of hard drives on physical and virtual machines. PBD uses a variety of unlocking methods, such as user passwords, a Trusted Platform Module (TPM) device, a PKCS #11 device connected to a system, for example, a smart card, or a special network server.
		</p><p>
			PBD allows combining different unlocking methods into a policy, which makes it possible to unlock the same volume in different ways. The current implementation of the PBD in RHEL consists of the Clevis framework and plug-ins called <span class="emphasis"><em>pins</em></span>. Each pin provides a separate unlocking capability. Currently, the following pins are available:
		</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">tang</code></span></dt><dd>
						Allows unlocking volumes using a network server.
					</dd><dt><span class="term"><code class="literal">tpm2</code></span></dt><dd>
						allows unlocking volumes using a TPM2 policy.
					</dd><dt><span class="term"><code class="literal">sss</code></span></dt><dd>
						allows deploying high-availability systems using the Shamir’s Secret Sharing (SSS) cryptographic scheme.
					</dd></dl></div><section class="section" id="network-bound-disk-encryption_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.1. Network-bound disk encryption</h3></div></div></div><p>
				The Network Bound Disc Encryption (NBDE) is a subcategory of Policy-Based Decryption (PBD) that allows binding encrypted volumes to a special network server. The current implementation of the NBDE includes a Clevis pin for the Tang server and the Tang server itself.
			</p><p>
				In RHEL, NBDE is implemented through the following components and technologies:
			</p><div class="figure" id="fig-NBDE-Clevis-Tang"><p class="title"><strong>Figure 10.1. NBDE scheme when using a LUKS1-encrypted volume. The luksmeta package is not used for LUKS2 volumes.</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/254dc068af942f27c7edc6e7c65bf7a2/RHEL_Security-Guide_453350_0717_ECE_NBDE.png" alt="Network-Bound Disk Encryption (NBDE)"></div></div></div><p>
				<span class="emphasis"><em>Tang</em></span> is a server for binding data to network presence. It makes a system containing your data available when the system is bound to a certain secure network. Tang is stateless and does not require TLS or authentication. Unlike escrow-based solutions, where the server stores all encryption keys and has knowledge of every key ever used, Tang never interacts with any client keys, so it never gains any identifying information from the client.
			</p><p>
				<span class="emphasis"><em>Clevis</em></span> is a pluggable framework for automated decryption. In NBDE, Clevis provides automated unlocking of LUKS volumes. The <code class="literal">clevis</code> package provides the client side of the feature.
			</p><p>
				A <span class="emphasis"><em>Clevis pin</em></span> is a plug-in into the Clevis framework. One of such pins is a plug-in that implements interactions with the NBDE server — Tang.
			</p><p>
				Clevis and Tang are generic client and server components that provide network-bound encryption. In RHEL, they are used in conjunction with LUKS to encrypt and decrypt root and non-root storage volumes to accomplish Network-Bound Disk Encryption.
			</p><p>
				Both client- and server-side components use the <span class="emphasis"><em>José</em></span> library to perform encryption and decryption operations.
			</p><p>
				When you begin provisioning NBDE, the Clevis pin for Tang server gets a list of the Tang server’s advertised asymmetric keys. Alternatively, since the keys are asymmetric, a list of Tang’s public keys can be distributed out of band so that clients can operate without access to the Tang server. This mode is called <span class="emphasis"><em>offline provisioning</em></span>.
			</p><p>
				The Clevis pin for Tang uses one of the public keys to generate a unique, cryptographically-strong encryption key. Once the data is encrypted using this key, the key is discarded. The Clevis client should store the state produced by this provisioning operation in a convenient location. This process of encrypting data is the <span class="emphasis"><em>provisioning step</em></span>.
			</p><p>
				The LUKS version 2 (LUKS2) is the default disk-encryption format in RHEL, hence, the provisioning state for NBDE is stored as a token in a LUKS2 header. The leveraging of provisioning state for NBDE by the <code class="literal">luksmeta</code> package is used only for volumes encrypted with LUKS1.
			</p><p>
				The Clevis pin for Tang supports both LUKS1 and LUKS2 without specification need. Clevis can encrypt plain-text files but you have to use the <code class="literal">cryptsetup</code> tool for encrypting block devices. See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/encrypting-block-devices-using-luks_security-hardening">Encrypting block devices using LUKS</a> for more information.
			</p><p>
				When the client is ready to access its data, it loads the metadata produced in the provisioning step and it responds to recover the encryption key. This process is the <span class="emphasis"><em>recovery step</em></span>.
			</p><p>
				In NBDE, Clevis binds a LUKS volume using a pin so that it can be automatically unlocked. After successful completion of the binding process, the disk can be unlocked using the provided Dracut unlocker.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If the <code class="literal">kdump</code> kernel crash dumping mechanism is set to save the content of the system memory to a LUKS-encrypted device, you are prompted for entering a password during the second kernel boot.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/6987053">NBDE (Network-Bound Disk Encryption) Technology</a> Knowledgebase article
					</li><li class="listitem">
						<code class="literal">tang(8)</code>, <code class="literal">clevis(1)</code>, <code class="literal">jose(1)</code>, and <code class="literal">clevis-luks-unlockers(7)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/4500491">How to set up Network-Bound Disk Encryption with multiple LUKS devices (Clevis + Tang unlocking)</a> Knowledgebase article
					</li></ul></div></section><section class="section" id="deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.2. Deploying a Tang server with SELinux in enforcing mode</h3></div></div></div><p>
				You can use a Tang server to automatically unlock LUKS-encrypted volumes on Clevis-enabled clients. In the minimalistic scenario, you deploy a Tang server on port 80 by installing the <code class="literal">tang</code> package and entering the <code class="literal">systemctl enable tangd.socket --now</code> command. The following example procedure demonstrates the deployment of a Tang server running on a custom port as a confined service in SELinux enforcing mode.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package and its dependencies are installed.
					</li><li class="listitem">
						The <code class="literal">firewalld</code> service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To install the <code class="literal">tang</code> package and its dependencies, enter the following command as <code class="literal">root</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install tang</strong></span></pre></li><li class="listitem"><p class="simpara">
						Pick an unoccupied port, for example, <span class="emphasis"><em>7500/tcp</em></span>, and allow the <code class="literal">tangd</code> service to bind to that port:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage port -a -t tangd_port_t -p tcp <span class="emphasis"><em>7500</em></span></strong></span></pre><p class="simpara">
						Note that a port can be used only by one service at a time, and thus an attempt to use an already occupied port implies the <code class="literal">ValueError: Port already defined</code> error message.
					</p></li><li class="listitem"><p class="simpara">
						Open the port in the firewall:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-port=<span class="emphasis"><em>7500</em></span>/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre></li><li class="listitem"><p class="simpara">
						Enable the <code class="literal">tangd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable tangd.socket</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an override file:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl edit tangd.socket</strong></span></pre></li><li class="listitem"><p class="simpara">
						In the following editor screen, which opens an empty <code class="literal">override.conf</code> file located in the <code class="literal">/etc/systemd/system/tangd.socket.d/</code> directory, change the default port for the Tang server from 80 to the previously picked number by adding the following lines:
					</p><pre class="screen">[Socket]
ListenStream=
ListenStream=<span class="emphasis"><em>7500</em></span></pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Insert the previous code snippet between the lines starting with <code class="literal"># Anything between here</code> and <code class="literal"># Lines below this</code>, otherwise the system discards your changes.
						</p></div></rh-alert></li><li class="listitem">
						Save the changes by pressing <kbd class="keycap">Ctrl</kbd>+<kbd class="keycap">O</kbd> and <kbd class="keycap">Enter</kbd>. Exit the editor by pressing <kbd class="keycap">Ctrl</kbd>+<kbd class="keycap">X</kbd>.
					</li><li class="listitem"><p class="simpara">
						Reload the changed configuration:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl daemon-reload</strong></span></pre></li><li class="listitem"><p class="simpara">
						Check that your configuration is working:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl show tangd.socket -p Listen</strong></span>
Listen=[::]:7500 (Stream)</pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">tangd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart tangd.socket</strong></span></pre><p class="simpara">
						Because <code class="literal">tangd</code> uses the <code class="literal">systemd</code> socket activation mechanism, the server starts as soon as the first connection comes in. A new set of cryptographic keys is automatically generated at the first start. To perform cryptographic operations such as manual key generation, use the <code class="literal">jose</code> utility.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On your NBDE client, verify that your Tang server works correctly by using the following command. The command must return the identical message you pass for encryption and decryption:
					</p><pre class="screen"># <span class="strong strong"><strong>echo test | clevis encrypt tang '{"url":"<span class="emphasis"><em>&lt;tang.server.example.com:7500&gt;</em></span>"}' -y | clevis decrypt</strong></span>
test</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">tang(8)</code>, <code class="literal">semanage(8)</code>, <code class="literal">firewall-cmd(1)</code>, <code class="literal">jose(1)</code>, <code class="literal">systemd.unit(5)</code>, and <code class="literal">systemd.socket(5)</code> man pages on your system
					</li></ul></div></section><section class="section" id="rotating-tang-keys_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.3. Rotating Tang server keys and updating bindings on clients</h3></div></div></div><p>
				For security reasons, rotate your Tang server keys and update existing bindings on clients periodically. The precise interval at which you should rotate them depends on your application, key sizes, and institutional policy.
			</p><p>
				Alternatively, you can rotate Tang keys by using the <code class="literal">nbde_server</code> RHEL system role. See <a class="link" href="#using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles" title="10.16.1. Using the nbde_server RHEL system role for setting up multiple Tang servers">Using the nbde_server system role for setting up multiple Tang servers</a> for more information.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A Tang server is running.
					</li><li class="listitem">
						The <code class="literal">clevis</code> and <code class="literal">clevis-luks</code> packages are installed on your clients.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Rename all keys in the <code class="literal">/var/db/tang</code> key database directory to have a leading <code class="literal">.</code> to hide them from advertisement. Note that the file names in the following example differs from unique file names in the key database directory of your Tang server:
					</p><pre class="screen"># <span class="strong strong"><strong>cd <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
# <span class="strong strong"><strong>ls -l</strong></span>
-rw-r--r--. 1 root root 349 Feb  7 14:55 UV6dqXSwe1bRKG3KbJmdiR020hY.jwk
-rw-r--r--. 1 root root 354 Feb  7 14:55 y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk
# <span class="strong strong"><strong>mv UV6dqXSwe1bRKG3KbJmdiR020hY.jwk .UV6dqXSwe1bRKG3KbJmdiR020hY.jwk</strong></span>
# <span class="strong strong"><strong>mv y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk .y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk</strong></span></pre></li><li class="listitem"><p class="simpara">
						Check that you renamed and therefore hid all keys from the Tang server advertisement:
					</p><pre class="screen"># <span class="strong strong"><strong>ls -l</strong></span>
total 0</pre></li><li class="listitem"><p class="simpara">
						Generate new keys using the <code class="literal">/usr/libexec/tangd-keygen</code> command in <code class="literal">/var/db/tang</code> on the Tang server:
					</p><pre class="screen"># <span class="strong strong"><strong>/usr/libexec/tangd-keygen <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
# <span class="strong strong"><strong>ls <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
3ZWS6-cDrCG61UPJS2BMmPU4I54.jwk zyLuX6hijUy_PSeUEFDi7hi38.jwk</pre></li><li class="listitem"><p class="simpara">
						Check that your Tang server advertises the signing key from the new key pair, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>tang-show-keys <span class="emphasis"><em>7500</em></span></strong></span>
3ZWS6-cDrCG61UPJS2BMmPU4I54</pre></li><li class="listitem"><p class="simpara">
						On your NBDE clients, use the <code class="literal">clevis luks report</code> command to check if the keys advertised by the Tang server remains the same. You can identify slots with the relevant binding using the <code class="literal">clevis luks list</code> command, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks list -d <span class="emphasis"><em>/dev/sda2</em></span></strong></span>
1: tang '{"url":"<span class="emphasis"><em>http://tang.srv</em></span>"}'
# <span class="strong strong"><strong>clevis luks report -d <span class="emphasis"><em>/dev/sda2</em></span> -s <span class="emphasis"><em>1</em></span></strong></span>
...
Report detected that some keys were rotated.
Do you want to regenerate luks metadata with "clevis luks regen -d /dev/sda2 -s 1"? [ynYN]</pre></li><li class="listitem"><p class="simpara">
						To regenerate LUKS metadata for the new keys either press <code class="literal">y</code> to the prompt of the previous command, or use the <code class="literal">clevis luks regen</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks regen -d <span class="emphasis"><em>/dev/sda2</em></span> -s <span class="emphasis"><em>1</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						When you are sure that all old clients use the new keys, you can remove the old keys from the Tang server, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cd <span class="emphasis"><em>/var/db/tang</em></span></strong></span>
# <span class="strong strong"><strong>rm .*.jwk</strong></span></pre></li></ol></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Removing the old keys while clients are still using them can result in data loss. If you accidentally remove such keys, use the <code class="literal">clevis luks regen</code> command on the clients, and provide your LUKS password manually.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">tang-show-keys(1)</code>, <code class="literal">clevis-luks-list(1)</code>, <code class="literal">clevis-luks-report(1)</code>, and <code class="literal">clevis-luks-regen(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="configuring-automated-unlocking-using-a-tang-key-in-the-web-console_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.4. Configuring automated unlocking by using a Tang key in the web console</h3></div></div></div><p>
				You can configure automated unlocking of a LUKS-encrypted storage device using a key provided by a Tang server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have installed the RHEL 9 web console.
					</p><p class="simpara">
						For instructions, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console">Installing and enabling the web console</a>.
					</p></li><li class="listitem">
						The <code class="literal">cockpit-storaged</code> and <code class="literal">clevis-luks</code> packages are installed on your system.
					</li><li class="listitem">
						The <code class="literal">cockpit.socket</code> service is running at port 9090.
					</li><li class="listitem">
						A Tang server is available. See <a class="link" href="#deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" title="10.2. Deploying a Tang server with SELinux in enforcing mode">Deploying a Tang server with SELinux in enforcing mode</a> for details.
					</li><li class="listitem">
						You have <code class="literal">root</code> privileges or permissions to enter administrative commands with <code class="literal">sudo</code>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the RHEL 9 web console.
					</p><p class="simpara">
						For details, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console">Logging in to the web console</a>.
					</p></li><li class="listitem">
						Switch to administrative access, provide your credentials, and click <span class="guibutton">Storage</span>. In the <span class="strong strong"><strong>Storage</strong></span> table, click the disk that contains an encrypted volume you plan to add to unlock automatically.
					</li><li class="listitem"><p class="simpara">
						In the following page with details of the selected disk, click <span class="guibutton">+</span> in the <span class="strong strong"><strong>Keys</strong></span> section to add a Tang key:
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/8994ea1c421cf66cb10392220ef97533/web-console-disk-encryption.png" alt="RHEL web console: Encryption"></div></div></li><li class="listitem"><p class="simpara">
						Select <code class="literal">Tang keyserver</code> as <code class="literal">Key source</code>, provide the address of your Tang server, and a password that unlocks the LUKS-encrypted device. Click <span class="guibutton">Add</span> to confirm:
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/72cd4123b92f2472b3d30b3a1ce12e88/web-console-add-tang-key.png" alt="RHEL web console: Add Tang key"></div></div><p class="simpara">
						The following dialog window provides a command to verify that the key hash matches.
					</p></li><li class="listitem"><p class="simpara">
						In a terminal on the Tang server, use the <code class="literal">tang-show-keys</code> command to display the key hash for comparison. In this example, the Tang server is running on the port <span class="emphasis"><em>7500</em></span>:
					</p><pre class="screen"># <span class="strong strong"><strong>tang-show-keys <span class="emphasis"><em>7500</em></span></strong></span>
x100_1k6GPiDOaMlL3WbpCjHOy9ul1bSfdhI3M08wO0</pre></li><li class="listitem"><p class="simpara">
						Click <span class="guibutton">Trust key</span> when the key hashes in the web console and in the output of previously listed commands are the same:
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/54a6b130eab4415f92e9bdecfcf4321b/web-console-verify-tang-key.png" alt="RHEL web console: Verify Tang key"></div></div></li><li class="listitem">
						In RHEL 9.2 and later, after you select an encrypted root file system and a Tang server, you can skip adding the <code class="literal">rd.neednet=1</code> parameter to the kernel command line, installing the <code class="literal">clevis-dracut</code> package, and regenerating an initial RAM disk (<code class="literal">initrd</code>). For non-root file systems, the web console now enables the <code class="literal">remote-cryptsetup.target</code> and <code class="literal">clevis-luks-akspass.path</code> <code class="literal">systemd</code> units, installs the <code class="literal">clevis-systemd</code> package, and adds the <code class="literal">_netdev</code> parameter to the <code class="literal">fstab</code> and <code class="literal">crypttab</code> configuration files.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the newly added Tang key is now listed in the <span class="strong strong"><strong>Keys</strong></span> section with the <code class="literal">Keyserver</code> type:
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/4748edf7dcc02e012be459a8ef260007/web-console-disk-encryption-with-tang-key.png" alt="RHEL web console: A keyserver key is listed"></div></div></li><li class="listitem"><p class="simpara">
						Verify that the bindings are available for the early boot, for example:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>lsinitrd | grep clevis-luks</strong></span>
lrwxrwxrwx   1 root     root           48 Jan  4 02:56 etc/systemd/system/cryptsetup.target.wants/clevis-luks-askpass.path -&gt; /usr/lib/systemd/system/clevis-luks-askpass.path
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console">Getting started using the RHEL web console</a>
					</li></ul></div></section><section class="section" id="basic-nbde-and-tpm2-encryption-client-operations_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.5. Basic NBDE and TPM2 encryption-client operations</h3></div></div></div><p class="_abstract _abstract">
				The Clevis framework can encrypt plain-text files and decrypt both ciphertexts in the JSON Web Encryption (JWE) format and LUKS-encrypted block devices. Clevis clients can use either Tang network servers or Trusted Platform Module 2.0 (TPM 2.0) chips for cryptographic operations.
			</p><p>
				The following commands demonstrate the basic functionality provided by Clevis on examples containing plain-text files. You can also use them for troubleshooting your NBDE or Clevis+TPM deployments.
			</p><div class="itemizedlist"><p class="title"><strong>Encryption client bound to a Tang server</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To check that a Clevis encryption client binds to a Tang server, use the <code class="literal command">clevis encrypt tang</code> sub-command:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tang '{"url":"<span class="emphasis"><em>http://tang.srv:port</em></span>"}' &lt; <span class="emphasis"><em>input-plain.txt</em></span> &gt; <span class="emphasis"><em>secret.jwe</em></span></strong></span>
The advertisement contains the following signing keys:

_OsIk0T-E2l6qjfdDiwVmidoZjA

Do you wish to trust these keys? [ynYN] y</pre><p class="simpara">
						Change the <code class="literal"><span class="emphasis"><em>http://tang.srv:port</em></span></code> URL in the previous example to match the URL of the server where <code class="literal package">tang</code> is installed. The <code class="literal"><span class="emphasis"><em>secret.jwe</em></span></code> output file contains your encrypted cipher text in the JWE format. This cipher text is read from the <code class="literal"><span class="emphasis"><em>input-plain.txt</em></span></code> input file.
					</p><p class="simpara">
						Alternatively, if your configuration requires a non-interactive communication with a Tang server without SSH access, you can download an advertisement and save it to a file:
					</p><pre class="screen">$ <span class="strong strong"><strong>curl -sfg <span class="emphasis"><em>http://tang.srv:port</em></span>/adv -o <span class="emphasis"><em>adv.jws</em></span></strong></span></pre><p class="simpara">
						Use the advertisement in the <code class="literal"><span class="emphasis"><em>adv.jws</em></span></code> file for any following tasks, such as encryption of files or messages:
					</p><pre class="screen">$ <span class="strong strong"><strong>echo 'hello' | clevis encrypt tang '{"url":"<span class="emphasis"><em>http://tang.srv:port</em></span>","adv":"<span class="emphasis"><em>adv.jws</em></span>"}'</strong></span></pre></li><li class="listitem"><p class="simpara">
						To decrypt data, use the <code class="literal command">clevis decrypt</code> command and provide the cipher text (JWE):
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis decrypt &lt; <span class="emphasis"><em>secret.jwe</em></span> &gt; <span class="emphasis"><em>output-plain.txt</em></span></strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Encryption client using TPM 2.0</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To encrypt using a TPM 2.0 chip, use the <code class="literal command">clevis encrypt tpm2</code> sub-command with the only argument in form of the JSON configuration object:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tpm2 '{}' &lt; <span class="emphasis"><em>input-plain.txt</em></span> &gt; <span class="emphasis"><em>secret.jwe</em></span></strong></span></pre><p class="simpara">
						To choose a different hierarchy, hash, and key algorithms, specify configuration properties, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tpm2 '{"hash":"sha256","key":"rsa"}' &lt; <span class="emphasis"><em>input-plain.txt</em></span> &gt; <span class="emphasis"><em>secret.jwe</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To decrypt the data, provide the ciphertext in the JSON Web Encryption (JWE) format:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis decrypt &lt; <span class="emphasis"><em>secret.jwe</em></span> &gt; <span class="emphasis"><em>output-plain.txt</em></span></strong></span></pre></li></ul></div><p>
				The pin also supports sealing data to a Platform Configuration Registers (PCR) state. That way, the data can only be unsealed if the PCR hashes values match the policy used when sealing.
			</p><p>
				For example, to seal the data to the PCR with index 0 and 7 for the SHA-256 bank:
			</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tpm2 '{"pcr_bank":"sha256","pcr_ids":"0,7"}' &lt; <span class="emphasis"><em>input-plain.txt</em></span> &gt; <span class="emphasis"><em>secret.jwe</em></span></strong></span></pre><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Hashes in PCRs can be rewritten, and you no longer can unlock your encrypted volume. For this reason, add a strong passphrase that enable you to unlock the encrypted volume manually even when a value in a PCR changes.
				</p><p>
					If the system cannot automatically unlock your encrypted volume after an upgrade of the <code class="literal package">shim-x64</code> package, follow the steps in the <a class="link" href="https://access.redhat.com/solutions/6175492">Clevis TPM2 no longer decrypts LUKS devices after a restart</a> KCS article.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">clevis-encrypt-tang(1)</code>, <code class="literal">clevis-luks-unlockers(7)</code>, <code class="literal">clevis(1)</code>, and <code class="literal">clevis-encrypt-tpm2(1)</code> man pages on your system
					</li><li class="listitem"><p class="simpara">
						<code class="literal">clevis</code>, <code class="literal">clevis decrypt</code>, and <code class="literal">clevis encrypt tang</code> commands without any arguments show the built-in CLI help, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>clevis encrypt tang</strong></span>
Usage: clevis encrypt tang CONFIG &lt; PLAINTEXT &gt; JWE
...</pre></li></ul></div></section><section class="section" id="configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes</h3></div></div></div><p>
				With the Clevis framework, you can configure clients for automated unlocking of LUKS-encrypted volumes when a selected Tang server is available. This creates an NBDE (Network-Bound Disk Encryption) deployment.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A Tang server is running and available.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To automatically unlock an existing LUKS-encrypted volume, install the <code class="literal">clevis-luks</code> subpackage:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install clevis-luks</strong></span></pre></li><li class="listitem"><p class="simpara">
						Identify the LUKS-encrypted volume for PBD. In the following example, the block device is referred as <span class="emphasis"><em>/dev/sda2</em></span>:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>lsblk</strong></span>
NAME                                          MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT
sda                                             8:0    0    12G  0 disk
├─sda1                                          8:1    0     1G  0 part  /boot
└─sda2                                          8:2    0    11G  0 part
  └─luks-40e20552-2ade-4954-9d56-565aa7994fb6 253:0    0    11G  0 crypt
    ├─rhel-root                               253:0    0   9.8G  0 lvm   /
    └─rhel-swap                               253:1    0   1.2G  0 lvm   [SWAP]</pre></li><li class="listitem"><p class="simpara">
						Bind the volume to a Tang server using the <code class="literal command">clevis luks bind</code> command:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>clevis luks bind -d <span class="emphasis"><em>/dev/sda2</em></span> tang '{"url":"<span class="emphasis"><em>http://tang.srv</em></span>"}'</strong></span>
The advertisement contains the following signing keys:

_OsIk0T-E2l6qjfdDiwVmidoZjA

Do you wish to trust these keys? [ynYN] y
You are about to initialize a LUKS device for metadata storage.
Attempting to initialize it may result in data loss if data was
already written into the LUKS header gap in a different format.
A backup is advised before initialization is performed.

Do you wish to initialize /dev/sda2? [yn] y
Enter existing LUKS password:</pre><p class="simpara">
						This command performs four steps:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Creates a new key with the same entropy as the LUKS master key.
							</li><li class="listitem">
								Encrypts the new key with Clevis.
							</li><li class="listitem">
								Stores the Clevis JWE object in the LUKS2 header token or uses LUKSMeta if the non-default LUKS1 header is used.
							</li><li class="listitem">
								Enables the new key for use with LUKS.
							</li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							The binding procedure assumes that there is at least one free LUKS password slot. The <code class="literal">clevis luks bind</code> command takes one of the slots.
						</p></div></rh-alert><p class="simpara">
						The volume can now be unlocked with your existing password as well as with the Clevis policy.
					</p></li><li class="listitem"><p class="simpara">
						To enable the early boot system to process the disk binding, use the <code class="literal">dracut</code> tool on an already installed system. In RHEL, Clevis produces a generic <code class="literal">initrd</code> (initial RAM disk) without host-specific configuration options and does not automatically add parameters such as <code class="literal">rd.neednet=1</code> to the kernel command line. If your configuration relies on a Tang pin that requires network during early boot, use the <code class="literal">--hostonly-cmdline</code> argument and <code class="literal">dracut</code> adds <code class="literal">rd.neednet=1</code> when it detects a Tang binding:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Install the <code class="literal">clevis-dracut</code> package:
							</p><pre class="screen"># <span class="strong strong"><strong>dnf install clevis-dracut</strong></span></pre></li><li class="listitem"><p class="simpara">
								Regenerate the initial RAM disk:
							</p><pre class="screen"># <span class="strong strong"><strong>dracut -fv --regenerate-all --hostonly-cmdline</strong></span></pre></li><li class="listitem"><p class="simpara">
								Alternatively, create a .conf file in the <code class="literal">/etc/dracut.conf.d/</code> directory, and add the <code class="literal">hostonly_cmdline=yes</code> option to the file. Then, you can use <code class="literal">dracut</code> without <code class="literal">--hostonly-cmdline</code>, for example:
							</p><pre class="screen"># <span class="strong strong"><strong>echo "hostonly_cmdline=yes" &gt; /etc/dracut.conf.d/clevis.conf</strong></span>
# <span class="strong strong"><strong>dracut -fv --regenerate-all</strong></span></pre></li><li class="listitem"><p class="simpara">
								You can also ensure that networking for a Tang pin is available during early boot by using the <code class="literal">grubby</code> tool on the system where Clevis is installed:
							</p><pre class="screen"># <span class="strong strong"><strong>grubby --update-kernel=ALL --args="rd.neednet=1"</strong></span></pre></li></ol></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the Clevis JWE object is successfully placed in a LUKS header, use the <code class="literal">clevis luks list</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks list -d <span class="emphasis"><em>/dev/sda2</em></span></strong></span>
1: tang '{"url":"http://tang.srv:port"}'</pre></li><li class="listitem"><p class="simpara">
						Check that the bindings are available for the early boot, for example:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>lsinitrd | grep clevis-luks</strong></span>
lrwxrwxrwx   1 root     root           48 Jan  4 02:56 etc/systemd/system/cryptsetup.target.wants/clevis-luks-askpass.path -&gt; /usr/lib/systemd/system/clevis-luks-askpass.path
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">clevis-luks-bind(1)</code> and <code class="literal">dracut.cmdline(7)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/boot_options_for_rhel_installer/kickstart-and-advanced-boot-options_boot-options-for-rhel-installer#network-boot-options_kickstart-and-advanced-boot-options">Network boot options</a> in the Boot options for RHEL Installer document
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/sysadmin/network-confi-initrd">Looking forward to Linux network configuration in the initial ramdisk (initrd)</a> (Red Hat Enable Sysadmin)
					</li></ul></div></section><section class="section" id="configuring-nbde-clients-with-static-ip-configuration_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.7. Configuring NBDE clients with static IP configuration</h3></div></div></div><p>
				To use NBDE for clients with static IP configuration (without DHCP), you must pass your network configuration to the <code class="literal">dracut</code> tool manually.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A Tang server is running and available.
					</li><li class="listitem"><p class="simpara">
						The NBDE client is configured for automated unlocking of encrypted volumes by the Tang server.
					</p><p class="simpara">
						For details, see <a class="link" href="#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" title="10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes">Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes</a>.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						You can provide your static network configuration as a value for the <code class="literal">kernel-cmdline</code> option in a <code class="literal">dracut</code> command, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>dracut -fv --regenerate-all --kernel-cmdline "ip=192.0.2.10::192.0.2.1:255.255.255.0::ens3:none nameserver=192.0.2.100"</strong></span></pre></li><li class="listitem"><p class="simpara">
						Alternatively, create a .conf file in the <code class="literal">/etc/dracut.conf.d/</code> directory with the static network information and then, regenerate the initial RAM disk image:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /etc/dracut.conf.d/static_ip.conf</strong></span>
kernel_cmdline="ip=192.0.2.10::192.0.2.1:255.255.255.0::ens3:none nameserver=192.0.2.100"
# <span class="strong strong"><strong>dracut -fv --regenerate-all</strong></span></pre></li></ol></div></section><section class="section" id="configuring-manual-enrollment-of-volumes-using-tpm2_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.8. Configuring manual enrollment of LUKS-encrypted volumes by using a TPM 2.0 policy</h3></div></div></div><p>
				You can configure unlocking of LUKS-encrypted volumes by using a Trusted Platform Module 2.0 (TPM 2.0) policy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						An accessible TPM 2.0-compatible device.
					</li><li class="listitem">
						A system with the 64-bit Intel or 64-bit AMD architecture.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To automatically unlock an existing LUKS-encrypted volume, install the <code class="literal package">clevis-luks</code> subpackage:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install clevis-luks</strong></span></pre></li><li class="listitem"><p class="simpara">
						Identify the LUKS-encrypted volume for PBD. In the following example, the block device is referred as <span class="emphasis"><em>/dev/sda2</em></span>:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>lsblk</strong></span>
NAME                                          MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT
sda                                             8:0    0    12G  0 disk
├─sda1                                          8:1    0     1G  0 part  /boot
└─sda2                                          8:2    0    11G  0 part
  └─luks-40e20552-2ade-4954-9d56-565aa7994fb6 253:0    0    11G  0 crypt
    ├─rhel-root                               253:0    0   9.8G  0 lvm   /
    └─rhel-swap                               253:1    0   1.2G  0 lvm   [SWAP]</pre></li><li class="listitem"><p class="simpara">
						Bind the volume to a TPM 2.0 device using the <code class="literal command">clevis luks bind</code> command, for example:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>clevis luks bind -d <span class="emphasis"><em>/dev/sda2</em></span> tpm2 '{"hash":"sha256","key":"rsa"}'</strong></span>
...
Do you wish to initialize /dev/sda2? [yn] y
Enter existing LUKS password:</pre><p class="simpara">
						This command performs four steps:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Creates a new key with the same entropy as the LUKS master key.
							</li><li class="listitem">
								Encrypts the new key with Clevis.
							</li><li class="listitem">
								Stores the Clevis JWE object in the LUKS2 header token or uses LUKSMeta if the non-default LUKS1 header is used.
							</li><li class="listitem"><p class="simpara">
								Enables the new key for use with LUKS.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									The binding procedure assumes that there is at least one free LUKS password slot. The <code class="literal command">clevis luks bind</code> command takes one of the slots.
								</p></div></rh-alert><p class="simpara">
								Alternatively, if you want to seal data to specific Platform Configuration Registers (PCR) states, add the <code class="literal">pcr_bank</code> and <code class="literal">pcr_ids</code> values to the <code class="literal command">clevis luks bind</code> command, for example:
							</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>clevis luks bind -d <span class="emphasis"><em>/dev/sda2</em></span> tpm2 '{"hash":"sha256","key":"rsa","pcr_bank":"sha256","pcr_ids":"0,1"}'</strong></span></pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
									Because the data can only be unsealed if PCR hashes values match the policy used when sealing and the hashes can be rewritten, add a strong passphrase that enable you to unlock the encrypted volume manually when a value in a PCR changes.
								</p><p>
									If the system cannot automatically unlock your encrypted volume after an upgrade of the <code class="literal package">shim-x64</code> package, follow the steps in the <a class="link" href="https://access.redhat.com/solutions/6175492">Clevis TPM2 no longer decrypts LUKS devices after a restart</a> KCS article.
								</p></div></rh-alert></li></ol></div></li><li class="listitem">
						The volume can now be unlocked with your existing password as well as with the Clevis policy.
					</li><li class="listitem"><p class="simpara">
						To enable the early boot system to process the disk binding, use the <code class="literal">dracut</code> tool on an already installed system:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install clevis-dracut</strong></span>
# <span class="strong strong"><strong>dracut -fv --regenerate-all</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To verify that the Clevis JWE object is successfully placed in a LUKS header, use the <code class="literal">clevis luks list</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks list -d <span class="emphasis"><em>/dev/sda2</em></span></strong></span>
1: tpm2 '{"hash":"sha256","key":"rsa"}'</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">clevis-luks-bind(1)</code>, <code class="literal">clevis-encrypt-tpm2(1)</code>, and <code class="literal">dracut.cmdline(7)</code> man pages on your system
					</li></ul></div></section><section class="section" id="removing-a-clevis-pin-from-a-luks-encrypted-volume-manually_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.9. Removing a Clevis pin from a LUKS-encrypted volume manually</h3></div></div></div><p class="_abstract _abstract">
				Use the following procedure for manual removing the metadata created by the <code class="literal">clevis luks bind</code> command and also for wiping a key slot that contains passphrase added by Clevis.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					The recommended way to remove a Clevis pin from a LUKS-encrypted volume is through the <code class="literal">clevis luks unbind</code> command. The removal procedure using <code class="literal">clevis luks unbind</code> consists of only one step and works for both LUKS1 and LUKS2 volumes. The following example command removes the metadata created by the binding step and wipe the key slot <code class="literal"><span class="emphasis"><em>1</em></span></code> on the <code class="literal"><span class="emphasis"><em>/dev/sda2</em></span></code> device:
				</p><pre class="screen"># <span class="strong strong"><strong>clevis luks unbind -d /dev/sda2 -s 1</strong></span></pre></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A LUKS-encrypted volume with a Clevis binding.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check which LUKS version the volume, for example <code class="literal"><span class="emphasis"><em>/dev/sda2</em></span></code>, is encrypted by and identify a slot and a token that is bound to Clevis:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksDump <span class="emphasis"><em>/dev/sda2</em></span></strong></span>
LUKS header information
Version:        2
...
Keyslots:
  0: luks2
...
1: luks2
      Key:        512 bits
      Priority:   normal
      Cipher:     aes-xts-plain64
...
      Tokens:
        0: clevis
              Keyslot:  1
...</pre><p class="simpara">
						In the previous example, the Clevis token is identified by <code class="literal"><span class="emphasis"><em>0</em></span></code> and the associated key slot is <code class="literal"><span class="emphasis"><em>1</em></span></code>.
					</p></li><li class="listitem"><p class="simpara">
						In case of LUKS2 encryption, remove the token:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup token remove --token-id <span class="emphasis"><em>0</em></span> <span class="emphasis"><em>/dev/sda2</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						If your device is encrypted by LUKS1, which is indicated by the <code class="literal">Version: 1</code> string in the output of the <code class="literal">cryptsetup luksDump</code> command, perform this additional step with the <code class="literal">luksmeta wipe</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>luksmeta wipe -d <span class="emphasis"><em>/dev/sda2</em></span> -s <span class="emphasis"><em>1</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Wipe the key slot containing the Clevis passphrase:
					</p><pre class="screen"># <span class="strong strong"><strong>cryptsetup luksKillSlot <span class="emphasis"><em>/dev/sda2</em></span> <span class="emphasis"><em>1</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">clevis-luks-unbind(1)</code>, <code class="literal">cryptsetup(8)</code>, and <code class="literal">luksmeta(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.10. Configuring automated enrollment of LUKS-encrypted volumes by using Kickstart</h3></div></div></div><p class="_abstract _abstract">
				Follow the steps in this procedure to configure an automated installation process that uses Clevis for the enrollment of LUKS-encrypted volumes.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Instruct Kickstart to partition the disk such that LUKS encryption has enabled for all mount points, other than <code class="literal">/boot</code>, with a temporary password. The password is temporary for this step of the enrollment process.
					</p><pre class="screen">part /boot --fstype="xfs" --ondisk=vda --size=256
part / --fstype="xfs" --ondisk=vda --grow --encrypted --passphrase=temppass</pre><p class="simpara">
						Note that OSPP-compliant systems require a more complex configuration, for example:
					</p><pre class="screen">part /boot --fstype="xfs" --ondisk=vda --size=256
part / --fstype="xfs" --ondisk=vda --size=2048 --encrypted --passphrase=temppass
part /var --fstype="xfs" --ondisk=vda --size=1024 --encrypted --passphrase=temppass
part /tmp --fstype="xfs" --ondisk=vda --size=1024 --encrypted --passphrase=temppass
part /home --fstype="xfs" --ondisk=vda --size=2048 --grow --encrypted --passphrase=temppass
part /var/log --fstype="xfs" --ondisk=vda --size=1024 --encrypted --passphrase=temppass
part /var/log/audit --fstype="xfs" --ondisk=vda --size=1024 --encrypted --passphrase=temppass</pre></li><li class="listitem"><p class="simpara">
						Install the related Clevis packages by listing them in the <code class="literal">%packages</code> section:
					</p><pre class="screen">%packages
clevis-dracut
clevis-luks
clevis-systemd
%end</pre></li><li class="listitem">
						Optional: To ensure that you can unlock the encrypted volume manually when required, add a strong passphrase before you remove the temporary passphrase. See the <a class="link" href="https://access.redhat.com/solutions/230993">How to add a passphrase, key, or keyfile to an existing LUKS device</a> article for more information.
					</li><li class="listitem"><p class="simpara">
						Call <code class="literal command">clevis luks bind</code> to perform binding in the <code class="literal">%post</code> section. Afterward, remove the temporary password:
					</p><pre class="screen">%post
clevis luks bind -y -k - -d /dev/vda2 \
tang '{"url":"http://tang.srv"}' &lt;&lt;&lt; "temppass"
cryptsetup luksRemoveKey /dev/vda2 &lt;&lt;&lt; "temppass"
dracut -fv --regenerate-all
%end</pre><p class="simpara">
						If your configuration relies on a Tang pin that requires network during early boot or you use NBDE clients with static IP configurations, you have to modify the <code class="literal">dracut</code> command as described in <a class="link" href="#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" title="10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes">Configuring manual enrollment of LUKS-encrypted volumes</a>.
					</p><p class="simpara">
						Note that the <code class="literal">-y</code> option for the <code class="literal">clevis luks bind</code> command is available from RHEL 8.3. In RHEL 8.2 and older, replace <code class="literal">-y</code> by <code class="literal">-f</code> in the <code class="literal">clevis luks bind</code> command and download the advertisement from the Tang server:
					</p><pre class="screen">%post
curl -sfg http://tang.srv/adv -o adv.jws
clevis luks bind -f -k - -d /dev/vda2 \
tang '{"url":"http://tang.srv","adv":"adv.jws"}' &lt;&lt;&lt; "temppass"
cryptsetup luksRemoveKey /dev/vda2 &lt;&lt;&lt; "temppass"
dracut -fv --regenerate-all
%end</pre><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							The <code class="literal">cryptsetup luksRemoveKey</code> command prevents any further administration of a LUKS2 device on which you apply it. You can recover a removed master key using the <code class="literal">dmsetup</code> command only for LUKS1 devices.
						</p></div></rh-alert></li></ol></div><p>
				You can use an analogous procedure when using a TPM 2.0 policy instead of a Tang server.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">clevis(1)</code>, <code class="literal">clevis-luks-bind(1)</code>, <code class="literal">cryptsetup(8)</code>, and <code class="literal">dmsetup(8)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automatically_installing_rhel/index">Automatically installing RHEL</a>
					</li></ul></div></section><section class="section" id="configuring-automated-unlocking-of-a-luks-encrypted-removable-storage-device_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.11. Configuring automated unlocking of a LUKS-encrypted removable storage device</h3></div></div></div><p class="_abstract _abstract">
				You can set up an automated unlocking process of a LUKS-encrypted USB storage device.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To automatically unlock a LUKS-encrypted removable storage device, such as a USB drive, install the <code class="literal package">clevis-udisks2</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install clevis-udisks2</strong></span></pre></li><li class="listitem"><p class="simpara">
						Reboot the system, and then perform the binding step using the <code class="literal command">clevis luks bind</code> command as described in <a class="link" href="#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" title="10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes">Configuring manual enrollment of LUKS-encrypted volumes</a>, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks bind -d <span class="emphasis"><em>/dev/sdb1</em></span> tang '{"url":"<span class="emphasis"><em>http://tang.srv</em></span>"}'</strong></span></pre></li><li class="listitem"><p class="simpara">
						The LUKS-encrypted removable device can be now unlocked automatically in your GNOME desktop session. The device bound to a Clevis policy can be also unlocked by the <code class="literal command">clevis luks unlock</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>clevis luks unlock -d <span class="emphasis"><em>/dev/sdb1</em></span></strong></span></pre></li></ol></div><p>
				You can use an analogous procedure when using a TPM 2.0 policy instead of a Tang server.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">clevis-luks-unlockers(7)</code> man page on your system
					</li></ul></div></section><section class="section" id="deploying-high-availability-nbde-systems_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.12. Deploying high-availability NBDE systems</h3></div></div></div><p class="_abstract _abstract">
				Tang provides two methods for building a high-availability deployment:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Client redundancy (recommended)</span></dt><dd>
							Clients should be configured with the ability to bind to multiple Tang servers. In this setup, each Tang server has its own keys and clients can decrypt by contacting a subset of these servers. Clevis already supports this workflow through its <code class="literal">sss</code> plug-in. Red Hat recommends this method for a high-availability deployment.
						</dd><dt><span class="term">Key sharing</span></dt><dd>
							For redundancy purposes, more than one instance of Tang can be deployed. To set up a second or any subsequent instance, install the <code class="literal">tang</code> packages and copy the key directory to the new host using <code class="literal">rsync</code> over <code class="literal">SSH</code>. Note that Red Hat does not recommend this method because sharing keys increases the risk of key compromise and requires additional automation infrastructure.
						</dd></dl></div><h5 id="high_available_nbde_using_shamir_s_secret_sharing">High-available NBDE using Shamir’s Secret Sharing</h5><p>
				Shamir’s Secret Sharing (SSS) is a cryptographic scheme that divides a secret into several unique parts. To reconstruct the secret, a number of parts is required. The number is called threshold and SSS is also referred to as a thresholding scheme.
			</p><p>
				Clevis provides an implementation of SSS. It creates a key and divides it into a number of pieces. Each piece is encrypted using another pin including even SSS recursively. Additionally, you define the threshold <code class="literal">t</code>. If an NBDE deployment decrypts at least <code class="literal">t</code> pieces, then it recovers the encryption key and the decryption process succeeds. When Clevis detects a smaller number of parts than specified in the threshold, it prints an error message.
			</p><h5 id="example_1_redundancy_with_two_tang_servers">Example 1: Redundancy with two Tang servers</h5><p>
				The following command decrypts a LUKS-encrypted device when at least one of two Tang servers is available:
			</p><pre class="screen"># <span class="strong strong"><strong>clevis luks bind -d <span class="emphasis"><em>/dev/sda1</em></span> sss '{"t":1,"pins":{"tang":[{"url":"<span class="emphasis"><em>http://tang1.srv</em></span>"},{"url":"<span class="emphasis"><em>http://tang2.srv</em></span>"}]}}'</strong></span></pre><p>
				The previous command used the following configuration scheme:
			</p><pre class="screen">{
    "t":1,
    "pins":{
        "tang":[
            {
                "url":"http://tang1.srv"
            },
            {
                "url":"http://tang2.srv"
            }
        ]
    }
}</pre><p>
				In this configuration, the SSS threshold <code class="literal">t</code> is set to <code class="literal">1</code> and the <code class="literal">clevis luks bind</code> command successfully reconstructs the secret if at least one from two listed <code class="literal">tang</code> servers is available.
			</p><h5 id="example_2_shared_secret_on_a_tang_server_and_a_tpm_device">Example 2: Shared secret on a Tang server and a TPM device</h5><p>
				The following command successfully decrypts a LUKS-encrypted device when both the <code class="literal">tang</code> server and the <code class="literal">tpm2</code> device are available:
			</p><pre class="screen"># <span class="strong strong"><strong>clevis luks bind -d <span class="emphasis"><em>/dev/sda1</em></span> sss '{"t":2,"pins":{"tang":[{"url":"<span class="emphasis"><em>http://tang1.srv</em></span>"}], "tpm2": {"pcr_ids":"0,7"}}}'</strong></span></pre><p>
				The configuration scheme with the SSS threshold 't' set to '2' is now:
			</p><pre class="screen">{
    "t":2,
    "pins":{
        "tang":[
            {
                "url":"http://tang1.srv"
            }
        ],
        "tpm2":{
            "pcr_ids":"0,7"
        }
    }
}</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">tang(8)</code> (section <code class="literal">High Availability</code>), <code class="literal">clevis(1)</code> (section <code class="literal">Shamir’s Secret Sharing</code>), and <code class="literal">clevis-encrypt-sss(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="deployment-of-virtual-machines-in-a-nbde-network_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.13. Deployment of virtual machines in a NBDE network</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal command">clevis luks bind</code> command does not change the LUKS master key. This implies that if you create a LUKS-encrypted image for use in a virtual machine or cloud environment, all the instances that run this image share a master key. This is extremely insecure and should be avoided at all times.
			</p><p>
				This is not a limitation of Clevis but a design principle of LUKS. If your scenario requires having encrypted root volumes in a cloud, perform the installation process (usually using Kickstart) for each instance of Red Hat Enterprise Linux in the cloud as well. The images cannot be shared without also sharing a LUKS master key.
			</p><p>
				To deploy automated unlocking in a virtualized environment, use systems such as <code class="literal">lorax</code> or <code class="literal">virt-install</code> together with a Kickstart file (see <a class="link" href="#configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption" title="10.10. Configuring automated enrollment of LUKS-encrypted volumes by using Kickstart">Configuring automated enrollment of LUKS-encrypted volumes using Kickstart</a>) or another automated provisioning tool to ensure that each encrypted VM has a unique master key.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">clevis-luks-bind(1)</code> man page on your system
					</li></ul></div></section><section class="section" id="building-automatically-enrollable-vm-images-for-cloud-environments_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.14. Building automatically-enrollable VM images for cloud environments by using NBDE</h3></div></div></div><p class="_abstract _abstract">
				Deploying automatically-enrollable encrypted images in a cloud environment can provide a unique set of challenges. Like other virtualization environments, it is recommended to reduce the number of instances started from a single image to avoid sharing the LUKS master key.
			</p><p>
				Therefore, the best practice is to create customized images that are not shared in any public repository and that provide a base for the deployment of a limited amount of instances. The exact number of instances to create should be defined by deployment’s security policies and based on the risk tolerance associated with the LUKS master key attack vector.
			</p><p>
				To build LUKS-enabled automated deployments, systems such as Lorax or virt-install together with a Kickstart file should be used to ensure master key uniqueness during the image building process.
			</p><p>
				Cloud environments enable two Tang server deployment options which we consider here. First, the Tang server can be deployed within the cloud environment itself. Second, the Tang server can be deployed outside of the cloud on independent infrastructure with a VPN link between the two infrastructures.
			</p><p>
				Deploying Tang natively in the cloud does allow for easy deployment. However, given that it shares infrastructure with the data persistence layer of ciphertext of other systems, it may be possible for both the Tang server’s private key and the Clevis metadata to be stored on the same physical disk. Access to this physical disk permits a full compromise of the ciphertext data.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Always maintain a physical separation between the location where the data is stored and the system where Tang is running. This separation between the cloud and the Tang server ensures that the Tang server’s private key cannot be accidentally combined with the Clevis metadata. It also provides local control of the Tang server if the cloud infrastructure is at risk.
				</p></div></rh-alert></section><section class="section" id="proc_deploying-tang-as-a-container_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.15. Deploying Tang as a container</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">tang</code> container image provides Tang-server decryption capabilities for Clevis clients that run either in OpenShift Container Platform (OCP) clusters or in separate virtual machines.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">podman</code> package and its dependencies are installed on the system.
					</li><li class="listitem">
						You have logged in on the <code class="literal">registry.redhat.io</code> container catalog using the <code class="literal">podman login registry.redhat.io</code> command. See <a class="link" href="https://access.redhat.com/RegistryAuthentication">Red Hat Container Registry Authentication</a> for more information.
					</li><li class="listitem">
						The Clevis client is installed on systems containing LUKS-encrypted volumes that you want to automatically unlock by using a Tang server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Pull the <code class="literal">tang</code> container image from the <code class="literal">registry.redhat.io</code> registry:
					</p><pre class="screen"># <span class="strong strong"><strong>podman pull registry.redhat.io/rhel9/tang</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the container, specify its port, and specify the path to the Tang keys. The previous example runs the <code class="literal">tang</code> container, specifies the port <span class="emphasis"><em>7500</em></span>, and indicates a path to the Tang keys of the <code class="literal">/var/db/tang</code> directory:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>podman run -d -p 7500:7500 -v tang-keys:/var/db/tang --name tang registry.redhat.io/rhel9/tang</strong></span></pre><p class="simpara">
						Note that Tang uses port 80 by default but this may collide with other services such as the Apache HTTP server.
					</p></li><li class="listitem"><p class="simpara">
						Optional: For increased security, rotate the Tang keys periodically. You can use the <code class="literal">tangd-rotate-keys</code> script, for example:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>podman run --rm -v tang-keys:/var/db/tang registry.redhat.io/rhel9/tang tangd-rotate-keys -v -d /var/db/tang</strong></span>
Rotated key 'rZAMKAseaXBe0rcKXL1hCCIq-DY.jwk' -&gt; .'rZAMKAseaXBe0rcKXL1hCCIq-DY.jwk'
Rotated key 'x1AIpc6WmnCU-CabD8_4q18vDuw.jwk' -&gt; .'x1AIpc6WmnCU-CabD8_4q18vDuw.jwk'
Created new key GrMMX_WfdqomIU_4RyjpcdlXb0E.jwk
Created new key _dTTfn17sZZqVAp80u3ygFDHtjk.jwk
Keys rotated successfully.</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On a system that contains LUKS-encrypted volumes for automated unlocking by the presence of the Tang server, check that the Clevis client can encrypt and decrypt a plain-text message using Tang:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>echo test | clevis encrypt tang '{"url":"http://localhost:7500"}' | clevis decrypt</strong></span>
The advertisement contains the following signing keys:

x1AIpc6WmnCU-CabD8_4q18vDuw

Do you wish to trust these keys? [ynYN] y
test</pre><p class="simpara">
						The previous example command shows the <code class="literal">test</code> string at the end of its output when a Tang server is available on the <span class="emphasis"><em>localhost</em></span> URL and communicates through port <span class="emphasis"><em>7500</em></span>.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">podman(1)</code>, <code class="literal">clevis(1)</code>, and <code class="literal">tang(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption"><div class="titlepage"><div><div><h3 class="title">10.16. Configuring NBDE by using RHEL system roles</h3></div></div></div><p>
				You can use the <code class="literal">nbde_client</code> and <code class="literal">nbde_server</code> RHEL system roles for automated deployments of Policy-Based Decryption (PBD) solutions using Clevis and Tang. The <code class="literal">rhel-system-roles</code> package contains these system roles, the related examples, and also the reference documentation.
			</p><section class="section" id="using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h4 class="title">10.16.1. Using the <code class="literal">nbde_server</code> RHEL system role for setting up multiple Tang servers</h4></div></div></div><p>
					By using the <code class="literal">nbde_server</code> system role, you can deploy and manage a Tang server as part of an automated disk encryption solution. This role supports the following features:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Rotating Tang keys
						</li><li class="listitem">
							Deploying and backing up Tang keys
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Deploy a Tang server
- hosts: tang.server.example.com
- tasks:
  - name: Install and configure periodic key rotation
    ansible.builtin.include_role:
        name: rhel-system-roles.nbde_server
    vars:
      nbde_server_rotate_keys: yes
      nbde_server_manage_firewall: true
      nbde_server_manage_selinux: true</pre><p class="simpara">
							This example playbook ensures deploying of your Tang server and a key rotation.
						</p><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">nbde_server_manage_firewall: true</code></span></dt><dd>
										Use the <code class="literal">firewall</code> system role to manage ports used by the <code class="literal">nbde_server</code> role.
									</dd><dt><span class="term"><code class="literal">nbde_server_manage_selinux: true</code></span></dt><dd><p class="simpara">
										Use the <code class="literal">selinux</code> system role to manage ports used by the <code class="literal">nbde_server</code> role.
									</p><p class="simpara">
										For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_server/README.md</code> file on the control node.
									</p></dd></dl></div></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							On your NBDE client, verify that your Tang server works correctly by using the following command. The command must return the identical message you pass for encryption and decryption:
						</p><pre class="screen"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'echo test | clevis encrypt tang '{"url":"<span class="emphasis"><em>&lt;tang.server.example.com&gt;</em></span>"}' -y | clevis decrypt'</strong></span>
test</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_server/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/nbde_server/</code> directory
						</li></ul></div></section><section class="section" id="using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h4 class="title">10.16.2. Setting up Clevis clients with DHCP by using the <code class="literal">nbde_client</code> RHEL system role</h4></div></div></div><p>
					The <code class="literal">nbde_client</code> system role enables you to deploy multiple Clevis clients in an automated way.
				</p><p>
					This role supports binding a LUKS-encrypted volume to one or more Network-Bound (NBDE) servers - Tang servers. You can either preserve the existing volume encryption with a passphrase or remove it. After removing the passphrase, you can unlock the volume only using NBDE. This is useful when a volume is initially encrypted using a temporary key or password that you should remove after you provision the system.
				</p><p>
					If you provide both a passphrase and a key file, the role uses what you have provided first. If it does not find any of these valid, it attempts to retrieve a passphrase from an existing binding.
				</p><p>
					Policy-Based Decryption (PBD) defines a binding as a mapping of a device to a slot. This means that you can have multiple bindings for the same device. The default slot is slot 1.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						The <code class="literal">nbde_client</code> system role supports only Tang bindings. Therefore, you cannot use it for TPM2 bindings.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							A volume that is already encrypted by using LUKS.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure clients for unlocking of encrypted volumes by Tang servers
  hosts: managed-node-01.example.com
  tasks:
    - name: Create NBDE client bindings
      ansible.builtin.include_role:
        name: rhel-system-roles.nbde_client
      vars:
        nbde_client_bindings:
          - device: /dev/rhel/root
            encryption_key_src: /etc/luks/keyfile
            nbde_client_early_boot: true
            state: present
            servers:
              - http://server1.example.com
              - http://server2.example.com
          - device: /dev/rhel/swap
            encryption_key_src: /etc/luks/keyfile
            servers:
              - http://server1.example.com
              - http://server2.example.com</pre><p class="simpara">
							This example playbook configures Clevis clients for automated unlocking of two LUKS-encrypted volumes when at least one of two Tang servers is available.
						</p><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">state: present</code></span></dt><dd>
										The values of <code class="literal">state</code> indicate the configuration after you run the playbook. Use the <code class="literal">present</code> value for either creating a new binding or updating an existing one. Contrary to a <code class="literal">clevis luks bind</code> command, you can use <code class="literal">state: present</code> also for overwriting an existing binding in its device slot. The <code class="literal">absent</code> value removes a specified binding.
									</dd><dt><span class="term"><code class="literal">nbde_client_early_boot: true</code></span></dt><dd><p class="simpara">
										The <code class="literal">nbde_client</code> role ensures that networking for a Tang pin is available during early boot by default. If you scenario requires to disable this feature, add the <code class="literal">nbde_client_early_boot: false</code> variable to your playbook.
									</p><p class="simpara">
										For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md</code> file on the control node.
									</p></dd></dl></div></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							On your NBDE client, check that the encrypted volume that should be automatically unlocked by your Tang servers contain the corresponding information in its LUKS pins:
						</p><pre class="screen"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'clevis luks list -d /dev/rhel/root'</strong></span>
1: tang '{"url":"<span class="emphasis"><em>&lt;http://server1.example.com/&gt;</em></span>"}'
2: tang '{"url":"<span class="emphasis"><em>&lt;http://server2.example.com/&gt;</em></span>"}'</pre></li><li class="listitem"><p class="simpara">
							If you do not use the <code class="literal">nbde_client_early_boot: false</code> variable, verify that the bindings are available for the early boot, for example:
						</p><pre class="screen"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'lsinitrd | grep clevis-luks'</strong></span>
lrwxrwxrwx   1 root     root           48 Jan  4 02:56 etc/systemd/system/cryptsetup.target.wants/clevis-luks-askpass.path -&gt; /usr/lib/systemd/system/clevis-luks-askpass.path
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/nbde_client/</code> directory
						</li></ul></div></section><section class="section" id="setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h4 class="title">10.16.3. Setting up static-IP Clevis clients by using the <code class="literal">nbde_client</code> RHEL system role</h4></div></div></div><p>
					The <code class="literal">nbde_client</code> RHEL system role supports only scenarios with Dynamic Host Configuration Protocol (DHCP). On an NBDE client with static IP configuration, you must pass your network configuration as a kernel boot parameter.
				</p><p>
					Typically, administrators want to reuse a playbook and not maintain individual playbooks for each host to which Ansible assigns static IP addresses during early boot. In this case, you can use variables in the playbook and provide the settings in an external file. As a result, you need only one playbook and one file with the settings.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							A volume that is already encrypted by using LUKS.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a file with the network settings of your hosts, for example, <code class="literal">static-ip-settings-clients.yml</code>, and add the values you want to dynamically assign to the hosts:
						</p><pre class="programlisting language-yaml">clients:
  managed-node-01.example.com:
    ip_v4: 192.0.2.1
    gateway_v4: 192.0.2.254
    netmask_v4: 255.255.255.0
    interface: enp1s0
  managed-node-02.example.com:
    ip_v4: 192.0.2.2
    gateway_v4: 192.0.2.254
    netmask_v4: 255.255.255.0
    interface: enp1s0</pre></li><li class="listitem"><p class="simpara">
							Create a playbook file, for example, <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">- name: Configure clients for unlocking of encrypted volumes by Tang servers
  hosts: managed-node-01.example.com,managed-node-02.example.com
  vars_files:
    - ~/static-ip-settings-clients.yml
  tasks:
    - name: Create NBDE client bindings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        nbde_client_bindings:
          - device: /dev/rhel/root
            encryption_key_src: /etc/luks/keyfile
            servers:
              - http://server1.example.com
              - http://server2.example.com
          - device: /dev/rhel/swap
            encryption_key_src: /etc/luks/keyfile
            servers:
              - http://server1.example.com
              - http://server2.example.com

    - name: Configure a Clevis client with static IP address during early boot
      ansible.builtin.include_role:
        name: rhel-system-roles.bootloader
      vars:
        bootloader_settings:
          - kernel: ALL
            options:
              - name: ip
                value: "{{ clients[inventory_hostname]['ip_v4'] }}::{{ clients[inventory_hostname]['gateway_v4'] }}:{{ clients[inventory_hostname]['netmask_v4'] }}::{{ clients[inventory_hostname]['interface'] }}:none"</pre><p class="simpara">
							This playbook reads certain values dynamically for each host listed in the <code class="literal">~/static-ip-settings-clients.yml</code> file.
						</p><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/nbde_client/</code> directory
						</li><li class="listitem">
							<a class="link" href="https://www.redhat.com/sysadmin/network-confi-initrd">Looking forward to Linux network configuration in the initial ramdisk (initrd)</a> (Red Hat Enable Sysadmin)
						</li></ul></div></section></section></section><section class="chapter" id="auditing-the-system_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Auditing the system</h2></div></div></div><p class="_abstract _abstract">
			Audit does not provide additional security to your system; rather, it can be used to discover violations of security policies used on your system. These violations can further be prevented by additional security measures such as SELinux.
		</p><section class="section" id="linux-audit_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.1. Linux Audit</h3></div></div></div><p class="_abstract _abstract">
				The Linux Audit system provides a way to track security-relevant information about your system. Based on pre-configured rules, Audit generates log entries to record as much information about the events that are happening on your system as possible. This information is crucial for mission-critical environments to determine the violator of the security policy and the actions they performed.
			</p><p>
				The following list summarizes some of the information that Audit is capable of recording in its log files:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Date and time, type, and outcome of an event
					</li><li class="listitem">
						Sensitivity labels of subjects and objects
					</li><li class="listitem">
						Association of an event with the identity of the user who triggered the event
					</li><li class="listitem">
						All modifications to Audit configuration and attempts to access Audit log files
					</li><li class="listitem">
						All uses of authentication mechanisms, such as SSH, Kerberos, and others
					</li><li class="listitem">
						Changes to any trusted database, such as <code class="literal">/etc/passwd</code>
					</li><li class="listitem">
						Attempts to import or export information into or from the system
					</li><li class="listitem">
						Include or exclude events based on user identity, subject and object labels, and other attributes
					</li></ul></div><p>
				The use of the Audit system is also a requirement for a number of security-related certifications. Audit is designed to meet or exceed the requirements of the following certifications or compliance guides:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Controlled Access Protection Profile (CAPP)
					</li><li class="listitem">
						Labeled Security Protection Profile (LSPP)
					</li><li class="listitem">
						Rule Set Base Access Control (RSBAC)
					</li><li class="listitem">
						National Industrial Security Program Operating Manual (NISPOM)
					</li><li class="listitem">
						Federal Information Security Management Act (FISMA)
					</li><li class="listitem">
						Payment Card Industry — Data Security Standard (PCI-DSS)
					</li><li class="listitem">
						Security Technical Implementation Guides (STIG)
					</li></ul></div><p>
				Audit has also been:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Evaluated by National Information Assurance Partnership (NIAP) and Best Security Industries (BSI)
					</li><li class="listitem">
						Certified to LSPP/CAPP/RSBAC/EAL4+ on Red Hat Enterprise Linux 5
					</li><li class="listitem">
						Certified to Operating System Protection Profile / Evaluation Assurance Level 4+ (OSPP/EAL4+) on Red Hat Enterprise Linux 6
					</li></ul></div><div class="variablelist"><p class="title"><strong>Use Cases</strong></p><dl class="variablelist"><dt><span class="term">Watching file access</span></dt><dd>
							Audit can track whether a file or a directory has been accessed, modified, executed, or the file’s attributes have been changed. This is useful, for example, to detect access to important files and have an Audit trail available in case one of these files is corrupted.
						</dd><dt><span class="term">Monitoring system calls</span></dt><dd>
							Audit can be configured to generate a log entry every time a particular system call is used. This can be used, for example, to track changes to the system time by monitoring the <code class="literal">settimeofday</code>, <code class="literal">clock_adjtime</code>, and other time-related system calls.
						</dd><dt><span class="term">Recording commands run by a user</span></dt><dd>
							Audit can track whether a file has been executed, so rules can be defined to record every execution of a particular command. For example, a rule can be defined for every executable in the <code class="literal">/bin</code> directory. The resulting log entries can then be searched by user ID to generate an audit trail of executed commands per user.
						</dd><dt><span class="term">Recording execution of system pathnames</span></dt><dd>
							Aside from watching file access which translates a path to an inode at rule invocation, Audit can now watch the execution of a path even if it does not exist at rule invocation, or if the file is replaced after rule invocation. This allows rules to continue to work after upgrading a program executable or before it is even installed.
						</dd><dt><span class="term">Recording security events</span></dt><dd>
							The <code class="literal">pam_faillock</code> authentication module is capable of recording failed login attempts. Audit can be set up to record failed login attempts as well and provides additional information about the user who attempted to log in.
						</dd><dt><span class="term">Searching for events</span></dt><dd>
							Audit provides the <code class="literal application">ausearch</code> utility, which can be used to filter the log entries and provide a complete audit trail based on several conditions.
						</dd><dt><span class="term">Running summary reports</span></dt><dd>
							The <code class="literal application">aureport</code> utility can be used to generate, among other things, daily reports of recorded events. A system administrator can then analyze these reports and investigate suspicious activity further.
						</dd><dt><span class="term">Monitoring network access</span></dt><dd>
							The <code class="literal application">nftables</code>, <code class="literal application">iptables</code>, and <code class="literal application">ebtables</code> utilities can be configured to trigger Audit events, allowing system administrators to monitor network access.
						</dd></dl></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					System performance may be affected depending on the amount of information that is collected by Audit.
				</p></div></rh-alert></section><section class="section" id="audit-system-architecture_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.2. Audit system architecture</h3></div></div></div><p class="_abstract _abstract">
				The Audit system consists of two main parts: the user-space applications and utilities, and the kernel-side system call processing. The kernel component receives system calls from user-space applications and filters them through one of the following filters: <span class="strong strong"><strong>user</strong></span>, <span class="strong strong"><strong>task</strong></span>, <span class="strong strong"><strong>fstype</strong></span>, or <span class="strong strong"><strong>exit</strong></span>.
			</p><p>
				After a system call passes the <span class="strong strong"><strong>exclude</strong></span> filter, it is sent through one of the aforementioned filters, which, based on the Audit rule configuration, sends it to the Audit daemon for further processing.
			</p><p>
				The user-space Audit daemon collects the information from the kernel and creates entries in a log file. Other Audit user-space utilities interact with the Audit daemon, the kernel Audit component, or the Audit log files:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal application">auditctl</code> Audit control utility interacts with the kernel Audit component to manage rules and to control many settings and parameters of the event generation process.
					</li><li class="listitem">
						The remaining Audit utilities take the contents of the Audit log files as input and generate output based on user’s requirements. For example, the <code class="literal application">aureport</code> utility generates a report of all recorded events.
					</li></ul></div><p>
				In RHEL 9, the Audit dispatcher daemon (<code class="literal application">audisp</code>) functionality is integrated in the Audit daemon (<code class="literal">auditd</code>). Configuration files of plugins for the interaction of real-time analytical programs with Audit events are located in the <code class="literal filename">/etc/audit/plugins.d/</code> directory by default.
			</p></section><section class="section" id="configuring-auditd-for-a-secure-environment_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.3. Configuring auditd for a secure environment</h3></div></div></div><p class="_abstract _abstract">
				The default <code class="literal">auditd</code> configuration should be suitable for most environments. However, if your environment must meet strict security policies, you can change the following settings for the Audit daemon configuration in the <code class="literal filename">/etc/audit/auditd.conf</code> file:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">log_file</code></span></dt><dd>
							The directory that holds the Audit log files (usually <code class="literal filename">/var/log/audit/</code>) should reside on a separate mount point. This prevents other processes from consuming space in this directory and provides accurate detection of the remaining space for the Audit daemon.
						</dd><dt><span class="term"><code class="literal">max_log_file</code></span></dt><dd>
							Specifies the maximum size of a single Audit log file, must be set to make full use of the available space on the partition that holds the Audit log files. The <code class="literal">max_log_file`</code> parameter specifies the maximum file size in megabytes. The value given must be numeric.
						</dd><dt><span class="term"><code class="literal">max_log_file_action</code></span></dt><dd>
							Decides what action is taken once the limit set in <code class="literal">max_log_file</code> is reached, should be set to <code class="literal">keep_logs</code> to prevent Audit log files from being overwritten.
						</dd><dt><span class="term"><code class="literal">space_left</code></span></dt><dd>
							Specifies the amount of free space left on the disk for which an action that is set in the <code class="literal">space_left_action</code> parameter is triggered. Must be set to a number that gives the administrator enough time to respond and free up disk space. The <code class="literal">space_left</code> value depends on the rate at which the Audit log files are generated. If the value of space_left is specified as a whole number, it is interpreted as an absolute size in megabytes (MiB). If the value is specified as a number between 1 and 99 followed by a percentage sign (for example, 5%), the Audit daemon calculates the absolute size in megabytes based on the size of the file system containing <code class="literal">log_file</code>.
						</dd><dt><span class="term"><code class="literal">space_left_action</code></span></dt><dd>
							It is recommended to set the <code class="literal">space_left_action</code> parameter to <code class="literal">email</code> or <code class="literal">exec</code> with an appropriate notification method.
						</dd><dt><span class="term"><code class="literal">admin_space_left</code></span></dt><dd>
							Specifies the absolute minimum amount of free space for which an action that is set in the <code class="literal">admin_space_left_action</code> parameter is triggered, must be set to a value that leaves enough space to log actions performed by the administrator. The numeric value for this parameter should be lower than the number for space_left. You can also append a percent sign (for example, 1%) to the number to have the audit daemon calculate the number based on the disk partition size.
						</dd><dt><span class="term"><code class="literal">admin_space_left_action</code></span></dt><dd>
							Should be set to <code class="literal">single</code> to put the system into single-user mode and allow the administrator to free up some disk space.
						</dd><dt><span class="term"><code class="literal">disk_full_action</code></span></dt><dd>
							Specifies an action that is triggered when no free space is available on the partition that holds the Audit log files, must be set to <code class="literal">halt</code> or <code class="literal">single</code>. This ensures that the system is either shut down or operating in single-user mode when Audit can no longer log events.
						</dd><dt><span class="term"><code class="literal">disk_error_action</code></span></dt><dd>
							Specifies an action that is triggered in case an error is detected on the partition that holds the Audit log files, must be set to <code class="literal">syslog</code>, <code class="literal">single</code>, or <code class="literal">halt</code>, depending on your local security policies regarding the handling of hardware malfunctions.
						</dd><dt><span class="term"><code class="literal">flush</code></span></dt><dd>
							Should be set to <code class="literal">incremental_async</code>. It works in combination with the <code class="literal">freq</code> parameter, which determines how many records can be sent to the disk before forcing a hard synchronization with the hard drive. The <code class="literal">freq</code> parameter should be set to <code class="literal">100</code>. These parameters assure that Audit event data is synchronized with the log files on the disk while keeping good performance for bursts of activity.
						</dd></dl></div><p>
				The remaining configuration options should be set according to your local security policy.
			</p></section><section class="section" id="starting-the-audit-service_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.4. Starting and controlling auditd</h3></div></div></div><p class="_abstract _abstract">
				After <code class="literal">auditd</code> is configured, start the service to collect Audit information and store it in the log files. Use the following command as the root user to start <code class="literal">auditd</code>:
			</p><pre class="screen"># <span class="strong strong"><strong>service auditd start</strong></span></pre><p>
				To configure <code class="literal">auditd</code> to start at boot time:
			</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable auditd</strong></span></pre><p>
				You can temporarily disable <code class="literal">auditd</code> with the <code class="literal"># auditctl -e 0</code> command and re-enable it with <code class="literal"># auditctl -e 1</code>.
			</p><p>
				You can perform other actions on <code class="literal">auditd</code> by using the <code class="literal command">service auditd <span class="emphasis"><em>&lt;action&gt;</em></span></code> command, where <span class="emphasis"><em>&lt;action&gt;</em></span> can be one of the following:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal command">stop</code></span></dt><dd>
							Stops <code class="literal">auditd</code>.
						</dd><dt><span class="term"><code class="literal command">restart</code></span></dt><dd>
							Restarts <code class="literal">auditd</code>.
						</dd><dt><span class="term"><code class="literal command">reload</code> or <code class="literal command">force-reload</code></span></dt><dd>
							Reloads the configuration of <code class="literal application">auditd</code> from the <code class="literal">/etc/audit/auditd.conf</code> file.
						</dd><dt><span class="term"><code class="literal command">rotate</code></span></dt><dd>
							Rotates the log files in the <code class="literal">/var/log/audit/</code> directory.
						</dd><dt><span class="term"><code class="literal command">resume</code></span></dt><dd>
							Resumes logging of Audit events after it has been previously suspended, for example, when there is not enough free space on the disk partition that holds the Audit log files.
						</dd><dt><span class="term"><code class="literal command">condrestart</code> or <code class="literal command">try-restart</code></span></dt><dd>
							Restarts <code class="literal application">auditd</code> only if it is already running.
						</dd><dt><span class="term"><code class="literal command">status</code></span></dt><dd>
							Displays the running status of <code class="literal application">auditd</code>.
						</dd></dl></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal command">service</code> command is the only way to correctly interact with the <code class="literal">auditd</code> daemon. You need to use the <code class="literal command">service</code> command so that the <code class="literal">auid</code> value is properly recorded. You can use the <code class="literal command">systemctl</code> command only for two actions: <code class="literal command">enable</code> and <code class="literal command">status</code>.
				</p></div></rh-alert></section><section class="section" id="understanding-audit-log-files_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.5. Understanding Audit log files</h3></div></div></div><p class="_abstract _abstract">
				By default, the Audit system stores log entries in the <code class="literal filename">/var/log/audit/audit.log</code> file; if log rotation is enabled, rotated <code class="literal filename">audit.log</code> files are stored in the same directory.
			</p><p>
				Add the following Audit rule to log every attempt to read or modify the <code class="literal filename">/etc/ssh/sshd_config</code> file:
			</p><pre class="screen"># <span class="strong strong"><strong>auditctl -w /etc/ssh/sshd_config -p warx -k sshd_config</strong></span></pre><p>
				If the <code class="literal">auditd</code> daemon is running, for example, using the following command creates a new event in the Audit log file:
			</p><pre class="screen">$ <span class="strong strong"><strong>cat /etc/ssh/sshd_config</strong></span></pre><p>
				This event in the <code class="literal">audit.log</code> file looks as follows:
			</p><pre class="screen">type=SYSCALL msg=audit(1364481363.243:24287): arch=c000003e syscall=2 success=no exit=-13 a0=7fffd19c5592 a1=0 a2=7fffd19c4b50 a3=a items=1 ppid=2686 pid=3538 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=1 comm="cat" exe="/bin/cat" subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key="sshd_config"
type=CWD msg=audit(1364481363.243:24287):  cwd="/home/shadowman"
type=PATH msg=audit(1364481363.243:24287): item=0 name="/etc/ssh/sshd_config" inode=409248 dev=fd:00 mode=0100600 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:etc_t:s0  nametype=NORMAL cap_fp=none cap_fi=none cap_fe=0 cap_fver=0
type=PROCTITLE msg=audit(1364481363.243:24287) : proctitle=636174002F6574632F7373682F737368645F636F6E666967</pre><p>
				The above event consists of four records, which share the same time stamp and serial number. Records always start with the <code class="literal">type=</code> keyword. Each record consists of several <code class="literal"><span class="emphasis"><em>name</em></span>=<span class="emphasis"><em>value</em></span></code> pairs separated by a white space or a comma. A detailed analysis of the above event follows:
			</p><div class="variablelist"><p class="title"><strong>First Record</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">type=SYSCALL</code></span></dt><dd>
							The <code class="literal">type</code> field contains the type of the record. In this example, the <code class="literal">SYSCALL</code> value specifies that this record was triggered by a system call to the kernel.
						</dd></dl></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287):</code></span></dt><dd><p class="simpara">
							The <code class="literal">msg</code> field records:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A time stamp and a unique ID of the record in the form <code class="literal">audit(<span class="emphasis"><em>time_stamp</em></span>:<span class="emphasis"><em>ID</em></span>)</code>. Multiple records can share the same time stamp and ID if they were generated as part of the same Audit event. The time stamp is using the Unix time format - seconds since 00:00:00 UTC on 1 January 1970.
								</li><li class="listitem">
									Various event-specific <code class="literal"><span class="emphasis"><em>name</em></span>=<span class="emphasis"><em>value</em></span></code> pairs provided by the kernel or user-space applications.
								</li></ul></div></dd><dt><span class="term"><code class="literal">arch=c000003e</code></span></dt><dd>
							The <code class="literal">arch</code> field contains information about the CPU architecture of the system. The value, <code class="literal">c000003e</code>, is encoded in hexadecimal notation. When searching Audit records with the <code class="literal command">ausearch</code> command, use the <code class="literal option">-i</code> or <code class="literal option">--interpret</code> option to automatically convert hexadecimal values into their human-readable equivalents. The <code class="literal">c000003e</code> value is interpreted as <code class="literal">x86_64</code>.
						</dd><dt><span class="term"><code class="literal">syscall=2</code></span></dt><dd>
							The <code class="literal">syscall</code> field records the type of the system call that was sent to the kernel. The value, <code class="literal">2</code>, can be matched with its human-readable equivalent in the <code class="literal">/usr/include/asm/unistd_64.h</code> file. In this case, <code class="literal">2</code> is the <code class="literal">open</code> system call. Note that the <code class="literal application">ausyscall</code> utility allows you to convert system call numbers to their human-readable equivalents. Use the <code class="literal command">ausyscall --dump</code> command to display a listing of all system calls along with their numbers. For more information, see the <code class="literal">ausyscall</code>(8) man page.
						</dd><dt><span class="term"><code class="literal">success=no</code></span></dt><dd>
							The <code class="literal">success</code> field records whether the system call recorded in that particular event succeeded or failed. In this case, the call did not succeed.
						</dd><dt><span class="term"><code class="literal">exit=-13</code></span></dt><dd><p class="simpara">
							The <code class="literal">exit</code> field contains a value that specifies the exit code returned by the system call. This value varies for a different system call. You can interpret the value to its human-readable equivalent with the following command:
						</p><pre class="screen"># <span class="strong strong"><strong>ausearch --interpret --exit -13</strong></span></pre><p class="simpara">
							Note that the previous example assumes that your Audit log contains an event that failed with exit code <code class="literal">-13</code>.
						</p></dd><dt><span class="term"><code class="literal">a0=7fffd19c5592</code>, <code class="literal">a1=0</code>, <code class="literal">a2=7fffd19c5592</code>, <code class="literal">a3=a</code></span></dt><dd>
							The <code class="literal">a0</code> to <code class="literal">a3</code> fields record the first four arguments, encoded in hexadecimal notation, of the system call in this event. These arguments depend on the system call that is used; they can be interpreted by the <code class="literal application">ausearch</code> utility.
						</dd><dt><span class="term"><code class="literal">items=1</code></span></dt><dd>
							The <code class="literal">items</code> field contains the number of PATH auxiliary records that follow the syscall record.
						</dd><dt><span class="term"><code class="literal">ppid=2686</code></span></dt><dd>
							The <code class="literal">ppid</code> field records the Parent Process ID (PPID). In this case, <code class="literal">2686</code> was the PPID of the parent process such as <code class="literal">bash</code>.
						</dd><dt><span class="term"><code class="literal">pid=3538</code></span></dt><dd>
							The <code class="literal">pid</code> field records the Process ID (PID). In this case, <code class="literal">3538</code> was the PID of the <code class="literal">cat</code> process.
						</dd><dt><span class="term"><code class="literal">auid=1000</code></span></dt><dd>
							The <code class="literal">auid</code> field records the Audit user ID, that is the loginuid. This ID is assigned to a user upon login and is inherited by every process even when the user’s identity changes, for example, by switching user accounts with the <code class="literal command">su - john</code> command.
						</dd><dt><span class="term"><code class="literal">uid=1000</code></span></dt><dd>
							The <code class="literal">uid</code> field records the user ID of the user who started the analyzed process. The user ID can be interpreted into user names with the following command: <code class="literal command">ausearch -i --uid <span class="emphasis"><em>UID</em></span></code>.
						</dd><dt><span class="term"><code class="literal">gid=1000</code></span></dt><dd>
							The <code class="literal">gid</code> field records the group ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">euid=1000</code></span></dt><dd>
							The <code class="literal">euid</code> field records the effective user ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">suid=1000</code></span></dt><dd>
							The <code class="literal">suid</code> field records the set user ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">fsuid=1000</code></span></dt><dd>
							The <code class="literal">fsuid</code> field records the file system user ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">egid=1000</code></span></dt><dd>
							The <code class="literal">egid</code> field records the effective group ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">sgid=1000</code></span></dt><dd>
							The <code class="literal">sgid</code> field records the set group ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">fsgid=1000</code></span></dt><dd>
							The <code class="literal">fsgid</code> field records the file system group ID of the user who started the analyzed process.
						</dd><dt><span class="term"><code class="literal">tty=pts0</code></span></dt><dd>
							The <code class="literal">tty</code> field records the terminal from which the analyzed process was invoked.
						</dd><dt><span class="term"><code class="literal">ses=1</code></span></dt><dd>
							The <code class="literal">ses</code> field records the session ID of the session from which the analyzed process was invoked.
						</dd><dt><span class="term"><code class="literal">comm="cat"</code></span></dt><dd>
							The <code class="literal">comm</code> field records the command-line name of the command that was used to invoke the analyzed process. In this case, the <code class="literal command">cat</code> command was used to trigger this Audit event.
						</dd><dt><span class="term"><code class="literal">exe="/bin/cat"</code></span></dt><dd>
							The <code class="literal">exe</code> field records the path to the executable that was used to invoke the analyzed process.
						</dd><dt><span class="term"><code class="literal">subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</code></span></dt><dd>
							The <code class="literal">subj</code> field records the SELinux context with which the analyzed process was labeled at the time of execution.
						</dd><dt><span class="term"><code class="literal">key="sshd_config"</code></span></dt><dd>
							The <code class="literal">key</code> field records the administrator-defined string associated with the rule that generated this event in the Audit log.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>Second Record</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">type=CWD</code></span></dt><dd><p class="simpara">
							In the second record, the <code class="literal">type</code> field value is <code class="literal">CWD</code> — current working directory. This type is used to record the working directory from which the process that invoked the system call specified in the first record was executed.
						</p><p class="simpara">
							The purpose of this record is to record the current process’s location in case a relative path winds up being captured in the associated PATH record. This way the absolute path can be reconstructed.
						</p></dd><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287)</code></span></dt><dd>
							The <code class="literal">msg</code> field holds the same time stamp and ID value as the value in the first record. The time stamp is using the Unix time format - seconds since 00:00:00 UTC on 1 January 1970.
						</dd><dt><span class="term"><code class="literal">cwd="/home/<span class="emphasis"><em>user_name</em></span>"</code></span></dt><dd>
							The <code class="literal">cwd</code> field contains the path to the directory in which the system call was invoked.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>Third Record</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">type=PATH</code></span></dt><dd>
							In the third record, the <code class="literal">type</code> field value is <code class="literal">PATH</code>. An Audit event contains a <code class="literal">PATH</code>-type record for every path that is passed to the system call as an argument. In this Audit event, only one path (<code class="literal filename">/etc/ssh/sshd_config</code>) was used as an argument.
						</dd><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287):</code></span></dt><dd>
							The <code class="literal">msg</code> field holds the same time stamp and ID value as the value in the first and second record.
						</dd><dt><span class="term"><code class="literal">item=0</code></span></dt><dd>
							The <code class="literal">item</code> field indicates which item, of the total number of items referenced in the <code class="literal">SYSCALL</code> type record, the current record is. This number is zero-based; a value of <code class="literal">0</code> means it is the first item.
						</dd><dt><span class="term"><code class="literal">name="/etc/ssh/sshd_config"</code></span></dt><dd>
							The <code class="literal">name</code> field records the path of the file or directory that was passed to the system call as an argument. In this case, it was the <code class="literal filename">/etc/ssh/sshd_config</code> file.
						</dd><dt><span class="term"><code class="literal">inode=409248</code></span></dt><dd><p class="simpara">
							The <code class="literal">inode</code> field contains the inode number associated with the file or directory recorded in this event. The following command displays the file or directory that is associated with the <code class="literal">409248</code> inode number:
						</p><pre class="screen"># <span class="strong strong"><strong>find / -inum 409248 -print</strong></span>
/etc/ssh/sshd_config</pre></dd><dt><span class="term"><code class="literal">dev=fd:00</code></span></dt><dd>
							The <code class="literal">dev</code> field specifies the minor and major ID of the device that contains the file or directory recorded in this event. In this case, the value represents the <code class="literal">/dev/fd/0</code> device.
						</dd><dt><span class="term"><code class="literal">mode=0100600</code></span></dt><dd>
							The <code class="literal">mode</code> field records the file or directory permissions, encoded in numerical notation as returned by the <code class="literal command">stat</code> command in the <code class="literal">st_mode</code> field. See the <code class="literal">stat(2)</code> man page for more information. In this case, <code class="literal">0100600</code> can be interpreted as <code class="literal">-rw-------</code>, meaning that only the root user has read and write permissions to the <code class="literal filename">/etc/ssh/sshd_config</code> file.
						</dd><dt><span class="term"><code class="literal">ouid=0</code></span></dt><dd>
							The <code class="literal">ouid</code> field records the object owner’s user ID.
						</dd><dt><span class="term"><code class="literal">ogid=0</code></span></dt><dd>
							The <code class="literal">ogid</code> field records the object owner’s group ID.
						</dd><dt><span class="term"><code class="literal">rdev=00:00</code></span></dt><dd>
							The <code class="literal">rdev</code> field contains a recorded device identifier for special files only. In this case, it is not used as the recorded file is a regular file.
						</dd><dt><span class="term"><code class="literal">obj=system_u:object_r:etc_t:s0</code></span></dt><dd>
							The <code class="literal">obj</code> field records the SELinux context with which the recorded file or directory was labeled at the time of execution.
						</dd><dt><span class="term"><code class="literal">nametype=NORMAL</code></span></dt><dd>
							The <code class="literal">nametype</code> field records the intent of each path record’s operation in the context of a given syscall.
						</dd><dt><span class="term"><code class="literal">cap_fp=none</code></span></dt><dd>
							The <code class="literal">cap_fp</code> field records data related to the setting of a permitted file system-based capability of the file or directory object.
						</dd><dt><span class="term"><code class="literal">cap_fi=none</code></span></dt><dd>
							The <code class="literal">cap_fi</code> field records data related to the setting of an inherited file system-based capability of the file or directory object.
						</dd><dt><span class="term"><code class="literal">cap_fe=0</code></span></dt><dd>
							The <code class="literal">cap_fe</code> field records the setting of the effective bit of the file system-based capability of the file or directory object.
						</dd><dt><span class="term"><code class="literal">cap_fver=0</code></span></dt><dd>
							The <code class="literal">cap_fver</code> field records the version of the file system-based capability of the file or directory object.
						</dd></dl></div><div class="variablelist"><p class="title"><strong>Fourth Record</strong></p><dl class="variablelist"><dt><span class="term"><code class="literal">type=PROCTITLE</code></span></dt><dd>
							The <code class="literal">type</code> field contains the type of the record. In this example, the <code class="literal">PROCTITLE</code> value specifies that this record gives the full command-line that triggered this Audit event, triggered by a system call to the kernel.
						</dd><dt><span class="term"><code class="literal">proctitle=636174002F6574632F7373682F737368645F636F6E666967</code></span></dt><dd>
							The <code class="literal">proctitle</code> field records the full command-line of the command that was used to invoke the analyzed process. The field is encoded in hexadecimal notation to not allow the user to influence the Audit log parser. The text decodes to the command that triggered this Audit event. When searching Audit records with the <code class="literal command">ausearch</code> command, use the <code class="literal option">-i</code> or <code class="literal option">--interpret</code> option to automatically convert hexadecimal values into their human-readable equivalents. The <code class="literal">636174002F6574632F7373682F737368645F636F6E666967</code> value is interpreted as <code class="literal">cat /etc/ssh/sshd_config</code>.
						</dd></dl></div></section><section class="section" id="using-auditctl-for-defining-and-executing-audit-rules_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.6. Using auditctl for defining and executing Audit rules</h3></div></div></div><p class="_abstract _abstract">
				The Audit system operates on a set of rules that define what is captured in the log files. Audit rules can be set either on the command line using the <code class="literal">auditctl</code> utility or in the <code class="literal filename">/etc/audit/rules.d/</code> directory.
			</p><p>
				The <code class="literal">auditctl</code> command enables you to control the basic functionality of the Audit system and to define rules that decide which Audit events are logged.
			</p><div class="orderedlist"><p class="title"><strong>File-system rules examples</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To define a rule that logs all write access to, and every attribute change of, the <code class="literal">/etc/passwd</code> file:
					</p><pre class="screen"># <span class="strong strong"><strong>auditctl -w /etc/passwd -p wa -k passwd_changes</strong></span></pre></li><li class="listitem"><p class="simpara">
						To define a rule that logs all write access to, and every attribute change of, all the files in the <code class="literal">/etc/selinux/</code> directory:
					</p><pre class="screen"># <span class="strong strong"><strong>auditctl -w /etc/selinux/ -p wa -k selinux_changes</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>System-call rules examples</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To define a rule that creates a log entry every time the <code class="literal">adjtimex</code> or <code class="literal">settimeofday</code> system calls are used by a program, and the system uses the 64-bit architecture:
					</p><pre class="screen"># <span class="strong strong"><strong>auditctl -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time_change</strong></span></pre></li><li class="listitem"><p class="simpara">
						To define a rule that creates a log entry every time a file is deleted or renamed by a system user whose ID is 1000 or larger:
					</p><pre class="screen"># <span class="strong strong"><strong>auditctl -a always,exit -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=1000 -F auid!=4294967295 -k delete</strong></span></pre><p class="simpara">
						Note that the <code class="literal">-F auid!=4294967295</code> option is used to exclude users whose login UID is not set.
					</p></li></ol></div><div class="formalpara"><p class="title"><strong>Executable-file rules</strong></p><p>
					To define a rule that logs all execution of the <code class="literal">/bin/id</code> program, execute the following command:
				</p></div><pre class="screen"># <span class="strong strong"><strong>auditctl -a always,exit -F exe=/bin/id -F arch=b64 -S execve -k execution_bin_id</strong></span></pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">auditctl(8)</code> man page on your system
					</li></ul></div></section><section class="section" id="defining-persistent-audit-rules_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.7. Defining persistent Audit rules</h3></div></div></div><p class="_abstract _abstract">
				To define Audit rules that are persistent across reboots, you must either directly include them in the <code class="literal">/etc/audit/rules.d/audit.rules</code> file or use the <code class="literal">augenrules</code> program that reads rules located in the <code class="literal">/etc/audit/rules.d/</code> directory.
			</p><p>
				Note that the <code class="literal">/etc/audit/audit.rules</code> file is generated whenever the <code class="literal">auditd</code> service starts. Files in <code class="literal">/etc/audit/rules.d/</code> use the same <code class="literal">auditctl</code> command-line syntax to specify the rules. Empty lines and text following a hash sign (#) are ignored.
			</p><p>
				Furthermore, you can use the <code class="literal">auditctl</code> command to read rules from a specified file using the <code class="literal">-R</code> option, for example:
			</p><pre class="screen"># <span class="strong strong"><strong>auditctl -R /usr/share/audit/sample-rules/30-stig.rules</strong></span></pre></section><section class="section" id="pre-configured-audit-rules-files-for-compliance-with-standards_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.8. Pre-configured Audit rules files for compliance with standards</h3></div></div></div><p id="using-pre-configured-rules-files">
				To configure Audit for compliance with a specific certification standard, such as OSPP, PCI DSS, or STIG, you can use the set of pre-configured rules files installed with the <code class="literal">audit</code> package as a starting point. The sample rules are located in the <code class="literal">/usr/share/audit/sample-rules</code> directory.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The Audit sample rules in the <code class="literal">sample-rules</code> directory are not exhaustive nor up to date because security standards are dynamic and subject to change. These rules are provided only to demonstrate how Audit rules can be structured and written. They do not ensure immediate compliance with the latest security standards. To bring your system into compliance with the latest security standards according to specific security guidelines, use the <a class="link" href="#configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities" title="6.1. Configuration compliance tools in RHEL">SCAP-based security compliance tools</a>.
				</p></div></rh-alert><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">30-nispom.rules</code></span></dt><dd>
							Audit rule configuration that meets the requirements specified in the Information System Security chapter of the National Industrial Security Program Operating Manual.
						</dd><dt><span class="term"><code class="literal">30-ospp-v42*.rules</code></span></dt><dd>
							Audit rule configuration that meets the requirements defined in the OSPP (Protection Profile for General Purpose Operating Systems) profile version 4.2.
						</dd><dt><span class="term"><code class="literal">30-pci-dss-v31.rules</code></span></dt><dd>
							Audit rule configuration that meets the requirements set by Payment Card Industry Data Security Standard (PCI DSS) v3.1.
						</dd><dt><span class="term"><code class="literal">30-stig.rules</code></span></dt><dd>
							Audit rule configuration that meets the requirements set by Security Technical Implementation Guides (STIG).
						</dd></dl></div><p>
				To use these configuration files, copy them to the <code class="literal filename">/etc/audit/rules.d/</code> directory and use the <code class="literal command">augenrules --load</code> command, for example:
			</p><pre class="screen"># <span class="strong strong"><strong>cd /usr/share/audit/sample-rules/</strong></span>
# <span class="strong strong"><strong>cp 10-base-config.rules 30-stig.rules 31-privileged.rules 99-finalize.rules /etc/audit/rules.d/</strong></span>
# <span class="strong strong"><strong>augenrules --load</strong></span></pre><p>
				You can order Audit rules using a numbering scheme. See the <code class="literal">/usr/share/audit/sample-rules/README-rules</code> file for more information.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">audit.rules(7)</code> man page on your system
					</li></ul></div></section><section class="section" id="using-augenrules-to-define-persistent-rules_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.9. Using augenrules to define persistent rules</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">augenrules</code> script reads rules located in the <code class="literal filename">/etc/audit/rules.d/</code> directory and compiles them into an <code class="literal filename">audit.rules</code> file. This script processes all files that end with <code class="literal">.rules</code> in a specific order based on their natural sort order. The files in this directory are organized into groups with the following meanings:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">10</span></dt><dd>
							Kernel and auditctl configuration
						</dd><dt><span class="term">20</span></dt><dd>
							Rules that could match general rules but you want a different match
						</dd><dt><span class="term">30</span></dt><dd>
							Main rules
						</dd><dt><span class="term">40</span></dt><dd>
							Optional rules
						</dd><dt><span class="term">50</span></dt><dd>
							Server-specific rules
						</dd><dt><span class="term">70</span></dt><dd>
							System local rules
						</dd><dt><span class="term">90</span></dt><dd>
							Finalize (immutable)
						</dd></dl></div><p>
				The rules are not meant to be used all at once. They are pieces of a policy that should be thought out and individual files copied to <code class="literal filename">/etc/audit/rules.d/</code>. For example, to set a system up in the STIG configuration, copy rules <code class="literal filename">10-base-config</code>, <code class="literal filename">30-stig</code>, <code class="literal filename">31-privileged</code>, and <code class="literal filename">99-finalize</code>.
			</p><p>
				Once you have the rules in the <code class="literal filename">/etc/audit/rules.d/</code> directory, load them by running the <code class="literal">augenrules</code> script with the <code class="literal option">--load</code> directive:
			</p><pre class="screen"># <span class="strong strong"><strong>augenrules --load</strong></span>
/sbin/augenrules: No change
No rules
enabled 1
failure 1
pid 742
rate_limit 0
...</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">audit.rules(8)</code> and <code class="literal">augenrules(8)</code> man pages.
					</li></ul></div></section><section class="section" id="disabling-augenrules_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.10. Disabling augenrules</h3></div></div></div><p class="_abstract _abstract">
				Use the following steps to disable the <code class="literal">augenrules</code> utility. This switches Audit to use rules defined in the <code class="literal">/etc/audit/audit.rules</code> file.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy the <code class="literal">/usr/lib/systemd/system/auditd.service</code> file to the <code class="literal">/etc/systemd/system/</code> directory:
					</p><pre class="screen"># <span class="strong strong"><strong>cp -f /usr/lib/systemd/system/auditd.service /etc/systemd/system/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal">/etc/systemd/system/auditd.service</code> file in a text editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/systemd/system/auditd.service</strong></span></pre></li><li class="listitem"><p class="simpara">
						Comment out the line containing <code class="literal">augenrules</code>, and uncomment the line containing the <code class="literal">auditctl -R</code> command:
					</p><pre class="screen">#ExecStartPost=-/sbin/augenrules --load
ExecStartPost=-/sbin/auditctl -R /etc/audit/audit.rules</pre></li><li class="listitem"><p class="simpara">
						Reload the <code class="literal">systemd</code> daemon to fetch changes in the <code class="literal">auditd.service</code> file:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl daemon-reload</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">auditd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>service auditd restart</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">augenrules(8)</code> and <code class="literal">audit.rules(8)</code> man pages.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/1505033">Auditd service restart overrides changes made to /etc/audit/audit.rules</a> (Red Hat Knowledgebase)
					</li></ul></div></section><section class="section" id="proc_setting-up-audit-to-monitor-software-updates_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.11. Setting up Audit to monitor software updates</h3></div></div></div><p class="_abstract _abstract">
				You can use the pre-configured rule <code class="literal">44-installers.rules</code> to configure Audit to monitor the following utilities that install software:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">dnf</code> <a href="#ftn.idm140081354625568" class="footnote"><sup class="footnote" id="idm140081354625568">[2]</sup></a>
					</li><li class="listitem">
						<code class="literal">yum</code>
					</li><li class="listitem">
						<code class="literal">pip</code>
					</li><li class="listitem">
						<code class="literal">npm</code>
					</li><li class="listitem">
						<code class="literal">cpan</code>
					</li><li class="listitem">
						<code class="literal">gem</code>
					</li><li class="listitem">
						<code class="literal">luarocks</code>
					</li></ul></div><p>
				To monitor the <code class="literal">rpm</code> utility, install the <code class="literal">rpm-plugin-audit</code> package. Audit will then generate <code class="literal">SOFTWARE_UPDATE</code> events when it installs or updates a package. You can list these events by entering <code class="literal">ausearch -m SOFTWARE_UPDATE</code> on the command line.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Pre-configured rule files cannot be used on systems with the <code class="literal">ppc64le</code> and <code class="literal">aarch64</code> architectures.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">auditd</code> is configured in accordance with the settings provided in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/auditing-the-system_security-hardening#configuring-auditd-for-a-secure-environment_auditing-the-system">Configuring auditd for a secure environment</a> .
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy the pre-configured rule file <code class="literal">44-installers.rules</code> from the <code class="literal">/usr/share/audit/sample-rules/</code> directory to the <code class="literal">/etc/audit/rules.d/</code> directory:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /usr/share/audit/sample-rules/44-installers.rules /etc/audit/rules.d/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Load the audit rules:
					</p><pre class="screen"># <span class="strong strong"><strong>augenrules --load</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List the loaded rules:
					</p><pre class="screen"># <span class="strong strong"><strong>auditctl -l</strong></span>
-p x-w /usr/bin/dnf-3 -k software-installer
-p x-w /usr/bin/yum -k software-installer
-p x-w /usr/bin/pip -k software-installer
-p x-w /usr/bin/npm -k software-installer
-p x-w /usr/bin/cpan -k software-installer
-p x-w /usr/bin/gem -k software-installer
-p x-w /usr/bin/luarocks -k software-installer</pre></li><li class="listitem"><p class="simpara">
						Perform an installation, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf reinstall -y vim-enhanced</strong></span></pre></li><li class="listitem"><p class="simpara">
						Search the Audit log for recent installation events, for example:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>ausearch -ts recent -k software-installer</strong></span>
––––
time-&gt;Thu Dec 16 10:33:46 2021
type=PROCTITLE msg=audit(1639668826.074:298): proctitle=2F7573722F6C6962657865632F706C6174666F726D2D707974686F6E002F7573722F62696E2F646E66007265696E7374616C6C002D790076696D2D656E68616E636564
type=PATH msg=audit(1639668826.074:298): item=2 name="/lib64/ld-linux-x86-64.so.2" inode=10092 dev=fd:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:ld_so_t:s0 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0
type=PATH msg=audit(1639668826.074:298): item=1 name="/usr/libexec/platform-python" inode=4618433 dev=fd:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:bin_t:s0 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0
type=PATH msg=audit(1639668826.074:298): item=0 name="/usr/bin/dnf" inode=6886099 dev=fd:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:rpm_exec_t:s0 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0
type=CWD msg=audit(1639668826.074:298): cwd="/root"
type=EXECVE msg=audit(1639668826.074:298): argc=5 a0="/usr/libexec/platform-python" a1="/usr/bin/dnf" a2="reinstall" a3="-y" a4="vim-enhanced"
type=SYSCALL msg=audit(1639668826.074:298): arch=c000003e syscall=59 success=yes exit=0 a0=55c437f22b20 a1=55c437f2c9d0 a2=55c437f2aeb0 a3=8 items=3 ppid=5256 pid=5375 auid=0 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=3 comm="dnf" exe="/usr/libexec/platform-python3.6" subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key="software-installer"</pre></li></ol></div><div class="footnotes"><br><hr width="100" align="left"><div id="ftn.idm140081354625568" class="footnote"><div class="para"><a href="#idm140081354625568" class="simpara"><sup class="simpara">[2] </sup></a>
							Because <code class="literal">dnf</code> is a symlink in RHEL, the path in the <code class="literal">dnf</code> Audit rule must include the target of the symlink. To receive correct Audit events, modify the <code class="literal">44-installers.rules</code> file by changing the <code class="literal">path=/usr/bin/dnf</code> path to <code class="literal">/usr/bin/dnf-3</code>.
						</div></div></div></section><section class="section" id="proc_monitoring-user-login-times-with-audit_auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.12. Monitoring user login times with Audit</h3></div></div></div><p class="_abstract _abstract">
				To monitor which users logged in at specific times, you do not need to configure Audit in any special way. You can use the <code class="literal">ausearch</code> or <code class="literal">aureport</code> tools, which provide different ways of presenting the same information.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">auditd</code> is configured in accordance with the settings provided in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/auditing-the-system_security-hardening#configuring-auditd-for-a-secure-environment_auditing-the-system">Configuring auditd for a secure environment</a> .
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					To display user log in times, use any one of the following commands:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Search the audit log for the <code class="literal">USER_LOGIN</code> message type:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -m USER_LOGIN -ts '<span class="emphasis"><em>12/02/2020</em></span>' '<span class="emphasis"><em>18:00:00</em></span>' -sv <span class="emphasis"><em>no</em></span></strong></span>
time-&gt;Mon Nov 22 07:33:22 2021
type=USER_LOGIN msg=audit(1637584402.416:92): pid=1939 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:sshd_t:s0-s0:c0.c1023 msg='op=login acct="(unknown)" exe="/usr/sbin/sshd" hostname=? addr=10.37.128.108 terminal=ssh res=failed'</pre><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You can specify the date and time with the <code class="literal">-ts</code> option. If you do not use this option, <code class="literal">ausearch</code> provides results from today, and if you omit time, <code class="literal">ausearch</code> provides results from midnight.
							</li><li class="listitem">
								You can use the <code class="literal">-sv yes</code> option to filter out successful login attempts and <code class="literal">-sv no</code> for unsuccessful login attempts.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Pipe the raw output of the <code class="literal">ausearch</code> command into the <code class="literal">aulast</code> utility, which displays the output in a format similar to the output of the <code class="literal">last</code> command. For example:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch --raw | aulast --stdin</strong></span>
root     ssh          10.37.128.108    Mon Nov 22 07:33 - 07:33  (00:00)
root     ssh          10.37.128.108    Mon Nov 22 07:33 - 07:33  (00:00)
root     ssh          10.22.16.106     Mon Nov 22 07:40 - 07:40  (00:00)
reboot   system boot  4.18.0-348.6.el8 Mon Nov 22 07:33</pre></li><li class="listitem"><p class="simpara">
						Display the list of login events by using the <code class="literal">aureport</code> command with the <code class="literal">--login -i</code> options.
					</p><pre class="screen"># <span class="strong strong"><strong>aureport --login -i</strong></span>

Login Report
============================================
# date time auid host term exe success event
============================================
1. 11/16/2021 13:11:30 root 10.40.192.190 ssh /usr/sbin/sshd yes 6920
2. 11/16/2021 13:11:31 root 10.40.192.190 ssh /usr/sbin/sshd yes 6925
3. 11/16/2021 13:11:31 root 10.40.192.190 ssh /usr/sbin/sshd yes 6930
4. 11/16/2021 13:11:31 root 10.40.192.190 ssh /usr/sbin/sshd yes 6935
5. 11/16/2021 13:11:33 root 10.40.192.190 ssh /usr/sbin/sshd yes 6940
6. 11/16/2021 13:11:33 root 10.40.192.190 /dev/pts/0 /usr/sbin/sshd yes 6945</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">ausearch(8)</code>, <code class="literal">aulast(8)</code>, and <code class="literal">aureport(8)</code> man pages on your system
					</li></ul></div></section><section class="section _additional-resources" id="related-information-auditing-the-system"><div class="titlepage"><div><div><h3 class="title">11.13. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <a class="link" href="https://access.redhat.com/articles/4409591">RHEL Audit System Reference</a> Knowledgebase article.
					</li><li class="listitem">
						The <a class="link" href="https://access.redhat.com/articles/4494341">Auditd execution options in a container</a> Knowledgebase article.
					</li><li class="listitem">
						The <a class="link" href="https://github.com/linux-audit/audit-documentation/wiki">Linux Audit Documentation Project page</a>.
					</li><li class="listitem">
						The <code class="literal package">audit</code> package provides documentation in the <code class="literal">/usr/share/doc/audit/</code> directory.
					</li><li class="listitem">
						<code class="literal">auditd(8)</code>, <code class="literal">auditctl(8)</code>, <code class="literal">ausearch(8)</code>, <code class="literal">audit.rules(7)</code>, <code class="literal">audispd.conf(5)</code>, <code class="literal">audispd(8)</code>, <code class="literal">auditd.conf(5)</code>, <code class="literal">ausearch-expression(5)</code>, <code class="literal">aulast(8)</code>, <code class="literal">aulastlog(8)</code>, <code class="literal">aureport(8)</code>, <code class="literal">ausyscall(8)</code>, <code class="literal">autrace(8)</code>, and <code class="literal">auvirt(8)</code> man pages.
					</li></ul></div></section></section><section class="chapter" id="assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 12. Blocking and allowing applications by using fapolicyd</h2></div></div></div><p class="_abstract _abstract">
			Setting and enforcing a policy that either allows or denies application execution based on a rule set efficiently prevents the execution of unknown and potentially malicious software.
		</p><section class="section" id="introduction-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd"><div class="titlepage"><div><div><h3 class="title">12.1. Introduction to fapolicyd</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">fapolicyd</code> software framework controls the execution of applications based on a user-defined policy. This is one of the most efficient ways to prevent running untrusted and possibly malicious applications on the system.
			</p><p>
				The <code class="literal">fapolicyd</code> framework provides the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">fapolicyd</code> service
					</li><li class="listitem">
						<code class="literal">fapolicyd</code> command-line utilities
					</li><li class="listitem">
						<code class="literal">fapolicyd</code> RPM plugin
					</li><li class="listitem">
						<code class="literal">fapolicyd</code> rule language
					</li><li class="listitem">
						<code class="literal">fagenrules</code> script
					</li></ul></div><p>
				The administrator can define the <code class="literal">allow</code> and <code class="literal">deny</code> execution rules for any application with the possibility of auditing based on a path, hash, MIME type, or trust.
			</p><p>
				The <code class="literal">fapolicyd</code> framework introduces the concept of trust. An application is trusted when it is properly installed by the system package manager, and therefore it is registered in the system RPM database. The <code class="literal">fapolicyd</code> daemon uses the RPM database as a list of trusted binaries and scripts. The <code class="literal">fapolicyd</code> RPM plugin registers any system update that is handled by either the DNF package manager or the RPM Package Manager. The plugin notifies the <code class="literal">fapolicyd</code> daemon about changes in this database. Other ways of adding applications require the creation of custom rules and restarting the <code class="literal">fapolicyd</code> service.
			</p><p>
				The <code class="literal">fapolicyd</code> service configuration is located in the <code class="literal">/etc/fapolicyd/</code> directory with the following structure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">/etc/fapolicyd/fapolicyd.trust</code> file contains a list of trusted files. You can also use multiple trust files in the <code class="literal">/etc/fapolicyd/trust.d/</code> directory.
					</li><li class="listitem">
						The <code class="literal">/etc/fapolicyd/rules.d/</code> directory for files containing <code class="literal">allow</code> and <code class="literal">deny</code> execution rules. The <code class="literal">fagenrules</code> script merges these component rules files to the <code class="literal">/etc/fapolicyd/compiled.rules</code> file.
					</li><li class="listitem">
						The <code class="literal">fapolicyd.conf</code> file contains the daemon’s configuration options. This file is useful primarily for performance-tuning purposes.
					</li></ul></div><p>
				Rules in <code class="literal">/etc/fapolicyd/rules.d/</code> are organized in several files, each representing a different policy goal. The numbers at the beginning of the corresponding file names determine the order in <code class="literal">/etc/fapolicyd/compiled.rules</code>:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">10</span></dt><dd>
							Language rules.
						</dd><dt><span class="term">20</span></dt><dd>
							Dracut-related Rules.
						</dd><dt><span class="term">21</span></dt><dd>
							rules for updaters.
						</dd><dt><span class="term">30</span></dt><dd>
							Patterns.
						</dd><dt><span class="term">40</span></dt><dd>
							ELF rules.
						</dd><dt><span class="term">41</span></dt><dd>
							Shared objects rules.
						</dd><dt><span class="term">42</span></dt><dd>
							Trusted ELF rules.
						</dd><dt><span class="term">70</span></dt><dd>
							Trusted language rules.
						</dd><dt><span class="term">72</span></dt><dd>
							Shell rules.
						</dd><dt><span class="term">90</span></dt><dd>
							Deny execute rules.
						</dd><dt><span class="term">95</span></dt><dd>
							Allow open rules.
						</dd></dl></div><p>
				You can use one of the following ways for <code class="literal">fapolicyd</code> integrity checking:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						File-size checking
					</li><li class="listitem">
						Comparing SHA-256 hashes
					</li><li class="listitem">
						Integrity Measurement Architecture (IMA) subsystem
					</li></ul></div><p>
				By default, <code class="literal">fapolicyd</code> does no integrity checking. Integrity checking based on the file size is fast, but an attacker can replace the content of the file and preserve its byte size. Computing and checking SHA-256 checksums is more secure, but it affects the performance of the system. The <code class="literal">integrity = ima</code> option in <code class="literal">fapolicyd.conf</code> requires support for files extended attributes (also known as <code class="literal"><span class="emphasis"><em>xattr</em></span></code>) on all file systems containing executable files.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">fapolicyd(8)</code>, <code class="literal">fapolicyd.rules(5)</code>, <code class="literal">fapolicyd.conf(5)</code>, <code class="literal">fapolicyd.trust(13)</code>, <code class="literal">fagenrules(8)</code>, and <code class="literal">fapolicyd-cli(1)</code> man pages.
					</li><li class="listitem">
						The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel">Enhancing security with the kernel integrity subsystem</a> chapter in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/">Managing, monitoring, and updating the kernel</a> document.
					</li><li class="listitem">
						The documentation installed with the <code class="literal">fapolicyd</code> package in the <code class="literal">/usr/share/doc/fapolicyd/</code> directory and the <code class="literal">/usr/share/fapolicyd/sample-rules/README-rules</code> file.
					</li></ul></div></section><section class="section" id="proc_deploying-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd"><div class="titlepage"><div><div><h3 class="title">12.2. Deploying fapolicyd</h3></div></div></div><p>
				When deploying the <code class="literal">fapolicyd</code> application allowlisting framework, you can either try your configuration in permissive mode first or directly enable the service in the default configuration.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">fapolicyd</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install fapolicyd</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: To try your configuration first, change mode to permissive.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Open the <code class="literal">/etc/fapolicyd/fapolicyd.conf</code> file in a text editor of your choice, for example:
							</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/fapolicyd/fapolicyd.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
								Change the value of the <code class="literal">permissive</code> option from <code class="literal">0</code> to <code class="literal">1</code>, save the file, and exit the editor:
							</p><pre class="screen">permissive = 1</pre><p class="simpara">
								Alternatively, you can debug your configuration by using the <code class="literal">fapolicyd --debug-deny --permissive</code> command before you start the service. See the <a class="link" href="#ref_troubleshooting-problems-related-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd" title="12.6. Troubleshooting problems related to fapolicyd">Troubleshooting problems related to fapolicyd</a> section for more information.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal">fapolicyd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now fapolicyd</strong></span></pre></li><li class="listitem"><p class="simpara">
						If you enabled permissive mode through <code class="literal">/etc/fapolicyd/fapolicyd.conf</code>:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Set the Audit service for recording <code class="literal">fapolicyd</code> events:
							</p><pre class="screen"># <span class="strong strong"><strong>auditctl -w /etc/fapolicyd/ -p wa -k fapolicyd_changes</strong></span>
# <span class="strong strong"><strong>service try-restart auditd</strong></span></pre></li><li class="listitem">
								Use your applications.
							</li><li class="listitem"><p class="simpara">
								Check Audit logs for <code class="literal">fanotify</code> denials, for example:
							</p><pre class="screen"># <span class="strong strong"><strong>ausearch -ts recent -m fanotify</strong></span></pre></li><li class="listitem"><p class="simpara">
								When debugged, disable permissive mode by changing the corresponding value back to <code class="literal">permissive = 0</code>, and restart the service:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart fapolicyd</strong></span></pre></li></ol></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the <code class="literal">fapolicyd</code> service is running correctly:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status fapolicyd</strong></span>
● fapolicyd.service - File Access Policy Daemon
     Loaded: loaded (/usr/lib/systemd/system/fapolicyd.service; enabled; preset: disabled)
     Active: active (running) since Tue 2024-10-08 05:53:50 EDT; 11s ago
…
Oct 08 05:53:51 machine1.example.com fapolicyd[4974]: Loading trust data from rpmdb backend
Oct 08 05:53:51 machine1.example.com fapolicyd[4974]: Loading trust data from file backend
Oct 08 05:53:51 machine1.example.com fapolicyd[4974]: Starting to listen for events</pre></li><li class="listitem"><p class="simpara">
						Log in as a user without root privileges, and check that <code class="literal">fapolicyd</code> is working, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>cp /bin/ls /tmp</strong></span>
$ <span class="strong strong"><strong>/tmp/ls</strong></span>
bash: /tmp/ls: Operation not permitted</pre></li></ol></div></section><section class="section" id="marking-files-as-trusted-using-an-additional-source-of-trust_assembly_blocking-and-allowing-applications-using-fapolicyd"><div class="titlepage"><div><div><h3 class="title">12.3. Marking files as trusted using an additional source of trust</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">fapolicyd</code> framework trusts files contained in the RPM database. You can mark additional files as trusted by adding the corresponding entries to the <code class="literal">/etc/fapolicyd/fapolicyd.trust</code> plain-text file or the <code class="literal">/etc/fapolicyd/trust.d/</code> directory, which supports separating a list of trusted files into more files. You can modify <code class="literal">fapolicyd.trust</code> or the files in <code class="literal">/etc/fapolicyd/trust.d</code> either directly using a text editor or through <code class="literal">fapolicyd-cli</code> commands.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Marking files as trusted using <code class="literal">fapolicyd.trust</code> or <code class="literal">trust.d/</code> is better than writing custom <code class="literal">fapolicyd</code> rules due to performance reasons.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">fapolicyd</code> framework is deployed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy your custom binary to the required directory, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>cp /bin/ls /tmp</strong></span>
$ <span class="strong strong"><strong>/tmp/ls</strong></span>
bash: /tmp/ls: Operation not permitted</pre></li><li class="listitem"><p class="simpara">
						Mark your custom binary as trusted, and store the corresponding entry to the <code class="literal">myapp</code> file in <code class="literal">/etc/fapolicyd/trust.d/</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd-cli --file add /tmp/ls --trust-file myapp</strong></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								If you skip the <code class="literal">--trust-file</code> option, then the previous command adds the corresponding line to <code class="literal">/etc/fapolicyd/fapolicyd.trust</code>.
							</li><li class="listitem">
								To mark all existing files in a directory as trusted, provide the directory path as an argument of the <code class="literal">--file</code> option, for example: <code class="literal">fapolicyd-cli --file add /tmp/my_bin_dir/ --trust-file myapp</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Update the <code class="literal">fapolicyd</code> database:
					</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd-cli --update</strong></span></pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Changing the content of a trusted file or directory changes their checksum, and therefore <code class="literal">fapolicyd</code> no longer considers them trusted.
				</p><p>
					To make the new content trusted again, refresh the file trust database by using the <code class="literal">fapolicyd-cli --file update</code> command. If you do not provide any argument, the entire database refreshes. Alternatively, you can specify a path to a specific file or directory. Then, update the database by using <code class="literal">fapolicyd-cli --update</code>.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that your custom binary can be now executed, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>/tmp/ls</strong></span>
ls</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">fapolicyd.trust(13)</code> man page on your system
					</li></ul></div></section><section class="section" id="proc_adding-custom-allow-and-deny-rules-for-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd"><div class="titlepage"><div><div><h3 class="title">12.4. Adding custom allow and deny rules for fapolicyd</h3></div></div></div><p class="_abstract _abstract">
				The default set of rules in the <code class="literal">fapolicyd</code> package does not affect system functions. For custom scenarios, such as storing binaries and scripts in a non-standard directory or adding applications without the <code class="literal">dnf</code> or <code class="literal">rpm</code> installers, you must either mark additional files as trusted or add new custom rules.
			</p><p>
				For basic scenarios, prefer <a class="link" href="#marking-files-as-trusted-using-an-additional-source-of-trust_assembly_blocking-and-allowing-applications-using-fapolicyd" title="12.3. Marking files as trusted using an additional source of trust">Marking files as trusted using an additional source of trust</a>. In more advanced scenarios such as allowing to execute a custom binary only for specific user and group identifiers, add new custom rules to the <code class="literal">/etc/fapolicyd/rules.d/</code> directory.
			</p><p>
				The following steps demonstrate adding a new rule to allow a custom binary.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">fapolicyd</code> framework is deployed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy your custom binary to the required directory, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>cp /bin/ls /tmp</strong></span>
$ <span class="strong strong"><strong>/tmp/ls</strong></span>
bash: /tmp/ls: Operation not permitted</pre></li><li class="listitem"><p class="simpara">
						Stop the <code class="literal">fapolicyd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop fapolicyd</strong></span></pre></li><li class="listitem"><p class="simpara">
						Use debug mode to identify a corresponding rule. Because the output of the <code class="literal">fapolicyd --debug</code> command is verbose and you can stop it only by pressing <kbd class="keycap">Ctrl</kbd>+<kbd class="keycap">C</kbd> or killing the corresponding process, redirect the error output to a file. In this case, you can limit the output only to access denials by using the <code class="literal">--debug-deny</code> option instead of <code class="literal">--debug</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd --debug-deny 2&gt; <span class="emphasis"><em>fapolicy.output</em></span> &amp;</strong></span>
[1] <span class="emphasis"><em>51341</em></span></pre><p class="simpara">
						Alternatively, you can run <code class="literal">fapolicyd</code> debug mode in another terminal.
					</p></li><li class="listitem"><p class="simpara">
						Repeat the command that <code class="literal">fapolicyd</code> denied:
					</p><pre class="screen">$ <span class="strong strong"><strong>/tmp/ls</strong></span>
bash: /tmp/ls: Operation not permitted</pre></li><li class="listitem"><p class="simpara">
						Stop debug mode by resuming it in the foreground and pressing <kbd class="keycap">Ctrl</kbd>+<kbd class="keycap">C</kbd>:
					</p><pre class="screen"># <span class="strong strong"><strong>fg</strong></span>
fapolicyd --debug 2&gt; fapolicy.output
^C
...</pre><p class="simpara">
						Alternatively, kill the process of <code class="literal">fapolicyd</code> debug mode:
					</p><pre class="screen"># <span class="strong strong"><strong>kill <span class="emphasis"><em>51341</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Find a rule that denies the execution of your application:
					</p><pre class="screen"># <span class="strong strong"><strong>cat <span class="emphasis"><em>fapolicy.output</em></span> | grep 'deny_audit'</strong></span>
...
rule=13 dec=deny_audit perm=execute auid=0 pid=6855 exe=/usr/bin/bash : path=/tmp/ls ftype=application/x-executable trust=0</pre></li><li class="listitem"><p class="simpara">
						Locate the file that contains a rule that prevented the execution of your custom binary. In this case, the <code class="literal">deny_audit perm=execute</code> rule belongs to the <code class="literal">90-deny-execute.rules</code> file:
					</p><pre class="screen"># <span class="strong strong"><strong>ls /etc/fapolicyd/rules.d/</strong></span>
10-languages.rules  40-bad-elf.rules	   72-shell.rules
20-dracut.rules     41-shared-obj.rules    90-deny-execute.rules
21-updaters.rules   42-trusted-elf.rules   95-allow-open.rules
30-patterns.rules   70-trusted-lang.rules


# <span class="strong strong"><strong>cat /etc/fapolicyd/rules.d/90-deny-execute.rules</strong></span>
# Deny execution for anything untrusted

deny_audit perm=execute all : all</pre></li><li class="listitem"><p class="simpara">
						Add a new <code class="literal">allow</code> rule to the file that lexically <span class="emphasis"><em>precedes</em></span> the rule file that contains the rule that denied the execution of your custom binary in the <code class="literal">/etc/fapolicyd/rules.d/</code> directory:
					</p><pre class="screen"># <span class="strong strong"><strong>touch /etc/fapolicyd/rules.d/80-myapps.rules</strong></span>
# <span class="strong strong"><strong>vi /etc/fapolicyd/rules.d/80-myapps.rules</strong></span></pre><p class="simpara">
						Insert the following rule to the <code class="literal">80-myapps.rules</code> file:
					</p><pre class="screen">allow perm=execute exe=/usr/bin/bash trust=1 : path=/tmp/ls ftype=application/x-executable trust=0</pre><p class="simpara">
						Alternatively, you can allow executions of all binaries in the <code class="literal">/tmp</code> directory by adding the following rule to the rule file in <code class="literal">/etc/fapolicyd/rules.d/</code>:
					</p><pre class="screen">allow perm=execute exe=/usr/bin/bash trust=1 : dir=/tmp/ trust=0</pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							To make a rule effective recursively on all directories under the specified directory, add a trailing slash to the value of the <code class="literal">dir=</code> parameter in the rule (<code class="literal">/tmp/</code> in the previous example).
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						To prevent changes in the content of your custom binary, define the required rule using an SHA-256 checksum:
					</p><pre class="screen">$ <span class="strong strong"><strong>sha256sum /tmp/ls</strong></span>
780b75c90b2d41ea41679fcb358c892b1251b68d1927c80fbc0d9d148b25e836  ls</pre><p class="simpara">
						Change the rule to the following definition:
					</p><pre class="screen">allow perm=execute exe=/usr/bin/bash trust=1 : sha256hash=<span class="emphasis"><em>780b75c90b2d41ea41679fcb358c892b1251b68d1927c80fbc0d9d148b25e836</em></span></pre></li><li class="listitem"><p class="simpara">
						Check that the list of compiled differs from the rule set in <code class="literal">/etc/fapolicyd/rules.d/</code>, and update the list, which is stored in the <code class="literal">/etc/fapolicyd/compiled.rules</code> file:
					</p><pre class="screen"># <span class="strong strong"><strong>fagenrules --check</strong></span>
/usr/sbin/fagenrules: Rules have changed and should be updated
# <span class="strong strong"><strong>fagenrules --load</strong></span></pre></li><li class="listitem"><p class="simpara">
						Check that your custom rule is in the list of <code class="literal">fapolicyd</code> rules before the rule that prevented the execution:
					</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd-cli --list</strong></span>
...
13. allow perm=execute exe=/usr/bin/bash trust=1 : path=/tmp/ls ftype=application/x-executable trust=0
14. deny_audit perm=execute all : all
...</pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">fapolicyd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl start fapolicyd</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that your custom binary can be now executed, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>/tmp/ls</strong></span>
ls</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">fapolicyd.rules(5)</code> and <code class="literal">fapolicyd-cli(1)</code> man pages on your system
					</li><li class="listitem">
						The documentation installed with the <code class="literal">fapolicyd</code> package in the <code class="literal">/usr/share/fapolicyd/sample-rules/README-rules</code> file.
					</li></ul></div></section><section class="section" id="proc_enabling-fapolicyd-integrity-checks_assembly_blocking-and-allowing-applications-using-fapolicyd"><div class="titlepage"><div><div><h3 class="title">12.5. Enabling fapolicyd integrity checks</h3></div></div></div><p class="_abstract _abstract">
				By default, <code class="literal">fapolicyd</code> does not perform integrity checking. You can configure <code class="literal">fapolicyd</code> to perform integrity checks by comparing either file sizes or SHA-256 hashes. You can also set integrity checks by using the Integrity Measurement Architecture (IMA) subsystem.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">fapolicyd</code> framework is deployed on your system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the <code class="literal">/etc/fapolicyd/fapolicyd.conf</code> file in a text editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/fapolicyd/fapolicyd.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Change the value of the <code class="literal">integrity</code> option from <code class="literal">none</code> to <code class="literal">sha256</code>, save the file, and exit the editor:
					</p><pre class="screen">integrity = sha256</pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">fapolicyd</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart fapolicyd</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Back up the file used for the verification:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /bin/more /bin/more.bak</strong></span></pre></li><li class="listitem"><p class="simpara">
						Change the content of the <code class="literal">/bin/more</code> binary:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /bin/less &gt; /bin/more</strong></span></pre></li><li class="listitem"><p class="simpara">
						Use the changed binary as a regular user:
					</p><pre class="screen"># <span class="strong strong"><strong>su <span class="emphasis"><em>example.user</em></span></strong></span>
$ <span class="strong strong"><strong>/bin/more /etc/redhat-release</strong></span>
bash: /bin/more: Operation not permitted</pre></li><li class="listitem"><p class="simpara">
						Revert the changes:
					</p><pre class="screen"># <span class="strong strong"><strong>mv -f /bin/more.bak /bin/more</strong></span></pre></li></ol></div></section><section class="section" id="ref_troubleshooting-problems-related-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd"><div class="titlepage"><div><div><h3 class="title">12.6. Troubleshooting problems related to fapolicyd</h3></div></div></div><p>
				The <code class="literal">fapolicyd</code> application framework provides tools for troubleshooting the most common problems and you can also add applications installed with the <code class="literal">rpm</code> command to the trust database.
			</p><div class="itemizedlist"><p class="title"><strong>Installing applications by using <code class="literal">rpm</code></strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If you install an application by using the <code class="literal">rpm</code> command, you have to perform a manual refresh of the <code class="literal">fapolicyd</code> RPM database:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Install your <span class="emphasis"><em>application</em></span>:
							</p><pre class="screen"># <span class="strong strong"><strong>rpm -i <span class="emphasis"><em>application</em></span>.rpm</strong></span></pre></li><li class="listitem"><p class="simpara">
								Refresh the database:
							</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd-cli --update</strong></span></pre><p class="simpara">
								If you skip this step, the system can freeze and must be restarted.
							</p></li></ol></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Service status</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If <code class="literal">fapolicyd</code> does not work correctly, check the service status:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status fapolicyd</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong><code class="literal">fapolicyd-cli</code> checks and listings</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">--check-config</code>, <code class="literal">--check-watch_fs</code>, and <code class="literal">--check-trustdb</code> options help you find syntax errors, not-yet-watched file systems, and file mismatches, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd-cli --check-config</strong></span>
Daemon config is OK

# <span class="strong strong"><strong>fapolicyd-cli --check-trustdb</strong></span>
/etc/selinux/targeted/contexts/files/file_contexts miscompares: size sha256
/etc/selinux/targeted/policy/policy.31 miscompares: size sha256</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">--list</code> option to check the current list of rules and their order:
					</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd-cli --list</strong></span>
...
9. allow perm=execute all : trust=1
10. allow perm=open all : ftype=%languages trust=1
11. deny_audit perm=any all : ftype=%languages
12. allow perm=any all : ftype=text/x-shellscript
13. deny_audit perm=execute all : all
...</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Debug mode</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Debug mode provides detailed information about matched rules, database status, and more. To switch <code class="literal">fapolicyd</code> to debug mode:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Stop the <code class="literal">fapolicyd</code> service:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop fapolicyd</strong></span></pre></li><li class="listitem"><p class="simpara">
								Use debug mode to identify a corresponding rule:
							</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd --debug</strong></span></pre><p class="simpara">
								Because the output of the <code class="literal">fapolicyd --debug</code> command is verbose, you can redirect the error output to a file:
							</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd --debug 2&gt; fapolicy.output</strong></span></pre><p class="simpara">
								Alternatively, to limit the output only to entries when <code class="literal">fapolicyd</code> denies access, use the <code class="literal">--debug-deny</code> option:
							</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd --debug-deny</strong></span></pre><p class="simpara">
								You can also use permissive mode, which does not prevent running your application but only records the matched <code class="literal">fapolicyd</code> rule:
							</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd --debug-deny --permissive</strong></span></pre></li></ol></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Removing the <code class="literal">fapolicyd</code> database</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To solve problems related to the <code class="literal">fapolicyd</code> database, try to remove the database file:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop fapolicyd</strong></span>
# <span class="strong strong"><strong>fapolicyd-cli --delete-db</strong></span></pre><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
							Do not remove the <code class="literal">/var/lib/fapolicyd/</code> directory. The <code class="literal">fapolicyd</code> framework automatically restores only the database file in this directory.
						</p></div></rh-alert></li></ul></div><div class="itemizedlist"><p class="title"><strong>Dumping the <code class="literal">fapolicyd</code> database</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">fapolicyd</code> contains entries from all enabled trust sources. You can check the entries after dumping the database:
					</p><pre class="screen"># <span class="strong strong"><strong>fapolicyd-cli --dump-db</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Application pipe</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						In rare cases, removing the <code class="literal">fapolicyd</code> pipe file can solve a lockup:
					</p><pre class="screen"># <span class="strong strong"><strong>rm -f /var/run/fapolicyd/fapolicyd.fifo</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">fapolicyd-cli(1)</code> man page on your system
					</li></ul></div></section><section class="section" id="preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_assembly_blocking-and-allowing-applications-using-fapolicyd"><div class="titlepage"><div><div><h3 class="title">12.7. Preventing users from executing untrustworthy code by using the <code class="literal">fapolicyd</code> RHEL system role</h3></div></div></div><p>
				You can automate the installation and configuration of the <code class="literal">fapolicyd</code> service by using the <code class="literal">fapolicyd</code> RHEL system role. With this role, you can remotely configure the service to allow users to execute only trusted applications, for example, the ones which are listed in the RPM database and in an allow list. Additionally, the service can perform integrity checks before it executes an allowed application.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuring fapolicyd
  hosts: managed-node-01.example.com
  tasks:
    - name: Allow only executables installed from RPM database and specific files
      ansible.builtin.include_role:
        name: rhel-system-roles.fapolicyd
      vars:
        fapolicyd_setup_permissive: false
        fapolicyd_setup_integrity: sha256
        fapolicyd_setup_trust: rpmdb,file
        fapolicyd_add_trusted_file:
          - <span class="emphasis"><em>&lt;path_to_allowed_command&gt;</em></span>
          - <span class="emphasis"><em>&lt;path_to_allowed_service&gt;</em></span></pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">fapolicyd_setup_permissive: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code> </span></dt><dd>
									Enables or disables sending policy decisions to the kernel for enforcement. Set this variable for debugging and testing purposes to <code class="literal">false</code>.
								</dd><dt><span class="term"><code class="literal">fapolicyd_setup_integrity: <span class="emphasis"><em>&lt;type_type&gt;</em></span></code></span></dt><dd><p class="simpara">
									Defines the integrity checking method. You can set one of the following values:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">none</code> (default): Disables integrity checking.
										</li><li class="listitem">
											<code class="literal">size</code>: The service compares only the file sizes of allowed applications.
										</li><li class="listitem">
											<code class="literal">ima</code>: The service checks the SHA-256 hash that the kernel’s Integrity Measurement Architecture (IMA) stored in a file’s extended attribute. Additionally, the service performs a size check. Note that the role does not configure the IMA kernel subsystem. To use this option, you must manually configure the IMA subsystem.
										</li><li class="listitem">
											<code class="literal">sha256</code>: The service compares the SHA-256 hash of allowed applications.
										</li></ul></div></dd><dt><span class="term"><code class="literal">fapolicyd_setup_trust: <span class="emphasis"><em>&lt;trust_backends&gt;</em></span></code> </span></dt><dd>
									Defines the list of trust backends. If you include the <code class="literal">file</code> backend, specify the allowed executable files in the <code class="literal">fapolicyd_add_trusted_file</code> list.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.fapolicyd.README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml --syntax-check</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Execute a binary application that is not on the allow list as a user:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'su -c "/bin/not_authorized_application " <span class="emphasis"><em>&lt;user_name&gt;</em></span>'</strong></span>
bash: line 1: /bin/not_authorized_application: Operation not permitted non-zero return code</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.fapolicyd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/fapolicyd/</code> directory
					</li></ul></div></section><section class="section _additional-resources" id="additional_resources_2"><div class="titlepage"><div><div><h3 class="title">12.8. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">fapolicyd</code>-related man pages listed by using the <code class="literal">man -k fapolicyd</code> command on your system
					</li><li class="listitem">
						<a class="link" href="https://rsroka.fedorapeople.org/fapolicyd-fosdem.pdf">FOSDEM 2020 fapolicyd</a> presentation
					</li></ul></div></section></section><section class="chapter" id="protecting-systems-against-intrusive-usb-devices_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Protecting systems against intrusive USB devices</h2></div></div></div><p class="_abstract _abstract">
			USB devices can be loaded with spyware, malware, or trojans, which can steal your data or damage your system. As a Red Hat Enterprise Linux administrator, you can prevent such USB attacks with <span class="strong strong"><strong>USBGuard</strong></span>.
		</p><section class="section" id="usbguard_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h3 class="title">13.1. USBGuard</h3></div></div></div><p class="_abstract _abstract">
				With the USBGuard software framework, you can protect your systems against intrusive USB devices by using basic lists of permitted and forbidden devices based on the USB device authorization feature in the kernel.
			</p><p>
				The USBGuard framework provides the following components:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The system service component with an inter-process communication (IPC) interface for dynamic interaction and policy enforcement
					</li><li class="listitem">
						The command-line interface to interact with a running <code class="literal">usbguard</code> system service
					</li><li class="listitem">
						The rule language for writing USB device authorization policies
					</li><li class="listitem">
						The C++ API for interacting with the system service component implemented in a shared library
					</li></ul></div><p>
				The <code class="literal">usbguard</code> system service configuration file (<code class="literal">/etc/usbguard/usbguard-daemon.conf</code>) includes the options to authorize the users and groups to use the IPC interface.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					The system service provides the USBGuard public IPC interface. In Red Hat Enterprise Linux, the access to this interface is limited to the root user only by default.
				</p><p>
					Consider setting either the <code class="literal">IPCAccessControlFiles</code> option (recommended) or the <code class="literal">IPCAllowedUsers</code> and <code class="literal">IPCAllowedGroups</code> options to limit access to the IPC interface.
				</p><p>
					Ensure that you do not leave the Access Control List (ACL) unconfigured as this exposes the IPC interface to all local users and allows them to manipulate the authorization state of USB devices and modify the USBGuard policy.
				</p></div></rh-alert></section><section class="section" id="installing-usbguard_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h3 class="title">13.2. Installing USBGuard</h3></div></div></div><p class="_abstract _abstract">
				Use this procedure to install and initiate the USBGuard framework.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">usbguard</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install usbguard</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an initial rule set:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard generate-policy &gt; /etc/usbguard/rules.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">usbguard</code> daemon and ensure that it starts automatically on boot:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now usbguard</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the <code class="literal">usbguard</code> service is running:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status usbguard</strong></span>
● usbguard.service - USBGuard daemon
   Loaded: loaded (/usr/lib/systemd/system/usbguard.service; enabled; vendor preset: disabled)
   Active: active (running) since Thu 2019-11-07 09:44:07 CET; 3min 16s ago
     Docs: man:usbguard-daemon(8)
 Main PID: 6122 (usbguard-daemon)
    Tasks: 3 (limit: 11493)
   Memory: 1.2M
   CGroup: /system.slice/usbguard.service
           └─6122 /usr/sbin/usbguard-daemon -f -s -c /etc/usbguard/usbguard-daemon.conf

Nov 07 09:44:06 localhost.localdomain systemd[1]: Starting USBGuard daemon...
Nov 07 09:44:07 localhost.localdomain systemd[1]: Started USBGuard daemon.</pre></li><li class="listitem"><p class="simpara">
						List USB devices recognized by USBGuard:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard list-devices</strong></span>
4: allow id 1d6b:0002 serial "0000:02:00.0" name "xHCI Host Controller" hash...</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">usbguard(1)</code> and <code class="literal">usbguard-daemon.conf(5)</code> man pages.
					</li></ul></div></section><section class="section" id="blocking-and-authorizing-a-usb-device-using-cli_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h3 class="title">13.3. Blocking and authorizing a USB device by using CLI</h3></div></div></div><p>
				You can set USBGuard to authorize and block a USB device by using the <code class="literal">usbguard</code> command in your terminal.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List USB devices recognized by USBGuard, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard list-devices</strong></span>
1: allow id 1d6b:0002 serial "0000:00:06.7" name "EHCI Host Controller" hash "JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=" parent-hash "4PHGcaDKWtPjKDwYpIRG722cB9SlGz9l9Iea93+Gt9c=" via-port "usb1" with-interface 09:00:00
...
6: block id 1b1c:1ab1 serial "000024937962" name "Voyager" hash "CrXgiaWIf2bZAU+5WkzOE7y0rdSO82XMzubn7HDb95Q=" parent-hash "JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=" via-port "1-3" with-interface 08:06:50</pre></li><li class="listitem"><p class="simpara">
						Authorize the device <span class="emphasis"><em>&lt;6&gt;</em></span> to interact with the system:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard allow-device <span class="emphasis"><em>&lt;6&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Deauthorize and remove the device <span class="emphasis"><em>&lt;6&gt;</em></span>:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard reject-device <span class="emphasis"><em>&lt;6&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Deauthorize and retain the device <span class="emphasis"><em>&lt;6&gt;</em></span>:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard block-device <span class="emphasis"><em>&lt;6&gt;</em></span></strong></span></pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					USBGuard uses the terms <code class="literal"><span class="emphasis"><em>block</em></span></code> and <code class="literal"><span class="emphasis"><em>reject</em></span></code> with the following meanings:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal"><span class="emphasis"><em>block</em></span></code></span></dt><dd>
								Do not interact with this device for now.
							</dd><dt><span class="term"><code class="literal"><span class="emphasis"><em>reject</em></span></code></span></dt><dd>
								Ignore this device as if it does not exist.
							</dd></dl></div></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">usbguard(1)</code> man page on your system
					</li><li class="listitem">
						<code class="literal">usbguard --help</code> command
					</li></ul></div></section><section class="section" id="permanently-blocking-and-authorizing-a-usb-device_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h3 class="title">13.4. Permanently blocking and authorizing a USB device</h3></div></div></div><p class="_abstract _abstract">
				You can permanently block and authorize a USB device by using the <code class="literal">-p</code> option. This adds a device-specific rule to the current policy.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure SELinux to allow the <code class="literal">usbguard</code> daemon to write rules.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Display the <code class="literal">semanage</code> Booleans relevant to <code class="literal">usbguard</code>.
							</p><pre class="screen"># <span class="strong strong"><strong>semanage boolean -l | grep usbguard</strong></span>
usbguard_daemon_write_conf     (off  ,  off)  Allow usbguard to daemon write conf
usbguard_daemon_write_rules    (on   ,   on)  Allow usbguard to daemon write rules</pre></li><li class="listitem"><p class="simpara">
								Optional: If the <code class="literal">usbguard_daemon_write_rules</code> Boolean is turned off, turn it on.
							</p><pre class="screen"># <span class="strong strong"><strong>semanage boolean -m --on usbguard_daemon_write_rules</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						List USB devices recognized by USBGuard:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard list-devices</strong></span>
1: allow id 1d6b:0002 serial "0000:00:06.7" name "EHCI Host Controller" hash "JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=" parent-hash "4PHGcaDKWtPjKDwYpIRG722cB9SlGz9l9Iea93+Gt9c=" via-port "usb1" with-interface 09:00:00
...
<span class="emphasis"><em>6</em></span>: block id 1b1c:1ab1 serial "000024937962" name "Voyager" hash "CrXgiaWIf2bZAU+5WkzOE7y0rdSO82XMzubn7HDb95Q=" parent-hash "JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=" via-port "1-3" with-interface 08:06:50</pre></li><li class="listitem"><p class="simpara">
						Permanently authorize device <code class="literal"><span class="emphasis"><em>6</em></span></code> to interact with the system:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard allow-device <span class="emphasis"><em>6</em></span></strong></span> -p</pre></li><li class="listitem"><p class="simpara">
						Permanently deauthorize and remove device <code class="literal"><span class="emphasis"><em>6</em></span></code>:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard reject-device <span class="emphasis"><em>6</em></span></strong></span> -p</pre></li><li class="listitem"><p class="simpara">
						Permanently deauthorize and retain device <code class="literal"><span class="emphasis"><em>6</em></span></code>:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard block-device <span class="emphasis"><em>6</em></span></strong></span> -p</pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					<code class="literal">USBGuard</code> uses the terms <code class="literal"><span class="emphasis"><em>block</em></span></code> and <code class="literal"><span class="emphasis"><em>reject</em></span></code> with the following meanings:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal"><span class="emphasis"><em>block</em></span></code></span></dt><dd>
								Do not interact with this device for now.
							</dd><dt><span class="term"><code class="literal"><span class="emphasis"><em>reject</em></span></code></span></dt><dd>
								Ignore this device as if it does not exist.
							</dd></dl></div></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that USBGuard rules include the changes you made.
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard list-rules</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">usbguard(1)</code> man page on your system
					</li><li class="listitem">
						Built-in help listed by using the <code class="literal">usbguard --help</code> command.
					</li></ul></div></section><section class="section" id="creating-a-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h3 class="title">13.5. Creating a custom policy for USB devices</h3></div></div></div><p class="_abstract _abstract">
				The following procedure contains steps for creating a rule set for USB devices that reflects the requirements of your scenario.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li><li class="listitem">
						The <code class="literal">/etc/usbguard/rules.conf</code> file contains an initial rule set generated by the <code class="literal">usbguard generate-policy</code> command.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a policy which authorizes the currently connected USB devices, and store the generated rules to the <code class="literal">rules.conf</code> file:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard generate-policy --no-hashes &gt; <span class="emphasis"><em>./rules.conf</em></span></strong></span></pre><p class="simpara">
						The <code class="literal">--no-hashes</code> option does not generate hash attributes for devices. Avoid hash attributes in your configuration settings because they might not be persistent.
					</p></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal">rules.conf</code> file with a text editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi <span class="emphasis"><em>./rules.conf</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Add, remove, or edit the rules as required. For example, the following rule allows only devices with a single mass storage interface to interact with the system:
					</p><pre class="screen">allow with-interface equals { 08:*:* }</pre><p class="simpara">
						See the <code class="literal">usbguard-rules.conf(5)</code> man page for a detailed rule-language description and more examples.
					</p></li><li class="listitem"><p class="simpara">
						Install the updated policy:
					</p><pre class="screen"># <span class="strong strong"><strong>install -m 0600 -o root -g root <span class="emphasis"><em>rules.conf</em></span> /etc/usbguard/rules.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">usbguard</code> daemon to apply your changes:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart usbguard</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that your custom rules are in the active policy, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard list-rules</strong></span>
...
4: allow with-interface 08:*:*
...</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">usbguard-rules.conf(5)</code> man page on your system
					</li></ul></div></section><section class="section" id="creating-a-structured-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h3 class="title">13.6. Creating a structured custom policy for USB devices</h3></div></div></div><p class="_abstract _abstract">
				You can organize your custom USBGuard policy in several <code class="literal">.conf</code> files within the <code class="literal">/etc/usbguard/rules.d/</code> directory. The <code class="literal">usbguard-daemon</code> then combines the main <code class="literal">rules.conf</code> file with the <code class="literal">.conf</code> files within the directory in alphabetical order.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a policy which authorizes the currently connected USB devices, and store the generated rules to a new <code class="literal">.conf</code> file, for example, <code class="literal"><span class="emphasis"><em>policy.conf</em></span></code>.
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard generate-policy --no-hashes &gt; ./<span class="emphasis"><em>policy.conf</em></span></strong></span></pre><p class="simpara">
						The <code class="literal">--no-hashes</code> option does not generate hash attributes for devices. Avoid hash attributes in your configuration settings because they might not be persistent.
					</p></li><li class="listitem"><p class="simpara">
						Display the <code class="literal"><span class="emphasis"><em>policy.conf</em></span></code> file with a text editor of your choice, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi ./<span class="emphasis"><em>policy.conf</em></span></strong></span>
...
allow id 04f2:0833 serial "" name "USB Keyboard" via-port "7-2" with-interface { 03:01:01 03:00:00 } with-connect-type "unknown"
...</pre></li><li class="listitem"><p class="simpara">
						Move selected lines into a separate <code class="literal">.conf</code> file.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							The two digits at the beginning of the file name specify the order in which the daemon reads the configuration files.
						</p></div></rh-alert><p class="simpara">
						For example, copy the rules for your keyboards into a new <code class="literal">.conf</code> file.
					</p><pre class="screen"># <span class="strong strong"><strong>grep "<span class="emphasis"><em>USB Keyboard</em></span>" ./<span class="emphasis"><em>policy.conf</em></span> &gt; ./<span class="emphasis"><em>10keyboards.conf</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Install the new policy to the <code class="literal">/etc/usbguard/rules.d/</code> directory.
					</p><pre class="screen"># <span class="strong strong"><strong>install -m 0600 -o root -g root <span class="emphasis"><em>10keyboards.conf</em></span> /etc/usbguard/rules.d/<span class="emphasis"><em>10keyboards.conf</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Move the rest of the lines to a main <code class="literal">rules.conf</code> file.
					</p><pre class="screen"># <span class="strong strong"><strong>grep -v "<span class="emphasis"><em>USB Keyboard</em></span>" ./policy.conf &gt; ./rules.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Install the remaining rules.
					</p><pre class="screen"># <span class="strong strong"><strong>install -m 0600 -o root -g root <span class="emphasis"><em>rules.conf</em></span> /etc/usbguard/rules.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">usbguard</code> daemon to apply your changes.
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart usbguard</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display all active USBGuard rules.
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard list-rules</strong></span>
...
15: allow id 04f2:0833 serial "" name "USB Keyboard" hash "kxM/iddRe/WSCocgiuQlVs6Dn0VEza7KiHoDeTz0fyg=" parent-hash "2i6ZBJfTl5BakXF7Gba84/Cp1gslnNc1DM6vWQpie3s=" via-port "7-2" with-interface { 03:01:01 03:00:00 } with-connect-type "unknown"
...</pre></li><li class="listitem"><p class="simpara">
						Display the contents of the <code class="literal">rules.conf</code> file and all the <code class="literal">.conf</code> files in the <code class="literal">/etc/usbguard/rules.d/</code> directory.
					</p><pre class="screen"># <span class="strong strong"><strong>cat /etc/usbguard/rules.conf /etc/usbguard/rules.d/*.conf</strong></span></pre></li><li class="listitem">
						Verify that the active rules contain all the rules from the files and are in the correct order.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">usbguard-rules.conf(5)</code> man page on your system
					</li></ul></div></section><section class="section" id="authorizing-users-and-groups-to-use-the-usbguard-ipc-interface_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h3 class="title">13.7. Authorizing users and groups to use the USBGuard IPC interface</h3></div></div></div><p class="_abstract _abstract">
				Use this procedure to authorize a specific user or a group to use the USBGuard public IPC interface. By default, only the root user can use this interface.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li><li class="listitem">
						The <code class="literal">/etc/usbguard/rules.conf</code> file contains an initial rule set generated by the <code class="literal">usbguard generate-policy</code> command.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">/etc/usbguard/usbguard-daemon.conf</code> file with a text editor of your choice:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/usbguard/usbguard-daemon.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						For example, add a line with a rule that allows all users in the <code class="literal">wheel</code> group to use the IPC interface, and save the file:
					</p><pre class="screen">IPCAllowGroups=wheel</pre></li><li class="listitem"><p class="simpara">
						You can add users or groups also with the <code class="literal">usbguard</code> command. For example, the following command enables the <span class="emphasis"><em>joesec</em></span> user to have full access to the <code class="literal">Devices</code> and <code class="literal">Exceptions</code> sections. Furthermore, <span class="emphasis"><em>joesec</em></span> can list and modify the current policy:
					</p><pre class="screen"># <span class="strong strong"><strong>usbguard add-user <span class="emphasis"><em>joesec</em></span> --devices ALL --policy modify,list --exceptions ALL</strong></span></pre><p class="simpara">
						To remove the granted permissions for the <span class="emphasis"><em>joesec</em></span> user, use the <code class="literal">usbguard remove-user joesec</code> command.
					</p></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">usbguard</code> daemon to apply your changes:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart usbguard</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">usbguard(1)</code> and <code class="literal">usbguard-rules.conf(5)</code> man pages.
					</li></ul></div></section><section class="section" id="logging-usbguard-authorization-events-to-the-linux-audit-log_protecting-systems-against-intrusive-usb-devices"><div class="titlepage"><div><div><h3 class="title">13.8. Logging USBguard authorization events to the Linux Audit log</h3></div></div></div><p class="_abstract _abstract">
				Use the following steps to integrate logging of USBguard authorization events to the standard Linux Audit log. By default, the <code class="literal">usbguard</code> daemon logs events to the <code class="literal">/var/log/usbguard/usbguard-audit.log</code> file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">usbguard</code> service is installed and running.
					</li><li class="listitem">
						The <code class="literal">auditd</code> service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">usbguard-daemon.conf</code> file with a text editor of your choice:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/usbguard/usbguard-daemon.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Change the <code class="literal">AuditBackend</code> option from <code class="literal">FileAudit</code> to <code class="literal">LinuxAudit</code>:
					</p><pre class="screen">AuditBackend=LinuxAudit</pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">usbguard</code> daemon to apply the configuration change:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart usbguard</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Query the <code class="literal">audit</code> daemon log for a USB authorization event, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>ausearch -ts recent -m USER_DEVICE</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">usbguard-daemon.conf(5)</code> man page on your system
					</li></ul></div></section><section class="section _additional-resources" id="additional_resources_3"><div class="titlepage"><div><div><h3 class="title">13.9. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">usbguard(1)</code>, <code class="literal">usbguard-rules.conf(5)</code>, <code class="literal">usbguard-daemon(8)</code>, and <code class="literal">usbguard-daemon.conf(5)</code> man pages.
					</li><li class="listitem">
						<a class="link" href="https://usbguard.github.io/">USBGuard Homepage</a>.
					</li></ul></div></section></section><section class="chapter" id="assembly_configuring-a-remote-logging-solution_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Configuring a remote logging solution</h2></div></div></div><p class="_abstract _abstract">
			To ensure that logs from various machines in your environment are recorded centrally on a logging server, you can configure the <span class="strong strong"><strong>Rsyslog</strong></span> application to record logs that fit specific criteria from the client system to the server.
		</p><section class="section" id="the-rsyslog-logging-service_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.1. The Rsyslog logging service</h3></div></div></div><p>
				The Rsyslog application, in combination with the <code class="literal">systemd-journald</code> service, provides local and remote logging support in Red Hat Enterprise Linux. The <code class="literal">rsyslogd</code> daemon continuously reads <code class="literal">syslog</code> messages received by the <code class="literal">systemd-journald</code> service from the Journal. <code class="literal">rsyslogd</code> then filters and processes these <code class="literal">syslog</code> events and records them to <code class="literal">rsyslog</code> log files or forwards them to other services according to its configuration.
			</p><p>
				The <code class="literal">rsyslogd</code> daemon also provides extended filtering, encryption protected relaying of messages, input and output modules, and support for transportation using the TCP and UDP protocols.
			</p><p>
				In <code class="literal">/etc/rsyslog.conf</code>, which is the main configuration file for <code class="literal">rsyslog</code>, you can specify the rules according to which <code class="literal">rsyslogd</code> handles the messages. Generally, you can classify messages by their source and topic (facility) and urgency (priority), and then assign an action that should be performed when a message fits these criteria.
			</p><p>
				In <code class="literal">/etc/rsyslog.conf</code>, you can also see a list of log files maintained by <code class="literal">rsyslogd</code>. Most log files are located in the <code class="literal">/var/log/</code> directory. Some applications, such as <code class="literal">httpd</code> and <code class="literal">samba</code>, store their log files in a subdirectory within <code class="literal">/var/log/</code>.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">rsyslogd(8)</code> and <code class="literal">rsyslog.conf(5)</code> man pages.
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rsyslog-doc</code> package in the <code class="literal">/usr/share/doc/rsyslog/html/index.html</code> file.
					</li></ul></div></section><section class="section" id="installing-rsyslog-documentation_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.2. Installing Rsyslog documentation</h3></div></div></div><p class="_abstract _abstract">
				The Rsyslog application has extensive online documentation that is available at <a class="link" href="https://www.rsyslog.com/doc/">https://www.rsyslog.com/doc/</a>, but you can also install the <code class="literal">rsyslog-doc</code> documentation package locally.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have activated the <code class="literal">AppStream</code> repository on your system.
					</li><li class="listitem">
						You are authorized to install new packages using <code class="literal">sudo</code>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Install the <code class="literal">rsyslog-doc</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install rsyslog-doc</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Open the <code class="literal">/usr/share/doc/rsyslog/html/index.html</code> file in a browser of your choice, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>firefox /usr/share/doc/rsyslog/html/index.html &amp;</strong></span></pre></li></ul></div></section><section class="section" id="configuring-a-server-for-remote-logging-over-tcp_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.3. Configuring a server for remote logging over TCP</h3></div></div></div><p class="_abstract _abstract">
				The Rsyslog application enables you to both run a logging server and configure individual systems to send their log files to the logging server. To use remote logging through TCP, configure both the server and the client. The server collects and analyzes the logs sent by one or more client systems.
			</p><p>
				With the Rsyslog application, you can maintain a centralized logging system where log messages are forwarded to a server over the network. To avoid message loss when the server is not available, you can configure an action queue for the forwarding action. This way, messages that failed to be sent are stored locally until the server is reachable again. Note that such queues cannot be configured for connections using the UDP protocol.
			</p><p>
				The <code class="literal">omfwd</code> plug-in provides forwarding over UDP or TCP. The default protocol is UDP. Because the plug-in is built in, it does not have to be loaded.
			</p><p>
				By default, <code class="literal">rsyslog</code> uses TCP on port <code class="literal">514</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Rsyslog is installed on the server system.
					</li><li class="listitem">
						You are logged in as <code class="literal">root</code> on the server.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed for the optional step using the <code class="literal">semanage</code> command.
					</li><li class="listitem">
						The <code class="literal">firewalld</code> service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: To use a different port for <code class="literal">rsyslog</code> traffic, add the <code class="literal">syslogd_port_t</code> SELinux type to port. For example, enable port <code class="literal">30514</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage port -a -t syslogd_port_t -p tcp 30514</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: To use a different port for <code class="literal">rsyslog</code> traffic, configure <code class="literal">firewalld</code> to allow incoming <code class="literal">rsyslog</code> traffic on that port. For example, allow TCP traffic on port <code class="literal">30514</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --zone=<span class="emphasis"><em>&lt;zone-name&gt;</em></span> --permanent --add-port=30514/tcp</strong></span>
success
# <span class="strong strong"><strong>firewall-cmd --reload</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create a new file in the <code class="literal">/etc/rsyslog.d/</code> directory named, for example, <code class="literal">remotelog.conf</code>, and insert the following content:
					</p><pre class="screen white-space-pre white-space-pre"># Define templates before the rules that use them
# Per-Host templates for remote systems
template(name="TmplAuthpriv" type="list") {
    constant(value="/var/log/remote/auth/")
    property(name="hostname")
    constant(value="/")
    property(name="programname" SecurePath="replace")
    constant(value=".log")
    }

template(name="TmplMsg" type="list") {
    constant(value="/var/log/remote/msg/")
    property(name="hostname")
    constant(value="/")
    property(name="programname" SecurePath="replace")
    constant(value=".log")
    }

# Provides TCP syslog reception
module(load="imtcp")

# Adding this ruleset to process remote messages
ruleset(name="remote1"){
     authpriv.*   action(type="omfile" DynaFile="TmplAuthpriv")
      *.info;mail.none;authpriv.none;cron.none
action(type="omfile" DynaFile="TmplMsg")
}

input(type="imtcp" port="30514" ruleset="remote1")</pre></li><li class="listitem">
						Save the changes to the <code class="literal">/etc/rsyslog.d/remotelog.conf</code> file.
					</li><li class="listitem"><p class="simpara">
						Test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><pre class="screen"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-2.el8, config validation run...
rsyslogd: End of config validation run. Bye.</pre></li><li class="listitem"><p class="simpara">
						Make sure the <code class="literal">rsyslog</code> service is running and enabled on the logging server:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">rsyslog</code> service.
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: If <code class="literal">rsyslog</code> is not enabled, ensure the <code class="literal">rsyslog</code> service starts automatically after reboot:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable rsyslog</strong></span></pre></li></ol></div><p>
				Your log server is now configured to receive and store log files from the other systems in your environment.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">rsyslogd(8)</code>, <code class="literal">rsyslog.conf(5)</code>, <code class="literal">semanage(8)</code>, and <code class="literal">firewall-cmd(1)</code> man pages.
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rsyslog-doc</code> package in the <code class="literal">/usr/share/doc/rsyslog/html/index.html</code> file.
					</li></ul></div></section><section class="section" id="configuring-remote-logging-to-a-server-over-tcp_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.4. Configuring remote logging to a server over TCP</h3></div></div></div><p>
				You can configure a system for forwarding log messages to a server over the TCP protocol. The <code class="literal">omfwd</code> plug-in provides forwarding over UDP or TCP. The default protocol is UDP. Because the plug-in is built in, you do not have to load it.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">rsyslog</code> package is installed on the client systems that should report to the server.
					</li><li class="listitem">
						You have configured the server for remote logging.
					</li><li class="listitem">
						The specified port is permitted in SELinux and open in firewall.
					</li><li class="listitem">
						The system contains the <code class="literal">policycoreutils-python-utils</code> package, which provides the <code class="literal">semanage</code> command for adding a non-standard port to the SELinux configuration.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new file in the <code class="literal">/etc/rsyslog.d/</code> directory named, for example, <code class="literal">10-remotelog.conf</code>, and insert the following content:
					</p><pre class="screen">*.* action(type="omfwd"
      queue.type="linkedlist"
      queue.filename="example_fwd"
      action.resumeRetryCount="-1"
      queue.saveOnShutdown="on"
      target="example.com" port="30514" protocol="tcp"
     )</pre><p class="simpara">
						Where:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">queue.type="linkedlist"</code> setting enables a LinkedList in-memory queue,
							</li><li class="listitem">
								The <code class="literal">queue.filename</code> setting defines a disk storage. The backup files are created with the <code class="literal">example_fwd</code> prefix in the working directory specified by the preceding global <code class="literal">workDirectory</code> directive.
							</li><li class="listitem">
								The <code class="literal">action.resumeRetryCount -1</code> setting prevents <code class="literal">rsyslog</code> from dropping messages when retrying to connect if server is not responding,
							</li><li class="listitem">
								The <code class="literal">queue.saveOnShutdown="on"</code> setting saves in-memory data if <code class="literal">rsyslog</code> shuts down.
							</li><li class="listitem"><p class="simpara">
								The last line forwards all received messages to the logging server. Port specification is optional.
							</p><p class="simpara">
								With this configuration, <code class="literal">rsyslog</code> sends messages to the server but keeps messages in memory if the remote server is not reachable. A file on disk is created only if <code class="literal">rsyslog</code> runs out of the configured memory queue space or needs to shut down, which benefits the system performance.
							</p></li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Rsyslog processes configuration files <code class="literal">/etc/rsyslog.d/</code> in the lexical order.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">rsyslog</code> service.
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart rsyslog</strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					To verify that the client system sends messages to the server, follow these steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the client system, send a test message:
					</p><pre class="screen"># <span class="strong strong"><strong>logger test</strong></span></pre></li><li class="listitem"><p class="simpara">
						On the server system, view the <code class="literal">/var/log/messages</code> log, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /var/log/remote/msg/<span class="emphasis"><em>hostname</em></span>/root.log</strong></span>
Feb 25 03:53:17 <span class="emphasis"><em>hostname</em></span> root[6064]: test</pre><p class="simpara">
						Where <span class="emphasis"><em>hostname</em></span> is the host name of the client system. Note that the log contains the user name of the user that entered the <code class="literal">logger</code> command, in this case <code class="literal">root</code>.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">rsyslogd(8)</code> and <code class="literal">rsyslog.conf(5)</code> man pages.
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rsyslog-doc</code> package in the <code class="literal">/usr/share/doc/rsyslog/html/index.html</code> file.
					</li></ul></div></section><section class="section" id="proc_configuring-tls-encrypted-remote-logging_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.5. Configuring TLS-encrypted remote logging</h3></div></div></div><p class="_abstract _abstract">
				By default, Rsyslog sends remote-logging communication in the plain text format. If your scenario requires to secure this communication channel, you can encrypt it using TLS.
			</p><p>
				To use encrypted transport through TLS, configure both the server and the client. The server collects and analyzes the logs sent by one or more client systems.
			</p><p>
				You can use either the <code class="literal">ossl</code> network stream driver (OpenSSL) or the <code class="literal">gtls</code> stream driver (GnuTLS).
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you have a separate system with higher security, for example, a system that is not connected to any network or has stricter authorizations, use the separate system as the certifying authority (CA).
				</p></div></rh-alert><p>
				You can customize your connection settings with stream drivers on the server side on the <code class="literal">global</code>, <code class="literal">module</code>, and <code class="literal">input</code> levels, and on the client side on the <code class="literal">global</code> and <code class="literal">action</code> levels. The more specific configuration overrides the more general configuration. This means, for example, that you can use <code class="literal">ossl</code> in global settings for most connections and <code class="literal">gtls</code> on the input and action settings only for specific connections.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> access to both the client and server systems.
					</li><li class="listitem"><p class="simpara">
						The following packages are installed on the server and the client systems:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">rsyslog</code> package.
							</li><li class="listitem">
								For the <code class="literal">ossl</code> network stream driver, the <code class="literal">rsyslog-openssl</code> package.
							</li><li class="listitem">
								For the <code class="literal">gtls</code> network stream driver, the <code class="literal">rsyslog-gnutls</code> package.
							</li><li class="listitem">
								For generating certificates by using the <code class="literal">certtool</code> command, the <code class="literal">gnutls-utils</code> package.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						On your logging server, the following certificates are in the <code class="literal">/etc/pki/ca-trust/source/anchors/</code> directory and your system configuration is updated by using the <code class="literal">update-ca-trust</code> command:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">ca-cert.pem</code> - a CA certificate that can verify keys and certificates on logging servers and clients.
							</li><li class="listitem">
								<code class="literal">server-cert.pem</code> - a public key of the logging server.
							</li><li class="listitem">
								<code class="literal">server-key.pem</code> - a private key of the logging server.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						On your logging clients, the following certificates are in the <code class="literal">/etc/pki/ca-trust/source/anchors/</code> directory and your system configuration is updated by using <code class="literal">update-ca-trust</code>:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">ca-cert.pem</code> - a CA certificate that can verify keys and certificates on logging servers and clients.
							</li><li class="listitem">
								<code class="literal">client-cert.pem</code> - a public key of a client.
							</li><li class="listitem">
								<code class="literal">client-key.pem</code> - a private key of a client.
							</li><li class="listitem">
								If the server runs RHEL 9.2 or later and FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS extension "Extended Master Secret" enforced</a> Knowledgebase article.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure the server for receiving encrypted logs from your client systems:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Create a new file in the <code class="literal">/etc/rsyslog.d/</code> directory named, for example, <code class="literal">securelogser.conf</code>.
							</li><li class="listitem"><p class="simpara">
								To encrypt the communication, the configuration file must contain paths to certificate files on your server, a selected authentication method, and a stream driver that supports TLS encryption. Add the following lines to the <code class="literal">/etc/rsyslog.d/securelogser.conf</code> file:
							</p><pre class="screen white-space-pre white-space-pre"># Set certificate files
global(
  DefaultNetstreamDriverCAFile="/etc/pki/ca-trust/source/anchors/ca-cert.pem"
  DefaultNetstreamDriverCertFile="/etc/pki/ca-trust/source/anchors/server-cert.pem"
  DefaultNetstreamDriverKeyFile="/etc/pki/ca-trust/source/anchors/server-key.pem"
)

# TCP listener
module(
  load="imtcp"
  PermittedPeer=["client1.example.com", "client2.example.com"]
  StreamDriver.AuthMode="x509/name"
  StreamDriver.Mode="1"
  StreamDriver.Name="ossl"
)

# Start up listener at port 514
input(
  type="imtcp"
  port="514"
)</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									If you prefer the GnuTLS driver, use the <code class="literal">StreamDriver.Name="gtls"</code> configuration option. See the documentation installed with the <code class="literal">rsyslog-doc</code> package for more information about less strict authentication modes than <code class="literal">x509/name</code>.
								</p></div></rh-alert></li><li class="listitem"><p class="simpara">
								Optional: From Rsyslog version 8.2310, which is provided in RHEL 9.4, you can customize the connection configuration. To do so, replace the <code class="literal">input</code> section with the following:
							</p><pre class="screen">input(
  type="imtcp"
  Port="50515"
  StreamDriver.Name="<span class="emphasis"><em>&lt;driver&gt;</em></span>"
  streamdriver.CAFile="/etc/rsyslog.d/<span class="emphasis"><em>&lt;ca1&gt;</em></span>.pem"
  streamdriver.CertFile="/etc/rsyslog.d/<span class="emphasis"><em>&lt;server1-cert&gt;</em></span>.pem"
  streamdriver.KeyFile="/etc/rsyslog.d/<span class="emphasis"><em>&lt;server1-key&gt;</em></span>.pem"
)</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Replace <code class="literal"><span class="emphasis"><em>&lt;driver&gt;</em></span></code> with <code class="literal">ossl</code> or <code class="literal">gtls</code> depending on the driver you want to use.
									</li><li class="listitem">
										Replace <code class="literal"><span class="emphasis"><em>&lt;ca1&gt;</em></span></code> with the CA certificate, <code class="literal"><span class="emphasis"><em>&lt;server1-cert&gt;</em></span></code> with the certificate, and <code class="literal"><span class="emphasis"><em>&lt;server1-key&gt;</em></span></code> with the key of the customized connection.
									</li></ul></div></li><li class="listitem">
								Save the changes to the <code class="literal">/etc/rsyslog.d/securelogser.conf</code> file.
							</li><li class="listitem"><p class="simpara">
								Verify the syntax of the <code class="literal">/etc/rsyslog.conf</code> file and any files in the <code class="literal">/etc/rsyslog.d/</code> directory:
							</p><pre class="screen"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-2.el8, config validation run (level 1)...
rsyslogd: End of config validation run. Bye.</pre></li><li class="listitem"><p class="simpara">
								Make sure the <code class="literal">rsyslog</code> service is running and enabled on the logging server:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl status rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
								Restart the <code class="literal">rsyslog</code> service:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
								Optional: If Rsyslog is not enabled, ensure the <code class="literal">rsyslog</code> service starts automatically after reboot:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable rsyslog</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Configure clients for sending encrypted logs to the server:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								On a client system, create a new file in the <code class="literal">/etc/rsyslog.d/</code> directory named, for example, <code class="literal">securelogcli.conf</code>.
							</li><li class="listitem"><p class="simpara">
								Add the following lines to the <code class="literal">/etc/rsyslog.d/securelogcli.conf</code> file:
							</p><pre class="screen white-space-pre white-space-pre"># Set certificate files
global(
  DefaultNetstreamDriverCAFile="/etc/pki/ca-trust/source/anchors/ca-cert.pem"
  DefaultNetstreamDriverCertFile="/etc/pki/ca-trust/source/anchors/client-cert.pem"
  DefaultNetstreamDriverKeyFile="/etc/pki/ca-trust/source/anchors/client-key.pem"
)


# Set up the action for all messages
*.* action(
  type="omfwd"
  StreamDriver="ossl"
  StreamDriverMode="1"
  StreamDriverPermittedPeers="server.example.com"
  StreamDriverAuthMode="x509/name"
  target="server.example.com" port="514" protocol="tcp"
)</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									If you prefer the GnuTLS driver, use the <code class="literal">StreamDriver.Name="gtls"</code> configuration option.
								</p></div></rh-alert></li><li class="listitem"><p class="simpara">
								Optional: From Rsyslog version 8.2310, which is provided in RHEL 9.4, you can customize the connection configuration. To do so, replace the <code class="literal">action</code> section with the following:
							</p><pre class="screen">local1.* action(
  type="omfwd"
  StreamDriver="&lt;driver&gt;"
  StreamDriverMode="1"
  StreamDriverAuthMode="x509/certvalid"
  streamDriver.CAFile="/etc/rsyslog.d/&lt;ca1&gt;.pem"
  streamDriver.CertFile="/etc/rsyslog.d/&lt;client1-cert&gt;.pem"
  streamDriver.KeyFile="/etc/rsyslog.d/&lt;client1-key&gt;.pem"
  target="server.example.com" port="514" protocol="tcp"
  )</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Replace <code class="literal"><span class="emphasis"><em>&lt;driver&gt;</em></span></code> with <code class="literal">ossl</code> or <code class="literal">gtls</code> depending on the driver you want to use.
									</li><li class="listitem">
										Replace <code class="literal"><span class="emphasis"><em>&lt;ca1&gt;</em></span></code> with the CA certificate, <code class="literal"><span class="emphasis"><em>&lt;client1-cert&gt;</em></span></code> with the certificate, and <code class="literal">&lt;client1-key&gt;</code> with the key of the customized connection.
									</li></ul></div></li><li class="listitem">
								Save the changes to the <code class="literal">/etc/rsyslog.d/securelogcli.conf</code> file.
							</li><li class="listitem"><p class="simpara">
								Verify the syntax of the <code class="literal">/etc/rsyslog.conf</code> file and other files in the <code class="literal">/etc/rsyslog.d/</code> directory:
							</p><pre class="screen"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-2.el8, config validation run (level 1)...
rsyslogd: End of config validation run. Bye.</pre></li><li class="listitem"><p class="simpara">
								Make sure the <code class="literal">rsyslog</code> service is running and enabled on the logging server:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl status rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
								Restart the <code class="literal">rsyslog</code> service:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
								Optional: If Rsyslog is not enabled, ensure the <code class="literal">rsyslog</code> service starts automatically after reboot:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable rsyslog</strong></span></pre></li></ol></div></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					To verify that the client system sends messages to the server, follow these steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the client system, send a test message:
					</p><pre class="screen"># <span class="strong strong"><strong>logger test</strong></span></pre></li><li class="listitem"><p class="simpara">
						On the server system, view the <code class="literal">/var/log/messages</code> log, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /var/log/remote/msg/<span class="emphasis"><em>&lt;hostname&gt;</em></span>/root.log</strong></span>
Feb 25 03:53:17 <span class="emphasis"><em>&lt;hostname&gt;</em></span> root[6064]: test</pre><p class="simpara">
						Where <code class="literal"><span class="emphasis"><em>&lt;hostname&gt;</em></span></code> is the hostname of the client system. Note that the log contains the user name of the user that entered the logger command, in this case <code class="literal">root</code>.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">certtool(1)</code>, <code class="literal">openssl(1)</code>, <code class="literal">update-ca-trust(8)</code>, <code class="literal">rsyslogd(8)</code>, and <code class="literal">rsyslog.conf(5)</code> man pages.
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rsyslog-doc</code> package at <code class="literal">/usr/share/doc/rsyslog/html/index.html</code>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles">Using the logging system role with TLS</a>.
					</li></ul></div></section><section class="section" id="configuring-a-server-for-receiving-remote-logging-information-over-udp_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.6. Configuring a server for receiving remote logging information over UDP</h3></div></div></div><p class="_abstract _abstract">
				The <span class="strong strong"><strong>Rsyslog</strong></span> application enables you to configure a system to receive logging information from remote systems. To use remote logging through UDP, configure both the server and the client. The receiving server collects and analyzes the logs sent by one or more client systems. By default, <code class="literal">rsyslog</code> uses UDP on port <code class="literal">514</code> to receive log information from remote systems.
			</p><p>
				Follow this procedure to configure a server for collecting and analyzing logs sent by one or more client systems over the UDP protocol.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Rsyslog is installed on the server system.
					</li><li class="listitem">
						You are logged in as <code class="literal">root</code> on the server.
					</li><li class="listitem">
						The <code class="literal">policycoreutils-python-utils</code> package is installed for the optional step using the <code class="literal">semanage</code> command.
					</li><li class="listitem">
						The <code class="literal">firewalld</code> service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: To use a different port for <code class="literal">rsyslog</code> traffic than the default port <code class="literal">514</code>:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Add the <code class="literal">syslogd_port_t</code> SELinux type to the SELinux policy configuration, replacing <code class="literal"><span class="emphasis"><em>portno</em></span></code> with the port number you want <code class="literal">rsyslog</code> to use:
							</p><pre class="screen"># <span class="strong strong"><strong>semanage port -a -t syslogd_port_t -p udp <span class="emphasis"><em>portno</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								Configure <code class="literal">firewalld</code> to allow incoming <code class="literal">rsyslog</code> traffic, replacing <code class="literal"><span class="emphasis"><em>portno</em></span></code> with the port number and <code class="literal">zone</code> with the zone you want <code class="literal">rsyslog</code> to use:
							</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --zone=<span class="emphasis"><em>zone</em></span> --permanent --add-port=<span class="emphasis"><em>portno</em></span>/udp</strong></span>
success
# <span class="strong strong"><strong>firewall-cmd --reload</strong></span></pre></li><li class="listitem"><p class="simpara">
								Reload the firewall rules:
							</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --reload</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/rsyslog.d/</code> directory, for example, <code class="literal">remotelogserv.conf</code>, and insert the following content:
					</p><pre class="screen white-space-pre white-space-pre"># Define templates before the rules that use them
# Per-Host templates for remote systems
template(name="TmplAuthpriv" type="list") {
    constant(value="/var/log/remote/auth/")
    property(name="hostname")
    constant(value="/")
    property(name="programname" SecurePath="replace")
    constant(value=".log")
    }

template(name="TmplMsg" type="list") {
    constant(value="/var/log/remote/msg/")
    property(name="hostname")
    constant(value="/")
    property(name="programname" SecurePath="replace")
    constant(value=".log")
    }

# Provides UDP syslog reception
module(load="imudp")

# This ruleset processes remote messages
ruleset(name="remote1"){
     authpriv.*   action(type="omfile" DynaFile="TmplAuthpriv")
      *.info;mail.none;authpriv.none;cron.none
action(type="omfile" DynaFile="TmplMsg")
}

input(type="imudp" port="514" ruleset="remote1")</pre><p class="simpara">
						Where <code class="literal">514</code> is the port number <code class="literal">rsyslog</code> uses by default. You can specify a different port instead.
					</p></li><li class="listitem"><p class="simpara">
						Verify the syntax of the <code class="literal">/etc/rsyslog.conf</code> file and all <code class="literal">.conf</code> files in the <code class="literal">/etc/rsyslog.d/</code> directory:
					</p><pre class="screen"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-2.el8, config validation run...</pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">rsyslog</code> service.
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: If <code class="literal">rsyslog</code> is not enabled, ensure the <code class="literal">rsyslog</code> service starts automatically after reboot:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable rsyslog</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">rsyslogd(8)</code> , <code class="literal">rsyslog.conf(5)</code>, <code class="literal">semanage(8)</code>, and <code class="literal">firewall-cmd(1)</code> man pages.
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rsyslog-doc</code> package in the <code class="literal">/usr/share/doc/rsyslog/html/index.html</code> file.
					</li></ul></div></section><section class="section" id="configuring-remote-logging-to-a-server-over-udp_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.7. Configuring remote logging to a server over UDP</h3></div></div></div><p>
				You can configure a system for forwarding log messages to a server over the UDP protocol. The <code class="literal">omfwd</code> plug-in provides forwarding over UDP or TCP. The default protocol is UDP. Because the plug-in is built in, you do not have to load it.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">rsyslog</code> package is installed on the client systems that should report to the server.
					</li><li class="listitem">
						You have configured the server for remote logging as described in <a class="link" href="#configuring-a-server-for-receiving-remote-logging-information-over-udp_assembly_configuring-a-remote-logging-solution" title="14.6. Configuring a server for receiving remote logging information over UDP">Configuring a server for receiving remote logging information over UDP</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/rsyslog.d/</code> directory, for example, <code class="literal">10-remotelogcli.conf</code>, and insert the following content:
					</p><pre class="screen">*.* action(type="omfwd"
      queue.type="linkedlist"
      queue.filename="<span class="emphasis"><em>example_fwd</em></span>"
      action.resumeRetryCount="-1"
      queue.saveOnShutdown="on"
      target="<span class="emphasis"><em>example.com</em></span>" port="<span class="emphasis"><em>portno</em></span>" protocol="udp"
     )</pre><p class="simpara">
						Where:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The <code class="literal">queue.type="linkedlist"</code> setting enables a LinkedList in-memory queue.
							</li><li class="listitem">
								The <code class="literal">queue.filename</code> setting defines a disk storage. The backup files are created with the <code class="literal"><span class="emphasis"><em>example_fwd</em></span></code> prefix in the working directory specified by the preceding global <code class="literal">workDirectory</code> directive.
							</li><li class="listitem">
								The <code class="literal">action.resumeRetryCount -1</code> setting prevents <code class="literal">rsyslog</code> from dropping messages when retrying to connect if the server is not responding.
							</li><li class="listitem">
								The <code class="literal">enabled queue.saveOnShutdown="on"</code> setting saves in-memory data if <code class="literal">rsyslog</code> shuts down.
							</li><li class="listitem">
								The <code class="literal"><span class="emphasis"><em>portno</em></span></code> value is the port number you want <code class="literal">rsyslog</code> to use. The default value is <code class="literal">514</code>.
							</li><li class="listitem"><p class="simpara">
								The last line forwards all received messages to the logging server, port specification is optional.
							</p><p class="simpara">
								With this configuration, <code class="literal">rsyslog</code> sends messages to the server but keeps messages in memory if the remote server is not reachable. A file on disk is created only if <code class="literal">rsyslog</code> runs out of the configured memory queue space or needs to shut down, which benefits the system performance.
							</p></li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Rsyslog processes configuration files <code class="literal">/etc/rsyslog.d/</code> in the lexical order.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">rsyslog</code> service.
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: If <code class="literal">rsyslog</code> is not enabled, ensure the <code class="literal">rsyslog</code> service starts automatically after reboot:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable rsyslog</strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					To verify that the client system sends messages to the server, follow these steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the client system, send a test message:
					</p><pre class="screen"># <span class="strong strong"><strong>logger test</strong></span></pre></li><li class="listitem"><p class="simpara">
						On the server system, view the <code class="literal">/var/log/remote/msg/<span class="emphasis"><em>hostname</em></span>/root.log</code> log, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /var/log/remote/msg/<span class="emphasis"><em>hostname</em></span>/root.log</strong></span>
Feb 25 03:53:17 hostname root[6064]: test</pre><p class="simpara">
						Where <code class="literal">hostname</code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case <code class="literal">root</code>.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">rsyslogd(8)</code> and <code class="literal">rsyslog.conf(5)</code> man pages.
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rsyslog-doc</code> package at <code class="literal">/usr/share/doc/rsyslog/html/index.html</code>.
					</li></ul></div></section><section class="section" id="con_load-balancing-helper-in-rsyslog_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.8. Load balancing helper in Rsyslog</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">RebindInterval</code> setting specifies an interval at which the current connection is broken and is re-established. This setting applies to TCP, UDP, and RELP traffic. The load balancers perceive it as a new connection and forward the messages to another physical target system.
			</p><p>
				The <code class="literal">RebindInterval</code> setting proves to be helpful in scenarios when a target system has changed its IP address. The Rsyslog application caches the IP address when the connection establishes, therefore, the messages are sent to the same server. If the IP address changes, the UDP packets will be lost until the Rsyslog service restarts. Re-establishing the connection will ensure the IP to be resolved by DNS again.
			</p><pre class="screen">action(type=”omfwd” protocol=”tcp” RebindInterval=”250” target=”<span class="emphasis"><em>example.com</em></span>” port=”514” …)

action(type=”omfwd” protocol=”udp” RebindInterval=”250” target=”<span class="emphasis"><em>example.com</em></span>” port=”514” …)

action(type=”omrelp” RebindInterval=”250” target=”<span class="emphasis"><em>example.com</em></span>” port=”6514” …)</pre></section><section class="section" id="configuring-reliable-remote-logging_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.9. Configuring reliable remote logging</h3></div></div></div><p class="_abstract _abstract">
				With the Reliable Event Logging Protocol (RELP), you can send and receive <code class="literal">syslog</code> messages over TCP with a much reduced risk of message loss. RELP provides reliable delivery of event messages, which makes it useful in environments where message loss is not acceptable. To use RELP, configure the <code class="literal">imrelp</code> input module, which runs on the server and receives the logs, and the <code class="literal">omrelp</code> output module, which runs on the client and sends logs to the logging server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the <code class="literal">rsyslog</code>, <code class="literal">librelp</code>, and <code class="literal">rsyslog-relp</code> packages on the server and the client systems.
					</li><li class="listitem">
						The specified port is permitted in SELinux and open in the firewall.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Configure the client system for reliable remote logging:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								On the client system, create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/rsyslog.d/</code> directory named, for example, <code class="literal">relpclient.conf</code>, and insert the following content:
							</p><pre class="screen">module(load="omrelp")
*.* action(type="omrelp" target="_target_IP_" port="_target_port_")</pre><p class="simpara">
								Where:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal"><span class="emphasis"><em>target_IP</em></span></code> is the IP address of the logging server.
									</li><li class="listitem">
										<code class="literal"><span class="emphasis"><em>target_port</em></span></code> is the port of the logging server.
									</li></ul></div></li><li class="listitem">
								Save the changes to the <code class="literal">/etc/rsyslog.d/relpclient.conf</code> file.
							</li><li class="listitem"><p class="simpara">
								Restart the <code class="literal">rsyslog</code> service.
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
								Optional: If <code class="literal">rsyslog</code> is not enabled, ensure the <code class="literal">rsyslog</code> service starts automatically after reboot:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable rsyslog</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Configure the server system for reliable remote logging:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								On the server system, create a new <code class="literal">.conf</code> file in the <code class="literal">/etc/rsyslog.d/</code> directory named, for example, <code class="literal">relpserv.conf</code>, and insert the following content:
							</p><pre class="screen">ruleset(name="relp"){
*.* action(type="omfile" file="_log_path_")
}


module(load="imrelp")
input(type="imrelp" port="_target_port_" ruleset="relp")</pre><p class="simpara">
								Where:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal"><span class="emphasis"><em>log_path</em></span></code> specifies the path for storing messages.
									</li><li class="listitem">
										<code class="literal"><span class="emphasis"><em>target_port</em></span></code> is the port of the logging server. Use the same value as in the client configuration file.
									</li></ul></div></li><li class="listitem">
								Save the changes to the <code class="literal">/etc/rsyslog.d/relpserv.conf</code> file.
							</li><li class="listitem"><p class="simpara">
								Restart the <code class="literal">rsyslog</code> service.
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart rsyslog</strong></span></pre></li><li class="listitem"><p class="simpara">
								Optional: If <code class="literal">rsyslog</code> is not enabled, ensure the <code class="literal">rsyslog</code> service starts automatically after reboot:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable rsyslog</strong></span></pre></li></ol></div></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					To verify that the client system sends messages to the server, follow these steps:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the client system, send a test message:
					</p><pre class="screen"># <span class="strong strong"><strong>logger test</strong></span></pre></li><li class="listitem"><p class="simpara">
						On the server system, view the log at the specified <code class="literal"><span class="emphasis"><em>log_path</em></span></code>, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /var/log/remote/msg/hostname/root.log</strong></span>
Feb 25 03:53:17 hostname root[6064]: test</pre><p class="simpara">
						Where <code class="literal">hostname</code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case <code class="literal">root</code>.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">rsyslogd(8)</code> and <code class="literal">rsyslog.conf(5)</code> man pages.
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rsyslog-doc</code> package in the <code class="literal">/usr/share/doc/rsyslog/html/index.html</code> file.
					</li></ul></div></section><section class="section" id="supported-rsyslog-modules_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.10. Supported Rsyslog modules</h3></div></div></div><p class="_abstract _abstract">
				To expand the functionality of the Rsyslog application, you can use specific modules. Modules provide additional inputs (Input Modules), outputs (Output Modules), and other functionalities. A module can also provide additional configuration directives that become available after you load the module.
			</p><p>
				You can list the input and output modules installed on your system by entering the following command:
			</p><pre class="screen"># <span class="strong strong"><strong>ls /usr/lib64/rsyslog/{i,o}m</strong></span>*</pre><p>
				You can view the list of all available <code class="literal">rsyslog</code> modules in the <code class="literal">/usr/share/doc/rsyslog/html/configuration/modules/idx_output.html</code> file after you install the <code class="literal">rsyslog-doc</code> package.
			</p></section><section class="section" id="configuring-the-netconsole-service-to-log-kernel-messages-to-a-remote-host_assembly_configuring-a-remote-logging-solution"><div class="titlepage"><div><div><h3 class="title">14.11. Configuring the netconsole service to log kernel messages to a remote host</h3></div></div></div><p class="_abstract _abstract">
				When logging to disk or using a serial console is not possible, you can use the <code class="literal">netconsole</code> kernel module and the same-named service to log kernel messages over a network to a remote <code class="literal">rsyslog</code> service.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A system log service, such as <code class="literal">rsyslog</code> is installed on the remote host.
					</li><li class="listitem">
						The remote system log service is configured to receive incoming log entries from this host.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal">netconsole-service</code> package:
					</p><pre class="literallayout"># <span class="strong strong"><strong>dnf install netconsole-service</strong></span></pre></li><li class="listitem"><p class="simpara">
						Edit the <code class="literal">/etc/sysconfig/netconsole</code> file and set the <code class="literal">SYSLOGADDR</code> parameter to the IP address of the remote host:
					</p><pre class="literallayout"># <span class="strong strong"><strong>SYSLOGADDR=<span class="emphasis"><em>192.0.2.1</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Enable and start the <code class="literal">netconsole</code> service:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl enable --now netconsole</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Display the <code class="literal">/var/log/messages</code> file on the remote system log server.
					</li></ul></div><div class="_additional-resources _additional-resources"><p class="title"><strong>Additional resources</strong></p><p>
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/assembly_configuring-a-remote-logging-solution_security-hardening">Configuring a remote logging solution</a>
				</p></div></section><section class="section _additional-resources" id="additional_resources_4"><div class="titlepage"><div><div><h3 class="title">14.12. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Documentation installed with the <code class="literal">rsyslog-doc</code> package in the <code class="literal">/usr/share/doc/rsyslog/html/index.html</code> file
					</li><li class="listitem">
						<code class="literal">rsyslog.conf(5)</code> and <code class="literal">rsyslogd(8)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/4058681">Configuring system logging without journald or with minimized journald usage</a> Knowledgebase article
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/4095141">Negative effects of the RHEL default logging setup on performance and their mitigations</a> Knowledgebase article
					</li><li class="listitem">
						The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Using the Logging system role</a> chapter
					</li></ul></div></section></section><section class="chapter" id="assembly_using-the-logging-system-role_security-hardening"><div class="titlepage"><div><div><h2 class="title">Chapter 15. Using the <code class="literal">logging</code> system role</h2></div></div></div><p class="_abstract _abstract">
			As a system administrator, you can use the <code class="literal">logging</code> system role to configure a Red Hat Enterprise Linux host as a logging server to collect logs from many client systems.
		</p><section class="section" id="proc_filtering-logs-in-a-local-logging-system-role_assembly_using-the-logging-system-role"><div class="titlepage"><div><div><h3 class="title">15.1. Filtering local log messages by using the <code class="literal">logging</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can use the property-based filter of the <code class="literal">logging</code> RHEL system role to filter your local log messages based on various conditions. As a result, you can achieve for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Log clarity: In a high-traffic environment, logs can grow rapidly. The focus on specific messages, like errors, can help to identify problems faster.
					</li><li class="listitem">
						Optimized system performance: Excessive amount of logs is usually connected with system performance degradation. Selective logging for only the important events can prevent resource depletion, which enables your systems to run more efficiently.
					</li><li class="listitem">
						Enhanced security: Efficient filtering through security messages, like system errors and failed logins, helps to capture only the relevant logs. This is important for detecting breaches and meeting compliance standards.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Deploy the logging solution
  hosts: managed-node-01.example.com
  tasks:
    - name: Filter logs based on a specific value they contain
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: files_input
            type: basics
        logging_outputs:
          - name: files_output0
            type: files
            property: msg
            property_op: contains
            property_value: error
            path: /var/log/errors.log
          - name: files_output1
            type: files
            property: msg
            property_op: "!contains"
            property_value: error
            path: /var/log/others.log
        logging_flows:
          - name: flow0
            inputs: [files_input]
            outputs: [files_output0, files_output1]</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_inputs</code></span></dt><dd>
									Defines a list of logging input dictionaries. The <code class="literal">type: basics</code> option covers inputs from <code class="literal">systemd</code> journal or Unix socket.
								</dd><dt><span class="term"><code class="literal">logging_outputs</code></span></dt><dd>
									Defines a list of logging output dictionaries. The <code class="literal">type: files</code> option supports storing logs in the local files, usually in the <code class="literal">/var/log/</code> directory. The <code class="literal">property: msg</code>; <code class="literal">property: contains</code>; and <code class="literal">property_value: error</code> options specify that all logs that contain the <code class="literal">error</code> string are stored in the <code class="literal">/var/log/errors.log</code> file. The <code class="literal">property: msg</code>; <code class="literal">property: !contains</code>; and <code class="literal">property_value: error</code> options specify that all other logs are put in the <code class="literal">/var/log/others.log</code> file. You can replace the <code class="literal">error</code> value with the string by which you want to filter.
								</dd><dt><span class="term"><code class="literal">logging_flows</code></span></dt><dd>
									Defines a list of logging flow dictionaries to specify relationships between <code class="literal">logging_inputs</code> and <code class="literal">logging_outputs</code>. The <code class="literal">inputs: [files_input]</code> option specifies a list of inputs, from which processing of logs starts. The <code class="literal">outputs: [files_output0, files_output1]</code> option specifies a list of outputs, to which the logs are sent.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the managed node, test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-6.el8, config validation run...
rsyslogd: End of config validation run. Bye.</pre></li><li class="listitem"><p class="simpara">
						On the managed node, verify that the system sends messages that contain the <code class="literal">error</code> string to the log:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Send a test message:
							</p><pre class="literallayout"># <span class="strong strong"><strong>logger error</strong></span></pre></li><li class="listitem"><p class="simpara">
								View the <code class="literal">/var/log/errors.log</code> log, for example:
							</p><pre class="literallayout"># <span class="strong strong"><strong>cat /var/log/errors.log</strong></span>
Aug  5 13:48:31 <span class="emphasis"><em>hostname</em></span> root[6778]: error</pre><p class="simpara">
								Where <code class="literal"><span class="emphasis"><em>hostname</em></span></code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case <code class="literal">root</code>.
							</p></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
					</li><li class="listitem">
						<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
					</li></ul></div></section><section class="section" id="applying-a-remote-logging-solution-using-the-logging-system-role_assembly_using-the-logging-system-role"><div class="titlepage"><div><div><h3 class="title">15.2. Applying a remote logging solution by using the <code class="literal">logging</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">logging</code> RHEL system role to configure a remote logging solution, where one or more clients take logs from the <code class="literal">systemd-journal</code> service and forward them to a remote server. The server receives remote input from the <code class="literal">remote_rsyslog</code> and <code class="literal">remote_files</code> configurations, and outputs the logs to local files in directories named by remote host names.
			</p><p>
				As a result, you can cover use cases where you need for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Centralized log management: Collecting, accessing, and managing log messages of multiple machines from a single storage point simplifies day-to-day monitoring and troubleshooting tasks. Also, this use case reduces the need to log into individual machines to check the log messages.
					</li><li class="listitem">
						Enhanced security: Storing log messages in one central place increases chances they are in a secure and tamper-proof environment. Such an environment makes it easier to detect and respond to security incidents more effectively and to meet audit requirements.
					</li><li class="listitem">
						Improved efficiency in log analysis: Correlating log messages from multiple systems is important for fast troubleshooting of complex problems that span multiple machines or services. That way you can quickly analyze and cross-reference events from different sources.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						Define the ports in the SELinux policy of the server or client system and open the firewall for those ports. The default SELinux policy includes ports 601, 514, 6514, 10514, and 20514. To use a different port, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations">modify the SELinux policy on the client and server systems</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Deploy the logging solution
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure the server to receive remote input
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: remote_udp_input
            type: remote
            udp_ports: [ 601 ]
          - name: remote_tcp_input
            type: remote
            tcp_ports: [ 601 ]
        logging_outputs:
          - name: remote_files_output
            type: remote_files
        logging_flows:
          - name: flow_0
            inputs: [remote_udp_input, remote_tcp_input]
            outputs: [remote_files_output]

- name: Deploy the logging solution
  hosts: managed-node-02.example.com
  tasks:
    - name: Configure the server to output the logs to local files in directories named by remote host names
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: basic_input
            type: basics
        logging_outputs:
          - name: forward_output0
            type: forwards
            severity: info
            target: <span class="emphasis"><em>&lt;host1.example.com&gt;</em></span>
            udp_port: 601
          - name: forward_output1
            type: forwards
            facility: mail
            target: <span class="emphasis"><em>&lt;host1.example.com&gt;</em></span>
            tcp_port: 601
        logging_flows:
          - name: flows0
            inputs: [basic_input]
            outputs: [forward_output0, forward_output1]

[basic_input]
[forward_output0, forward_output1]</pre><p class="simpara">
						The settings specified in the first play of the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_inputs</code></span></dt><dd>
									Defines a list of logging input dictionaries. The <code class="literal">type: remote</code> option covers remote inputs from the other logging system over the network. The <code class="literal">udp_ports: [ 601 ]</code> option defines a list of UDP port numbers to monitor. The <code class="literal">tcp_ports: [ 601 ]</code> option defines a list of TCP port numbers to monitor. If both <code class="literal">udp_ports</code> and <code class="literal">tcp_ports</code> is set, <code class="literal">udp_ports</code> is used and <code class="literal">tcp_ports</code> is dropped.
								</dd><dt><span class="term"><code class="literal">logging_outputs</code></span></dt><dd>
									Defines a list of logging output dictionaries. The <code class="literal">type: remote_files</code> option makes output store logs to the local files per remote host and program name originated the logs.
								</dd><dt><span class="term"><code class="literal">logging_flows</code></span></dt><dd>
									Defines a list of logging flow dictionaries to specify relationships between <code class="literal">logging_inputs</code> and <code class="literal">logging_outputs</code>. The <code class="literal">inputs: [remote_udp_input, remote_tcp_input]</code> option specifies a list of inputs, from which processing of logs starts. The <code class="literal">outputs: [remote_files_output]</code> option specifies a list of outputs, to which the logs are sent.
								</dd></dl></div><p class="simpara">
						The settings specified in the second play of the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_inputs</code></span></dt><dd>
									Defines a list of logging input dictionaries. The <code class="literal">type: basics</code> option covers inputs from <code class="literal">systemd</code> journal or Unix socket.
								</dd><dt><span class="term"><code class="literal">logging_outputs</code></span></dt><dd>
									Defines a list of logging output dictionaries. The <code class="literal">type: forwards</code> option supports sending logs to the remote logging server over the network. The <code class="literal">severity: info</code> option refers to log messages of the informative importance. The <code class="literal">facility: mail</code> option refers to the type of system program that is generating the log message. The <code class="literal">target: <span class="emphasis"><em>&lt;host1.example.com&gt;</em></span></code> option specifies the hostname of the remote logging server. The <code class="literal">udp_port: 601</code>/<code class="literal">tcp_port: 601</code> options define the UDP/TCP ports on which the remote logging server listens.
								</dd><dt><span class="term"><code class="literal">logging_flows</code></span></dt><dd>
									Defines a list of logging flow dictionaries to specify relationships between <code class="literal">logging_inputs</code> and <code class="literal">logging_outputs</code>. The <code class="literal">inputs: [basic_input]</code> option specifies a list of inputs, from which processing of logs starts. The <code class="literal">outputs: [forward_output0, forward_output1]</code> option specifies a list of outputs, to which the logs are sent.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On both the client and the server system, test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-6.el8, config validation run (level 1), master config /etc/rsyslog.conf
rsyslogd: End of config validation run. Bye.</pre></li><li class="listitem"><p class="simpara">
						Verify that the client system sends messages to the server:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								On the client system, send a test message:
							</p><pre class="literallayout"># <span class="strong strong"><strong>logger test</strong></span></pre></li><li class="listitem"><p class="simpara">
								On the server system, view the <code class="literal">/var/log/<span class="emphasis"><em>&lt;host2.example.com&gt;</em></span>/messages</code> log, for example:
							</p><pre class="literallayout"># <span class="strong strong"><strong>cat /var/log/<span class="emphasis"><em>&lt;host2.example.com&gt;</em></span>/messages</strong></span>
Aug  5 13:48:31 <span class="emphasis"><em>&lt;host2.example.com&gt;</em></span> root[6778]: test</pre><p class="simpara">
								Where <code class="literal"><span class="emphasis"><em>&lt;host2.example.com&gt;</em></span></code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case <code class="literal">root</code>.
							</p></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
					</li><li class="listitem">
						<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
					</li></ul></div></section><section class="section" id="assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role"><div class="titlepage"><div><div><h3 class="title">15.3. Using the <code class="literal">logging</code> RHEL system role with TLS</h3></div></div></div><p class="_abstract _abstract">
				Transport Layer Security (TLS) is a cryptographic protocol designed to allow secure communication over the computer network.
			</p><p>
				You can use the <code class="literal">logging</code> RHEL system role to configure a secure transfer of log messages, where one or more clients take logs from the <code class="literal">systemd-journal</code> service and transfer them to a remote server while using TLS.
			</p><p>
				Typically, TLS for transferring logs in a remote logging solution is used when sending sensitive data over less trusted or public networks, such as the Internet. Also, by using certificates in TLS you can ensure that the client is forwarding logs to the correct and trusted server. This prevents attacks like "man-in-the-middle".
			</p><section class="section" id="configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls"><div class="titlepage"><div><div><h4 class="title">15.3.1. Configuring client logging with TLS</h4></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> RHEL system role to configure logging on RHEL clients and transfer logs to a remote logging system using TLS encryption.
				</p><p>
					This procedure creates a private key and a certificate. Next, it configures TLS on all hosts in the clients group in the Ansible inventory. The TLS protocol encrypts the message transmission for secure transfer of logs over the network.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						You do not have to call the <code class="literal">certificate</code> RHEL system role in the playbook to create the certificate. The <code class="literal">logging</code> RHEL system role calls it automatically when the <code class="literal">logging_certificates</code> variable is set.
					</p><p>
						In order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							The managed nodes are enrolled in an IdM domain.
						</li><li class="listitem">
							If the logging server you want to configure on the manage node runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS extension "Extended Master Secret" enforced</a> Knowledgebase article.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure remote logging solution using TLS for secure transfer of logs
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploying files input and forwards output with certs
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_certificates:
          - name: logging_cert
            dns: ['localhost', 'www.example.com']
            ca: ipa
        logging_pki_files:
          - ca_cert: /local/path/to/ca_cert.pem
            cert: /local/path/to/logging_cert.pem
            private_key: /local/path/to/logging_cert.pem
        logging_inputs:
          - name: input_name
            type: files
            input_log_path: /var/log/containers/*.log
        logging_outputs:
          - name: output_name
            type: forwards
            target: your_target_host
            tcp_port: 514
            tls: true
            pki_authmode: x509/name
            permitted_server: 'server.example.com'
        logging_flows:
          - name: flow_name
            inputs: [input_name]
            outputs: [output_name]</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_certificates</code></span></dt><dd>
										The value of this parameter is passed on to <code class="literal">certificate_requests</code> in the <code class="literal">certificate</code> RHEL system role and used to create a private key and certificate.
									</dd><dt><span class="term"><code class="literal">logging_pki_files</code></span></dt><dd><p class="simpara">
										Using this parameter, you can configure the paths and other settings that logging uses to find the CA, certificate, and key files used for TLS, specified with one or more of the following sub-parameters: <code class="literal">ca_cert</code>, <code class="literal">ca_cert_src</code>, <code class="literal">cert</code>, <code class="literal">cert_src</code>, <code class="literal">private_key</code>, <code class="literal">private_key_src</code>, and <code class="literal">tls</code>.
									</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
											If you are using <code class="literal">logging_certificates</code> to create the files on the managed node, do not use <code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, and <code class="literal">private_key_src</code>, which are used to copy files not created by <code class="literal">logging_certificates</code>.
										</p></div></rh-alert></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to the CA certificate file on the managed node. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to the certificate file on the managed node. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to the private key file on the managed node. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents the path to the CA certificate file on the control node which is copied to the target host to the location specified by <code class="literal">ca_cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the path to a certificate file on the control node which is copied to the target host to the location specified by <code class="literal">cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the path to a private key file on the control node which is copied to the target host to the location specified by <code class="literal">private_key</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd>
										Setting this parameter to <code class="literal">true</code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set <code class="literal">tls: false</code>.
									</dd></dl></div><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
						</li><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/certificate/</code> directory
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL system roles</a>.
						</li><li class="listitem">
							<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
						</li></ul></div></section><section class="section" id="configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls"><div class="titlepage"><div><div><h4 class="title">15.3.2. Configuring server logging with TLS</h4></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> RHEL system role to configure logging on RHEL servers and set them to receive logs from a remote logging system using TLS encryption.
				</p><p>
					This procedure creates a private key and a certificate. Next, it configures TLS on all hosts in the server group in the Ansible inventory.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						You do not have to call the <code class="literal">certificate</code> RHEL system role in the playbook to create the certificate. The <code class="literal">logging</code> RHEL system role calls it automatically.
					</p><p>
						In order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							The managed nodes are enrolled in an IdM domain.
						</li><li class="listitem">
							If the logging server you want to configure on the manage node runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS extension "Extended Master Secret" enforced</a> Knowledgebase article.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure remote logging solution using TLS for secure transfer of logs
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploying remote input and remote_files output with certs
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_certificates:
          - name: logging_cert
            dns: ['localhost', 'www.example.com']
            ca: ipa
        logging_pki_files:
          - ca_cert: /local/path/to/ca_cert.pem
            cert: /local/path/to/logging_cert.pem
            private_key: /local/path/to/logging_cert.pem
        logging_inputs:
          - name: input_name
            type: remote
            tcp_ports: 514
            tls: true
            permitted_clients: ['clients.example.com']
        logging_outputs:
          - name: output_name
            type: remote_files
            remote_log_path: /var/log/remote/%FROMHOST%/%PROGRAMNAME:::secpath-replace%.log
            async_writing: true
            client_count: 20
            io_buffer_size: 8192
        logging_flows:
          - name: flow_name
            inputs: [input_name]
            outputs: [output_name]</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_certificates</code></span></dt><dd>
										The value of this parameter is passed on to <code class="literal">certificate_requests</code> in the <code class="literal">certificate</code> RHEL system role and used to create a private key and certificate.
									</dd><dt><span class="term"><code class="literal">logging_pki_files</code></span></dt><dd><p class="simpara">
										Using this parameter, you can configure the paths and other settings that logging uses to find the CA, certificate, and key files used for TLS, specified with one or more of the following sub-parameters: <code class="literal">ca_cert</code>, <code class="literal">ca_cert_src</code>, <code class="literal">cert</code>, <code class="literal">cert_src</code>, <code class="literal">private_key</code>, <code class="literal">private_key_src</code>, and <code class="literal">tls</code>.
									</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
											If you are using <code class="literal">logging_certificates</code> to create the files on the managed node, do not use <code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, and <code class="literal">private_key_src</code>, which are used to copy files not created by <code class="literal">logging_certificates</code>.
										</p></div></rh-alert></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to the CA certificate file on the managed node. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to the certificate file on the managed node. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to the private key file on the managed node. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents the path to the CA certificate file on the control node which is copied to the target host to the location specified by <code class="literal">ca_cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the path to a certificate file on the control node which is copied to the target host to the location specified by <code class="literal">cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the path to a private key file on the control node which is copied to the target host to the location specified by <code class="literal">private_key</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd>
										Setting this parameter to <code class="literal">true</code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set <code class="literal">tls: false</code>.
									</dd></dl></div><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL system roles</a>.
						</li><li class="listitem">
							<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
						</li></ul></div></section></section><section class="section" id="assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h3 class="title">15.4. Using the <code class="literal">logging</code> RHEL system roles with RELP</h3></div></div></div><p class="_abstract _abstract">
				Reliable Event Logging Protocol (RELP) is a networking protocol for data and message logging over the TCP network. It ensures reliable delivery of event messages and you can use it in environments that do not tolerate any message loss.
			</p><p>
				The RELP sender transfers log entries in the form of commands and the receiver acknowledges them once they are processed. To ensure consistency, RELP stores the transaction number to each transferred command for any kind of message recovery.
			</p><p>
				You can consider a remote logging system in between the RELP Client and RELP Server. The RELP Client transfers the logs to the remote logging system and the RELP Server receives all the logs sent by the remote logging system. To achieve that use case, you can use the <code class="literal">logging</code> RHEL system role to configure the logging system to reliably send and receive log entries.
			</p><section class="section" id="configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h4 class="title">15.4.1. Configuring client logging with RELP</h4></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> RHEL system role to configure a transfer of log messages stored locally to the remote logging system with RELP.
				</p><p>
					This procedure configures RELP on all hosts in the <code class="literal">clients</code> group in the Ansible inventory. The RELP configuration uses Transport Layer Security (TLS) to encrypt the message transmission for secure transfer of logs over the network.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure client-side of the remote logging solution using RELP
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploy basic input and RELP output
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: basic_input
            type: basics
        logging_outputs:
          - name: relp_client
            type: relp
            target: logging.server.com
            port: 20514
            tls: true
            ca_cert: /etc/pki/tls/certs/ca.pem
            cert: /etc/pki/tls/certs/client-cert.pem
            private_key: /etc/pki/tls/private/client-key.pem
            pki_authmode: name
            permitted_servers:
              - '*.server.example.com'
        logging_flows:
          - name: example_flow
            inputs: [basic_input]
            outputs: [relp_client]</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">target</code></span></dt><dd>
										This is a required parameter that specifies the host name where the remote logging system is running.
									</dd><dt><span class="term"><code class="literal">port</code></span></dt><dd>
										Port number the remote logging system is listening.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd><p class="simpara">
										Ensures secure transfer of logs over the network. If you do not want a secure wrapper you can set the <code class="literal">tls</code> variable to <code class="literal">false</code>. By default <code class="literal">tls</code> parameter is set to true while working with RELP and requires key/certificates and triplets {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} and/or {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>}.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												If the {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>} triplet is set, the default locations <code class="literal">/etc/pki/tls/certs</code> and <code class="literal">/etc/pki/tls/private</code> are used as the destination on the managed node to transfer files from control node. In this case, the file names are identical to the original ones in the triplet
											</li><li class="listitem">
												If the {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} triplet is set, files are expected to be on the default path before the logging configuration.
											</li><li class="listitem">
												If both triplets are set, files are transferred from local path from control node to specific path of the managed node.
											</li></ul></div></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to CA certificate. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to certificate. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to private key. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents local CA certificate file path which is copied to the managed node. If <code class="literal">ca_cert</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the local certificate file path which is copied to the managed node. If <code class="literal">cert</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the local key file path which is copied to the managed node. If <code class="literal">private_key</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">pki_authmode</code></span></dt><dd>
										Accepts the authentication mode as <code class="literal">name</code> or <code class="literal">fingerprint</code>.
									</dd><dt><span class="term"><code class="literal">permitted_servers</code></span></dt><dd>
										List of servers that will be allowed by the logging client to connect and send logs over TLS.
									</dd><dt><span class="term"><code class="literal">inputs</code></span></dt><dd>
										List of logging input dictionary.
									</dd><dt><span class="term"><code class="literal">outputs</code></span></dt><dd>
										List of logging output dictionary.
									</dd></dl></div><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
						</li><li class="listitem">
							<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
						</li></ul></div></section><section class="section" id="configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h4 class="title">15.4.2. Configuring server logging with RELP</h4></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> RHEL system role to configure a server for receiving log messages from the remote logging system with RELP.
				</p><p>
					This procedure configures RELP on all hosts in the <code class="literal">server</code> group in the Ansible inventory. The RELP configuration uses TLS to encrypt the message transmission for secure transfer of logs over the network.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure server-side of the remote logging solution using RELP
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploying remote input and remote_files output
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: relp_server
            type: relp
            port: 20514
            tls: true
            ca_cert: /etc/pki/tls/certs/ca.pem
            cert: /etc/pki/tls/certs/server-cert.pem
            private_key: /etc/pki/tls/private/server-key.pem
            pki_authmode: name
            permitted_clients:
              - '*example.client.com'
        logging_outputs:
          - name: remote_files_output
            type: remote_files
        logging_flows:
          - name: example_flow
            inputs: relp_server
            outputs: remote_files_output</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">port</code></span></dt><dd>
										Port number the remote logging system is listening.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd><p class="simpara">
										Ensures secure transfer of logs over the network. If you do not want a secure wrapper you can set the <code class="literal">tls</code> variable to <code class="literal">false</code>. By default <code class="literal">tls</code> parameter is set to true while working with RELP and requires key/certificates and triplets {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} and/or {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>}.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												If the {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>} triplet is set, the default locations <code class="literal">/etc/pki/tls/certs</code> and <code class="literal">/etc/pki/tls/private</code> are used as the destination on the managed node to transfer files from control node. In this case, the file names are identical to the original ones in the triplet
											</li><li class="listitem">
												If the {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} triplet is set, files are expected to be on the default path before the logging configuration.
											</li><li class="listitem">
												If both triplets are set, files are transferred from local path from control node to specific path of the managed node.
											</li></ul></div></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to CA certificate. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to the certificate. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to private key. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents local CA certificate file path which is copied to the managed node. If <code class="literal">ca_cert</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the local certificate file path which is copied to the managed node. If <code class="literal">cert</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the local key file path which is copied to the managed node. If <code class="literal">private_key</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">pki_authmode</code></span></dt><dd>
										Accepts the authentication mode as <code class="literal">name</code> or <code class="literal">fingerprint</code>.
									</dd><dt><span class="term"><code class="literal">permitted_clients</code></span></dt><dd>
										List of clients that will be allowed by the logging server to connect and send logs over TLS.
									</dd><dt><span class="term"><code class="literal">inputs</code></span></dt><dd>
										List of logging input dictionary.
									</dd><dt><span class="term"><code class="literal">outputs</code></span></dt><dd>
										List of logging output dictionary.
									</dd></dl></div><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
						</li><li class="listitem">
							<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
						</li></ul></div></section></section><section class="section _additional-resources" id="additional_resources_5"><div class="titlepage"><div><div><h3 class="title">15.5. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Preparing a control node and managed nodes to use RHEL system roles</a>
					</li><li class="listitem">
						Documentation installed with the <code class="literal">rhel-system-roles</code> package in <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.html</code>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/node/3050101">RHEL system roles</a>
					</li><li class="listitem">
						<code class="literal">ansible-playbook(1)</code> man page on your system
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140081355003760"><h2 class="legalnotice">Legal Notice</h2><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2024 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></body></section><!----></div></article><aside id="layout" class="span-xs-12 span-sm-2 span-md-2 content-format-selectors" aria-label="Select page format" data-v-8589d091><div class="sticky-top page-layout-options" data-v-8589d091><label for="page-format" data-v-8589d091>Format</label><select id="page-format" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div><!----></aside></div><div class="btn-container hidden" data-v-8589d091><pf-button class="top-scroll-btn" icon="angle-up" icon-set="fas" icon-position="right" data-v-8589d091>Back to top</pf-button></div><!--]--><!--]--></main><rh-footer data-analytics-region="page-footer" data-v-97dd2752><a slot="logo" href="/en" data-analytics-category="Footer" data-analytics-text="Logo" data-v-97dd2752><img alt="Red Hat logo" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" loading="lazy" width="222" height="40" data-v-97dd2752></a><rh-footer-social-link slot="social-links" icon="github" data-v-97dd2752><a href="https://github.com/redhat-documentation" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="LinkedIn" data-v-97dd2752>Github</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="reddit" data-v-97dd2752><a href="https://www.reddit.com/r/redhat/" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="YouTube" data-v-97dd2752>Reddit</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="youtube" data-v-97dd2752><a href="https://www.youtube.com/@redhat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Facebook" data-v-97dd2752>Youtube</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="twitter" data-v-97dd2752><a href="https://twitter.com/RedHat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Twitter" data-v-97dd2752>Twitter</a></rh-footer-social-link><h3 slot="links" data-analytics-text="Learn" data-v-97dd2752>Learn</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://developers.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Developer resources" data-v-97dd2752>Developer resources</a></li><li data-v-97dd2752><a href="https://cloud.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Cloud learning hub" data-v-97dd2752>Cloud learning hub</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="Footer|Learn" data-analytics-text="Interactive labs" data-v-97dd2752>Interactive labs</a></li><li data-v-97dd2752><a href="https://www.redhat.com/services/training-and-certification" data-analytics-category="Footer|Learn" data-analytics-text="Training and certification" data-v-97dd2752>Training and certification</a></li><li data-v-97dd2752><a href="https://access.redhat.com/support" data-analytics-category="Footer|Learn" data-analytics-text="Customer support" data-v-97dd2752>Customer support</a></li><li data-v-97dd2752><a href="/products" data-analytics-category="Footer|Learn" data-analytics-text="See all documentation" data-v-97dd2752>See all documentation</a></li></ul><h3 slot="links" data-analytics-text="Try buy sell" data-v-97dd2752>Try, buy, &amp; sell</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/products/trials" data-analytics-category="Footer|Try buy sell" data-analytics-text="Product trial center" data-v-97dd2752>Product trial center</a></li><li data-v-97dd2752><a href="https://marketplace.redhat.com" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Marketplace" data-v-97dd2752>Red Hat Marketplace</a></li><li data-v-97dd2752><a href="https://catalog.redhat.com/" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Ecosystem Catalog" data-v-97dd2752>Red Hat Ecosystem Catalog</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/store" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Store" data-v-97dd2752>Red Hat Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/japan-buy" data-analytics-category="Footer|Try buy sell" data-analytics-text="Buy online (Japan)" data-v-97dd2752>Buy online (Japan)</a></li></ul><h3 slot="links" data-analytics-text="Communities" data-v-97dd2752>Communities</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://access.redhat.com/community" data-analytics-category="Footer|Communities" data-analytics-text="Customer Portal Community" data-v-97dd2752>Customer Portal Community</a></li><li data-v-97dd2752><a href="https://www.redhat.com/events" data-analytics-category="Footer|Communities" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/our-community-contributions" data-analytics-category="Footer|Communities" data-analytics-text="How we contribute" data-v-97dd2752>How we contribute</a></li></ul><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat Documentation" data-v-97dd2752>About Red Hat Documentation</h3><p data-v-97dd2752>We help Red Hat users innovate and achieve their goals with our products and services with content they can trust.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="Making open source more inclusive" data-v-97dd2752>Making open source more inclusive</h3><p data-v-97dd2752>Red Hat is committed to replacing problematic language in our code, documentation, and web properties. For more details, see the <a href=" https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language" data-analytics-category="Footer|Making open source more inclusive" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a>.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</h3><p data-v-97dd2752>We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.</p></rh-footer-block><rh-footer-universal slot="universal" data-v-97dd2752><h3 slot="links-primary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-primary" data-analytics-region="page-footer-bottom-primary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/company" data-analytics-category="Footer|Corporate" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/jobs" data-analytics-category="Footer|Corporate" data-analytics-text="Jobs" data-v-97dd2752>Jobs</a></li><li data-v-97dd2752><a href="https://redhat.com/en/events" data-analytics-category="Footer|Corporate" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/office-locations" data-analytics-category="Footer|Corporate" data-analytics-text="Locations" data-v-97dd2752>Locations</a></li><li data-v-97dd2752><a href="https://redhat.com/en/contact" data-analytics-category="Footer|Corporate" data-analytics-text="Contact Red Hat" data-v-97dd2752>Contact Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/blog" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/our-culture/diversity-equity-inclusion" data-analytics-category="Footer|Corporate" data-analytics-text="Diversity equity and inclusion" data-v-97dd2752>Diversity, equity, and inclusion</a></li><li data-v-97dd2752><a href="https://coolstuff.redhat.com/" data-analytics-category="Footer|Corporate" data-analytics-text="Cool Stuff Store" data-v-97dd2752>Cool Stuff Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/summit" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Summit" data-v-97dd2752>Red Hat Summit</a></li></ul><span data-v-97dd2752 data-v-5f538988></span><rh-footer-copyright slot="links-secondary" data-v-97dd2752>© 2024 Red Hat, Inc.</rh-footer-copyright><h3 slot="links-secondary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-secondary" data-analytics-region="page-footer-bottom-secondary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/privacy-policy" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Privacy statement" data-v-97dd2752>Privacy statement</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/terms-use" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Terms of use" data-v-97dd2752>Terms of use</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/all-policies-guidelines" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="All policies and guidelines" data-v-97dd2752>All policies and guidelines</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/digital-accessibility" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Digital accessibility" class="active" data-v-97dd2752>Digital accessibility</a></li><li data-v-97dd2752><span id="teconsent" data-v-97dd2752></span></li></ul></rh-footer-universal></rh-footer><div id="consent_blackbar" style="position:fixed;bottom:0;width:100%;z-index:5;padding:10px;"></div><!--]--><!--]--></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["ShallowReactive",1],{"data":2,"state":894,"once":898,"_errors":899,"serverRendered":15,"path":901},["ShallowReactive",3],{"s8LoCEfG4A":4,"uUstF4AIyn":10,"Pn02PlJOas":822,"rFVLKcOK8e":893},[5,6,7,8,9],"fr-fr","en-us","zh-cn","ko-kr","ja-jp",{"name":11,"html":12,"type":-1,"toc":13,"breadcrumbs":738,"error":18,"title":746,"productName":740,"productVersions":755,"pagination":784,"redirect":803,"canonicalLinks":804,"openShiftProducts":806,"tocFromVolume":-1,"jumpLinks":821},"Security hardening","\u003Cbody>\u003Cdiv xml:lang=\"en-US\" class=\"book\" id=\"idm140081374029808\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv class=\"producttitle\">\u003Cspan class=\"productname\">Red Hat Enterprise Linux\u003C/span> \u003Cspan class=\"productnumber\">9\u003C/span>\u003C/div>\u003Cdiv>\u003Ch3 class=\"subtitle\">Enhancing security of Red Hat Enterprise Linux 9 systems\u003C/h3>\u003C/div>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"authorgroup\">\u003Cspan class=\"orgname\">Red Hat\u003C/span> \u003Cspan class=\"orgdiv\">Customer Content Services\u003C/span>\u003C/div>\u003C/div>\u003Cdiv>\u003Ca href=\"#idm140081355003760\">Legal Notice\u003C/a>\u003C/div>\u003Cdiv>\u003Cdiv class=\"abstract\">\u003Cp class=\"title\">\u003Cstrong>Abstract\u003C/strong>\u003C/p>\u003Cdiv class=\"para\">\n\t\t\t\tLearn the processes and practices for securing Red Hat Enterprise Linux servers and workstations against local and remote intrusion, exploitation, and malicious activity. By using these approaches and tools, you can create a more secure computing environment for the data center, workplace, and home.\n\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003Chr/>\u003C/div>\u003Csection class=\"preface\" id=\"proc_providing-feedback-on-red-hat-documentation_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Providing feedback on Red Hat documentation\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWe appreciate your feedback on our documentation. Let us know how we can improve it.\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Submitting feedback through Jira (account required)\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLog in to the \u003Ca class=\"link\" href=\"https://issues.redhat.com/projects/RHELDOCS/issues\">Jira\u003C/a> website.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> in the top navigation bar\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter a descriptive title in the \u003Cspan class=\"strong strong\">\u003Cstrong>Summary\u003C/strong>\u003C/span> field.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter your suggestion for improvement in the \u003Cspan class=\"strong strong\">\u003Cstrong>Description\u003C/strong>\u003C/span> field. Include links to the relevant parts of the documentation.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> at the bottom of the dialogue.\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_securing-rhel-during-installation-security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 1. Securing RHEL during and right after installation\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tSecurity begins even before you start the installation of Red Hat Enterprise Linux. Configuring your system securely from the beginning makes it easier to implement additional security settings later.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"Disk_partitioning_securing-rhel-during-installation\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.1. Disk partitioning\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe recommended practices for disk partitioning differ for installations on bare-metal machines and for virtualized or cloud environments that support adjusting virtual disk hardware and file systems containing already-installed operating systems.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo ensure separation and protection of data on \u003Cspan class=\"strong strong\">\u003Cstrong>bare-metal installations\u003C/strong>\u003C/span>, create separate partitions for the \u003Ccode class=\"literal\">/boot\u003C/code>, \u003Ccode class=\"literal\">/\u003C/code>, \u003Ccode class=\"literal\">/home\u003C/code>, \u003Ccode class=\"literal\">/tmp\u003C/code>, and \u003Ccode class=\"literal\">/var/tmp/\u003C/code> directories:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">/boot\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThis partition is the first partition that is read by the system during boot up. The boot loader and kernel images that are used to boot your system into Red Hat Enterprise Linux 9 are stored in this partition. This partition should not be encrypted. If this partition is included in \u003Ccode class=\"literal\">/\u003C/code> and that partition is encrypted or otherwise becomes unavailable then your system is not able to boot.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">/home\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tWhen user data (\u003Ccode class=\"literal\">/home\u003C/code>) is stored in \u003Ccode class=\"literal\">/\u003C/code> instead of in a separate partition, the partition can fill up causing the operating system to become unstable. Also, when upgrading your system to the next version of Red Hat Enterprise Linux 9 it is a lot easier when you can keep your data in the \u003Ccode class=\"literal\">/home\u003C/code> partition as it is not be overwritten during installation. If the root partition (\u003Ccode class=\"literal\">/\u003C/code>) becomes corrupt your data could be lost forever. By using a separate partition there is slightly more protection against data loss. You can also target this partition for frequent backups.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">/tmp\u003C/code> and \u003Ccode class=\"literal\">/var/tmp/\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tBoth the \u003Ccode class=\"literal\">/tmp\u003C/code> and \u003Ccode class=\"literal\">/var/tmp/\u003C/code> directories are used to store data that does not need to be stored for a long period of time. However, if a lot of data floods one of these directories it can consume all of your storage space. If this happens and these directories are stored within \u003Ccode class=\"literal\">/\u003C/code> then your system could become unstable and crash. For this reason, moving these directories into their own partitions is a good idea.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tFor \u003Cspan class=\"strong strong\">\u003Cstrong>virtual machines or cloud instances\u003C/strong>\u003C/span>, the separate \u003Ccode class=\"literal\">/boot\u003C/code>, \u003Ccode class=\"literal\">/home\u003C/code>, \u003Ccode class=\"literal\">/tmp\u003C/code>, and \u003Ccode class=\"literal\">/var/tmp\u003C/code> partitions are optional because you can increase the virtual disk size and the \u003Ccode class=\"literal\">/\u003C/code> partition if it begins to fill up. Set up monitoring to regularly check the \u003Ccode class=\"literal\">/\u003C/code> partition usage so that it does not fill up before you increase the virtual disk size accordingly.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDuring the installation process, you have an option to encrypt partitions. You must supply a passphrase. This passphrase serves as a key to unlock the bulk encryption key, which is used to secure the partition’s data.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"Restricting_network_during_installation_securing-rhel-during-installation\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.2. Restricting network connectivity during the installation process\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWhen installing Red Hat Enterprise Linux 9, the installation medium represents a snapshot of the system at a particular time. Because of this, it may not be up-to-date with the latest security fixes and may be vulnerable to certain issues that were fixed only after the system provided by the installation medium was released.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWhen installing a potentially vulnerable operating system, always limit exposure only to the closest necessary network zone. The safest choice is the “no network” zone, which means to leave your machine disconnected during the installation process. In some cases, a LAN or intranet connection is sufficient while the Internet connection is the riskiest. To follow the best security practices, choose the closest zone with your repository while installing Red Hat Enterprise Linux 9 from a network.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"Minimal_install_securing-rhel-during-installation\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.3. Installing the minimum amount of packages required\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIt is best practice to install only the packages you will use because each piece of software on your computer could possibly contain a vulnerability. If you are installing from the DVD media, take the opportunity to select exactly what packages you want to install during the installation. If you find you need another package, you can always add it to the system later.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"Post-installation_procedures_securing-rhel-during-installation\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.4. Post-installation procedures\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following steps are the security-related procedures that should be performed immediately after installation of Red Hat Enterprise Linux 9.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUpdate your system. Enter the following command as root:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf update\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEven though the firewall service, \u003Ccode class=\"literal\">firewalld\u003C/code>, is automatically enabled with the installation of Red Hat Enterprise Linux, it might be explicitly disabled, for example, in the Kickstart configuration. In such a case, re-enable the firewall.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo start \u003Ccode class=\"literal\">firewalld\u003C/code> enter the following commands as root:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start firewalld\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable firewalld\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo enhance security, disable services you do not need. For example, if no printers are installed on your computer, disable the \u003Ccode class=\"literal command\">cups\u003C/code> service by using the following command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl disable cups\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo review active services, enter the following command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl list-units | grep service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"disabling-simultaneous-multithreading-to-prevent-cpu-security-issues_configuring-system-settings-in-the-web-console\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.5. Disabling SMT to prevent CPU security issues by using the web console\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tDisable Simultaneous Multi Threading (SMT) in case of attacks that misuse CPU SMT. Disabling SMT can mitigate security vulnerabilities, such as L1TF or MDS.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDisabling SMT might lower the system performance.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have installed the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor instructions, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console\">Installing and enabling the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console\">Logging in to the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Overview\u003C/strong>\u003C/span> tab find the \u003Cspan class=\"strong strong\">\u003Cstrong>System information\u003C/strong>\u003C/span> field and click \u003Cspan class=\"strong strong\">\u003Cstrong>View hardware details\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the \u003Cspan class=\"strong strong\">\u003Cstrong>CPU Security\u003C/strong>\u003C/span> line, click \u003Cspan class=\"strong strong\">\u003Cstrong>Mitigations\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf this link is not present, it means that your system does not support SMT, and therefore is not vulnerable.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>CPU Security Toggles\u003C/strong>\u003C/span> table, turn on the \u003Cspan class=\"strong strong\">\u003Cstrong>Disable simultaneous multithreading (nosmt)\u003C/strong>\u003C/span> option.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the \u003Cspan class=\"guibutton\">Save and reboot\u003C/span> button.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tAfter the system restart, the CPU no longer uses SMT.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/security/vulnerabilities/L1TF\">L1TF - L1 Terminal Fault Attack - CVE-2018-3620 &amp; CVE-2018-3646\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/security/vulnerabilities/mds\">MDS - Microarchitectural Data Sampling - CVE-2018-12130, CVE-2018-12126, CVE-2018-12127, and CVE-2019-11091\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"switching-rhel-to-fips-mode_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 2. Switching RHEL to FIPS mode\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp id=\"assembly_installing-the-system-in-fips-mode_security-hardening\">\n\t\t\tTo enable the cryptographic module self-checks mandated by the Federal Information Processing Standard (FIPS) 140-3, you must operate RHEL 9 in FIPS mode. Starting the installation in FIPS mode is the recommended method if you aim for FIPS compliance.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tThe cryptographic modules of RHEL 9 are not yet certified for the FIPS 140-3 requirements.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"federal-information-processing-standards-140-and-fips-mode_switching-rhel-to-fips-mode\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.1. Federal Information Processing Standards 140 and FIPS mode\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Federal Information Processing Standards (FIPS) Publication 140 is a series of computer security standards developed by the National Institute of Standards and Technology (NIST) to ensure the quality of cryptographic modules. The FIPS 140 standard ensures that cryptographic tools implement their algorithms correctly. Runtime cryptographic algorithm and integrity self-tests are some of the mechanisms to ensure a system uses cryptography that meets the requirements of the standard.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo ensure that your RHEL system generates and uses all cryptographic keys only with FIPS-approved algorithms, you must switch RHEL to FIPS mode.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can enable FIPS mode by using one of the following methods:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tStarting the installation in FIPS mode\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSwitching the system into FIPS mode after the installation\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIf you aim for FIPS compliance, start the installation in FIPS mode. This avoids cryptographic key material regeneration and reevaluation of the compliance of the resulting system associated with converting already deployed systems.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo operate a FIPS-compliant system, create all cryptographic key material in FIPS mode. Furthermore, the cryptographic key material must never leave the FIPS environment unless it is securely wrapped and never unwrapped in non-FIPS environments.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSwitching the system to FIPS mode by using the \u003Ccode class=\"literal\">fips-mode-setup\u003C/code> tool does not guarantee compliance with the FIPS 140 standard. Re-generating all cryptographic keys after setting the system to FIPS mode may not be possible. For example, in the case of an existing IdM realm with users' cryptographic keys you cannot re-generate all the keys. If you cannot start the installation in FIPS mode, always enable FIPS mode as the first step after the installation, before you make any post-installation configuration steps or install any workloads.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">fips-mode-setup\u003C/code> tool also uses the \u003Ccode class=\"literal\">FIPS\u003C/code> system-wide cryptographic policy internally. But on top of what the \u003Ccode class=\"literal\">update-crypto-policies --set FIPS\u003C/code> command does, \u003Ccode class=\"literal\">fips-mode-setup\u003C/code> ensures the installation of the FIPS dracut module by using the \u003Ccode class=\"literal\">fips-finish-install\u003C/code> tool, it also adds the \u003Ccode class=\"literal\">fips=1\u003C/code> boot option to the kernel command line and regenerates the initial RAM disk.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFurthermore, enforcement of restrictions required in FIPS mode depends on the contents of the \u003Ccode class=\"literal\">/proc/sys/crypto/fips_enabled\u003C/code> file. If the file contains \u003Ccode class=\"literal\">1\u003C/code>, RHEL core cryptographic components switch to mode, in which they use only FIPS-approved implementations of cryptographic algorithms. If \u003Ccode class=\"literal\">/proc/sys/crypto/fips_enabled\u003C/code> contains \u003Ccode class=\"literal\">0\u003C/code>, the cryptographic components do not enable their FIPS mode.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">FIPS\u003C/code> system-wide cryptographic policy helps to configure higher-level restrictions. Therefore, communication protocols supporting cryptographic agility do not announce ciphers that the system refuses when selected. For example, the ChaCha20 algorithm is not FIPS-approved, and the \u003Ccode class=\"literal\">FIPS\u003C/code> cryptographic policy ensures that TLS servers and clients do not announce the TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 TLS cipher suite, because any attempt to use such a cipher fails.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you operate RHEL in FIPS mode and use an application providing its own FIPS-mode-related configuration options, ignore these options and the corresponding application guidance. The system running in FIPS mode and the system-wide cryptographic policies enforce only FIPS-compliant cryptography. For example, the Node.js configuration option \u003Ccode class=\"literal\">--enable-fips\u003C/code> is ignored if the system runs in FIPS mode. If you use the \u003Ccode class=\"literal\">--enable-fips\u003C/code> option on a system not running in FIPS mode, you do not meet the FIPS-140 compliance requirements.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe cryptographic modules of RHEL 9 are not yet certified for the FIPS 140-3 requirements by the National Institute of Standards and Technology (NIST) Cryptographic Module Validation Program (CMVP). You can see the validation status of cryptographic modules \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2918071#fips-140-2-and-fips-140-3-2\">FIPS 140-2 and FIPS 140-3\u003C/a> section in the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2918071\">Compliance Activities and Government Standards\u003C/a> Knowledgebase article.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tA RHEL 9.2 and later system running in FIPS mode enforces that any TLS 1.2 connection must use the Extended Master Secret (EMS) extension (RFC 7627) as requires the FIPS 140-3 standard. Thus, legacy clients not supporting EMS or TLS 1.3 cannot connect to RHEL 9 servers running in FIPS mode, RHEL 9 clients in FIPS mode cannot connect to servers that support only TLS 1.2 without EMS. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS Extension \"Extended Master Secret\" enforced with Red Hat Enterprise Linux 9.2\u003C/a> solution article.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2918071#fips-140-2-and-fips-140-3-2\">FIPS 140-2 and FIPS 140-3\u003C/a> section in the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2918071\">Compliance Activities and Government Standards\u003C/a> Knowledgebase article.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-the-system-wide-cryptographic-policies_security-hardening\" title=\"Chapter 3. Using system-wide cryptographic policies\">RHEL system-wide cryptographic policies\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://csrc.nist.gov/publications/fips\">FIPS publications at NIST Computer Security Resource Center\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://doi.org/10.6028/NIST.FIPS.140-3\">Federal Information Processing Standards Publication: FIPS 140-3\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_installing-the-system-with-fips-mode-enabled_switching-rhel-to-fips-mode\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.2. Installing the system with FIPS mode enabled\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp id=\"proc_installing-the-system-with-fips-mode-enabled_assembly_installing-the-system-in-fips-mode\">\n\t\t\t\tTo enable the cryptographic module self-checks mandated by the Federal Information Processing Standard (FIPS) 140, enable FIPS mode during the system installation.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tOnly enabling FIPS mode during the RHEL installation ensures that the system generates all keys with FIPS-approved algorithms and continuous monitoring tests in place.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tAfter you complete the setup of FIPS mode, you cannot switch off FIPS mode without putting the system into an inconsistent state. If your scenario requires this change, the only correct way is a complete re-installation of the system.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">fips=1\u003C/code> option to the kernel command line during the system installation.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDuring the software selection stage, do not install any third-party software.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAfter the installation, the system starts in FIPS mode automatically.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter the system starts, check that FIPS mode is enabled:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>fips-mode-setup --check\u003C/strong>\u003C/span>\nFIPS mode is enabled.\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/boot_options_for_rhel_installer/kickstart-and-advanced-boot-options_boot-options-for-rhel-installer#proc_editing-the-boot-prompt-in-bios_assembly_editing-boot-options\">Editing boot options\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.3. Switching the system to FIPS mode\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe system-wide cryptographic policies contain a policy level that enables cryptographic algorithms in accordance with the requirements by the Federal Information Processing Standard (FIPS) Publication 140. The \u003Ccode class=\"literal\">fips-mode-setup\u003C/code> tool that enables or disables FIPS mode internally uses the \u003Ccode class=\"literal\">FIPS\u003C/code> system-wide cryptographic policy.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSwitching the system to FIPS mode by using the \u003Ccode class=\"literal\">FIPS\u003C/code> system-wide cryptographic policy does not guarantee compliance with the FIPS 140 standard. Re-generating all cryptographic keys after setting the system to FIPS mode may not be possible. For example, in the case of an existing IdM realm with users' cryptographic keys you cannot re-generate all the keys.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tOnly enabling \u003Ca class=\"link\" href=\"#proc_installing-the-system-with-fips-mode-enabled_assembly_installing-the-system-in-fips-mode\">FIPS mode during the RHEL installation\u003C/a> ensures that the system generates all keys with FIPS-approved algorithms and continuous monitoring tests in place.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">fips-mode-setup\u003C/code> tool uses the \u003Ccode class=\"literal\">FIPS\u003C/code> policy internally. But on top of what the \u003Ccode class=\"literal\">update-crypto-policies\u003C/code> command with the \u003Ccode class=\"literal\">--set FIPS\u003C/code> option does, \u003Ccode class=\"literal\">fips-mode-setup\u003C/code> ensures the installation of the FIPS dracut module by using the \u003Ccode class=\"literal\">fips-finish-install\u003C/code> tool, it also adds the \u003Ccode class=\"literal\">fips=1\u003C/code> boot option to the kernel command line and regenerates the initial RAM disk.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tAfter you complete the setup of FIPS mode, you cannot switch off FIPS mode without putting the system into an inconsistent state. If your scenario requires this change, the only correct way is a complete re-installation of the system.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe cryptographic modules of RHEL 9 are not yet certified for the FIPS 140-3 requirements.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo switch the system to FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fips-mode-setup --enable\u003C/strong>\u003C/span>\nKernel initramdisks are being regenerated. This might take some time.\nSetting system policy to FIPS\nNote: System-wide crypto policies are applied on application start-up.\nIt is recommended to restart the system for the change of policies\nto fully take place.\nFIPS mode will be enabled.\nPlease reboot the system for the setting to take effect.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart your system to allow the kernel to switch to FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter the restart, you can check the current state of FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fips-mode-setup --check\u003C/strong>\u003C/span>\nFIPS mode is enabled.\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fips-mode-setup(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://csrc.nist.gov/publications/detail/fips/140/3/final\">Security Requirements for Cryptographic Modules\u003C/a> on the National Institute of Standards and Technology (NIST) web site.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"enabling-fips-mode-in-a-container_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.4. Enabling FIPS mode in a container\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo enable the full set of cryptographic module self-checks mandated by the Federal Information Processing Standard Publication 140-2 (FIPS mode), the host system kernel must be running in FIPS mode. The \u003Ccode class=\"literal\">podman\u003C/code> utility automatically enables FIPS mode on supported containers.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">fips-mode-setup\u003C/code> command does not work correctly in containers, and it cannot be used to enable or check FIPS mode in this scenario.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe cryptographic modules of RHEL 9 are not yet certified for the FIPS 140-3 requirements.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host system must be in FIPS mode.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn systems with FIPS mode enabled, the \u003Ccode class=\"literal\">podman\u003C/code> utility automatically enables FIPS mode on supported containers.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies\" title=\"2.3. Switching the system to FIPS mode\">Switching the system to FIPS mode\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_installing-the-system-with-fips-mode-enabled_assembly_installing-the-system-in-fips-mode\">Installing the system in FIPS mode\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_list-of-rhel-applications-using-cryptography-that-is-not-compliant-with-fips-140-3_switching-rhel-to-fips-mode\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.5. List of RHEL applications using cryptography that is not compliant with FIPS 140-3\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo pass all relevant cryptographic certifications, such as FIPS 140-3, use libraries from the core cryptographic components set. These libraries, except from \u003Ccode class=\"literal\">libgcrypt\u003C/code>, also follow the RHEL system-wide cryptographic policies.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSee the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/3655361\">RHEL core cryptographic components\u003C/a> article for an overview of the core cryptographic components, the information on how are they selected, how are they integrated into the operating system, how do they support hardware security modules and smart cards, and how do cryptographic certifications apply to them.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cp class=\"title\">\u003Cstrong>List of RHEL 9 applications using cryptography that is not compliant with FIPS 140-3\u003C/strong>\u003C/p>\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Bacula\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tImplements the CRAM-MD5 authentication protocol.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Cyrus SASL\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tUses the SCRAM-SHA-1 authentication method.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Dovecot\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tUses SCRAM-SHA-1.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Emacs\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tUses SCRAM-SHA-1.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">FreeRADIUS\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tUses MD5 and SHA-1 for authentication protocols.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Ghostscript\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tCustom cryptography implementation (MD5, RC4, SHA-2, AES) to encrypt and decrypt documents.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">GRUB2\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSupports legacy firmware protocols requiring SHA-1 and includes the \u003Ccode class=\"literal\">libgcrypt\u003C/code> library.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">iPXE\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tImplements TLS stack.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Kerberos\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tPreserves support for SHA-1 (interoperability with Windows).\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Lasso\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">lasso_wsse_username_token_derive_key()\u003C/code> key derivation function (KDF) uses SHA-1.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">MariaDB, MariaDB Connector\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">mysql_native_password\u003C/code> authentication plugin uses SHA-1.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">MySQL\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">mysql_native_password\u003C/code> uses SHA-1.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">OpenIPMI\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe RAKP-HMAC-MD5 authentication method is not approved for FIPS usage and does not work in FIPS mode.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Ovmf (UEFI firmware), Edk2, shim\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tFull cryptographic stack (an embedded copy of the OpenSSL library).\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Perl\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tUses HMAC, HMAC-SHA1, HMAC-MD5, SHA-1, SHA-224,….\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Pidgin\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tImplements DES and RC4 ciphers.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">PKCS #12 file processing (OpenSSL, GnuTLS, NSS, Firefox, Java)\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAll uses of PKCS #12 are not FIPS-compliant, because the Key Derivation Function (KDF) used for calculating the whole-file HMAC is not FIPS-approved. As such, PKCS #12 files are considered to be plain text for the purposes of FIPS compliance. For key-transport purposes, wrap PKCS #12 (.p12) files using a FIPS-approved encryption scheme.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Poppler\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tCan save PDFs with signatures, passwords, and encryption based on non-allowed algorithms if they are present in the original PDF (for example MD5, RC4, and SHA-1).\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">PostgreSQL\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tImplements Blowfish, DES, and MD5. A KDF uses SHA-1.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">QAT Engine\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tMixed hardware and software implementation of cryptographic primitives (RSA, EC, DH, AES,…)\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Ruby\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tProvides insecure MD5 and SHA-1 library functions.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Samba\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tPreserves support for RC4 and DES (interoperability with Windows).\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Syslinux\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tBIOS passwords use SHA-1.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">SWTPM\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tExplicitly disables FIPS mode in its OpenSSL usage.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Unbound\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDNS specification requires that DNSSEC resolvers use a SHA-1-based algorithm in DNSKEY records for validation.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Valgrind\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAES, SHA hashes.\u003Ca href=\"#ftn.idm140081378418480\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"idm140081378418480\">[1]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">zip\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tCustom cryptography implementation (insecure PKWARE encryption algorithm) to encrypt and decrypt archives using a password.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2918071#fips-140-2-and-fips-140-3-2\">FIPS 140-2 and FIPS 140-3\u003C/a> section in the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2918071\">Compliance Activities and Government Standards\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/3655361\">RHEL core cryptographic components\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"footnotes\">\u003Cbr/>\u003Chr width=\"100\" align=\"left\"/>\u003Cdiv id=\"ftn.idm140081378418480\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#idm140081378418480\" class=\"simpara\">\u003Csup class=\"simpara\">[1] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\tRe-implements in software hardware-offload operations, such as AES-NI or SHA-1 and SHA-2 on ARM.\n\t\t\t\t\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-the-system-wide-cryptographic-policies_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 3. Using system-wide cryptographic policies\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThe system-wide cryptographic policies is a system component that configures the core cryptographic subsystems, covering the TLS, IPsec, SSH, DNSSec, and Kerberos protocols. It provides a small set of policies, which the administrator can select.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"system-wide-crypto-policies_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.1. System-wide cryptographic policies\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen a system-wide policy is set up, applications in RHEL follow it and refuse to use algorithms and protocols that do not meet the policy, unless you explicitly request the application to do so. That is, the policy applies to the default behavior of applications when running with the system-provided configuration but you can override it if required.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tRHEL 9 contains the following predefined policies:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">DEFAULT\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe default system-wide cryptographic policy level offers secure settings for current threat models. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 2048 bits long.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">LEGACY\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tEnsures maximum compatibility with Red Hat Enterprise Linux 6 and earlier; it is less secure due to an increased attack surface. SHA-1 is allowed to be used as TLS hash, signature, and algorithm. CBC-mode ciphers are allowed to be used with SSH. Applications using GnuTLS allow certificates signed with SHA-1. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 2048 bits long.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">FUTURE\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tA stricter forward-looking security level intended for testing a possible future policy. This policy does not allow the use of SHA-1 in DNSSec or as an HMAC. SHA2-224 and SHA3-224 hashes are rejected. 128-bit ciphers are disabled. CBC-mode ciphers are disabled except in Kerberos. It allows the TLS 1.2 and 1.3 protocols, as well as the IKEv2 and SSH2 protocols. The RSA keys and Diffie-Hellman parameters are accepted if they are at least 3072 bits long. If your system communicates on the public internet, you might face interoperability problems.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tBecause a cryptographic key used by a certificate on the Customer Portal API does not meet the requirements by the \u003Ccode class=\"literal\">FUTURE\u003C/code> system-wide cryptographic policy, the \u003Ccode class=\"literal\">redhat-support-tool\u003C/code> utility does not work with this policy level at the moment.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\tTo work around this problem, use the \u003Ccode class=\"literal\">DEFAULT\u003C/code> cryptographic policy while connecting to the Customer Portal API.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">FIPS\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tConforms with the FIPS 140 requirements. The \u003Ccode class=\"literal\">fips-mode-setup\u003C/code> tool, which switches the RHEL system into FIPS mode, uses this policy internally. Switching to the \u003Ccode class=\"literal\">FIPS\u003C/code> policy does not guarantee compliance with the FIPS 140 standard. You also must re-generate all cryptographic keys after you set the system to FIPS mode. This is not possible in many scenarios.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRHEL also provides the \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> system-wide subpolicy, which contains further restrictions for cryptographic algorithms required by the Common Criteria (CC) certification. The system becomes less interoperable after you set this subpolicy. For example, you cannot use RSA and DH keys shorter than 3072 bits, additional SSH algorithms, and several TLS groups. Setting \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> also prevents connecting to Red Hat Content Delivery Network (CDN) structure. Furthermore, you cannot integrate Active Directory (AD) into the IdM deployments that use \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code>, communication between RHEL hosts using \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> and AD domains might not work, or some AD accounts might not be able to authenticate.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tYour system is not CC-compliant after you set the \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> cryptographic subpolicy. The only correct way to make your RHEL system compliant with the CC standard is by following the guidance provided in the \u003Ccode class=\"literal\">cc-config\u003C/code> package. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/compliance_activities_and_gov_standards#common-criteria-1\">Common Criteria\u003C/a> section in the Compliance Activities and Government Standards Knowledgebase article for a list of certified RHEL versions, validation reports, and links to CC guides.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tRed Hat continuously adjusts all policy levels so that all libraries provide secure defaults, except when using the \u003Ccode class=\"literal\">LEGACY\u003C/code> policy. Even though the \u003Ccode class=\"literal\">LEGACY\u003C/code> profile does not provide secure defaults, it does not include any algorithms that are easily exploitable. As such, the set of enabled algorithms or acceptable key sizes in any provided policy may change during the lifetime of Red Hat Enterprise Linux.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSuch changes reflect new security standards and new security research. If you must ensure interoperability with a specific system for the whole lifetime of Red Hat Enterprise Linux, you should opt-out from the system-wide cryptographic policies for components that interact with that system or re-enable specific algorithms using custom cryptographic policies.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe specific algorithms and ciphers described as allowed in the policy levels are available only if an application supports them:\n\t\t\t\u003C/p>\u003Crh-table id=\"idm140081372148448\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 3.1. Cipher suites and protocols enabled in the cryptographic policies\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_5\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081373212448\" scope=\"col\"> \u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081373211520\" scope=\"col\">\u003Ccode class=\"literal\">LEGACY\u003C/code>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081366656448\" scope=\"col\">\u003Ccode class=\"literal\">DEFAULT\u003C/code>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081366655200\" scope=\"col\">\u003Ccode class=\"literal\">FIPS\u003C/code>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081366653952\" scope=\"col\">\u003Ccode class=\"literal\">FUTURE\u003C/code>\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>IKEv1\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>3DES\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>RC4\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>DH\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tmin. 2048-bit\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tmin. 2048-bit\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tmin. 2048-bit\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tmin. 3072-bit\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>RSA\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tmin. 2048-bit\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tmin. 2048-bit\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tmin. 2048-bit\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tmin. 3072-bit\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>DSA\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>TLS v1.1 and older\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>TLS v1.2 and newer\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>SHA-1 in digital signatures and certificates\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>CBC mode ciphers\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\u003Ca href=\"#ftn.idm140081375189616\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"idm140081375189616\">[a]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\u003Ca href=\"#ftn.idm140081377495488\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"idm140081377495488\">[b]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\u003Ca href=\"#ftn.idm140081377492992\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"idm140081377492992\">[c]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373212448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Symmetric ciphers with keys &lt; 256 bits\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373211520\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366656448\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366655200\"> \u003Cp>\n\t\t\t\t\t\t\t\tyes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366653952\"> \u003Cp>\n\t\t\t\t\t\t\t\tno\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003Ctbody class=\"footnotes\">\u003Ctr>\u003Ctd colspan=\"5\">\u003Cdiv id=\"ftn.idm140081375189616\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#idm140081375189616\" class=\"simpara\">\u003Csup class=\"simpara\">[a] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\t\tCBC ciphers are disabled for SSH\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/div>\u003Cdiv id=\"ftn.idm140081377495488\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#idm140081377495488\" class=\"simpara\">\u003Csup class=\"simpara\">[b] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\t\tCBC ciphers are disabled for all protocols except Kerberos\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/div>\u003Cdiv id=\"ftn.idm140081377492992\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#idm140081377492992\" class=\"simpara\">\u003Csup class=\"simpara\">[c] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\t\tCBC ciphers are disabled for all protocols except Kerberos\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/div>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">crypto-policies(7)\u003C/code> and \u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"changing-the-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.2. Changing the system-wide cryptographic policy\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can change the system-wide cryptographic policy on your system by using the \u003Ccode class=\"literal\">update-crypto-policies\u003C/code> tool and restarting your system.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root privileges on the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Display the current cryptographic policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --show\u003C/strong>\u003C/span>\nDEFAULT\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet the new cryptographic policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --set \u003Cspan class=\"emphasis\">\u003Cem>&lt;POLICY&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\u003Cspan class=\"emphasis\">\u003Cem>&lt;POLICY&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;POLICY&gt;\u003C/em>\u003C/span>\u003C/code> with the policy or subpolicy you want to set, for example \u003Ccode class=\"literal\">FUTURE\u003C/code>, \u003Ccode class=\"literal\">LEGACY\u003C/code> or \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the current cryptographic policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --show\u003C/strong>\u003C/span>\n\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;POLICY&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information on system-wide cryptographic policies, see \u003Ca class=\"link\" href=\"#system-wide-crypto-policies_using-the-system-wide-cryptographic-policies\" title=\"3.1. System-wide cryptographic policies\">System-wide cryptographic policies\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"switching-the-system-wide-crypto-policy-to-mode-compatible-with-previous-systems_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.3. Switching the system-wide cryptographic policy to mode compatible with earlier releases\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe default system-wide cryptographic policy in Red Hat Enterprise Linux 9 does not allow communication using older, insecure protocols. For environments that require to be compatible with Red Hat Enterprise Linux 6 and in some cases also with earlier releases, the less secure \u003Ccode class=\"literal\">LEGACY\u003C/code> policy level is available.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tSwitching to the \u003Ccode class=\"literal\">LEGACY\u003C/code> policy level results in a less secure system and applications.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo switch the system-wide cryptographic policy to the \u003Ccode class=\"literal\">LEGACY\u003C/code> level, enter the following command as \u003Ccode class=\"literal\">root\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --set LEGACY\u003C/strong>\u003C/span>\nSetting system policy to LEGACY\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor the list of available cryptographic policy levels, see the \u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor defining custom cryptographic policies, see the \u003Ccode class=\"literal\">Custom Policies\u003C/code> section in the \u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> man page and the \u003Ccode class=\"literal\">Crypto Policy Definition Format\u003C/code> section in the \u003Ccode class=\"literal\">crypto-policies(7)\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_re-enabling-sha-1_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.4. Re-enabling SHA-1\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe use of the SHA-1 algorithm for creating and verifying signatures is restricted in the \u003Ccode class=\"literal\">DEFAULT\u003C/code> cryptographic policy. If your scenario requires the use of SHA-1 for verifying existing or third-party cryptographic signatures, you can enable it by applying the \u003Ccode class=\"literal\">SHA1\u003C/code> subpolicy, which RHEL 9 provides by default. Note that it weakens the security of the system.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system uses the \u003Ccode class=\"literal\">DEFAULT\u003C/code> system-wide cryptographic policy.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tApply the \u003Ccode class=\"literal\">SHA1\u003C/code> subpolicy to the \u003Ccode class=\"literal\">DEFAULT\u003C/code> cryptographic policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --set DEFAULT:SHA1\u003C/strong>\u003C/span>\nSetting system policy to DEFAULT:SHA1\nNote: System-wide crypto policies are applied on application start-up.\nIt is recommended to restart the system for the change of policies\nto fully take place.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the current cryptographic policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --show\u003C/strong>\u003C/span>\nDEFAULT:SHA1\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tSwitching to the \u003Ccode class=\"literal\">LEGACY\u003C/code> cryptographic policy by using the \u003Ccode class=\"literal\">update-crypto-policies --set LEGACY\u003C/code> command also enables SHA-1 for signatures. However, the \u003Ccode class=\"literal\">LEGACY\u003C/code> cryptographic policy makes your system much more vulnerable by also enabling other weak cryptographic algorithms. Use this workaround only for scenarios that require the enablement of other legacy cryptographic algorithms than SHA-1 signatures.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/6816771\">SSH from RHEL 9 to RHEL 6 systems does not work\u003C/a> (Red Hat Knowledgebase)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/6868611\">Packages signed with SHA-1 cannot be installed or upgraded\u003C/a> (Red Hat Knowledgebase)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-up-system-wide-crypto-policies-in-the-web-console_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.5. Setting up system-wide cryptographic policies in the web console\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can set one of system-wide cryptographic policies and subpolicies directly in the RHEL web console interface. Besides the four predefined system-wide cryptographic policies, you can also apply the following combinations of policies and subpolicies through the graphical interface now:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">DEFAULT:SHA1\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">DEFAULT\u003C/code> policy with the \u003Ccode class=\"literal\">SHA-1\u003C/code> algorithm enabled.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">LEGACY:AD-SUPPORT\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">LEGACY\u003C/code> policy with less secure settings that improve interoperability for Active Directory services.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">FIPS:OSPP\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">FIPS\u003C/code> policy with further restrictions required by the Common Criteria for Information Technology Security Evaluation standard.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tBecause the \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> system-wide subpolicy contains further restrictions for cryptographic algorithms required by the Common Criteria (CC) certification, the system is less interoperable after you set it. For example, you cannot use RSA and DH keys shorter than 3072 bits, additional SSH algorithms, and several TLS groups. Setting \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> also prevents connecting to Red Hat Content Delivery Network (CDN) structure. Furthermore, you cannot integrate Active Directory (AD) into the IdM deployments that use \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code>, communication between RHEL hosts using \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> and AD domains might not work, or some AD accounts might not be able to authenticate.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tNote that your \u003Cspan class=\"strong strong\">\u003Cstrong>system is not CC-compliant\u003C/strong>\u003C/span> after you set the \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> cryptographic subpolicy. The only correct way to make your RHEL system compliant with the CC standard is by following the guidance provided in the \u003Ccode class=\"literal\">cc-config\u003C/code> package. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/compliance_activities_and_gov_standards#common-criteria-1\">Common Criteria\u003C/a> section in the Compliance Activities and Government Standards Knowledgebase article for a list of certified RHEL versions, validation reports, and links to CC guides hosted at the \u003Ca class=\"link\" href=\"https://www.niap-ccevs.org/\">National Information Assurance Partnership (NIAP)\u003C/a> website.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have installed the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor instructions, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console\">Installing and enabling the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> privileges or permissions to enter administrative commands with \u003Ccode class=\"literal\">sudo\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console\">Logging in to the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Configuration\u003C/strong>\u003C/span> card of the \u003Cspan class=\"strong strong\">\u003Cstrong>Overview\u003C/strong>\u003C/span> page, click your current policy value next to \u003Cspan class=\"strong strong\">\u003Cstrong>Crypto policy\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/ab541c5145a88c27bb0de37f9df77636/web-console-crypto-policies-overview.png\" alt=\"The web console: Overview\"/>\u003C/span>\n\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Change crypto policy\u003C/strong>\u003C/span> dialog window, click on the policy you want to start using on your system.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/8a53db0d2f25719abcfe2a44cf898235/web-console-crypto-policies-select.png\" alt=\"The web console: Change the system-wide cryptographic policy\"/>\u003C/span>\n\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the \u003Cspan class=\"guibutton\">Apply and reboot\u003C/span> button.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter the restart, log back in to web console, and check that the \u003Cspan class=\"strong strong\">\u003Cstrong>Crypto policy\u003C/strong>\u003C/span> value corresponds to the one you selected.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, you can enter the \u003Ccode class=\"literal\">update-crypto-policies --show\u003C/code> command to display the current system-wide cryptographic policy in your terminal.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.6. Excluding an application from following system-wide crypto policies\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can customize cryptographic settings used by your application preferably by configuring supported cipher suites and protocols directly in the application.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can also remove a symlink related to your application from the \u003Ccode class=\"literal\">/etc/crypto-policies/back-ends\u003C/code> directory and replace it with your customized cryptographic settings. This configuration prevents the use of system-wide cryptographic policies for applications that use the excluded back end. Furthermore, this modification is not supported by Red Hat.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"examples-of-opting-out-of-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">3.6.1. Examples of opting out of system-wide crypto policies\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>wget\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tTo customize cryptographic settings used by the \u003Ccode class=\"literal\">wget\u003C/code> network downloader, use \u003Ccode class=\"literal\">--secure-protocol\u003C/code> and \u003Ccode class=\"literal\">--ciphers\u003C/code> options. For example:\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>wget --secure-protocol=\u003Cspan class=\"emphasis\">\u003Cem>TLSv1_1\u003C/em>\u003C/span> --ciphers=\"\u003Cspan class=\"emphasis\">\u003Cem>SECURE128\u003C/em>\u003C/span>\" \u003Cspan class=\"emphasis\">\u003Cem>https://example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\t\tSee the HTTPS (SSL/TLS) Options section of the \u003Ccode class=\"literal\">wget(1)\u003C/code> man page for more information.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>curl\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tTo specify ciphers used by the \u003Ccode class=\"literal\">curl\u003C/code> tool, use the \u003Ccode class=\"literal\">--ciphers\u003C/code> option and provide a colon-separated list of ciphers as a value. For example:\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>curl \u003Cspan class=\"emphasis\">\u003Cem>https://example.com\u003C/em>\u003C/span> --ciphers \u003Cspan class=\"emphasis\">\u003Cem>'@SECLEVEL=0:DES-CBC3-SHA:RSA-DES-CBC3-SHA'\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\t\tSee the \u003Ccode class=\"literal\">curl(1)\u003C/code> man page for more information.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Firefox\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tEven though you cannot opt out of system-wide cryptographic policies in the \u003Ccode class=\"literal\">Firefox\u003C/code> web browser, you can further restrict supported ciphers and TLS versions in Firefox’s Configuration Editor. Type \u003Ccode class=\"literal\">about:config\u003C/code> in the address bar and change the value of the \u003Ccode class=\"literal\">security.tls.version.min\u003C/code> option as required. Setting \u003Ccode class=\"literal\">security.tls.version.min\u003C/code> to \u003Ccode class=\"literal\">1\u003C/code> allows TLS 1.0 as the minimum required, \u003Ccode class=\"literal\">security.tls.version.min 2\u003C/code> enables TLS 1.1, and so on.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>OpenSSH\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tTo opt out of the system-wide cryptographic policies for your OpenSSH server, specify the cryptographic policy in a drop-in configuration file located in the \u003Ccode class=\"literal\">/etc/ssh/sshd_config.d/\u003C/code> directory, with a two-digit number prefix smaller than 50, so that it lexicographically precedes the \u003Ccode class=\"literal\">50-redhat.conf\u003C/code> file, and with a \u003Ccode class=\"literal\">.conf\u003C/code> suffix, for example, \u003Ccode class=\"literal\">49-crypto-policy-override.conf\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\t\tSee the \u003Ccode class=\"literal\">sshd_config(5)\u003C/code> man page for more information.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tTo opt out of system-wide cryptographic policies for your OpenSSH client, perform one of the following tasks:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFor a given user, override the global \u003Ccode class=\"literal\">ssh_config\u003C/code> with a user-specific configuration in the \u003Ccode class=\"literal\">~/.ssh/config\u003C/code> file.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFor the entire system, specify the cryptographic policy in a drop-in configuration file located in the \u003Ccode class=\"literal\">/etc/ssh/ssh_config.d/\u003C/code> directory, with a two-digit number prefix smaller than 50, so that it lexicographically precedes the \u003Ccode class=\"literal\">50-redhat.conf\u003C/code> file, and with a \u003Ccode class=\"literal\">.conf\u003C/code> suffix, for example, \u003Ccode class=\"literal\">49-crypto-policy-override.conf\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\tSee the \u003Ccode class=\"literal\">ssh_config(5)\u003C/code> man page for more information.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Libreswan\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tSee the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/configuring-a-vpn-with-ipsec_securing-networks#configuring-ipsec-connections-that-opt-out-of-the-system-wide-crypto-policies_configuring-a-vpn-with-ipsec\">Configuring IPsec connections that opt out of the system-wide crypto policies\u003C/a> in the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/\">Securing networks\u003C/a> document for detailed information.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"customizing-system-wide-cryptographic-policies-with-subpolicies_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.7. Customizing system-wide cryptographic policies with subpolicies\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse this procedure to adjust the set of enabled cryptographic algorithms or protocols.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can either apply custom subpolicies on top of an existing system-wide cryptographic policy or define such a policy from scratch.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe concept of scoped policies allows enabling different sets of algorithms for different back ends. You can limit each configuration directive to specific protocols, libraries, or services.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFurthermore, directives can use asterisks for specifying multiple values using wildcards.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">/etc/crypto-policies/state/CURRENT.pol\u003C/code> file lists all settings in the currently applied system-wide cryptographic policy after wildcard expansion. To make your cryptographic policy more strict, consider using values listed in the \u003Ccode class=\"literal\">/usr/share/crypto-policies/policies/FUTURE.pol\u003C/code> file.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can find example subpolicies in the \u003Ccode class=\"literal\">/usr/share/crypto-policies/policies/modules/\u003C/code> directory. The subpolicy files in this directory contain also descriptions in lines that are commented out.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheckout to the \u003Ccode class=\"literal\">/etc/crypto-policies/policies/modules/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cd /etc/crypto-policies/policies/modules/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate subpolicies for your adjustments, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>touch \u003Cspan class=\"emphasis\">\u003Cem>MYCRYPTO-1\u003C/em>\u003C/span>.pmod\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>touch \u003Cspan class=\"emphasis\">\u003Cem>SCOPES-AND-WILDCARDS\u003C/em>\u003C/span>.pmod\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tUse upper-case letters in file names of policy modules.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the policy modules in a text editor of your choice and insert options that modify the system-wide cryptographic policy, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi \u003Cspan class=\"emphasis\">\u003Cem>MYCRYPTO-1\u003C/em>\u003C/span>.pmod\u003C/strong>\u003C/span>\u003C/pre>\u003Cpre class=\"screen\">min_rsa_size = 3072\nhash = SHA2-384 SHA2-512 SHA3-384 SHA3-512\u003C/pre>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi \u003Cspan class=\"emphasis\">\u003Cem>SCOPES-AND-WILDCARDS\u003C/em>\u003C/span>.pmod\u003C/strong>\u003C/span>\u003C/pre>\u003Cpre class=\"screen\"># Disable the AES-128 cipher, all modes\ncipher = -AES-128-*\n\n# Disable CHACHA20-POLY1305 for the TLS protocol (OpenSSL, GnuTLS, NSS, and OpenJDK)\ncipher@TLS = -CHACHA20-POLY1305\n\n# Allow using the FFDHE-1024 group with the SSH protocol (libssh and OpenSSH)\ngroup@SSH = FFDHE-1024+\n\n# Disable all CBC mode ciphers for the SSH protocol (libssh and OpenSSH)\ncipher@SSH = -*-CBC\n\n# Allow the AES-256-CBC cipher in applications using libssh\ncipher@libssh = AES-256-CBC+\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the changes in the module files.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tApply your policy adjustments to the \u003Ccode class=\"literal\">DEFAULT\u003C/code> system-wide cryptographic policy level:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --set DEFAULT:\u003Cspan class=\"emphasis\">\u003Cem>MYCRYPTO-1\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>SCOPES-AND-WILDCARDS\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo make your cryptographic settings effective for already running services and applications, restart the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">/etc/crypto-policies/state/CURRENT.pol\u003C/code> file contains your changes, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/crypto-policies/state/CURRENT.pol | grep rsa_size\u003C/strong>\u003C/span>\nmin_rsa_size = 3072\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Custom Policies\u003C/code> section in the \u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Crypto Policy Definition Format\u003C/code> section in the \u003Ccode class=\"literal\">crypto-policies(7)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/how-customize-crypto-policies-rhel-82\">How to customize crypto policies in RHEL 8.2\u003C/a> Red Hat blog article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.8. Creating and setting a custom system-wide cryptographic policy\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFor specific scenarios, you can customize the system-wide cryptographic policy by creating and using a complete policy file.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a policy file for your customizations:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cd /etc/crypto-policies/policies/\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>touch \u003Cspan class=\"emphasis\">\u003Cem>MYPOLICY\u003C/em>\u003C/span>.pol\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, start by copying one of the four predefined policy levels:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/crypto-policies/policies/\u003Cspan class=\"emphasis\">\u003Cem>DEFAULT\u003C/em>\u003C/span>.pol /etc/crypto-policies/policies/\u003Cspan class=\"emphasis\">\u003Cem>MYPOLICY\u003C/em>\u003C/span>.pol\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the file with your custom cryptographic policy in a text editor of your choice to fit your requirements, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/crypto-policies/policies/\u003Cspan class=\"emphasis\">\u003Cem>MYPOLICY\u003C/em>\u003C/span>.pol\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSwitch the system-wide cryptographic policy to your custom level:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --set \u003Cspan class=\"emphasis\">\u003Cem>MYPOLICY\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo make your cryptographic settings effective for already running services and applications, restart the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Custom Policies\u003C/code> section in the \u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> man page and the \u003Ccode class=\"literal\">Crypto Policy Definition Format\u003C/code> section in the \u003Ccode class=\"literal\">crypto-policies(7)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/how-customize-crypto-policies-rhel-82\">How to customize crypto policies in RHEL\u003C/a> Red Hat blog article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_using-the-system-wide-cryptographic-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.9. Enhancing security with the \u003Ccode class=\"literal\">FUTURE\u003C/code> cryptographic policy using the \u003Ccode class=\"literal\">crypto_policies\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">crypto_policies\u003C/code> RHEL system role to configure the \u003Ccode class=\"literal\">FUTURE\u003C/code> policy on your managed nodes. This policy helps to achieve for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFuture-proofing against emerging threats: anticipates advancements in computational power.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnhanced security: stronger encryption standards require longer key lengths and more secure algorithms.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCompliance with high-security standards: for example in healthcare, telco, and finance the data sensitivity is high, and availability of strong cryptography is critical.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tTypically, \u003Ccode class=\"literal\">FUTURE\u003C/code> is suitable for environments handling highly sensitive data, preparing for future regulations, or adopting long-term security strategies.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tLegacy systems or software does not have to support the more modern and stricter algorithms and protocols enforced by the \u003Ccode class=\"literal\">FUTURE\u003C/code> policy. For example, older systems might not support TLS 1.3 or larger key sizes. This could lead to compatibility problems.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tAlso, using strong algorithms usually increases the computational workload, which could negatively affect your system performance.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure cryptographic policies\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure the FUTURE cryptographic security policy on the managed node\n      ansible.builtin.include_role:\n        name: rhel-system-roles.crypto_policies\n      vars:\n        - crypto_policies_policy: \u003Cspan class=\"emphasis\">\u003Cem>FUTURE\u003C/em>\u003C/span>\n        - crypto_policies_reboot_ok: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">crypto_policies_policy: \u003Cspan class=\"emphasis\">\u003Cem>FUTURE\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tConfigures the required cryptographic policy (\u003Ccode class=\"literal\">FUTURE\u003C/code>) on the managed node. It can be either the base policy or a base policy with some sub-policies. The specified base policy and sub-policies have to be available on the managed node. The default value is \u003Ccode class=\"literal\">null\u003C/code>. It means that the configuration is not changed and the \u003Ccode class=\"literal\">crypto_policies\u003C/code> RHEL system role will only collect the Ansible facts.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">crypto_policies_reboot_ok: \u003Cspan class=\"emphasis\">\u003Cem>true\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tCauses the system to reboot after the cryptographic policy change to make sure all of the services and applications will read the new configuration files. The default value is \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tBecause the \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> system-wide subpolicy contains further restrictions for cryptographic algorithms required by the Common Criteria (CC) certification, the system is less interoperable after you set it. For example, you cannot use RSA and DH keys shorter than 3072 bits, additional SSH algorithms, and several TLS groups. Setting \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> also prevents connecting to Red Hat Content Delivery Network (CDN) structure. Furthermore, you cannot integrate Active Directory (AD) into the IdM deployments that use \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code>, communication between RHEL hosts using \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> and AD domains might not work, or some AD accounts might not be able to authenticate.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tNote that your \u003Cspan class=\"strong strong\">\u003Cstrong>system is not CC-compliant\u003C/strong>\u003C/span> after you set the \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> cryptographic subpolicy. The only correct way to make your RHEL system compliant with the CC standard is by following the guidance provided in the \u003Ccode class=\"literal\">cc-config\u003C/code> package. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/compliance_activities_and_gov_standards#common-criteria-1\">Common Criteria\u003C/a> section in the Compliance Activities and Government Standards Knowledgebase article for a list of certified RHEL versions, validation reports, and links to CC guides hosted at the \u003Ca class=\"link\" href=\"https://www.niap-ccevs.org/\">National Information Assurance Partnership (NIAP)\u003C/a> website.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node, create another playbook named, for example, \u003Ccode class=\"literal\">verify_playbook.yml\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Verification\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Verify active cryptographic policy\n      ansible.builtin.include_role:\n        name: rhel-system-roles.crypto_policies\n    - name: Display the currently active cryptographic policy\n      ansible.builtin.debug:\n        var: crypto_policies_active\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">crypto_policies_active\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tAn exported Ansible fact that contains the currently active policy name in the format as accepted by the \u003Ccode class=\"literal\">crypto_policies_policy\u003C/code> variable.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/verify_playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/verify_playbook.yml\u003C/strong>\u003C/span>\nTASK [debug] **************************\nok: [host] =&gt; {\n    \"crypto_policies_active\": \"FUTURE\"\n}\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">crypto_policies_active\u003C/code> variable shows the active policy on the managed node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/crypto_policies/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> and \u003Ccode class=\"literal\">crypto-policies(7)\u003C/code> manual pages\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 4. Configuring applications to use cryptographic hardware through PKCS #11\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tSeparating parts of your secret information about dedicated cryptographic devices, such as smart cards and cryptographic tokens for end-user authentication and hardware security modules (HSM) for server applications, provides an additional layer of security. In RHEL, support for cryptographic hardware through the PKCS #11 API is consistent across different applications, and the isolation of secrets on cryptographic hardware is not a complicated task.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"cryptographic-hardware-support-through-pkcs-11_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.1. Cryptographic hardware support through PKCS #11\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPublic-Key Cryptography Standard (PKCS) #11 defines an application programming interface (API) to cryptographic devices that hold cryptographic information and perform cryptographic functions.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tPKCS #11 introduces the \u003Cspan class=\"emphasis\">\u003Cem>cryptographic token\u003C/em>\u003C/span>, an object that presents each hardware or software device to applications in a unified manner. Therefore, applications view devices such as smart cards, which are typically used by persons, and hardware security modules, which are typically used by computers, as PKCS #11 cryptographic tokens.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA PKCS #11 token can store various object types including a certificate; a data object; and a public, private, or secret key. These objects are uniquely identifiable through the PKCS #11 Uniform Resource Identifier (URI) scheme.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA PKCS #11 URI is a standard way to identify a specific object in a PKCS #11 module according to the object attributes. This enables you to configure all libraries and applications with the same configuration string in the form of a URI.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tRHEL provides the OpenSC PKCS #11 driver for smart cards by default. However, hardware tokens and HSMs can have their own PKCS #11 modules that do not have their counterpart in the system. You can register such PKCS #11 modules with the \u003Ccode class=\"literal\">p11-kit\u003C/code> tool, which acts as a wrapper over the registered smart-card drivers in the system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo make your own PKCS #11 module work on the system, add a new text file to the \u003Ccode class=\"literal filename\">/etc/pkcs11/modules/\u003C/code> directory\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can add your own PKCS #11 module into the system by creating a new text file in the \u003Ccode class=\"literal filename\">/etc/pkcs11/modules/\u003C/code> directory. For example, the OpenSC configuration file in \u003Ccode class=\"literal\">p11-kit\u003C/code> looks as follows:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat /usr/share/p11-kit/modules/opensc.module\u003C/strong>\u003C/span>\nmodule: opensc-pkcs11.so\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://tools.ietf.org/html/rfc7512\">The PKCS #11 URI Scheme\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/blogs/766093/posts/1976313\">Controlling access to smart cards\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ssh-keys-stored-on-a-smart-card_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.2. Authenticating by SSH keys stored on a smart card\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can create and store ECDSA and RSA keys on a smart card and authenticate by the smart card on an OpenSSH client. Smart-card authentication replaces the default password authentication.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn the client side, the \u003Ccode class=\"literal\">opensc\u003C/code> package is installed and the \u003Ccode class=\"literal\">pcscd\u003C/code> service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList all keys provided by the OpenSC PKCS #11 module including their PKCS #11 URIs and save the output to the \u003Ccode class=\"literal\">keys.pub\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-keygen -D pkcs11: &gt; keys.pub\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTransfer the public key to the remote server. Use the \u003Ccode class=\"literal\">ssh-copy-id\u003C/code> command with the \u003Ccode class=\"literal\">keys.pub\u003C/code> file created in the previous step:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-copy-id -f -i keys.pub \u003Cspan class=\"emphasis\">\u003Cem>&lt;username@ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConnect to \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span> by using the ECDSA key. You can use just a subset of the URI, which uniquely references your key, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -i \"pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so\" \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter PIN for 'SSH key':\n[ssh-server-example.com] $\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause OpenSSH uses the \u003Ccode class=\"literal\">p11-kit-proxy\u003C/code> wrapper and the OpenSC PKCS #11 module is registered to the \u003Ccode class=\"literal\">p11-kit\u003C/code> tool, you can simplify the previous command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -i \"pkcs11:id=%01\" \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter PIN for 'SSH key':\n[ssh-server-example.com] $\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you skip the \u003Ccode class=\"literal\">id=\u003C/code> part of a PKCS #11 URI, OpenSSH loads all keys that are available in the proxy module. This can reduce the amount of typing required:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -i pkcs11: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter PIN for 'SSH key':\n[ssh-server-example.com] $\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: You can use the same URI string in the \u003Ccode class=\"literal\">~/.ssh/config\u003C/code> file to make the configuration permanent:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat ~/.ssh/config\u003C/strong>\u003C/span>\nIdentityFile \"pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so\"\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter PIN for 'SSH key':\n[ssh-server-example.com] $\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ssh\u003C/code> client utility now automatically uses this URI and the key from the smart card.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">p11-kit(8)\u003C/code>, \u003Ccode class=\"literal\">opensc.conf(5)\u003C/code>, \u003Ccode class=\"literal\">pcscd(8)\u003C/code>, \u003Ccode class=\"literal\">ssh(1)\u003C/code>, and \u003Ccode class=\"literal\">ssh-keygen(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-applications-to-authenticate-using-certificates-from-smart-cards_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.3. Configuring applications for authentication with certificates on smart cards\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAuthentication by using smart cards in applications may increase security and simplify automation. You can integrate the Public Key Cryptography Standard (PKCS) #11 URIs into your application by using the following methods:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">Firefox\u003C/code> web browser automatically loads the \u003Ccode class=\"literal\">p11-kit-proxy\u003C/code> PKCS #11 module. This means that every supported smart card in the system is automatically detected. For using TLS client authentication, no additional setup is required and keys and certificates from a smart card are automatically used when a server requests them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf your application uses the \u003Ccode class=\"literal\">GnuTLS\u003C/code> or \u003Ccode class=\"literal\">NSS\u003C/code> library, it already supports PKCS #11 URIs. Also, applications that rely on the \u003Ccode class=\"literal\">OpenSSL\u003C/code> library can access cryptographic hardware modules, including smart cards, through the \u003Ccode class=\"literal\">pkcs11\u003C/code> engine provided by the \u003Ccode class=\"literal\">openssl-pkcs11\u003C/code> package.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tApplications that require working with private keys on smart cards and that do not use \u003Ccode class=\"literal\">NSS\u003C/code>, \u003Ccode class=\"literal\">GnuTLS\u003C/code>, nor \u003Ccode class=\"literal\">OpenSSL\u003C/code> can use the \u003Ccode class=\"literal\">p11-kit\u003C/code> API directly to work with cryptographic hardware modules, including smart cards, rather than using the PKCS #11 API of specific PKCS #11 modules.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWith the the \u003Ccode class=\"literal\">wget\u003C/code> network downloader, you can specify PKCS #11 URIs instead of paths to locally stored private keys and certificates. This might simplify creation of scripts for tasks that require safely stored private keys and certificates. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>wget --private-key 'pkcs11:token=softhsm;id=%01;type=private?pin-value=111111' --certificate 'pkcs11:token=softhsm;id=%01;type=cert' https://example.com/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can also specify PKCS #11 URI when using the \u003Ccode class=\"literal\">curl\u003C/code> tool:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>curl --key 'pkcs11:token=softhsm;id=%01;type=private?pin-value=111111' --cert 'pkcs11:token=softhsm;id=%01;type=cert' https://example.com/\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tBecause a PIN is a security measure that controls access to keys stored on a smart card and the configuration file contains the PIN in the plain-text form, consider additional protection to prevent an attacker from reading the PIN. For example, you can use the \u003Ccode class=\"literal\">pin-source\u003C/code> attribute and provide a \u003Ccode class=\"literal\">file:\u003C/code> URI for reading the PIN from a file. See \u003Ca class=\"link\" href=\"https://datatracker.ietf.org/doc/html/rfc7512#section-2.4\">RFC 7512: PKCS #11 URI Scheme Query Attribute Semantics\u003C/a> for more information. Note that using a command path as a value of the \u003Ccode class=\"literal\">pin-source\u003C/code> attribute is not supported.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">curl(1)\u003C/code>, \u003Ccode class=\"literal\">wget(1)\u003C/code>, and \u003Ccode class=\"literal\">p11-kit(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_using-hsms-protecting-private-keys-in-apache_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.4. Using HSMs protecting private keys in Apache\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">Apache\u003C/code> HTTP server can work with private keys stored on hardware security modules (HSMs), which helps to prevent the keys' disclosure and man-in-the-middle attacks. Note that this usually requires high-performance HSMs for busy servers.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor secure communication in the form of the HTTPS protocol, the \u003Ccode class=\"literal\">Apache\u003C/code> HTTP server (\u003Ccode class=\"literal\">httpd\u003C/code>) uses the OpenSSL library. OpenSSL does not support PKCS #11 natively. To use HSMs, you have to install the \u003Ccode class=\"literal package\">openssl-pkcs11\u003C/code> package, which provides access to PKCS #11 modules through the engine interface. You can use a PKCS #11 URI instead of a regular file name to specify a server key and a certificate in the \u003Ccode class=\"literal\">/etc/httpd/conf.d/ssl.conf\u003C/code> configuration file, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">SSLCertificateFile    \"pkcs11:id=%01;token=softhsm;type=cert\"\nSSLCertificateKeyFile \"pkcs11:id=%01;token=softhsm;type=private?pin-value=111111\"\u003C/pre>\u003Cp>\n\t\t\t\tInstall the \u003Ccode class=\"literal package\">httpd-manual\u003C/code> package to obtain complete documentation for the \u003Ccode class=\"literal\">Apache\u003C/code> HTTP Server, including TLS configuration. The directives available in the \u003Ccode class=\"literal\">/etc/httpd/conf.d/ssl.conf\u003C/code> configuration file are described in detail in the \u003Ccode class=\"literal\">/usr/share/httpd/manual/mod/mod_ssl.html\u003C/code> file.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ref_using-hsms-protecting-private-keys-in-nginx_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.5. Using HSMs protecting private keys in Nginx\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">Nginx\u003C/code> HTTP server can work with private keys stored on hardware security modules (HSMs), which helps to prevent the keys' disclosure and man-in-the-middle attacks. Note that this usually requires high-performance HSMs for busy servers.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBecause \u003Ccode class=\"literal\">Nginx\u003C/code> also uses the OpenSSL for cryptographic operations, support for PKCS #11 must go through the \u003Ccode class=\"literal\">openssl-pkcs11\u003C/code> engine. \u003Ccode class=\"literal\">Nginx\u003C/code> currently supports only loading private keys from an HSM, and a certificate must be provided separately as a regular file. Modify the \u003Ccode class=\"literal\">ssl_certificate\u003C/code> and \u003Ccode class=\"literal\">ssl_certificate_key\u003C/code> options in the \u003Ccode class=\"literal\">server\u003C/code> section of the \u003Ccode class=\"literal\">/etc/nginx/nginx.conf\u003C/code> configuration file:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">ssl_certificate     /path/to/cert.pem\nssl_certificate_key \"engine:pkcs11:pkcs11:token=softhsm;id=%01;type=private?pin-value=111111\";\u003C/pre>\u003Cp>\n\t\t\t\tNote that the \u003Ccode class=\"literal\">engine:pkcs11:\u003C/code> prefix is needed for the PKCS #11 URI in the \u003Ccode class=\"literal\">Nginx\u003C/code> configuration file. This is because the other \u003Ccode class=\"literal\">pkcs11\u003C/code> prefix refers to the engine name.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"related-information-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.6. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pkcs11.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_controlling-access-to-smart-cards-using-polkit_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 5. Controlling access to smart cards by using polkit\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tTo cover possible threats that cannot be prevented by mechanisms built into smart cards, such as PINs, PIN pads, and biometrics, and for more fine-grained control, RHEL uses the \u003Ccode class=\"literal\">polkit\u003C/code> framework for controlling access control to smart cards.\n\t\t\u003C/p>\u003Cp>\n\t\t\tSystem administrators can configure \u003Ccode class=\"literal\">polkit\u003C/code> to fit specific scenarios, such as smart-card access for non-privileged or non-local users or services.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"con_smart-card-access-control-through-polkit_assembly_controlling-access-to-smart-cards-using-polkit\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.1. Smart-card access control through polkit\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Personal Computer/Smart Card (PC/SC) protocol specifies a standard for integrating smart cards and their readers into computing systems. In RHEL, the \u003Ccode class=\"literal\">pcsc-lite\u003C/code> package provides middleware to access smart cards that use the PC/SC API. A part of this package, the \u003Ccode class=\"literal\">pcscd\u003C/code> (PC/SC Smart Card) daemon, ensures that the system can access a smart card using the PC/SC protocol.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBecause access-control mechanisms built into smart cards, such as PINs, PIN pads, and biometrics, do not cover all possible threats, RHEL uses the \u003Ccode class=\"literal\">polkit\u003C/code> framework for more robust access control. The \u003Ccode class=\"literal\">polkit\u003C/code> authorization manager can grant access to privileged operations. In addition to granting access to disks, you can use \u003Ccode class=\"literal\">polkit\u003C/code> also to specify policies for securing smart cards. For example, you can define which users can perform which operations with a smart card.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAfter installing the \u003Ccode class=\"literal\">pcsc-lite\u003C/code> package and starting the \u003Ccode class=\"literal\">pcscd\u003C/code> daemon, the system enforces policies defined in the \u003Ccode class=\"literal\">/usr/share/polkit-1/actions/\u003C/code> directory. The default system-wide policy is in the \u003Ccode class=\"literal\">/usr/share/polkit-1/actions/org.debian.pcsc-lite.policy\u003C/code> file. Polkit policy files use the XML format and the syntax is described in the \u003Ccode class=\"literal\">polkit(8)\u003C/code> man page on your system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">polkitd\u003C/code> service monitors the \u003Ccode class=\"literal\">/etc/polkit-1/rules.d/\u003C/code> and \u003Ccode class=\"literal\">/usr/share/polkit-1/rules.d/\u003C/code> directories for any changes in rule files stored in these directories. The files contain authorization rules in JavaScript format. System administrators can add custom rule files in both directories, and \u003Ccode class=\"literal\">polkitd\u003C/code> reads them in lexical order based on their file name. If two files have the same names, then the file in \u003Ccode class=\"literal\">/etc/polkit-1/rules.d/\u003C/code> is read first.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you need to enable smart-card support when the system security services daemon (SSSD) does not run as \u003Ccode class=\"literal\">root\u003C/code>, you must install the \u003Ccode class=\"literal\">sssd-polkit-rules\u003C/code> package. The package provides \u003Ccode class=\"literal\">polkit\u003C/code> integration with SSSD.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">polkit(8)\u003C/code>, \u003Ccode class=\"literal\">polkitd(8)\u003C/code>, and \u003Ccode class=\"literal\">pcscd(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_troubleshooting-problems-related-to-pc-sc-and-polkit_assembly_controlling-access-to-smart-cards-using-polkit\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.2. Troubleshooting problems related to PC/SC and polkit\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPolkit policies that are automatically enforced after you install the \u003Ccode class=\"literal\">pcsc-lite\u003C/code> package and start the \u003Ccode class=\"literal\">pcscd\u003C/code> daemon may ask for authentication in the user’s session even if the user does not directly interact with a smart card. In GNOME, you can see the following error message:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">Authentication is required to access the PC/SC daemon\u003C/pre>\u003Cp>\n\t\t\t\tNote that the system can install the \u003Ccode class=\"literal\">pcsc-lite\u003C/code> package as a dependency when you install other packages related to smart cards such as \u003Ccode class=\"literal\">opensc\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf your scenario does not require any interaction with smart cards and you want to prevent displaying authorization requests for the PC/SC daemon, you can remove the \u003Ccode class=\"literal\">pcsc-lite\u003C/code> package. Keeping the minimum of necessary packages is a good security practice anyway.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you use smart cards, start troubleshooting by checking the rules in the system-provided policy file at \u003Ccode class=\"literal\">/usr/share/polkit-1/actions/org.debian.pcsc-lite.policy\u003C/code>. You can add your custom rule files to the policy in the \u003Ccode class=\"literal\">/etc/polkit-1/rules.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">03-allow-pcscd.rules\u003C/code>. Note that the rule files use the JavaScript syntax, the policy file is in the XML format.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo understand what authorization requests the system displays, check the Journal log, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -b | grep pcsc\u003C/strong>\u003C/span>\n...\nProcess 3087 (user: 1001) is NOT authorized for action: access_pcsc\n...\u003C/pre>\u003Cp>\n\t\t\t\tThe previous log entry means that the user is not authorized to perform an action by the policy. You can solve this denial by adding a corresponding rule to \u003Ccode class=\"literal\">/etc/polkit-1/rules.d/\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can search also for log entries related to the \u003Ccode class=\"literal\">polkitd\u003C/code> unit, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -u polkit\u003C/strong>\u003C/span>\n...\npolkitd[NNN]: Error compiling script /etc/polkit-1/rules.d/00-debug-pcscd.rules\n...\npolkitd[NNN]: Operator of unix-session:c2 FAILED to authenticate to gain authorization for action org.debian.pcsc-lite.access_pcsc for unix-process:4800:14441 [/usr/libexec/gsd-smartcard] (owned by unix-user:group)\n...\u003C/pre>\u003Cp>\n\t\t\t\tIn the previous output, the first entry means that the rule file contains some syntax error. The second entry means that the user failed to gain the access to \u003Ccode class=\"literal\">pcscd\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can also list all applications that use the PC/SC protocol by a short script. Create an executable file, for example, \u003Ccode class=\"literal\">pcsc-apps.sh\u003C/code>, and insert the following code:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">#!/bin/bash\n\ncd /proc\n\nfor p in [0-9]*\ndo\n\tif grep libpcsclite.so.1.0.0 $p/maps &amp;&gt; /dev/null\n\tthen\n\t\techo -n \"process: \"\n\t\tcat $p/cmdline\n\t\techo \" ($p)\"\n\tfi\ndone\u003C/pre>\u003Cp>\n\t\t\t\tRun the script as \u003Ccode class=\"literal\">root\u003C/code>:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>./pcsc-apps.sh\u003C/strong>\u003C/span>\nprocess: /usr/libexec/gsd-smartcard (3048)\nenable-sync --auto-ssl-client-auth --enable-crashpad (4828)\n...\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">journalctl\u003C/code>, \u003Ccode class=\"literal\">polkit(8)\u003C/code>, \u003Ccode class=\"literal\">polkitd(8)\u003C/code>, and \u003Ccode class=\"literal\">pcscd(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_displaying-more-detailed-information-about-polkit-authorization-to-pc-sc_assembly_controlling-access-to-smart-cards-using-polkit\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.3. Displaying more detailed information about polkit authorization to PC/SC\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn the default configuration, the \u003Ccode class=\"literal\">polkit\u003C/code> authorization framework sends only limited information to the Journal log. You can extend \u003Ccode class=\"literal\">polkit\u003C/code> log entries related to the PC/SC protocol by adding new rules.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have installed the \u003Ccode class=\"literal\">pcsc-lite\u003C/code> package on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">pcscd\u003C/code> daemon is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new file in the \u003Ccode class=\"literal\">/etc/polkit-1/rules.d/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>touch /etc/polkit-1/rules.d/00-test.rules\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the file in an editor of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/polkit-1/rules.d/00-test.rules\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInsert the following lines:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">polkit.addRule(function(action, subject) {\n  if (action.id == \"org.debian.pcsc-lite.access_pcsc\" ||\n  \taction.id == \"org.debian.pcsc-lite.access_card\") {\n\tpolkit.log(\"action=\" + action);\n\tpolkit.log(\"subject=\" + subject);\n  }\n});\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSave the file, and exit the editor.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">pcscd\u003C/code> and \u003Ccode class=\"literal\">polkit\u003C/code> services:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart pcscd.service pcscd.socket polkit.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMake an authorization request for \u003Ccode class=\"literal\">pcscd\u003C/code>. For example, open the Firefox web browser or use the \u003Ccode class=\"literal\">pkcs11-tool -L\u003C/code> command provided by the \u003Ccode class=\"literal\">opensc\u003C/code> package.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the extended log entries, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -u polkit --since \"1 hour ago\"\u003C/strong>\u003C/span>\npolkitd[1224]: &lt;no filename&gt;:4: action=[Action id='org.debian.pcsc-lite.access_pcsc']\npolkitd[1224]: &lt;no filename&gt;:5: subject=[Subject pid=2020481 user=user' groups=user,wheel,mock,wireshark seat=null session=null local=true active=true]\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">polkit(8)\u003C/code> and \u003Ccode class=\"literal\">polkitd(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.4. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/controlling-access-smart-cards\">Controlling access to smart cards\u003C/a> Red Hat Blog article.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 6. Scanning the system for configuration compliance and vulnerabilities\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tA compliance audit is a process of determining whether a given object follows all the rules specified in a compliance policy. The compliance policy is defined by security professionals who specify the required settings, often in the form of a checklist, that a computing environment should use.\n\t\t\u003C/p>\u003Cp>\n\t\t\tCompliance policies can vary substantially across organizations and even across different systems within the same organization. Differences among these policies are based on the purpose of each system and its importance for the organization. Custom software settings and deployment characteristics also raise a need for custom policy checklists.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.1. Configuration compliance tools in RHEL\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can perform a fully automated compliance audit in Red Hat Enterprise Linux by using the following configuration compliance tools. These tools are based on the Security Content Automation Protocol (SCAP) standard and are designed for automated tailoring of compliance policies.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">SCAP Workbench\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">scap-workbench\u003C/code> graphical utility is designed to perform configuration and vulnerability scans on a single local or remote system. You can also use it to generate security reports based on these scans and evaluations.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">OpenSCAP\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">OpenSCAP\u003C/code> library, with the accompanying \u003Ccode class=\"literal\">oscap\u003C/code> command-line utility, is designed to perform configuration and vulnerability scans on a local system, to validate configuration compliance content, and to generate reports and guides based on these scans and evaluations.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tYou can experience memory-consumption problems while using \u003Cspan class=\"strong strong\">\u003Cstrong>OpenSCAP\u003C/strong>\u003C/span>, which can cause stopping the program prematurely and prevent generating any result files. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6999111\">OpenSCAP memory-consumption problems\u003C/a> Knowledgebase article for details.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">SCAP Security Guide (SSG)\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal package\">scap-security-guide\u003C/code> package provides collections of security policies for Linux systems. The guidance consists of a catalog of practical hardening advice, linked to government requirements where applicable. The project bridges the gap between generalized policy requirements and specific implementation guidelines.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Script Check Engine (SCE)\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tWith SCE, which is an extension to the SCAP protocol, administrators can write their security content by using a scripting language, such as Bash, Python, and Ruby. The SCE extension is provided in the \u003Ccode class=\"literal package\">openscap-engine-sce\u003C/code> package. The SCE itself is not part of the SCAP standard.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tTo perform automated compliance audits on multiple systems remotely, you can use the OpenSCAP solution for Red Hat Satellite.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">oscap(8)\u003C/code>, \u003Ccode class=\"literal\">scap-workbench(8)\u003C/code>, and \u003Ccode class=\"literal\">scap-security-guide(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://2020-summit-labs.gitlab.io/rhel-custom-security-content/\">Red Hat Security Demos: Creating Customized Security Policy Content to Automate Security Compliance\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/RedHatDemos/SecurityDemos/blob/master/2020Labs/RHELSecurity/documentation/README.adoc\">Red Hat Security Demos: Defend Yourself with RHEL Security Technologies\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_satellite/6.15/html/managing_security_compliance/index\">Managing security compliance in Red Hat Satellite\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.2. Vulnerability scanning\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Csection class=\"section\" id=\"red-hat-security-advisories-oval-feed_vulnerability-scanning\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.2.1. Red Hat Security Advisories OVAL feed\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tRed Hat Enterprise Linux security auditing capabilities are based on the Security Content Automation Protocol (SCAP) standard. SCAP is a multi-purpose framework of specifications that supports automated configuration, vulnerability and patch checking, technical control compliance activities, and security measurement.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tSCAP specifications create an ecosystem where the format of security content is well-known and standardized although the implementation of the scanner or policy editor is not mandated. This enables organizations to build their security policy (SCAP content) once, no matter how many security vendors they employ.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThe Open Vulnerability Assessment Language (OVAL) is the essential and oldest component of SCAP. Unlike other tools and custom scripts, OVAL describes a required state of resources in a declarative manner. OVAL code is never executed directly but using an OVAL interpreter tool called scanner. The declarative nature of OVAL ensures that the state of the assessed system is not accidentally modified.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tLike all other SCAP components, OVAL is based on XML. The SCAP standard defines several document formats. Each of them includes a different kind of information and serves a different purpose.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/security/team/\">Red Hat Product Security\u003C/a> helps customers evaluate and manage risk by tracking and investigating all security issues affecting Red Hat customers. It provides timely and concise patches and security advisories on the Red Hat Customer Portal. Red Hat creates and supports OVAL patch definitions, providing machine-readable versions of our security advisories.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBecause of differences between platforms, versions, and other factors, Red Hat Product Security qualitative severity ratings of vulnerabilities do not directly align with the Common Vulnerability Scoring System (CVSS) baseline ratings provided by third parties. Therefore, we recommend that you use the RHSA OVAL definitions instead of those provided by third parties.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://www.redhat.com/security/data/oval/v2/\">RHSA OVAL definitions\u003C/a> are available individually and as a complete package, and are updated within an hour of a new security advisory being made available on the Red Hat Customer Portal.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tEach OVAL patch definition maps one-to-one to a Red Hat Security Advisory (RHSA). Because an RHSA can contain fixes for multiple vulnerabilities, each vulnerability is listed separately by its Common Vulnerabilities and Exposures (CVE) name and has a link to its entry in our public bug database.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThe RHSA OVAL definitions are designed to check for vulnerable versions of RPM packages installed on a system. It is possible to extend these definitions to include further checks, for example, to find out if the packages are being used in a vulnerable configuration. These definitions are designed to cover software and updates shipped by Red Hat. Additional definitions are required to detect the patch status of third-party software.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_insights/1-latest/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/intro-compliance\">Red Hat Insights for Red Hat Enterprise Linux compliance service\u003C/a> helps IT security and compliance administrators to assess, monitor, and report on the security policy compliance of Red Hat Enterprise Linux systems. You can also create and manage your SCAP security policies entirely within the compliance service UI.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/221883\">Red Hat and OVAL compatibility\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2123171\">Red Hat and CVE compatibility\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/security/updates/advisory\">Notifications and Advisories\u003C/a> in the \u003Ca class=\"link\" href=\"https://access.redhat.com/security/overview\">Product Security Overview\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/security/data/metrics/\">Security Data Metrics\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"scanning-the-system-for-vulnerabilities_vulnerability-scanning\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.2.2. Scanning the system for vulnerabilities\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tThe \u003Ccode class=\"literal\">oscap\u003C/code> command-line utility enables you to scan local systems, validate configuration compliance content, and generate reports and guides based on these scans and evaluations. This utility serves as a front end to the OpenSCAP library and groups its functionalities to modules (sub-commands) based on the type of SCAP content it processes.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">openscap-scanner\u003C/code> and \u003Ccode class=\"literal\">bzip2\u003C/code> packages are installed.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDownload the latest RHSA OVAL definitions for your system:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>wget -O - https://www.redhat.com/security/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2 | bzip2 --decompress &gt; rhel-9.oval.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tScan the system for vulnerabilities and save results to the \u003Cspan class=\"emphasis\">\u003Cem>vulnerability.html\u003C/em>\u003C/span> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap oval eval --report \u003Cspan class=\"emphasis\">\u003Cem>vulnerability.html\u003C/em>\u003C/span> rhel-9.oval.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCheck the results in a browser of your choice, for example:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>firefox \u003Cspan class=\"emphasis\">\u003Cem>vulnerability.html\u003C/em>\u003C/span> &amp;\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">oscap(8)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/security/data/oval/v2/RHEL9/\">Red Hat OVAL definitions\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6999111\">OpenSCAP memory consumption problems\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"scanning-remote-systems-for-vulnerabilities_vulnerability-scanning\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.2.3. Scanning remote systems for vulnerabilities\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can check remote systems for vulnerabilities with the OpenSCAP scanner by using the \u003Ccode class=\"literal\">oscap-ssh\u003C/code> tool over the SSH protocol.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">openscap-utils\u003C/code> and \u003Ccode class=\"literal\">bzip2\u003C/code> packages are installed on the system you use for scanning.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">openscap-scanner\u003C/code> package is installed on the remote systems.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe SSH server is running on the remote systems.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDownload the latest RHSA OVAL definitions for your system:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>wget -O - https://www.redhat.com/security/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2 | bzip2 --decompress &gt; rhel-9.oval.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tScan a remote system for vulnerabilities and save the results to a file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap-ssh \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;port&gt;\u003C/em>\u003C/span> oval eval --report \u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span> rhel-9.oval.xml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tReplace:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname&gt;\u003C/em>\u003C/span>\u003C/code> with the user name and host name of the remote system.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;port&gt;\u003C/em>\u003C/span>\u003C/code> with the port number through which you can access the remote system, for example, \u003Ccode class=\"literal\">22\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span>\u003C/code> with the file name where \u003Ccode class=\"literal\">oscap\u003C/code> saves the scan results.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">oscap-ssh(8)\u003C/code>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/security/data/oval/v2/RHEL9/\">Red Hat OVAL definitions\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6999111\">OpenSCAP memory consumption problems\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.3. Configuration compliance scanning\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Csection class=\"section\" id=\"configuration-compliance-in-rhel-8_configuration-compliance-scanning\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.3.1. Configuration compliance in RHEL\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can use configuration compliance scanning to conform to a baseline defined by a specific organization. For example, if you work with the US government, you might have to align your systems with the Operating System Protection Profile (OSPP), and if you are a payment processor, you might have to align your systems with the Payment Card Industry Data Security Standard (PCI-DSS). You can also perform configuration compliance scanning to harden your system security.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tRed Hat recommends you follow the Security Content Automation Protocol (SCAP) content provided in the SCAP Security Guide package because it is in line with Red Hat best practices for affected components.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThe SCAP Security Guide package provides content which conforms to the SCAP 1.2 and SCAP 1.3 standards. The \u003Ccode class=\"literal\">openscap scanner\u003C/code> utility is compatible with both SCAP 1.2 and SCAP 1.3 content provided in the SCAP Security Guide package.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tPerforming a configuration compliance scanning does not guarantee the system is compliant.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\t\tThe SCAP Security Guide suite provides profiles for several platforms in a form of data stream documents. A data stream is a file that contains definitions, benchmarks, profiles, and individual rules. Each rule specifies the applicability and requirements for compliance. RHEL provides several profiles for compliance with security policies. In addition to the industry standard, Red Hat data streams also contain information for remediation of failed rules.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Structure of compliance scanning resources\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\n\u003Cpre class=\"screen\">Data stream\n   ├── xccdf\n   |      ├── benchmark\n   |            ├── profile\n   |            |    ├──rule reference\n   |            |    └──variable\n   |            ├── rule\n   |                 ├── human readable data\n   |                 ├── oval reference\n   ├── oval          ├── ocil reference\n   ├── ocil          ├── cpe reference\n   └── cpe           └── remediation\u003C/pre>\n\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\t\tA profile is a set of rules based on a security policy, such as OSPP, PCI-DSS, and Health Insurance Portability and Accountability Act (HIPAA). This enables you to audit the system in an automated way for compliance with security standards.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tYou can modify (tailor) a profile to customize certain rules, for example, password length. For more information about profile tailoring, see \u003Ca class=\"link\" href=\"#customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench\" title=\"6.8.2. Customizing a security profile with SCAP Workbench\">Customizing a security profile with SCAP Workbench\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"possible-results-of-an-openscap-scan_configuration-compliance-scanning\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.3.2. Possible results of an OpenSCAP scan\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tDepending on the data stream and profile applied to an OpenSCAP scan, as well as various properties of your system, each rule may produce a specific result. These are the possible results with brief explanations of their meanings:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Pass\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThe scan did not find any conflicts with this rule.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Fail\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThe scan found a conflict with this rule.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Not checked\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tOpenSCAP does not perform an automatic evaluation of this rule. Check whether your system conforms to this rule manually.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Not applicable\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThis rule does not apply to the current configuration.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Not selected\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThis rule is not part of the profile. OpenSCAP does not evaluate this rule and does not display these rules in the results.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Error\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThe scan encountered an error. For additional information, you can enter the \u003Ccode class=\"literal\">oscap\u003C/code> command with the \u003Ccode class=\"literal\">--verbose DEVEL\u003C/code> option. File a support case on the \u003Ca class=\"link\" href=\"https://access.redhat.com/support/cases/\">Red Hat customer portal\u003C/a> or open a ticket in the \u003Ca class=\"link\" href=\"https://issues.redhat.com/projects/RHEL/issues\">RHEL project in Red Hat Jira\u003C/a>.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Unknown\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThe scan encountered an unexpected situation. For additional information, you can enter the \u003Ccode class=\"literal\">oscap\u003C/code> command with the \u003Ccode class=\"literal\">`--verbose DEVEL\u003C/code> option. File a support case on the \u003Ca class=\"link\" href=\"https://access.redhat.com/support/cases/\">Red Hat customer portal\u003C/a> or open a ticket in the \u003Ca class=\"link\" href=\"https://issues.redhat.com/projects/RHEL/issues\">RHEL project in Red Hat Jira\u003C/a>.\n\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"viewing-profiles-for-configuration-compliance_configuration-compliance-scanning\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.3.3. Viewing profiles for configuration compliance\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tBefore you decide to use profiles for scanning or remediation, you can list them and check their detailed descriptions using the \u003Ccode class=\"literal\">oscap info\u003C/code> subcommand.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">openscap-scanner\u003C/code> and \u003Ccode class=\"literal\">scap-security-guide\u003C/code> packages are installed.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tList all available files with security compliance profiles provided by the SCAP Security Guide project:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ls /usr/share/xml/scap/ssg/content/\u003C/strong>\u003C/span>\nssg-rhel9-ds.xml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisplay detailed information about a selected data stream using the \u003Ccode class=\"literal command\">oscap info\u003C/code> subcommand. XML files containing data streams are indicated by the \u003Ccode class=\"literal\">-ds\u003C/code> string in their names. In the \u003Ccode class=\"literal\">Profiles\u003C/code> section, you can find a list of available profiles and their IDs:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>oscap info /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\nProfiles:\n…\n  Title: Australian Cyber Security Centre (ACSC) Essential Eight\n    Id: xccdf_org.ssgproject.content_profile_e8\n  Title: Health Insurance Portability and Accountability Act (HIPAA)\n    Id: xccdf_org.ssgproject.content_profile_hipaa\n  Title: PCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9\n    Id: xccdf_org.ssgproject.content_profile_pci-dss\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tSelect a profile from the data stream file and display additional details about the selected profile. To do so, use \u003Ccode class=\"literal command\">oscap info\u003C/code> with the \u003Ccode class=\"literal\">--profile\u003C/code> option followed by the last section of the ID displayed in the output of the previous command. For example, the ID of the HIPPA profile is \u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_hipaa\u003C/code>, and the value for the \u003Ccode class=\"literal option\">--profile\u003C/code> option is \u003Ccode class=\"literal\">hipaa\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>oscap info --profile hipaa /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\n…\nProfile\n\tTitle: Health Insurance Portability and Accountability Act (HIPAA)\n\n\tDescription: The HIPAA Security Rule establishes U.S. national standards to protect individuals’ electronic personal health information that is created, received, used, or maintained by a covered entity.\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">scap-security-guide(8)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6999111\">OpenSCAP memory consumption problems\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"assessing-configuration-compliance-with-a-specific-baseline_configuration-compliance-scanning\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.3.4. Assessing configuration compliance with a specific baseline\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can determine whether your system or a remote system conforms to a specific baseline, and save the results in a report by using the \u003Ccode class=\"literal\">oscap\u003C/code> command-line tool.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal package\">openscap-scanner\u003C/code> and \u003Ccode class=\"literal package\">scap-security-guide\u003C/code> packages are installed.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou know the ID of the profile within the baseline with which the system should comply. To find the ID, see the \u003Ca class=\"link\" href=\"#viewing-profiles-for-configuration-compliance_configuration-compliance-scanning\" title=\"6.3.3. Viewing profiles for configuration compliance\">Viewing profiles for configuration compliance\u003C/a> section.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tScan the local system for compliance with the selected profile and save the scan results to a file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf eval --report \u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span> --profile \u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tReplace:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span>\u003C/code> with the file name where \u003Ccode class=\"literal\">oscap\u003C/code> saves the scan results.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span>\u003C/code> with the profile ID with which the system should comply, for example, \u003Ccode class=\"literal\">hipaa\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOptional: Scan a remote system for compliance with the selected profile and save the scan results to a file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>oscap-ssh \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;port&gt;\u003C/em>\u003C/span> xccdf eval --report \u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span> --profile \u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tReplace:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname&gt;\u003C/em>\u003C/span>\u003C/code> with the user name and host name of the remote system.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;port&gt;\u003C/em>\u003C/span>\u003C/code> with the port number through which you can access the remote system.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span>\u003C/code> with the file name where \u003Ccode class=\"literal\">oscap\u003C/code> saves the scan results.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span>\u003C/code> with the profile ID with which the system should comply, for example, \u003Ccode class=\"literal\">hipaa\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">scap-security-guide(8)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">SCAP Security Guide\u003C/code> documentation in the \u003Ccode class=\"literal\">/usr/share/doc/scap-security-guide/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/scap-security-guide/guides/ssg-rhel9-guide-index.html\u003C/code> - [Guide to the Secure Configuration of Red Hat Enterprise Linux 9] installed with the \u003Ccode class=\"literal package\">scap-security-guide-doc\u003C/code> package\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6999111\">OpenSCAP memory consumption problems\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"remediating-the-system-to-align-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.4. Remediating the system to align with a specific baseline\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can remediate the RHEL system to align with a specific baseline. You can remediate the system to align with any profile provided by the SCAP Security Guide. For the details on listing the available profiles, see the \u003Ca class=\"link\" href=\"#viewing-profiles-for-configuration-compliance_configuration-compliance-scanning\" title=\"6.3.3. Viewing profiles for configuration compliance\">Viewing profiles for configuration compliance\u003C/a> section.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf not used carefully, running the system evaluation with the \u003Ccode class=\"literal\">Remediate\u003C/code> option enabled might render the system non-functional. Red Hat does not provide any automated method to revert changes made by security-hardening remediations. Remediations are supported on RHEL systems in the default configuration. If your system has been altered after the installation, running remediation might not make it compliant with the required security profile.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">scap-security-guide\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRemediate the system by using the \u003Ccode class=\"literal\">oscap\u003C/code> command with the \u003Ccode class=\"literal\">--remediate\u003C/code> option:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf eval --profile \u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span> --remediate /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span>\u003C/code> with the profile ID with which the system should comply, for example, \u003Ccode class=\"literal\">hipaa\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRestart your system.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEvaluate compliance of the system with the profile, and save the scan results to a file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf eval --report \u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span> --profile \u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span>\u003C/code> with the file name where \u003Ccode class=\"literal\">oscap\u003C/code> saves the scan results.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span>\u003C/code> with the profile ID with which the system should comply, for example, \u003Ccode class=\"literal\">hipaa\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">scap-security-guide(8)\u003C/code> and \u003Ccode class=\"literal\">oscap(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"remediating-the-system-to-align-with-a-specific-baseline-using-the-ssg-ansible-playbook_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.5. Remediating the system to align with a specific baseline using an SSG Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can remediate your system to align with a specific baseline by using an Ansible playbook file from the SCAP Security Guide project. This example uses the Health Insurance Portability and Accountability Act (HIPAA) profile, but you can remediate to align with any other profile provided by the SCAP Security Guide. For the details on listing the available profiles, see the \u003Ca class=\"link\" href=\"#viewing-profiles-for-configuration-compliance_configuration-compliance-scanning\" title=\"6.3.3. Viewing profiles for configuration compliance\">Viewing profiles for configuration compliance\u003C/a> section.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf not used carefully, running the system evaluation with the \u003Ccode class=\"literal\">Remediate\u003C/code> option enabled might render the system non-functional. Red Hat does not provide any automated method to revert changes made by security-hardening remediations. Remediations are supported on RHEL systems in the default configuration. If your system has been altered after the installation, running remediation might not make it compliant with the required security profile.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">scap-security-guide\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ansible-core\u003C/code> package is installed. See the \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/installation_guide/\">Ansible Installation Guide\u003C/a> for more information.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRemediate your system to align with HIPAA by using Ansible:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -i localhost, -c local /usr/share/scap-security-guide/ansible/rhel9-playbook-hipaa.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRestart the system.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEvaluate the compliance of the system with the HIPAA profile, and save the scan results to a file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf eval --profile hipaa --report \u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span>\u003C/code> with the file name where \u003Ccode class=\"literal\">oscap\u003C/code> saves the scan results.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">scap-security-guide(8)\u003C/code> and \u003Ccode class=\"literal\">oscap(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/\">Ansible Documentation\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-remediation-ansible-playbook-to-align-the-system-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.6. Creating a remediation Ansible playbook to align the system with a specific baseline\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can create an Ansible playbook containing only the remediations that are required to align your system with a specific baseline. This playbook is smaller because it does not cover already satisfied requirements. Creating the playbook does not modify your system in any way, you only prepare a file for later application. This example uses the Health Insurance Portability and Accountability Act (HIPAA) profile.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn RHEL 9, Ansible Engine is replaced by the \u003Ccode class=\"literal\">ansible-core\u003C/code> package, which contains only built-in modules. Note that many Ansible remediations use modules from the community and Portable Operating System Interface (POSIX) collections, which are not included in the built-in modules. In this case, you can use Bash remediations as a substitute for Ansible remediations. The Red Hat Connector in RHEL 9.0 includes the Ansible modules necessary for the remediation playbooks to function with Ansible Core.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">scap-security-guide\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tScan the system and save the results:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf eval --profile hipaa --results \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-results.xml&gt;\u003C/em>\u003C/span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFind the value of the result ID in the file with the results:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap info \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-results.xml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate an Ansible playbook based on the file generated in step 1:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf generate fix --fix-type ansible --result-id \u003Cspan class=\"emphasis\">\u003Cem>&lt;xccdf_org.open-scap_testresult_xccdf_org.ssgproject.content_profile_hipaa&gt;\u003C/em>\u003C/span> --output \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-remediations.yml&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-results.xml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tReview the generated file, which contains the Ansible remediations for rules that failed during the scan performed in step 1. After reviewing this generated file, you can apply it by using the \u003Ccode class=\"literal\">ansible-playbook \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-remediations.yml&gt;\u003C/em>\u003C/span>\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn a text editor of your choice, review that the generated \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-remediations.yml&gt;\u003C/em>\u003C/span>\u003C/code> file contains rules that failed in the scan performed in step 1.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">scap-security-guide(8)\u003C/code> and \u003Ccode class=\"literal\">oscap(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/\">Ansible Documentation\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-remediation-bash-script-for-a-later-application_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.7. Creating a remediation Bash script for a later application\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse this procedure to create a Bash script containing remediations that align your system with a security profile such as HIPAA. Using the following steps, you do not do any modifications to your system, you only prepare a file for later application.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">scap-security-guide\u003C/code> package is installed on your RHEL system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">oscap\u003C/code> command to scan the system and to save the results to an XML file. In the following example, \u003Ccode class=\"literal\">oscap\u003C/code> evaluates the system against the \u003Ccode class=\"literal\">hipaa\u003C/code> profile:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf eval --profile hipaa --results \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-results.xml&gt;\u003C/em>\u003C/span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFind the value of the result ID in the file with the results:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap info \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-results.xml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a Bash script based on the results file generated in step 1:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf generate fix --fix-type bash --result-id \u003Cspan class=\"emphasis\">\u003Cem>&lt;xccdf_org.open-scap_testresult_xccdf_org.ssgproject.content_profile_hipaa&gt;\u003C/em>\u003C/span> --output \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-remediations.sh&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-results.xml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-remediations.sh&gt;\u003C/em>\u003C/span>\u003C/code> file contains remediations for rules that failed during the scan performed in step 1. After reviewing this generated file, you can apply it with the \u003Ccode class=\"literal\">./\u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-remediations.sh&gt;\u003C/em>\u003C/span>\u003C/code> command when you are in the same directory as this file.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn a text editor of your choice, review that the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;hipaa-remediations.sh&gt;\u003C/em>\u003C/span>\u003C/code> file contains rules that failed in the scan performed in step 1.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">scap-security-guide(8)\u003C/code>, \u003Ccode class=\"literal\">oscap(8)\u003C/code>, and \u003Ccode class=\"literal\">bash(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.8. Scanning the system with a customized profile using SCAP Workbench\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Ccode class=\"literal application\">SCAP Workbench\u003C/code>, which is contained in the \u003Ccode class=\"literal package\">scap-workbench\u003C/code> package, is a graphical utility that enables users to perform configuration and vulnerability scans on a single local or a remote system, perform remediation of the system, and generate reports based on scan evaluations. Note that \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code> has limited functionality compared with the \u003Ccode class=\"literal application\">oscap\u003C/code> command-line utility. \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code> processes security content in the form of data stream files.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"using-scap-workbench-to-scan-and-remediate-the-system_scanning-the-system-with-a-customized-profile-using-scap-workbench\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.8.1. Using SCAP Workbench to scan and remediate the system\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tTo evaluate your system against the selected security policy, use the following procedure.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">scap-workbench\u003C/code> package is installed on your system.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo run \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code> from the \u003Ccode class=\"literal application\">GNOME Classic\u003C/code> desktop environment, press the \u003Ckbd class=\"keycap\">Super\u003C/kbd> key to enter the \u003Ccode class=\"literal\">Activities Overview\u003C/code>, type \u003Ccode class=\"literal command\">scap-workbench\u003C/code>, and then press \u003Ckbd class=\"keycap\">Enter\u003C/kbd>. Alternatively, use:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>scap-workbench\u003C/strong>\u003C/span> &amp;\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tSelect a security policy using either of the following options:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">Load Content\u003C/code> button on the starting window\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">Open content from SCAP Security Guide\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">Open Other Content\u003C/code> in the \u003Ccode class=\"literal\">File\u003C/code> menu, and search the respective XCCDF, SCAP RPM, or data stream file.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/0f9eeb2312fe90ee8ec24db4d46c31e1/scap-workbench-start.png\" alt=\"scap workbench start\"/>\u003C/div>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can allow automatic correction of the system configuration by selecting the \u003Cspan class=\"guibutton\">Remediate\u003C/span> check box. With this option enabled, \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code> attempts to change the system configuration in accordance with the security rules applied by the policy. This process should fix the related checks that fail during the system scan.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tIf not used carefully, running the system evaluation with the \u003Ccode class=\"literal option\">Remediate\u003C/code> option enabled might render the system non-functional. Red Hat does not provide any automated method to revert changes made by security-hardening remediations. Remediations are supported on RHEL systems in the default configuration. If your system has been altered after the installation, running remediation might not make it compliant with the required security profile.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tScan your system with the selected profile by clicking the \u003Cspan class=\"guibutton\">Scan\u003C/span> button.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/9664b64567d257b481dda88e7737edc7/scap-workbench-results.png\" alt=\"scap workbench results\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tTo store the scan results in form of an XCCDF, ARF, or HTML file, click the \u003Cspan class=\"guibutton\">Save Results\u003C/span> combo box. Choose the \u003Ccode class=\"literal option\">HTML Report\u003C/code> option to generate the scan report in human-readable format. The XCCDF and ARF (data stream) formats are suitable for further automatic processing. You can repeatedly choose all three options.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tTo export results-based remediations to a file, use the \u003Cspan class=\"guibutton\">Generate remediation role\u003C/span> pop-up menu.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.8.2. Customizing a security profile with SCAP Workbench\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can customize a security profile by changing parameters in certain rules (for example, minimum password length), removing rules that you cover in a different way, and selecting additional rules, to implement internal policies. You cannot define new rules by customizing a profile.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThe following procedure demonstrates the use of \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code> for customizing (tailoring) a profile. You can also save the tailored profile for use with the \u003Ccode class=\"literal application\">oscap\u003C/code> command-line utility.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">scap-workbench\u003C/code> package is installed on your system.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tRun \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code>, and select the profile to customize by using either \u003Ccode class=\"literal option\">Open content from SCAP Security Guide\u003C/code> or \u003Ccode class=\"literal option\">Open Other Content\u003C/code> in the \u003Ccode class=\"literal\">File\u003C/code> menu.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo adjust the selected security profile according to your needs, click the \u003Cspan class=\"guibutton\">Customize\u003C/span> button.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis opens the new Customization window that enables you to modify the currently selected profile without changing the original data stream file. Choose a new profile ID.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/19d27fa7989305554414c334d5d76e3a/scap-new-profile-id.png\" alt=\"Choosing the ID of your new profile\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFind a rule to modify using either the tree structure with rules organized into logical groups or the \u003Cspan class=\"guibutton\">Search\u003C/span> field.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tInclude or exclude rules using check boxes in the tree structure, or modify values in rules where applicable.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/4a52e7daf700132237fb0712802b0b79/scap-workbench-customizing-profile.png\" alt=\"Customizing a rule in the OSPP profile\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tConfirm the changes by clicking the \u003Cspan class=\"guibutton\">OK\u003C/span> button.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo store your changes permanently, use one of the following options:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tSave a customization file separately by using \u003Ccode class=\"literal option\">Save Customization Only\u003C/code> in the \u003Ccode class=\"literal\">File\u003C/code> menu.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tSave all security content at once by \u003Ccode class=\"literal option\">Save All\u003C/code> in the \u003Ccode class=\"literal\">File\u003C/code> menu.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you select the \u003Ccode class=\"literal option\">Into a directory\u003C/code> option, \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code> saves both the data stream file and the customization file to the specified location. You can use this as a backup solution.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tBy selecting the \u003Ccode class=\"literal option\">As RPM\u003C/code> option, you can instruct \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code> to create an RPM package containing the data stream file and the customization file. This is useful for distributing the security content to systems that cannot be scanned remotely, and for delivering the content for further processing.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tBecause \u003Ccode class=\"literal application\">SCAP Workbench\u003C/code> does not support results-based remediations for tailored profiles, use the exported remediations with the \u003Ccode class=\"literal application\">oscap\u003C/code> command-line utility.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"related-information-scanning-the-system-with-a-customized-profile-using-scap-workbench\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.8.3. Additional resources\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">scap-workbench(8)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/scap-workbench/user_manual.html\u003C/code> file provided by the \u003Ccode class=\"literal\">scap-workbench\u003C/code> package\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/2377951\">Deploy customized SCAP policies with Satellite 6.x\u003C/a> (Red Hat Knowledgebase)\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.9. Deploying systems that are compliant with a security profile immediately after an installation\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the OpenSCAP suite to deploy RHEL systems that are compliant with a security profile, such as OSPP, PCI-DSS, and HIPAA profile, immediately after the installation process. Using this deployment method, you can apply specific rules that cannot be applied later using remediation scripts, for example, a rule for password strength and partitioning.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"ref_profiles-not-compatible-with-server-with-gui_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.9.1. Profiles not compatible with Server with GUI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tCertain security profiles provided as part of the \u003Cspan class=\"strong strong\">\u003Cstrong>SCAP Security Guide\u003C/strong>\u003C/span> are not compatible with the extended package set included in the \u003Cspan class=\"strong strong\">\u003Cstrong>Server with GUI\u003C/strong>\u003C/span> base environment. Therefore, do not select \u003Cspan class=\"strong strong\">\u003Cstrong>Server with GUI\u003C/strong>\u003C/span> when installing systems compliant with one of the following profiles:\n\t\t\t\t\u003C/p>\u003Crh-table id=\"idm140081373242944\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 6.1. Profiles not compatible with Server with GUI\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 25%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081373765040\" scope=\"col\">Profile name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081373763952\" scope=\"col\">Profile ID\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081373762864\" scope=\"col\">Justification\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081373761776\" scope=\"col\">Notes\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373765040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t[DRAFT] CIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373763952\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373762864\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tPackages \u003Ccode class=\"literal\">xorg-x11-server-Xorg\u003C/code>, \u003Ccode class=\"literal\">xorg-x11-server-common\u003C/code>, \u003Ccode class=\"literal\">xorg-x11-server-utils\u003C/code>, and \u003Ccode class=\"literal\">xorg-x11-server-Xwayland\u003C/code> are part of the \u003Cspan class=\"strong strong\">\u003Cstrong>Server with GUI\u003C/strong>\u003C/span> package set, but the policy requires their removal.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373761776\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373765040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t[DRAFT] CIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373763952\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_server_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373762864\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tPackages \u003Ccode class=\"literal\">xorg-x11-server-Xorg\u003C/code>, \u003Ccode class=\"literal\">xorg-x11-server-common\u003C/code>, \u003Ccode class=\"literal\">xorg-x11-server-utils\u003C/code>, and \u003Ccode class=\"literal\">xorg-x11-server-Xwayland\u003C/code> are part of the \u003Cspan class=\"strong strong\">\u003Cstrong>Server with GUI\u003C/strong>\u003C/span> package set, but the policy requires their removal.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373761776\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373765040\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tDISA STIG for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373763952\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373762864\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tPackages \u003Ccode class=\"literal\">xorg-x11-server-Xorg\u003C/code>, \u003Ccode class=\"literal\">xorg-x11-server-common\u003C/code>, \u003Ccode class=\"literal\">xorg-x11-server-utils\u003C/code>, and \u003Ccode class=\"literal\">xorg-x11-server-Xwayland\u003C/code> are part of the \u003Cspan class=\"strong strong\">\u003Cstrong>Server with GUI\u003C/strong>\u003C/span> package set, but the policy requires their removal.\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081373761776\"> \u003Cp>\n\t\t\t\t\t\t\t\t\tTo install a RHEL system as a \u003Cspan class=\"strong strong\">\u003Cstrong>Server with GUI\u003C/strong>\u003C/span> aligned with DISA STIG, you can use the \u003Cspan class=\"strong strong\">\u003Cstrong>DISA STIG with GUI\u003C/strong>\u003C/span> profile \u003Ca class=\"link\" href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1648162\">BZ#1648162\u003C/a>\n\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"deploying-baseline-compliant-rhel-systems-using-the-graphical-installation_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.9.2. Deploying baseline-compliant RHEL systems using the graphical installation\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tUse this procedure to deploy a RHEL system that is aligned with a specific baseline. This example uses Protection Profile for General Purpose Operating System (OSPP).\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tCertain security profiles provided as part of the \u003Cspan class=\"strong strong\">\u003Cstrong>SCAP Security Guide\u003C/strong>\u003C/span> are not compatible with the extended package set included in the \u003Cspan class=\"strong strong\">\u003Cstrong>Server with GUI\u003C/strong>\u003C/span> base environment. For additional details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening#ref_profiles-not-compatible-with-server-with-gui_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation\">Profiles not compatible with a GUI server\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou have booted into the \u003Ccode class=\"literal\">graphical\u003C/code> installation program. Note that the \u003Cspan class=\"strong strong\">\u003Cstrong>OSCAP Anaconda Add-on\u003C/strong>\u003C/span> does not support interactive text-only installation.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou have accessed the \u003Ccode class=\"literal\">Installation Summary\u003C/code> window.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFrom the \u003Ccode class=\"literal\">Installation Summary\u003C/code> window, click \u003Ccode class=\"literal\">Software Selection\u003C/code>. The \u003Ccode class=\"literal\">Software Selection\u003C/code> window opens.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tFrom the \u003Ccode class=\"literal\">Base Environment\u003C/code> pane, select the \u003Ccode class=\"literal\">Server\u003C/code> environment. You can select only one base environment.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Done\u003C/code> to apply the setting and return to the \u003Ccode class=\"literal\">Installation Summary\u003C/code> window.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tBecause OSPP has strict partitioning requirements that must be met, create separate partitions for \u003Ccode class=\"literal\">/boot\u003C/code>, \u003Ccode class=\"literal\">/home\u003C/code>, \u003Ccode class=\"literal\">/var\u003C/code>, \u003Ccode class=\"literal\">/tmp\u003C/code>, \u003Ccode class=\"literal\">/var/log\u003C/code>, \u003Ccode class=\"literal\">/var/tmp\u003C/code>, and \u003Ccode class=\"literal\">/var/log/audit\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Security Policy\u003C/code>. The \u003Ccode class=\"literal\">Security Policy\u003C/code> window opens.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tTo enable security policies on the system, toggle the \u003Ccode class=\"literal\">Apply security policy\u003C/code> switch to \u003Ccode class=\"literal\">ON\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSelect \u003Ccode class=\"literal\">Protection Profile for General Purpose Operating Systems\u003C/code> from the profile pane.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Select Profile\u003C/code> to confirm the selection.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tConfirm the changes in the \u003Ccode class=\"literal\">Changes that were done or need to be done\u003C/code> pane that is displayed at the bottom of the window. Complete any remaining manual changes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tComplete the graphical installation process.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tThe graphical installation program automatically creates a corresponding Kickstart file after a successful installation. You can use the \u003Ccode class=\"literal\">/root/anaconda-ks.cfg\u003C/code> file to automatically install OSPP-compliant systems.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo check the current status of the system after installation is complete, reboot the system and start a new scan:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf eval --profile ospp --report eval_postinstall_report.html /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/interactively_installing_rhel_from_installation_media/index#storage-devices_customizing-the-system-in-the-installer\">Configuring manual partitioning\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-baseline-compliant-rhel-systems-using-kickstart_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.9.3. Deploying baseline-compliant RHEL systems using Kickstart\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can deploy RHEL systems that are aligned with a specific baseline. This example uses Protection Profile for General Purpose Operating System (OSPP).\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">scap-security-guide\u003C/code> package is installed on your RHEL 9 system.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/scap-security-guide/kickstart/ssg-rhel9-ospp-ks.cfg\u003C/code> Kickstart file in an editor of your choice.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tUpdate the partitioning scheme to fit your configuration requirements. For OSPP compliance, the separate partitions for \u003Ccode class=\"literal\">/boot\u003C/code>, \u003Ccode class=\"literal\">/home\u003C/code>, \u003Ccode class=\"literal\">/var\u003C/code>, \u003Ccode class=\"literal\">/tmp\u003C/code>, \u003Ccode class=\"literal\">/var/log\u003C/code>, \u003Ccode class=\"literal\">/var/tmp\u003C/code>, and \u003Ccode class=\"literal\">/var/log/audit\u003C/code> must be preserved, and you can only change the size of the partitions.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tStart a Kickstart installation as described in \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automatically_installing_rhel/index#starting-kickstart-installations_rhel-installer\">Performing an automated installation using Kickstart\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tPasswords in Kickstart files are not checked for OSPP requirements.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo check the current status of the system after installation is complete, reboot the system and start a new scan:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap xccdf eval --profile ospp --report eval_postinstall_report.html /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.open-scap.org/tools/oscap-anaconda-addon/\">OSCAP Anaconda Add-on\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automatically_installing_rhel/index#addon-com_redhat_oscap_kickstart-commands-for-addons-supplied-with-the-rhel-installation-program\">Kickstart commands and options reference: %addon org_fedora_oscap\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.10. Scanning container and container images for vulnerabilities\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse this procedure to find security vulnerabilities in a container or a container image.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">openscap-utils\u003C/code> and \u003Ccode class=\"literal\">bzip2\u003C/code> packages are installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDownload the latest RHSA OVAL definitions for your system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>wget -O - https://www.redhat.com/security/data/oval/v2/RHEL9/rhel-9.oval.xml.bz2 | bzip2 --decompress &gt; rhel-9.oval.xml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGet the ID of a container or a container image, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman images\u003C/strong>\u003C/span>\nREPOSITORY                            TAG      IMAGE ID       CREATED       SIZE\nregistry.access.redhat.com/ubi9/ubi   latest   096cae65a207   7 weeks ago   239 MB\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tScan the container or the container image for vulnerabilities and save results to the \u003Cspan class=\"emphasis\">\u003Cem>vulnerability.html\u003C/em>\u003C/span> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap-podman \u003Cspan class=\"emphasis\">\u003Cem>096cae65a207\u003C/em>\u003C/span> oval eval --report \u003Cspan class=\"emphasis\">\u003Cem>vulnerability.html\u003C/em>\u003C/span> rhel-9.oval.xml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that the \u003Ccode class=\"literal\">oscap-podman\u003C/code> command requires root privileges, and the ID of a container is the first argument.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the results in a browser of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>firefox \u003Cspan class=\"emphasis\">\u003Cem>vulnerability.html\u003C/em>\u003C/span> &amp;\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information, see the \u003Ccode class=\"literal\">oscap-podman(8)\u003C/code> and \u003Ccode class=\"literal\">oscap(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"assessing-security-compliance-of-a-container-or-a-container-image-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.11. Assessing security compliance of a container or a container image with a specific baseline\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can assess the compliance of your container or a container image with a specific security baseline, such as Operating System Protection Profile (OSPP), Payment Card Industry Data Security Standard (PCI-DSS), and Health Insurance Portability and Accountability Act (HIPAA).\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">openscap-utils\u003C/code> and \u003Ccode class=\"literal\">scap-security-guide\u003C/code> packages are installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have root access to the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFind the ID of a container or a container image:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tTo find the ID of a container, enter the \u003Ccode class=\"literal\">podman ps -a\u003C/code> command.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tTo find the ID of a container image, enter the \u003Ccode class=\"literal\">podman images\u003C/code> command.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEvaluate the compliance of the container or container image with a profile and save the scan results into a file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>oscap-podman \u003Cspan class=\"emphasis\">\u003Cem>&lt;ID&gt;\u003C/em>\u003C/span> xccdf eval --report \u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span> --profile \u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span> /usr/share/xml/scap/ssg/content/ssg-rhel9-ds.xml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;ID&gt;\u003C/em>\u003C/span>\u003C/code> with the ID of your container or container image\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span>\u003C/code> with the file name where \u003Ccode class=\"literal\">oscap\u003C/code> saves the scan results\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;profileID&gt;\u003C/em>\u003C/span>\u003C/code> with the profile ID with which the system should comply, for example, \u003Ccode class=\"literal\">hipaa\u003C/code>, \u003Ccode class=\"literal\">ospp\u003C/code>, or \u003Ccode class=\"literal\">pci-dss\u003C/code>\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the results in a browser of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>firefox \u003Cspan class=\"emphasis\">\u003Cem>&lt;scan-report.html&gt;\u003C/em>\u003C/span> &amp;amp;\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe rules marked as \u003Ccode class=\"literal\">notapplicable\u003C/code> apply only to bare-metal and virtualized systems and not to containers or container images.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">oscap-podman(8)\u003C/code> and \u003Ccode class=\"literal\">scap-security-guide(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/scap-security-guide/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"scap-security-guide-profiles-supported-in-rhel-9_scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.12. SCAP Security Guide profiles supported in RHEL 9\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tUse only the SCAP content provided in the particular minor release of RHEL. This is because components that participate in hardening are sometimes updated with new capabilities. SCAP content changes to reflect these updates, but it is not always backward compatible.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn the following tables, you can find the profiles provided in RHEL 9, together with the version of the policy with which the profile aligns.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm140081370176928\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 6.2. SCAP Security Guide profiles supported in RHEL 9.4\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081366697472\" scope=\"col\">Profile name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081366696384\" scope=\"col\">Profile ID\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081366695296\" scope=\"col\">Policy version\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_enhanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 High Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_high\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_intermediary\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_minimal\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Advanced\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_advanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Basic\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_basic\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Intermediate\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_intermediate\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.4.0 to RHEL 9.4.2:1.0.0\u003Cbr/> RHEL 9.4.3 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_server_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.4.0 to RHEL 9.4.2:1.0.0\u003Cbr/> RHEL 9.4.3 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.4.0 to RHEL 9.4.2:1.0.0\u003Cbr/> RHEL 9.4.3 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l2\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.4.0 to RHEL 9.4.2:1.0.0\u003Cbr/> RHEL 9.4.3 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\t[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tr2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) Essential Eight\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>e8\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tHealth Insurance Portability and Accountability Act (HIPAA)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>hipaa\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) ISM Official\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ism_o\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tProtection Profile for General Purpose Operating Systems\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ospp\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t4.3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tPCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>pci-dss\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t4.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.4.0:V1R2\u003Cbr/> RHEL 9.4.1 and later:V1R3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig_gui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.4.0:V1R2\u003Cbr/> RHEL 9.4.1 and later:V1R3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Basic\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_basic\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Intermediate\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_intermediate\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366697472\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Advanced\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366696384\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_advanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081366695296\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081371194032\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 6.3. SCAP Security Guide profiles supported in RHEL 9.3\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081367683872\" scope=\"col\">Profile name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081367682784\" scope=\"col\">Profile ID\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081369874672\" scope=\"col\">Policy version\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_enhanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 High Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_high\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_intermediary\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_minimal\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Advanced\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_advanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Basic\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_basic\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Intermediate\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_intermediate\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t1.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_server_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t1.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t1.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l2\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t1.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\t[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\tr2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) Essential Eight\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>e8\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tHealth Insurance Portability and Accountability Act (HIPAA)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>hipaa\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) ISM Official\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ism_o\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tProtection Profile for General Purpose Operating Systems\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ospp\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t4.3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tPCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>pci-dss\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.3.0 to RHEL 9.3.2:3.2.1\u003Cbr/> RHEL 9.3.3:4.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.3.0: DRAFT\u003Ca href=\"#ftn.stig\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"stig\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.3.2:V1R1\u003Cbr/> RHEL 9.3.3 and later:V1R2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig_gui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.3.0: DRAFT\u003Ca href=\"#ftn.stig\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.3.2:V1R1\u003Cbr/> RHEL 9.3.3 and later:V1R2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Basic\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_basic\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Intermediate\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_intermediate\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367683872\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Advanced\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367682784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_advanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369874672\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003Ctbody class=\"footnotes\">\u003Ctr>\u003Ctd colspan=\"3\">\u003Cdiv id=\"ftn.stig\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#stig\" class=\"simpara\">\u003Csup class=\"simpara\">[a] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\t\tDISA has not yet published an official benchmark for RHEL 9\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/div>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081372927424\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 6.4. SCAP Security Guide profiles supported in RHEL 9.2\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081362891840\" scope=\"col\">Profile name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081362890752\" scope=\"col\">Profile ID\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081367290496\" scope=\"col\">Policy version\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_enhanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.2:1.2\u003Cbr/> RHEL 9.2.3 and later:2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 High Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_high\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.2:1.2\u003Cbr/> RHEL 9.2.3 and later:2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_intermediary\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.2:1.2\u003Cbr/> RHEL 9.2.3 and later:2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_minimal\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.2:1.2\u003Cbr/> RHEL 9.2.3 and later:2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.10:1.0.0\u003Cbr/> RHEL 9.2.11 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_server_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.10:1.0.0\u003Cbr/> RHEL 9.2.11 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.10:1.0.0\u003Cbr/> RHEL 9.2.11 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l2\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.10:1.0.0\u003Cbr/> RHEL 9.2.11 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\t[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tr2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) Essential Eight\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>e8\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tHealth Insurance Portability and Accountability Act (HIPAA)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>hipaa\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) ISM Official\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ism_o\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tProtection Profile for General Purpose Operating Systems\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ospp\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\t4.2.1\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tPCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>pci-dss\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.5:3.2.1\u003Cbr/> RHEL 9.2.6 and later:4.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to RHEL 9.2.4: DRAFT\u003Ca href=\"#ftn.stig\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.2.5:V1R1\u003Cbr/> RHEL 9.2.6 to RHEL 9.2.8:V1R2\u003Cbr/> RHEL 9.2.9 and later:V1R3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig_gui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.2.0 to 9.2.4: DRAFT\u003Ca href=\"#ftn.stig\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.2.5:V1R1\u003Cbr/> RHEL 9.2.6 to RHEL 9.2.8:V1R2\u003Cbr/> RHEL 9.2.9 and later:V1R3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Basic\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_basic\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Intermediate\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_intermediate\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362891840\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Advanced\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081362890752\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_advanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081367290496\"> \u003Cp>\n\t\t\t\t\t\t\t\t2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081368669728\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 6.5. SCAP Security Guide profiles supported in RHEL 9.1\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081368664000\" scope=\"col\">Profile name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081369021760\" scope=\"col\">Profile ID\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081369020672\" scope=\"col\">Policy version\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_enhanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\t1.2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 High Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_high\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\t1.2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_intermediary\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\t1.2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_minimal\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\t1.2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.1.0 and RHEL 9.1.1:DRAFT\u003Ca href=\"#ftn.cis\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"cis\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.1.2 and later:1.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_server_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.1.0 and RHEL 9.1.1:DRAFT\u003Ca href=\"#ftn.cis\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.1.2 and later:1.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.1.0 and RHEL 9.1.1:DRAFT\u003Ca href=\"#ftn.cis\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.1.2 and later:1.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l2\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.1.0 and RHEL 9.1.1:DRAFT\u003Ca href=\"#ftn.cis\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.1.2 and later:1.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\t[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tr2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) Essential Eight\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>e8\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tHealth Insurance Portability and Accountability Act (HIPAA)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>hipaa\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) ISM Official\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ism_o\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tProtection Profile for General Purpose Operating Systems\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ospp\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\t4.2.1\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\tPCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>pci-dss\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\t3.2.1\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\t[DRAFT] The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tDRAFT\u003Ca href=\"#ftn.stig\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081368664000\"> \u003Cp>\n\t\t\t\t\t\t\t\t[DRAFT] The Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369021760\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig_gui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369020672\"> \u003Cp>\n\t\t\t\t\t\t\t\tDRAFT\u003Ca href=\"#ftn.stig\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003Ctbody class=\"footnotes\">\u003Ctr>\u003Ctd colspan=\"3\">\u003Cdiv id=\"ftn.cis\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#cis\" class=\"simpara\">\u003Csup class=\"simpara\">[a] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\t\tCIS has not yet published an official benchmark for RHEL 9\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/div>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081372174960\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 6.6. SCAP Security Guide profiles supported in RHEL 9.0\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081372169232\" scope=\"col\">Profile name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081369415728\" scope=\"col\">Profile ID\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081369414640\" scope=\"col\">Policy version\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Enhanced Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_enhanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.10:1.2\u003Cbr/> RHEL 9.0.11 and later:2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 High Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_high\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.10:1.2\u003Cbr/> RHEL 9.0.11 and later:2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Intermediary Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_intermediary\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.10:1.2\u003Cbr/> RHEL 9.0.11 and later:2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tFrench National Agency for the Security of Information Systems (ANSSI) BP-028 Minimal Level\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>anssi_bp28_minimal\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.10:1.2\u003Cbr/> RHEL 9.0.11 and later:2.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.6:DRAFT\u003Ca href=\"#ftn.cis\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.0.7 to RHEL 9.0.19:1.0.0\u003Cbr/> RHEL 9.0.20 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_server_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.6:DRAFT\u003Ca href=\"#ftn.cis\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.0.7 to RHEL 9.0.19:1.0.0\u003Cbr/> RHEL 9.0.20 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 1 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l1\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.6:DRAFT\u003Ca href=\"#ftn.cis\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.0.7 to RHEL 9.0.19:1.0.0\u003Cbr/> RHEL 9.0.20 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tCIS Red Hat Enterprise Linux 9 Benchmark for Level 2 - Workstation\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cis_workstation_l2\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.6:DRAFT\u003Ca href=\"#ftn.cis\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.0.7 to RHEL 9.0.19:1.0.0\u003Cbr/> RHEL 9.0.20 and later:2.0.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\t[DRAFT] Unclassified Information in Non-federal Information Systems and Organizations (NIST 800-171)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>cui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tr2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) Essential Eight\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>e8\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tHealth Insurance Portability and Accountability Act (HIPAA)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>hipaa\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tAustralian Cyber Security Centre (ACSC) ISM Official\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ism_o\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tnot versioned\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tProtection Profile for General Purpose Operating Systems\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ospp\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.2:DRAFT\u003Cbr/> RHEL 9.0.3 and later:4.2.1\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tPCI-DSS v3.2.1 Control Baseline for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>pci-dss\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.14:3.2.1\u003Cbr/> RHEL 9.0.15:4.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.13: DRAFT\u003Ca href=\"#ftn.stig\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.0.14:V1R1\u003Cbr/> RHEL 9.0.15 to 9.0.17:V1R2\u003Cbr/> RHEL 9.0.18 and later:V1R3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe Defense Information Systems Agency Security Technical Implementation Guide (DISA STIG) with GUI for Red Hat Enterprise Linux 9\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>stig_gui\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.0 to RHEL 9.0.13: DRAFT\u003Ca href=\"#ftn.stig\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\u003Cbr/> RHEL 9.0.14:V1R1\u003Cbr/> RHEL 9.0.15 to 9.0.17:V1R2\u003Cbr/> RHEL 9.0.18 and later:V1R3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Basic\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_basic\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.11 and later:2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Intermediate\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_intermediate\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.11 and later:2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081372169232\"> \u003Cp>\n\t\t\t\t\t\t\t\tCCN Red Hat Enterprise Linux 9 - Advanced\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369415728\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xccdf_org.ssgproject.content_profile_\u003Cspan class=\"strong strong\">\u003Cstrong>ccn_advanced\u003C/strong>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081369414640\"> \u003Cp>\n\t\t\t\t\t\t\t\tRHEL 9.0.11 and later:2022-10\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"related-information-scanning-the-system-for-configuration-compliance-and-vulnerabilities\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.13. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6337261\">Supported versions of the SCAP Security Guide in RHEL\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://www.open-scap.org\">The OpenSCAP project page\u003C/a> provides detailed information about the \u003Ccode class=\"literal\">oscap\u003C/code> utility and other components and projects related to SCAP.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.open-scap.org/tools/scap-workbench/\">The SCAP Workbench project page\u003C/a> provides detailed information about the \u003Ccode class=\"literal\">scap-workbench\u003C/code> application.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.open-scap.org/security-policies/scap-security-guide/\">The SCAP Security Guide (SSG) project page\u003C/a> provides the latest security content for Red Hat Enterprise Linux.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://lab.redhat.com/tracks/openscap\">Using OpenSCAP for security compliance and vulnerability scanning\u003C/a> - A hands-on lab on running tools based on the Security Content Automation Protocol (SCAP) standard for compliance and vulnerability scanning in RHEL.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://2020-summit-labs.gitlab.io/rhel-custom-security-content/\">Red Hat Security Demos: Creating Customized Security Policy Content to Automate Security Compliance\u003C/a> - A hands-on lab to get initial experience in automating security compliance using the tools that are included in RHEL to comply with both industry standard security policies and custom security policies. If you want training or access to these lab exercises for your team, contact your Red Hat account team for additional details.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/RedHatDemos/SecurityDemos/blob/master/2020Labs/RHELSecurity/documentation/README.adoc\">Red Hat Security Demos: Defend Yourself with RHEL Security Technologies\u003C/a> - A hands-on lab to learn how to implement security at all levels of your RHEL system, using the key security technologies available to you in RHEL, including OpenSCAP. If you want training or access to these lab exercises for your team, contact your Red Hat account team for additional details.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://scap.nist.gov/\">National Institute of Standards and Technology (NIST) SCAP page\u003C/a> has a vast collection of SCAP-related materials, including SCAP publications, specifications, and the SCAP Validation Program.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://nvd.nist.gov/\">National Vulnerability Database (NVD)\u003C/a> has the largest repository of SCAP content and other SCAP standards-based vulnerability management data.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://www.redhat.com/security/data/oval/\">Red Hat OVAL content repository\u003C/a> contains OVAL definitions for vulnerabilities of RHEL systems. This is the recommended source of vulnerability content.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://cve.mitre.org/\">MITRE CVE\u003C/a> - This is a database of publicly known security vulnerabilities provided by the MITRE corporation. For RHEL, using OVAL CVE content provided by Red Hat is recommended.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://oval.mitre.org/\">MITRE OVAL\u003C/a> - This is an OVAL-related project provided by the MITRE corporation. Among other OVAL-related information, these pages contain the OVAL language and a repository of OVAL content with thousands of OVAL definitions. Note that for scanning RHEL, using OVAL CVE content provided by Red Hat is recommended.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_satellite/6.15/html/managing_security_compliance/index\">Managing security compliance in Red Hat Satellite\u003C/a> - This set of guides describes, among other topics, how to maintain system security on multiple systems by using OpenSCAP.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_ensuring-system-integrity-with-keylime_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 7. Ensuring system integrity with Keylime\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tWith Keylime, you can continuously monitor the integrity of remote systems and verify the state of systems at boot. You can also send encrypted files to the monitored systems, and specify automated actions triggered whenever a monitored system fails the integrity test.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.1. How Keylime works\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure Keylime agents to perform one or more of the following actions:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Runtime integrity monitoring\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tKeylime runtime integrity monitoring continuously monitors the system on which the agent is deployed and measures the integrity of the files included in the allowlist and not included in the excludelist.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Measured boot\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tKeylime measured boot verifies the system state at boot.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tKeylime’s concept of trust is based on the Trusted Platform Module (TPM) technology. A TPM is a hardware, firmware, or virtual component with integrated cryptographic keys. By polling TPM quotes and comparing the hashes of objects, Keylime provides initial and runtime monitoring of remote systems.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tKeylime running in a virtual machine or using a virtual TPM depends upon the integrity of the underlying host. Ensure you trust the host environment before relying upon Keylime measurements in a virtual environment.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tKeylime consists of three main components:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Verifier\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tInitially and continuously verifies the integrity of the systems that run the agent. You can deploy the verifier from a package, as a container, or by usign the \u003Ccode class=\"literal\">keylime_server\u003C/code> RHEL system role.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Registrar\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tContains a database of all agents and it hosts the public keys of the TPM vendors. You can deploy the registrar from a package, as a container, or by usign the \u003Ccode class=\"literal\">keylime_server\u003C/code> RHEL system role.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Agent\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDeployed to remote systems measured by the verifier.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tIn addition, Keylime uses the \u003Ccode class=\"literal\">keylime_tenant\u003C/code> utility for many functions, including provisioning the agents on the target systems.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"idm140081371716128\">\u003Cp class=\"title\">\u003Cstrong>Figure 7.1. Connections between Keylime components through configurations\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/100eed5bc2bbc3a8b24265dda8d072f6/sec-keylime_conf_connections.png\" alt=\"The Keylime components are connected through their configuration options.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tKeylime ensures the integrity of the monitored systems in a chain of trust by using keys and certificates exchanged between the components and the tenant. For a secure foundation of this chain, use a certificate authority (CA) that you can trust.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf the agent receives no key and certificate, it generates a key and a self-signed certificate with no involvement from the CA.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"figure\" id=\"idm140081370442144\">\u003Cp class=\"title\">\u003Cstrong>Figure 7.2. Connections between Keylime components certificates and keys\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/e695e1a133c9234d5df07fbf5fc912c5/sec-keylime_cert_connections.png\" alt=\"The Keylime components are connected through the keys and certificates.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.2. Deploying Keylime verifier from a package\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe verifier is the most important component in Keylime. It performs initial and periodic checks of system integrity and supports bootstrapping a cryptographic key securely with the agent. The verifier uses mutual TLS encryption for its control interface.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo maintain the chain of trust, keep the system that runs the verifier secure and under your control.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tYou can install the verifier on a separate system or on the same system as the Keylime registrar, depending on your requirements. Running the verifier and registrar on separate systems provides better performance.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo keep the configuration files organized within the drop-in directories, use file names with a two-digit number prefix, for example \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/00-verifier-ip.conf\u003C/code>. The configuration processing reads the files inside the drop-in directory in lexicographic order and sets each option to the last value it reads.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> permissions and network connection to the system or systems on which you want to install Keylime components.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have valid keys and certificates from your certificate authority.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: You have access to the databases where Keylime saves data from the verifier. You can use any of the following database management systems:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSQLite (default)\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tPostgreSQL\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMySQL\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMariaDB\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the Keylime verifier:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install keylime-verifier\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine the IP address and port of verifier by creating a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/00-verifier-ip.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">\u003Cspan class=\"strong strong\">\u003Cstrong>[verifier]\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>ip = \u003Cspan class=\"emphasis\">\u003Cem>&lt;verifier_IP_address&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;verifier_IP_address&gt;\u003C/em>\u003C/span>\u003C/code> with the verifier’s IP address. Alternatively, use \u003Ccode class=\"literal\">ip = *\u003C/code> or \u003Ccode class=\"literal\">ip = 0.0.0.0\u003C/code> to bind the verifier to all available IP addresses.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, you can also change the verifier’s port from the default value \u003Ccode class=\"literal\">8881\u003C/code> by using the \u003Ccode class=\"literal\">port\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Configure the verifier’s database for the list of agents. The default configuration uses an SQLite database in the verifier’s \u003Ccode class=\"literal\">/var/lib/keylime/cv_data.sqlite/\u003C/code> directory. You can define a different database by creating a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/00-db-url.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[verifier]\ndatabase_url = \u003Cspan class=\"emphasis\">\u003Cem>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;\u003C/em>\u003C/span>\u003C/code> with the URL of the database, for example, \u003Ccode class=\"literal\">postgresql://verifier:UQ?nRNY9g7GZzN7@198.51.100.1/verifierdb\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnsure that the credentials you use provide the permissions for Keylime to create the database structure.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd certificates and keys to the verifier. You can either let Keylime generate them, or use existing keys and certificates:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tWith the default \u003Ccode class=\"literal\">tls_dir = generate\u003C/code> option, Keylime generates new certificates for the verifier, registrar, and tenant in the \u003Ccode class=\"literal\">/var/lib/keylime/cv_ca/\u003C/code> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo load existing keys and certificates in the configuration, define their location in the verifier configuration. The certificates must be accessible by the \u003Ccode class=\"literal\">keylime\u003C/code> user, under which the Keylime services are running.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/00-keys-and-certs.conf\u003C/code>, with the following content:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[verifier]\ntls_dir = /var/lib/keylime/cv_ca\nserver_key = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/server_key&gt;\u003C/em>\u003C/span>\nserver_key_password = \u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase1&gt;\u003C/em>\u003C/span>\nserver_cert = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/server_cert&gt;\u003C/em>\u003C/span>\ntrusted_client_ca = ['\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert1&gt;\u003C/em>\u003C/span>', '\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert2&gt;\u003C/em>\u003C/span>']\nclient_key = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/client_key&gt;\u003C/em>\u003C/span>\nclient_key_password = \u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase2&gt;\u003C/em>\u003C/span>\nclient_cert = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/client_cert&gt;\u003C/em>\u003C/span>\ntrusted_server_ca = ['\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert3&gt;\u003C/em>\u003C/span>', '\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert4&gt;\u003C/em>\u003C/span>']\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tUse absolute paths to define key and certificate locations. Alternatively, relative paths are resolved from the directory defined in the \u003Ccode class=\"literal\">tls_dir\u003C/code> option.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the port in firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-port 8881/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you use a different port, replace \u003Ccode class=\"literal\">8881\u003C/code> with the port number defined in the \u003Ccode class=\"literal\">.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the verifier service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now keylime_verifier\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIn the default configuration, start the \u003Ccode class=\"literal\">keylime_verifier\u003C/code> before starting the \u003Ccode class=\"literal\">keylime_registrar\u003C/code> service because the verifier creates the CA and certificates for the other Keylime components. This order is not necessary when you use custom certificates.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">keylime_verifier\u003C/code> service is active and running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status keylime_verifier\u003C/strong>\u003C/span>\n● keylime_verifier.service - The Keylime verifier\n     Loaded: loaded (/usr/lib/systemd/system/keylime_verifier.service; disabled; vendor preset: disabled)\n     Active: active (running) since Wed 2022-11-09 10:10:08 EST; 1min 45s ago\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"xref\" href=\"#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime\" title=\"7.4. Deploying Keylime registrar from a package\">Section 7.4, “Deploying Keylime registrar from a package”\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-keylime-verifier-as-a-container_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.3. Deploying Keylime verifier as a container\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Keylime verifier performs initial and periodic checks of system integrity and supports bootstrapping a cryptographic key securely with the agent. You can configure the Keylime verifier as a container instead of the RPM method, without any binaries or packages on the host. The container deployment provides better isolation, modularity, and reproducibility of Keylime components.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAfter you start the container, the Keylime verifier is deployed with default configuration files. You can customize the configuration by using one or more of following methods:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMounting the host’s directories that contain the configuration files to the container. This is available in all versions of RHEL 9.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tModifying the environment variables directly on the container. This is available in RHEL 9.3 and later versions. Modifying the environment variables overrides the values from the configuration files.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">podman\u003C/code> package and its dependencies are installed on the system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: You have access to a database where Keylime saves data from the verifier. You can use any of the following database management systems:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSQLite (default)\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tPostgreSQL\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMySQL\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMariaDB\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have valid keys and certificates from your certificate authority.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Install the \u003Ccode class=\"literal\">keylime-verifier\u003C/code> package to access the configuration files. You can configure the container without this package, but it might be easier to modify the configuration files provided with the package.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install keylime-verifier\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBind the verifier to all available IP addresses by creating a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/00-verifier-ip.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[verifier]\nip = *\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, you can also change the verifier’s port from the default value \u003Ccode class=\"literal\">8881\u003C/code> by using the \u003Ccode class=\"literal\">port\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Configure the verifier’s database for the list of agents. The default configuration uses an SQLite database in the verifier’s \u003Ccode class=\"literal\">/var/lib/keylime/cv_data.sqlite/\u003C/code> directory. You can define a different database by creating a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/00-db-url.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[verifier]\ndatabase_url = \u003Cspan class=\"emphasis\">\u003Cem>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;\u003C/em>\u003C/span>\u003C/code> with the URL of the database, for example, \u003Ccode class=\"literal\">postgresql://verifier:UQ?nRNY9g7GZzN7@198.51.100.1/verifierdb\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnsure that the credentials you use have the permissions for Keylime to create the database structure.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd certificates and keys to the verifier. You can either let Keylime generate them, or use existing keys and certificates:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tWith the default \u003Ccode class=\"literal\">tls_dir = generate\u003C/code> option, Keylime generates new certificates for the verifier, registrar, and tenant in the \u003Ccode class=\"literal\">/var/lib/keylime/cv_ca/\u003C/code> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo load existing keys and certificates in the configuration, define their location in the verifier configuration. The certificates must be accessible by the \u003Ccode class=\"literal\">keylime\u003C/code> user, under which the Keylime processes are running.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/verifier.conf.d/00-keys-and-certs.conf\u003C/code>, with the following content:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[verifier]\ntls_dir = /var/lib/keylime/cv_ca\nserver_key = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/server_key&gt;\u003C/em>\u003C/span>\nserver_cert = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/server_cert&gt;\u003C/em>\u003C/span>\ntrusted_client_ca = ['\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert1&gt;\u003C/em>\u003C/span>', '\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert2&gt;\u003C/em>\u003C/span>']\nclient_key = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/client_key&gt;\u003C/em>\u003C/span>\nclient_cert = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/client_cert&gt;\u003C/em>\u003C/span>\ntrusted_server_ca = ['\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert3&gt;\u003C/em>\u003C/span>', '\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert4&gt;\u003C/em>\u003C/span>']\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tUse absolute paths to define key and certificate locations. Alternatively, relative paths are resolved from the directory defined in the \u003Ccode class=\"literal\">tls_dir\u003C/code> option.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the port in firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-port 8881/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you use a different port, replace \u003Ccode class=\"literal\">8881\u003C/code> with the port number defined in the \u003Ccode class=\"literal\">.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the container:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>podman run --name keylime-verifier \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-p 8881:8881 \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-v /etc/keylime/verifier.conf.d:/etc/keylime/verifier.conf.d:Z \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-v /var/lib/keylime/cv_ca:/var/lib/keylime/cv_ca:Z \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-d \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-e KEYLIME_VERIFIER_SERVER_KEY_PASSWORD=\u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase1&gt;\u003C/em>\u003C/span> \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-e KEYLIME_VERIFIER_CLIENT_KEY_PASSWORD=\u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase2&gt;\u003C/em>\u003C/span> \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>registry.access.redhat.com/rhel9/keylime-verifier\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-p\u003C/code> option opens the default port \u003Ccode class=\"literal\">8881\u003C/code> on the host and on the container.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-v\u003C/code> option creates a bind mount for the directory to the container.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tWith the \u003Ccode class=\"literal\">Z\u003C/code> option, Podman marks the content with a private unshared label. This means only the current container can use the private volume.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-d\u003C/code> option runs the container detached and in the background.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe option \u003Ccode class=\"literal\">-e KEYLIME_VERIFIER_SERVER_KEY_PASSWORD=\u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase1&gt;\u003C/em>\u003C/span>\u003C/code> defines the server key passphrase.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe option \u003Ccode class=\"literal\">-e KEYLIME_VERIFIER_CLIENT_KEY_PASSWORD=\u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase2&gt;\u003C/em>\u003C/span>\u003C/code> defines the client key passphrase.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can override configuration options with environment variables by using the option \u003Ccode class=\"literal\">-e KEYLIME_VERIFIER\u003Cspan class=\"emphasis\">\u003Cem>_&lt;ENVIRONMENT_VARIABLE&gt;\u003C/em>\u003C/span>=\u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>. To modify additional options, insert the \u003Ccode class=\"literal\">-e\u003C/code> option separately for each environment variable. For a complete list of environment variables and their default values, see \u003Ca class=\"link\" href=\"#keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime\" title=\"7.12. Keylime environment variables\">Keylime environment variables\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the container is running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>podman ps -a\u003C/strong>\u003C/span>\nCONTAINER ID  IMAGE                                                     COMMAND           CREATED         STATUS         PORTS                   NAMES\n80b6b9dbf57c  registry.access.redhat.com/rhel9/keylime-verifier:latest  keylime_verifier  14 seconds ago  Up 14 seconds  0.0.0.0:8881-&gt;8881/tcp  keylime-verifier\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-keylime-registrar-as-a-container_assembly_ensuring-system-integrity-with-keylime\" title=\"7.5. Deploying Keylime registrar as a container\">Install the Keylime registrar as a container\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about Keylime components, see \u003Ca class=\"link\" href=\"#con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime\" title=\"7.1. How Keylime works\">How Keylime works\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about configuring the Keylime verifier, see \u003Ca class=\"link\" href=\"#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime\" title=\"7.2. Deploying Keylime verifier from a package\">Configuring Keylime verifier\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about the \u003Ccode class=\"literal\">podman run\u003C/code> command, see the \u003Ccode class=\"literal\">podman-run(1)\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.4. Deploying Keylime registrar from a package\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe registrar is the Keylime component that contains a database of all agents, and it hosts the public keys of the TPM vendors. After the registrar’s HTTPS service accepts trusted platform module (TPM) public keys, it presents an interface to obtain these public keys for checking quotes.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo maintain the chain of trust, keep the system that runs the registrar secure and under your control.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tYou can install the registrar on a separate system or on the same system as the Keylime verifier, depending on your requirements. Running the verifier and registrar on separate systems provides better performance.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo keep the configuration files organized within the drop-in directories, use file names with a two-digit number prefix, for example \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/00-registrar-ip.conf\u003C/code>. The configuration processing reads the files inside the drop-in directory in lexicographic order and sets each option to the last value it reads.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have network access to the systems where the Keylime verifier is installed and running. For more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime\" title=\"7.2. Deploying Keylime verifier from a package\">Section 7.2, “Deploying Keylime verifier from a package”\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> permissions and network connection to the system or systems on which you want to install Keylime components.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have access to the database where Keylime saves data from the registrar. You can use any of the following database management systems:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSQLite (default)\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tPostgreSQL\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMySQL\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMariaDB\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have valid keys and certificates from your certificate authority.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the Keylime registrar:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install keylime-registrar\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine the IP address and port of the registrar by creating a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/00-registrar-ip.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[registrar]\nip = \u003Cspan class=\"emphasis\">\u003Cem>&lt;registrar_IP_address&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;registrar_IP_address&gt;\u003C/em>\u003C/span>\u003C/code> with the registrar’s IP address. Alternatively, use \u003Ccode class=\"literal\">ip = *\u003C/code> or \u003Ccode class=\"literal\">ip = 0.0.0.0\u003C/code> to bind the registrar to all available IP addresses.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, change the port to which the Keylime agents connect by using the \u003Ccode class=\"literal\">port\u003C/code> option. The default value is \u003Ccode class=\"literal\">8890\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, change the TLS port to which the Keylime verifier and tenant connect by using the \u003Ccode class=\"literal\">tls_port\u003C/code> option. The default value is \u003Ccode class=\"literal\">8891\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Configure the registrar’s database for the list of agents. The default configuration uses an SQLite database in the registrar’s \u003Ccode class=\"literal\">/var/lib/keylime/reg_data.sqlite\u003C/code> directory. You can create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/00-db-url.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[registrar]\ndatabase_url = \u003Cspan class=\"emphasis\">\u003Cem>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;\u003C/em>\u003C/span>\u003C/code> with the URL of the database, for example, \u003Ccode class=\"literal\">postgresql://registrar:EKYYX-bqY2?#raXm@198.51.100.1/registrardb\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnsure that the credentials you use have the permissions for Keylime to create the database structure.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd certificates and keys to the registrar:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can use the default configuration and load the keys and certificates to the \u003Ccode class=\"literal\">/var/lib/keylime/reg_ca/\u003C/code> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAlternatively, you can define the location of the keys and certificates in the configuration. Create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/00-keys-and-certs.conf\u003C/code>, with the following content:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[registrar]\ntls_dir = /var/lib/keylime/reg_ca\nserver_key = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/server_key&gt;\u003C/em>\u003C/span>\nserver_key_password = \u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase1&gt;\u003C/em>\u003C/span>\nserver_cert = \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/server_cert&gt;\u003C/em>\u003C/span>\ntrusted_client_ca = ['\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert1&gt;\u003C/em>\u003C/span>', '\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert2&gt;\u003C/em>\u003C/span>']\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tUse absolute paths to define key and certificate locations. Alternatively, you can define a directory in the \u003Ccode class=\"literal\">tls_dir\u003C/code> option and use paths relative to that directory.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the ports in firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-port 8890/tcp --add-port 8891/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you use a different port, replace \u003Ccode class=\"literal\">8890\u003C/code> or \u003Ccode class=\"literal\">8891\u003C/code> with the port number defined in the \u003Ccode class=\"literal\">.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">keylime_registrar\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now keylime_registrar\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIn the default configuration, start the \u003Ccode class=\"literal\">keylime_verifier\u003C/code> before starting the \u003Ccode class=\"literal\">keylime_registrar\u003C/code> service because the verifier creates the CA and certificates for the other Keylime components. This order is not necessary when you use custom certificates.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">keylime_registrar\u003C/code> service is active and running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status keylime_registrar\u003C/strong>\u003C/span>\n● keylime_registrar.service - The Keylime registrar service\n     Loaded: loaded (/usr/lib/systemd/system/keylime_registrar.service; disabled; vendor preset: disabled)\n     Active: active (running) since Wed 2022-11-09 10:10:17 EST; 1min 42s ago\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"xref\" href=\"#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime\" title=\"7.8. Deploying Keylime tenant from a package\">Section 7.8, “Deploying Keylime tenant from a package”\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-keylime-registrar-as-a-container_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.5. Deploying Keylime registrar as a container\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe registrar is the Keylime component that contains a database of all agents, and it hosts the public keys of the trusted platform module (TPM) vendors. After the registrar’s HTTPS service accepts TPM public keys, it presents an interface to obtain these public keys for checking quotes. You can configure the Keylime registrar as a container instead of the RPM method, without any binaries or packages on the host. The container deployment provides better isolation, modularity, and reproducibility of Keylime components.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAfter you start the container, the Keylime registrar is deployed with default configuration files. You can customize the configuration by using one or more of following methods:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMounting the host’s directories that contain the configuration files to the container. This is available in all versions of RHEL 9.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tModifying the environment variables directly on the container. This is available in RHEL 9.3 and later versions. Modifying the environment variables overrides the values from the configuration files.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">podman\u003C/code> package and its dependencies are installed on the system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: You have access to a database where Keylime saves data from the registrar. You can use any of the following database management systems:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSQLite (default)\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tPostgreSQL\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMySQL\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMariaDB\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have valid keys and certificates from your certificate authority.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Install the \u003Ccode class=\"literal\">keylime-registrar\u003C/code> package to access the configuration files. You can configure the container without this package, but it might be easier to modify the configuration files provided with the package.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install keylime-registrar\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBind the registrar to all available IP addresses by creating a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/00-registrar-ip.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[registrar]\nip = *\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, change the port to which the Keylime agents connect by using the \u003Ccode class=\"literal\">port\u003C/code> option. The default value is \u003Ccode class=\"literal\">8890\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, change the TLS port to which the Keylime tenant connects by using the \u003Ccode class=\"literal\">tls_port\u003C/code> option. The default value is \u003Ccode class=\"literal\">8891\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Configure the registrar’s database for the list of agents. The default configuration uses an SQLite database in the registrar’s \u003Ccode class=\"literal\">/var/lib/keylime/reg_data.sqlite\u003C/code> directory. You can create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/00-db-url.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[registrar]\ndatabase_url = \u003Cspan class=\"emphasis\">\u003Cem>&amp;lt;protocol&amp;gt;://&amp;lt;name&amp;gt;:&amp;lt;password&amp;gt;@&amp;lt;ip_address_or_hostname&amp;gt;/&amp;lt;properties&amp;gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;protocol&gt;://&lt;name&gt;:&lt;password&gt;@&lt;ip_address_or_hostname&gt;/&lt;properties&gt;\u003C/em>\u003C/span>\u003C/code> with the URL of the database, for example, \u003Ccode class=\"literal\">postgresql://registrar:EKYYX-bqY2?#raXm@198.51.100.1/registrardb\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnsure that the credentials you use have the permissions for Keylime to create the database structure.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd certificates and keys to the registrar:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can use the default configuration and load the keys and certificates to the \u003Ccode class=\"literal\">/var/lib/keylime/reg_ca/\u003C/code> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAlternatively, you can define the location of the keys and certificates in the configuration. Create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/registrar.conf.d/00-keys-and-certs.conf\u003C/code>, with the following content:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[registrar]\ntls_dir = /var/lib/keylime/reg_ca\nserver_key = \u003Cspan class=\"emphasis\">\u003Cem>&amp;lt;/path/to/server_key&amp;gt;\u003C/em>\u003C/span>\nserver_cert = \u003Cspan class=\"emphasis\">\u003Cem>&amp;lt;/path/to/server_cert&amp;gt;\u003C/em>\u003C/span>\ntrusted_client_ca = ['\u003Cspan class=\"emphasis\">\u003Cem>&amp;lt;/path/to/ca/cert1&amp;gt;\u003C/em>\u003C/span>', '\u003Cspan class=\"emphasis\">\u003Cem>&amp;lt;/path/to/ca/cert2&amp;gt;\u003C/em>\u003C/span>']\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tUse absolute paths to define key and certificate locations. Alternatively, you can define a directory in the \u003Ccode class=\"literal\">tls_dir\u003C/code> option and use paths relative to that directory.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the ports in firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-port 8890/tcp --add-port 8891/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you use a different port, replace \u003Ccode class=\"literal\">8890\u003C/code> or \u003Ccode class=\"literal\">8891\u003C/code> with the port number defined in the \u003Ccode class=\"literal\">.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the container:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>podman run --name keylime-registrar \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-p 8890:8890 \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-p 8891:8891 \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-v /etc/keylime/registrar.conf.d:/etc/keylime/registrar.conf.d:Z \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-v /var/lib/keylime/reg_ca:/var/lib/keylime/reg_ca:Z \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-d \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>-e KEYLIME_REGISTRAR_SERVER_KEY_PASSWORD=\u003Cspan class=\"emphasis\">\u003Cem>&amp;lt;passphrase1&amp;gt;\u003C/em>\u003C/span> \\\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>registry.access.redhat.com/rhel9/keylime-registrar\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-p\u003C/code> option opens the default ports \u003Ccode class=\"literal\">8890\u003C/code> and \u003Ccode class=\"literal\">8881\u003C/code> on the host and on the container.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-v\u003C/code> option creates a bind mount for the directory to the container.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tWith the \u003Ccode class=\"literal\">Z\u003C/code> option, Podman marks the content with a private unshared label. This means only the current container can use the private volume.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-d\u003C/code> option runs the container detached and in the background.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe option \u003Ccode class=\"literal\">-e KEYLIME_VERIFIER_SERVER_KEY_PASSWORD=\u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase1&gt;\u003C/em>\u003C/span>\u003C/code> defines the server key passphrase.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can override configuration options with environment variables by using the option \u003Ccode class=\"literal\">-e KEYLIME_REGISTRAR\u003Cspan class=\"emphasis\">\u003Cem>_&lt;ENVIRONMENT_VARIABLE&gt;\u003C/em>\u003C/span>=\u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>. To modify additional options, insert the \u003Ccode class=\"literal\">-e\u003C/code> option separately for each environment variable. For a complete list of environment variables and their default values, see \u003Ca class=\"xref\" href=\"#keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime\" title=\"7.12. Keylime environment variables\">Section 7.12, “Keylime environment variables”\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the container is running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>podman ps -a\u003C/strong>\u003C/span>\nCONTAINER ID  IMAGE                               COMMAND            CREATED             STATUS             PORTS                                           NAMES\n07d4b4bff1b6  localhost/keylime-registrar:latest  keylime_registrar  12 seconds ago      Up 12 seconds      0.0.0.0:8881-&gt;8881/tcp, 0.0.0.0:8891-&gt;8891/tcp  keylime-registrar\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"xref\" href=\"#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime\" title=\"7.8. Deploying Keylime tenant from a package\">Section 7.8, “Deploying Keylime tenant from a package”\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about Keylime components, see \u003Ca class=\"xref\" href=\"#con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime\" title=\"7.1. How Keylime works\">Section 7.1, “How Keylime works”\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about configuring the Keylime registrar, see \u003Ca class=\"xref\" href=\"#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime\" title=\"7.4. Deploying Keylime registrar from a package\">Section 7.4, “Deploying Keylime registrar from a package”\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about the \u003Ccode class=\"literal\">podman run\u003C/code> command, see the \u003Ccode class=\"literal\">podman-run(1)\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_setting-keylime-server-using-system-roles_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.6. Deploying a Keylime server by using RHEL system roles\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can set up the verifier and registrar, which are the Keylime server components, by using the \u003Ccode class=\"literal\">keylime_server\u003C/code> RHEL system role. The \u003Ccode class=\"literal\">keylime_server\u003C/code> role installs and configures both the verifier and registrar components together on each node.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tPerform this procedure on the Ansible control node.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor more information about Keylime, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/assembly_ensuring-system-integrity-with-keylime_security-hardening#con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime\">8.1. How Keylime works\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed nodes or groups of managed nodes on which you want to run this playbook are listed in the Ansible inventory file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook that defines the required role:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a new YAML file and open it in a text editor, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi keylime-playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInsert the following content:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">---\n- name: Manage keylime servers\n  hosts: all\n  vars:\n    keylime_server_verifier_ip: \"{{ ansible_host }}\"\n    keylime_server_registrar_ip: \"{{ ansible_host }}\"\n    keylime_server_verifier_tls_dir: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_tls_directory\u003C/em>\u003C/span>&gt;\n    keylime_server_verifier_server_cert: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_server_certfile\u003C/em>\u003C/span>&gt;\n    keylime_server_verifier_server_key: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_server_key\u003C/em>\u003C/span>&gt;\n    keylime_server_verifier_server_key_passphrase: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_server_key_passphrase\u003C/em>\u003C/span>&gt;\n    keylime_server_verifier_trusted_client_ca: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_trusted_client_ca_list\u003C/em>\u003C/span>&gt;\n    keylime_server_verifier_client_cert: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_client_certfile\u003C/em>\u003C/span>&gt;\n    keylime_server_verifier_client_key: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_client_key\u003C/em>\u003C/span>&gt;\n    keylime_server_verifier_client_key_passphrase: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_client_key_passphrase\u003C/em>\u003C/span>&gt;\n    keylime_server_verifier_trusted_server_ca: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ver_trusted_server_ca_list\u003C/em>\u003C/span>&gt;\n    keylime_server_registrar_tls_dir: \u003Cspan class=\"emphasis\">\u003Cem>&lt;reg_tls_directory\u003C/em>\u003C/span>&gt;\n    keylime_server_registrar_server_cert: \u003Cspan class=\"emphasis\">\u003Cem>&lt;reg_server_certfile\u003C/em>\u003C/span>&gt;\n    keylime_server_registrar_server_key: \u003Cspan class=\"emphasis\">\u003Cem>&lt;reg_server_key\u003C/em>\u003C/span>&gt;\n    keylime_server_registrar_server_key_passphrase: \u003Cspan class=\"emphasis\">\u003Cem>&lt;reg_server_key_passphrase\u003C/em>\u003C/span>&gt;\n    keylime_server_registrar_trusted_client_ca: \u003Cspan class=\"emphasis\">\u003Cem>&lt;reg_trusted_client_ca_list\u003C/em>\u003C/span>&gt;\n  roles:\n    - rhel-system-roles.keylime_server\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tYou can find out more about the variables in \u003Ca class=\"link\" href=\"#ref_variables-for-keylime-server-system-role_assembly_ensuring-system-integrity-with-keylime\" title=\"7.7. Variables for the keylime_server RHEL system role\">Variables for the keylime_server RHEL system role\u003C/a>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook \u003Cspan class=\"emphasis\">\u003Cem>&lt;keylime-playbook.yml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">keylime_verifier\u003C/code> service is active and running on the managed host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status keylime_verifier\u003C/strong>\u003C/span>\n● keylime_verifier.service - The Keylime verifier\n     Loaded: loaded (/usr/lib/systemd/system/keylime_verifier.service; disabled; vendor preset: disabled)\n     Active: active (running) since Wed 2022-11-09 10:10:08 EST; 1min 45s ago\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">keylime_registrar\u003C/code> service is active and running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status keylime_registrar\u003C/strong>\u003C/span>\n● keylime_registrar.service - The Keylime registrar service\n     Loaded: loaded (/usr/lib/systemd/system/keylime_registrar.service; disabled; vendor preset: disabled)\n     Active: active (running) since Wed 2022-11-09 10:10:17 EST; 1min 42s ago\n...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Ca class=\"xref\" href=\"#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime\" title=\"7.8. Deploying Keylime tenant from a package\">Section 7.8, “Deploying Keylime tenant from a package”\u003C/a>\n\t\t\t\t\u003C/p>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_variables-for-keylime-server-system-role_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.7. Variables for the keylime_server RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen setting up a Keylime server by using the \u003Ccode class=\"literal\">keylime_server\u003C/code> RHEL system role, you can customize the following variables for registrar and verifier.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cp class=\"title\">\u003Cstrong>List of \u003Ccode class=\"literal\">keylime_server\u003C/code> RHEL system role variables for configuring the Keylime verifier\u003C/strong>\u003C/p>\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_verifier_ip\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the IP address of the verifier.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_verifier_tls_dir\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the directory where the keys and certificates are stored. If set to default, the verifier uses the \u003Ccode class=\"literal\">/var/lib/keylime/cv_ca\u003C/code> directory.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_verifier_server_key_passphrase\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies a passphrase to decrypt the server private key. If the value is empty, the private key is not encrypted.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\t\u003Ccode class=\"literal\">keylime_server_verifier_server_cert\u003C/code>: Specifies the Keylime verifier server certificate file.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_verifier_trusted_client_ca\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the list of trusted client CA certificates. You must store the files in the directory set in the \u003Ccode class=\"literal\">keylime_server_verifier_tls_dir\u003C/code> option.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_verifier_client_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the file containing the Keylime verifier private client key.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_verifier_client_key_passphrase\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the passphrase to decrypt the client private key file. If the value is empty, the private key is not encrypted.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_verifier_client_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the Keylime verifier client certificate file.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_verifier_trusted_server_ca\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the list of trusted server CA certificates. You must store the files in the directory set in the \u003Ccode class=\"literal\">keylime_server_verifier_tls_dir\u003C/code> option.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cp class=\"title\">\u003Cstrong>List of registrar variables for setting up keylime_server RHEL system role\u003C/strong>\u003C/p>\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_registrar_ip\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the IP address of the registrar.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_registrar_tls_dir\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the directory where you store the keys and certificates for the registrar. If you set it to default, the registrar uses the \u003Ccode class=\"literal\">/var/lib/keylime/reg_ca\u003C/code> directory.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_registrar_server_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the Keylime registrar private server key file.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_registrar_server_key_passphrase\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the passphrase to decrypt the server private key of the registrar. If the value is empty, the private key is not encrypted.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_registrar_server_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the Keylime registrar server certificate file.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">keylime_server_registrar_trusted_client_ca\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the list of trusted client CA certificates. You must store the files in the directory set in the \u003Ccode class=\"literal\">keylime_server_registrar_tls_dir\u003C/code> option.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.8. Deploying Keylime tenant from a package\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tKeylime uses the \u003Ccode class=\"literal\">keylime_tenant\u003C/code> utility for many functions, including provisioning the agents on the target systems. You can install \u003Ccode class=\"literal\">keylime_tenant\u003C/code> on any system, including the systems that run other Keylime components, or on a separate system, depending on your requirements.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> permissions and network connection to the system or systems on which you want to install Keylime components.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have network access to the systems where the other Keylime components are configured:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Verifier\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime\" title=\"7.2. Deploying Keylime verifier from a package\">Section 7.2, “Deploying Keylime verifier from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Registrar\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime\" title=\"7.4. Deploying Keylime registrar from a package\">Section 7.4, “Deploying Keylime registrar from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the Keylime tenant:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install keylime-tenant\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine the tenant’s connection to the Keylime verifier by editing the \u003Ccode class=\"literal\">/etc/keylime/tenant.conf.d/00-verifier-ip.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[tenant]\nverifier_ip = \u003Cspan class=\"emphasis\">\u003Cem>&lt;verifier_ip&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;verifier_ip&gt;\u003C/em>\u003C/span>\u003C/code> with the IP address to the verifier’s system.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf the verifier uses a different port than the default value \u003Ccode class=\"literal\">8881\u003C/code>, add the \u003Ccode class=\"literal\">verifier_port = \u003Cspan class=\"emphasis\">\u003Cem>&lt;verifier_port&gt;\u003C/em>\u003C/span>\u003C/code> setting.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine the tenant’s connection to the Keylime registrar by editing the \u003Ccode class=\"literal\">/etc/keylime/tenant.conf.d/00-registrar-ip.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[tenant]\nregistrar_ip = \u003Cspan class=\"emphasis\">\u003Cem>&lt;registrar_ip&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;registrar_ip&gt;\u003C/em>\u003C/span>\u003C/code> with the IP address to the registrar’s system.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf the registrar uses a different port than the default value \u003Ccode class=\"literal\">8891\u003C/code>, add the \u003Ccode class=\"literal\">registrar_port = \u003Cspan class=\"emphasis\">\u003Cem>&lt;registrar_port&gt;\u003C/em>\u003C/span>\u003C/code> setting.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd certificates and keys to the tenant:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can use the default configuration and load the keys and certificates to the \u003Ccode class=\"literal\">/var/lib/keylime/cv_ca\u003C/code> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAlternatively, you can define the location of the keys and certificates in the configuration. Create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/tenant.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/tenant.conf.d/00-keys-and-certs.conf\u003C/code>, with the following content:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[tenant]\ntls_dir = /var/lib/keylime/cv_ca\nclient_key = tenant-key.pem\nclient_key_password = \u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase1&gt;\u003C/em>\u003C/span>\nclient_cert = tenant-cert.pem\ntrusted_server_ca = ['\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert&gt;\u003C/em>\u003C/span>']\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">trusted_server_ca\u003C/code> parameter accepts paths to the verifier and registrar server CA certificate. You can provide multiple comma-separated paths, for example if the verifier and registrar use different CAs.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tUse absolute paths to define key and certificate locations. Alternatively, you can define a directory in the \u003Ccode class=\"literal\">tls_dir\u003C/code> option and use paths relative to that directory.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: If the trusted platform module (TPM) endorsement key (EK) cannot be verified by using certificates in the \u003Ccode class=\"literal\">/var/lib/keylime/tpm_cert_store\u003C/code> directory, add the certificate to that directory. This can occur particularly when using virtual machines with emulated TPMs.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the status of the verifier:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_tenant -c cvstatus\u003C/strong>\u003C/span>\nReading configuration from ['/etc/keylime/logging.conf']\n2022-10-14 12:56:08.155 - keylime.tpm - INFO - TPM2-TOOLS Version: 5.2\nReading configuration from ['/etc/keylime/tenant.conf']\n2022-10-14 12:56:08.157 - keylime.tenant - INFO - Setting up client TLS...\n2022-10-14 12:56:08.158 - keylime.tenant - INFO - Using default client_cert option for tenant\n2022-10-14 12:56:08.158 - keylime.tenant - INFO - Using default client_key option for tenant\n2022-10-14 12:56:08.178 - keylime.tenant - INFO - TLS is enabled.\n2022-10-14 12:56:08.178 - keylime.tenant - WARNING - Using default UUID d432fbb3-d2f1-4a97-9ef7-75bd81c00000\n2022-10-14 12:56:08.221 - keylime.tenant - INFO - Verifier at 127.0.0.1 with Port 8881 does not have agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000.\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf correctly set up, and if no agent is configured, the verifier responds that it does not recognize the default agent UUID.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the status of the registrar:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_tenant -c regstatus\u003C/strong>\u003C/span>\nReading configuration from ['/etc/keylime/logging.conf']\n2022-10-14 12:56:02.114 - keylime.tpm - INFO - TPM2-TOOLS Version: 5.2\nReading configuration from ['/etc/keylime/tenant.conf']\n2022-10-14 12:56:02.116 - keylime.tenant - INFO - Setting up client TLS...\n2022-10-14 12:56:02.116 - keylime.tenant - INFO - Using default client_cert option for tenant\n2022-10-14 12:56:02.116 - keylime.tenant - INFO - Using default client_key option for tenant\n2022-10-14 12:56:02.137 - keylime.tenant - INFO - TLS is enabled.\n2022-10-14 12:56:02.137 - keylime.tenant - WARNING - Using default UUID d432fbb3-d2f1-4a97-9ef7-75bd81c00000\n2022-10-14 12:56:02.171 - keylime.registrar_client - CRITICAL - Error: could not get agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000 data from Registrar Server: 404\n2022-10-14 12:56:02.172 - keylime.registrar_client - CRITICAL - Response code 404: agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000 not found\n2022-10-14 12:56:02.172 - keylime.tenant - INFO - Agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000 does not exist on the registrar. Please register the agent with the registrar.\n2022-10-14 12:56:02.172 - keylime.tenant - INFO - {\"code\": 404, \"status\": \"Agent d432fbb3-d2f1-4a97-9ef7-75bd81c00000 does not exist on registrar 127.0.0.1 port 8891.\", \"results\": {}}\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf correctly set up, and if no agent is configured, the registrar responds that it does not recognize the default agent UUID.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor additional advanced options for the \u003Ccode class=\"literal\">keylime_tenant\u003C/code> utility, enter the \u003Ccode class=\"literal\">keylime_tenant -h\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.9. Deploying Keylime agent from a package\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Keylime agent is the component deployed to all systems to be monitored by Keylime.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy default, the Keylime agent stores all its data in the \u003Ccode class=\"literal\">/var/lib/keylime/\u003C/code> directory of the monitored system.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo keep the configuration files organized within the drop-in directories, use file names with a two-digit number prefix, for example \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/00-registrar-ip.conf\u003C/code>. The configuration processing reads the files inside the drop-in directory in lexicographic order and sets each option to the last value it reads.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> permissions to the monitored system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe monitored system has a Trusted Platform Module (TPM). To verify, enter the \u003Ccode class=\"literal\">tpm2_pcrread\u003C/code> command. If the output returns several hashes, a TPM is available.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have network access to the systems where the other Keylime components are configured:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Verifier\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"link\" href=\"#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime\" title=\"7.2. Deploying Keylime verifier from a package\">Configuring Keylime verifier\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Registrar\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"link\" href=\"#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime\" title=\"7.4. Deploying Keylime registrar from a package\">Configuring Keylime registrar\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Tenant\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"link\" href=\"#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime\" title=\"7.8. Deploying Keylime tenant from a package\">Configuring Keylime tenant\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIntegrity measurement architecture (IMA) is enabled on the monitored system. For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel#enabling-integrity-measurement-architecture-and-extended-verification-module_enhancing-security-with-the-kernel-integrity-subsystem\">Enabling integrity measurement architecture and extended verification module\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the Keylime agent:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install keylime-agent\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis command installs the \u003Ccode class=\"literal\">keylime-agent-rust\u003C/code> package.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine the agent’s IP address and port in the configuration files. Create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/00-agent-ip.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[agent]\nip = '\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_ip&gt;\u003C/em>\u003C/span>'\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe Keylime agent configuration uses the TOML format, which is different from the INI format used for configuration of the other components. Therefore, enter values in valid TOML syntax, for example, paths in single quotation marks and arrays of multiple paths in square brackets.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_IP_address&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s IP address. Alternatively, use \u003Ccode class=\"literal\">ip = '*'\u003C/code> or \u003Ccode class=\"literal\">ip = '0.0.0.0'\u003C/code> to bind the agent to all available IP addresses.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, you can also change the agent’s port from the default value \u003Ccode class=\"literal\">9002\u003C/code> by using the \u003Ccode class=\"literal\">port = '\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_port&gt;\u003C/em>\u003C/span>'\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine the registrar’s IP address and port in the configuration files. Create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/00-registrar-ip.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[agent]\nregistrar_ip = '\u003Cspan class=\"emphasis\">\u003Cem>&lt;registrar_IP_address&gt;\u003C/em>\u003C/span>'\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;registrar_IP_address&gt;\u003C/em>\u003C/span>\u003C/code> with the registrar’s IP address.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, you can also change the registrar’s port from the default value \u003Ccode class=\"literal\">8890\u003C/code> by using the \u003Ccode class=\"literal\">registrar_port = '\u003Cspan class=\"emphasis\">\u003Cem>&lt;registrar_port&gt;\u003C/em>\u003C/span>'\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Define the agent’s universally unique identifier (UUID). If it is not defined, the default UUID is used. Create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/00-agent-uuid.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[agent]\nuuid = '\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_UUID&gt;\u003C/em>\u003C/span>'\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_UUID&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s UUID, for example \u003Ccode class=\"literal\">d432fbb3-d2f1-4a97-9ef7-abcdef012345\u003C/code>. You can use the \u003Ccode class=\"literal\">uuidgen\u003C/code> utility to generate a UUID.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Load existing keys and certificates for the agent. If the agent receives no \u003Ccode class=\"literal\">server_key\u003C/code> and \u003Ccode class=\"literal\">server_cert\u003C/code>, it generates its own key and a self-signed certificate.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDefine the location of the keys and certificates in the configuration. Create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">/etc/keylime/agent.conf.d/00-keys-and-certs.conf\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[agent]\nserver_key = '\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/server_key&gt;\u003C/em>\u003C/span>'\nserver_key_password = '\u003Cspan class=\"emphasis\">\u003Cem>&lt;passphrase1&gt;\u003C/em>\u003C/span>'\nserver_cert = '\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/server_cert&gt;\u003C/em>\u003C/span>'\ntrusted_client_ca = '[\u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert3&gt;\u003C/em>\u003C/span>, \u003Cspan class=\"emphasis\">\u003Cem>&lt;/path/to/ca/cert4&gt;\u003C/em>\u003C/span>]'\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tUse absolute paths to define key and certificate locations. The Keylime agent does not accept relative paths.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the port in firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-port 9002/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you use a different port, replace \u003Ccode class=\"literal\">9002\u003C/code> with the port number defined in the \u003Ccode class=\"literal\">.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable and start the \u003Ccode class=\"literal\">keylime_agent\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now keylime_agent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: From the system where the Keylime tenant is configured, verify that the agent is correctly configured and can connect to the registrar.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_tenant -c regstatus --uuid \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nReading configuration from ['/etc/keylime/logging.conf']\n...\n==\\n-----END CERTIFICATE-----\\n\", \"ip\": \"127.0.0.1\", \"port\": 9002, \"regcount\": 1, \"operational_state\": \"Registered\"}}}\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s UUID.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the registrar and agent are correctly configured, the output displays the agent’s IP address and port, followed by \u003Ccode class=\"literal\">\"operational_state\": \"Registered\"\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new IMA policy by entering the following content into the \u003Ccode class=\"literal\">/etc/ima/ima-policy\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># PROC_SUPER_MAGIC = 0x9fa0\ndont_measure fsmagic=0x9fa0\n# SYSFS_MAGIC = 0x62656572\ndont_measure fsmagic=0x62656572\n# DEBUGFS_MAGIC = 0x64626720\ndont_measure fsmagic=0x64626720\n# TMPFS_MAGIC = 0x01021994\ndont_measure fsmagic=0x1021994\n# RAMFS_MAGIC\ndont_measure fsmagic=0x858458f6\n# DEVPTS_SUPER_MAGIC=0x1cd1\ndont_measure fsmagic=0x1cd1\n# BINFMTFS_MAGIC=0x42494e4d\ndont_measure fsmagic=0x42494e4d\n# SECURITYFS_MAGIC=0x73636673\ndont_measure fsmagic=0x73636673\n# SELINUX_MAGIC=0xf97cff8c\ndont_measure fsmagic=0xf97cff8c\n# SMACK_MAGIC=0x43415d53\ndont_measure fsmagic=0x43415d53\n# NSFS_MAGIC=0x6e736673\ndont_measure fsmagic=0x6e736673\n# EFIVARFS_MAGIC\ndont_measure fsmagic=0xde5e81e4\n# CGROUP_SUPER_MAGIC=0x27e0eb\ndont_measure fsmagic=0x27e0eb\n# CGROUP2_SUPER_MAGIC=0x63677270\ndont_measure fsmagic=0x63677270\n# OVERLAYFS_MAGIC\n# when containers are used we almost always want to ignore them\ndont_measure fsmagic=0x794c7630\n# MEASUREMENTS\nmeasure func=BPRM_CHECK\nmeasure func=FILE_MMAP mask=MAY_EXEC\nmeasure func=MODULE_CHECK uid=0\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis policy targets runtime monitoring of executed applications. You can adjust this policy according to your scenario. You can find the MAGIC constants in the \u003Ccode class=\"literal\">statfs(2)\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUpdate kernel parameters:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>grubby --update-kernel DEFAULT --args 'ima_appraise=fix ima_canonical_fmt ima_policy=tcb ima_template=ima-ng'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tReboot the system to apply the new IMA policy.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the agent is running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status keylime_agent\u003C/strong>\u003C/span>\n● keylime_agent.service - The Keylime compute agent\n     Loaded: loaded (/usr/lib/systemd/system/keylime_agent.service; enabled; preset: disabled)\n     Active: active (running) since ...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tAfter the agent is configured on all systems you want to monitor, you can deploy Keylime to perform one or both of the following functions:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_deploying-keylime-for-runtime-monitoring_assembly_ensuring-system-integrity-with-keylime\" title=\"7.10. Configuring Keylime for runtime monitoring\">Deploying Keylime for runtime monitoring\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_deploying-keylime-for-measured-boot-attestation_assembly_ensuring-system-integrity-with-keylime\" title=\"7.11. Configuring Keylime for measured boot attestation\">Deploying Keylime for measured boot attestation\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://sourceforge.net/p/linux-ima/wiki/Home/\">Integrity Measurement Architecture (IMA) Wiki\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_deploying-keylime-for-runtime-monitoring_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.10. Configuring Keylime for runtime monitoring\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo verify that the state of monitored systems is correct, the Keylime agent must be running on the monitored systems.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tBecause Keylime runtime monitoring uses integrity measurement architecture (IMA) to measure large numbers of files, it might have a significant impact on the performance of your system.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tWhen provisioning the agent, you can also define a file that Keylime sends to the monitored system. Keylime encrypts the file sent to the agent, and decrypts it only if the agent’s system complies with the TPM policy and with the IMA allowlist.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can make Keylime ignore changes of specific files or within specific directories by configuring a Keylime excludelist. The excluded files are still measured by IMA.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFrom Keylime version 7.3.0, provided in RHEL 9.3, the allowlist and excludelist are combined into the Keylime runtime policy.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have network access to the systems where the Keylime components are configured:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Verifier\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime\" title=\"7.2. Deploying Keylime verifier from a package\">Section 7.2, “Deploying Keylime verifier from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Registrar\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime\" title=\"7.4. Deploying Keylime registrar from a package\">Section 7.4, “Deploying Keylime registrar from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Tenant\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime\" title=\"7.8. Deploying Keylime tenant from a package\">Section 7.8, “Deploying Keylime tenant from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Agent\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime\" title=\"7.9. Deploying Keylime agent from a package\">Section 7.9, “Deploying Keylime agent from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the monitored system where the Keylime agent is configured and running, generate an allowlist from the current state of the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>/usr/share/keylime/scripts/create_allowlist.sh -o \u003Cspan class=\"emphasis\">\u003Cem>&lt;allowlist.txt&gt;\u003C/em>\u003C/span> -h sha256sum\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;allowlist.txt&gt;\u003C/em>\u003C/span>\u003C/code> with the file name of the allowlist.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tUse the SHA-256 hash function. SHA-1 is not secure and has been deprecated in RHEL 9. For additional information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6846411\">SHA-1 deprecation in Red Hat Enterprise Linux 9\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the generated allowlist to the system where the \u003Ccode class=\"literal\">keylime_tenant\u003C/code> utility is configured, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>scp \u003Cspan class=\"emphasis\">\u003Cem>&lt;allowlist.txt&gt;\u003C/em>\u003C/span> root@\u003Cspan class=\"emphasis\">\u003Cem>&lt;tenant\u003C/em>\u003C/span>.\u003Cspan class=\"emphasis\">\u003Cem>ip&gt;\u003C/em>\u003C/span>:/root/\u003Cspan class=\"emphasis\">\u003Cem>&lt;allowlist.txt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: You can define a list of files or directories excluded from Keylime measurements by creating a file on the tenant system and entering the paths of files and directories to exclude. The excludelist accepts Python regular expressions with one regular expression per line. See \u003Ca class=\"link\" href=\"https://docs.python.org/3/library/re.html#regular-expression-syntax\">Regular expression operations at docs.python.org\u003C/a> for the complete list of special characters. Save the excludelist on the tenant system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCombine the allowlist and excludelist into the Keylime runtime policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_create_policy -a \u003Cspan class=\"emphasis\">\u003Cem>&lt;allowlist.txt&gt;\u003C/em>\u003C/span> -e \u003Cspan class=\"emphasis\">\u003Cem>&lt;excludelist.txt&gt;\u003C/em>\u003C/span> -o \u003Cspan class=\"emphasis\">\u003Cem>&lt;policy.json&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the system where the Keylime tenant is configured, provision the agent by using the \u003Ccode class=\"literal\">keylime_tenant\u003C/code> utility:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_tenant -c add -t \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_ip&gt;\u003C/em>\u003C/span> -u \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span> --runtime-policy \u003Cspan class=\"emphasis\">\u003Cem>&lt;policy.json&gt;\u003C/em>\u003C/span> --cert default\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_ip&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s IP address.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s UUID.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;policy.json&gt;\u003C/em>\u003C/span>\u003C/code> with the path to the Keylime runtime policy file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWith the \u003Ccode class=\"literal\">--cert\u003C/code> option, the tenant generates and signs a certificate for the agent by using the CA certificates and keys located in the specified directory, or the default \u003Ccode class=\"literal\">/var/lib/keylime/ca/\u003C/code> directory. If the directory contains no CA certificates and keys, the tenant will generate them automatically according to the configuration in the \u003Ccode class=\"literal\">/etc/keylime/ca.conf\u003C/code> file and save them to the specified directory. The tenant then sends these keys and certificates to the agent.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhen generating CA certificates or signing agent certificates, you might be prompted for the password to access the CA private key: \u003Ccode class=\"literal\">Please enter the password to decrypt your keystore:\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf you do not want to use a certificate, use the \u003Ccode class=\"literal\">-f\u003C/code> option instead for delivering a file to the agent. Provisioning an agent requires sending any file, even an empty file.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tKeylime encrypts the file sent to the agent, and decrypts it only if the agent’s system complies with the TPM policy and the IMA allowlist. By default, Keylime decompresses sent \u003Ccode class=\"literal\">.zip\u003C/code> files.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAs an example, with the following command, \u003Ccode class=\"literal\">keylime_tenant\u003C/code> provisions a new Keylime agent at \u003Ccode class=\"literal\">127.0.0.1\u003C/code> with UUID \u003Ccode class=\"literal\">d432fbb3-d2f1-4a97-9ef7-75bd81c00000\u003C/code> and loads a runtime policy \u003Ccode class=\"literal\">policy.json\u003C/code>. It also generates a certificate in the default directory and sends the certificate file to the agent. Keylime decrypts the file only if the TPM policy configured in \u003Ccode class=\"literal\">/etc/keylime/verifier.conf\u003C/code> is satisfied:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_tenant -c add -t 127.0.0.1 -u d432fbb3-d2f1-4a97-9ef7-75bd81c00000 --runtime-policy policy.json --cert default\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tYou can stop Keylime from monitoring a node by using the \u003Ccode class=\"literal\"># keylime_tenant -c delete -u \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span>\u003C/code> command.\n\t\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\t\tYou can modify the configuration of an already registered agent by using the \u003Ccode class=\"literal\">keylime_tenant -c update\u003C/code> command.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: Reboot the monitored system to verify that the settings are persistent.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify a successful attestation of the agent:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_tenant -c cvstatus -u \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent.uuid&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n...\n{\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent.uuid&gt;\u003C/em>\u003C/span>\": {\"operational_state\": \"Get Quote\"...\"attestation_count\": 5\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent.uuid&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s UUID.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the value of \u003Ccode class=\"literal\">operational_state\u003C/code> is \u003Ccode class=\"literal\">Get Quote\u003C/code> and \u003Ccode class=\"literal\">attestation_count\u003C/code> is nonzero, the attestation of this agent is successful.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the value of \u003Ccode class=\"literal\">operational_state\u003C/code> is \u003Ccode class=\"literal\">Invalid Quote\u003C/code> or \u003Ccode class=\"literal\">Failed\u003C/code> attestation fails, the command displays output similar to the following:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">{\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent.uuid&gt;\u003C/em>\u003C/span>\": {\"operational_state\": \"Invalid Quote\", ... \"ima.validation.ima-ng.not_in_allowlist\", \"attestation_count\": 5, \"last_received_quote\": 1684150329, \"last_successful_attestation\": 1684150327}}\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the attestation fails, display more details in the verifier log:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -u keylime_verifier\u003C/strong>\u003C/span>\nkeylime.tpm - INFO - Checking IMA measurement list...\nkeylime.ima - WARNING - File not found in allowlist: /root/bad-script.sh\nkeylime.ima - ERROR - IMA ERRORS: template-hash 0 fnf 1 hash 0 good 781\nkeylime.cloudverifier - WARNING - agent D432FBB3-D2F1-4A97-9EF7-75BD81C00000 failed, stopping polling\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about IMA, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel\">Enhancing security with the kernel integrity subsystem\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_deploying-keylime-for-measured-boot-attestation_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.11. Configuring Keylime for measured boot attestation\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen you configure Keylime for measured boot attestation, Keylime checks that the boot process on the measured system corresponds to the state you defined.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have network access to the systems where the Keylime components are configured:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Verifier\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime\" title=\"7.2. Deploying Keylime verifier from a package\">Section 7.2, “Deploying Keylime verifier from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Registrar\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime\" title=\"7.4. Deploying Keylime registrar from a package\">Section 7.4, “Deploying Keylime registrar from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Tenant\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime\" title=\"7.8. Deploying Keylime tenant from a package\">Section 7.8, “Deploying Keylime tenant from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Agent\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFor more information, see \u003Ca class=\"xref\" href=\"#configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime\" title=\"7.9. Deploying Keylime agent from a package\">Section 7.9, “Deploying Keylime agent from a package”\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUnified Extensible Firmware Interface (UEFI) is enabled on the agent system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the monitored system where the Keylime agent is configured and running, install the \u003Ccode class=\"literal\">python3-keylime\u003C/code> package, which contains the \u003Ccode class=\"literal\">create_mb_refstate\u003C/code> script:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf -y install python3-keylime\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the monitored system, generate a policy from the measured boot log of the current state of the system by using the \u003Ccode class=\"literal\">create_mb_refstate\u003C/code> script:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>/usr/share/keylime/scripts/create_mb_refstate /sys/kernel/security/tpm0/binary_bios_measurements \u003Cspan class=\"emphasis\">\u003Cem>&lt;./measured_boot_reference_state.json&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;./measured_boot_reference_state.json&gt;\u003C/em>\u003C/span>\u003C/code> with the path where the script saves the generated policy.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf your UEFI system does not have Secure Boot enabled, pass the \u003Ccode class=\"literal\">--without-secureboot\u003C/code> argument.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tThe policy generated with the \u003Ccode class=\"literal\">create_mb_refstate\u003C/code> script is based on the current state of the system and is very strict. Any modifications of the system including kernel updates and system updates will change the boot process and the system will fail the attestation.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the generated policy to the system where the \u003Ccode class=\"literal\">keylime_tenant\u003C/code> utility is configured, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>scp root@\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_ip&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;./measured_boot_reference_state.json&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;./measured_boot_reference_state.json&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the system where the Keylime tenant is configured, provision the agent by using the \u003Ccode class=\"literal\">keylime_tenant\u003C/code> utility:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_tenant -c add -t \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_ip&gt;\u003C/em>\u003C/span> -u \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span> --mb_refstate \u003Cspan class=\"emphasis\">\u003Cem>&lt;./measured_boot_reference_state.json&gt;\u003C/em>\u003C/span> --cert default\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_ip&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s IP address.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s UUID.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;./measured_boot_reference_state.json&gt;\u003C/em>\u003C/span>\u003C/code> with the path to the measured boot policy.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you configure measured boot in combination with runtime monitoring, provide all the options from both use cases when entering the \u003Ccode class=\"literal\">keylime_tenant -c add\u003C/code> command.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tYou can stop Keylime from monitoring a node by using the \u003Ccode class=\"literal\"># keylime_tenant -c delete -t \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_ip&gt;\u003C/em>\u003C/span> -u \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span>\u003C/code> command.\n\t\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\t\tYou can modify the configuration of an already registered agent by using the \u003Ccode class=\"literal\">keylime_tenant -c update\u003C/code> command.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReboot the monitored system and verify a successful attestation of the agent:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>keylime_tenant -c cvstatus -u \u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n...\n{\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent.uuid&gt;\u003C/em>\u003C/span>\": {\"operational_state\": \"Get Quote\"...\"attestation_count\": 5\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent_uuid&gt;\u003C/em>\u003C/span>\u003C/code> with the agent’s UUID.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the value of \u003Ccode class=\"literal\">operational_state\u003C/code> is \u003Ccode class=\"literal\">Get Quote\u003C/code> and \u003Ccode class=\"literal\">attestation_count\u003C/code> is nonzero, the attestation of this agent is successful.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the value of \u003Ccode class=\"literal\">operational_state\u003C/code> is \u003Ccode class=\"literal\">Invalid Quote\u003C/code> or \u003Ccode class=\"literal\">Failed\u003C/code> attestation fails, the command displays output similar to the following:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">{\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;agent.uuid&gt;\u003C/em>\u003C/span>\": {\"operational_state\": \"Invalid Quote\", ... \"ima.validation.ima-ng.not_in_allowlist\", \"attestation_count\": 5, \"last_received_quote\": 1684150329, \"last_successful_attestation\": 1684150327}}\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the attestation fails, display more details in the verifier log:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -u keylime_verifier\u003C/strong>\u003C/span>\n{\"d432fbb3-d2f1-4a97-9ef7-75bd81c00000\": {\"operational_state\": \"Tenant Quote Failed\", ... \"last_event_id\": \"measured_boot.invalid_pcr_0\", \"attestation_count\": 0, \"last_received_quote\": 1684487093, \"last_successful_attestation\": 0}}\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.12. Keylime environment variables\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can set Keylime environment variables to override the values from the configuration files, for example, when starting a container with the \u003Ccode class=\"literal\">podman run\u003C/code> command by using the \u003Ccode class=\"literal\">-e\u003C/code> option.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe environment variables have the following syntax:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">KEYLIME\u003Cspan class=\"emphasis\">\u003Cem>_&lt;SECTION&gt;_&lt;ENVIRONMENT_VARIABLE&gt;\u003C/em>\u003C/span>=\u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tWhere:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;SECTION&gt;\u003C/em>\u003C/span>\u003C/code> is the section of the Keylime configuration file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;ENVIRONMENT_VARIABLE&gt;\u003C/em>\u003C/span>\u003C/code> is the environment variable.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> is the value to which you want to set the environment variable.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tFor example, \u003Ccode class=\"literal\">-e KEYLIME_VERIFIER_MAX_RETRIES=6\u003C/code> sets the \u003Ccode class=\"literal\">max_retries\u003C/code> configuration option in the \u003Ccode class=\"literal\">[verifier]\u003C/code> section to \u003Ccode class=\"literal\">6\u003C/code>.\n\t\t\t\u003C/p>\u003Ch5 id=\"verifier_configuration\">Verifier configuration\u003C/h5>\u003Crh-table id=\"idm140081359024800\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.1. [verifier] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081358602880\" scope=\"col\">Configuration option\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081358601792\" scope=\"col\">Environment variable\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081358600704\" scope=\"col\">Default value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auto_migrate_db\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_AUTO_MIGRATE_DB\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">True\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">client_cert\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_CLIENT_CERT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">client_key_password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_CLIENT_KEY_PASSWORD\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">client_key\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_CLIENT_KEY\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">database_pool_sz_ovfl\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_DATABASE_POOL_SZ_OVFL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">5,10\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">database_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_DATABASE_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sqlite\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">durable_attestation_import\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_DURABLE_ATTESTATION_IMPORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">enable_agent_mtls\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_ENABLE_AGENT_MTLS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">True\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">exponential_backoff\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_EXPONENTIAL_BACKOFF\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">True\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ignore_tomtou_errors\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_IGNORE_TOMTOU_ERRORS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">False\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">max_retries\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_MAX_RETRIES\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">5\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">max_upload_size\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_MAX_UPLOAD_SIZE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">104857600\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">measured_boot_evaluate\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_MEASURED_BOOT_EVALUATE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">once\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">measured_boot_imports\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_MEASURED_BOOT_IMPORTS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">[]\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">measured_boot_policy_name\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_MEASURED_BOOT_POLICY_NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">accept-all\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">num_workers\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_NUM_WORKERS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">persistent_store_encoding\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_PERSISTENT_STORE_ENCODING\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">persistent_store_format\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_PERSISTENT_STORE_FORMAT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">json\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">persistent_store_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_PERSISTENT_STORE_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">8881\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">quote_interval\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_QUOTE_INTERVAL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">registrar_ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_REGISTRAR_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">registrar_port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_REGISTRAR_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">8891\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">request_timeout\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_REQUEST_TIMEOUT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">60.0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">require_allow_list_signatures\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_REQUIRE_ALLOW_LIST_SIGNATURES\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">True\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">retry_interval\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_RETRY_INTERVAL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_cert\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_SERVER_CERT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_key_password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_SERVER_KEY_PASSWORD\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_key\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_SERVER_KEY\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">severity_labels\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_SEVERITY_LABELS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">[\"info\", \"notice\", \"warning\", \"error\", \"critical\", \"alert\", \"emergency\"]\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">severity_policy\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_SEVERITY_POLICY\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">[{\"event_id\": \".*\", \"severity_label\" : \"emergency\"}]\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">signed_attributes\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_SIGNED_ATTRIBUTES\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">time_stamp_authority_certs_path\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_TIME_STAMP_AUTHORITY_CERTS_PATH\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">time_stamp_authority_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_TIME_STAMP_AUTHORITY_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tls_dir\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_TLS_DIR\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">generate\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">transparency_log_sign_algo\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_TRANSPARENCY_LOG_SIGN_ALGO\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sha256\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">transparency_log_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_TRANSPARENCY_LOG_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">trusted_client_ca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_TRUSTED_CLIENT_CA\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">trusted_server_ca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_TRUSTED_SERVER_CA\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">uuid\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_UUID\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358602880\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">version\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358601792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_VERSION\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358600704\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2.0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081357114064\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.2. [revocations] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">enabled_revocation_notifications\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_REVOCATIONS_ENABLED_REVOCATION_NOTIFICATIONS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">[agent]\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">webhook_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_VERIFIER_REVOCATIONS_WEBHOOK_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Ch5 id=\"registrar_configuration\">Registrar configuration\u003C/h5>\u003Crh-table id=\"idm140081380651392\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.3. [registrar] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auto_migrate_db\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_AUTO_MIGRATE_DB\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">True\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">database_pool_sz_ovfl\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_DATABASE_POOL_SZ_OVFL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">5,10\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">database_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_DATABASE_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sqlite\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">durable_attestation_import\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_DURABLE_ATTESTATION_IMPORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">persistent_store_encoding\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_PERSISTENT_STORE_ENCODING\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">persistent_store_format\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_PERSISTENT_STORE_FORMAT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">json\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">persistent_store_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_PERSISTENT_STORE_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">8890\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">prov_db_filename\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_PROV_DB_FILENAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">provider_reg_data.sqlite\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_cert\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_SERVER_CERT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_key_password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_SERVER_KEY_PASSWORD\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_key\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_SERVER_KEY\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">signed_attributes\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_SIGNED_ATTRIBUTES\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ek_tpm,aik_tpm,ekcert\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">time_stamp_authority_certs_path\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_TIME_STAMP_AUTHORITY_CERTS_PATH\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">time_stamp_authority_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_TIME_STAMP_AUTHORITY_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tls_dir\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_TLS_DIR\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tls_port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_TLS_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">8891\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">transparency_log_sign_algo\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_TRANSPARENCY_LOG_SIGN_ALGO\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sha256\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">transparency_log_url\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_TRANSPARENCY_LOG_URL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">trusted_client_ca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_TRUSTED_CLIENT_CA\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">version\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_REGISTRAR_VERSION\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2.0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Ch5 id=\"tenant_configuration\">Tenant configuration\u003C/h5>\u003Crh-table id=\"idm140081358995264\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.4. [tenant] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">accept_tpm_encryption_algs\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_ACCEPT_TPM_ENCRYPTION_ALGS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ecc, rsa\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">accept_tpm_hash_algs\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_ACCEPT_TPM_HASH_ALGS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sha512, sha384, sha256\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">accept_tpm_signing_algs\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_ACCEPT_TPM_SIGNING_ALGS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ecschnorr, rsassa\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">client_cert\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_CLIENT_CERT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">client_key_password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_CLIENT_KEY_PASSWORD\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">client_key\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_CLIENT_KEY\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ek_check_script\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_EK_CHECK_SCRIPT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">enable_agent_mtls\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_ENABLE_AGENT_MTLS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">True\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">exponential_backoff\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_EXPONENTIAL_BACKOFF\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">True\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">max_payload_size\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_MAX_PAYLOAD_SIZE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">1048576\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">max_retries\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_MAX_RETRIES\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">5\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">mb_refstate\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_MB_REFSTATE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">registrar_ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_REGISTRAR_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">registrar_port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_REGISTRAR_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">8891\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">request_timeout\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_REQUEST_TIMEOUT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">60\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">require_ek_cert\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_REQUIRE_EK_CERT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">True\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">retry_interval\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_RETRY_INTERVAL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tls_dir\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_TLS_DIR\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tpm_cert_store\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_TPM_CERT_STORE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/var/lib/keylime/tpm_cert_store\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">trusted_server_ca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_TRUSTED_SERVER_CA\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">verifier_ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_VERIFIER_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">verifier_port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_VERIFIER_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">8881\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">version\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_TENANT_VERSION\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2.0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Ch5 id=\"ca_configuration\">CA configuration\u003C/h5>\u003Crh-table id=\"idm140081354688368\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.5. [ca] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_bits\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_BITS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2048\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_ca_lifetime\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_CA_LIFETIME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">3650\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_ca_name\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_CA_NAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Keylime Certificate Authority\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_country\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_COUNTRY\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">US\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_crl_dist\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_CRL_DIST\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">http://localhost:38080/crl\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_lifetime\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_LIFETIME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">365\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_locality\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_LOCALITY\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Lexington\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_org_unit\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_ORG_UNIT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">53\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_organization\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_ORGANIZATION\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">MITLL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cert_state\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_CERT_STATE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">MA\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_PASSWORD\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">version\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_CA_VERSION\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2.0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Ch5 id=\"agent_configuration\">Agent configuration\u003C/h5>\u003Crh-table id=\"idm140081364413456\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.6. [agent] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081364407376\" scope=\"col\">Configuration option\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081358043216\" scope=\"col\">Environment variable\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081358042128\" scope=\"col\">Default value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">contact_ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_CONTACT_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">contact_port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_CONTACT_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">9002\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">dec_payload_file\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_DEC_PAYLOAD_FILE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">decrypted_payload\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ek_handle\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_EK_HANDLE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">generate\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">enable_agent_mtls\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_ENABLE_AGENT_MTLS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">true\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">enable_insecure_payload\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_ENABLE_INSECURE_PAYLOAD\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">false\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">enable_revocation_notifications\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_ENABLE_REVOCATION_NOTIFICATIONS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">true\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">enc_keyname\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_ENC_KEYNAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">derived_tci_key\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">exponential_backoff\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_EXPONENTIAL_BACKOFF\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">true\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">extract_payload_zip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_EXTRACT_PAYLOAD_ZIP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">true\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">max_retries\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_MAX_RETRIES\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">4\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">measure_payload_pcr\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_MEASURE_PAYLOAD_PCR\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">-1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">payload_script\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_PAYLOAD_SCRIPT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">autorun.sh\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">9002\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">registrar_ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_REGISTRAR_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">registrar_port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_REGISTRAR_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">8890\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">retry_interval\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_RETRY_INTERVAL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">revocation_actions\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_REVOCATION_ACTIONS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">[]\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">revocation_cert\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_REVOCATION_CERT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">revocation_notification_ip\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_REVOCATION_NOTIFICATION_IP\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">127.0.0.1\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">revocation_notification_port\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_REVOCATION_NOTIFICATION_PORT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">8992\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">run_as\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_RUN_AS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">keylime:tss\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">secure_size\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_SECURE_SIZE\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">1m\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_cert\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_SERVER_CERT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_key_password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_SERVER_KEY_PASSWORD\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server_key\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_SERVER_KEY\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tls_dir\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_TLS_DIR\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tpm_encryption_alg\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_TPM_ENCRYPTION_ALG\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsa\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tpm_hash_alg\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_TPM_HASH_ALG\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sha256\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tpm_ownerpassword\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_TPM_OWNERPASSWORD\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tpm_signing_alg\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_TPM_SIGNING_ALG\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsassa\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">trusted_client_ca\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_TRUSTED_CLIENT_CA\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">default\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">uuid\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_UUID\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">d432fbb3-d2f1-4a97-9ef7-75bd81c00000\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081364407376\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">version\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358043216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_AGENT_VERSION\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358042128\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2.0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Ch5 id=\"logging_configuration\">Logging configuration\u003C/h5>\u003Crh-table id=\"idm140081357109696\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.7. [logging] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">version\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_VERSION\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">2.0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081357091600\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.8. [loggers] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">keys\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_LOGGERS_KEYS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">root,keylime\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081354768096\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.9. [handlers] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">keys\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_HANDLERS_KEYS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">consoleHandler\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081354749984\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.10. [formatters] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">keys\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_FORMATTERS_KEYS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">formatter\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081359151952\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.11. [formatter_formatter] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">datefmt\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_FORMATTER_FORMATTER_DATEFMT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">%Y-%m-%d %H:%M:%S\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">format\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_FORMATTER_FORMATTER_FORMAT\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">%(asctime)s.%(msecs)03d - %(name)s - %(levelname)s - %(message)s\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081362844576\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.12. [logger_root] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">handlers\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_LOGGER_ROOT_HANDLERS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">consoleHandler\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">level\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_LOGGER_ROOT_LEVEL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">INFO\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081359510992\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.13. [handler_consoleHandler] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">args\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_HANDLER_CONSOLEHANDLER_ARGS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">(sys.stdout,)\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">class\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_HANDLER_CONSOLEHANDLER_CLASS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">StreamHandler\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">formatter\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_HANDLER_CONSOLEHANDLER_FORMATTER\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">formatter\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">level\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_HANDLER_CONSOLEHANDLER_LEVEL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">INFO\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140081359211888\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 7.14. [logger_keylime] section\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tConfiguration option\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnvironment variable\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault value\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">handlers\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_LOGGER_KEYLIME_HANDLERS\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">level\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_LOGGER_KEYLIME_LEVEL\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">INFO\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">qualname\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">KEYLIME_LOGGING_LOGGER_KEYLIME_QUALNAME\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">keylime\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"checking-integrity-with-aide_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 8. Checking integrity with AIDE\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAdvanced Intrusion Detection Environment (AIDE) is a utility that creates a database of files on the system, and then uses that database to ensure file integrity and detect system intrusions.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"installing-aide_checking-integrity-with-aide\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.1. Installing AIDE\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo start file-integrity checking with AIDE, you must install the corresponding package and initiate the AIDE database.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">AppStream\u003C/code> repository is enabled.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">aide\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install aide\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate an initial database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>aide --init\u003C/strong>\u003C/span>\nStart timestamp: 2024-07-08 10:39:23 -0400 (AIDE 0.16)\nAIDE initialized database at /var/lib/aide/aide.db.new.gz\n\nNumber of entries:\t55856\n\n---------------------------------------------------\nThe attributes of the (uncompressed) database(s):\n---------------------------------------------------\n\n/var/lib/aide/aide.db.new.gz\n…\n  SHA512   : mZaWoGzL2m6ZcyyZ/AXTIowliEXWSZqx\n             IFYImY4f7id4u+Bq8WeuSE2jasZur/A4\n             FPBFaBkoCFHdoE/FW/V94Q==\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: In the default configuration, the \u003Ccode class=\"literal\">aide --init\u003C/code> command checks just a set of directories and files defined in the \u003Ccode class=\"literal\">/etc/aide.conf\u003C/code> file. To include additional directories or files in the AIDE database, and to change their watched parameters, edit \u003Ccode class=\"literal\">/etc/aide.conf\u003C/code> accordingly.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo start using the database, remove the \u003Ccode class=\"literal\">.new\u003C/code> substring from the initial database file name:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: To change the location of the AIDE database, edit the \u003Ccode class=\"literal\">/etc/aide.conf\u003C/code> file and modify the \u003Ccode class=\"literal\">DBDIR\u003C/code> value. For additional security, store the database, configuration, and the \u003Ccode class=\"literal\">/usr/sbin/aide\u003C/code> binary file in a secure location such as a read-only media.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"performing-integrity-checks-with-aide_checking-integrity-with-aide\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.2. Performing integrity checks with AIDE\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">crond\u003C/code> service to schedule regular file-integrity checks with AIDE.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAIDE is properly installed and its database is initialized. See \u003Ca class=\"link\" href=\"#installing-aide_checking-integrity-with-aide\" title=\"8.1. Installing AIDE\">Installing AIDE\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo initiate a manual check:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>aide --check\u003C/strong>\u003C/span>\nStart timestamp: 2024-07-08 10:43:46 -0400 (AIDE 0.16)\nAIDE found differences between database and filesystem!!\n\nSummary:\n  Total number of entries:\t55856\n  Added entries:\t\t0\n  Removed entries:\t\t0\n  Changed entries:\t\t1\n\n---------------------------------------------------\nChanged entries:\n---------------------------------------------------\n\nf   ...      ..S : /root/.viminfo\n\n---------------------------------------------------\nDetailed information about changes:\n---------------------------------------------------\n\nFile: /root/.viminfo\n  SELinux  : system_u:object_r:admin_home_t:s | unconfined_u:object_r:admin_home\n             0                                | _t:s0\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAt a minimum, configure the system to run AIDE weekly. Optimally, run AIDE daily. For example, to schedule a daily execution of AIDE at \u003Cspan class=\"emphasis\">\u003Cem>04:05\u003C/em>\u003C/span> a.m. by using the \u003Ccode class=\"literal\">cron\u003C/code> command, add the following line to the \u003Ccode class=\"literal\">/etc/crontab\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"> 05 4 * * * root /usr/sbin/aide --check\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">cron(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"updating-an-aide-database_checking-integrity-with-aide\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.3. Updating an AIDE database\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAfter verifying the changes of your system, such as package updates or configuration files adjustments, update also your baseline AIDE database.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAIDE is properly installed and its database is initialized. See \u003Ca class=\"link\" href=\"#installing-aide_checking-integrity-with-aide\" title=\"8.1. Installing AIDE\">Installing AIDE\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUpdate your baseline AIDE database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>aide --update\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">aide --update\u003C/code> command creates the \u003Ccode class=\"literal\">/var/lib/aide/aide.db.new.gz\u003C/code> database file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo start using the updated database for integrity checks, remove the \u003Ccode class=\"literal\">.new\u003C/code> substring from the file name.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"file-integrity-tools-aide-and-ima_checking-integrity-with-aide\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.4. File-integrity tools: AIDE and IMA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tRed Hat Enterprise Linux provides several tools for checking and preserving the integrity of files and directories on your system. The following table helps you decide which tool better fits your scenario.\n\t\t\t\u003C/p>\u003Crh-table id=\"idm140081358697120\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 8.1. Comparison between AIDE and IMA\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 14%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 43%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 43%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081358691344\" scope=\"col\">Question\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081358690256\" scope=\"col\">Advanced Intrusion Detection Environment (AIDE)\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140081358689136\" scope=\"col\">Integrity Measurement Architecture (IMA)\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358691344\"> \u003Cp>\n\t\t\t\t\t\t\t\tWhat\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358690256\"> \u003Cp>\n\t\t\t\t\t\t\t\tAIDE is a utility that creates a database of files and directories on the system. This database serves for checking file integrity and detect intrusion detection.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358689136\"> \u003Cp>\n\t\t\t\t\t\t\t\tIMA detects if a file is altered by checking file measurement (hash values) compared to previously stored extended attributes.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358691344\"> \u003Cp>\n\t\t\t\t\t\t\t\tHow\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358690256\"> \u003Cp>\n\t\t\t\t\t\t\t\tAIDE uses rules to compare the integrity state of the files and directories.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358689136\"> \u003Cp>\n\t\t\t\t\t\t\t\tIMA uses file hash values to detect the intrusion.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358691344\"> \u003Cp>\n\t\t\t\t\t\t\t\tWhy\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358690256\"> \u003Cp>\n\t\t\t\t\t\t\t\tDetection - AIDE detects if a file is modified by verifying the rules.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358689136\"> \u003Cp>\n\t\t\t\t\t\t\t\tDetection and Prevention - IMA detects and prevents an attack by replacing the extended attribute of a file.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358691344\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsage\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358690256\"> \u003Cp>\n\t\t\t\t\t\t\t\tAIDE detects a threat when the file or directory is modified.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358689136\"> \u003Cp>\n\t\t\t\t\t\t\t\tIMA detects a threat when someone tries to alter the entire file.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358691344\"> \u003Cp>\n\t\t\t\t\t\t\t\tExtension\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358690256\"> \u003Cp>\n\t\t\t\t\t\t\t\tAIDE checks the integrity of files and directories on the local system.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140081358689136\"> \u003Cp>\n\t\t\t\t\t\t\t\tIMA ensures security on the local and remote systems.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"related-information-checking-integrity-with-aide\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.5. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">aide(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel\">Kernel integrity subsystem\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"encrypting-block-devices-using-luks_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 9. Encrypting block devices using LUKS\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tBy using the disk encryption, you can protect the data on a block device by encrypting it. To access the device’s decrypted contents, enter a passphrase or key as authentication. This is important for mobile computers and removable media because it helps to protect the device’s contents even if it has been physically removed from the system. The LUKS format is a default implementation of block device encryption in Red Hat Enterprise Linux.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"luks-disk-encryption_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.1. LUKS disk encryption\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tLinux Unified Key Setup-on-disk-format (LUKS) provides a set of tools that simplifies managing the encrypted devices. With LUKS, you can encrypt block devices and enable multiple user keys to decrypt a master key. For bulk encryption of the partition, use this master key.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tRed Hat Enterprise Linux uses LUKS to perform block device encryption. By default, the option to encrypt the block device is unchecked during the installation. If you select the option to encrypt your disk, the system prompts you for a passphrase every time you boot the computer. This passphrase unlocks the bulk encryption key that decrypts your partition. If you want to modify the default partition table, you can select the partitions that you want to encrypt. This is set in the partition table settings.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Ciphers\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe default cipher used for LUKS is \u003Ccode class=\"literal\">aes-xts-plain64\u003C/code>. The default key size for LUKS is 512 bits. The default key size for LUKS with \u003Cspan class=\"strong strong\">\u003Cstrong>Anaconda\u003C/strong>\u003C/span> XTS mode is 512 bits. The following are the available ciphers:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdvanced Encryption Standard (AES)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTwofish\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSerpent\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Operations performed by LUKS\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLUKS encrypts entire block devices and is therefore well-suited for protecting contents of mobile devices such as removable storage media or laptop disk drives.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe underlying contents of the encrypted block device are arbitrary, which makes it useful for encrypting swap devices. This can also be useful with certain databases that use specially formatted block devices for data storage.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLUKS uses the existing device mapper kernel subsystem.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLUKS provides passphrase strengthening, which protects against dictionary attacks.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLUKS devices contain multiple key slots, which means you can add backup keys or passphrases.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tLUKS is not recommended for the following scenarios:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tDisk-encryption solutions such as LUKS protect the data only when your system is off. After the system is on and LUKS has decrypted the disk, the files on that disk are available to anyone who have access to them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tScenarios that require multiple users to have distinct access keys to the same device. The LUKS1 format provides eight key slots and LUKS2 provides up to 32 key slots.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tApplications that require file-level encryption.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://gitlab.com/cryptsetup/cryptsetup/blob/master/README.md\">LUKS Project Home Page\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://gitlab.com/cryptsetup/LUKS2-docs/blob/master/luks2_doc_wip.pdf\">LUKS On-Disk Format Specification\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://doi.org/10.6028/NIST.FIPS.197-upd1\">FIPS 197: Advanced Encryption Standard (AES)\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"luks-versions-in-rhel_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.2. LUKS versions in RHEL\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIn Red Hat Enterprise Linux, the default format for LUKS encryption is LUKS2. The old LUKS1 format remains fully supported and it is provided as a format compatible with earlier Red Hat Enterprise Linux releases. LUKS2 re-encryption is considered more robust and safe to use as compared to LUKS1 re-encryption.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe LUKS2 format enables future updates of various parts without a need to modify binary structures. Internally it uses JSON text format for metadata, provides redundancy of metadata, detects metadata corruption, and automatically repairs from a metadata copy.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not use LUKS2 in systems that support only LUKS1.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tSince Red Hat Enterprise Linux 9.2, you can use the \u003Ccode class=\"literal\">cryptsetup reencrypt\u003C/code> command for both the LUKS versions to encrypt the disk.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Online re-encryption\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe LUKS2 format supports re-encrypting encrypted devices while the devices are in use. For example, you do not have to unmount the file system on the device to perform the following tasks:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tChanging the volume key\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChanging the encryption algorithm\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen encrypting a non-encrypted device, you must still unmount the file system. You can remount the file system after a short initialization of the encryption.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe LUKS1 format does not support online re-encryption.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Conversion\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tIn certain situations, you can convert LUKS1 to LUKS2. The conversion is not possible specifically in the following scenarios:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA LUKS1 device is marked as being used by a Policy-Based Decryption (PBD) Clevis solution. The \u003Ccode class=\"literal\">cryptsetup\u003C/code> tool does not convert the device when some \u003Ccode class=\"literal\">luksmeta\u003C/code> metadata are detected.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA device is active. The device must be in an inactive state before any conversion is possible.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"options-for-data-protection-during-luks2-re-encryption_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.3. Options for data protection during LUKS2 re-encryption\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tLUKS2 provides several options that prioritize performance or data protection during the re-encryption process. It provides the following modes for the \u003Ccode class=\"literal\">resilience\u003C/code> option, and you can select any of these modes by using the \u003Ccode class=\"literal\">cryptsetup reencrypt --resilience resilience-mode \u003Cspan class=\"emphasis\">\u003Cem>/dev/sdx\u003C/em>\u003C/span>\u003C/code> command:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">checksum\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe default mode. It balances data protection and performance.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis mode stores individual checksums of the sectors in the re-encryption area, which the recovery process can detect for the sectors that were re-encrypted by LUKS2. The mode requires that the block device sector write is atomic.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">journal\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe safest mode but also the slowest. Since this mode journals the re-encryption area in the binary area, the LUKS2 writes the data twice.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">none\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">none\u003C/code> mode prioritizes performance and provides no data protection. It protects the data only against safe process termination, such as the \u003Ccode class=\"literal\">SIGTERM\u003C/code> signal or the user pressing \u003Ckbd class=\"keycap\">Ctrl\u003C/kbd>+\u003Ckbd class=\"keycap\">C\u003C/kbd> key. Any unexpected system failure or application failure might result in data corruption.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tIf a LUKS2 re-encryption process terminates unexpectedly by force, LUKS2 can perform the recovery in one of the following ways:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Automatically\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy performing any one of the following actions triggers the automatic recovery action during the next LUKS2 device open action:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tExecuting the \u003Ccode class=\"literal\">cryptsetup open\u003C/code> command.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tAttaching the device with the \u003Ccode class=\"literal\">systemd-cryptsetup\u003C/code> command.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Manually\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tBy using the \u003Ccode class=\"literal\">cryptsetup repair \u003Cspan class=\"emphasis\">\u003Cem>/dev/sdx\u003C/em>\u003C/span>\u003C/code> command on the LUKS2 device.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">cryptsetup-reencrypt(8)\u003C/code> and \u003Ccode class=\"literal\">cryptsetup-repair(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"encrypting-existing-data-on-a-block-device-using-luks2_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.4. Encrypting existing data on a block device using LUKS2\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can encrypt the existing data on a not yet encrypted device by using the LUKS2 format. A new LUKS header is stored in the head of the device.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe block device has a file system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have backed up your data.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tYou might lose your data during the encryption process due to a hardware, kernel, or human failure. Ensure that you have a reliable backup before you start encrypting the data.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUnmount all file systems on the device that you plan to encrypt, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>umount \u003Cspan class=\"emphasis\">\u003Cem>/dev/mapper/vg00-lv00\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake free space for storing a LUKS header. Use one of the following options that suits your scenario:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the case of encrypting a logical volume, you can extend the logical volume without resizing the file system. For example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>lvextend -L+\u003Cspan class=\"emphasis\">\u003Cem>32M /dev/mapper/vg00-lv00\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tExtend the partition by using partition management tools, such as \u003Ccode class=\"literal\">parted\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tShrink the file system on the device. You can use the \u003Ccode class=\"literal\">resize2fs\u003C/code> utility for the ext2, ext3, or ext4 file systems. Note that you cannot shrink the XFS file system.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInitialize the encryption:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup reencrypt --encrypt --init-only --reduce-device-size \u003Cspan class=\"emphasis\">\u003Cem>32M\u003C/em>\u003C/span> /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>vg00-lv00 lv00_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\n/dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>lv00_encrypted\u003C/em>\u003C/span> is now active and ready for online encryption.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMount the device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mount /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>lv00_encrypted /mnt/lv00_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd an entry for a persistent mapping to the \u003Ccode class=\"literal\">/etc/crypttab\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFind the \u003Ccode class=\"literal\">luksUUID\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup luksUUID /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>vg00-lv00\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\na52e2cc9-a5be-47b8-a95d-6bdf4f2d9325\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOpen \u003Ccode class=\"literal\">/etc/crypttab\u003C/code> in a text editor of your choice and add a device in this file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/crypttab\u003C/strong>\u003C/span>\n\nlv00_encrypted UUID=\u003Cspan class=\"emphasis\">\u003Cem>a52e2cc9-a5be-47b8-a95d-6bdf4f2d9325\u003C/em>\u003C/span> none\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tReplace \u003Cspan class=\"emphasis\">\u003Cem>a52e2cc9-a5be-47b8-a95d-6bdf4f2d9325\u003C/em>\u003C/span> with your device’s \u003Ccode class=\"literal\">luksUUID\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRefresh initramfs with \u003Ccode class=\"literal\">dracut\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>dracut -f --regenerate-all\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd an entry for a persistent mounting to the \u003Ccode class=\"literal\">/etc/fstab\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFind the file system’s UUID of the active LUKS block device:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>blkid -p /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>lv00_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\n/dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>lv00-encrypted\u003C/em>\u003C/span>: UUID=\"\u003Cspan class=\"emphasis\">\u003Cem>37bc2492-d8fa-4969-9d9b-bb64d3685aa9\u003C/em>\u003C/span>\" BLOCK_SIZE=\"4096\" TYPE=\"xfs\" USAGE=\"filesystem\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOpen \u003Ccode class=\"literal\">/etc/fstab\u003C/code> in a text editor of your choice and add a device in this file, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/fstab\u003C/strong>\u003C/span>\n\nUUID=\u003Cspan class=\"emphasis\">\u003Cem>37bc2492-d8fa-4969-9d9b-bb64d3685aa9\u003C/em>\u003C/span> /home auto rw,user,auto 0\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tReplace \u003Cspan class=\"emphasis\">\u003Cem>37bc2492-d8fa-4969-9d9b-bb64d3685aa9\u003C/em>\u003C/span> with your file system’s UUID.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tResume the online encryption:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup reencrypt --resume-only /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>vg00-lv00\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nEnter passphrase for /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>vg00-lv00\u003C/em>\u003C/span>:\nAuto-detected active dm device '\u003Cspan class=\"emphasis\">\u003Cem>lv00_encrypted\u003C/em>\u003C/span>' for data device /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>vg00-lv00\u003C/em>\u003C/span>.\nFinished, time 00:31.130, 10272 MiB written, speed 330.0 MiB/s\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify if the existing data was encrypted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup luksDump /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>vg00-lv00\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nLUKS header information\nVersion: 2\nEpoch: 4\nMetadata area: 16384 [bytes]\nKeyslots area: 16744448 [bytes]\nUUID: a52e2cc9-a5be-47b8-a95d-6bdf4f2d9325\nLabel: (no label)\nSubsystem: (no subsystem)\nFlags: (no flags)\n\nData segments:\n  0: crypt\n\toffset: 33554432 [bytes]\n\tlength: (whole device)\n\tcipher: aes-xts-plain64\n[...]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the status of the encrypted blank block device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup status \u003Cspan class=\"emphasis\">\u003Cem>lv00_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\n/dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>lv00_encrypted\u003C/em>\u003C/span> is active and is in use.\n  type:    LUKS2\n  cipher:  aes-xts-plain64\n  keysize: 512 bits\n  key location: keyring\n  device:  /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>vg00-lv00\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">cryptsetup(8)\u003C/code>, \u003Ccode class=\"literal\">cryptsetup-reencrypt(8)\u003C/code>, \u003Ccode class=\"literal\">lvextend(8)\u003C/code>, \u003Ccode class=\"literal\">resize2fs(8)\u003C/code>, and \u003Ccode class=\"literal\">parted(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"encrypting-existing-data-on-a-block-device-using-luks2-with-a-detached-header_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.5. Encrypting existing data on a block device using LUKS2 with a detached header\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can encrypt existing data on a block device without creating free space for storing a LUKS header. The header is stored in a detached location, which also serves as an additional layer of security. The procedure uses the LUKS2 encryption format.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe block device has a file system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have backed up your data.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tYou might lose your data during the encryption process due to a hardware, kernel, or human failure. Ensure that you have a reliable backup before you start encrypting the data.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUnmount all file systems on the device, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>umount /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInitialize the encryption:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup reencrypt --encrypt --init-only --header \u003Cspan class=\"emphasis\">\u003Cem>/home/header\u003C/em>\u003C/span> /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1 nvme_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nWARNING!\n========\nHeader file does not exist, do you want to create it?\n\nAre you sure? (Type 'yes' in capital letters): YES\nEnter passphrase for \u003Cspan class=\"emphasis\">\u003Cem>/home/header\u003C/em>\u003C/span>:\nVerify passphrase:\n/dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>nvme_encrypted\u003C/em>\u003C/span> is now active and ready for online encryption.\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Cspan class=\"emphasis\">\u003Cem>/home/header\u003C/em>\u003C/span> with a path to the file with a detached LUKS header. The detached LUKS header has to be accessible to unlock the encrypted device later.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMount the device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mount /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>nvme_encrypted /mnt/nvme_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tResume the online encryption:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup reencrypt --resume-only --header \u003Cspan class=\"emphasis\">\u003Cem>/home/header\u003C/em>\u003C/span> /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nEnter passphrase for /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>:\nAuto-detected active dm device 'nvme_encrypted' for data device /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>.\nFinished, time 00m51s,   10 GiB written, speed 198.2 MiB/s\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify if the existing data on a block device using LUKS2 with a detached header is encrypted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup luksDump \u003Cspan class=\"emphasis\">\u003Cem>/home/header\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nLUKS header information\nVersion:       \t2\nEpoch:         \t88\nMetadata area: \t16384 [bytes]\nKeyslots area: \t16744448 [bytes]\nUUID:          \tc4f5d274-f4c0-41e3-ac36-22a917ab0386\nLabel:         \t(no label)\nSubsystem:     \t(no subsystem)\nFlags:       \t(no flags)\n\nData segments:\n  0: crypt\n\toffset: 0 [bytes]\n\tlength: (whole device)\n\tcipher: aes-xts-plain64\n\tsector: 512 [bytes]\n[...]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the status of the encrypted blank block device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup status \u003Cspan class=\"emphasis\">\u003Cem>nvme_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\n/dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>nvme_encrypted\u003C/em>\u003C/span> is active and is in use.\n  type:    LUKS2\n  cipher:  aes-xts-plain64\n  keysize: 512 bits\n  key location: keyring\n  device:  /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">cryptsetup(8)\u003C/code> and \u003Ccode class=\"literal\">cryptsetup-reencrypt(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"encrypting-a-blank-block-device-using-luks2_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.6. Encrypting a blank block device using LUKS2\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can encrypt a blank block device, which you can use for an encrypted storage by using the LUKS2 format.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA blank block device. You can use commands such as \u003Ccode class=\"literal\">lsblk\u003C/code> to find if there is no real data on that device, for example, a file system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSetup a partition as an encrypted LUKS partition:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup luksFormat /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nWARNING!\n========\nThis will overwrite data on \u003Cspan class=\"emphasis\">\u003Cem>/dev/nvme0n1p1\u003C/em>\u003C/span> irrevocably.\nAre you sure? (Type 'yes' in capital letters): YES\nEnter passphrase for /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>:\nVerify passphrase:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen an encrypted LUKS partition:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup open /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1 nvme0n1p1_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nEnter passphrase for /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>:\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis unlocks the partition and maps it to a new device by using the device mapper. To not overwrite the encrypted data, this command alerts the kernel that the device is an encrypted device and addressed through LUKS by using the \u003Ccode class=\"literal\">/dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>device_mapped_name\u003C/em>\u003C/span>\u003C/code> path.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a file system to write encrypted data to the partition, which must be accessed through the device mapped name:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mkfs -t ext4 /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMount the device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mount /dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1_encrypted mount-point\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify if the blank block device is encrypted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup luksDump /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nLUKS header information\nVersion:       \t2\nEpoch:         \t3\nMetadata area: \t16384 [bytes]\nKeyslots area: \t16744448 [bytes]\nUUID:          \t34ce4870-ffdf-467c-9a9e-345a53ed8a25\nLabel:         \t(no label)\nSubsystem:     \t(no subsystem)\nFlags:       \t(no flags)\n\nData segments:\n  0: crypt\n\toffset: 16777216 [bytes]\n\tlength: (whole device)\n\tcipher: aes-xts-plain64\n\tsector: 512 [bytes]\n[...]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the status of the encrypted blank block device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup status \u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1_encrypted\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\n/dev/mapper/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1_encrypted\u003C/em>\u003C/span> is active and is in use.\n  type:    LUKS2\n  cipher:  aes-xts-plain64\n  keysize: 512 bits\n  key location: keyring\n  device:  /dev/\u003Cspan class=\"emphasis\">\u003Cem>nvme0n1p1\u003C/em>\u003C/span>\n  sector size:  512\n  offset:  32768 sectors\n  size:    20938752 sectors\n  mode:    read/write\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">cryptsetup(8)\u003C/code>, \u003Ccode class=\"literal\">cryptsetup-open (8)\u003C/code>, and \u003Ccode class=\"literal\">cryptsetup-lusFormat(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.7. Configuring the LUKS passphrase in the web console\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you want to add encryption to an existing logical volume on your system, you can only do so through formatting the volume.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have installed the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor instructions, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console\">Installing and enabling the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cockpit-storaged\u003C/code> package is installed on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAvailable existing logical volume without encryption.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console\">Logging in to the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Storage\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Storage\u003C/strong>\u003C/span> table, click the menu button, \u003Cspan class=\"guibutton\">⋮\u003C/span>, next to the storage device you want to encrypt.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFrom the drop-down menu, select \u003Cspan class=\"guibutton\">Format\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Encryption field\u003C/strong>\u003C/span>, select the encryption specification, \u003Cspan class=\"strong strong\">\u003Cstrong>LUKS1\u003C/strong>\u003C/span> or \u003Cspan class=\"strong strong\">\u003Cstrong>LUKS2\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSet and confirm your new passphrase.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: Modify further encryption options.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFinalize formatting settings.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Format\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"changing-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.8. Changing the LUKS passphrase in the web console\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tChange a LUKS passphrase on an encrypted disk or partition in the web console.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have installed the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor instructions, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console\">Installing and enabling the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cockpit-storaged\u003C/code> package is installed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console\">Logging in to the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Storage\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Storage\u003C/strong>\u003C/span> table, select the disk with encrypted data.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the disk page, scroll to the \u003Cspan class=\"strong strong\">\u003Cstrong>Keys\u003C/strong>\u003C/span> section and click the edit button.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/cfaf0f76552b0b0e79c9e3f01f8ef688/cockpit-LUKS-edit.png\" alt=\"cockpit LUKS edit\"/>\u003C/span>\n\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Change passphrase\u003C/strong>\u003C/span> dialog window:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnter your current passphrase.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnter your new passphrase.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConfirm your new passphrase.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/901a308feba70ad35b232e9179f0f81a/cockpit-change-pwd.png\" alt=\"cockpit change pwd\"/>\u003C/span>\n\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Save\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-luks2-encrypted-volume-using-the-storage-role_encrypting-block-devices-using-luks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.9. Creating a LUKS2 encrypted volume by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">storage\u003C/code> role to create and configure a volume encrypted with LUKS by running an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create and configure a volume encrypted with LUKS\n  hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.storage\n  vars:\n    storage_volumes:\n      - name: barefs\n        type: disk\n        disks:\n         \u003Cspan class=\"emphasis\">\u003Cem>- sdb\u003C/em>\u003C/span>\n        fs_type: xfs\n        fs_label: label-name\n        mount_point: /mnt/data\n        encryption: true\n        encryption_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can also add other encryption parameters, such as \u003Ccode class=\"literal\">encryption_key\u003C/code>, \u003Ccode class=\"literal\">encryption_cipher\u003C/code>, \u003Ccode class=\"literal\">encryption_key_size\u003C/code>, and \u003Ccode class=\"literal\">encryption_luks\u003C/code>, to the playbook file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the encryption status:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup status sdb\u003C/strong>\u003C/span>\n\n/dev/mapper/sdb is active and is in use.\ntype: LUKS2\ncipher: aes-xts-plain64\nkeysize: 512 bits\nkey location: keyring\ndevice: /dev/sdb\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the created LUKS encrypted volume:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup luksDump /dev/sdb\u003C/strong>\u003C/span>\n\nVersion:        2\nEpoch:          6\nMetadata area:  16384 [bytes]\nKeyslots area:  33521664 [bytes]\nUUID:           a4c6be82-7347-4a91-a8ad-9479b72c9426\nLabel:          (no label)\nSubsystem:      (no subsystem)\nFlags:          allow-discards\n\nData segments:\n  0: crypt\n        offset: 33554432 [bytes]\n        length: (whole device)\n        cipher: aes-xts-plain64\n        sector: 4096 [bytes]\n...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_storage_devices/encrypting-block-devices-using-luks_managing-storage-devices\">Encrypting block devices by using LUKS\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 10. Configuring automated unlocking of encrypted volumes by using policy-based decryption\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tPolicy-Based Decryption (PBD) is a collection of technologies that enable unlocking encrypted root and secondary volumes of hard drives on physical and virtual machines. PBD uses a variety of unlocking methods, such as user passwords, a Trusted Platform Module (TPM) device, a PKCS #11 device connected to a system, for example, a smart card, or a special network server.\n\t\t\u003C/p>\u003Cp>\n\t\t\tPBD allows combining different unlocking methods into a policy, which makes it possible to unlock the same volume in different ways. The current implementation of the PBD in RHEL consists of the Clevis framework and plug-ins called \u003Cspan class=\"emphasis\">\u003Cem>pins\u003C/em>\u003C/span>. Each pin provides a separate unlocking capability. Currently, the following pins are available:\n\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tang\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\tAllows unlocking volumes using a network server.\n\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tpm2\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\tallows unlocking volumes using a TPM2 policy.\n\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sss\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\tallows deploying high-availability systems using the Shamir’s Secret Sharing (SSS) cryptographic scheme.\n\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Csection class=\"section\" id=\"network-bound-disk-encryption_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.1. Network-bound disk encryption\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Network Bound Disc Encryption (NBDE) is a subcategory of Policy-Based Decryption (PBD) that allows binding encrypted volumes to a special network server. The current implementation of the NBDE includes a Clevis pin for the Tang server and the Tang server itself.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn RHEL, NBDE is implemented through the following components and technologies:\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"fig-NBDE-Clevis-Tang\">\u003Cp class=\"title\">\u003Cstrong>Figure 10.1. NBDE scheme when using a LUKS1-encrypted volume. The luksmeta package is not used for LUKS2 volumes.\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/254dc068af942f27c7edc6e7c65bf7a2/RHEL_Security-Guide_453350_0717_ECE_NBDE.png\" alt=\"Network-Bound Disk Encryption (NBDE)\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>Tang\u003C/em>\u003C/span> is a server for binding data to network presence. It makes a system containing your data available when the system is bound to a certain secure network. Tang is stateless and does not require TLS or authentication. Unlike escrow-based solutions, where the server stores all encryption keys and has knowledge of every key ever used, Tang never interacts with any client keys, so it never gains any identifying information from the client.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>Clevis\u003C/em>\u003C/span> is a pluggable framework for automated decryption. In NBDE, Clevis provides automated unlocking of LUKS volumes. The \u003Ccode class=\"literal\">clevis\u003C/code> package provides the client side of the feature.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA \u003Cspan class=\"emphasis\">\u003Cem>Clevis pin\u003C/em>\u003C/span> is a plug-in into the Clevis framework. One of such pins is a plug-in that implements interactions with the NBDE server — Tang.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tClevis and Tang are generic client and server components that provide network-bound encryption. In RHEL, they are used in conjunction with LUKS to encrypt and decrypt root and non-root storage volumes to accomplish Network-Bound Disk Encryption.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBoth client- and server-side components use the \u003Cspan class=\"emphasis\">\u003Cem>José\u003C/em>\u003C/span> library to perform encryption and decryption operations.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWhen you begin provisioning NBDE, the Clevis pin for Tang server gets a list of the Tang server’s advertised asymmetric keys. Alternatively, since the keys are asymmetric, a list of Tang’s public keys can be distributed out of band so that clients can operate without access to the Tang server. This mode is called \u003Cspan class=\"emphasis\">\u003Cem>offline provisioning\u003C/em>\u003C/span>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe Clevis pin for Tang uses one of the public keys to generate a unique, cryptographically-strong encryption key. Once the data is encrypted using this key, the key is discarded. The Clevis client should store the state produced by this provisioning operation in a convenient location. This process of encrypting data is the \u003Cspan class=\"emphasis\">\u003Cem>provisioning step\u003C/em>\u003C/span>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe LUKS version 2 (LUKS2) is the default disk-encryption format in RHEL, hence, the provisioning state for NBDE is stored as a token in a LUKS2 header. The leveraging of provisioning state for NBDE by the \u003Ccode class=\"literal\">luksmeta\u003C/code> package is used only for volumes encrypted with LUKS1.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe Clevis pin for Tang supports both LUKS1 and LUKS2 without specification need. Clevis can encrypt plain-text files but you have to use the \u003Ccode class=\"literal\">cryptsetup\u003C/code> tool for encrypting block devices. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/encrypting-block-devices-using-luks_security-hardening\">Encrypting block devices using LUKS\u003C/a> for more information.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWhen the client is ready to access its data, it loads the metadata produced in the provisioning step and it responds to recover the encryption key. This process is the \u003Cspan class=\"emphasis\">\u003Cem>recovery step\u003C/em>\u003C/span>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn NBDE, Clevis binds a LUKS volume using a pin so that it can be automatically unlocked. After successful completion of the binding process, the disk can be unlocked using the provided Dracut unlocker.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf the \u003Ccode class=\"literal\">kdump\u003C/code> kernel crash dumping mechanism is set to save the content of the system memory to a LUKS-encrypted device, you are prompted for entering a password during the second kernel boot.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6987053\">NBDE (Network-Bound Disk Encryption) Technology\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">tang(8)\u003C/code>, \u003Ccode class=\"literal\">clevis(1)\u003C/code>, \u003Ccode class=\"literal\">jose(1)\u003C/code>, and \u003Ccode class=\"literal\">clevis-luks-unlockers(7)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/4500491\">How to set up Network-Bound Disk Encryption with multiple LUKS devices (Clevis + Tang unlocking)\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.2. Deploying a Tang server with SELinux in enforcing mode\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use a Tang server to automatically unlock LUKS-encrypted volumes on Clevis-enabled clients. In the minimalistic scenario, you deploy a Tang server on port 80 by installing the \u003Ccode class=\"literal\">tang\u003C/code> package and entering the \u003Ccode class=\"literal\">systemctl enable tangd.socket --now\u003C/code> command. The following example procedure demonstrates the deployment of a Tang server running on a custom port as a confined service in SELinux enforcing mode.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package and its dependencies are installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">firewalld\u003C/code> service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo install the \u003Ccode class=\"literal\">tang\u003C/code> package and its dependencies, enter the following command as \u003Ccode class=\"literal\">root\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install tang\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPick an unoccupied port, for example, \u003Cspan class=\"emphasis\">\u003Cem>7500/tcp\u003C/em>\u003C/span>, and allow the \u003Ccode class=\"literal\">tangd\u003C/code> service to bind to that port:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port -a -t tangd_port_t -p tcp \u003Cspan class=\"emphasis\">\u003Cem>7500\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that a port can be used only by one service at a time, and thus an attempt to use an already occupied port implies the \u003Ccode class=\"literal\">ValueError: Port already defined\u003C/code> error message.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the port in the firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-port=\u003Cspan class=\"emphasis\">\u003Cem>7500\u003C/em>\u003C/span>/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable the \u003Ccode class=\"literal\">tangd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable tangd.socket\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an override file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl edit tangd.socket\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the following editor screen, which opens an empty \u003Ccode class=\"literal\">override.conf\u003C/code> file located in the \u003Ccode class=\"literal\">/etc/systemd/system/tangd.socket.d/\u003C/code> directory, change the default port for the Tang server from 80 to the previously picked number by adding the following lines:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">[Socket]\nListenStream=\nListenStream=\u003Cspan class=\"emphasis\">\u003Cem>7500\u003C/em>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tInsert the previous code snippet between the lines starting with \u003Ccode class=\"literal\"># Anything between here\u003C/code> and \u003Ccode class=\"literal\"># Lines below this\u003C/code>, otherwise the system discards your changes.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the changes by pressing \u003Ckbd class=\"keycap\">Ctrl\u003C/kbd>+\u003Ckbd class=\"keycap\">O\u003C/kbd> and \u003Ckbd class=\"keycap\">Enter\u003C/kbd>. Exit the editor by pressing \u003Ckbd class=\"keycap\">Ctrl\u003C/kbd>+\u003Ckbd class=\"keycap\">X\u003C/kbd>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReload the changed configuration:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl daemon-reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that your configuration is working:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl show tangd.socket -p Listen\u003C/strong>\u003C/span>\nListen=[::]:7500 (Stream)\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">tangd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart tangd.socket\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause \u003Ccode class=\"literal\">tangd\u003C/code> uses the \u003Ccode class=\"literal\">systemd\u003C/code> socket activation mechanism, the server starts as soon as the first connection comes in. A new set of cryptographic keys is automatically generated at the first start. To perform cryptographic operations such as manual key generation, use the \u003Ccode class=\"literal\">jose\u003C/code> utility.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your NBDE client, verify that your Tang server works correctly by using the following command. The command must return the identical message you pass for encryption and decryption:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>echo test | clevis encrypt tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;tang.server.example.com:7500&gt;\u003C/em>\u003C/span>\"}' -y | clevis decrypt\u003C/strong>\u003C/span>\ntest\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">tang(8)\u003C/code>, \u003Ccode class=\"literal\">semanage(8)\u003C/code>, \u003Ccode class=\"literal\">firewall-cmd(1)\u003C/code>, \u003Ccode class=\"literal\">jose(1)\u003C/code>, \u003Ccode class=\"literal\">systemd.unit(5)\u003C/code>, and \u003Ccode class=\"literal\">systemd.socket(5)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"rotating-tang-keys_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.3. Rotating Tang server keys and updating bindings on clients\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFor security reasons, rotate your Tang server keys and update existing bindings on clients periodically. The precise interval at which you should rotate them depends on your application, key sizes, and institutional policy.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAlternatively, you can rotate Tang keys by using the \u003Ccode class=\"literal\">nbde_server\u003C/code> RHEL system role. See \u003Ca class=\"link\" href=\"#using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles\" title=\"10.16.1. Using the nbde_server RHEL system role for setting up multiple Tang servers\">Using the nbde_server system role for setting up multiple Tang servers\u003C/a> for more information.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA Tang server is running.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">clevis\u003C/code> and \u003Ccode class=\"literal\">clevis-luks\u003C/code> packages are installed on your clients.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRename all keys in the \u003Ccode class=\"literal\">/var/db/tang\u003C/code> key database directory to have a leading \u003Ccode class=\"literal\">.\u003C/code> to hide them from advertisement. Note that the file names in the following example differs from unique file names in the key database directory of your Tang server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cd \u003Cspan class=\"emphasis\">\u003Cem>/var/db/tang\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ls -l\u003C/strong>\u003C/span>\n-rw-r--r--. 1 root root 349 Feb  7 14:55 UV6dqXSwe1bRKG3KbJmdiR020hY.jwk\n-rw-r--r--. 1 root root 354 Feb  7 14:55 y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk\n# \u003Cspan class=\"strong strong\">\u003Cstrong>mv UV6dqXSwe1bRKG3KbJmdiR020hY.jwk .UV6dqXSwe1bRKG3KbJmdiR020hY.jwk\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>mv y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk .y9hxLTQSiSB5jSEGWnjhY8fDTJU.jwk\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that you renamed and therefore hid all keys from the Tang server advertisement:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ls -l\u003C/strong>\u003C/span>\ntotal 0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate new keys using the \u003Ccode class=\"literal\">/usr/libexec/tangd-keygen\u003C/code> command in \u003Ccode class=\"literal\">/var/db/tang\u003C/code> on the Tang server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>/usr/libexec/tangd-keygen \u003Cspan class=\"emphasis\">\u003Cem>/var/db/tang\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ls \u003Cspan class=\"emphasis\">\u003Cem>/var/db/tang\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n3ZWS6-cDrCG61UPJS2BMmPU4I54.jwk zyLuX6hijUy_PSeUEFDi7hi38.jwk\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that your Tang server advertises the signing key from the new key pair, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tang-show-keys \u003Cspan class=\"emphasis\">\u003Cem>7500\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n3ZWS6-cDrCG61UPJS2BMmPU4I54\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your NBDE clients, use the \u003Ccode class=\"literal\">clevis luks report\u003C/code> command to check if the keys advertised by the Tang server remains the same. You can identify slots with the relevant binding using the \u003Ccode class=\"literal\">clevis luks list\u003C/code> command, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks list -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n1: tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>http://tang.srv\u003C/em>\u003C/span>\"}'\n# \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks report -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span> -s \u003Cspan class=\"emphasis\">\u003Cem>1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n...\nReport detected that some keys were rotated.\nDo you want to regenerate luks metadata with \"clevis luks regen -d /dev/sda2 -s 1\"? [ynYN]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo regenerate LUKS metadata for the new keys either press \u003Ccode class=\"literal\">y\u003C/code> to the prompt of the previous command, or use the \u003Ccode class=\"literal\">clevis luks regen\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks regen -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span> -s \u003Cspan class=\"emphasis\">\u003Cem>1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen you are sure that all old clients use the new keys, you can remove the old keys from the Tang server, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cd \u003Cspan class=\"emphasis\">\u003Cem>/var/db/tang\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm .*.jwk\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tRemoving the old keys while clients are still using them can result in data loss. If you accidentally remove such keys, use the \u003Ccode class=\"literal\">clevis luks regen\u003C/code> command on the clients, and provide your LUKS password manually.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">tang-show-keys(1)\u003C/code>, \u003Ccode class=\"literal\">clevis-luks-list(1)\u003C/code>, \u003Ccode class=\"literal\">clevis-luks-report(1)\u003C/code>, and \u003Ccode class=\"literal\">clevis-luks-regen(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-automated-unlocking-using-a-tang-key-in-the-web-console_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.4. Configuring automated unlocking by using a Tang key in the web console\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure automated unlocking of a LUKS-encrypted storage device using a key provided by a Tang server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have installed the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor instructions, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#installing-the-web-console_getting-started-with-the-rhel-9-web-console\">Installing and enabling the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cockpit-storaged\u003C/code> and \u003Ccode class=\"literal\">clevis-luks\u003C/code> packages are installed on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cockpit.socket\u003C/code> service is running at port 9090.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA Tang server is available. See \u003Ca class=\"link\" href=\"#deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\" title=\"10.2. Deploying a Tang server with SELinux in enforcing mode\">Deploying a Tang server with SELinux in enforcing mode\u003C/a> for details.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> privileges or permissions to enter administrative commands with \u003Ccode class=\"literal\">sudo\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the RHEL 9 web console.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console#logging-in-to-the-web-console_getting-started-with-the-rhel-9-web-console\">Logging in to the web console\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSwitch to administrative access, provide your credentials, and click \u003Cspan class=\"guibutton\">Storage\u003C/span>. In the \u003Cspan class=\"strong strong\">\u003Cstrong>Storage\u003C/strong>\u003C/span> table, click the disk that contains an encrypted volume you plan to add to unlock automatically.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the following page with details of the selected disk, click \u003Cspan class=\"guibutton\">+\u003C/span> in the \u003Cspan class=\"strong strong\">\u003Cstrong>Keys\u003C/strong>\u003C/span> section to add a Tang key:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/8994ea1c421cf66cb10392220ef97533/web-console-disk-encryption.png\" alt=\"RHEL web console: Encryption\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSelect \u003Ccode class=\"literal\">Tang keyserver\u003C/code> as \u003Ccode class=\"literal\">Key source\u003C/code>, provide the address of your Tang server, and a password that unlocks the LUKS-encrypted device. Click \u003Cspan class=\"guibutton\">Add\u003C/span> to confirm:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/72cd4123b92f2472b3d30b3a1ce12e88/web-console-add-tang-key.png\" alt=\"RHEL web console: Add Tang key\"/>\u003C/div>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe following dialog window provides a command to verify that the key hash matches.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn a terminal on the Tang server, use the \u003Ccode class=\"literal\">tang-show-keys\u003C/code> command to display the key hash for comparison. In this example, the Tang server is running on the port \u003Cspan class=\"emphasis\">\u003Cem>7500\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tang-show-keys \u003Cspan class=\"emphasis\">\u003Cem>7500\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nx100_1k6GPiDOaMlL3WbpCjHOy9ul1bSfdhI3M08wO0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick \u003Cspan class=\"guibutton\">Trust key\u003C/span> when the key hashes in the web console and in the output of previously listed commands are the same:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/54a6b130eab4415f92e9bdecfcf4321b/web-console-verify-tang-key.png\" alt=\"RHEL web console: Verify Tang key\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn RHEL 9.2 and later, after you select an encrypted root file system and a Tang server, you can skip adding the \u003Ccode class=\"literal\">rd.neednet=1\u003C/code> parameter to the kernel command line, installing the \u003Ccode class=\"literal\">clevis-dracut\u003C/code> package, and regenerating an initial RAM disk (\u003Ccode class=\"literal\">initrd\u003C/code>). For non-root file systems, the web console now enables the \u003Ccode class=\"literal\">remote-cryptsetup.target\u003C/code> and \u003Ccode class=\"literal\">clevis-luks-akspass.path\u003C/code> \u003Ccode class=\"literal\">systemd\u003C/code> units, installs the \u003Ccode class=\"literal\">clevis-systemd\u003C/code> package, and adds the \u003Ccode class=\"literal\">_netdev\u003C/code> parameter to the \u003Ccode class=\"literal\">fstab\u003C/code> and \u003Ccode class=\"literal\">crypttab\u003C/code> configuration files.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the newly added Tang key is now listed in the \u003Cspan class=\"strong strong\">\u003Cstrong>Keys\u003C/strong>\u003C/span> section with the \u003Ccode class=\"literal\">Keyserver\u003C/code> type:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US/images/4748edf7dcc02e012be459a8ef260007/web-console-disk-encryption-with-tang-key.png\" alt=\"RHEL web console: A keyserver key is listed\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the bindings are available for the early boot, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>lsinitrd | grep clevis-luks\u003C/strong>\u003C/span>\nlrwxrwxrwx   1 root     root           48 Jan  4 02:56 etc/systemd/system/cryptsetup.target.wants/clevis-luks-askpass.path -&gt; /usr/lib/systemd/system/clevis-luks-askpass.path\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_systems_using_the_rhel_9_web_console/getting-started-with-the-rhel-9-web-console_system-management-using-the-rhel-9-web-console\">Getting started using the RHEL web console\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"basic-nbde-and-tpm2-encryption-client-operations_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.5. Basic NBDE and TPM2 encryption-client operations\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Clevis framework can encrypt plain-text files and decrypt both ciphertexts in the JSON Web Encryption (JWE) format and LUKS-encrypted block devices. Clevis clients can use either Tang network servers or Trusted Platform Module 2.0 (TPM 2.0) chips for cryptographic operations.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following commands demonstrate the basic functionality provided by Clevis on examples containing plain-text files. You can also use them for troubleshooting your NBDE or Clevis+TPM deployments.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Encryption client bound to a Tang server\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo check that a Clevis encryption client binds to a Tang server, use the \u003Ccode class=\"literal command\">clevis encrypt tang\u003C/code> sub-command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>clevis encrypt tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>http://tang.srv:port\u003C/em>\u003C/span>\"}' &lt; \u003Cspan class=\"emphasis\">\u003Cem>input-plain.txt\u003C/em>\u003C/span> &gt; \u003Cspan class=\"emphasis\">\u003Cem>secret.jwe\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nThe advertisement contains the following signing keys:\n\n_OsIk0T-E2l6qjfdDiwVmidoZjA\n\nDo you wish to trust these keys? [ynYN] y\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>http://tang.srv:port\u003C/em>\u003C/span>\u003C/code> URL in the previous example to match the URL of the server where \u003Ccode class=\"literal package\">tang\u003C/code> is installed. The \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>secret.jwe\u003C/em>\u003C/span>\u003C/code> output file contains your encrypted cipher text in the JWE format. This cipher text is read from the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>input-plain.txt\u003C/em>\u003C/span>\u003C/code> input file.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, if your configuration requires a non-interactive communication with a Tang server without SSH access, you can download an advertisement and save it to a file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>curl -sfg \u003Cspan class=\"emphasis\">\u003Cem>http://tang.srv:port\u003C/em>\u003C/span>/adv -o \u003Cspan class=\"emphasis\">\u003Cem>adv.jws\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the advertisement in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>adv.jws\u003C/em>\u003C/span>\u003C/code> file for any following tasks, such as encryption of files or messages:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>echo 'hello' | clevis encrypt tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>http://tang.srv:port\u003C/em>\u003C/span>\",\"adv\":\"\u003Cspan class=\"emphasis\">\u003Cem>adv.jws\u003C/em>\u003C/span>\"}'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo decrypt data, use the \u003Ccode class=\"literal command\">clevis decrypt\u003C/code> command and provide the cipher text (JWE):\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>clevis decrypt &lt; \u003Cspan class=\"emphasis\">\u003Cem>secret.jwe\u003C/em>\u003C/span> &gt; \u003Cspan class=\"emphasis\">\u003Cem>output-plain.txt\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Encryption client using TPM 2.0\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo encrypt using a TPM 2.0 chip, use the \u003Ccode class=\"literal command\">clevis encrypt tpm2\u003C/code> sub-command with the only argument in form of the JSON configuration object:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>clevis encrypt tpm2 '{}' &lt; \u003Cspan class=\"emphasis\">\u003Cem>input-plain.txt\u003C/em>\u003C/span> &gt; \u003Cspan class=\"emphasis\">\u003Cem>secret.jwe\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo choose a different hierarchy, hash, and key algorithms, specify configuration properties, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>clevis encrypt tpm2 '{\"hash\":\"sha256\",\"key\":\"rsa\"}' &lt; \u003Cspan class=\"emphasis\">\u003Cem>input-plain.txt\u003C/em>\u003C/span> &gt; \u003Cspan class=\"emphasis\">\u003Cem>secret.jwe\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo decrypt the data, provide the ciphertext in the JSON Web Encryption (JWE) format:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>clevis decrypt &lt; \u003Cspan class=\"emphasis\">\u003Cem>secret.jwe\u003C/em>\u003C/span> &gt; \u003Cspan class=\"emphasis\">\u003Cem>output-plain.txt\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe pin also supports sealing data to a Platform Configuration Registers (PCR) state. That way, the data can only be unsealed if the PCR hashes values match the policy used when sealing.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, to seal the data to the PCR with index 0 and 7 for the SHA-256 bank:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>clevis encrypt tpm2 '{\"pcr_bank\":\"sha256\",\"pcr_ids\":\"0,7\"}' &lt; \u003Cspan class=\"emphasis\">\u003Cem>input-plain.txt\u003C/em>\u003C/span> &gt; \u003Cspan class=\"emphasis\">\u003Cem>secret.jwe\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tHashes in PCRs can be rewritten, and you no longer can unlock your encrypted volume. For this reason, add a strong passphrase that enable you to unlock the encrypted volume manually even when a value in a PCR changes.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIf the system cannot automatically unlock your encrypted volume after an upgrade of the \u003Ccode class=\"literal package\">shim-x64\u003C/code> package, follow the steps in the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/6175492\">Clevis TPM2 no longer decrypts LUKS devices after a restart\u003C/a> KCS article.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">clevis-encrypt-tang(1)\u003C/code>, \u003Ccode class=\"literal\">clevis-luks-unlockers(7)\u003C/code>, \u003Ccode class=\"literal\">clevis(1)\u003C/code>, and \u003Ccode class=\"literal\">clevis-encrypt-tpm2(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">clevis\u003C/code>, \u003Ccode class=\"literal\">clevis decrypt\u003C/code>, and \u003Ccode class=\"literal\">clevis encrypt tang\u003C/code> commands without any arguments show the built-in CLI help, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>clevis encrypt tang\u003C/strong>\u003C/span>\nUsage: clevis encrypt tang CONFIG &lt; PLAINTEXT &gt; JWE\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the Clevis framework, you can configure clients for automated unlocking of LUKS-encrypted volumes when a selected Tang server is available. This creates an NBDE (Network-Bound Disk Encryption) deployment.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA Tang server is running and available.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo automatically unlock an existing LUKS-encrypted volume, install the \u003Ccode class=\"literal\">clevis-luks\u003C/code> subpackage:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install clevis-luks\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIdentify the LUKS-encrypted volume for PBD. In the following example, the block device is referred as \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>lsblk\u003C/strong>\u003C/span>\nNAME                                          MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT\nsda                                             8:0    0    12G  0 disk\n├─sda1                                          8:1    0     1G  0 part  /boot\n└─sda2                                          8:2    0    11G  0 part\n  └─luks-40e20552-2ade-4954-9d56-565aa7994fb6 253:0    0    11G  0 crypt\n    ├─rhel-root                               253:0    0   9.8G  0 lvm   /\n    └─rhel-swap                               253:1    0   1.2G  0 lvm   [SWAP]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBind the volume to a Tang server using the \u003Ccode class=\"literal command\">clevis luks bind\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks bind -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span> tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>http://tang.srv\u003C/em>\u003C/span>\"}'\u003C/strong>\u003C/span>\nThe advertisement contains the following signing keys:\n\n_OsIk0T-E2l6qjfdDiwVmidoZjA\n\nDo you wish to trust these keys? [ynYN] y\nYou are about to initialize a LUKS device for metadata storage.\nAttempting to initialize it may result in data loss if data was\nalready written into the LUKS header gap in a different format.\nA backup is advised before initialization is performed.\n\nDo you wish to initialize /dev/sda2? [yn] y\nEnter existing LUKS password:\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis command performs four steps:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tCreates a new key with the same entropy as the LUKS master key.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEncrypts the new key with Clevis.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tStores the Clevis JWE object in the LUKS2 header token or uses LUKSMeta if the non-default LUKS1 header is used.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnables the new key for use with LUKS.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe binding procedure assumes that there is at least one free LUKS password slot. The \u003Ccode class=\"literal\">clevis luks bind\u003C/code> command takes one of the slots.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe volume can now be unlocked with your existing password as well as with the Clevis policy.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo enable the early boot system to process the disk binding, use the \u003Ccode class=\"literal\">dracut\u003C/code> tool on an already installed system. In RHEL, Clevis produces a generic \u003Ccode class=\"literal\">initrd\u003C/code> (initial RAM disk) without host-specific configuration options and does not automatically add parameters such as \u003Ccode class=\"literal\">rd.neednet=1\u003C/code> to the kernel command line. If your configuration relies on a Tang pin that requires network during early boot, use the \u003Ccode class=\"literal\">--hostonly-cmdline\u003C/code> argument and \u003Ccode class=\"literal\">dracut\u003C/code> adds \u003Ccode class=\"literal\">rd.neednet=1\u003C/code> when it detects a Tang binding:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">clevis-dracut\u003C/code> package:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install clevis-dracut\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRegenerate the initial RAM disk:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dracut -fv --regenerate-all --hostonly-cmdline\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAlternatively, create a .conf file in the \u003Ccode class=\"literal\">/etc/dracut.conf.d/\u003C/code> directory, and add the \u003Ccode class=\"literal\">hostonly_cmdline=yes\u003C/code> option to the file. Then, you can use \u003Ccode class=\"literal\">dracut\u003C/code> without \u003Ccode class=\"literal\">--hostonly-cmdline\u003C/code>, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>echo \"hostonly_cmdline=yes\" &gt; /etc/dracut.conf.d/clevis.conf\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>dracut -fv --regenerate-all\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tYou can also ensure that networking for a Tang pin is available during early boot by using the \u003Ccode class=\"literal\">grubby\u003C/code> tool on the system where Clevis is installed:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>grubby --update-kernel=ALL --args=\"rd.neednet=1\"\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the Clevis JWE object is successfully placed in a LUKS header, use the \u003Ccode class=\"literal\">clevis luks list\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks list -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n1: tang '{\"url\":\"http://tang.srv:port\"}'\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the bindings are available for the early boot, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>lsinitrd | grep clevis-luks\u003C/strong>\u003C/span>\nlrwxrwxrwx   1 root     root           48 Jan  4 02:56 etc/systemd/system/cryptsetup.target.wants/clevis-luks-askpass.path -&gt; /usr/lib/systemd/system/clevis-luks-askpass.path\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">clevis-luks-bind(1)\u003C/code> and \u003Ccode class=\"literal\">dracut.cmdline(7)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/boot_options_for_rhel_installer/kickstart-and-advanced-boot-options_boot-options-for-rhel-installer#network-boot-options_kickstart-and-advanced-boot-options\">Network boot options\u003C/a> in the Boot options for RHEL Installer document\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/sysadmin/network-confi-initrd\">Looking forward to Linux network configuration in the initial ramdisk (initrd)\u003C/a> (Red Hat Enable Sysadmin)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-nbde-clients-with-static-ip-configuration_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.7. Configuring NBDE clients with static IP configuration\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo use NBDE for clients with static IP configuration (without DHCP), you must pass your network configuration to the \u003Ccode class=\"literal\">dracut\u003C/code> tool manually.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA Tang server is running and available.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe NBDE client is configured for automated unlocking of encrypted volumes by the Tang server.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details, see \u003Ca class=\"link\" href=\"#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\" title=\"10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes\">Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can provide your static network configuration as a value for the \u003Ccode class=\"literal\">kernel-cmdline\u003C/code> option in a \u003Ccode class=\"literal\">dracut\u003C/code> command, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dracut -fv --regenerate-all --kernel-cmdline \"ip=192.0.2.10::192.0.2.1:255.255.255.0::ens3:none nameserver=192.0.2.100\"\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, create a .conf file in the \u003Ccode class=\"literal\">/etc/dracut.conf.d/\u003C/code> directory with the static network information and then, regenerate the initial RAM disk image:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/dracut.conf.d/static_ip.conf\u003C/strong>\u003C/span>\nkernel_cmdline=\"ip=192.0.2.10::192.0.2.1:255.255.255.0::ens3:none nameserver=192.0.2.100\"\n# \u003Cspan class=\"strong strong\">\u003Cstrong>dracut -fv --regenerate-all\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-manual-enrollment-of-volumes-using-tpm2_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.8. Configuring manual enrollment of LUKS-encrypted volumes by using a TPM 2.0 policy\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure unlocking of LUKS-encrypted volumes by using a Trusted Platform Module 2.0 (TPM 2.0) policy.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn accessible TPM 2.0-compatible device.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA system with the 64-bit Intel or 64-bit AMD architecture.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo automatically unlock an existing LUKS-encrypted volume, install the \u003Ccode class=\"literal package\">clevis-luks\u003C/code> subpackage:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install clevis-luks\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIdentify the LUKS-encrypted volume for PBD. In the following example, the block device is referred as \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>lsblk\u003C/strong>\u003C/span>\nNAME                                          MAJ:MIN RM   SIZE RO TYPE  MOUNTPOINT\nsda                                             8:0    0    12G  0 disk\n├─sda1                                          8:1    0     1G  0 part  /boot\n└─sda2                                          8:2    0    11G  0 part\n  └─luks-40e20552-2ade-4954-9d56-565aa7994fb6 253:0    0    11G  0 crypt\n    ├─rhel-root                               253:0    0   9.8G  0 lvm   /\n    └─rhel-swap                               253:1    0   1.2G  0 lvm   [SWAP]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBind the volume to a TPM 2.0 device using the \u003Ccode class=\"literal command\">clevis luks bind\u003C/code> command, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks bind -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span> tpm2 '{\"hash\":\"sha256\",\"key\":\"rsa\"}'\u003C/strong>\u003C/span>\n...\nDo you wish to initialize /dev/sda2? [yn] y\nEnter existing LUKS password:\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis command performs four steps:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tCreates a new key with the same entropy as the LUKS master key.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEncrypts the new key with Clevis.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tStores the Clevis JWE object in the LUKS2 header token or uses LUKSMeta if the non-default LUKS1 header is used.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnables the new key for use with LUKS.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tThe binding procedure assumes that there is at least one free LUKS password slot. The \u003Ccode class=\"literal command\">clevis luks bind\u003C/code> command takes one of the slots.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAlternatively, if you want to seal data to specific Platform Configuration Registers (PCR) states, add the \u003Ccode class=\"literal\">pcr_bank\u003C/code> and \u003Ccode class=\"literal\">pcr_ids\u003C/code> values to the \u003Ccode class=\"literal command\">clevis luks bind\u003C/code> command, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks bind -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span> tpm2 '{\"hash\":\"sha256\",\"key\":\"rsa\",\"pcr_bank\":\"sha256\",\"pcr_ids\":\"0,1\"}'\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tBecause the data can only be unsealed if PCR hashes values match the policy used when sealing and the hashes can be rewritten, add a strong passphrase that enable you to unlock the encrypted volume manually when a value in a PCR changes.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\tIf the system cannot automatically unlock your encrypted volume after an upgrade of the \u003Ccode class=\"literal package\">shim-x64\u003C/code> package, follow the steps in the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/6175492\">Clevis TPM2 no longer decrypts LUKS devices after a restart\u003C/a> KCS article.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe volume can now be unlocked with your existing password as well as with the Clevis policy.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo enable the early boot system to process the disk binding, use the \u003Ccode class=\"literal\">dracut\u003C/code> tool on an already installed system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install clevis-dracut\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>dracut -fv --regenerate-all\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo verify that the Clevis JWE object is successfully placed in a LUKS header, use the \u003Ccode class=\"literal\">clevis luks list\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks list -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n1: tpm2 '{\"hash\":\"sha256\",\"key\":\"rsa\"}'\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">clevis-luks-bind(1)\u003C/code>, \u003Ccode class=\"literal\">clevis-encrypt-tpm2(1)\u003C/code>, and \u003Ccode class=\"literal\">dracut.cmdline(7)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"removing-a-clevis-pin-from-a-luks-encrypted-volume-manually_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.9. Removing a Clevis pin from a LUKS-encrypted volume manually\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the following procedure for manual removing the metadata created by the \u003Ccode class=\"literal\">clevis luks bind\u003C/code> command and also for wiping a key slot that contains passphrase added by Clevis.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe recommended way to remove a Clevis pin from a LUKS-encrypted volume is through the \u003Ccode class=\"literal\">clevis luks unbind\u003C/code> command. The removal procedure using \u003Ccode class=\"literal\">clevis luks unbind\u003C/code> consists of only one step and works for both LUKS1 and LUKS2 volumes. The following example command removes the metadata created by the binding step and wipe the key slot \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>1\u003C/em>\u003C/span>\u003C/code> on the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>\u003C/code> device:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks unbind -d /dev/sda2 -s 1\u003C/strong>\u003C/span>\u003C/pre>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA LUKS-encrypted volume with a Clevis binding.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck which LUKS version the volume, for example \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>\u003C/code>, is encrypted by and identify a slot and a token that is bound to Clevis:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup luksDump \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nLUKS header information\nVersion:        2\n...\nKeyslots:\n  0: luks2\n...\n1: luks2\n      Key:        512 bits\n      Priority:   normal\n      Cipher:     aes-xts-plain64\n...\n      Tokens:\n        0: clevis\n              Keyslot:  1\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the previous example, the Clevis token is identified by \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>0\u003C/em>\u003C/span>\u003C/code> and the associated key slot is \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>1\u003C/em>\u003C/span>\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn case of LUKS2 encryption, remove the token:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup token remove --token-id \u003Cspan class=\"emphasis\">\u003Cem>0\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf your device is encrypted by LUKS1, which is indicated by the \u003Ccode class=\"literal\">Version: 1\u003C/code> string in the output of the \u003Ccode class=\"literal\">cryptsetup luksDump\u003C/code> command, perform this additional step with the \u003Ccode class=\"literal\">luksmeta wipe\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>luksmeta wipe -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span> -s \u003Cspan class=\"emphasis\">\u003Cem>1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWipe the key slot containing the Clevis passphrase:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cryptsetup luksKillSlot \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda2\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">clevis-luks-unbind(1)\u003C/code>, \u003Ccode class=\"literal\">cryptsetup(8)\u003C/code>, and \u003Ccode class=\"literal\">luksmeta(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.10. Configuring automated enrollment of LUKS-encrypted volumes by using Kickstart\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow the steps in this procedure to configure an automated installation process that uses Clevis for the enrollment of LUKS-encrypted volumes.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstruct Kickstart to partition the disk such that LUKS encryption has enabled for all mount points, other than \u003Ccode class=\"literal\">/boot\u003C/code>, with a temporary password. The password is temporary for this step of the enrollment process.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">part /boot --fstype=\"xfs\" --ondisk=vda --size=256\npart / --fstype=\"xfs\" --ondisk=vda --grow --encrypted --passphrase=temppass\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that OSPP-compliant systems require a more complex configuration, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">part /boot --fstype=\"xfs\" --ondisk=vda --size=256\npart / --fstype=\"xfs\" --ondisk=vda --size=2048 --encrypted --passphrase=temppass\npart /var --fstype=\"xfs\" --ondisk=vda --size=1024 --encrypted --passphrase=temppass\npart /tmp --fstype=\"xfs\" --ondisk=vda --size=1024 --encrypted --passphrase=temppass\npart /home --fstype=\"xfs\" --ondisk=vda --size=2048 --grow --encrypted --passphrase=temppass\npart /var/log --fstype=\"xfs\" --ondisk=vda --size=1024 --encrypted --passphrase=temppass\npart /var/log/audit --fstype=\"xfs\" --ondisk=vda --size=1024 --encrypted --passphrase=temppass\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the related Clevis packages by listing them in the \u003Ccode class=\"literal\">%packages\u003C/code> section:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">%packages\nclevis-dracut\nclevis-luks\nclevis-systemd\n%end\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: To ensure that you can unlock the encrypted volume manually when required, add a strong passphrase before you remove the temporary passphrase. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/230993\">How to add a passphrase, key, or keyfile to an existing LUKS device\u003C/a> article for more information.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCall \u003Ccode class=\"literal command\">clevis luks bind\u003C/code> to perform binding in the \u003Ccode class=\"literal\">%post\u003C/code> section. Afterward, remove the temporary password:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">%post\nclevis luks bind -y -k - -d /dev/vda2 \\\ntang '{\"url\":\"http://tang.srv\"}' &lt;&lt;&lt; \"temppass\"\ncryptsetup luksRemoveKey /dev/vda2 &lt;&lt;&lt; \"temppass\"\ndracut -fv --regenerate-all\n%end\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf your configuration relies on a Tang pin that requires network during early boot or you use NBDE clients with static IP configurations, you have to modify the \u003Ccode class=\"literal\">dracut\u003C/code> command as described in \u003Ca class=\"link\" href=\"#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\" title=\"10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes\">Configuring manual enrollment of LUKS-encrypted volumes\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that the \u003Ccode class=\"literal\">-y\u003C/code> option for the \u003Ccode class=\"literal\">clevis luks bind\u003C/code> command is available from RHEL 8.3. In RHEL 8.2 and older, replace \u003Ccode class=\"literal\">-y\u003C/code> by \u003Ccode class=\"literal\">-f\u003C/code> in the \u003Ccode class=\"literal\">clevis luks bind\u003C/code> command and download the advertisement from the Tang server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">%post\ncurl -sfg http://tang.srv/adv -o adv.jws\nclevis luks bind -f -k - -d /dev/vda2 \\\ntang '{\"url\":\"http://tang.srv\",\"adv\":\"adv.jws\"}' &lt;&lt;&lt; \"temppass\"\ncryptsetup luksRemoveKey /dev/vda2 &lt;&lt;&lt; \"temppass\"\ndracut -fv --regenerate-all\n%end\u003C/pre>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cryptsetup luksRemoveKey\u003C/code> command prevents any further administration of a LUKS2 device on which you apply it. You can recover a removed master key using the \u003Ccode class=\"literal\">dmsetup\u003C/code> command only for LUKS1 devices.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou can use an analogous procedure when using a TPM 2.0 policy instead of a Tang server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">clevis(1)\u003C/code>, \u003Ccode class=\"literal\">clevis-luks-bind(1)\u003C/code>, \u003Ccode class=\"literal\">cryptsetup(8)\u003C/code>, and \u003Ccode class=\"literal\">dmsetup(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automatically_installing_rhel/index\">Automatically installing RHEL\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-automated-unlocking-of-a-luks-encrypted-removable-storage-device_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.11. Configuring automated unlocking of a LUKS-encrypted removable storage device\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can set up an automated unlocking process of a LUKS-encrypted USB storage device.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo automatically unlock a LUKS-encrypted removable storage device, such as a USB drive, install the \u003Ccode class=\"literal package\">clevis-udisks2\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install clevis-udisks2\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReboot the system, and then perform the binding step using the \u003Ccode class=\"literal command\">clevis luks bind\u003C/code> command as described in \u003Ca class=\"link\" href=\"#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\" title=\"10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes\">Configuring manual enrollment of LUKS-encrypted volumes\u003C/a>, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks bind -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sdb1\u003C/em>\u003C/span> tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>http://tang.srv\u003C/em>\u003C/span>\"}'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe LUKS-encrypted removable device can be now unlocked automatically in your GNOME desktop session. The device bound to a Clevis policy can be also unlocked by the \u003Ccode class=\"literal command\">clevis luks unlock\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks unlock -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sdb1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou can use an analogous procedure when using a TPM 2.0 policy instead of a Tang server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">clevis-luks-unlockers(7)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-high-availability-nbde-systems_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.12. Deploying high-availability NBDE systems\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTang provides two methods for building a high-availability deployment:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Client redundancy (recommended)\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tClients should be configured with the ability to bind to multiple Tang servers. In this setup, each Tang server has its own keys and clients can decrypt by contacting a subset of these servers. Clevis already supports this workflow through its \u003Ccode class=\"literal\">sss\u003C/code> plug-in. Red Hat recommends this method for a high-availability deployment.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Key sharing\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tFor redundancy purposes, more than one instance of Tang can be deployed. To set up a second or any subsequent instance, install the \u003Ccode class=\"literal\">tang\u003C/code> packages and copy the key directory to the new host using \u003Ccode class=\"literal\">rsync\u003C/code> over \u003Ccode class=\"literal\">SSH\u003C/code>. Note that Red Hat does not recommend this method because sharing keys increases the risk of key compromise and requires additional automation infrastructure.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Ch5 id=\"high_available_nbde_using_shamir_s_secret_sharing\">High-available NBDE using Shamir’s Secret Sharing\u003C/h5>\u003Cp>\n\t\t\t\tShamir’s Secret Sharing (SSS) is a cryptographic scheme that divides a secret into several unique parts. To reconstruct the secret, a number of parts is required. The number is called threshold and SSS is also referred to as a thresholding scheme.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tClevis provides an implementation of SSS. It creates a key and divides it into a number of pieces. Each piece is encrypted using another pin including even SSS recursively. Additionally, you define the threshold \u003Ccode class=\"literal\">t\u003C/code>. If an NBDE deployment decrypts at least \u003Ccode class=\"literal\">t\u003C/code> pieces, then it recovers the encryption key and the decryption process succeeds. When Clevis detects a smaller number of parts than specified in the threshold, it prints an error message.\n\t\t\t\u003C/p>\u003Ch5 id=\"example_1_redundancy_with_two_tang_servers\">Example 1: Redundancy with two Tang servers\u003C/h5>\u003Cp>\n\t\t\t\tThe following command decrypts a LUKS-encrypted device when at least one of two Tang servers is available:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks bind -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda1\u003C/em>\u003C/span> sss '{\"t\":1,\"pins\":{\"tang\":[{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>http://tang1.srv\u003C/em>\u003C/span>\"},{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>http://tang2.srv\u003C/em>\u003C/span>\"}]}}'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tThe previous command used the following configuration scheme:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">{\n    \"t\":1,\n    \"pins\":{\n        \"tang\":[\n            {\n                \"url\":\"http://tang1.srv\"\n            },\n            {\n                \"url\":\"http://tang2.srv\"\n            }\n        ]\n    }\n}\u003C/pre>\u003Cp>\n\t\t\t\tIn this configuration, the SSS threshold \u003Ccode class=\"literal\">t\u003C/code> is set to \u003Ccode class=\"literal\">1\u003C/code> and the \u003Ccode class=\"literal\">clevis luks bind\u003C/code> command successfully reconstructs the secret if at least one from two listed \u003Ccode class=\"literal\">tang\u003C/code> servers is available.\n\t\t\t\u003C/p>\u003Ch5 id=\"example_2_shared_secret_on_a_tang_server_and_a_tpm_device\">Example 2: Shared secret on a Tang server and a TPM device\u003C/h5>\u003Cp>\n\t\t\t\tThe following command successfully decrypts a LUKS-encrypted device when both the \u003Ccode class=\"literal\">tang\u003C/code> server and the \u003Ccode class=\"literal\">tpm2\u003C/code> device are available:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>clevis luks bind -d \u003Cspan class=\"emphasis\">\u003Cem>/dev/sda1\u003C/em>\u003C/span> sss '{\"t\":2,\"pins\":{\"tang\":[{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>http://tang1.srv\u003C/em>\u003C/span>\"}], \"tpm2\": {\"pcr_ids\":\"0,7\"}}}'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tThe configuration scheme with the SSS threshold 't' set to '2' is now:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">{\n    \"t\":2,\n    \"pins\":{\n        \"tang\":[\n            {\n                \"url\":\"http://tang1.srv\"\n            }\n        ],\n        \"tpm2\":{\n            \"pcr_ids\":\"0,7\"\n        }\n    }\n}\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">tang(8)\u003C/code> (section \u003Ccode class=\"literal\">High Availability\u003C/code>), \u003Ccode class=\"literal\">clevis(1)\u003C/code> (section \u003Ccode class=\"literal\">Shamir’s Secret Sharing\u003C/code>), and \u003Ccode class=\"literal\">clevis-encrypt-sss(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deployment-of-virtual-machines-in-a-nbde-network_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.13. Deployment of virtual machines in a NBDE network\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal command\">clevis luks bind\u003C/code> command does not change the LUKS master key. This implies that if you create a LUKS-encrypted image for use in a virtual machine or cloud environment, all the instances that run this image share a master key. This is extremely insecure and should be avoided at all times.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis is not a limitation of Clevis but a design principle of LUKS. If your scenario requires having encrypted root volumes in a cloud, perform the installation process (usually using Kickstart) for each instance of Red Hat Enterprise Linux in the cloud as well. The images cannot be shared without also sharing a LUKS master key.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo deploy automated unlocking in a virtualized environment, use systems such as \u003Ccode class=\"literal\">lorax\u003C/code> or \u003Ccode class=\"literal\">virt-install\u003C/code> together with a Kickstart file (see \u003Ca class=\"link\" href=\"#configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\" title=\"10.10. Configuring automated enrollment of LUKS-encrypted volumes by using Kickstart\">Configuring automated enrollment of LUKS-encrypted volumes using Kickstart\u003C/a>) or another automated provisioning tool to ensure that each encrypted VM has a unique master key.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">clevis-luks-bind(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"building-automatically-enrollable-vm-images-for-cloud-environments_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.14. Building automatically-enrollable VM images for cloud environments by using NBDE\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tDeploying automatically-enrollable encrypted images in a cloud environment can provide a unique set of challenges. Like other virtualization environments, it is recommended to reduce the number of instances started from a single image to avoid sharing the LUKS master key.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTherefore, the best practice is to create customized images that are not shared in any public repository and that provide a base for the deployment of a limited amount of instances. The exact number of instances to create should be defined by deployment’s security policies and based on the risk tolerance associated with the LUKS master key attack vector.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo build LUKS-enabled automated deployments, systems such as Lorax or virt-install together with a Kickstart file should be used to ensure master key uniqueness during the image building process.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tCloud environments enable two Tang server deployment options which we consider here. First, the Tang server can be deployed within the cloud environment itself. Second, the Tang server can be deployed outside of the cloud on independent infrastructure with a VPN link between the two infrastructures.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDeploying Tang natively in the cloud does allow for easy deployment. However, given that it shares infrastructure with the data persistence layer of ciphertext of other systems, it may be possible for both the Tang server’s private key and the Clevis metadata to be stored on the same physical disk. Access to this physical disk permits a full compromise of the ciphertext data.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tAlways maintain a physical separation between the location where the data is stored and the system where Tang is running. This separation between the cloud and the Tang server ensures that the Tang server’s private key cannot be accidentally combined with the Clevis metadata. It also provides local control of the Tang server if the cloud infrastructure is at risk.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"proc_deploying-tang-as-a-container_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.15. Deploying Tang as a container\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">tang\u003C/code> container image provides Tang-server decryption capabilities for Clevis clients that run either in OpenShift Container Platform (OCP) clusters or in separate virtual machines.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">podman\u003C/code> package and its dependencies are installed on the system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have logged in on the \u003Ccode class=\"literal\">registry.redhat.io\u003C/code> container catalog using the \u003Ccode class=\"literal\">podman login registry.redhat.io\u003C/code> command. See \u003Ca class=\"link\" href=\"https://access.redhat.com/RegistryAuthentication\">Red Hat Container Registry Authentication\u003C/a> for more information.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe Clevis client is installed on systems containing LUKS-encrypted volumes that you want to automatically unlock by using a Tang server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPull the \u003Ccode class=\"literal\">tang\u003C/code> container image from the \u003Ccode class=\"literal\">registry.redhat.io\u003C/code> registry:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman pull registry.redhat.io/rhel9/tang\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the container, specify its port, and specify the path to the Tang keys. The previous example runs the \u003Ccode class=\"literal\">tang\u003C/code> container, specifies the port \u003Cspan class=\"emphasis\">\u003Cem>7500\u003C/em>\u003C/span>, and indicates a path to the Tang keys of the \u003Ccode class=\"literal\">/var/db/tang\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman run -d -p 7500:7500 -v tang-keys:/var/db/tang --name tang registry.redhat.io/rhel9/tang\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that Tang uses port 80 by default but this may collide with other services such as the Apache HTTP server.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: For increased security, rotate the Tang keys periodically. You can use the \u003Ccode class=\"literal\">tangd-rotate-keys\u003C/code> script, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>podman run --rm -v tang-keys:/var/db/tang registry.redhat.io/rhel9/tang tangd-rotate-keys -v -d /var/db/tang\u003C/strong>\u003C/span>\nRotated key 'rZAMKAseaXBe0rcKXL1hCCIq-DY.jwk' -&gt; .'rZAMKAseaXBe0rcKXL1hCCIq-DY.jwk'\nRotated key 'x1AIpc6WmnCU-CabD8_4q18vDuw.jwk' -&gt; .'x1AIpc6WmnCU-CabD8_4q18vDuw.jwk'\nCreated new key GrMMX_WfdqomIU_4RyjpcdlXb0E.jwk\nCreated new key _dTTfn17sZZqVAp80u3ygFDHtjk.jwk\nKeys rotated successfully.\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn a system that contains LUKS-encrypted volumes for automated unlocking by the presence of the Tang server, check that the Clevis client can encrypt and decrypt a plain-text message using Tang:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>echo test | clevis encrypt tang '{\"url\":\"http://localhost:7500\"}' | clevis decrypt\u003C/strong>\u003C/span>\nThe advertisement contains the following signing keys:\n\nx1AIpc6WmnCU-CabD8_4q18vDuw\n\nDo you wish to trust these keys? [ynYN] y\ntest\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe previous example command shows the \u003Ccode class=\"literal\">test\u003C/code> string at the end of its output when a Tang server is available on the \u003Cspan class=\"emphasis\">\u003Cem>localhost\u003C/em>\u003C/span> URL and communicates through port \u003Cspan class=\"emphasis\">\u003Cem>7500\u003C/em>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">podman(1)\u003C/code>, \u003Ccode class=\"literal\">clevis(1)\u003C/code>, and \u003Ccode class=\"literal\">tang(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.16. Configuring NBDE by using RHEL system roles\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">nbde_client\u003C/code> and \u003Ccode class=\"literal\">nbde_server\u003C/code> RHEL system roles for automated deployments of Policy-Based Decryption (PBD) solutions using Clevis and Tang. The \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package contains these system roles, the related examples, and also the reference documentation.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.16.1. Using the \u003Ccode class=\"literal\">nbde_server\u003C/code> RHEL system role for setting up multiple Tang servers\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tBy using the \u003Ccode class=\"literal\">nbde_server\u003C/code> system role, you can deploy and manage a Tang server as part of an automated disk encryption solution. This role supports the following features:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tRotating Tang keys\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tDeploying and backing up Tang keys\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Deploy a Tang server\n- hosts: tang.server.example.com\n- tasks:\n  - name: Install and configure periodic key rotation\n    ansible.builtin.include_role:\n        name: rhel-system-roles.nbde_server\n    vars:\n      nbde_server_rotate_keys: yes\n      nbde_server_manage_firewall: true\n      nbde_server_manage_selinux: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis example playbook ensures deploying of your Tang server and a key rotation.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nbde_server_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">firewall\u003C/code> system role to manage ports used by the \u003Ccode class=\"literal\">nbde_server\u003C/code> role.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nbde_server_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">selinux\u003C/code> system role to manage ports used by the \u003Ccode class=\"literal\">nbde_server\u003C/code> role.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_server/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn your NBDE client, verify that your Tang server works correctly by using the following command. The command must return the identical message you pass for encryption and decryption:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'echo test | clevis encrypt tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;tang.server.example.com&gt;\u003C/em>\u003C/span>\"}' -y | clevis decrypt'\u003C/strong>\u003C/span>\ntest\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_server/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/nbde_server/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.16.2. Setting up Clevis clients with DHCP by using the \u003Ccode class=\"literal\">nbde_client\u003C/code> RHEL system role\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">nbde_client\u003C/code> system role enables you to deploy multiple Clevis clients in an automated way.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis role supports binding a LUKS-encrypted volume to one or more Network-Bound (NBDE) servers - Tang servers. You can either preserve the existing volume encryption with a passphrase or remove it. After removing the passphrase, you can unlock the volume only using NBDE. This is useful when a volume is initially encrypted using a temporary key or password that you should remove after you provision the system.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIf you provide both a passphrase and a key file, the role uses what you have provided first. If it does not find any of these valid, it attempts to retrieve a passphrase from an existing binding.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tPolicy-Based Decryption (PBD) defines a binding as a mapping of a device to a slot. This means that you can have multiple bindings for the same device. The default slot is slot 1.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">nbde_client\u003C/code> system role supports only Tang bindings. Therefore, you cannot use it for TPM2 bindings.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tA volume that is already encrypted by using LUKS.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure clients for unlocking of encrypted volumes by Tang servers\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Create NBDE client bindings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.nbde_client\n      vars:\n        nbde_client_bindings:\n          - device: /dev/rhel/root\n            encryption_key_src: /etc/luks/keyfile\n            nbde_client_early_boot: true\n            state: present\n            servers:\n              - http://server1.example.com\n              - http://server2.example.com\n          - device: /dev/rhel/swap\n            encryption_key_src: /etc/luks/keyfile\n            servers:\n              - http://server1.example.com\n              - http://server2.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis example playbook configures Clevis clients for automated unlocking of two LUKS-encrypted volumes when at least one of two Tang servers is available.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">state: present\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThe values of \u003Ccode class=\"literal\">state\u003C/code> indicate the configuration after you run the playbook. Use the \u003Ccode class=\"literal\">present\u003C/code> value for either creating a new binding or updating an existing one. Contrary to a \u003Ccode class=\"literal\">clevis luks bind\u003C/code> command, you can use \u003Ccode class=\"literal\">state: present\u003C/code> also for overwriting an existing binding in its device slot. The \u003Ccode class=\"literal\">absent\u003C/code> value removes a specified binding.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nbde_client_early_boot: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">nbde_client\u003C/code> role ensures that networking for a Tang pin is available during early boot by default. If you scenario requires to disable this feature, add the \u003Ccode class=\"literal\">nbde_client_early_boot: false\u003C/code> variable to your playbook.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn your NBDE client, check that the encrypted volume that should be automatically unlocked by your Tang servers contain the corresponding information in its LUKS pins:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'clevis luks list -d /dev/rhel/root'\u003C/strong>\u003C/span>\n1: tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;http://server1.example.com/&gt;\u003C/em>\u003C/span>\"}'\n2: tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;http://server2.example.com/&gt;\u003C/em>\u003C/span>\"}'\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf you do not use the \u003Ccode class=\"literal\">nbde_client_early_boot: false\u003C/code> variable, verify that the bindings are available for the early boot, for example:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'lsinitrd | grep clevis-luks'\u003C/strong>\u003C/span>\nlrwxrwxrwx   1 root     root           48 Jan  4 02:56 etc/systemd/system/cryptsetup.target.wants/clevis-luks-askpass.path -&gt; /usr/lib/systemd/system/clevis-luks-askpass.path\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/nbde_client/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">10.16.3. Setting up static-IP Clevis clients by using the \u003Ccode class=\"literal\">nbde_client\u003C/code> RHEL system role\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">nbde_client\u003C/code> RHEL system role supports only scenarios with Dynamic Host Configuration Protocol (DHCP). On an NBDE client with static IP configuration, you must pass your network configuration as a kernel boot parameter.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tTypically, administrators want to reuse a playbook and not maintain individual playbooks for each host to which Ansible assigns static IP addresses during early boot. In this case, you can use variables in the playbook and provide the settings in an external file. As a result, you need only one playbook and one file with the settings.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tA volume that is already encrypted by using LUKS.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a file with the network settings of your hosts, for example, \u003Ccode class=\"literal\">static-ip-settings-clients.yml\u003C/code>, and add the values you want to dynamically assign to the hosts:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">clients:\n  managed-node-01.example.com:\n    ip_v4: 192.0.2.1\n    gateway_v4: 192.0.2.254\n    netmask_v4: 255.255.255.0\n    interface: enp1s0\n  managed-node-02.example.com:\n    ip_v4: 192.0.2.2\n    gateway_v4: 192.0.2.254\n    netmask_v4: 255.255.255.0\n    interface: enp1s0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example, \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Configure clients for unlocking of encrypted volumes by Tang servers\n  hosts: managed-node-01.example.com,managed-node-02.example.com\n  vars_files:\n    - ~/static-ip-settings-clients.yml\n  tasks:\n    - name: Create NBDE client bindings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        nbde_client_bindings:\n          - device: /dev/rhel/root\n            encryption_key_src: /etc/luks/keyfile\n            servers:\n              - http://server1.example.com\n              - http://server2.example.com\n          - device: /dev/rhel/swap\n            encryption_key_src: /etc/luks/keyfile\n            servers:\n              - http://server1.example.com\n              - http://server2.example.com\n\n    - name: Configure a Clevis client with static IP address during early boot\n      ansible.builtin.include_role:\n        name: rhel-system-roles.bootloader\n      vars:\n        bootloader_settings:\n          - kernel: ALL\n            options:\n              - name: ip\n                value: \"{{ clients[inventory_hostname]['ip_v4'] }}::{{ clients[inventory_hostname]['gateway_v4'] }}:{{ clients[inventory_hostname]['netmask_v4'] }}::{{ clients[inventory_hostname]['interface'] }}:none\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis playbook reads certain values dynamically for each host listed in the \u003Ccode class=\"literal\">~/static-ip-settings-clients.yml\u003C/code> file.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/nbde_client/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/sysadmin/network-confi-initrd\">Looking forward to Linux network configuration in the initial ramdisk (initrd)\u003C/a> (Red Hat Enable Sysadmin)\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"auditing-the-system_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 11. Auditing the system\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAudit does not provide additional security to your system; rather, it can be used to discover violations of security policies used on your system. These violations can further be prevented by additional security measures such as SELinux.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"linux-audit_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.1. Linux Audit\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Linux Audit system provides a way to track security-relevant information about your system. Based on pre-configured rules, Audit generates log entries to record as much information about the events that are happening on your system as possible. This information is crucial for mission-critical environments to determine the violator of the security policy and the actions they performed.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following list summarizes some of the information that Audit is capable of recording in its log files:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDate and time, type, and outcome of an event\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSensitivity labels of subjects and objects\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAssociation of an event with the identity of the user who triggered the event\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAll modifications to Audit configuration and attempts to access Audit log files\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAll uses of authentication mechanisms, such as SSH, Kerberos, and others\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tChanges to any trusted database, such as \u003Ccode class=\"literal\">/etc/passwd\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAttempts to import or export information into or from the system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tInclude or exclude events based on user identity, subject and object labels, and other attributes\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe use of the Audit system is also a requirement for a number of security-related certifications. Audit is designed to meet or exceed the requirements of the following certifications or compliance guides:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tControlled Access Protection Profile (CAPP)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLabeled Security Protection Profile (LSPP)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRule Set Base Access Control (RSBAC)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNational Industrial Security Program Operating Manual (NISPOM)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFederal Information Security Management Act (FISMA)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPayment Card Industry — Data Security Standard (PCI-DSS)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSecurity Technical Implementation Guides (STIG)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tAudit has also been:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEvaluated by National Information Assurance Partnership (NIAP) and Best Security Industries (BSI)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCertified to LSPP/CAPP/RSBAC/EAL4+ on Red Hat Enterprise Linux 5\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCertified to Operating System Protection Profile / Evaluation Assurance Level 4+ (OSPP/EAL4+) on Red Hat Enterprise Linux 6\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cp class=\"title\">\u003Cstrong>Use Cases\u003C/strong>\u003C/p>\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Watching file access\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAudit can track whether a file or a directory has been accessed, modified, executed, or the file’s attributes have been changed. This is useful, for example, to detect access to important files and have an Audit trail available in case one of these files is corrupted.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Monitoring system calls\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAudit can be configured to generate a log entry every time a particular system call is used. This can be used, for example, to track changes to the system time by monitoring the \u003Ccode class=\"literal\">settimeofday\u003C/code>, \u003Ccode class=\"literal\">clock_adjtime\u003C/code>, and other time-related system calls.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Recording commands run by a user\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAudit can track whether a file has been executed, so rules can be defined to record every execution of a particular command. For example, a rule can be defined for every executable in the \u003Ccode class=\"literal\">/bin\u003C/code> directory. The resulting log entries can then be searched by user ID to generate an audit trail of executed commands per user.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Recording execution of system pathnames\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAside from watching file access which translates a path to an inode at rule invocation, Audit can now watch the execution of a path even if it does not exist at rule invocation, or if the file is replaced after rule invocation. This allows rules to continue to work after upgrading a program executable or before it is even installed.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Recording security events\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">pam_faillock\u003C/code> authentication module is capable of recording failed login attempts. Audit can be set up to record failed login attempts as well and provides additional information about the user who attempted to log in.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Searching for events\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAudit provides the \u003Ccode class=\"literal application\">ausearch\u003C/code> utility, which can be used to filter the log entries and provide a complete audit trail based on several conditions.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Running summary reports\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal application\">aureport\u003C/code> utility can be used to generate, among other things, daily reports of recorded events. A system administrator can then analyze these reports and investigate suspicious activity further.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Monitoring network access\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal application\">nftables\u003C/code>, \u003Ccode class=\"literal application\">iptables\u003C/code>, and \u003Ccode class=\"literal application\">ebtables\u003C/code> utilities can be configured to trigger Audit events, allowing system administrators to monitor network access.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tSystem performance may be affected depending on the amount of information that is collected by Audit.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"audit-system-architecture_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.2. Audit system architecture\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Audit system consists of two main parts: the user-space applications and utilities, and the kernel-side system call processing. The kernel component receives system calls from user-space applications and filters them through one of the following filters: \u003Cspan class=\"strong strong\">\u003Cstrong>user\u003C/strong>\u003C/span>, \u003Cspan class=\"strong strong\">\u003Cstrong>task\u003C/strong>\u003C/span>, \u003Cspan class=\"strong strong\">\u003Cstrong>fstype\u003C/strong>\u003C/span>, or \u003Cspan class=\"strong strong\">\u003Cstrong>exit\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAfter a system call passes the \u003Cspan class=\"strong strong\">\u003Cstrong>exclude\u003C/strong>\u003C/span> filter, it is sent through one of the aforementioned filters, which, based on the Audit rule configuration, sends it to the Audit daemon for further processing.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe user-space Audit daemon collects the information from the kernel and creates entries in a log file. Other Audit user-space utilities interact with the Audit daemon, the kernel Audit component, or the Audit log files:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal application\">auditctl\u003C/code> Audit control utility interacts with the kernel Audit component to manage rules and to control many settings and parameters of the event generation process.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe remaining Audit utilities take the contents of the Audit log files as input and generate output based on user’s requirements. For example, the \u003Ccode class=\"literal application\">aureport\u003C/code> utility generates a report of all recorded events.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIn RHEL 9, the Audit dispatcher daemon (\u003Ccode class=\"literal application\">audisp\u003C/code>) functionality is integrated in the Audit daemon (\u003Ccode class=\"literal\">auditd\u003C/code>). Configuration files of plugins for the interaction of real-time analytical programs with Audit events are located in the \u003Ccode class=\"literal filename\">/etc/audit/plugins.d/\u003C/code> directory by default.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"configuring-auditd-for-a-secure-environment_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.3. Configuring auditd for a secure environment\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe default \u003Ccode class=\"literal\">auditd\u003C/code> configuration should be suitable for most environments. However, if your environment must meet strict security policies, you can change the following settings for the Audit daemon configuration in the \u003Ccode class=\"literal filename\">/etc/audit/auditd.conf\u003C/code> file:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">log_file\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe directory that holds the Audit log files (usually \u003Ccode class=\"literal filename\">/var/log/audit/\u003C/code>) should reside on a separate mount point. This prevents other processes from consuming space in this directory and provides accurate detection of the remaining space for the Audit daemon.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">max_log_file\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the maximum size of a single Audit log file, must be set to make full use of the available space on the partition that holds the Audit log files. The \u003Ccode class=\"literal\">max_log_file`\u003C/code> parameter specifies the maximum file size in megabytes. The value given must be numeric.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">max_log_file_action\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDecides what action is taken once the limit set in \u003Ccode class=\"literal\">max_log_file\u003C/code> is reached, should be set to \u003Ccode class=\"literal\">keep_logs\u003C/code> to prevent Audit log files from being overwritten.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">space_left\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the amount of free space left on the disk for which an action that is set in the \u003Ccode class=\"literal\">space_left_action\u003C/code> parameter is triggered. Must be set to a number that gives the administrator enough time to respond and free up disk space. The \u003Ccode class=\"literal\">space_left\u003C/code> value depends on the rate at which the Audit log files are generated. If the value of space_left is specified as a whole number, it is interpreted as an absolute size in megabytes (MiB). If the value is specified as a number between 1 and 99 followed by a percentage sign (for example, 5%), the Audit daemon calculates the absolute size in megabytes based on the size of the file system containing \u003Ccode class=\"literal\">log_file\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">space_left_action\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIt is recommended to set the \u003Ccode class=\"literal\">space_left_action\u003C/code> parameter to \u003Ccode class=\"literal\">email\u003C/code> or \u003Ccode class=\"literal\">exec\u003C/code> with an appropriate notification method.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">admin_space_left\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the absolute minimum amount of free space for which an action that is set in the \u003Ccode class=\"literal\">admin_space_left_action\u003C/code> parameter is triggered, must be set to a value that leaves enough space to log actions performed by the administrator. The numeric value for this parameter should be lower than the number for space_left. You can also append a percent sign (for example, 1%) to the number to have the audit daemon calculate the number based on the disk partition size.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">admin_space_left_action\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tShould be set to \u003Ccode class=\"literal\">single\u003C/code> to put the system into single-user mode and allow the administrator to free up some disk space.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">disk_full_action\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies an action that is triggered when no free space is available on the partition that holds the Audit log files, must be set to \u003Ccode class=\"literal\">halt\u003C/code> or \u003Ccode class=\"literal\">single\u003C/code>. This ensures that the system is either shut down or operating in single-user mode when Audit can no longer log events.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">disk_error_action\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies an action that is triggered in case an error is detected on the partition that holds the Audit log files, must be set to \u003Ccode class=\"literal\">syslog\u003C/code>, \u003Ccode class=\"literal\">single\u003C/code>, or \u003Ccode class=\"literal\">halt\u003C/code>, depending on your local security policies regarding the handling of hardware malfunctions.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">flush\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tShould be set to \u003Ccode class=\"literal\">incremental_async\u003C/code>. It works in combination with the \u003Ccode class=\"literal\">freq\u003C/code> parameter, which determines how many records can be sent to the disk before forcing a hard synchronization with the hard drive. The \u003Ccode class=\"literal\">freq\u003C/code> parameter should be set to \u003Ccode class=\"literal\">100\u003C/code>. These parameters assure that Audit event data is synchronized with the log files on the disk while keeping good performance for bursts of activity.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tThe remaining configuration options should be set according to your local security policy.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"starting-the-audit-service_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.4. Starting and controlling auditd\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAfter \u003Ccode class=\"literal\">auditd\u003C/code> is configured, start the service to collect Audit information and store it in the log files. Use the following command as the root user to start \u003Ccode class=\"literal\">auditd\u003C/code>:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>service auditd start\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tTo configure \u003Ccode class=\"literal\">auditd\u003C/code> to start at boot time:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable auditd\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tYou can temporarily disable \u003Ccode class=\"literal\">auditd\u003C/code> with the \u003Ccode class=\"literal\"># auditctl -e 0\u003C/code> command and re-enable it with \u003Ccode class=\"literal\"># auditctl -e 1\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can perform other actions on \u003Ccode class=\"literal\">auditd\u003C/code> by using the \u003Ccode class=\"literal command\">service auditd \u003Cspan class=\"emphasis\">\u003Cem>&lt;action&gt;\u003C/em>\u003C/span>\u003C/code> command, where \u003Cspan class=\"emphasis\">\u003Cem>&lt;action&gt;\u003C/em>\u003C/span> can be one of the following:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal command\">stop\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tStops \u003Ccode class=\"literal\">auditd\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal command\">restart\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tRestarts \u003Ccode class=\"literal\">auditd\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal command\">reload\u003C/code> or \u003Ccode class=\"literal command\">force-reload\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tReloads the configuration of \u003Ccode class=\"literal application\">auditd\u003C/code> from the \u003Ccode class=\"literal\">/etc/audit/auditd.conf\u003C/code> file.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal command\">rotate\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tRotates the log files in the \u003Ccode class=\"literal\">/var/log/audit/\u003C/code> directory.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal command\">resume\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tResumes logging of Audit events after it has been previously suspended, for example, when there is not enough free space on the disk partition that holds the Audit log files.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal command\">condrestart\u003C/code> or \u003Ccode class=\"literal command\">try-restart\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tRestarts \u003Ccode class=\"literal application\">auditd\u003C/code> only if it is already running.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal command\">status\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDisplays the running status of \u003Ccode class=\"literal application\">auditd\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal command\">service\u003C/code> command is the only way to correctly interact with the \u003Ccode class=\"literal\">auditd\u003C/code> daemon. You need to use the \u003Ccode class=\"literal command\">service\u003C/code> command so that the \u003Ccode class=\"literal\">auid\u003C/code> value is properly recorded. You can use the \u003Ccode class=\"literal command\">systemctl\u003C/code> command only for two actions: \u003Ccode class=\"literal command\">enable\u003C/code> and \u003Ccode class=\"literal command\">status\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"understanding-audit-log-files_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.5. Understanding Audit log files\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBy default, the Audit system stores log entries in the \u003Ccode class=\"literal filename\">/var/log/audit/audit.log\u003C/code> file; if log rotation is enabled, rotated \u003Ccode class=\"literal filename\">audit.log\u003C/code> files are stored in the same directory.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAdd the following Audit rule to log every attempt to read or modify the \u003Ccode class=\"literal filename\">/etc/ssh/sshd_config\u003C/code> file:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -w /etc/ssh/sshd_config -p warx -k sshd_config\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tIf the \u003Ccode class=\"literal\">auditd\u003C/code> daemon is running, for example, using the following command creates a new event in the Audit log file:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ssh/sshd_config\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tThis event in the \u003Ccode class=\"literal\">audit.log\u003C/code> file looks as follows:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">type=SYSCALL msg=audit(1364481363.243:24287): arch=c000003e syscall=2 success=no exit=-13 a0=7fffd19c5592 a1=0 a2=7fffd19c4b50 a3=a items=1 ppid=2686 pid=3538 auid=1000 uid=1000 gid=1000 euid=1000 suid=1000 fsuid=1000 egid=1000 sgid=1000 fsgid=1000 tty=pts0 ses=1 comm=\"cat\" exe=\"/bin/cat\" subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key=\"sshd_config\"\ntype=CWD msg=audit(1364481363.243:24287):  cwd=\"/home/shadowman\"\ntype=PATH msg=audit(1364481363.243:24287): item=0 name=\"/etc/ssh/sshd_config\" inode=409248 dev=fd:00 mode=0100600 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:etc_t:s0  nametype=NORMAL cap_fp=none cap_fi=none cap_fe=0 cap_fver=0\ntype=PROCTITLE msg=audit(1364481363.243:24287) : proctitle=636174002F6574632F7373682F737368645F636F6E666967\u003C/pre>\u003Cp>\n\t\t\t\tThe above event consists of four records, which share the same time stamp and serial number. Records always start with the \u003Ccode class=\"literal\">type=\u003C/code> keyword. Each record consists of several \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>name\u003C/em>\u003C/span>=\u003Cspan class=\"emphasis\">\u003Cem>value\u003C/em>\u003C/span>\u003C/code> pairs separated by a white space or a comma. A detailed analysis of the above event follows:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cp class=\"title\">\u003Cstrong>First Record\u003C/strong>\u003C/p>\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">type=SYSCALL\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">type\u003C/code> field contains the type of the record. In this example, the \u003Ccode class=\"literal\">SYSCALL\u003C/code> value specifies that this record was triggered by a system call to the kernel.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">msg=audit(1364481363.243:24287):\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">msg\u003C/code> field records:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tA time stamp and a unique ID of the record in the form \u003Ccode class=\"literal\">audit(\u003Cspan class=\"emphasis\">\u003Cem>time_stamp\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>ID\u003C/em>\u003C/span>)\u003C/code>. Multiple records can share the same time stamp and ID if they were generated as part of the same Audit event. The time stamp is using the Unix time format - seconds since 00:00:00 UTC on 1 January 1970.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tVarious event-specific \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>name\u003C/em>\u003C/span>=\u003Cspan class=\"emphasis\">\u003Cem>value\u003C/em>\u003C/span>\u003C/code> pairs provided by the kernel or user-space applications.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">arch=c000003e\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">arch\u003C/code> field contains information about the CPU architecture of the system. The value, \u003Ccode class=\"literal\">c000003e\u003C/code>, is encoded in hexadecimal notation. When searching Audit records with the \u003Ccode class=\"literal command\">ausearch\u003C/code> command, use the \u003Ccode class=\"literal option\">-i\u003C/code> or \u003Ccode class=\"literal option\">--interpret\u003C/code> option to automatically convert hexadecimal values into their human-readable equivalents. The \u003Ccode class=\"literal\">c000003e\u003C/code> value is interpreted as \u003Ccode class=\"literal\">x86_64\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">syscall=2\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">syscall\u003C/code> field records the type of the system call that was sent to the kernel. The value, \u003Ccode class=\"literal\">2\u003C/code>, can be matched with its human-readable equivalent in the \u003Ccode class=\"literal\">/usr/include/asm/unistd_64.h\u003C/code> file. In this case, \u003Ccode class=\"literal\">2\u003C/code> is the \u003Ccode class=\"literal\">open\u003C/code> system call. Note that the \u003Ccode class=\"literal application\">ausyscall\u003C/code> utility allows you to convert system call numbers to their human-readable equivalents. Use the \u003Ccode class=\"literal command\">ausyscall --dump\u003C/code> command to display a listing of all system calls along with their numbers. For more information, see the \u003Ccode class=\"literal\">ausyscall\u003C/code>(8) man page.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">success=no\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">success\u003C/code> field records whether the system call recorded in that particular event succeeded or failed. In this case, the call did not succeed.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">exit=-13\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">exit\u003C/code> field contains a value that specifies the exit code returned by the system call. This value varies for a different system call. You can interpret the value to its human-readable equivalent with the following command:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch --interpret --exit -13\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that the previous example assumes that your Audit log contains an event that failed with exit code \u003Ccode class=\"literal\">-13\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">a0=7fffd19c5592\u003C/code>, \u003Ccode class=\"literal\">a1=0\u003C/code>, \u003Ccode class=\"literal\">a2=7fffd19c5592\u003C/code>, \u003Ccode class=\"literal\">a3=a\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">a0\u003C/code> to \u003Ccode class=\"literal\">a3\u003C/code> fields record the first four arguments, encoded in hexadecimal notation, of the system call in this event. These arguments depend on the system call that is used; they can be interpreted by the \u003Ccode class=\"literal application\">ausearch\u003C/code> utility.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">items=1\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">items\u003C/code> field contains the number of PATH auxiliary records that follow the syscall record.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ppid=2686\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ppid\u003C/code> field records the Parent Process ID (PPID). In this case, \u003Ccode class=\"literal\">2686\u003C/code> was the PPID of the parent process such as \u003Ccode class=\"literal\">bash\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">pid=3538\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">pid\u003C/code> field records the Process ID (PID). In this case, \u003Ccode class=\"literal\">3538\u003C/code> was the PID of the \u003Ccode class=\"literal\">cat\u003C/code> process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">auid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">auid\u003C/code> field records the Audit user ID, that is the loginuid. This ID is assigned to a user upon login and is inherited by every process even when the user’s identity changes, for example, by switching user accounts with the \u003Ccode class=\"literal command\">su - john\u003C/code> command.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">uid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">uid\u003C/code> field records the user ID of the user who started the analyzed process. The user ID can be interpreted into user names with the following command: \u003Ccode class=\"literal command\">ausearch -i --uid \u003Cspan class=\"emphasis\">\u003Cem>UID\u003C/em>\u003C/span>\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">gid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">gid\u003C/code> field records the group ID of the user who started the analyzed process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">euid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">euid\u003C/code> field records the effective user ID of the user who started the analyzed process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">suid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">suid\u003C/code> field records the set user ID of the user who started the analyzed process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">fsuid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">fsuid\u003C/code> field records the file system user ID of the user who started the analyzed process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">egid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">egid\u003C/code> field records the effective group ID of the user who started the analyzed process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sgid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">sgid\u003C/code> field records the set group ID of the user who started the analyzed process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">fsgid=1000\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">fsgid\u003C/code> field records the file system group ID of the user who started the analyzed process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tty=pts0\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">tty\u003C/code> field records the terminal from which the analyzed process was invoked.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ses=1\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ses\u003C/code> field records the session ID of the session from which the analyzed process was invoked.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">comm=\"cat\"\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">comm\u003C/code> field records the command-line name of the command that was used to invoke the analyzed process. In this case, the \u003Ccode class=\"literal command\">cat\u003C/code> command was used to trigger this Audit event.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">exe=\"/bin/cat\"\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">exe\u003C/code> field records the path to the executable that was used to invoke the analyzed process.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">subj\u003C/code> field records the SELinux context with which the analyzed process was labeled at the time of execution.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">key=\"sshd_config\"\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">key\u003C/code> field records the administrator-defined string associated with the rule that generated this event in the Audit log.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cp class=\"title\">\u003Cstrong>Second Record\u003C/strong>\u003C/p>\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">type=CWD\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn the second record, the \u003Ccode class=\"literal\">type\u003C/code> field value is \u003Ccode class=\"literal\">CWD\u003C/code> — current working directory. This type is used to record the working directory from which the process that invoked the system call specified in the first record was executed.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe purpose of this record is to record the current process’s location in case a relative path winds up being captured in the associated PATH record. This way the absolute path can be reconstructed.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">msg=audit(1364481363.243:24287)\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">msg\u003C/code> field holds the same time stamp and ID value as the value in the first record. The time stamp is using the Unix time format - seconds since 00:00:00 UTC on 1 January 1970.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cwd=\"/home/\u003Cspan class=\"emphasis\">\u003Cem>user_name\u003C/em>\u003C/span>\"\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cwd\u003C/code> field contains the path to the directory in which the system call was invoked.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cp class=\"title\">\u003Cstrong>Third Record\u003C/strong>\u003C/p>\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">type=PATH\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIn the third record, the \u003Ccode class=\"literal\">type\u003C/code> field value is \u003Ccode class=\"literal\">PATH\u003C/code>. An Audit event contains a \u003Ccode class=\"literal\">PATH\u003C/code>-type record for every path that is passed to the system call as an argument. In this Audit event, only one path (\u003Ccode class=\"literal filename\">/etc/ssh/sshd_config\u003C/code>) was used as an argument.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">msg=audit(1364481363.243:24287):\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">msg\u003C/code> field holds the same time stamp and ID value as the value in the first and second record.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">item=0\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">item\u003C/code> field indicates which item, of the total number of items referenced in the \u003Ccode class=\"literal\">SYSCALL\u003C/code> type record, the current record is. This number is zero-based; a value of \u003Ccode class=\"literal\">0\u003C/code> means it is the first item.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">name=\"/etc/ssh/sshd_config\"\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">name\u003C/code> field records the path of the file or directory that was passed to the system call as an argument. In this case, it was the \u003Ccode class=\"literal filename\">/etc/ssh/sshd_config\u003C/code> file.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">inode=409248\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">inode\u003C/code> field contains the inode number associated with the file or directory recorded in this event. The following command displays the file or directory that is associated with the \u003Ccode class=\"literal\">409248\u003C/code> inode number:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>find / -inum 409248 -print\u003C/strong>\u003C/span>\n/etc/ssh/sshd_config\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dev=fd:00\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">dev\u003C/code> field specifies the minor and major ID of the device that contains the file or directory recorded in this event. In this case, the value represents the \u003Ccode class=\"literal\">/dev/fd/0\u003C/code> device.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mode=0100600\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">mode\u003C/code> field records the file or directory permissions, encoded in numerical notation as returned by the \u003Ccode class=\"literal command\">stat\u003C/code> command in the \u003Ccode class=\"literal\">st_mode\u003C/code> field. See the \u003Ccode class=\"literal\">stat(2)\u003C/code> man page for more information. In this case, \u003Ccode class=\"literal\">0100600\u003C/code> can be interpreted as \u003Ccode class=\"literal\">-rw-------\u003C/code>, meaning that only the root user has read and write permissions to the \u003Ccode class=\"literal filename\">/etc/ssh/sshd_config\u003C/code> file.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ouid=0\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ouid\u003C/code> field records the object owner’s user ID.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ogid=0\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ogid\u003C/code> field records the object owner’s group ID.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">rdev=00:00\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rdev\u003C/code> field contains a recorded device identifier for special files only. In this case, it is not used as the recorded file is a regular file.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">obj=system_u:object_r:etc_t:s0\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">obj\u003C/code> field records the SELinux context with which the recorded file or directory was labeled at the time of execution.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nametype=NORMAL\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">nametype\u003C/code> field records the intent of each path record’s operation in the context of a given syscall.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cap_fp=none\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cap_fp\u003C/code> field records data related to the setting of a permitted file system-based capability of the file or directory object.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cap_fi=none\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cap_fi\u003C/code> field records data related to the setting of an inherited file system-based capability of the file or directory object.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cap_fe=0\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cap_fe\u003C/code> field records the setting of the effective bit of the file system-based capability of the file or directory object.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cap_fver=0\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">cap_fver\u003C/code> field records the version of the file system-based capability of the file or directory object.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cp class=\"title\">\u003Cstrong>Fourth Record\u003C/strong>\u003C/p>\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">type=PROCTITLE\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">type\u003C/code> field contains the type of the record. In this example, the \u003Ccode class=\"literal\">PROCTITLE\u003C/code> value specifies that this record gives the full command-line that triggered this Audit event, triggered by a system call to the kernel.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">proctitle=636174002F6574632F7373682F737368645F636F6E666967\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">proctitle\u003C/code> field records the full command-line of the command that was used to invoke the analyzed process. The field is encoded in hexadecimal notation to not allow the user to influence the Audit log parser. The text decodes to the command that triggered this Audit event. When searching Audit records with the \u003Ccode class=\"literal command\">ausearch\u003C/code> command, use the \u003Ccode class=\"literal option\">-i\u003C/code> or \u003Ccode class=\"literal option\">--interpret\u003C/code> option to automatically convert hexadecimal values into their human-readable equivalents. The \u003Ccode class=\"literal\">636174002F6574632F7373682F737368645F636F6E666967\u003C/code> value is interpreted as \u003Ccode class=\"literal\">cat /etc/ssh/sshd_config\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-auditctl-for-defining-and-executing-audit-rules_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.6. Using auditctl for defining and executing Audit rules\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Audit system operates on a set of rules that define what is captured in the log files. Audit rules can be set either on the command line using the \u003Ccode class=\"literal\">auditctl\u003C/code> utility or in the \u003Ccode class=\"literal filename\">/etc/audit/rules.d/\u003C/code> directory.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">auditctl\u003C/code> command enables you to control the basic functionality of the Audit system and to define rules that decide which Audit events are logged.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>File-system rules examples\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo define a rule that logs all write access to, and every attribute change of, the \u003Ccode class=\"literal\">/etc/passwd\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -w /etc/passwd -p wa -k passwd_changes\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo define a rule that logs all write access to, and every attribute change of, all the files in the \u003Ccode class=\"literal\">/etc/selinux/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -w /etc/selinux/ -p wa -k selinux_changes\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>System-call rules examples\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo define a rule that creates a log entry every time the \u003Ccode class=\"literal\">adjtimex\u003C/code> or \u003Ccode class=\"literal\">settimeofday\u003C/code> system calls are used by a program, and the system uses the 64-bit architecture:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time_change\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo define a rule that creates a log entry every time a file is deleted or renamed by a system user whose ID is 1000 or larger:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -a always,exit -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=1000 -F auid!=4294967295 -k delete\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that the \u003Ccode class=\"literal\">-F auid!=4294967295\u003C/code> option is used to exclude users whose login UID is not set.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Executable-file rules\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo define a rule that logs all execution of the \u003Ccode class=\"literal\">/bin/id\u003C/code> program, execute the following command:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -a always,exit -F exe=/bin/id -F arch=b64 -S execve -k execution_bin_id\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">auditctl(8)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"defining-persistent-audit-rules_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.7. Defining persistent Audit rules\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo define Audit rules that are persistent across reboots, you must either directly include them in the \u003Ccode class=\"literal\">/etc/audit/rules.d/audit.rules\u003C/code> file or use the \u003Ccode class=\"literal\">augenrules\u003C/code> program that reads rules located in the \u003Ccode class=\"literal\">/etc/audit/rules.d/\u003C/code> directory.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNote that the \u003Ccode class=\"literal\">/etc/audit/audit.rules\u003C/code> file is generated whenever the \u003Ccode class=\"literal\">auditd\u003C/code> service starts. Files in \u003Ccode class=\"literal\">/etc/audit/rules.d/\u003C/code> use the same \u003Ccode class=\"literal\">auditctl\u003C/code> command-line syntax to specify the rules. Empty lines and text following a hash sign (#) are ignored.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFurthermore, you can use the \u003Ccode class=\"literal\">auditctl\u003C/code> command to read rules from a specified file using the \u003Ccode class=\"literal\">-R\u003C/code> option, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -R /usr/share/audit/sample-rules/30-stig.rules\u003C/strong>\u003C/span>\u003C/pre>\u003C/section>\u003Csection class=\"section\" id=\"pre-configured-audit-rules-files-for-compliance-with-standards_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.8. Pre-configured Audit rules files for compliance with standards\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp id=\"using-pre-configured-rules-files\">\n\t\t\t\tTo configure Audit for compliance with a specific certification standard, such as OSPP, PCI DSS, or STIG, you can use the set of pre-configured rules files installed with the \u003Ccode class=\"literal\">audit\u003C/code> package as a starting point. The sample rules are located in the \u003Ccode class=\"literal\">/usr/share/audit/sample-rules\u003C/code> directory.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe Audit sample rules in the \u003Ccode class=\"literal\">sample-rules\u003C/code> directory are not exhaustive nor up to date because security standards are dynamic and subject to change. These rules are provided only to demonstrate how Audit rules can be structured and written. They do not ensure immediate compliance with the latest security standards. To bring your system into compliance with the latest security standards according to specific security guidelines, use the \u003Ca class=\"link\" href=\"#configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities\" title=\"6.1. Configuration compliance tools in RHEL\">SCAP-based security compliance tools\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">30-nispom.rules\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAudit rule configuration that meets the requirements specified in the Information System Security chapter of the National Industrial Security Program Operating Manual.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">30-ospp-v42*.rules\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAudit rule configuration that meets the requirements defined in the OSPP (Protection Profile for General Purpose Operating Systems) profile version 4.2.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">30-pci-dss-v31.rules\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAudit rule configuration that meets the requirements set by Payment Card Industry Data Security Standard (PCI DSS) v3.1.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">30-stig.rules\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAudit rule configuration that meets the requirements set by Security Technical Implementation Guides (STIG).\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tTo use these configuration files, copy them to the \u003Ccode class=\"literal filename\">/etc/audit/rules.d/\u003C/code> directory and use the \u003Ccode class=\"literal command\">augenrules --load\u003C/code> command, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/audit/sample-rules/\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>cp 10-base-config.rules 30-stig.rules 31-privileged.rules 99-finalize.rules /etc/audit/rules.d/\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>augenrules --load\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tYou can order Audit rules using a numbering scheme. See the \u003Ccode class=\"literal\">/usr/share/audit/sample-rules/README-rules\u003C/code> file for more information.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">audit.rules(7)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-augenrules-to-define-persistent-rules_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.9. Using augenrules to define persistent rules\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">augenrules\u003C/code> script reads rules located in the \u003Ccode class=\"literal filename\">/etc/audit/rules.d/\u003C/code> directory and compiles them into an \u003Ccode class=\"literal filename\">audit.rules\u003C/code> file. This script processes all files that end with \u003Ccode class=\"literal\">.rules\u003C/code> in a specific order based on their natural sort order. The files in this directory are organized into groups with the following meanings:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">10\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tKernel and auditctl configuration\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">20\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tRules that could match general rules but you want a different match\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">30\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tMain rules\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">40\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tOptional rules\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">50\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tServer-specific rules\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">70\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSystem local rules\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">90\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tFinalize (immutable)\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tThe rules are not meant to be used all at once. They are pieces of a policy that should be thought out and individual files copied to \u003Ccode class=\"literal filename\">/etc/audit/rules.d/\u003C/code>. For example, to set a system up in the STIG configuration, copy rules \u003Ccode class=\"literal filename\">10-base-config\u003C/code>, \u003Ccode class=\"literal filename\">30-stig\u003C/code>, \u003Ccode class=\"literal filename\">31-privileged\u003C/code>, and \u003Ccode class=\"literal filename\">99-finalize\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tOnce you have the rules in the \u003Ccode class=\"literal filename\">/etc/audit/rules.d/\u003C/code> directory, load them by running the \u003Ccode class=\"literal\">augenrules\u003C/code> script with the \u003Ccode class=\"literal option\">--load\u003C/code> directive:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>augenrules --load\u003C/strong>\u003C/span>\n/sbin/augenrules: No change\nNo rules\nenabled 1\nfailure 1\npid 742\nrate_limit 0\n...\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">audit.rules(8)\u003C/code> and \u003Ccode class=\"literal\">augenrules(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"disabling-augenrules_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.10. Disabling augenrules\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the following steps to disable the \u003Ccode class=\"literal\">augenrules\u003C/code> utility. This switches Audit to use rules defined in the \u003Ccode class=\"literal\">/etc/audit/audit.rules\u003C/code> file.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">/usr/lib/systemd/system/auditd.service\u003C/code> file to the \u003Ccode class=\"literal\">/etc/systemd/system/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp -f /usr/lib/systemd/system/auditd.service /etc/systemd/system/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal\">/etc/systemd/system/auditd.service\u003C/code> file in a text editor of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/systemd/system/auditd.service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tComment out the line containing \u003Ccode class=\"literal\">augenrules\u003C/code>, and uncomment the line containing the \u003Ccode class=\"literal\">auditctl -R\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">#ExecStartPost=-/sbin/augenrules --load\nExecStartPost=-/sbin/auditctl -R /etc/audit/audit.rules\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReload the \u003Ccode class=\"literal\">systemd\u003C/code> daemon to fetch changes in the \u003Ccode class=\"literal\">auditd.service\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl daemon-reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">auditd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>service auditd restart\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">augenrules(8)\u003C/code> and \u003Ccode class=\"literal\">audit.rules(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/1505033\">Auditd service restart overrides changes made to /etc/audit/audit.rules\u003C/a> (Red Hat Knowledgebase)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_setting-up-audit-to-monitor-software-updates_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.11. Setting up Audit to monitor software updates\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the pre-configured rule \u003Ccode class=\"literal\">44-installers.rules\u003C/code> to configure Audit to monitor the following utilities that install software:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">dnf\u003C/code> \u003Ca href=\"#ftn.idm140081354625568\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"idm140081354625568\">[2]\u003C/sup>\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">yum\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pip\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">npm\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">cpan\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">gem\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">luarocks\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tTo monitor the \u003Ccode class=\"literal\">rpm\u003C/code> utility, install the \u003Ccode class=\"literal\">rpm-plugin-audit\u003C/code> package. Audit will then generate \u003Ccode class=\"literal\">SOFTWARE_UPDATE\u003C/code> events when it installs or updates a package. You can list these events by entering \u003Ccode class=\"literal\">ausearch -m SOFTWARE_UPDATE\u003C/code> on the command line.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tPre-configured rule files cannot be used on systems with the \u003Ccode class=\"literal\">ppc64le\u003C/code> and \u003Ccode class=\"literal\">aarch64\u003C/code> architectures.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">auditd\u003C/code> is configured in accordance with the settings provided in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/auditing-the-system_security-hardening#configuring-auditd-for-a-secure-environment_auditing-the-system\">Configuring auditd for a secure environment\u003C/a> .\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the pre-configured rule file \u003Ccode class=\"literal\">44-installers.rules\u003C/code> from the \u003Ccode class=\"literal\">/usr/share/audit/sample-rules/\u003C/code> directory to the \u003Ccode class=\"literal\">/etc/audit/rules.d/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/audit/sample-rules/44-installers.rules /etc/audit/rules.d/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLoad the audit rules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>augenrules --load\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList the loaded rules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -l\u003C/strong>\u003C/span>\n-p x-w /usr/bin/dnf-3 -k software-installer\n-p x-w /usr/bin/yum -k software-installer\n-p x-w /usr/bin/pip -k software-installer\n-p x-w /usr/bin/npm -k software-installer\n-p x-w /usr/bin/cpan -k software-installer\n-p x-w /usr/bin/gem -k software-installer\n-p x-w /usr/bin/luarocks -k software-installer\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPerform an installation, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf reinstall -y vim-enhanced\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSearch the Audit log for recent installation events, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -ts recent -k software-installer\u003C/strong>\u003C/span>\n––––\ntime-&gt;Thu Dec 16 10:33:46 2021\ntype=PROCTITLE msg=audit(1639668826.074:298): proctitle=2F7573722F6C6962657865632F706C6174666F726D2D707974686F6E002F7573722F62696E2F646E66007265696E7374616C6C002D790076696D2D656E68616E636564\ntype=PATH msg=audit(1639668826.074:298): item=2 name=\"/lib64/ld-linux-x86-64.so.2\" inode=10092 dev=fd:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:ld_so_t:s0 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\ntype=PATH msg=audit(1639668826.074:298): item=1 name=\"/usr/libexec/platform-python\" inode=4618433 dev=fd:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:bin_t:s0 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\ntype=PATH msg=audit(1639668826.074:298): item=0 name=\"/usr/bin/dnf\" inode=6886099 dev=fd:01 mode=0100755 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:rpm_exec_t:s0 nametype=NORMAL cap_fp=0 cap_fi=0 cap_fe=0 cap_fver=0 cap_frootid=0\ntype=CWD msg=audit(1639668826.074:298): cwd=\"/root\"\ntype=EXECVE msg=audit(1639668826.074:298): argc=5 a0=\"/usr/libexec/platform-python\" a1=\"/usr/bin/dnf\" a2=\"reinstall\" a3=\"-y\" a4=\"vim-enhanced\"\ntype=SYSCALL msg=audit(1639668826.074:298): arch=c000003e syscall=59 success=yes exit=0 a0=55c437f22b20 a1=55c437f2c9d0 a2=55c437f2aeb0 a3=8 items=3 ppid=5256 pid=5375 auid=0 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=3 comm=\"dnf\" exe=\"/usr/libexec/platform-python3.6\" subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key=\"software-installer\"\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"footnotes\">\u003Cbr/>\u003Chr width=\"100\" align=\"left\"/>\u003Cdiv id=\"ftn.idm140081354625568\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#idm140081354625568\" class=\"simpara\">\u003Csup class=\"simpara\">[2] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\tBecause \u003Ccode class=\"literal\">dnf\u003C/code> is a symlink in RHEL, the path in the \u003Ccode class=\"literal\">dnf\u003C/code> Audit rule must include the target of the symlink. To receive correct Audit events, modify the \u003Ccode class=\"literal\">44-installers.rules\u003C/code> file by changing the \u003Ccode class=\"literal\">path=/usr/bin/dnf\u003C/code> path to \u003Ccode class=\"literal\">/usr/bin/dnf-3\u003C/code>.\n\t\t\t\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_monitoring-user-login-times-with-audit_auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.12. Monitoring user login times with Audit\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo monitor which users logged in at specific times, you do not need to configure Audit in any special way. You can use the \u003Ccode class=\"literal\">ausearch\u003C/code> or \u003Ccode class=\"literal\">aureport\u003C/code> tools, which provide different ways of presenting the same information.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">auditd\u003C/code> is configured in accordance with the settings provided in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/auditing-the-system_security-hardening#configuring-auditd-for-a-secure-environment_auditing-the-system\">Configuring auditd for a secure environment\u003C/a> .\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo display user log in times, use any one of the following commands:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSearch the audit log for the \u003Ccode class=\"literal\">USER_LOGIN\u003C/code> message type:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -m USER_LOGIN -ts '\u003Cspan class=\"emphasis\">\u003Cem>12/02/2020\u003C/em>\u003C/span>' '\u003Cspan class=\"emphasis\">\u003Cem>18:00:00\u003C/em>\u003C/span>' -sv \u003Cspan class=\"emphasis\">\u003Cem>no\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\ntime-&gt;Mon Nov 22 07:33:22 2021\ntype=USER_LOGIN msg=audit(1637584402.416:92): pid=1939 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:sshd_t:s0-s0:c0.c1023 msg='op=login acct=\"(unknown)\" exe=\"/usr/sbin/sshd\" hostname=? addr=10.37.128.108 terminal=ssh res=failed'\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can specify the date and time with the \u003Ccode class=\"literal\">-ts\u003C/code> option. If you do not use this option, \u003Ccode class=\"literal\">ausearch\u003C/code> provides results from today, and if you omit time, \u003Ccode class=\"literal\">ausearch\u003C/code> provides results from midnight.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">-sv yes\u003C/code> option to filter out successful login attempts and \u003Ccode class=\"literal\">-sv no\u003C/code> for unsuccessful login attempts.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPipe the raw output of the \u003Ccode class=\"literal\">ausearch\u003C/code> command into the \u003Ccode class=\"literal\">aulast\u003C/code> utility, which displays the output in a format similar to the output of the \u003Ccode class=\"literal\">last\u003C/code> command. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch --raw | aulast --stdin\u003C/strong>\u003C/span>\nroot     ssh          10.37.128.108    Mon Nov 22 07:33 - 07:33  (00:00)\nroot     ssh          10.37.128.108    Mon Nov 22 07:33 - 07:33  (00:00)\nroot     ssh          10.22.16.106     Mon Nov 22 07:40 - 07:40  (00:00)\nreboot   system boot  4.18.0-348.6.el8 Mon Nov 22 07:33\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the list of login events by using the \u003Ccode class=\"literal\">aureport\u003C/code> command with the \u003Ccode class=\"literal\">--login -i\u003C/code> options.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>aureport --login -i\u003C/strong>\u003C/span>\n\nLogin Report\n============================================\n# date time auid host term exe success event\n============================================\n1. 11/16/2021 13:11:30 root 10.40.192.190 ssh /usr/sbin/sshd yes 6920\n2. 11/16/2021 13:11:31 root 10.40.192.190 ssh /usr/sbin/sshd yes 6925\n3. 11/16/2021 13:11:31 root 10.40.192.190 ssh /usr/sbin/sshd yes 6930\n4. 11/16/2021 13:11:31 root 10.40.192.190 ssh /usr/sbin/sshd yes 6935\n5. 11/16/2021 13:11:33 root 10.40.192.190 ssh /usr/sbin/sshd yes 6940\n6. 11/16/2021 13:11:33 root 10.40.192.190 /dev/pts/0 /usr/sbin/sshd yes 6945\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ausearch(8)\u003C/code>, \u003Ccode class=\"literal\">aulast(8)\u003C/code>, and \u003Ccode class=\"literal\">aureport(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"related-information-auditing-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.13. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/4409591\">RHEL Audit System Reference\u003C/a> Knowledgebase article.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/4494341\">Auditd execution options in a container\u003C/a> Knowledgebase article.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://github.com/linux-audit/audit-documentation/wiki\">Linux Audit Documentation Project page\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal package\">audit\u003C/code> package provides documentation in the \u003Ccode class=\"literal\">/usr/share/doc/audit/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">auditd(8)\u003C/code>, \u003Ccode class=\"literal\">auditctl(8)\u003C/code>, \u003Ccode class=\"literal\">ausearch(8)\u003C/code>, \u003Ccode class=\"literal\">audit.rules(7)\u003C/code>, \u003Ccode class=\"literal\">audispd.conf(5)\u003C/code>, \u003Ccode class=\"literal\">audispd(8)\u003C/code>, \u003Ccode class=\"literal\">auditd.conf(5)\u003C/code>, \u003Ccode class=\"literal\">ausearch-expression(5)\u003C/code>, \u003Ccode class=\"literal\">aulast(8)\u003C/code>, \u003Ccode class=\"literal\">aulastlog(8)\u003C/code>, \u003Ccode class=\"literal\">aureport(8)\u003C/code>, \u003Ccode class=\"literal\">ausyscall(8)\u003C/code>, \u003Ccode class=\"literal\">autrace(8)\u003C/code>, and \u003Ccode class=\"literal\">auvirt(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 12. Blocking and allowing applications by using fapolicyd\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tSetting and enforcing a policy that either allows or denies application execution based on a rule set efficiently prevents the execution of unknown and potentially malicious software.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"introduction-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.1. Introduction to fapolicyd\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> software framework controls the execution of applications based on a user-defined policy. This is one of the most efficient ways to prevent running untrusted and possibly malicious applications on the system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> framework provides the following components:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd\u003C/code> service\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd\u003C/code> command-line utilities\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd\u003C/code> RPM plugin\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd\u003C/code> rule language\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fagenrules\u003C/code> script\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe administrator can define the \u003Ccode class=\"literal\">allow\u003C/code> and \u003Ccode class=\"literal\">deny\u003C/code> execution rules for any application with the possibility of auditing based on a path, hash, MIME type, or trust.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> framework introduces the concept of trust. An application is trusted when it is properly installed by the system package manager, and therefore it is registered in the system RPM database. The \u003Ccode class=\"literal\">fapolicyd\u003C/code> daemon uses the RPM database as a list of trusted binaries and scripts. The \u003Ccode class=\"literal\">fapolicyd\u003C/code> RPM plugin registers any system update that is handled by either the DNF package manager or the RPM Package Manager. The plugin notifies the \u003Ccode class=\"literal\">fapolicyd\u003C/code> daemon about changes in this database. Other ways of adding applications require the creation of custom rules and restarting the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> service configuration is located in the \u003Ccode class=\"literal\">/etc/fapolicyd/\u003C/code> directory with the following structure:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/etc/fapolicyd/fapolicyd.trust\u003C/code> file contains a list of trusted files. You can also use multiple trust files in the \u003Ccode class=\"literal\">/etc/fapolicyd/trust.d/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/etc/fapolicyd/rules.d/\u003C/code> directory for files containing \u003Ccode class=\"literal\">allow\u003C/code> and \u003Ccode class=\"literal\">deny\u003C/code> execution rules. The \u003Ccode class=\"literal\">fagenrules\u003C/code> script merges these component rules files to the \u003Ccode class=\"literal\">/etc/fapolicyd/compiled.rules\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd.conf\u003C/code> file contains the daemon’s configuration options. This file is useful primarily for performance-tuning purposes.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tRules in \u003Ccode class=\"literal\">/etc/fapolicyd/rules.d/\u003C/code> are organized in several files, each representing a different policy goal. The numbers at the beginning of the corresponding file names determine the order in \u003Ccode class=\"literal\">/etc/fapolicyd/compiled.rules\u003C/code>:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">10\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tLanguage rules.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">20\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDracut-related Rules.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">21\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\trules for updaters.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">30\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tPatterns.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">40\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tELF rules.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">41\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tShared objects rules.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">42\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tTrusted ELF rules.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">70\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tTrusted language rules.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">72\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tShell rules.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">90\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDeny execute rules.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">95\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tAllow open rules.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tYou can use one of the following ways for \u003Ccode class=\"literal\">fapolicyd\u003C/code> integrity checking:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFile-size checking\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tComparing SHA-256 hashes\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIntegrity Measurement Architecture (IMA) subsystem\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tBy default, \u003Ccode class=\"literal\">fapolicyd\u003C/code> does no integrity checking. Integrity checking based on the file size is fast, but an attacker can replace the content of the file and preserve its byte size. Computing and checking SHA-256 checksums is more secure, but it affects the performance of the system. The \u003Ccode class=\"literal\">integrity = ima\u003C/code> option in \u003Ccode class=\"literal\">fapolicyd.conf\u003C/code> requires support for files extended attributes (also known as \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>xattr\u003C/em>\u003C/span>\u003C/code>) on all file systems containing executable files.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd(8)\u003C/code>, \u003Ccode class=\"literal\">fapolicyd.rules(5)\u003C/code>, \u003Ccode class=\"literal\">fapolicyd.conf(5)\u003C/code>, \u003Ccode class=\"literal\">fapolicyd.trust(13)\u003C/code>, \u003Ccode class=\"literal\">fagenrules(8)\u003C/code>, and \u003Ccode class=\"literal\">fapolicyd-cli(1)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/enhancing-security-with-the-kernel-integrity-subsystem_managing-monitoring-and-updating-the-kernel\">Enhancing security with the kernel integrity subsystem\u003C/a> chapter in the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_monitoring_and_updating_the_kernel/\">Managing, monitoring, and updating the kernel\u003C/a> document.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe documentation installed with the \u003Ccode class=\"literal\">fapolicyd\u003C/code> package in the \u003Ccode class=\"literal\">/usr/share/doc/fapolicyd/\u003C/code> directory and the \u003Ccode class=\"literal\">/usr/share/fapolicyd/sample-rules/README-rules\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_deploying-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.2. Deploying fapolicyd\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen deploying the \u003Ccode class=\"literal\">fapolicyd\u003C/code> application allowlisting framework, you can either try your configuration in permissive mode first or directly enable the service in the default configuration.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">fapolicyd\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install fapolicyd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To try your configuration first, change mode to permissive.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/fapolicyd/fapolicyd.conf\u003C/code> file in a text editor of your choice, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/fapolicyd/fapolicyd.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tChange the value of the \u003Ccode class=\"literal\">permissive\u003C/code> option from \u003Ccode class=\"literal\">0\u003C/code> to \u003Ccode class=\"literal\">1\u003C/code>, save the file, and exit the editor:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">permissive = 1\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAlternatively, you can debug your configuration by using the \u003Ccode class=\"literal\">fapolicyd --debug-deny --permissive\u003C/code> command before you start the service. See the \u003Ca class=\"link\" href=\"#ref_troubleshooting-problems-related-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd\" title=\"12.6. Troubleshooting problems related to fapolicyd\">Troubleshooting problems related to fapolicyd\u003C/a> section for more information.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable and start the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now fapolicyd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you enabled permissive mode through \u003Ccode class=\"literal\">/etc/fapolicyd/fapolicyd.conf\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the Audit service for recording \u003Ccode class=\"literal\">fapolicyd\u003C/code> events:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>auditctl -w /etc/fapolicyd/ -p wa -k fapolicyd_changes\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>service try-restart auditd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse your applications.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCheck Audit logs for \u003Ccode class=\"literal\">fanotify\u003C/code> denials, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -ts recent -m fanotify\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhen debugged, disable permissive mode by changing the corresponding value back to \u003Ccode class=\"literal\">permissive = 0\u003C/code>, and restart the service:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart fapolicyd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service is running correctly:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status fapolicyd\u003C/strong>\u003C/span>\n● fapolicyd.service - File Access Policy Daemon\n     Loaded: loaded (/usr/lib/systemd/system/fapolicyd.service; enabled; preset: disabled)\n     Active: active (running) since Tue 2024-10-08 05:53:50 EDT; 11s ago\n…\nOct 08 05:53:51 machine1.example.com fapolicyd[4974]: Loading trust data from rpmdb backend\nOct 08 05:53:51 machine1.example.com fapolicyd[4974]: Loading trust data from file backend\nOct 08 05:53:51 machine1.example.com fapolicyd[4974]: Starting to listen for events\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in as a user without root privileges, and check that \u003Ccode class=\"literal\">fapolicyd\u003C/code> is working, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /bin/ls /tmp\u003C/strong>\u003C/span>\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>/tmp/ls\u003C/strong>\u003C/span>\nbash: /tmp/ls: Operation not permitted\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"marking-files-as-trusted-using-an-additional-source-of-trust_assembly_blocking-and-allowing-applications-using-fapolicyd\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.3. Marking files as trusted using an additional source of trust\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> framework trusts files contained in the RPM database. You can mark additional files as trusted by adding the corresponding entries to the \u003Ccode class=\"literal\">/etc/fapolicyd/fapolicyd.trust\u003C/code> plain-text file or the \u003Ccode class=\"literal\">/etc/fapolicyd/trust.d/\u003C/code> directory, which supports separating a list of trusted files into more files. You can modify \u003Ccode class=\"literal\">fapolicyd.trust\u003C/code> or the files in \u003Ccode class=\"literal\">/etc/fapolicyd/trust.d\u003C/code> either directly using a text editor or through \u003Ccode class=\"literal\">fapolicyd-cli\u003C/code> commands.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tMarking files as trusted using \u003Ccode class=\"literal\">fapolicyd.trust\u003C/code> or \u003Ccode class=\"literal\">trust.d/\u003C/code> is better than writing custom \u003Ccode class=\"literal\">fapolicyd\u003C/code> rules due to performance reasons.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> framework is deployed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy your custom binary to the required directory, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /bin/ls /tmp\u003C/strong>\u003C/span>\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>/tmp/ls\u003C/strong>\u003C/span>\nbash: /tmp/ls: Operation not permitted\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMark your custom binary as trusted, and store the corresponding entry to the \u003Ccode class=\"literal\">myapp\u003C/code> file in \u003Ccode class=\"literal\">/etc/fapolicyd/trust.d/\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --file add /tmp/ls --trust-file myapp\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf you skip the \u003Ccode class=\"literal\">--trust-file\u003C/code> option, then the previous command adds the corresponding line to \u003Ccode class=\"literal\">/etc/fapolicyd/fapolicyd.trust\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tTo mark all existing files in a directory as trusted, provide the directory path as an argument of the \u003Ccode class=\"literal\">--file\u003C/code> option, for example: \u003Ccode class=\"literal\">fapolicyd-cli --file add /tmp/my_bin_dir/ --trust-file myapp\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUpdate the \u003Ccode class=\"literal\">fapolicyd\u003C/code> database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --update\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tChanging the content of a trusted file or directory changes their checksum, and therefore \u003Ccode class=\"literal\">fapolicyd\u003C/code> no longer considers them trusted.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tTo make the new content trusted again, refresh the file trust database by using the \u003Ccode class=\"literal\">fapolicyd-cli --file update\u003C/code> command. If you do not provide any argument, the entire database refreshes. Alternatively, you can specify a path to a specific file or directory. Then, update the database by using \u003Ccode class=\"literal\">fapolicyd-cli --update\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that your custom binary can be now executed, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>/tmp/ls\u003C/strong>\u003C/span>\nls\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd.trust(13)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_adding-custom-allow-and-deny-rules-for-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.4. Adding custom allow and deny rules for fapolicyd\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe default set of rules in the \u003Ccode class=\"literal\">fapolicyd\u003C/code> package does not affect system functions. For custom scenarios, such as storing binaries and scripts in a non-standard directory or adding applications without the \u003Ccode class=\"literal\">dnf\u003C/code> or \u003Ccode class=\"literal\">rpm\u003C/code> installers, you must either mark additional files as trusted or add new custom rules.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor basic scenarios, prefer \u003Ca class=\"link\" href=\"#marking-files-as-trusted-using-an-additional-source-of-trust_assembly_blocking-and-allowing-applications-using-fapolicyd\" title=\"12.3. Marking files as trusted using an additional source of trust\">Marking files as trusted using an additional source of trust\u003C/a>. In more advanced scenarios such as allowing to execute a custom binary only for specific user and group identifiers, add new custom rules to the \u003Ccode class=\"literal\">/etc/fapolicyd/rules.d/\u003C/code> directory.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following steps demonstrate adding a new rule to allow a custom binary.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> framework is deployed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy your custom binary to the required directory, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /bin/ls /tmp\u003C/strong>\u003C/span>\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>/tmp/ls\u003C/strong>\u003C/span>\nbash: /tmp/ls: Operation not permitted\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStop the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop fapolicyd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse debug mode to identify a corresponding rule. Because the output of the \u003Ccode class=\"literal\">fapolicyd --debug\u003C/code> command is verbose and you can stop it only by pressing \u003Ckbd class=\"keycap\">Ctrl\u003C/kbd>+\u003Ckbd class=\"keycap\">C\u003C/kbd> or killing the corresponding process, redirect the error output to a file. In this case, you can limit the output only to access denials by using the \u003Ccode class=\"literal\">--debug-deny\u003C/code> option instead of \u003Ccode class=\"literal\">--debug\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd --debug-deny 2&gt; \u003Cspan class=\"emphasis\">\u003Cem>fapolicy.output\u003C/em>\u003C/span> &amp;\u003C/strong>\u003C/span>\n[1] \u003Cspan class=\"emphasis\">\u003Cem>51341\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, you can run \u003Ccode class=\"literal\">fapolicyd\u003C/code> debug mode in another terminal.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRepeat the command that \u003Ccode class=\"literal\">fapolicyd\u003C/code> denied:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>/tmp/ls\u003C/strong>\u003C/span>\nbash: /tmp/ls: Operation not permitted\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStop debug mode by resuming it in the foreground and pressing \u003Ckbd class=\"keycap\">Ctrl\u003C/kbd>+\u003Ckbd class=\"keycap\">C\u003C/kbd>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fg\u003C/strong>\u003C/span>\nfapolicyd --debug 2&gt; fapolicy.output\n^C\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, kill the process of \u003Ccode class=\"literal\">fapolicyd\u003C/code> debug mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>kill \u003Cspan class=\"emphasis\">\u003Cem>51341\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFind a rule that denies the execution of your application:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat \u003Cspan class=\"emphasis\">\u003Cem>fapolicy.output\u003C/em>\u003C/span> | grep 'deny_audit'\u003C/strong>\u003C/span>\n...\nrule=13 dec=deny_audit perm=execute auid=0 pid=6855 exe=/usr/bin/bash : path=/tmp/ls ftype=application/x-executable trust=0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLocate the file that contains a rule that prevented the execution of your custom binary. In this case, the \u003Ccode class=\"literal\">deny_audit perm=execute\u003C/code> rule belongs to the \u003Ccode class=\"literal\">90-deny-execute.rules\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ls /etc/fapolicyd/rules.d/\u003C/strong>\u003C/span>\n10-languages.rules  40-bad-elf.rules\t   72-shell.rules\n20-dracut.rules     41-shared-obj.rules    90-deny-execute.rules\n21-updaters.rules   42-trusted-elf.rules   95-allow-open.rules\n30-patterns.rules   70-trusted-lang.rules\n\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/fapolicyd/rules.d/90-deny-execute.rules\u003C/strong>\u003C/span>\n# Deny execution for anything untrusted\n\ndeny_audit perm=execute all : all\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd a new \u003Ccode class=\"literal\">allow\u003C/code> rule to the file that lexically \u003Cspan class=\"emphasis\">\u003Cem>precedes\u003C/em>\u003C/span> the rule file that contains the rule that denied the execution of your custom binary in the \u003Ccode class=\"literal\">/etc/fapolicyd/rules.d/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>touch /etc/fapolicyd/rules.d/80-myapps.rules\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/fapolicyd/rules.d/80-myapps.rules\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInsert the following rule to the \u003Ccode class=\"literal\">80-myapps.rules\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">allow perm=execute exe=/usr/bin/bash trust=1 : path=/tmp/ls ftype=application/x-executable trust=0\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, you can allow executions of all binaries in the \u003Ccode class=\"literal\">/tmp\u003C/code> directory by adding the following rule to the rule file in \u003Ccode class=\"literal\">/etc/fapolicyd/rules.d/\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">allow perm=execute exe=/usr/bin/bash trust=1 : dir=/tmp/ trust=0\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tTo make a rule effective recursively on all directories under the specified directory, add a trailing slash to the value of the \u003Ccode class=\"literal\">dir=\u003C/code> parameter in the rule (\u003Ccode class=\"literal\">/tmp/\u003C/code> in the previous example).\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo prevent changes in the content of your custom binary, define the required rule using an SHA-256 checksum:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sha256sum /tmp/ls\u003C/strong>\u003C/span>\n780b75c90b2d41ea41679fcb358c892b1251b68d1927c80fbc0d9d148b25e836  ls\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the rule to the following definition:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">allow perm=execute exe=/usr/bin/bash trust=1 : sha256hash=\u003Cspan class=\"emphasis\">\u003Cem>780b75c90b2d41ea41679fcb358c892b1251b68d1927c80fbc0d9d148b25e836\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the list of compiled differs from the rule set in \u003Ccode class=\"literal\">/etc/fapolicyd/rules.d/\u003C/code>, and update the list, which is stored in the \u003Ccode class=\"literal\">/etc/fapolicyd/compiled.rules\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fagenrules --check\u003C/strong>\u003C/span>\n/usr/sbin/fagenrules: Rules have changed and should be updated\n# \u003Cspan class=\"strong strong\">\u003Cstrong>fagenrules --load\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that your custom rule is in the list of \u003Ccode class=\"literal\">fapolicyd\u003C/code> rules before the rule that prevented the execution:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --list\u003C/strong>\u003C/span>\n...\n13. allow perm=execute exe=/usr/bin/bash trust=1 : path=/tmp/ls ftype=application/x-executable trust=0\n14. deny_audit perm=execute all : all\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl start fapolicyd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that your custom binary can be now executed, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>/tmp/ls\u003C/strong>\u003C/span>\nls\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd.rules(5)\u003C/code> and \u003Ccode class=\"literal\">fapolicyd-cli(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe documentation installed with the \u003Ccode class=\"literal\">fapolicyd\u003C/code> package in the \u003Ccode class=\"literal\">/usr/share/fapolicyd/sample-rules/README-rules\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_enabling-fapolicyd-integrity-checks_assembly_blocking-and-allowing-applications-using-fapolicyd\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.5. Enabling fapolicyd integrity checks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBy default, \u003Ccode class=\"literal\">fapolicyd\u003C/code> does not perform integrity checking. You can configure \u003Ccode class=\"literal\">fapolicyd\u003C/code> to perform integrity checks by comparing either file sizes or SHA-256 hashes. You can also set integrity checks by using the Integrity Measurement Architecture (IMA) subsystem.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> framework is deployed on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/fapolicyd/fapolicyd.conf\u003C/code> file in a text editor of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/fapolicyd/fapolicyd.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the value of the \u003Ccode class=\"literal\">integrity\u003C/code> option from \u003Ccode class=\"literal\">none\u003C/code> to \u003Ccode class=\"literal\">sha256\u003C/code>, save the file, and exit the editor:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">integrity = sha256\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart fapolicyd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBack up the file used for the verification:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /bin/more /bin/more.bak\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the content of the \u003Ccode class=\"literal\">/bin/more\u003C/code> binary:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /bin/less &gt; /bin/more\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the changed binary as a regular user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>su \u003Cspan class=\"emphasis\">\u003Cem>example.user\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>/bin/more /etc/redhat-release\u003C/strong>\u003C/span>\nbash: /bin/more: Operation not permitted\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRevert the changes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mv -f /bin/more.bak /bin/more\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_troubleshooting-problems-related-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.6. Troubleshooting problems related to fapolicyd\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> application framework provides tools for troubleshooting the most common problems and you can also add applications installed with the \u003Ccode class=\"literal\">rpm\u003C/code> command to the trust database.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Installing applications by using \u003Ccode class=\"literal\">rpm\u003C/code>\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you install an application by using the \u003Ccode class=\"literal\">rpm\u003C/code> command, you have to perform a manual refresh of the \u003Ccode class=\"literal\">fapolicyd\u003C/code> RPM database:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInstall your \u003Cspan class=\"emphasis\">\u003Cem>application\u003C/em>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rpm -i \u003Cspan class=\"emphasis\">\u003Cem>application\u003C/em>\u003C/span>.rpm\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRefresh the database:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --update\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf you skip this step, the system can freeze and must be restarted.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Service status\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf \u003Ccode class=\"literal\">fapolicyd\u003C/code> does not work correctly, check the service status:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status fapolicyd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>\u003Ccode class=\"literal\">fapolicyd-cli\u003C/code> checks and listings\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">--check-config\u003C/code>, \u003Ccode class=\"literal\">--check-watch_fs\u003C/code>, and \u003Ccode class=\"literal\">--check-trustdb\u003C/code> options help you find syntax errors, not-yet-watched file systems, and file mismatches, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --check-config\u003C/strong>\u003C/span>\nDaemon config is OK\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --check-trustdb\u003C/strong>\u003C/span>\n/etc/selinux/targeted/contexts/files/file_contexts miscompares: size sha256\n/etc/selinux/targeted/policy/policy.31 miscompares: size sha256\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">--list\u003C/code> option to check the current list of rules and their order:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --list\u003C/strong>\u003C/span>\n...\n9. allow perm=execute all : trust=1\n10. allow perm=open all : ftype=%languages trust=1\n11. deny_audit perm=any all : ftype=%languages\n12. allow perm=any all : ftype=text/x-shellscript\n13. deny_audit perm=execute all : all\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Debug mode\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDebug mode provides detailed information about matched rules, database status, and more. To switch \u003Ccode class=\"literal\">fapolicyd\u003C/code> to debug mode:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tStop the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop fapolicyd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse debug mode to identify a corresponding rule:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd --debug\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tBecause the output of the \u003Ccode class=\"literal\">fapolicyd --debug\u003C/code> command is verbose, you can redirect the error output to a file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd --debug 2&gt; fapolicy.output\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAlternatively, to limit the output only to entries when \u003Ccode class=\"literal\">fapolicyd\u003C/code> denies access, use the \u003Ccode class=\"literal\">--debug-deny\u003C/code> option:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd --debug-deny\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tYou can also use permissive mode, which does not prevent running your application but only records the matched \u003Ccode class=\"literal\">fapolicyd\u003C/code> rule:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd --debug-deny --permissive\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Removing the \u003Ccode class=\"literal\">fapolicyd\u003C/code> database\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo solve problems related to the \u003Ccode class=\"literal\">fapolicyd\u003C/code> database, try to remove the database file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop fapolicyd\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --delete-db\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tDo not remove the \u003Ccode class=\"literal\">/var/lib/fapolicyd/\u003C/code> directory. The \u003Ccode class=\"literal\">fapolicyd\u003C/code> framework automatically restores only the database file in this directory.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Dumping the \u003Ccode class=\"literal\">fapolicyd\u003C/code> database\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> contains entries from all enabled trust sources. You can check the entries after dumping the database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fapolicyd-cli --dump-db\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Application pipe\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn rare cases, removing the \u003Ccode class=\"literal\">fapolicyd\u003C/code> pipe file can solve a lockup:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rm -f /var/run/fapolicyd/fapolicyd.fifo\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd-cli(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_assembly_blocking-and-allowing-applications-using-fapolicyd\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.7. Preventing users from executing untrustworthy code by using the \u003Ccode class=\"literal\">fapolicyd\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can automate the installation and configuration of the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service by using the \u003Ccode class=\"literal\">fapolicyd\u003C/code> RHEL system role. With this role, you can remotely configure the service to allow users to execute only trusted applications, for example, the ones which are listed in the RPM database and in an allow list. Additionally, the service can perform integrity checks before it executes an allowed application.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuring fapolicyd\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Allow only executables installed from RPM database and specific files\n      ansible.builtin.include_role:\n        name: rhel-system-roles.fapolicyd\n      vars:\n        fapolicyd_setup_permissive: false\n        fapolicyd_setup_integrity: sha256\n        fapolicyd_setup_trust: rpmdb,file\n        fapolicyd_add_trusted_file:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;path_to_allowed_command&gt;\u003C/em>\u003C/span>\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;path_to_allowed_service&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">fapolicyd_setup_permissive: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code> \u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables or disables sending policy decisions to the kernel for enforcement. Set this variable for debugging and testing purposes to \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">fapolicyd_setup_integrity: \u003Cspan class=\"emphasis\">\u003Cem>&lt;type_type&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tDefines the integrity checking method. You can set one of the following values:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">none\u003C/code> (default): Disables integrity checking.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">size\u003C/code>: The service compares only the file sizes of allowed applications.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ima\u003C/code>: The service checks the SHA-256 hash that the kernel’s Integrity Measurement Architecture (IMA) stored in a file’s extended attribute. Additionally, the service performs a size check. Note that the role does not configure the IMA kernel subsystem. To use this option, you must manually configure the IMA subsystem.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sha256\u003C/code>: The service compares the SHA-256 hash of allowed applications.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">fapolicyd_setup_trust: \u003Cspan class=\"emphasis\">\u003Cem>&lt;trust_backends&gt;\u003C/em>\u003C/span>\u003C/code> \u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines the list of trust backends. If you include the \u003Ccode class=\"literal\">file\u003C/code> backend, specify the allowed executable files in the \u003Ccode class=\"literal\">fapolicyd_add_trusted_file\u003C/code> list.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.fapolicyd.README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml --syntax-check\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExecute a binary application that is not on the allow list as a user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'su -c \"/bin/not_authorized_application \" \u003Cspan class=\"emphasis\">\u003Cem>&lt;user_name&gt;\u003C/em>\u003C/span>'\u003C/strong>\u003C/span>\nbash: line 1: /bin/not_authorized_application: Operation not permitted non-zero return code\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.fapolicyd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/fapolicyd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_2\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.8. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">fapolicyd\u003C/code>-related man pages listed by using the \u003Ccode class=\"literal\">man -k fapolicyd\u003C/code> command on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://rsroka.fedorapeople.org/fapolicyd-fosdem.pdf\">FOSDEM 2020 fapolicyd\u003C/a> presentation\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"protecting-systems-against-intrusive-usb-devices_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 13. Protecting systems against intrusive USB devices\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tUSB devices can be loaded with spyware, malware, or trojans, which can steal your data or damage your system. As a Red Hat Enterprise Linux administrator, you can prevent such USB attacks with \u003Cspan class=\"strong strong\">\u003Cstrong>USBGuard\u003C/strong>\u003C/span>.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"usbguard_protecting-systems-against-intrusive-usb-devices\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.1. USBGuard\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWith the USBGuard software framework, you can protect your systems against intrusive USB devices by using basic lists of permitted and forbidden devices based on the USB device authorization feature in the kernel.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe USBGuard framework provides the following components:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system service component with an inter-process communication (IPC) interface for dynamic interaction and policy enforcement\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe command-line interface to interact with a running \u003Ccode class=\"literal\">usbguard\u003C/code> system service\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe rule language for writing USB device authorization policies\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe C++ API for interacting with the system service component implemented in a shared library\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">usbguard\u003C/code> system service configuration file (\u003Ccode class=\"literal\">/etc/usbguard/usbguard-daemon.conf\u003C/code>) includes the options to authorize the users and groups to use the IPC interface.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe system service provides the USBGuard public IPC interface. In Red Hat Enterprise Linux, the access to this interface is limited to the root user only by default.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tConsider setting either the \u003Ccode class=\"literal\">IPCAccessControlFiles\u003C/code> option (recommended) or the \u003Ccode class=\"literal\">IPCAllowedUsers\u003C/code> and \u003Ccode class=\"literal\">IPCAllowedGroups\u003C/code> options to limit access to the IPC interface.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tEnsure that you do not leave the Access Control List (ACL) unconfigured as this exposes the IPC interface to all local users and allows them to manipulate the authorization state of USB devices and modify the USBGuard policy.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"installing-usbguard_protecting-systems-against-intrusive-usb-devices\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.2. Installing USBGuard\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse this procedure to install and initiate the USBGuard framework.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">usbguard\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install usbguard\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an initial rule set:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard generate-policy &gt; /etc/usbguard/rules.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">usbguard\u003C/code> daemon and ensure that it starts automatically on boot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now usbguard\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the \u003Ccode class=\"literal\">usbguard\u003C/code> service is running:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status usbguard\u003C/strong>\u003C/span>\n● usbguard.service - USBGuard daemon\n   Loaded: loaded (/usr/lib/systemd/system/usbguard.service; enabled; vendor preset: disabled)\n   Active: active (running) since Thu 2019-11-07 09:44:07 CET; 3min 16s ago\n     Docs: man:usbguard-daemon(8)\n Main PID: 6122 (usbguard-daemon)\n    Tasks: 3 (limit: 11493)\n   Memory: 1.2M\n   CGroup: /system.slice/usbguard.service\n           └─6122 /usr/sbin/usbguard-daemon -f -s -c /etc/usbguard/usbguard-daemon.conf\n\nNov 07 09:44:06 localhost.localdomain systemd[1]: Starting USBGuard daemon...\nNov 07 09:44:07 localhost.localdomain systemd[1]: Started USBGuard daemon.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList USB devices recognized by USBGuard:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard list-devices\u003C/strong>\u003C/span>\n4: allow id 1d6b:0002 serial \"0000:02:00.0\" name \"xHCI Host Controller\" hash...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard(1)\u003C/code> and \u003Ccode class=\"literal\">usbguard-daemon.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"blocking-and-authorizing-a-usb-device-using-cli_protecting-systems-against-intrusive-usb-devices\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.3. Blocking and authorizing a USB device by using CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can set USBGuard to authorize and block a USB device by using the \u003Ccode class=\"literal\">usbguard\u003C/code> command in your terminal.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">usbguard\u003C/code> service is installed and running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList USB devices recognized by USBGuard, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard list-devices\u003C/strong>\u003C/span>\n1: allow id 1d6b:0002 serial \"0000:00:06.7\" name \"EHCI Host Controller\" hash \"JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=\" parent-hash \"4PHGcaDKWtPjKDwYpIRG722cB9SlGz9l9Iea93+Gt9c=\" via-port \"usb1\" with-interface 09:00:00\n...\n6: block id 1b1c:1ab1 serial \"000024937962\" name \"Voyager\" hash \"CrXgiaWIf2bZAU+5WkzOE7y0rdSO82XMzubn7HDb95Q=\" parent-hash \"JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=\" via-port \"1-3\" with-interface 08:06:50\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAuthorize the device \u003Cspan class=\"emphasis\">\u003Cem>&lt;6&gt;\u003C/em>\u003C/span> to interact with the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard allow-device \u003Cspan class=\"emphasis\">\u003Cem>&lt;6&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDeauthorize and remove the device \u003Cspan class=\"emphasis\">\u003Cem>&lt;6&gt;\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard reject-device \u003Cspan class=\"emphasis\">\u003Cem>&lt;6&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDeauthorize and retain the device \u003Cspan class=\"emphasis\">\u003Cem>&lt;6&gt;\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard block-device \u003Cspan class=\"emphasis\">\u003Cem>&lt;6&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tUSBGuard uses the terms \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>block\u003C/em>\u003C/span>\u003C/code> and \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>reject\u003C/em>\u003C/span>\u003C/code> with the following meanings:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>block\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tDo not interact with this device for now.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>reject\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tIgnore this device as if it does not exist.\n\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard --help\u003C/code> command\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"permanently-blocking-and-authorizing-a-usb-device_protecting-systems-against-intrusive-usb-devices\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.4. Permanently blocking and authorizing a USB device\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can permanently block and authorize a USB device by using the \u003Ccode class=\"literal\">-p\u003C/code> option. This adds a device-specific rule to the current policy.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">usbguard\u003C/code> service is installed and running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure SELinux to allow the \u003Ccode class=\"literal\">usbguard\u003C/code> daemon to write rules.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay the \u003Ccode class=\"literal\">semanage\u003C/code> Booleans relevant to \u003Ccode class=\"literal\">usbguard\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage boolean -l | grep usbguard\u003C/strong>\u003C/span>\nusbguard_daemon_write_conf     (off  ,  off)  Allow usbguard to daemon write conf\nusbguard_daemon_write_rules    (on   ,   on)  Allow usbguard to daemon write rules\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: If the \u003Ccode class=\"literal\">usbguard_daemon_write_rules\u003C/code> Boolean is turned off, turn it on.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage boolean -m --on usbguard_daemon_write_rules\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList USB devices recognized by USBGuard:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard list-devices\u003C/strong>\u003C/span>\n1: allow id 1d6b:0002 serial \"0000:00:06.7\" name \"EHCI Host Controller\" hash \"JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=\" parent-hash \"4PHGcaDKWtPjKDwYpIRG722cB9SlGz9l9Iea93+Gt9c=\" via-port \"usb1\" with-interface 09:00:00\n...\n\u003Cspan class=\"emphasis\">\u003Cem>6\u003C/em>\u003C/span>: block id 1b1c:1ab1 serial \"000024937962\" name \"Voyager\" hash \"CrXgiaWIf2bZAU+5WkzOE7y0rdSO82XMzubn7HDb95Q=\" parent-hash \"JDOb0BiktYs2ct3mSQKopnOOV2h9MGYADwhT+oUtF2s=\" via-port \"1-3\" with-interface 08:06:50\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPermanently authorize device \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>6\u003C/em>\u003C/span>\u003C/code> to interact with the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard allow-device \u003Cspan class=\"emphasis\">\u003Cem>6\u003C/em>\u003C/span>\u003C/strong>\u003C/span> -p\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPermanently deauthorize and remove device \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>6\u003C/em>\u003C/span>\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard reject-device \u003Cspan class=\"emphasis\">\u003Cem>6\u003C/em>\u003C/span>\u003C/strong>\u003C/span> -p\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPermanently deauthorize and retain device \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>6\u003C/em>\u003C/span>\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard block-device \u003Cspan class=\"emphasis\">\u003Cem>6\u003C/em>\u003C/span>\u003C/strong>\u003C/span> -p\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\u003Ccode class=\"literal\">USBGuard\u003C/code> uses the terms \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>block\u003C/em>\u003C/span>\u003C/code> and \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>reject\u003C/em>\u003C/span>\u003C/code> with the following meanings:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>block\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tDo not interact with this device for now.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>reject\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tIgnore this device as if it does not exist.\n\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that USBGuard rules include the changes you made.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard list-rules\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tBuilt-in help listed by using the \u003Ccode class=\"literal\">usbguard --help\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.5. Creating a custom policy for USB devices\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure contains steps for creating a rule set for USB devices that reflects the requirements of your scenario.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">usbguard\u003C/code> service is installed and running.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/etc/usbguard/rules.conf\u003C/code> file contains an initial rule set generated by the \u003Ccode class=\"literal\">usbguard generate-policy\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a policy which authorizes the currently connected USB devices, and store the generated rules to the \u003Ccode class=\"literal\">rules.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard generate-policy --no-hashes &gt; \u003Cspan class=\"emphasis\">\u003Cem>./rules.conf\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">--no-hashes\u003C/code> option does not generate hash attributes for devices. Avoid hash attributes in your configuration settings because they might not be persistent.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal\">rules.conf\u003C/code> file with a text editor of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi \u003Cspan class=\"emphasis\">\u003Cem>./rules.conf\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd, remove, or edit the rules as required. For example, the following rule allows only devices with a single mass storage interface to interact with the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">allow with-interface equals { 08:*:* }\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">usbguard-rules.conf(5)\u003C/code> man page for a detailed rule-language description and more examples.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the updated policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>install -m 0600 -o root -g root \u003Cspan class=\"emphasis\">\u003Cem>rules.conf\u003C/em>\u003C/span> /etc/usbguard/rules.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">usbguard\u003C/code> daemon to apply your changes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart usbguard\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that your custom rules are in the active policy, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard list-rules\u003C/strong>\u003C/span>\n...\n4: allow with-interface 08:*:*\n...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard-rules.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-structured-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.6. Creating a structured custom policy for USB devices\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can organize your custom USBGuard policy in several \u003Ccode class=\"literal\">.conf\u003C/code> files within the \u003Ccode class=\"literal\">/etc/usbguard/rules.d/\u003C/code> directory. The \u003Ccode class=\"literal\">usbguard-daemon\u003C/code> then combines the main \u003Ccode class=\"literal\">rules.conf\u003C/code> file with the \u003Ccode class=\"literal\">.conf\u003C/code> files within the directory in alphabetical order.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">usbguard\u003C/code> service is installed and running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a policy which authorizes the currently connected USB devices, and store the generated rules to a new \u003Ccode class=\"literal\">.conf\u003C/code> file, for example, \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>policy.conf\u003C/em>\u003C/span>\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard generate-policy --no-hashes &gt; ./\u003Cspan class=\"emphasis\">\u003Cem>policy.conf\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">--no-hashes\u003C/code> option does not generate hash attributes for devices. Avoid hash attributes in your configuration settings because they might not be persistent.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>policy.conf\u003C/em>\u003C/span>\u003C/code> file with a text editor of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi ./\u003Cspan class=\"emphasis\">\u003Cem>policy.conf\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n...\nallow id 04f2:0833 serial \"\" name \"USB Keyboard\" via-port \"7-2\" with-interface { 03:01:01 03:00:00 } with-connect-type \"unknown\"\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMove selected lines into a separate \u003Ccode class=\"literal\">.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe two digits at the beginning of the file name specify the order in which the daemon reads the configuration files.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor example, copy the rules for your keyboards into a new \u003Ccode class=\"literal\">.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>grep \"\u003Cspan class=\"emphasis\">\u003Cem>USB Keyboard\u003C/em>\u003C/span>\" ./\u003Cspan class=\"emphasis\">\u003Cem>policy.conf\u003C/em>\u003C/span> &gt; ./\u003Cspan class=\"emphasis\">\u003Cem>10keyboards.conf\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the new policy to the \u003Ccode class=\"literal\">/etc/usbguard/rules.d/\u003C/code> directory.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>install -m 0600 -o root -g root \u003Cspan class=\"emphasis\">\u003Cem>10keyboards.conf\u003C/em>\u003C/span> /etc/usbguard/rules.d/\u003Cspan class=\"emphasis\">\u003Cem>10keyboards.conf\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMove the rest of the lines to a main \u003Ccode class=\"literal\">rules.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>grep -v \"\u003Cspan class=\"emphasis\">\u003Cem>USB Keyboard\u003C/em>\u003C/span>\" ./policy.conf &gt; ./rules.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the remaining rules.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>install -m 0600 -o root -g root \u003Cspan class=\"emphasis\">\u003Cem>rules.conf\u003C/em>\u003C/span> /etc/usbguard/rules.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">usbguard\u003C/code> daemon to apply your changes.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart usbguard\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay all active USBGuard rules.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard list-rules\u003C/strong>\u003C/span>\n...\n15: allow id 04f2:0833 serial \"\" name \"USB Keyboard\" hash \"kxM/iddRe/WSCocgiuQlVs6Dn0VEza7KiHoDeTz0fyg=\" parent-hash \"2i6ZBJfTl5BakXF7Gba84/Cp1gslnNc1DM6vWQpie3s=\" via-port \"7-2\" with-interface { 03:01:01 03:00:00 } with-connect-type \"unknown\"\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the contents of the \u003Ccode class=\"literal\">rules.conf\u003C/code> file and all the \u003Ccode class=\"literal\">.conf\u003C/code> files in the \u003Ccode class=\"literal\">/etc/usbguard/rules.d/\u003C/code> directory.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/usbguard/rules.conf /etc/usbguard/rules.d/*.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tVerify that the active rules contain all the rules from the files and are in the correct order.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard-rules.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"authorizing-users-and-groups-to-use-the-usbguard-ipc-interface_protecting-systems-against-intrusive-usb-devices\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.7. Authorizing users and groups to use the USBGuard IPC interface\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse this procedure to authorize a specific user or a group to use the USBGuard public IPC interface. By default, only the root user can use this interface.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">usbguard\u003C/code> service is installed and running.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/etc/usbguard/rules.conf\u003C/code> file contains an initial rule set generated by the \u003Ccode class=\"literal\">usbguard generate-policy\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal\">/etc/usbguard/usbguard-daemon.conf\u003C/code> file with a text editor of your choice:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/usbguard/usbguard-daemon.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor example, add a line with a rule that allows all users in the \u003Ccode class=\"literal\">wheel\u003C/code> group to use the IPC interface, and save the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">IPCAllowGroups=wheel\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can add users or groups also with the \u003Ccode class=\"literal\">usbguard\u003C/code> command. For example, the following command enables the \u003Cspan class=\"emphasis\">\u003Cem>joesec\u003C/em>\u003C/span> user to have full access to the \u003Ccode class=\"literal\">Devices\u003C/code> and \u003Ccode class=\"literal\">Exceptions\u003C/code> sections. Furthermore, \u003Cspan class=\"emphasis\">\u003Cem>joesec\u003C/em>\u003C/span> can list and modify the current policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>usbguard add-user \u003Cspan class=\"emphasis\">\u003Cem>joesec\u003C/em>\u003C/span> --devices ALL --policy modify,list --exceptions ALL\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo remove the granted permissions for the \u003Cspan class=\"emphasis\">\u003Cem>joesec\u003C/em>\u003C/span> user, use the \u003Ccode class=\"literal\">usbguard remove-user joesec\u003C/code> command.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">usbguard\u003C/code> daemon to apply your changes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart usbguard\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard(1)\u003C/code> and \u003Ccode class=\"literal\">usbguard-rules.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"logging-usbguard-authorization-events-to-the-linux-audit-log_protecting-systems-against-intrusive-usb-devices\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.8. Logging USBguard authorization events to the Linux Audit log\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the following steps to integrate logging of USBguard authorization events to the standard Linux Audit log. By default, the \u003Ccode class=\"literal\">usbguard\u003C/code> daemon logs events to the \u003Ccode class=\"literal\">/var/log/usbguard/usbguard-audit.log\u003C/code> file.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">usbguard\u003C/code> service is installed and running.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">auditd\u003C/code> service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal\">usbguard-daemon.conf\u003C/code> file with a text editor of your choice:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/usbguard/usbguard-daemon.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">AuditBackend\u003C/code> option from \u003Ccode class=\"literal\">FileAudit\u003C/code> to \u003Ccode class=\"literal\">LinuxAudit\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">AuditBackend=LinuxAudit\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">usbguard\u003C/code> daemon to apply the configuration change:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart usbguard\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tQuery the \u003Ccode class=\"literal\">audit\u003C/code> daemon log for a USB authorization event, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ausearch -ts recent -m USER_DEVICE\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard-daemon.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_3\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.9. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">usbguard(1)\u003C/code>, \u003Ccode class=\"literal\">usbguard-rules.conf(5)\u003C/code>, \u003Ccode class=\"literal\">usbguard-daemon(8)\u003C/code>, and \u003Ccode class=\"literal\">usbguard-daemon.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://usbguard.github.io/\">USBGuard Homepage\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_configuring-a-remote-logging-solution_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 14. Configuring a remote logging solution\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tTo ensure that logs from various machines in your environment are recorded centrally on a logging server, you can configure the \u003Cspan class=\"strong strong\">\u003Cstrong>Rsyslog\u003C/strong>\u003C/span> application to record logs that fit specific criteria from the client system to the server.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"the-rsyslog-logging-service_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.1. The Rsyslog logging service\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Rsyslog application, in combination with the \u003Ccode class=\"literal\">systemd-journald\u003C/code> service, provides local and remote logging support in Red Hat Enterprise Linux. The \u003Ccode class=\"literal\">rsyslogd\u003C/code> daemon continuously reads \u003Ccode class=\"literal\">syslog\u003C/code> messages received by the \u003Ccode class=\"literal\">systemd-journald\u003C/code> service from the Journal. \u003Ccode class=\"literal\">rsyslogd\u003C/code> then filters and processes these \u003Ccode class=\"literal\">syslog\u003C/code> events and records them to \u003Ccode class=\"literal\">rsyslog\u003C/code> log files or forwards them to other services according to its configuration.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">rsyslogd\u003C/code> daemon also provides extended filtering, encryption protected relaying of messages, input and output modules, and support for transportation using the TCP and UDP protocols.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code>, which is the main configuration file for \u003Ccode class=\"literal\">rsyslog\u003C/code>, you can specify the rules according to which \u003Ccode class=\"literal\">rsyslogd\u003C/code> handles the messages. Generally, you can classify messages by their source and topic (facility) and urgency (priority), and then assign an action that should be performed when a message fits these criteria.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code>, you can also see a list of log files maintained by \u003Ccode class=\"literal\">rsyslogd\u003C/code>. Most log files are located in the \u003Ccode class=\"literal\">/var/log/\u003C/code> directory. Some applications, such as \u003Ccode class=\"literal\">httpd\u003C/code> and \u003Ccode class=\"literal\">samba\u003C/code>, store their log files in a subdirectory within \u003Ccode class=\"literal\">/var/log/\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rsyslogd(8)\u003C/code> and \u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package in the \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"installing-rsyslog-documentation_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.2. Installing Rsyslog documentation\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Rsyslog application has extensive online documentation that is available at \u003Ca class=\"link\" href=\"https://www.rsyslog.com/doc/\">https://www.rsyslog.com/doc/\u003C/a>, but you can also install the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> documentation package locally.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have activated the \u003Ccode class=\"literal\">AppStream\u003C/code> repository on your system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are authorized to install new packages using \u003Ccode class=\"literal\">sudo\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install rsyslog-doc\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code> file in a browser of your choice, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>firefox /usr/share/doc/rsyslog/html/index.html &amp;\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-server-for-remote-logging-over-tcp_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.3. Configuring a server for remote logging over TCP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Rsyslog application enables you to both run a logging server and configure individual systems to send their log files to the logging server. To use remote logging through TCP, configure both the server and the client. The server collects and analyzes the logs sent by one or more client systems.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWith the Rsyslog application, you can maintain a centralized logging system where log messages are forwarded to a server over the network. To avoid message loss when the server is not available, you can configure an action queue for the forwarding action. This way, messages that failed to be sent are stored locally until the server is reachable again. Note that such queues cannot be configured for connections using the UDP protocol.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">omfwd\u003C/code> plug-in provides forwarding over UDP or TCP. The default protocol is UDP. Because the plug-in is built in, it does not have to be loaded.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy default, \u003Ccode class=\"literal\">rsyslog\u003C/code> uses TCP on port \u003Ccode class=\"literal\">514\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRsyslog is installed on the server system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as \u003Ccode class=\"literal\">root\u003C/code> on the server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed for the optional step using the \u003Ccode class=\"literal\">semanage\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">firewalld\u003C/code> service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To use a different port for \u003Ccode class=\"literal\">rsyslog\u003C/code> traffic, add the \u003Ccode class=\"literal\">syslogd_port_t\u003C/code> SELinux type to port. For example, enable port \u003Ccode class=\"literal\">30514\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port -a -t syslogd_port_t -p tcp 30514\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To use a different port for \u003Ccode class=\"literal\">rsyslog\u003C/code> traffic, configure \u003Ccode class=\"literal\">firewalld\u003C/code> to allow incoming \u003Ccode class=\"literal\">rsyslog\u003C/code> traffic on that port. For example, allow TCP traffic on port \u003Ccode class=\"literal\">30514\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --zone=\u003Cspan class=\"emphasis\">\u003Cem>&lt;zone-name&gt;\u003C/em>\u003C/span> --permanent --add-port=30514/tcp\u003C/strong>\u003C/span>\nsuccess\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new file in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory named, for example, \u003Ccode class=\"literal\">remotelog.conf\u003C/code>, and insert the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># Define templates before the rules that use them\n# Per-Host templates for remote systems\ntemplate(name=\"TmplAuthpriv\" type=\"list\") {\n    constant(value=\"/var/log/remote/auth/\")\n    property(name=\"hostname\")\n    constant(value=\"/\")\n    property(name=\"programname\" SecurePath=\"replace\")\n    constant(value=\".log\")\n    }\n\ntemplate(name=\"TmplMsg\" type=\"list\") {\n    constant(value=\"/var/log/remote/msg/\")\n    property(name=\"hostname\")\n    constant(value=\"/\")\n    property(name=\"programname\" SecurePath=\"replace\")\n    constant(value=\".log\")\n    }\n\n# Provides TCP syslog reception\nmodule(load=\"imtcp\")\n\n# Adding this ruleset to process remote messages\nruleset(name=\"remote1\"){\n     authpriv.*   action(type=\"omfile\" DynaFile=\"TmplAuthpriv\")\n      *.info;mail.none;authpriv.none;cron.none\naction(type=\"omfile\" DynaFile=\"TmplMsg\")\n}\n\ninput(type=\"imtcp\" port=\"30514\" ruleset=\"remote1\")\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the changes to the \u003Ccode class=\"literal\">/etc/rsyslog.d/remotelog.conf\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTest the syntax of the \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rsyslogd -N 1\u003C/strong>\u003C/span>\nrsyslogd: version 8.1911.0-2.el8, config validation run...\nrsyslogd: End of config validation run. Bye.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake sure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service is running and enabled on the logging server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">rsyslog\u003C/code> service.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If \u003Ccode class=\"literal\">rsyslog\u003C/code> is not enabled, ensure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service starts automatically after reboot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYour log server is now configured to receive and store log files from the other systems in your environment.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslogd(8)\u003C/code>, \u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code>, \u003Ccode class=\"literal\">semanage(8)\u003C/code>, and \u003Ccode class=\"literal\">firewall-cmd(1)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package in the \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-remote-logging-to-a-server-over-tcp_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.4. Configuring remote logging to a server over TCP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure a system for forwarding log messages to a server over the TCP protocol. The \u003Ccode class=\"literal\">omfwd\u003C/code> plug-in provides forwarding over UDP or TCP. The default protocol is UDP. Because the plug-in is built in, you do not have to load it.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rsyslog\u003C/code> package is installed on the client systems that should report to the server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured the server for remote logging.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe specified port is permitted in SELinux and open in firewall.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system contains the \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package, which provides the \u003Ccode class=\"literal\">semanage\u003C/code> command for adding a non-standard port to the SELinux configuration.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new file in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory named, for example, \u003Ccode class=\"literal\">10-remotelog.conf\u003C/code>, and insert the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">*.* action(type=\"omfwd\"\n      queue.type=\"linkedlist\"\n      queue.filename=\"example_fwd\"\n      action.resumeRetryCount=\"-1\"\n      queue.saveOnShutdown=\"on\"\n      target=\"example.com\" port=\"30514\" protocol=\"tcp\"\n     )\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">queue.type=\"linkedlist\"\u003C/code> setting enables a LinkedList in-memory queue,\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">queue.filename\u003C/code> setting defines a disk storage. The backup files are created with the \u003Ccode class=\"literal\">example_fwd\u003C/code> prefix in the working directory specified by the preceding global \u003Ccode class=\"literal\">workDirectory\u003C/code> directive.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">action.resumeRetryCount -1\u003C/code> setting prevents \u003Ccode class=\"literal\">rsyslog\u003C/code> from dropping messages when retrying to connect if server is not responding,\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">queue.saveOnShutdown=\"on\"\u003C/code> setting saves in-memory data if \u003Ccode class=\"literal\">rsyslog\u003C/code> shuts down.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe last line forwards all received messages to the logging server. Port specification is optional.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWith this configuration, \u003Ccode class=\"literal\">rsyslog\u003C/code> sends messages to the server but keeps messages in memory if the remote server is not reachable. A file on disk is created only if \u003Ccode class=\"literal\">rsyslog\u003C/code> runs out of the configured memory queue space or needs to shut down, which benefits the system performance.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tRsyslog processes configuration files \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> in the lexical order.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">rsyslog\u003C/code> service.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo verify that the client system sends messages to the server, follow these steps:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the client system, send a test message:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logger test\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the server system, view the \u003Ccode class=\"literal\">/var/log/messages\u003C/code> log, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /var/log/remote/msg/\u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span>/root.log\u003C/strong>\u003C/span>\nFeb 25 03:53:17 \u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span> root[6064]: test\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere \u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span> is the host name of the client system. Note that the log contains the user name of the user that entered the \u003Ccode class=\"literal\">logger\u003C/code> command, in this case \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslogd(8)\u003C/code> and \u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package in the \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-tls-encrypted-remote-logging_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.5. Configuring TLS-encrypted remote logging\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBy default, Rsyslog sends remote-logging communication in the plain text format. If your scenario requires to secure this communication channel, you can encrypt it using TLS.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo use encrypted transport through TLS, configure both the server and the client. The server collects and analyzes the logs sent by one or more client systems.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use either the \u003Ccode class=\"literal\">ossl\u003C/code> network stream driver (OpenSSL) or the \u003Ccode class=\"literal\">gtls\u003C/code> stream driver (GnuTLS).\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you have a separate system with higher security, for example, a system that is not connected to any network or has stricter authorizations, use the separate system as the certifying authority (CA).\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tYou can customize your connection settings with stream drivers on the server side on the \u003Ccode class=\"literal\">global\u003C/code>, \u003Ccode class=\"literal\">module\u003C/code>, and \u003Ccode class=\"literal\">input\u003C/code> levels, and on the client side on the \u003Ccode class=\"literal\">global\u003C/code> and \u003Ccode class=\"literal\">action\u003C/code> levels. The more specific configuration overrides the more general configuration. This means, for example, that you can use \u003Ccode class=\"literal\">ossl\u003C/code> in global settings for most connections and \u003Ccode class=\"literal\">gtls\u003C/code> on the input and action settings only for specific connections.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to both the client and server systems.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe following packages are installed on the server and the client systems:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rsyslog\u003C/code> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tFor the \u003Ccode class=\"literal\">ossl\u003C/code> network stream driver, the \u003Ccode class=\"literal\">rsyslog-openssl\u003C/code> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tFor the \u003Ccode class=\"literal\">gtls\u003C/code> network stream driver, the \u003Ccode class=\"literal\">rsyslog-gnutls\u003C/code> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tFor generating certificates by using the \u003Ccode class=\"literal\">certtool\u003C/code> command, the \u003Ccode class=\"literal\">gnutls-utils\u003C/code> package.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your logging server, the following certificates are in the \u003Ccode class=\"literal\">/etc/pki/ca-trust/source/anchors/\u003C/code> directory and your system configuration is updated by using the \u003Ccode class=\"literal\">update-ca-trust\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ca-cert.pem\u003C/code> - a CA certificate that can verify keys and certificates on logging servers and clients.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server-cert.pem\u003C/code> - a public key of the logging server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server-key.pem\u003C/code> - a private key of the logging server.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your logging clients, the following certificates are in the \u003Ccode class=\"literal\">/etc/pki/ca-trust/source/anchors/\u003C/code> directory and your system configuration is updated by using \u003Ccode class=\"literal\">update-ca-trust\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ca-cert.pem\u003C/code> - a CA certificate that can verify keys and certificates on logging servers and clients.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">client-cert.pem\u003C/code> - a public key of a client.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">client-key.pem\u003C/code> - a private key of a client.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf the server runs RHEL 9.2 or later and FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS extension \"Extended Master Secret\" enforced\u003C/a> Knowledgebase article.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure the server for receiving encrypted logs from your client systems:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tCreate a new file in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory named, for example, \u003Ccode class=\"literal\">securelogser.conf\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo encrypt the communication, the configuration file must contain paths to certificate files on your server, a selected authentication method, and a stream driver that supports TLS encryption. Add the following lines to the \u003Ccode class=\"literal\">/etc/rsyslog.d/securelogser.conf\u003C/code> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># Set certificate files\nglobal(\n  DefaultNetstreamDriverCAFile=\"/etc/pki/ca-trust/source/anchors/ca-cert.pem\"\n  DefaultNetstreamDriverCertFile=\"/etc/pki/ca-trust/source/anchors/server-cert.pem\"\n  DefaultNetstreamDriverKeyFile=\"/etc/pki/ca-trust/source/anchors/server-key.pem\"\n)\n\n# TCP listener\nmodule(\n  load=\"imtcp\"\n  PermittedPeer=[\"client1.example.com\", \"client2.example.com\"]\n  StreamDriver.AuthMode=\"x509/name\"\n  StreamDriver.Mode=\"1\"\n  StreamDriver.Name=\"ossl\"\n)\n\n# Start up listener at port 514\ninput(\n  type=\"imtcp\"\n  port=\"514\"\n)\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tIf you prefer the GnuTLS driver, use the \u003Ccode class=\"literal\">StreamDriver.Name=\"gtls\"\u003C/code> configuration option. See the documentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package for more information about less strict authentication modes than \u003Ccode class=\"literal\">x509/name\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: From Rsyslog version 8.2310, which is provided in RHEL 9.4, you can customize the connection configuration. To do so, replace the \u003Ccode class=\"literal\">input\u003C/code> section with the following:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">input(\n  type=\"imtcp\"\n  Port=\"50515\"\n  StreamDriver.Name=\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;driver&gt;\u003C/em>\u003C/span>\"\n  streamdriver.CAFile=\"/etc/rsyslog.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;ca1&gt;\u003C/em>\u003C/span>.pem\"\n  streamdriver.CertFile=\"/etc/rsyslog.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;server1-cert&gt;\u003C/em>\u003C/span>.pem\"\n  streamdriver.KeyFile=\"/etc/rsyslog.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;server1-key&gt;\u003C/em>\u003C/span>.pem\"\n)\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;driver&gt;\u003C/em>\u003C/span>\u003C/code> with \u003Ccode class=\"literal\">ossl\u003C/code> or \u003Ccode class=\"literal\">gtls\u003C/code> depending on the driver you want to use.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;ca1&gt;\u003C/em>\u003C/span>\u003C/code> with the CA certificate, \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;server1-cert&gt;\u003C/em>\u003C/span>\u003C/code> with the certificate, and \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;server1-key&gt;\u003C/em>\u003C/span>\u003C/code> with the key of the customized connection.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes to the \u003Ccode class=\"literal\">/etc/rsyslog.d/securelogser.conf\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tVerify the syntax of the \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code> file and any files in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rsyslogd -N 1\u003C/strong>\u003C/span>\nrsyslogd: version 8.1911.0-2.el8, config validation run (level 1)...\nrsyslogd: End of config validation run. Bye.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tMake sure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service is running and enabled on the logging server:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">rsyslog\u003C/code> service:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: If Rsyslog is not enabled, ensure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service starts automatically after reboot:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure clients for sending encrypted logs to the server:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOn a client system, create a new file in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory named, for example, \u003Ccode class=\"literal\">securelogcli.conf\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the following lines to the \u003Ccode class=\"literal\">/etc/rsyslog.d/securelogcli.conf\u003C/code> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># Set certificate files\nglobal(\n  DefaultNetstreamDriverCAFile=\"/etc/pki/ca-trust/source/anchors/ca-cert.pem\"\n  DefaultNetstreamDriverCertFile=\"/etc/pki/ca-trust/source/anchors/client-cert.pem\"\n  DefaultNetstreamDriverKeyFile=\"/etc/pki/ca-trust/source/anchors/client-key.pem\"\n)\n\n\n# Set up the action for all messages\n*.* action(\n  type=\"omfwd\"\n  StreamDriver=\"ossl\"\n  StreamDriverMode=\"1\"\n  StreamDriverPermittedPeers=\"server.example.com\"\n  StreamDriverAuthMode=\"x509/name\"\n  target=\"server.example.com\" port=\"514\" protocol=\"tcp\"\n)\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tIf you prefer the GnuTLS driver, use the \u003Ccode class=\"literal\">StreamDriver.Name=\"gtls\"\u003C/code> configuration option.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: From Rsyslog version 8.2310, which is provided in RHEL 9.4, you can customize the connection configuration. To do so, replace the \u003Ccode class=\"literal\">action\u003C/code> section with the following:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">local1.* action(\n  type=\"omfwd\"\n  StreamDriver=\"&lt;driver&gt;\"\n  StreamDriverMode=\"1\"\n  StreamDriverAuthMode=\"x509/certvalid\"\n  streamDriver.CAFile=\"/etc/rsyslog.d/&lt;ca1&gt;.pem\"\n  streamDriver.CertFile=\"/etc/rsyslog.d/&lt;client1-cert&gt;.pem\"\n  streamDriver.KeyFile=\"/etc/rsyslog.d/&lt;client1-key&gt;.pem\"\n  target=\"server.example.com\" port=\"514\" protocol=\"tcp\"\n  )\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;driver&gt;\u003C/em>\u003C/span>\u003C/code> with \u003Ccode class=\"literal\">ossl\u003C/code> or \u003Ccode class=\"literal\">gtls\u003C/code> depending on the driver you want to use.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;ca1&gt;\u003C/em>\u003C/span>\u003C/code> with the CA certificate, \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;client1-cert&gt;\u003C/em>\u003C/span>\u003C/code> with the certificate, and \u003Ccode class=\"literal\">&lt;client1-key&gt;\u003C/code> with the key of the customized connection.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes to the \u003Ccode class=\"literal\">/etc/rsyslog.d/securelogcli.conf\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tVerify the syntax of the \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code> file and other files in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rsyslogd -N 1\u003C/strong>\u003C/span>\nrsyslogd: version 8.1911.0-2.el8, config validation run (level 1)...\nrsyslogd: End of config validation run. Bye.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tMake sure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service is running and enabled on the logging server:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">rsyslog\u003C/code> service:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: If Rsyslog is not enabled, ensure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service starts automatically after reboot:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo verify that the client system sends messages to the server, follow these steps:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the client system, send a test message:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logger test\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the server system, view the \u003Ccode class=\"literal\">/var/log/messages\u003C/code> log, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /var/log/remote/msg/\u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname&gt;\u003C/em>\u003C/span>/root.log\u003C/strong>\u003C/span>\nFeb 25 03:53:17 \u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname&gt;\u003C/em>\u003C/span> root[6064]: test\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname&gt;\u003C/em>\u003C/span>\u003C/code> is the hostname of the client system. Note that the log contains the user name of the user that entered the logger command, in this case \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">certtool(1)\u003C/code>, \u003Ccode class=\"literal\">openssl(1)\u003C/code>, \u003Ccode class=\"literal\">update-ca-trust(8)\u003C/code>, \u003Ccode class=\"literal\">rsyslogd(8)\u003C/code>, and \u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package at \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles\">Using the logging system role with TLS\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-server-for-receiving-remote-logging-information-over-udp_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.6. Configuring a server for receiving remote logging information over UDP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>Rsyslog\u003C/strong>\u003C/span> application enables you to configure a system to receive logging information from remote systems. To use remote logging through UDP, configure both the server and the client. The receiving server collects and analyzes the logs sent by one or more client systems. By default, \u003Ccode class=\"literal\">rsyslog\u003C/code> uses UDP on port \u003Ccode class=\"literal\">514\u003C/code> to receive log information from remote systems.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to configure a server for collecting and analyzing logs sent by one or more client systems over the UDP protocol.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRsyslog is installed on the server system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as \u003Ccode class=\"literal\">root\u003C/code> on the server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package is installed for the optional step using the \u003Ccode class=\"literal\">semanage\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">firewalld\u003C/code> service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: To use a different port for \u003Ccode class=\"literal\">rsyslog\u003C/code> traffic than the default port \u003Ccode class=\"literal\">514\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">syslogd_port_t\u003C/code> SELinux type to the SELinux policy configuration, replacing \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>portno\u003C/em>\u003C/span>\u003C/code> with the port number you want \u003Ccode class=\"literal\">rsyslog\u003C/code> to use:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port -a -t syslogd_port_t -p udp \u003Cspan class=\"emphasis\">\u003Cem>portno\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConfigure \u003Ccode class=\"literal\">firewalld\u003C/code> to allow incoming \u003Ccode class=\"literal\">rsyslog\u003C/code> traffic, replacing \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>portno\u003C/em>\u003C/span>\u003C/code> with the port number and \u003Ccode class=\"literal\">zone\u003C/code> with the zone you want \u003Ccode class=\"literal\">rsyslog\u003C/code> to use:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --zone=\u003Cspan class=\"emphasis\">\u003Cem>zone\u003C/em>\u003C/span> --permanent --add-port=\u003Cspan class=\"emphasis\">\u003Cem>portno\u003C/em>\u003C/span>/udp\u003C/strong>\u003C/span>\nsuccess\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tReload the firewall rules:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">remotelogserv.conf\u003C/code>, and insert the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># Define templates before the rules that use them\n# Per-Host templates for remote systems\ntemplate(name=\"TmplAuthpriv\" type=\"list\") {\n    constant(value=\"/var/log/remote/auth/\")\n    property(name=\"hostname\")\n    constant(value=\"/\")\n    property(name=\"programname\" SecurePath=\"replace\")\n    constant(value=\".log\")\n    }\n\ntemplate(name=\"TmplMsg\" type=\"list\") {\n    constant(value=\"/var/log/remote/msg/\")\n    property(name=\"hostname\")\n    constant(value=\"/\")\n    property(name=\"programname\" SecurePath=\"replace\")\n    constant(value=\".log\")\n    }\n\n# Provides UDP syslog reception\nmodule(load=\"imudp\")\n\n# This ruleset processes remote messages\nruleset(name=\"remote1\"){\n     authpriv.*   action(type=\"omfile\" DynaFile=\"TmplAuthpriv\")\n      *.info;mail.none;authpriv.none;cron.none\naction(type=\"omfile\" DynaFile=\"TmplMsg\")\n}\n\ninput(type=\"imudp\" port=\"514\" ruleset=\"remote1\")\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">514\u003C/code> is the port number \u003Ccode class=\"literal\">rsyslog\u003C/code> uses by default. You can specify a different port instead.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the syntax of the \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code> file and all \u003Ccode class=\"literal\">.conf\u003C/code> files in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rsyslogd -N 1\u003C/strong>\u003C/span>\nrsyslogd: version 8.1911.0-2.el8, config validation run...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">rsyslog\u003C/code> service.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If \u003Ccode class=\"literal\">rsyslog\u003C/code> is not enabled, ensure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service starts automatically after reboot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslogd(8)\u003C/code> , \u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code>, \u003Ccode class=\"literal\">semanage(8)\u003C/code>, and \u003Ccode class=\"literal\">firewall-cmd(1)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package in the \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-remote-logging-to-a-server-over-udp_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.7. Configuring remote logging to a server over UDP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure a system for forwarding log messages to a server over the UDP protocol. The \u003Ccode class=\"literal\">omfwd\u003C/code> plug-in provides forwarding over UDP or TCP. The default protocol is UDP. Because the plug-in is built in, you do not have to load it.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rsyslog\u003C/code> package is installed on the client systems that should report to the server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured the server for remote logging as described in \u003Ca class=\"link\" href=\"#configuring-a-server-for-receiving-remote-logging-information-over-udp_assembly_configuring-a-remote-logging-solution\" title=\"14.6. Configuring a server for receiving remote logging information over UDP\">Configuring a server for receiving remote logging information over UDP\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory, for example, \u003Ccode class=\"literal\">10-remotelogcli.conf\u003C/code>, and insert the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">*.* action(type=\"omfwd\"\n      queue.type=\"linkedlist\"\n      queue.filename=\"\u003Cspan class=\"emphasis\">\u003Cem>example_fwd\u003C/em>\u003C/span>\"\n      action.resumeRetryCount=\"-1\"\n      queue.saveOnShutdown=\"on\"\n      target=\"\u003Cspan class=\"emphasis\">\u003Cem>example.com\u003C/em>\u003C/span>\" port=\"\u003Cspan class=\"emphasis\">\u003Cem>portno\u003C/em>\u003C/span>\" protocol=\"udp\"\n     )\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">queue.type=\"linkedlist\"\u003C/code> setting enables a LinkedList in-memory queue.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">queue.filename\u003C/code> setting defines a disk storage. The backup files are created with the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>example_fwd\u003C/em>\u003C/span>\u003C/code> prefix in the working directory specified by the preceding global \u003Ccode class=\"literal\">workDirectory\u003C/code> directive.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">action.resumeRetryCount -1\u003C/code> setting prevents \u003Ccode class=\"literal\">rsyslog\u003C/code> from dropping messages when retrying to connect if the server is not responding.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">enabled queue.saveOnShutdown=\"on\"\u003C/code> setting saves in-memory data if \u003Ccode class=\"literal\">rsyslog\u003C/code> shuts down.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>portno\u003C/em>\u003C/span>\u003C/code> value is the port number you want \u003Ccode class=\"literal\">rsyslog\u003C/code> to use. The default value is \u003Ccode class=\"literal\">514\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe last line forwards all received messages to the logging server, port specification is optional.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWith this configuration, \u003Ccode class=\"literal\">rsyslog\u003C/code> sends messages to the server but keeps messages in memory if the remote server is not reachable. A file on disk is created only if \u003Ccode class=\"literal\">rsyslog\u003C/code> runs out of the configured memory queue space or needs to shut down, which benefits the system performance.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tRsyslog processes configuration files \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> in the lexical order.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">rsyslog\u003C/code> service.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If \u003Ccode class=\"literal\">rsyslog\u003C/code> is not enabled, ensure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service starts automatically after reboot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo verify that the client system sends messages to the server, follow these steps:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the client system, send a test message:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logger test\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the server system, view the \u003Ccode class=\"literal\">/var/log/remote/msg/\u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span>/root.log\u003C/code> log, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /var/log/remote/msg/\u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span>/root.log\u003C/strong>\u003C/span>\nFeb 25 03:53:17 hostname root[6064]: test\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">hostname\u003C/code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslogd(8)\u003C/code> and \u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package at \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"con_load-balancing-helper-in-rsyslog_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.8. Load balancing helper in Rsyslog\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">RebindInterval\u003C/code> setting specifies an interval at which the current connection is broken and is re-established. This setting applies to TCP, UDP, and RELP traffic. The load balancers perceive it as a new connection and forward the messages to another physical target system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">RebindInterval\u003C/code> setting proves to be helpful in scenarios when a target system has changed its IP address. The Rsyslog application caches the IP address when the connection establishes, therefore, the messages are sent to the same server. If the IP address changes, the UDP packets will be lost until the Rsyslog service restarts. Re-establishing the connection will ensure the IP to be resolved by DNS again.\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">action(type=”omfwd” protocol=”tcp” RebindInterval=”250” target=”\u003Cspan class=\"emphasis\">\u003Cem>example.com\u003C/em>\u003C/span>” port=”514” …)\n\naction(type=”omfwd” protocol=”udp” RebindInterval=”250” target=”\u003Cspan class=\"emphasis\">\u003Cem>example.com\u003C/em>\u003C/span>” port=”514” …)\n\naction(type=”omrelp” RebindInterval=”250” target=”\u003Cspan class=\"emphasis\">\u003Cem>example.com\u003C/em>\u003C/span>” port=”6514” …)\u003C/pre>\u003C/section>\u003Csection class=\"section\" id=\"configuring-reliable-remote-logging_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.9. Configuring reliable remote logging\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWith the Reliable Event Logging Protocol (RELP), you can send and receive \u003Ccode class=\"literal\">syslog\u003C/code> messages over TCP with a much reduced risk of message loss. RELP provides reliable delivery of event messages, which makes it useful in environments where message loss is not acceptable. To use RELP, configure the \u003Ccode class=\"literal\">imrelp\u003C/code> input module, which runs on the server and receives the logs, and the \u003Ccode class=\"literal\">omrelp\u003C/code> output module, which runs on the client and sends logs to the logging server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have installed the \u003Ccode class=\"literal\">rsyslog\u003C/code>, \u003Ccode class=\"literal\">librelp\u003C/code>, and \u003Ccode class=\"literal\">rsyslog-relp\u003C/code> packages on the server and the client systems.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe specified port is permitted in SELinux and open in the firewall.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure the client system for reliable remote logging:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOn the client system, create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory named, for example, \u003Ccode class=\"literal\">relpclient.conf\u003C/code>, and insert the following content:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">module(load=\"omrelp\")\n*.* action(type=\"omrelp\" target=\"_target_IP_\" port=\"_target_port_\")\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhere:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>target_IP\u003C/em>\u003C/span>\u003C/code> is the IP address of the logging server.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>target_port\u003C/em>\u003C/span>\u003C/code> is the port of the logging server.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes to the \u003Ccode class=\"literal\">/etc/rsyslog.d/relpclient.conf\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">rsyslog\u003C/code> service.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: If \u003Ccode class=\"literal\">rsyslog\u003C/code> is not enabled, ensure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service starts automatically after reboot:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure the server system for reliable remote logging:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOn the server system, create a new \u003Ccode class=\"literal\">.conf\u003C/code> file in the \u003Ccode class=\"literal\">/etc/rsyslog.d/\u003C/code> directory named, for example, \u003Ccode class=\"literal\">relpserv.conf\u003C/code>, and insert the following content:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">ruleset(name=\"relp\"){\n*.* action(type=\"omfile\" file=\"_log_path_\")\n}\n\n\nmodule(load=\"imrelp\")\ninput(type=\"imrelp\" port=\"_target_port_\" ruleset=\"relp\")\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhere:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>log_path\u003C/em>\u003C/span>\u003C/code> specifies the path for storing messages.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>target_port\u003C/em>\u003C/span>\u003C/code> is the port of the logging server. Use the same value as in the client configuration file.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes to the \u003Ccode class=\"literal\">/etc/rsyslog.d/relpserv.conf\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">rsyslog\u003C/code> service.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: If \u003Ccode class=\"literal\">rsyslog\u003C/code> is not enabled, ensure the \u003Ccode class=\"literal\">rsyslog\u003C/code> service starts automatically after reboot:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable rsyslog\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo verify that the client system sends messages to the server, follow these steps:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the client system, send a test message:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logger test\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the server system, view the log at the specified \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>log_path\u003C/em>\u003C/span>\u003C/code>, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /var/log/remote/msg/hostname/root.log\u003C/strong>\u003C/span>\nFeb 25 03:53:17 hostname root[6064]: test\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">hostname\u003C/code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslogd(8)\u003C/code> and \u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package in the \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"supported-rsyslog-modules_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.10. Supported Rsyslog modules\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo expand the functionality of the Rsyslog application, you can use specific modules. Modules provide additional inputs (Input Modules), outputs (Output Modules), and other functionalities. A module can also provide additional configuration directives that become available after you load the module.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can list the input and output modules installed on your system by entering the following command:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ls /usr/lib64/rsyslog/{i,o}m\u003C/strong>\u003C/span>*\u003C/pre>\u003Cp>\n\t\t\t\tYou can view the list of all available \u003Ccode class=\"literal\">rsyslog\u003C/code> modules in the \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/configuration/modules/idx_output.html\u003C/code> file after you install the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"configuring-the-netconsole-service-to-log-kernel-messages-to-a-remote-host_assembly_configuring-a-remote-logging-solution\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.11. Configuring the netconsole service to log kernel messages to a remote host\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWhen logging to disk or using a serial console is not possible, you can use the \u003Ccode class=\"literal\">netconsole\u003C/code> kernel module and the same-named service to log kernel messages over a network to a remote \u003Ccode class=\"literal\">rsyslog\u003C/code> service.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA system log service, such as \u003Ccode class=\"literal\">rsyslog\u003C/code> is installed on the remote host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe remote system log service is configured to receive incoming log entries from this host.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">netconsole-service\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install netconsole-service\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal\">/etc/sysconfig/netconsole\u003C/code> file and set the \u003Ccode class=\"literal\">SYSLOGADDR\u003C/code> parameter to the IP address of the remote host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>SYSLOGADDR=\u003Cspan class=\"emphasis\">\u003Cem>192.0.2.1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable and start the \u003Ccode class=\"literal\">netconsole\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now netconsole\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDisplay the \u003Ccode class=\"literal\">/var/log/messages\u003C/code> file on the remote system log server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"_additional-resources _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/assembly_configuring-a-remote-logging-solution_security-hardening\">Configuring a remote logging solution\u003C/a>\n\t\t\t\t\u003C/p>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_4\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.12. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rsyslog-doc\u003C/code> package in the \u003Ccode class=\"literal\">/usr/share/doc/rsyslog/html/index.html\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">rsyslogd(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/4058681\">Configuring system logging without journald or with minimized journald usage\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/4095141\">Negative effects of the RHEL default logging setup on performance and their mitigations\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">Using the Logging system role\u003C/a> chapter\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_using-the-logging-system-role_security-hardening\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 15. Using the \u003Ccode class=\"literal\">logging\u003C/code> system role\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAs a system administrator, you can use the \u003Ccode class=\"literal\">logging\u003C/code> system role to configure a Red Hat Enterprise Linux host as a logging server to collect logs from many client systems.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"proc_filtering-logs-in-a-local-logging-system-role_assembly_using-the-logging-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.1. Filtering local log messages by using the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the property-based filter of the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to filter your local log messages based on various conditions. As a result, you can achieve for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog clarity: In a high-traffic environment, logs can grow rapidly. The focus on specific messages, like errors, can help to identify problems faster.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptimized system performance: Excessive amount of logs is usually connected with system performance degradation. Selective logging for only the important events can prevent resource depletion, which enables your systems to run more efficiently.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnhanced security: Efficient filtering through security messages, like system errors and failed logins, helps to capture only the relevant logs. This is important for detecting breaches and meeting compliance standards.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Deploy the logging solution\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Filter logs based on a specific value they contain\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: files_input\n            type: basics\n        logging_outputs:\n          - name: files_output0\n            type: files\n            property: msg\n            property_op: contains\n            property_value: error\n            path: /var/log/errors.log\n          - name: files_output1\n            type: files\n            property: msg\n            property_op: \"!contains\"\n            property_value: error\n            path: /var/log/others.log\n        logging_flows:\n          - name: flow0\n            inputs: [files_input]\n            outputs: [files_output0, files_output1]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging input dictionaries. The \u003Ccode class=\"literal\">type: basics\u003C/code> option covers inputs from \u003Ccode class=\"literal\">systemd\u003C/code> journal or Unix socket.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging output dictionaries. The \u003Ccode class=\"literal\">type: files\u003C/code> option supports storing logs in the local files, usually in the \u003Ccode class=\"literal\">/var/log/\u003C/code> directory. The \u003Ccode class=\"literal\">property: msg\u003C/code>; \u003Ccode class=\"literal\">property: contains\u003C/code>; and \u003Ccode class=\"literal\">property_value: error\u003C/code> options specify that all logs that contain the \u003Ccode class=\"literal\">error\u003C/code> string are stored in the \u003Ccode class=\"literal\">/var/log/errors.log\u003C/code> file. The \u003Ccode class=\"literal\">property: msg\u003C/code>; \u003Ccode class=\"literal\">property: !contains\u003C/code>; and \u003Ccode class=\"literal\">property_value: error\u003C/code> options specify that all other logs are put in the \u003Ccode class=\"literal\">/var/log/others.log\u003C/code> file. You can replace the \u003Ccode class=\"literal\">error\u003C/code> value with the string by which you want to filter.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_flows\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging flow dictionaries to specify relationships between \u003Ccode class=\"literal\">logging_inputs\u003C/code> and \u003Ccode class=\"literal\">logging_outputs\u003C/code>. The \u003Ccode class=\"literal\">inputs: [files_input]\u003C/code> option specifies a list of inputs, from which processing of logs starts. The \u003Ccode class=\"literal\">outputs: [files_output0, files_output1]\u003C/code> option specifies a list of outputs, to which the logs are sent.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed node, test the syntax of the \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rsyslogd -N 1\u003C/strong>\u003C/span>\nrsyslogd: version 8.1911.0-6.el8, config validation run...\nrsyslogd: End of config validation run. Bye.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed node, verify that the system sends messages that contain the \u003Ccode class=\"literal\">error\u003C/code> string to the log:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSend a test message:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logger error\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tView the \u003Ccode class=\"literal\">/var/log/errors.log\u003C/code> log, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /var/log/errors.log\u003C/strong>\u003C/span>\nAug  5 13:48:31 \u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span> root[6778]: error\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span>\u003C/code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"applying-a-remote-logging-solution-using-the-logging-system-role_assembly_using-the-logging-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.2. Applying a remote logging solution by using the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure a remote logging solution, where one or more clients take logs from the \u003Ccode class=\"literal\">systemd-journal\u003C/code> service and forward them to a remote server. The server receives remote input from the \u003Ccode class=\"literal\">remote_rsyslog\u003C/code> and \u003Ccode class=\"literal\">remote_files\u003C/code> configurations, and outputs the logs to local files in directories named by remote host names.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAs a result, you can cover use cases where you need for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCentralized log management: Collecting, accessing, and managing log messages of multiple machines from a single storage point simplifies day-to-day monitoring and troubleshooting tasks. Also, this use case reduces the need to log into individual machines to check the log messages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnhanced security: Storing log messages in one central place increases chances they are in a secure and tamper-proof environment. Such an environment makes it easier to detect and respond to security incidents more effectively and to meet audit requirements.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tImproved efficiency in log analysis: Correlating log messages from multiple systems is important for fast troubleshooting of complex problems that span multiple machines or services. That way you can quickly analyze and cross-reference events from different sources.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDefine the ports in the SELinux policy of the server or client system and open the firewall for those ports. The default SELinux policy includes ports 601, 514, 6514, 10514, and 20514. To use a different port, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations\">modify the SELinux policy on the client and server systems\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Deploy the logging solution\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure the server to receive remote input\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: remote_udp_input\n            type: remote\n            udp_ports: [ 601 ]\n          - name: remote_tcp_input\n            type: remote\n            tcp_ports: [ 601 ]\n        logging_outputs:\n          - name: remote_files_output\n            type: remote_files\n        logging_flows:\n          - name: flow_0\n            inputs: [remote_udp_input, remote_tcp_input]\n            outputs: [remote_files_output]\n\n- name: Deploy the logging solution\n  hosts: managed-node-02.example.com\n  tasks:\n    - name: Configure the server to output the logs to local files in directories named by remote host names\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: basic_input\n            type: basics\n        logging_outputs:\n          - name: forward_output0\n            type: forwards\n            severity: info\n            target: \u003Cspan class=\"emphasis\">\u003Cem>&lt;host1.example.com&gt;\u003C/em>\u003C/span>\n            udp_port: 601\n          - name: forward_output1\n            type: forwards\n            facility: mail\n            target: \u003Cspan class=\"emphasis\">\u003Cem>&lt;host1.example.com&gt;\u003C/em>\u003C/span>\n            tcp_port: 601\n        logging_flows:\n          - name: flows0\n            inputs: [basic_input]\n            outputs: [forward_output0, forward_output1]\n\n[basic_input]\n[forward_output0, forward_output1]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the first play of the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging input dictionaries. The \u003Ccode class=\"literal\">type: remote\u003C/code> option covers remote inputs from the other logging system over the network. The \u003Ccode class=\"literal\">udp_ports: [ 601 ]\u003C/code> option defines a list of UDP port numbers to monitor. The \u003Ccode class=\"literal\">tcp_ports: [ 601 ]\u003C/code> option defines a list of TCP port numbers to monitor. If both \u003Ccode class=\"literal\">udp_ports\u003C/code> and \u003Ccode class=\"literal\">tcp_ports\u003C/code> is set, \u003Ccode class=\"literal\">udp_ports\u003C/code> is used and \u003Ccode class=\"literal\">tcp_ports\u003C/code> is dropped.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging output dictionaries. The \u003Ccode class=\"literal\">type: remote_files\u003C/code> option makes output store logs to the local files per remote host and program name originated the logs.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_flows\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging flow dictionaries to specify relationships between \u003Ccode class=\"literal\">logging_inputs\u003C/code> and \u003Ccode class=\"literal\">logging_outputs\u003C/code>. The \u003Ccode class=\"literal\">inputs: [remote_udp_input, remote_tcp_input]\u003C/code> option specifies a list of inputs, from which processing of logs starts. The \u003Ccode class=\"literal\">outputs: [remote_files_output]\u003C/code> option specifies a list of outputs, to which the logs are sent.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the second play of the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging input dictionaries. The \u003Ccode class=\"literal\">type: basics\u003C/code> option covers inputs from \u003Ccode class=\"literal\">systemd\u003C/code> journal or Unix socket.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging output dictionaries. The \u003Ccode class=\"literal\">type: forwards\u003C/code> option supports sending logs to the remote logging server over the network. The \u003Ccode class=\"literal\">severity: info\u003C/code> option refers to log messages of the informative importance. The \u003Ccode class=\"literal\">facility: mail\u003C/code> option refers to the type of system program that is generating the log message. The \u003Ccode class=\"literal\">target: \u003Cspan class=\"emphasis\">\u003Cem>&lt;host1.example.com&gt;\u003C/em>\u003C/span>\u003C/code> option specifies the hostname of the remote logging server. The \u003Ccode class=\"literal\">udp_port: 601\u003C/code>/\u003Ccode class=\"literal\">tcp_port: 601\u003C/code> options define the UDP/TCP ports on which the remote logging server listens.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_flows\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging flow dictionaries to specify relationships between \u003Ccode class=\"literal\">logging_inputs\u003C/code> and \u003Ccode class=\"literal\">logging_outputs\u003C/code>. The \u003Ccode class=\"literal\">inputs: [basic_input]\u003C/code> option specifies a list of inputs, from which processing of logs starts. The \u003Ccode class=\"literal\">outputs: [forward_output0, forward_output1]\u003C/code> option specifies a list of outputs, to which the logs are sent.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn both the client and the server system, test the syntax of the \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rsyslogd -N 1\u003C/strong>\u003C/span>\nrsyslogd: version 8.1911.0-6.el8, config validation run (level 1), master config /etc/rsyslog.conf\nrsyslogd: End of config validation run. Bye.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the client system sends messages to the server:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOn the client system, send a test message:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logger test\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOn the server system, view the \u003Ccode class=\"literal\">/var/log/\u003Cspan class=\"emphasis\">\u003Cem>&lt;host2.example.com&gt;\u003C/em>\u003C/span>/messages\u003C/code> log, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /var/log/\u003Cspan class=\"emphasis\">\u003Cem>&lt;host2.example.com&gt;\u003C/em>\u003C/span>/messages\u003C/strong>\u003C/span>\nAug  5 13:48:31 \u003Cspan class=\"emphasis\">\u003Cem>&lt;host2.example.com&gt;\u003C/em>\u003C/span> root[6778]: test\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;host2.example.com&gt;\u003C/em>\u003C/span>\u003C/code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.3. Using the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role with TLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTransport Layer Security (TLS) is a cryptographic protocol designed to allow secure communication over the computer network.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure a secure transfer of log messages, where one or more clients take logs from the \u003Ccode class=\"literal\">systemd-journal\u003C/code> service and transfer them to a remote server while using TLS.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTypically, TLS for transferring logs in a remote logging solution is used when sending sensitive data over less trusted or public networks, such as the Internet. Also, by using certificates in TLS you can ensure that the client is forwarding logs to the correct and trusted server. This prevents attacks like \"man-in-the-middle\".\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">15.3.1. Configuring client logging with TLS\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure logging on RHEL clients and transfer logs to a remote logging system using TLS encryption.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis procedure creates a private key and a certificate. Next, it configures TLS on all hosts in the clients group in the Ansible inventory. The TLS protocol encrypts the message transmission for secure transfer of logs over the network.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tYou do not have to call the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role in the playbook to create the certificate. The \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role calls it automatically when the \u003Ccode class=\"literal\">logging_certificates\u003C/code> variable is set.\n\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\tIn order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe managed nodes are enrolled in an IdM domain.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIf the logging server you want to configure on the manage node runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS extension \"Extended Master Secret\" enforced\u003C/a> Knowledgebase article.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure remote logging solution using TLS for secure transfer of logs\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploying files input and forwards output with certs\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_certificates:\n          - name: logging_cert\n            dns: ['localhost', 'www.example.com']\n            ca: ipa\n        logging_pki_files:\n          - ca_cert: /local/path/to/ca_cert.pem\n            cert: /local/path/to/logging_cert.pem\n            private_key: /local/path/to/logging_cert.pem\n        logging_inputs:\n          - name: input_name\n            type: files\n            input_log_path: /var/log/containers/*.log\n        logging_outputs:\n          - name: output_name\n            type: forwards\n            target: your_target_host\n            tcp_port: 514\n            tls: true\n            pki_authmode: x509/name\n            permitted_server: 'server.example.com'\n        logging_flows:\n          - name: flow_name\n            inputs: [input_name]\n            outputs: [output_name]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_certificates\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThe value of this parameter is passed on to \u003Ccode class=\"literal\">certificate_requests\u003C/code> in the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role and used to create a private key and certificate.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_pki_files\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tUsing this parameter, you can configure the paths and other settings that logging uses to find the CA, certificate, and key files used for TLS, specified with one or more of the following sub-parameters: \u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>, and \u003Ccode class=\"literal\">tls\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\tIf you are using \u003Ccode class=\"literal\">logging_certificates\u003C/code> to create the files on the managed node, do not use \u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, and \u003Ccode class=\"literal\">private_key_src\u003C/code>, which are used to copy files not created by \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the CA certificate file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/ca.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the certificate file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/server-cert.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the private key file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/private/server-key.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the CA certificate file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">ca_cert\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to a certificate file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">cert\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to a private key file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">private_key\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tSetting this parameter to \u003Ccode class=\"literal\">true\u003C/code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set \u003Ccode class=\"literal\">tls: false\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/certificate/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">Requesting certificates using RHEL system roles\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">15.3.2. Configuring server logging with TLS\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure logging on RHEL servers and set them to receive logs from a remote logging system using TLS encryption.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis procedure creates a private key and a certificate. Next, it configures TLS on all hosts in the server group in the Ansible inventory.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tYou do not have to call the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role in the playbook to create the certificate. The \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role calls it automatically.\n\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\tIn order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe managed nodes are enrolled in an IdM domain.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIf the logging server you want to configure on the manage node runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS extension \"Extended Master Secret\" enforced\u003C/a> Knowledgebase article.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure remote logging solution using TLS for secure transfer of logs\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploying remote input and remote_files output with certs\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_certificates:\n          - name: logging_cert\n            dns: ['localhost', 'www.example.com']\n            ca: ipa\n        logging_pki_files:\n          - ca_cert: /local/path/to/ca_cert.pem\n            cert: /local/path/to/logging_cert.pem\n            private_key: /local/path/to/logging_cert.pem\n        logging_inputs:\n          - name: input_name\n            type: remote\n            tcp_ports: 514\n            tls: true\n            permitted_clients: ['clients.example.com']\n        logging_outputs:\n          - name: output_name\n            type: remote_files\n            remote_log_path: /var/log/remote/%FROMHOST%/%PROGRAMNAME:::secpath-replace%.log\n            async_writing: true\n            client_count: 20\n            io_buffer_size: 8192\n        logging_flows:\n          - name: flow_name\n            inputs: [input_name]\n            outputs: [output_name]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_certificates\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThe value of this parameter is passed on to \u003Ccode class=\"literal\">certificate_requests\u003C/code> in the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role and used to create a private key and certificate.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_pki_files\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tUsing this parameter, you can configure the paths and other settings that logging uses to find the CA, certificate, and key files used for TLS, specified with one or more of the following sub-parameters: \u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>, and \u003Ccode class=\"literal\">tls\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\tIf you are using \u003Ccode class=\"literal\">logging_certificates\u003C/code> to create the files on the managed node, do not use \u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, and \u003Ccode class=\"literal\">private_key_src\u003C/code>, which are used to copy files not created by \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the CA certificate file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/ca.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the certificate file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/server-cert.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the private key file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/private/server-key.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the CA certificate file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">ca_cert\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to a certificate file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">cert\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to a private key file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">private_key\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tSetting this parameter to \u003Ccode class=\"literal\">true\u003C/code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set \u003Ccode class=\"literal\">tls: false\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">Requesting certificates using RHEL system roles\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"assembly_using-the-logging-system-roles-with-relp\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.4. Using the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system roles with RELP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tReliable Event Logging Protocol (RELP) is a networking protocol for data and message logging over the TCP network. It ensures reliable delivery of event messages and you can use it in environments that do not tolerate any message loss.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe RELP sender transfers log entries in the form of commands and the receiver acknowledges them once they are processed. To ensure consistency, RELP stores the transaction number to each transferred command for any kind of message recovery.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can consider a remote logging system in between the RELP Client and RELP Server. The RELP Client transfers the logs to the remote logging system and the RELP Server receives all the logs sent by the remote logging system. To achieve that use case, you can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure the logging system to reliably send and receive log entries.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">15.4.1. Configuring client logging with RELP\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure a transfer of log messages stored locally to the remote logging system with RELP.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis procedure configures RELP on all hosts in the \u003Ccode class=\"literal\">clients\u003C/code> group in the Ansible inventory. The RELP configuration uses Transport Layer Security (TLS) to encrypt the message transmission for secure transfer of logs over the network.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure client-side of the remote logging solution using RELP\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploy basic input and RELP output\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: basic_input\n            type: basics\n        logging_outputs:\n          - name: relp_client\n            type: relp\n            target: logging.server.com\n            port: 20514\n            tls: true\n            ca_cert: /etc/pki/tls/certs/ca.pem\n            cert: /etc/pki/tls/certs/client-cert.pem\n            private_key: /etc/pki/tls/private/client-key.pem\n            pki_authmode: name\n            permitted_servers:\n              - '*.server.example.com'\n        logging_flows:\n          - name: example_flow\n            inputs: [basic_input]\n            outputs: [relp_client]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">target\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThis is a required parameter that specifies the host name where the remote logging system is running.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">port\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tPort number the remote logging system is listening.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tEnsures secure transfer of logs over the network. If you do not want a secure wrapper you can set the \u003Ccode class=\"literal\">tls\u003C/code> variable to \u003Ccode class=\"literal\">false\u003C/code>. By default \u003Ccode class=\"literal\">tls\u003C/code> parameter is set to true while working with RELP and requires key/certificates and triplets {\u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>} and/or {\u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>}.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf the {\u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>} triplet is set, the default locations \u003Ccode class=\"literal\">/etc/pki/tls/certs\u003C/code> and \u003Ccode class=\"literal\">/etc/pki/tls/private\u003C/code> are used as the destination on the managed node to transfer files from control node. In this case, the file names are identical to the original ones in the triplet\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf the {\u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>} triplet is set, files are expected to be on the default path before the logging configuration.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf both triplets are set, files are transferred from local path from control node to specific path of the managed node.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to CA certificate. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/ca.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to certificate. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/server-cert.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to private key. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/private/server-key.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents local CA certificate file path which is copied to the managed node. If \u003Ccode class=\"literal\">ca_cert\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the local certificate file path which is copied to the managed node. If \u003Ccode class=\"literal\">cert\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the local key file path which is copied to the managed node. If \u003Ccode class=\"literal\">private_key\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">pki_authmode\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tAccepts the authentication mode as \u003Ccode class=\"literal\">name\u003C/code> or \u003Ccode class=\"literal\">fingerprint\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">permitted_servers\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of servers that will be allowed by the logging client to connect and send logs over TLS.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of logging input dictionary.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of logging output dictionary.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">15.4.2. Configuring server logging with RELP\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure a server for receiving log messages from the remote logging system with RELP.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis procedure configures RELP on all hosts in the \u003Ccode class=\"literal\">server\u003C/code> group in the Ansible inventory. The RELP configuration uses TLS to encrypt the message transmission for secure transfer of logs over the network.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure server-side of the remote logging solution using RELP\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploying remote input and remote_files output\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: relp_server\n            type: relp\n            port: 20514\n            tls: true\n            ca_cert: /etc/pki/tls/certs/ca.pem\n            cert: /etc/pki/tls/certs/server-cert.pem\n            private_key: /etc/pki/tls/private/server-key.pem\n            pki_authmode: name\n            permitted_clients:\n              - '*example.client.com'\n        logging_outputs:\n          - name: remote_files_output\n            type: remote_files\n        logging_flows:\n          - name: example_flow\n            inputs: relp_server\n            outputs: remote_files_output\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">port\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tPort number the remote logging system is listening.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tEnsures secure transfer of logs over the network. If you do not want a secure wrapper you can set the \u003Ccode class=\"literal\">tls\u003C/code> variable to \u003Ccode class=\"literal\">false\u003C/code>. By default \u003Ccode class=\"literal\">tls\u003C/code> parameter is set to true while working with RELP and requires key/certificates and triplets {\u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>} and/or {\u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>}.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf the {\u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>} triplet is set, the default locations \u003Ccode class=\"literal\">/etc/pki/tls/certs\u003C/code> and \u003Ccode class=\"literal\">/etc/pki/tls/private\u003C/code> are used as the destination on the managed node to transfer files from control node. In this case, the file names are identical to the original ones in the triplet\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf the {\u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>} triplet is set, files are expected to be on the default path before the logging configuration.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf both triplets are set, files are transferred from local path from control node to specific path of the managed node.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to CA certificate. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/ca.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the certificate. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/server-cert.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to private key. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/private/server-key.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents local CA certificate file path which is copied to the managed node. If \u003Ccode class=\"literal\">ca_cert\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the local certificate file path which is copied to the managed node. If \u003Ccode class=\"literal\">cert\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the local key file path which is copied to the managed node. If \u003Ccode class=\"literal\">private_key\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">pki_authmode\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tAccepts the authentication mode as \u003Ccode class=\"literal\">name\u003C/code> or \u003Ccode class=\"literal\">fingerprint\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">permitted_clients\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of clients that will be allowed by the logging server to connect and send logs over TLS.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of logging input dictionary.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of logging output dictionary.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_5\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.5. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">Preparing a control node and managed nodes to use RHEL system roles\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDocumentation installed with the \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package in \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.html\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/node/3050101\">RHEL system roles\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ansible-playbook(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"legalnotice\" id=\"idm140081355003760\">\u003Ch2 class=\"legalnotice\">Legal Notice\u003C/h2>\u003Cdiv class=\"para\">\n\t\tCopyright \u003Cspan class=\"trademark\">\u003C!--Empty-->\u003C/span>© 2024 Red Hat, Inc.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license (\"CC-BY-SA\"). An explanation of CC-BY-SA is available at \u003Ca class=\"uri\" href=\"http://creativecommons.org/licenses/by-sa/3.0/\">http://creativecommons.org/licenses/by-sa/3.0/\u003C/a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Linux\u003C/span>® is the registered trademark of Linus Torvalds in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Java\u003C/span>® is a registered trademark of Oracle and/or its affiliates.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">XFS\u003C/span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">MySQL\u003C/span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Node.js\u003C/span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe \u003Cspan class=\"trademark\">OpenStack\u003C/span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tAll other trademarks are the property of their respective owners.\n\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003C/body>",[14,21,26,54,79,129,158,179,296,349,374,415,500,557,594,635,688,732],{"title":11,"visible":15,"weight":16,"urlFragment":17,"anchor":18,"singlePageAnchor":18,"docTitle":19,"url":20},true,1,"index",null,"security_hardening","#",{"title":22,"visible":15,"weight":23,"urlFragment":24,"anchor":18,"singlePageAnchor":24,"docTitle":19,"url":25},"Providing feedback on Red Hat documentation",2,"proc_providing-feedback-on-red-hat-documentation_security-hardening","#proc_providing-feedback-on-red-hat-documentation_security-hardening",{"title":27,"visible":15,"weight":28,"urlFragment":29,"anchor":18,"singlePageAnchor":29,"sections":30,"docTitle":19,"url":53},"1. Securing RHEL during and right after installation",3,"assembly_securing-rhel-during-installation-security-hardening",[31,35,39,43,48],{"title":32,"visible":15,"weight":16,"urlFragment":29,"anchor":33,"singlePageAnchor":33,"docTitle":19,"url":34},"1.1. Disk partitioning","Disk_partitioning_securing-rhel-during-installation","#Disk_partitioning_securing-rhel-during-installation",{"title":36,"visible":15,"weight":23,"urlFragment":29,"anchor":37,"singlePageAnchor":37,"docTitle":19,"url":38},"1.2. Restricting network connectivity during the installation process","Restricting_network_during_installation_securing-rhel-during-installation","#Restricting_network_during_installation_securing-rhel-during-installation",{"title":40,"visible":15,"weight":28,"urlFragment":29,"anchor":41,"singlePageAnchor":41,"docTitle":19,"url":42},"1.3. Installing the minimum amount of packages required","Minimal_install_securing-rhel-during-installation","#Minimal_install_securing-rhel-during-installation",{"title":44,"visible":15,"weight":45,"urlFragment":29,"anchor":46,"singlePageAnchor":46,"docTitle":19,"url":47},"1.4. Post-installation procedures",4,"Post-installation_procedures_securing-rhel-during-installation","#Post-installation_procedures_securing-rhel-during-installation",{"title":49,"visible":15,"weight":50,"urlFragment":29,"anchor":51,"singlePageAnchor":51,"docTitle":19,"url":52},"1.5. Disabling SMT to prevent CPU security issues by using the web console",5,"disabling-simultaneous-multithreading-to-prevent-cpu-security-issues_configuring-system-settings-in-the-web-console","#disabling-simultaneous-multithreading-to-prevent-cpu-security-issues_configuring-system-settings-in-the-web-console","#assembly_securing-rhel-during-installation-security-hardening",{"title":55,"visible":15,"weight":45,"urlFragment":56,"anchor":18,"singlePageAnchor":56,"sections":57,"docTitle":19,"url":78},"2. Switching RHEL to FIPS mode","switching-rhel-to-fips-mode_security-hardening",[58,62,66,70,74],{"title":59,"visible":15,"weight":16,"urlFragment":56,"anchor":60,"singlePageAnchor":60,"docTitle":19,"url":61},"2.1. Federal Information Processing Standards 140 and FIPS mode","federal-information-processing-standards-140-and-fips-mode_switching-rhel-to-fips-mode","#federal-information-processing-standards-140-and-fips-mode_switching-rhel-to-fips-mode",{"title":63,"visible":15,"weight":23,"urlFragment":56,"anchor":64,"singlePageAnchor":64,"docTitle":19,"url":65},"2.2. Installing the system with FIPS mode enabled","proc_installing-the-system-with-fips-mode-enabled_switching-rhel-to-fips-mode","#proc_installing-the-system-with-fips-mode-enabled_switching-rhel-to-fips-mode",{"title":67,"visible":15,"weight":28,"urlFragment":56,"anchor":68,"singlePageAnchor":68,"docTitle":19,"url":69},"2.3. Switching the system to FIPS mode","switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies","#switching-the-system-to-fips-mode_using-the-system-wide-cryptographic-policies",{"title":71,"visible":15,"weight":45,"urlFragment":56,"anchor":72,"singlePageAnchor":72,"docTitle":19,"url":73},"2.4. Enabling FIPS mode in a container","enabling-fips-mode-in-a-container_using-the-system-wide-cryptographic-policies","#enabling-fips-mode-in-a-container_using-the-system-wide-cryptographic-policies",{"title":75,"visible":15,"weight":50,"urlFragment":56,"anchor":76,"singlePageAnchor":76,"docTitle":19,"url":77},"2.5. List of RHEL applications using cryptography that is not compliant with FIPS 140-3","ref_list-of-rhel-applications-using-cryptography-that-is-not-compliant-with-fips-140-3_switching-rhel-to-fips-mode","#ref_list-of-rhel-applications-using-cryptography-that-is-not-compliant-with-fips-140-3_switching-rhel-to-fips-mode","#switching-rhel-to-fips-mode_security-hardening",{"title":80,"visible":15,"weight":50,"urlFragment":81,"anchor":18,"singlePageAnchor":81,"sections":82,"docTitle":19,"url":128},"3. Using system-wide cryptographic policies","using-the-system-wide-cryptographic-policies_security-hardening",[83,87,91,95,99,103,113,118,123],{"title":84,"visible":15,"weight":16,"urlFragment":81,"anchor":85,"singlePageAnchor":85,"docTitle":19,"url":86},"3.1. System-wide cryptographic policies","system-wide-crypto-policies_using-the-system-wide-cryptographic-policies","#system-wide-crypto-policies_using-the-system-wide-cryptographic-policies",{"title":88,"visible":15,"weight":23,"urlFragment":81,"anchor":89,"singlePageAnchor":89,"docTitle":19,"url":90},"3.2. Changing the system-wide cryptographic policy","changing-the-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies","#changing-the-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies",{"title":92,"visible":15,"weight":28,"urlFragment":81,"anchor":93,"singlePageAnchor":93,"docTitle":19,"url":94},"3.3. Switching the system-wide cryptographic policy to mode compatible with earlier releases","switching-the-system-wide-crypto-policy-to-mode-compatible-with-previous-systems_using-the-system-wide-cryptographic-policies","#switching-the-system-wide-crypto-policy-to-mode-compatible-with-previous-systems_using-the-system-wide-cryptographic-policies",{"title":96,"visible":15,"weight":45,"urlFragment":81,"anchor":97,"singlePageAnchor":97,"docTitle":19,"url":98},"3.4. Re-enabling SHA-1","proc_re-enabling-sha-1_using-the-system-wide-cryptographic-policies","#proc_re-enabling-sha-1_using-the-system-wide-cryptographic-policies",{"title":100,"visible":15,"weight":50,"urlFragment":81,"anchor":101,"singlePageAnchor":101,"docTitle":19,"url":102},"3.5. Setting up system-wide cryptographic policies in the web console","setting-up-system-wide-crypto-policies-in-the-web-console_using-the-system-wide-cryptographic-policies","#setting-up-system-wide-crypto-policies-in-the-web-console_using-the-system-wide-cryptographic-policies",{"title":104,"visible":15,"weight":105,"urlFragment":81,"anchor":106,"singlePageAnchor":106,"sections":107,"docTitle":19,"url":112},"3.6. Excluding an application from following system-wide crypto policies",6,"excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies",[108],{"title":109,"visible":15,"weight":16,"urlFragment":81,"anchor":110,"singlePageAnchor":110,"docTitle":19,"url":111},"3.6.1. Examples of opting out of system-wide crypto policies","examples-of-opting-out-of-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies","#examples-of-opting-out-of-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies","#excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies",{"title":114,"visible":15,"weight":115,"urlFragment":81,"anchor":116,"singlePageAnchor":116,"docTitle":19,"url":117},"3.7. Customizing system-wide cryptographic policies with subpolicies",7,"customizing-system-wide-cryptographic-policies-with-subpolicies_using-the-system-wide-cryptographic-policies","#customizing-system-wide-cryptographic-policies-with-subpolicies_using-the-system-wide-cryptographic-policies",{"title":119,"visible":15,"weight":120,"urlFragment":81,"anchor":121,"singlePageAnchor":121,"docTitle":19,"url":122},"3.8. Creating and setting a custom system-wide cryptographic policy",8,"creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies","#creating-and-setting-a-custom-system-wide-cryptographic-policy_using-the-system-wide-cryptographic-policies",{"title":124,"visible":15,"weight":125,"urlFragment":81,"anchor":126,"singlePageAnchor":126,"docTitle":19,"url":127},"3.9. Enhancing security with the FUTURE cryptographic policy using the crypto_policies RHEL system role",9,"proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_using-the-system-wide-cryptographic-policies","#proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_using-the-system-wide-cryptographic-policies","#using-the-system-wide-cryptographic-policies_security-hardening",{"title":130,"visible":15,"weight":105,"urlFragment":131,"anchor":18,"singlePageAnchor":131,"sections":132,"docTitle":19,"url":157},"4. Configuring applications to use cryptographic hardware through PKCS #11","configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening",[133,137,141,145,149,153],{"title":134,"visible":15,"weight":16,"urlFragment":131,"anchor":135,"singlePageAnchor":135,"docTitle":19,"url":136},"4.1. Cryptographic hardware support through PKCS #11","cryptographic-hardware-support-through-pkcs-11_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11","#cryptographic-hardware-support-through-pkcs-11_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11",{"title":138,"visible":15,"weight":23,"urlFragment":131,"anchor":139,"singlePageAnchor":139,"docTitle":19,"url":140},"4.2. Authenticating by SSH keys stored on a smart card","using-ssh-keys-stored-on-a-smart-card_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11","#using-ssh-keys-stored-on-a-smart-card_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11",{"title":142,"visible":15,"weight":28,"urlFragment":131,"anchor":143,"singlePageAnchor":143,"docTitle":19,"url":144},"4.3. Configuring applications for authentication with certificates on smart cards","configuring-applications-to-authenticate-using-certificates-from-smart-cards_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11","#configuring-applications-to-authenticate-using-certificates-from-smart-cards_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11",{"title":146,"visible":15,"weight":45,"urlFragment":131,"anchor":147,"singlePageAnchor":147,"docTitle":19,"url":148},"4.4. Using HSMs protecting private keys in Apache","ref_using-hsms-protecting-private-keys-in-apache_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11","#ref_using-hsms-protecting-private-keys-in-apache_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11",{"title":150,"visible":15,"weight":50,"urlFragment":131,"anchor":151,"singlePageAnchor":151,"docTitle":19,"url":152},"4.5. Using HSMs protecting private keys in Nginx","ref_using-hsms-protecting-private-keys-in-nginx_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11","#ref_using-hsms-protecting-private-keys-in-nginx_configuring-applications-to-use-cryptographic-hardware-through-pkcs-11",{"title":154,"visible":15,"weight":105,"urlFragment":131,"anchor":155,"singlePageAnchor":155,"docTitle":19,"url":156},"4.6. Additional resources","related-information-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11","#related-information-configuring-applications-to-use-cryptographic-hardware-through-pkcs-11","#configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening",{"title":159,"visible":15,"weight":115,"urlFragment":160,"anchor":18,"singlePageAnchor":160,"sections":161,"docTitle":19,"url":178},"5. Controlling access to smart cards by using polkit","assembly_controlling-access-to-smart-cards-using-polkit_security-hardening",[162,166,170,174],{"title":163,"visible":15,"weight":16,"urlFragment":160,"anchor":164,"singlePageAnchor":164,"docTitle":19,"url":165},"5.1. Smart-card access control through polkit","con_smart-card-access-control-through-polkit_assembly_controlling-access-to-smart-cards-using-polkit","#con_smart-card-access-control-through-polkit_assembly_controlling-access-to-smart-cards-using-polkit",{"title":167,"visible":15,"weight":23,"urlFragment":160,"anchor":168,"singlePageAnchor":168,"docTitle":19,"url":169},"5.2. Troubleshooting problems related to PC/SC and polkit","ref_troubleshooting-problems-related-to-pc-sc-and-polkit_assembly_controlling-access-to-smart-cards-using-polkit","#ref_troubleshooting-problems-related-to-pc-sc-and-polkit_assembly_controlling-access-to-smart-cards-using-polkit",{"title":171,"visible":15,"weight":28,"urlFragment":160,"anchor":172,"singlePageAnchor":172,"docTitle":19,"url":173},"5.3. Displaying more detailed information about polkit authorization to PC/SC","proc_displaying-more-detailed-information-about-polkit-authorization-to-pc-sc_assembly_controlling-access-to-smart-cards-using-polkit","#proc_displaying-more-detailed-information-about-polkit-authorization-to-pc-sc_assembly_controlling-access-to-smart-cards-using-polkit",{"title":175,"visible":15,"weight":45,"urlFragment":160,"anchor":176,"singlePageAnchor":176,"docTitle":19,"url":177},"5.4. Additional resources","additional_resources","#additional_resources","#assembly_controlling-access-to-smart-cards-using-polkit_security-hardening",{"title":180,"visible":15,"weight":120,"urlFragment":181,"anchor":18,"singlePageAnchor":181,"sections":182,"docTitle":19,"url":295},"6. Scanning the system for configuration compliance and vulnerabilities","scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening",[183,187,204,225,229,233,237,241,258,275,280,285,290],{"title":184,"visible":15,"weight":16,"urlFragment":181,"anchor":185,"singlePageAnchor":185,"docTitle":19,"url":186},"6.1. Configuration compliance tools in RHEL","configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities","#configuration-compliance-tools-in-rhel_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":188,"visible":15,"weight":23,"urlFragment":181,"anchor":189,"singlePageAnchor":189,"sections":190,"docTitle":19,"url":203},"6.2. Vulnerability scanning","vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities",[191,195,199],{"title":192,"visible":15,"weight":16,"urlFragment":181,"anchor":193,"singlePageAnchor":193,"docTitle":19,"url":194},"6.2.1. Red Hat Security Advisories OVAL feed","red-hat-security-advisories-oval-feed_vulnerability-scanning","#red-hat-security-advisories-oval-feed_vulnerability-scanning",{"title":196,"visible":15,"weight":23,"urlFragment":181,"anchor":197,"singlePageAnchor":197,"docTitle":19,"url":198},"6.2.2. Scanning the system for vulnerabilities","scanning-the-system-for-vulnerabilities_vulnerability-scanning","#scanning-the-system-for-vulnerabilities_vulnerability-scanning",{"title":200,"visible":15,"weight":28,"urlFragment":181,"anchor":201,"singlePageAnchor":201,"docTitle":19,"url":202},"6.2.3. Scanning remote systems for vulnerabilities","scanning-remote-systems-for-vulnerabilities_vulnerability-scanning","#scanning-remote-systems-for-vulnerabilities_vulnerability-scanning","#vulnerability-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":205,"visible":15,"weight":28,"urlFragment":181,"anchor":206,"singlePageAnchor":206,"sections":207,"docTitle":19,"url":224},"6.3. Configuration compliance scanning","configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities",[208,212,216,220],{"title":209,"visible":15,"weight":16,"urlFragment":181,"anchor":210,"singlePageAnchor":210,"docTitle":19,"url":211},"6.3.1. Configuration compliance in RHEL","configuration-compliance-in-rhel-8_configuration-compliance-scanning","#configuration-compliance-in-rhel-8_configuration-compliance-scanning",{"title":213,"visible":15,"weight":23,"urlFragment":181,"anchor":214,"singlePageAnchor":214,"docTitle":19,"url":215},"6.3.2. Possible results of an OpenSCAP scan","possible-results-of-an-openscap-scan_configuration-compliance-scanning","#possible-results-of-an-openscap-scan_configuration-compliance-scanning",{"title":217,"visible":15,"weight":28,"urlFragment":181,"anchor":218,"singlePageAnchor":218,"docTitle":19,"url":219},"6.3.3. Viewing profiles for configuration compliance","viewing-profiles-for-configuration-compliance_configuration-compliance-scanning","#viewing-profiles-for-configuration-compliance_configuration-compliance-scanning",{"title":221,"visible":15,"weight":45,"urlFragment":181,"anchor":222,"singlePageAnchor":222,"docTitle":19,"url":223},"6.3.4. Assessing configuration compliance with a specific baseline","assessing-configuration-compliance-with-a-specific-baseline_configuration-compliance-scanning","#assessing-configuration-compliance-with-a-specific-baseline_configuration-compliance-scanning","#configuration-compliance-scanning_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":226,"visible":15,"weight":45,"urlFragment":181,"anchor":227,"singlePageAnchor":227,"docTitle":19,"url":228},"6.4. Remediating the system to align with a specific baseline","remediating-the-system-to-align-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities","#remediating-the-system-to-align-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":230,"visible":15,"weight":50,"urlFragment":181,"anchor":231,"singlePageAnchor":231,"docTitle":19,"url":232},"6.5. Remediating the system to align with a specific baseline using an SSG Ansible playbook","remediating-the-system-to-align-with-a-specific-baseline-using-the-ssg-ansible-playbook_scanning-the-system-for-configuration-compliance-and-vulnerabilities","#remediating-the-system-to-align-with-a-specific-baseline-using-the-ssg-ansible-playbook_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":234,"visible":15,"weight":105,"urlFragment":181,"anchor":235,"singlePageAnchor":235,"docTitle":19,"url":236},"6.6. Creating a remediation Ansible playbook to align the system with a specific baseline","creating-a-remediation-ansible-playbook-to-align-the-system-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities","#creating-a-remediation-ansible-playbook-to-align-the-system-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":238,"visible":15,"weight":115,"urlFragment":181,"anchor":239,"singlePageAnchor":239,"docTitle":19,"url":240},"6.7. Creating a remediation Bash script for a later application","creating-a-remediation-bash-script-for-a-later-application_scanning-the-system-for-configuration-compliance-and-vulnerabilities","#creating-a-remediation-bash-script-for-a-later-application_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":242,"visible":15,"weight":120,"urlFragment":181,"anchor":243,"singlePageAnchor":243,"sections":244,"docTitle":19,"url":257},"6.8. Scanning the system with a customized profile using SCAP Workbench","scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities",[245,249,253],{"title":246,"visible":15,"weight":16,"urlFragment":181,"anchor":247,"singlePageAnchor":247,"docTitle":19,"url":248},"6.8.1. Using SCAP Workbench to scan and remediate the system","using-scap-workbench-to-scan-and-remediate-the-system_scanning-the-system-with-a-customized-profile-using-scap-workbench","#using-scap-workbench-to-scan-and-remediate-the-system_scanning-the-system-with-a-customized-profile-using-scap-workbench",{"title":250,"visible":15,"weight":23,"urlFragment":181,"anchor":251,"singlePageAnchor":251,"docTitle":19,"url":252},"6.8.2. Customizing a security profile with SCAP Workbench","customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench","#customizing-a-security-profile-with-scap-workbench_scanning-the-system-with-a-customized-profile-using-scap-workbench",{"title":254,"visible":15,"weight":28,"urlFragment":181,"anchor":255,"singlePageAnchor":255,"docTitle":19,"url":256},"6.8.3. Additional resources","related-information-scanning-the-system-with-a-customized-profile-using-scap-workbench","#related-information-scanning-the-system-with-a-customized-profile-using-scap-workbench","#scanning-the-system-with-a-customized-profile-using-scap-workbench_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":259,"visible":15,"weight":125,"urlFragment":181,"anchor":260,"singlePageAnchor":260,"sections":261,"docTitle":19,"url":274},"6.9. Deploying systems that are compliant with a security profile immediately after an installation","deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities",[262,266,270],{"title":263,"visible":15,"weight":16,"urlFragment":181,"anchor":264,"singlePageAnchor":264,"docTitle":19,"url":265},"6.9.1. Profiles not compatible with Server with GUI","ref_profiles-not-compatible-with-server-with-gui_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation","#ref_profiles-not-compatible-with-server-with-gui_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation",{"title":267,"visible":15,"weight":23,"urlFragment":181,"anchor":268,"singlePageAnchor":268,"docTitle":19,"url":269},"6.9.2. Deploying baseline-compliant RHEL systems using the graphical installation","deploying-baseline-compliant-rhel-systems-using-the-graphical-installation_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation","#deploying-baseline-compliant-rhel-systems-using-the-graphical-installation_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation",{"title":271,"visible":15,"weight":28,"urlFragment":181,"anchor":272,"singlePageAnchor":272,"docTitle":19,"url":273},"6.9.3. Deploying baseline-compliant RHEL systems using Kickstart","deploying-baseline-compliant-rhel-systems-using-kickstart_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation","#deploying-baseline-compliant-rhel-systems-using-kickstart_deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation","#deploying-systems-that-are-compliant-with-a-security-profile-immediately-after-an-installation_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":276,"visible":15,"weight":277,"urlFragment":181,"anchor":278,"singlePageAnchor":278,"docTitle":19,"url":279},"6.10. Scanning container and container images for vulnerabilities",10,"scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-configuration-compliance-and-vulnerabilities","#scanning-container-and-container-images-for-vulnerabilities_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":281,"visible":15,"weight":282,"urlFragment":181,"anchor":283,"singlePageAnchor":283,"docTitle":19,"url":284},"6.11. Assessing security compliance of a container or a container image with a specific baseline",11,"assessing-security-compliance-of-a-container-or-a-container-image-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities","#assessing-security-compliance-of-a-container-or-a-container-image-with-a-specific-baseline_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":286,"visible":15,"weight":287,"urlFragment":181,"anchor":288,"singlePageAnchor":288,"docTitle":19,"url":289},"6.12. SCAP Security Guide profiles supported in RHEL 9",12,"scap-security-guide-profiles-supported-in-rhel-9_scanning-the-system-for-configuration-compliance-and-vulnerabilities","#scap-security-guide-profiles-supported-in-rhel-9_scanning-the-system-for-configuration-compliance-and-vulnerabilities",{"title":291,"visible":15,"weight":292,"urlFragment":181,"anchor":293,"singlePageAnchor":293,"docTitle":19,"url":294},"6.13. Additional resources",13,"related-information-scanning-the-system-for-configuration-compliance-and-vulnerabilities","#related-information-scanning-the-system-for-configuration-compliance-and-vulnerabilities","#scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening",{"title":297,"visible":15,"weight":125,"urlFragment":298,"anchor":18,"singlePageAnchor":298,"sections":299,"docTitle":19,"url":348},"7. Ensuring system integrity with Keylime","assembly_ensuring-system-integrity-with-keylime_security-hardening",[300,304,308,312,316,320,324,328,332,336,340,344],{"title":301,"visible":15,"weight":16,"urlFragment":298,"anchor":302,"singlePageAnchor":302,"docTitle":19,"url":303},"7.1. How Keylime works","con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime","#con_how-keylime-works_assembly_ensuring-system-integrity-with-keylime",{"title":305,"visible":15,"weight":23,"urlFragment":298,"anchor":306,"singlePageAnchor":306,"docTitle":19,"url":307},"7.2. Deploying Keylime verifier from a package","configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime","#configuring-keylime-verifier_assembly_ensuring-system-integrity-with-keylime",{"title":309,"visible":15,"weight":28,"urlFragment":298,"anchor":310,"singlePageAnchor":310,"docTitle":19,"url":311},"7.3. Deploying Keylime verifier as a container","configuring-keylime-verifier-as-a-container_assembly_ensuring-system-integrity-with-keylime","#configuring-keylime-verifier-as-a-container_assembly_ensuring-system-integrity-with-keylime",{"title":313,"visible":15,"weight":45,"urlFragment":298,"anchor":314,"singlePageAnchor":314,"docTitle":19,"url":315},"7.4. Deploying Keylime registrar from a package","configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime","#configuring-keylime-registrar_assembly_ensuring-system-integrity-with-keylime",{"title":317,"visible":15,"weight":50,"urlFragment":298,"anchor":318,"singlePageAnchor":318,"docTitle":19,"url":319},"7.5. Deploying Keylime registrar as a container","configuring-keylime-registrar-as-a-container_assembly_ensuring-system-integrity-with-keylime","#configuring-keylime-registrar-as-a-container_assembly_ensuring-system-integrity-with-keylime",{"title":321,"visible":15,"weight":105,"urlFragment":298,"anchor":322,"singlePageAnchor":322,"docTitle":19,"url":323},"7.6. Deploying a Keylime server by using RHEL system roles","proc_setting-keylime-server-using-system-roles_assembly_ensuring-system-integrity-with-keylime","#proc_setting-keylime-server-using-system-roles_assembly_ensuring-system-integrity-with-keylime",{"title":325,"visible":15,"weight":115,"urlFragment":298,"anchor":326,"singlePageAnchor":326,"docTitle":19,"url":327},"7.7. Variables for the keylime_server RHEL system role","ref_variables-for-keylime-server-system-role_assembly_ensuring-system-integrity-with-keylime","#ref_variables-for-keylime-server-system-role_assembly_ensuring-system-integrity-with-keylime",{"title":329,"visible":15,"weight":120,"urlFragment":298,"anchor":330,"singlePageAnchor":330,"docTitle":19,"url":331},"7.8. Deploying Keylime tenant from a package","configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime","#configuring-keylime-tenant_assembly_ensuring-system-integrity-with-keylime",{"title":333,"visible":15,"weight":125,"urlFragment":298,"anchor":334,"singlePageAnchor":334,"docTitle":19,"url":335},"7.9. Deploying Keylime agent from a package","configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime","#configuring-keylime-agent_assembly_ensuring-system-integrity-with-keylime",{"title":337,"visible":15,"weight":277,"urlFragment":298,"anchor":338,"singlePageAnchor":338,"docTitle":19,"url":339},"7.10. Configuring Keylime for runtime monitoring","proc_deploying-keylime-for-runtime-monitoring_assembly_ensuring-system-integrity-with-keylime","#proc_deploying-keylime-for-runtime-monitoring_assembly_ensuring-system-integrity-with-keylime",{"title":341,"visible":15,"weight":282,"urlFragment":298,"anchor":342,"singlePageAnchor":342,"docTitle":19,"url":343},"7.11. Configuring Keylime for measured boot attestation","proc_deploying-keylime-for-measured-boot-attestation_assembly_ensuring-system-integrity-with-keylime","#proc_deploying-keylime-for-measured-boot-attestation_assembly_ensuring-system-integrity-with-keylime",{"title":345,"visible":15,"weight":287,"urlFragment":298,"anchor":346,"singlePageAnchor":346,"docTitle":19,"url":347},"7.12. Keylime environment variables","keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime","#keylime-environment-variables_assembly_ensuring-system-integrity-with-keylime","#assembly_ensuring-system-integrity-with-keylime_security-hardening",{"title":350,"visible":15,"weight":277,"urlFragment":351,"anchor":18,"singlePageAnchor":351,"sections":352,"docTitle":19,"url":373},"8. Checking integrity with AIDE","checking-integrity-with-aide_security-hardening",[353,357,361,365,369],{"title":354,"visible":15,"weight":16,"urlFragment":351,"anchor":355,"singlePageAnchor":355,"docTitle":19,"url":356},"8.1. Installing AIDE","installing-aide_checking-integrity-with-aide","#installing-aide_checking-integrity-with-aide",{"title":358,"visible":15,"weight":23,"urlFragment":351,"anchor":359,"singlePageAnchor":359,"docTitle":19,"url":360},"8.2. Performing integrity checks with AIDE","performing-integrity-checks-with-aide_checking-integrity-with-aide","#performing-integrity-checks-with-aide_checking-integrity-with-aide",{"title":362,"visible":15,"weight":28,"urlFragment":351,"anchor":363,"singlePageAnchor":363,"docTitle":19,"url":364},"8.3. Updating an AIDE database","updating-an-aide-database_checking-integrity-with-aide","#updating-an-aide-database_checking-integrity-with-aide",{"title":366,"visible":15,"weight":45,"urlFragment":351,"anchor":367,"singlePageAnchor":367,"docTitle":19,"url":368},"8.4. File-integrity tools: AIDE and IMA","file-integrity-tools-aide-and-ima_checking-integrity-with-aide","#file-integrity-tools-aide-and-ima_checking-integrity-with-aide",{"title":370,"visible":15,"weight":50,"urlFragment":351,"anchor":371,"singlePageAnchor":371,"docTitle":19,"url":372},"8.5. Additional resources","related-information-checking-integrity-with-aide","#related-information-checking-integrity-with-aide","#checking-integrity-with-aide_security-hardening",{"title":375,"visible":15,"weight":282,"urlFragment":376,"anchor":18,"singlePageAnchor":376,"sections":377,"docTitle":19,"url":414},"9. Encrypting block devices using LUKS","encrypting-block-devices-using-luks_security-hardening",[378,382,386,390,394,398,402,406,410],{"title":379,"visible":15,"weight":16,"urlFragment":376,"anchor":380,"singlePageAnchor":380,"docTitle":19,"url":381},"9.1. LUKS disk encryption","luks-disk-encryption_encrypting-block-devices-using-luks","#luks-disk-encryption_encrypting-block-devices-using-luks",{"title":383,"visible":15,"weight":23,"urlFragment":376,"anchor":384,"singlePageAnchor":384,"docTitle":19,"url":385},"9.2. LUKS versions in RHEL","luks-versions-in-rhel_encrypting-block-devices-using-luks","#luks-versions-in-rhel_encrypting-block-devices-using-luks",{"title":387,"visible":15,"weight":28,"urlFragment":376,"anchor":388,"singlePageAnchor":388,"docTitle":19,"url":389},"9.3. Options for data protection during LUKS2 re-encryption","options-for-data-protection-during-luks2-re-encryption_encrypting-block-devices-using-luks","#options-for-data-protection-during-luks2-re-encryption_encrypting-block-devices-using-luks",{"title":391,"visible":15,"weight":45,"urlFragment":376,"anchor":392,"singlePageAnchor":392,"docTitle":19,"url":393},"9.4. Encrypting existing data on a block device using LUKS2","encrypting-existing-data-on-a-block-device-using-luks2_encrypting-block-devices-using-luks","#encrypting-existing-data-on-a-block-device-using-luks2_encrypting-block-devices-using-luks",{"title":395,"visible":15,"weight":50,"urlFragment":376,"anchor":396,"singlePageAnchor":396,"docTitle":19,"url":397},"9.5. Encrypting existing data on a block device using LUKS2 with a detached header","encrypting-existing-data-on-a-block-device-using-luks2-with-a-detached-header_encrypting-block-devices-using-luks","#encrypting-existing-data-on-a-block-device-using-luks2-with-a-detached-header_encrypting-block-devices-using-luks",{"title":399,"visible":15,"weight":105,"urlFragment":376,"anchor":400,"singlePageAnchor":400,"docTitle":19,"url":401},"9.6. Encrypting a blank block device using LUKS2","encrypting-a-blank-block-device-using-luks2_encrypting-block-devices-using-luks","#encrypting-a-blank-block-device-using-luks2_encrypting-block-devices-using-luks",{"title":403,"visible":15,"weight":115,"urlFragment":376,"anchor":404,"singlePageAnchor":404,"docTitle":19,"url":405},"9.7. Configuring the LUKS passphrase in the web console","configuring-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks","#configuring-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks",{"title":407,"visible":15,"weight":120,"urlFragment":376,"anchor":408,"singlePageAnchor":408,"docTitle":19,"url":409},"9.8. Changing the LUKS passphrase in the web console","changing-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks","#changing-the-luks-passphrase-in-the-web-console_encrypting-block-devices-using-luks",{"title":411,"visible":15,"weight":125,"urlFragment":376,"anchor":412,"singlePageAnchor":412,"docTitle":19,"url":413},"9.9. Creating a LUKS2 encrypted volume by using the storage RHEL system role","creating-a-luks2-encrypted-volume-using-the-storage-role_encrypting-block-devices-using-luks","#creating-a-luks2-encrypted-volume-using-the-storage-role_encrypting-block-devices-using-luks","#encrypting-block-devices-using-luks_security-hardening",{"title":416,"visible":15,"weight":287,"urlFragment":417,"anchor":18,"singlePageAnchor":417,"sections":418,"docTitle":19,"url":499},"10. Configuring automated unlocking of encrypted volumes by using policy-based decryption","configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening",[419,423,427,431,435,439,443,447,451,455,459,463,467,471,476,481],{"title":420,"visible":15,"weight":16,"urlFragment":417,"anchor":421,"singlePageAnchor":421,"docTitle":19,"url":422},"10.1. Network-bound disk encryption","network-bound-disk-encryption_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#network-bound-disk-encryption_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":424,"visible":15,"weight":23,"urlFragment":417,"anchor":425,"singlePageAnchor":425,"docTitle":19,"url":426},"10.2. Deploying a Tang server with SELinux in enforcing mode","deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#deploying-a-tang-server-with-selinux-in-enforcing-mode_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":428,"visible":15,"weight":28,"urlFragment":417,"anchor":429,"singlePageAnchor":429,"docTitle":19,"url":430},"10.3. Rotating Tang server keys and updating bindings on clients","rotating-tang-keys_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#rotating-tang-keys_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":432,"visible":15,"weight":45,"urlFragment":417,"anchor":433,"singlePageAnchor":433,"docTitle":19,"url":434},"10.4. Configuring automated unlocking by using a Tang key in the web console","configuring-automated-unlocking-using-a-tang-key-in-the-web-console_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#configuring-automated-unlocking-using-a-tang-key-in-the-web-console_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":436,"visible":15,"weight":50,"urlFragment":417,"anchor":437,"singlePageAnchor":437,"docTitle":19,"url":438},"10.5. Basic NBDE and TPM2 encryption-client operations","basic-nbde-and-tpm2-encryption-client-operations_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#basic-nbde-and-tpm2-encryption-client-operations_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":440,"visible":15,"weight":105,"urlFragment":417,"anchor":441,"singlePageAnchor":441,"docTitle":19,"url":442},"10.6. Configuring NBDE clients for automated unlocking of LUKS-encrypted volumes","configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#configuring-manual-enrollment-of-volumes-using-clevis_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":444,"visible":15,"weight":115,"urlFragment":417,"anchor":445,"singlePageAnchor":445,"docTitle":19,"url":446},"10.7. Configuring NBDE clients with static IP configuration","configuring-nbde-clients-with-static-ip-configuration_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#configuring-nbde-clients-with-static-ip-configuration_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":448,"visible":15,"weight":120,"urlFragment":417,"anchor":449,"singlePageAnchor":449,"docTitle":19,"url":450},"10.8. Configuring manual enrollment of LUKS-encrypted volumes by using a TPM 2.0 policy","configuring-manual-enrollment-of-volumes-using-tpm2_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#configuring-manual-enrollment-of-volumes-using-tpm2_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":452,"visible":15,"weight":125,"urlFragment":417,"anchor":453,"singlePageAnchor":453,"docTitle":19,"url":454},"10.9. Removing a Clevis pin from a LUKS-encrypted volume manually","removing-a-clevis-pin-from-a-luks-encrypted-volume-manually_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#removing-a-clevis-pin-from-a-luks-encrypted-volume-manually_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":456,"visible":15,"weight":277,"urlFragment":417,"anchor":457,"singlePageAnchor":457,"docTitle":19,"url":458},"10.10. Configuring automated enrollment of LUKS-encrypted volumes by using Kickstart","configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#configuring-automated-enrollment-of-luks-encrypted-volumes-using-kickstart_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":460,"visible":15,"weight":282,"urlFragment":417,"anchor":461,"singlePageAnchor":461,"docTitle":19,"url":462},"10.11. Configuring automated unlocking of a LUKS-encrypted removable storage device","configuring-automated-unlocking-of-a-luks-encrypted-removable-storage-device_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#configuring-automated-unlocking-of-a-luks-encrypted-removable-storage-device_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":464,"visible":15,"weight":287,"urlFragment":417,"anchor":465,"singlePageAnchor":465,"docTitle":19,"url":466},"10.12. Deploying high-availability NBDE systems","deploying-high-availability-nbde-systems_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#deploying-high-availability-nbde-systems_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":468,"visible":15,"weight":292,"urlFragment":417,"anchor":469,"singlePageAnchor":469,"docTitle":19,"url":470},"10.13. Deployment of virtual machines in a NBDE network","deployment-of-virtual-machines-in-a-nbde-network_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#deployment-of-virtual-machines-in-a-nbde-network_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":472,"visible":15,"weight":473,"urlFragment":417,"anchor":474,"singlePageAnchor":474,"docTitle":19,"url":475},"10.14. Building automatically-enrollable VM images for cloud environments by using NBDE",14,"building-automatically-enrollable-vm-images-for-cloud-environments_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#building-automatically-enrollable-vm-images-for-cloud-environments_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":477,"visible":15,"weight":478,"urlFragment":417,"anchor":479,"singlePageAnchor":479,"docTitle":19,"url":480},"10.15. Deploying Tang as a container",15,"proc_deploying-tang-as-a-container_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#proc_deploying-tang-as-a-container_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",{"title":482,"visible":15,"weight":483,"urlFragment":417,"anchor":484,"singlePageAnchor":484,"sections":485,"docTitle":19,"url":498},"10.16. Configuring NBDE by using RHEL system roles",16,"configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption",[486,490,494],{"title":487,"visible":15,"weight":16,"urlFragment":417,"anchor":488,"singlePageAnchor":488,"docTitle":19,"url":489},"10.16.1. Using the nbde_server RHEL system role for setting up multiple Tang servers","using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles","#using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles",{"title":491,"visible":15,"weight":23,"urlFragment":417,"anchor":492,"singlePageAnchor":492,"docTitle":19,"url":493},"10.16.2. Setting up Clevis clients with DHCP by using the nbde_client RHEL system role","using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles","#using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles",{"title":495,"visible":15,"weight":28,"urlFragment":417,"anchor":496,"singlePageAnchor":496,"docTitle":19,"url":497},"10.16.3. Setting up static-IP Clevis clients by using the nbde_client RHEL system role","setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles","#setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles","#configuring-nbde-by-using-rhel-system-roles_configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption","#configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening",{"title":501,"visible":15,"weight":292,"urlFragment":502,"anchor":18,"singlePageAnchor":502,"sections":503,"docTitle":19,"url":556},"11. Auditing the system","auditing-the-system_security-hardening",[504,508,512,516,520,524,528,532,536,540,544,548,552],{"title":505,"visible":15,"weight":16,"urlFragment":502,"anchor":506,"singlePageAnchor":506,"docTitle":19,"url":507},"11.1. Linux Audit","linux-audit_auditing-the-system","#linux-audit_auditing-the-system",{"title":509,"visible":15,"weight":23,"urlFragment":502,"anchor":510,"singlePageAnchor":510,"docTitle":19,"url":511},"11.2. Audit system architecture","audit-system-architecture_auditing-the-system","#audit-system-architecture_auditing-the-system",{"title":513,"visible":15,"weight":28,"urlFragment":502,"anchor":514,"singlePageAnchor":514,"docTitle":19,"url":515},"11.3. Configuring auditd for a secure environment","configuring-auditd-for-a-secure-environment_auditing-the-system","#configuring-auditd-for-a-secure-environment_auditing-the-system",{"title":517,"visible":15,"weight":45,"urlFragment":502,"anchor":518,"singlePageAnchor":518,"docTitle":19,"url":519},"11.4. Starting and controlling auditd","starting-the-audit-service_auditing-the-system","#starting-the-audit-service_auditing-the-system",{"title":521,"visible":15,"weight":50,"urlFragment":502,"anchor":522,"singlePageAnchor":522,"docTitle":19,"url":523},"11.5. Understanding Audit log files","understanding-audit-log-files_auditing-the-system","#understanding-audit-log-files_auditing-the-system",{"title":525,"visible":15,"weight":105,"urlFragment":502,"anchor":526,"singlePageAnchor":526,"docTitle":19,"url":527},"11.6. Using auditctl for defining and executing Audit rules","using-auditctl-for-defining-and-executing-audit-rules_auditing-the-system","#using-auditctl-for-defining-and-executing-audit-rules_auditing-the-system",{"title":529,"visible":15,"weight":115,"urlFragment":502,"anchor":530,"singlePageAnchor":530,"docTitle":19,"url":531},"11.7. Defining persistent Audit rules","defining-persistent-audit-rules_auditing-the-system","#defining-persistent-audit-rules_auditing-the-system",{"title":533,"visible":15,"weight":120,"urlFragment":502,"anchor":534,"singlePageAnchor":534,"docTitle":19,"url":535},"11.8. Pre-configured Audit rules files for compliance with standards","pre-configured-audit-rules-files-for-compliance-with-standards_auditing-the-system","#pre-configured-audit-rules-files-for-compliance-with-standards_auditing-the-system",{"title":537,"visible":15,"weight":125,"urlFragment":502,"anchor":538,"singlePageAnchor":538,"docTitle":19,"url":539},"11.9. Using augenrules to define persistent rules","using-augenrules-to-define-persistent-rules_auditing-the-system","#using-augenrules-to-define-persistent-rules_auditing-the-system",{"title":541,"visible":15,"weight":277,"urlFragment":502,"anchor":542,"singlePageAnchor":542,"docTitle":19,"url":543},"11.10. Disabling augenrules","disabling-augenrules_auditing-the-system","#disabling-augenrules_auditing-the-system",{"title":545,"visible":15,"weight":282,"urlFragment":502,"anchor":546,"singlePageAnchor":546,"docTitle":19,"url":547},"11.11. Setting up Audit to monitor software updates","proc_setting-up-audit-to-monitor-software-updates_auditing-the-system","#proc_setting-up-audit-to-monitor-software-updates_auditing-the-system",{"title":549,"visible":15,"weight":287,"urlFragment":502,"anchor":550,"singlePageAnchor":550,"docTitle":19,"url":551},"11.12. Monitoring user login times with Audit","proc_monitoring-user-login-times-with-audit_auditing-the-system","#proc_monitoring-user-login-times-with-audit_auditing-the-system",{"title":553,"visible":15,"weight":292,"urlFragment":502,"anchor":554,"singlePageAnchor":554,"docTitle":19,"url":555},"11.13. Additional resources","related-information-auditing-the-system","#related-information-auditing-the-system","#auditing-the-system_security-hardening",{"title":558,"visible":15,"weight":473,"urlFragment":559,"anchor":18,"singlePageAnchor":559,"sections":560,"docTitle":19,"url":593},"12. Blocking and allowing applications by using fapolicyd","assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening",[561,565,569,573,577,581,585,589],{"title":562,"visible":15,"weight":16,"urlFragment":559,"anchor":563,"singlePageAnchor":563,"docTitle":19,"url":564},"12.1. Introduction to fapolicyd","introduction-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd","#introduction-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd",{"title":566,"visible":15,"weight":23,"urlFragment":559,"anchor":567,"singlePageAnchor":567,"docTitle":19,"url":568},"12.2. Deploying fapolicyd","proc_deploying-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd","#proc_deploying-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd",{"title":570,"visible":15,"weight":28,"urlFragment":559,"anchor":571,"singlePageAnchor":571,"docTitle":19,"url":572},"12.3. Marking files as trusted using an additional source of trust","marking-files-as-trusted-using-an-additional-source-of-trust_assembly_blocking-and-allowing-applications-using-fapolicyd","#marking-files-as-trusted-using-an-additional-source-of-trust_assembly_blocking-and-allowing-applications-using-fapolicyd",{"title":574,"visible":15,"weight":45,"urlFragment":559,"anchor":575,"singlePageAnchor":575,"docTitle":19,"url":576},"12.4. Adding custom allow and deny rules for fapolicyd","proc_adding-custom-allow-and-deny-rules-for-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd","#proc_adding-custom-allow-and-deny-rules-for-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd",{"title":578,"visible":15,"weight":50,"urlFragment":559,"anchor":579,"singlePageAnchor":579,"docTitle":19,"url":580},"12.5. Enabling fapolicyd integrity checks","proc_enabling-fapolicyd-integrity-checks_assembly_blocking-and-allowing-applications-using-fapolicyd","#proc_enabling-fapolicyd-integrity-checks_assembly_blocking-and-allowing-applications-using-fapolicyd",{"title":582,"visible":15,"weight":105,"urlFragment":559,"anchor":583,"singlePageAnchor":583,"docTitle":19,"url":584},"12.6. Troubleshooting problems related to fapolicyd","ref_troubleshooting-problems-related-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd","#ref_troubleshooting-problems-related-to-fapolicyd_assembly_blocking-and-allowing-applications-using-fapolicyd",{"title":586,"visible":15,"weight":115,"urlFragment":559,"anchor":587,"singlePageAnchor":587,"docTitle":19,"url":588},"12.7. Preventing users from executing untrustworthy code by using the fapolicyd RHEL system role","preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_assembly_blocking-and-allowing-applications-using-fapolicyd","#preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_assembly_blocking-and-allowing-applications-using-fapolicyd",{"title":590,"visible":15,"weight":120,"urlFragment":559,"anchor":591,"singlePageAnchor":591,"docTitle":19,"url":592},"12.8. Additional resources","additional_resources_2","#additional_resources_2","#assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening",{"title":595,"visible":15,"weight":478,"urlFragment":596,"anchor":18,"singlePageAnchor":596,"sections":597,"docTitle":19,"url":634},"13. Protecting systems against intrusive USB devices","protecting-systems-against-intrusive-usb-devices_security-hardening",[598,602,606,610,614,618,622,626,630],{"title":599,"visible":15,"weight":16,"urlFragment":596,"anchor":600,"singlePageAnchor":600,"docTitle":19,"url":601},"13.1. USBGuard","usbguard_protecting-systems-against-intrusive-usb-devices","#usbguard_protecting-systems-against-intrusive-usb-devices",{"title":603,"visible":15,"weight":23,"urlFragment":596,"anchor":604,"singlePageAnchor":604,"docTitle":19,"url":605},"13.2. Installing USBGuard","installing-usbguard_protecting-systems-against-intrusive-usb-devices","#installing-usbguard_protecting-systems-against-intrusive-usb-devices",{"title":607,"visible":15,"weight":28,"urlFragment":596,"anchor":608,"singlePageAnchor":608,"docTitle":19,"url":609},"13.3. Blocking and authorizing a USB device by using CLI","blocking-and-authorizing-a-usb-device-using-cli_protecting-systems-against-intrusive-usb-devices","#blocking-and-authorizing-a-usb-device-using-cli_protecting-systems-against-intrusive-usb-devices",{"title":611,"visible":15,"weight":45,"urlFragment":596,"anchor":612,"singlePageAnchor":612,"docTitle":19,"url":613},"13.4. Permanently blocking and authorizing a USB device","permanently-blocking-and-authorizing-a-usb-device_protecting-systems-against-intrusive-usb-devices","#permanently-blocking-and-authorizing-a-usb-device_protecting-systems-against-intrusive-usb-devices",{"title":615,"visible":15,"weight":50,"urlFragment":596,"anchor":616,"singlePageAnchor":616,"docTitle":19,"url":617},"13.5. Creating a custom policy for USB devices","creating-a-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices","#creating-a-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices",{"title":619,"visible":15,"weight":105,"urlFragment":596,"anchor":620,"singlePageAnchor":620,"docTitle":19,"url":621},"13.6. Creating a structured custom policy for USB devices","creating-a-structured-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices","#creating-a-structured-custom-policy-for-usb-devices_protecting-systems-against-intrusive-usb-devices",{"title":623,"visible":15,"weight":115,"urlFragment":596,"anchor":624,"singlePageAnchor":624,"docTitle":19,"url":625},"13.7. Authorizing users and groups to use the USBGuard IPC interface","authorizing-users-and-groups-to-use-the-usbguard-ipc-interface_protecting-systems-against-intrusive-usb-devices","#authorizing-users-and-groups-to-use-the-usbguard-ipc-interface_protecting-systems-against-intrusive-usb-devices",{"title":627,"visible":15,"weight":120,"urlFragment":596,"anchor":628,"singlePageAnchor":628,"docTitle":19,"url":629},"13.8. Logging USBguard authorization events to the Linux Audit log","logging-usbguard-authorization-events-to-the-linux-audit-log_protecting-systems-against-intrusive-usb-devices","#logging-usbguard-authorization-events-to-the-linux-audit-log_protecting-systems-against-intrusive-usb-devices",{"title":631,"visible":15,"weight":125,"urlFragment":596,"anchor":632,"singlePageAnchor":632,"docTitle":19,"url":633},"13.9. Additional resources","additional_resources_3","#additional_resources_3","#protecting-systems-against-intrusive-usb-devices_security-hardening",{"title":636,"visible":15,"weight":483,"urlFragment":637,"anchor":18,"singlePageAnchor":637,"sections":638,"docTitle":19,"url":687},"14. Configuring a remote logging solution","assembly_configuring-a-remote-logging-solution_security-hardening",[639,643,647,651,655,659,663,667,671,675,679,683],{"title":640,"visible":15,"weight":16,"urlFragment":637,"anchor":641,"singlePageAnchor":641,"docTitle":19,"url":642},"14.1. The Rsyslog logging service","the-rsyslog-logging-service_assembly_configuring-a-remote-logging-solution","#the-rsyslog-logging-service_assembly_configuring-a-remote-logging-solution",{"title":644,"visible":15,"weight":23,"urlFragment":637,"anchor":645,"singlePageAnchor":645,"docTitle":19,"url":646},"14.2. Installing Rsyslog documentation","installing-rsyslog-documentation_assembly_configuring-a-remote-logging-solution","#installing-rsyslog-documentation_assembly_configuring-a-remote-logging-solution",{"title":648,"visible":15,"weight":28,"urlFragment":637,"anchor":649,"singlePageAnchor":649,"docTitle":19,"url":650},"14.3. Configuring a server for remote logging over TCP","configuring-a-server-for-remote-logging-over-tcp_assembly_configuring-a-remote-logging-solution","#configuring-a-server-for-remote-logging-over-tcp_assembly_configuring-a-remote-logging-solution",{"title":652,"visible":15,"weight":45,"urlFragment":637,"anchor":653,"singlePageAnchor":653,"docTitle":19,"url":654},"14.4. Configuring remote logging to a server over TCP","configuring-remote-logging-to-a-server-over-tcp_assembly_configuring-a-remote-logging-solution","#configuring-remote-logging-to-a-server-over-tcp_assembly_configuring-a-remote-logging-solution",{"title":656,"visible":15,"weight":50,"urlFragment":637,"anchor":657,"singlePageAnchor":657,"docTitle":19,"url":658},"14.5. Configuring TLS-encrypted remote logging","proc_configuring-tls-encrypted-remote-logging_assembly_configuring-a-remote-logging-solution","#proc_configuring-tls-encrypted-remote-logging_assembly_configuring-a-remote-logging-solution",{"title":660,"visible":15,"weight":105,"urlFragment":637,"anchor":661,"singlePageAnchor":661,"docTitle":19,"url":662},"14.6. Configuring a server for receiving remote logging information over UDP","configuring-a-server-for-receiving-remote-logging-information-over-udp_assembly_configuring-a-remote-logging-solution","#configuring-a-server-for-receiving-remote-logging-information-over-udp_assembly_configuring-a-remote-logging-solution",{"title":664,"visible":15,"weight":115,"urlFragment":637,"anchor":665,"singlePageAnchor":665,"docTitle":19,"url":666},"14.7. Configuring remote logging to a server over UDP","configuring-remote-logging-to-a-server-over-udp_assembly_configuring-a-remote-logging-solution","#configuring-remote-logging-to-a-server-over-udp_assembly_configuring-a-remote-logging-solution",{"title":668,"visible":15,"weight":120,"urlFragment":637,"anchor":669,"singlePageAnchor":669,"docTitle":19,"url":670},"14.8. Load balancing helper in Rsyslog","con_load-balancing-helper-in-rsyslog_assembly_configuring-a-remote-logging-solution","#con_load-balancing-helper-in-rsyslog_assembly_configuring-a-remote-logging-solution",{"title":672,"visible":15,"weight":125,"urlFragment":637,"anchor":673,"singlePageAnchor":673,"docTitle":19,"url":674},"14.9. Configuring reliable remote logging","configuring-reliable-remote-logging_assembly_configuring-a-remote-logging-solution","#configuring-reliable-remote-logging_assembly_configuring-a-remote-logging-solution",{"title":676,"visible":15,"weight":277,"urlFragment":637,"anchor":677,"singlePageAnchor":677,"docTitle":19,"url":678},"14.10. Supported Rsyslog modules","supported-rsyslog-modules_assembly_configuring-a-remote-logging-solution","#supported-rsyslog-modules_assembly_configuring-a-remote-logging-solution",{"title":680,"visible":15,"weight":282,"urlFragment":637,"anchor":681,"singlePageAnchor":681,"docTitle":19,"url":682},"14.11. Configuring the netconsole service to log kernel messages to a remote host","configuring-the-netconsole-service-to-log-kernel-messages-to-a-remote-host_assembly_configuring-a-remote-logging-solution","#configuring-the-netconsole-service-to-log-kernel-messages-to-a-remote-host_assembly_configuring-a-remote-logging-solution",{"title":684,"visible":15,"weight":287,"urlFragment":637,"anchor":685,"singlePageAnchor":685,"docTitle":19,"url":686},"14.12. Additional resources","additional_resources_4","#additional_resources_4","#assembly_configuring-a-remote-logging-solution_security-hardening",{"title":689,"visible":15,"weight":690,"urlFragment":691,"anchor":18,"singlePageAnchor":691,"sections":692,"docTitle":19,"url":731},"15. Using the logging system role",17,"assembly_using-the-logging-system-role_security-hardening",[693,697,701,714,727],{"title":694,"visible":15,"weight":16,"urlFragment":691,"anchor":695,"singlePageAnchor":695,"docTitle":19,"url":696},"15.1. Filtering local log messages by using the logging RHEL system role","proc_filtering-logs-in-a-local-logging-system-role_assembly_using-the-logging-system-role","#proc_filtering-logs-in-a-local-logging-system-role_assembly_using-the-logging-system-role",{"title":698,"visible":15,"weight":23,"urlFragment":691,"anchor":699,"singlePageAnchor":699,"docTitle":19,"url":700},"15.2. Applying a remote logging solution by using the logging RHEL system role","applying-a-remote-logging-solution-using-the-logging-system-role_assembly_using-the-logging-system-role","#applying-a-remote-logging-solution-using-the-logging-system-role_assembly_using-the-logging-system-role",{"title":702,"visible":15,"weight":28,"urlFragment":691,"anchor":703,"singlePageAnchor":703,"sections":704,"docTitle":19,"url":713},"15.3. Using the logging RHEL system role with TLS","assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role",[705,709],{"title":706,"visible":15,"weight":16,"urlFragment":691,"anchor":707,"singlePageAnchor":707,"docTitle":19,"url":708},"15.3.1. Configuring client logging with TLS","configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls","#configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls",{"title":710,"visible":15,"weight":23,"urlFragment":691,"anchor":711,"singlePageAnchor":711,"docTitle":19,"url":712},"15.3.2. Configuring server logging with TLS","configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls","#configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls","#assembly_using-the-logging-system-role-with-tls_assembly_using-the-logging-system-role",{"title":715,"visible":15,"weight":45,"urlFragment":691,"anchor":716,"singlePageAnchor":716,"sections":717,"docTitle":19,"url":726},"15.4. Using the logging RHEL system roles with RELP","assembly_using-the-logging-system-roles-with-relp",[718,722],{"title":719,"visible":15,"weight":16,"urlFragment":691,"anchor":720,"singlePageAnchor":720,"docTitle":19,"url":721},"15.4.1. Configuring client logging with RELP","configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp","#configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp",{"title":723,"visible":15,"weight":23,"urlFragment":691,"anchor":724,"singlePageAnchor":724,"docTitle":19,"url":725},"15.4.2. Configuring server logging with RELP","configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp","#configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp","#assembly_using-the-logging-system-roles-with-relp",{"title":728,"visible":15,"weight":50,"urlFragment":691,"anchor":729,"singlePageAnchor":729,"docTitle":19,"url":730},"15.5. Additional resources","additional_resources_5","#additional_resources_5","#assembly_using-the-logging-system-role_security-hardening",{"title":733,"visible":15,"weight":734,"urlFragment":735,"anchor":18,"singlePageAnchor":736,"docTitle":19,"url":737},"Legal Notice",18,"legal-notice","idm140081355003760","#idm140081355003760",[739,742,745],{"text":740,"link":741},"Red Hat Enterprise Linux","/documentation/red_hat_enterprise_linux/",{"text":743,"link":744},"9","/documentation/red_hat_enterprise_linux/9/",{"text":11},{"name":11,"translations":747,"productVersion":748,"singlePage":749,"pdf":752,"publishingStatus":754},[5,6,7,8,9],{"name":743},{"contentUrl":750,"name":11,"new":751,"url":19},"https://d2bhdhkti9t3uj.cloudfront.net/html/0453483a-782b-4041-9a50-e3b3212ef31c/881948f1d72c9d45d52618a840416b42.html","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/security_hardening/index",{"url":753},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/pdf/security_hardening/Red_Hat_Enterprise_Linux-9-Security_hardening-en-US.pdf","PUBLISHED",[756,761,764,768,772,776,780],{"name":757,"new":758,"url":759,"urlAliases":760},"10.0-Beta","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10-beta","10-beta",[],{"name":743,"new":762,"url":743,"urlAliases":763},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9",[],{"name":765,"new":766,"url":765,"urlAliases":767},"8","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8",[],{"name":769,"new":770,"url":769,"urlAliases":771},"7","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7",[],{"name":773,"new":774,"url":773,"urlAliases":775},"6","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/6",[],{"name":777,"new":778,"url":777,"urlAliases":779},"5","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/5",[],{"name":781,"new":782,"url":781,"urlAliases":783},"4","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/4",[],{"security_hardening/index":785,"security_hardening/proc_providing-feedback-on-red-hat-documentation_security-hardening":786,"security_hardening/assembly_securing-rhel-during-installation-security-hardening":787,"security_hardening/switching-rhel-to-fips-mode_security-hardening":788,"security_hardening/using-the-system-wide-cryptographic-policies_security-hardening":789,"security_hardening/configuring-applications-to-use-cryptographic-hardware-through-pkcs-11_security-hardening":790,"security_hardening/assembly_controlling-access-to-smart-cards-using-polkit_security-hardening":791,"security_hardening/scanning-the-system-for-configuration-compliance-and-vulnerabilities_security-hardening":792,"security_hardening/assembly_ensuring-system-integrity-with-keylime_security-hardening":793,"security_hardening/checking-integrity-with-aide_security-hardening":794,"security_hardening/encrypting-block-devices-using-luks_security-hardening":795,"security_hardening/configuring-automated-unlocking-of-encrypted-volumes-using-policy-based-decryption_security-hardening":796,"security_hardening/auditing-the-system_security-hardening":797,"security_hardening/assembly_blocking-and-allowing-applications-using-fapolicyd_security-hardening":798,"security_hardening/protecting-systems-against-intrusive-usb-devices_security-hardening":799,"security_hardening/assembly_configuring-a-remote-logging-solution_security-hardening":800,"security_hardening/assembly_using-the-logging-system-role_security-hardening":801,"security_hardening/legal-notice":802},{"prevt":18,"next":24},{"prevt":17,"next":29},{"prevt":18,"next":29},{"prevt":18,"next":56},{"prevt":18,"next":18},{"prevt":18,"next":131},{"prevt":18,"next":160},{"prevt":18,"next":181},{"prevt":18,"next":298},{"prevt":18,"next":351},{"prevt":18,"next":376},{"prevt":18,"next":417},{"prevt":18,"next":502},{"prevt":18,"next":559},{"prevt":18,"next":596},{"prevt":18,"next":637},{"prevt":18,"next":691},{"prevt":691,"next":18},{"product":18,"version":18},{"security_hardening":805},[751],{"products":807},[808,809,810,811,812,813,814,815,816,817,818,819,820],"builds_for_red_hat_openshift","migration_toolkit_for_virtualization","openshift_container_platform","openshift_sandboxed_containers","red_hat_advanced_cluster_security_for_kubernetes","red_hat_advanced_cluster_management_for_kubernetes","red_hat_openshift_data_foundation","red_hat_openshift_dev_spaces","red_hat_openshift_gitops","red_hat_openshift_local","red_hat_openshift_pipelines","red_hat_openshift_serverless","workload_availability_for_red_hat_openshift",[],{"default":823},[824,833,839,848,856,864,871,879,886],{"nid":825,"type":826,"langcode":827,"Published":16,"title":828,"Created":829,"Updated":830,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":831,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":832},580,"rebrand banner","en","OpenShift Container Storage is now OpenShift Data Foundation starting with version 4.9.","2023-01-11 15:38:32","2023-01-11 15:40:04","/documentation/red_hat_openshift_container_storage\r\n/documentation/red_hat_openshift_container_storage/\r\n/documentation/red_hat_openshift_container_storage/*","internal:/documentation/red_hat_openshift_data_foundation/",{"nid":834,"type":826,"langcode":827,"Published":16,"title":828,"Created":835,"Updated":836,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":837,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":838},581,"2023-01-11 15:41:31","2023-01-11 15:42:04","/documentation/red_hat_openshift_data_foundation/4.9\r\n/documentation/red_hat_openshift_data_foundation/4.9/\r\n/documentation/red_hat_openshift_data_foundation/4.9/*\r\n/documentation/red_hat_openshift_data_foundation/4.10\r\n/documentation/red_hat_openshift_data_foundation/4.10/\r\n/documentation/red_hat_openshift_data_foundation/4.10/*\r\n/documentation/red_hat_openshift_data_foundation/4.11\r\n/documentation/red_hat_openshift_data_foundation/4.11/\r\n/documentation/red_hat_openshift_data_foundation/4.11/*","internal:/documentation/red_hat_openshift_container_storage/",{"nid":840,"type":841,"langcode":827,"Published":16,"title":842,"Created":843,"Updated":844,"body_value":18,"field_documentation banner_text_value":845,"field_documentation banner_text_format":846,"field_paths_value":847,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},582,"developer preview banner","MicroShift is Developer Preview software only","2023-01-11 15:50:24","2023-01-30 19:00:52","\u003Cp slot=header>MicroShift is Developer Preview software only.\u003C/p>For more information about the support scope of Red Hat Developer Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/devpreview/\">Developer Preview Support Scope\u003C/a>.","documentation banner","/documentation/microshift/4.12\r\n/documentation/microshift/4.12/*\r\n/documentation/red_hat_build_of_microshift/4.12\r\n/documentation/red_hat_build_of_microshift/4.12/*",{"nid":849,"type":850,"langcode":827,"Published":16,"title":851,"Created":852,"Updated":853,"body_value":18,"field_documentation banner_text_value":854,"field_documentation banner_text_format":846,"field_paths_value":855,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},583,"obsolete documentation banner","RHACS EOL - DAT-3433","2023-01-23 16:36:43","2023-01-23 16:39:14","\u003Cp slot=header>You are viewing documentation for a release that is no longer maintained. To view the documentation for the most recent version, see the \u003Ca href=\"/documentation/red_hat_advanced_cluster_security_for_kubernetes/\">latest RHACS docs\u003C/a>.\u003C/p>","/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71/*",{"nid":857,"type":858,"langcode":827,"Published":16,"title":859,"Created":860,"Updated":861,"body_value":18,"field_documentation banner_text_value":862,"field_documentation banner_text_format":846,"field_paths_value":863,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},584,"end of life banner","EOL banner for RHV","2023-05-23 14:58:05","2023-05-24 15:19:42","\u003Cp slot=header>The Red Hat Virtualization\u003C/p>Maintenance Phase runs until August 31, 2024, followed by the Extended Life Phase with no more software fixes through August 31, 2026. See \u003Ca href=\"https://access.redhat.com/articles/6975303\">Migration Paths for OpenShift Container Platform deployed on Red Hat Virtualization\u003C/a> for details.","/documentation/red_hat_virtualization/4.4",{"nid":865,"type":858,"langcode":827,"Published":16,"title":866,"Created":867,"Updated":868,"body_value":18,"field_documentation banner_text_value":869,"field_documentation banner_text_format":846,"field_paths_value":870,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},585,"RHHI-V EOL","2023-06-01 16:52:57","2023-06-01 17:03:44","\u003Cp slot=header>Red Hat Hyperconverged Infrastructure for Virtualization\u003C/p> is in the \u003Ca href=\"https://access.redhat.com/support/policy/updates/rhhiv\">Maintenance Support Phase\u003C/a> of its lifecycle until October 31, 2024. After that date, the product will be End of Life. See the \u003Ca href=\"https://access.redhat.com/announcements/6972521\">RHHI-V announcement\u003C/a> for next steps.","/documentation/red_hat_hyperconverged_infrastructure_for_virtualization/1.8",{"nid":872,"type":873,"langcode":827,"Published":16,"title":874,"Created":875,"Updated":876,"body_value":18,"field_documentation banner_text_value":877,"field_documentation banner_text_format":846,"field_paths_value":878,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},586,"preview banner","MicroShift is Technology Preview software only","2024-03-18 16:53:05","2024-03-18 16:54:56","\u003Cp slot=header>MicroShift is Technology Preview software only.\u003C/p>For more information about the support scope of Red Hat Technology Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/techpreview/\">Technology Preview Support Scope\u003C/a>.","/documentation/red_hat_build_of_microshift/4.13\r\n/documentation/red_hat_build_of_microshift/4.13/*",{"nid":880,"type":873,"langcode":827,"Published":16,"title":881,"Created":882,"Updated":883,"body_value":18,"field_documentation banner_text_value":884,"field_documentation banner_text_format":846,"field_paths_value":885,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},588,"Ansible 2.5 upgrade limitation","2024-09-30 16:53:05","2024-10-28 16:54:56","\u003Cp slot=\"header\">Support added for upgrades from 2.4\u003C/p>Ansible Automation Platform 2.5-3, released on October 28, 2024, adds support for upgrades from 2.4. See the upgrade documentation for more information.","",{"nid":887,"alertType":888,"type":889,"langcode":827,"Published":16,"title":890,"Created":885,"Updated":885,"body_value":18,"field_documentation banner_text_value":891,"field_documentation banner_text_format":846,"field_paths_value":892,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},587,"warning","Warning banner","Red Hat build of Apache Camel K","\u003Cp slot=header>Red Hat Camel K is deprecated\u003C/p>Red Hat Camel K is deprecated and the End of Life date for this product is June 30, 2025. For help migrating to the current go-to solution, \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel\">Red Hat build of Apache Camel\u003C/a>, see the \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel_k/1.10.7/html/migration_guide_camel_k_to_camel_extensions_for_quarkus/index\">Migration Guide\u003C/a>.","/documentation/red_hat_build_of_apache_camel_k/*",{"product":740},["Reactive",895],{"$snuxt-i18n-meta":896,"$sisLoading":897,"$sisSinglePage":15,"$sisInFocusMode":897,"$smobileTocOpen":897,"$sisLargeTOC":897,"$scurrentChapter":17,"$scurrentSection":17,"$scurrentSubSection":885},{},false,["Set"],["ShallowReactive",900],{"s8LoCEfG4A":18,"rFVLKcOK8e":18,"uUstF4AIyn":18,"MdHNSZP4nR":18,"Pn02PlJOas":18},"/en/documentation/red_hat_enterprise_linux/9/html-single/security_hardening/index"]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{contentEnv:"",collectFeedback:true,i18n:{baseUrl:"",defaultLocale:"en",defaultDirection:"ltr",strategy:"prefix",lazy:false,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:false,differentDomains:false,trailingSlash:false,configLocales:[{code:"en",name:"English",iso:"en-US"},{code:"fr",name:"Français",iso:"fr-FR"},{code:"ko",name:"한국어",iso:"ko-KR"},{code:"ja",name:"日本語",iso:"ja-JP"},{code:"zh-cn",name:"中文 (中国)",iso:"zh-CN"},{code:"de",name:"Deutsch",iso:"de_DE"},{code:"it",name:"Italiano",iso:"it_IT"},{code:"pt-br",name:"Português",iso:"pt_BR"},{code:"es",name:"Español",iso:"es-ES"}],locales:{en:{domain:""},fr:{domain:""},ko:{domain:""},ja:{domain:""},"zh-cn":{domain:""},de:{domain:""},it:{domain:""},"pt-br":{domain:""},es:{domain:""}},detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",switchLocalePathLinkSSR:false,autoImportTranslationFunctions:false}}},app:{baseURL:"/",buildId:"5ff82c51-785e-4a7d-aca6-77d6692e8c7a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>
