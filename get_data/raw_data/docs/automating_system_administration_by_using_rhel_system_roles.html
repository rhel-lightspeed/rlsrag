<!DOCTYPE html><html  data-capo=""><head><script type="importmap">
  {
    "imports": {
      "@patternfly/elements/": "/scripts/v1/@patternfly/elements/",
      "@patternfly/pfe-clipboard/": "/scripts/v1/@patternfly/pfe-clipboard/",
      "@rhds/elements/": "/scripts/v1/@rhds/elements/elements/",
      "@cpelements/elements/": "/scripts/v1/@cpelements/elements/elements/"
    },
    "scopes": {
      "/": {
        "@floating-ui/core": "/scripts/v1/@floating-ui/core/dist/floating-ui.core.mjs",
        "@floating-ui/dom": "/scripts/v1/@floating-ui/dom/dist/floating-ui.dom.mjs",
        "@floating-ui/utils": "/scripts/v1/@floating-ui/utils/dist/floating-ui.utils.mjs",
        "@floating-ui/utils/dom": "/scripts/v1/@floating-ui/utils/dom/dist/floating-ui.utils.dom.mjs",
        "@lit/reactive-element": "/scripts/v1/@lit/reactive-element/reactive-element.js",
        "@lit/reactive-element/decorators/": "/scripts/v1/@lit/reactive-element/decorators/",
        "@patternfly/pfe-core": "/scripts/v1/@patternfly/pfe-core/core.js",
        "@patternfly/pfe-core/": "/scripts/v1/@patternfly/pfe-core/",
        "@rhds/tokens/media.js": "/scripts/v1/@rhds/tokens/js/media.js",
        "lit": "/scripts/v1/lit/index.js",
        "lit-element/lit-element.js": "/scripts/v1/lit-element/lit-element.js",
        "lit-html": "/scripts/v1/lit-html/lit-html.js",
        "lit-html/": "/scripts/v1/lit-html/",
        "lit/": "/scripts/v1/lit/",
        "tslib": "/scripts/v1/tslib/tslib.es6.mjs",
        "@cpelements/rh-table/dist/rh-table.js": "/scripts/v1/@cpelements/rh-table/dist/rh-table.js"
      }
    }
  }
</script><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Automating system administration by using RHEL system roles | Red Hat Product Documentation</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<script type="text/javascript" id="trustarc" src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
<script src="//www.redhat.com/dtm.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@400;500;700&family=Red+Hat+Text:wght@400;500;700&display=swap">
<link rel="stylesheet" href="/styles/rh-table--lightdom.min.css">
<style>.section .titlepage{gap:.75rem}.section .titlepage,div.edit{align-items:center;display:flex}div.edit{font-size:.9rem;margin-bottom:8px}div.edit>a{align-items:center;display:flex}.edit pf-icon{margin-right:4px}</style>
<style>#error[data-v-df31ff14]{align-items:center;display:flex;flex-direction:column;justify-content:center;min-height:80vh}h1[data-v-df31ff14]{font-size:calc(var(--rh-font-size-body-text-md, 1rem)*4);font-weight:700;margin-bottom:0}h1[data-v-df31ff14],h1 span[data-v-df31ff14]{line-height:var(--rh-line-height-heading,1.3)}h1 span[data-v-df31ff14]{color:var(--rh-color-text-brand-on-light,#e00);display:block;text-transform:uppercase}h1 span[data-v-df31ff14],p[data-v-df31ff14]{font-size:var(--rh-font-size-body-text-lg,1.125rem)}aside[data-v-df31ff14]{align-items:center;background:var(--rh-color-surface-lightest,#fff);border:var(--rh-border-width-sm,1px) solid var(--rh-color-border-subtle-on-light,#c7c7c7);border-radius:var(--rh-border-radius-default,3px);border-top:calc(var(--rh-border-width-md, 2px)*2) solid var(--rh-color-text-brand-on-light,#e00);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2));display:flex;flex-direction:column;justify-content:space-between;margin-top:var(--rh-space-2xl,32px);padding:var(--rh-space-xl,24px)}aside[data-v-df31ff14],aside>div[data-v-df31ff14]{width:100%}.text-container[data-v-df31ff14]{margin:auto;max-width:442px;text-align:center}.desktop[data-v-df31ff14]{display:none}.sr-only[data-v-df31ff14]{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;clip-path:inset(50%);white-space:nowrap}form[data-v-df31ff14]{display:flex}button[data-v-df31ff14],input[data-v-df31ff14]{border:1px solid var(--rh-color-black-500,#8a8d90);box-sizing:border-box;height:40px}input[data-v-df31ff14]{border-right:none;flex:1;font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);padding-left:var(--rh-space-md,8px);width:100%}button[data-v-df31ff14]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border-left:none;display:flex;width:var(--rh-size-icon-04,40px)}button[data-v-df31ff14]:before{background:var(--rh-context-light-color-text-link,#06c);content:"";cursor:pointer;display:block;height:28px;margin:auto;width:28px}.search-icon[data-v-df31ff14]{margin:auto}ul[data-v-df31ff14]{max-width:275px;padding:0}ul li[data-v-df31ff14]{display:inline-block;list-style:none;margin-right:var(--rh-space-xl,24px);padding:var(--rh-space-xs,4px) 0}ul li a[data-v-df31ff14]{color:var(--rh-context-light-color-text-link,#06c);text-decoration:none}@media (min-width:992px){aside[data-v-df31ff14]{flex-direction:row}.mobile[data-v-df31ff14]{display:none}.desktop[data-v-df31ff14]{display:block}input[data-v-df31ff14]{width:auto}}</style>
<style>@keyframes fade-in{0%{opacity:0;visibility:hidden}1%{visibility:visible}to{opacity:1;visibility:visible}}@media (min-height:48em){.rhdocs{--rh-table--maxHeight:calc(100vh - 12.5rem)}}*,.rhdocs *,.rhdocs :after,.rhdocs :before,:after,:before{box-sizing:border-box}.rhdocs img,.rhdocs object,.rhdocs svg,img,object,svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs hr{border:0;border-top:.0625rem solid #d2d2d2;clear:both;margin:1rem 0}.rhdocs a{color:#06c;text-decoration:underline}.rhdocs a:focus,.rhdocs a:hover{color:#036}.rhdocs a.anchor-heading{color:#151515;cursor:pointer;text-decoration:none;word-break:break-all}.rhdocs p{margin:1.49963rem 0}.rhdocs li>p{margin:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:500;margin:0 0 .625rem}.rhdocs h1{font-size:2.25rem;margin:2rem 0}.rhdocs h2{font-size:1.625rem;margin:2rem 0}.rhdocs h3{font-size:1.5rem;font-weight:400}.rhdocs h4,.rhdocs h5{font-size:1.25rem}.rhdocs h5{font-weight:400}.rhdocs h6{font-size:1.125rem;font-weight:500;line-height:1.6667}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ol ::marker,.rhdocs ul ::marker{font:inherit}.rhdocs li{margin:0 0 .5em;padding:0}.rhdocs li>p{margin:.5rem 0}.rhdocs li>ol,.rhdocs li>ul{margin:0}.rhdocs dl dd{margin:.5rem 0 .5rem 1rem}.rhdocs dl dd>p{margin:.5rem 0}.rhdocs .informaltable,.rhdocs .table-contents,.rhdocs .table-wrapper{max-height:var(--rh-table--maxHeight);overflow:auto}.rhdocs table{border:0;font-size:1rem;line-height:1.6667;table-layout:fixed}.rhdocs table caption{color:#585858;margin-bottom:.5rem;margin-top:.5rem;text-align:left}.rhdocs table td,.rhdocs table th{border:0;border-bottom:.0625rem solid #d2d2d2;border-bottom:.0625rem solid var(--pfe-table--Border,#d2d2d2);padding:.5em 1rem}.rhdocs table td.halign-left,.rhdocs table th.halign-left{text-align:left}.rhdocs table td.halign-center,.rhdocs table th.halign-center,table td.halign-center,table th.halign-center{text-align:center}.rhdocs table td.halign-right,.rhdocs table th.halign-right{text-align:right}.rhdocs table td.valign-top,.rhdocs table th.valign-top{vertical-align:top}.rhdocs table td.valign-middle,.rhdocs table th.valign-middle{vertical-align:middle}.rhdocs table td.valign-bottom,.rhdocs table th.valign-bottom{vertical-align:bottom}.rhdocs table thead td,.rhdocs table thead th{background:#f5f5f5;font-weight:600}.rhdocs rh-table table,.rhdocs rh-table.rh-table--expanded-vertically{max-height:-moz-max-content;max-height:max-content}.rhdocs pre.nowrap{overflow:auto;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs .codeblock__wrapper pre{background:transparent}.rh-table--full-screen code,.rhdocs .content--md code,.rhdocs .content--sm code,.rhdocs .rh-table--full-screen code{overflow-wrap:normal;word-break:normal}.rhdocs[class] pre code,[class] pre code{background:inherit;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.rhdocs .keycap,.rhdocs kbd{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.keycap strong,.rhdocs .keycap strong{font-weight:inherit}.rhdocs kbd.keyseq,kbd.keyseq{background:transparent;border:0;box-shadow:none;padding:0}.rhdocs kbd.keyseq kbd,kbd.keyseq kbd{display:inline-block;margin:0 .375rem}.rhdocs kbd.keyseq kbd:first-child,kbd.keyseq kbd:first-child{margin-left:0}.rhdocs b.button{font-size:90%;font-weight:700;padding:.1875rem}.rhdocs b.button:before{content:"["}.rhdocs b.button:after{content:"]"}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}.rhdocs audio,.rhdocs canvas,.rhdocs progress,.rhdocs video{display:inline-block;vertical-align:baseline}.rhdocs audio:not([controls]){display:none;height:0}[hidden],template{display:none}.rhdocs a{background:transparent}.rhdocs a:active,.rhdocs a:hover{outline:0}.rhdocs a.anchor-heading:hover:before{color:#151515;content:"#";margin-left:-1.6rem;position:absolute}.rhdocs a.anchor-heading:focus-visible{color:#151515}@media screen and (max-width:990px){.rhdocs a.anchor-heading:hover:before{font-size:16px;margin-left:-1rem;padding-top:8px}.rhdocs h1 a.anchor-heading:hover:before{padding-top:12px}.rhdocs h4 a.anchor-heading:hover:before,.rhdocs h5 a.anchor-heading:hover:before{padding-top:4px}.rhdocs h6 a.anchor-heading:hover:before{padding-top:2px}}.rhdocs abbr[title]{border-bottom:.0625rem dotted}.rhdocs dfn{font-style:italic}.rhdocs h1{font-size:2em;margin:.67em 0}.rhdocs mark{background:#ff0;color:#000}.rhdocs small{font-size:80%}.rhdocs sub,.rhdocs sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.rhdocs sup{top:-.5em}.rhdocs sub{bottom:-.25em}.rhdocs img{border:0}.rhdocs svg:not(:root){overflow:hidden}.rhdocs figure{margin:1em 2.5rem}.rhdocs hr{box-sizing:content-box;height:0}.rhdocs code,.rhdocs kbd,.rhdocs pre,.rhdocs samp{font-family:monospace,monospace;font-size:1em}.rhdocs button,.rhdocs optgroup,.rhdocs select,.rhdocs textarea,.rhdocsinput{color:inherit;font:inherit;margin:0}.rhdocs button.copy-link-btn{background:none;border:2px solid #fff;font:1px Red Hat Text}.rhdocs button.copy-link-btn:hover{border-bottom:2px solid #06c}.rhdocs button.copy-link-btn .link-icon{padding-bottom:4px}.rhdocs button{overflow:visible}.rhdocs button,.rhdocs select{text-transform:none}.rhdocs button,.rhdocs html input[type=button],.rhdocs input[type=reset],.rhdocs input[type=submit]{-moz-appearance:button;appearance:button;-webkit-appearance:button;cursor:pointer}.rhdocs button[disabled],.rhdocs html input[disabled]{cursor:default}.rhdocs button::-moz-focus-inner,.rhdocs input::-moz-focus-inner{border:0;padding:0}.rhdocs input{line-height:normal}.rhdocs input[type=checkbox],.rhdocs input[type=radio]{box-sizing:border-box;padding:0}.rhdocs input[type=number]::-webkit-inner-spin-button,.rhdocs input[type=number]::-webkit-outer-spin-button{height:auto}.rhdocs input[type=search]{-moz-appearance:textfield;appearance:textfield;-webkit-appearance:textfield;box-sizing:content-box}.rhdocs input[type=search]::-webkit-search-cancel-button,.rhdocs input[type=search]::-webkit-search-decoration{-webkit-appearance:none}.rhdocs fieldset{border:.0625rem solid silver;margin:0 .125rem;padding:.35em .625em .75em}.rhdocs legend{border:0;padding:0}.rhdocs textarea{overflow:auto}.rhdocs optgroup{font-weight:700}.rhdocs table{border-collapse:collapse;border-spacing:0}.rhdocs td,.rhdocs th{padding:0}.rhdocs ._additional-resources[class][class][id]:last-child{margin-top:-2rem}.rhdocs ._additional-resources[class][class]:only-child{grid-column:1/-1}._additional-resources[class][class] .additional-resources__heading,._additional-resources[class][class] .heading,._additional-resources[class][class] h1,._additional-resources[class][class] h2,._additional-resources[class][class] h3,._additional-resources[class][class] h4,._additional-resources[class][class] h5,._additional-resources[class][class] h6,._additional-resources[class][class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper ._additional-resources[class][class] ul{display:block}._additional-resources[class][class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}._additional-resources[class][class] li:only-child{grid-column:1/-1}._additional-resources[class][class] li:last-child{border:0}@media (min-width:1100px){._additional-resources[class][class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}._additional-resources[class][class] li p:only-child{margin:0;padding:0}._additional-resources[class][class] li a{text-decoration:none}._additional-resources[class][class] li a:focus,._additional-resources[class][class] li a:hover{text-decoration:underline}.rhdocs table .admonitionblock>div:nth-child(2),.rhdocs table .caution>div:nth-child(2),.rhdocs table .important>div:nth-child(2),.rhdocs table .note>div:nth-child(2),.rhdocs table .tip>div:nth-child(2),.rhdocs table .warning>div:nth-child(2){margin:.5rem 0}.rhdocs table .admonitionblock>div:nth-child(2)>:first-child,.rhdocs table .caution>div:nth-child(2)>:first-child,.rhdocs table .important>div:nth-child(2)>:first-child,.rhdocs table .note>div:nth-child(2)>:first-child,.rhdocs table .tip>div:nth-child(2)>:first-child,.rhdocs table .warning>div:nth-child(2)>:first-child{margin-top:0}.rhdocs table .admonitionblock>div:nth-child(2)>:last-child,.rhdocs table .caution>div:nth-child(2)>:last-child,.rhdocs table .important>div:nth-child(2)>:last-child,.rhdocs table .note>div:nth-child(2)>:last-child,.rhdocs table .tip>div:nth-child(2)>:last-child,.rhdocs table .warning>div:nth-child(2)>:last-child{margin-bottom:0}.rhdocs .codeblock__wrapper+.codeblock__wrapper,.rhdocs pre+pre,.rhdocs pre[class]+pre[class]{margin-top:2rem}.rhdocs .codeblock__wrapper{background:#f8f8f8;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__wrapper:before{background-repeat:no-repeat;background-size:6.25rem 100%;bottom:var(--scrollbar__height,1px);content:"";display:block;height:7.125rem;max-height:100%;max-height:calc(100% - var(--scrollbar__height, 2px));position:absolute;right:var(--scrollbar__width,6px);top:.0625rem;width:4.0625rem;z-index:1}.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 6.25rem)}@media (min-height:48em){.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 12.5rem)}}.rhdocs .codeblock__inner-wrapper{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs .codeblock__wrapper--expanded .codeblock__inner-wrapper{max-height:-moz-max-content;max-height:max-content}.codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.codeblock__copy:focus{outline:.0625rem dashed currentcolor}.codeblock__copy svg#icon--copy{height:1rem;width:1rem}.codeblock__expand{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;border:0;cursor:pointer;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));position:absolute;text-indent:-9999em;top:3.25rem;width:1.75rem;z-index:2}.codeblock__expand:before{background:#6a6e73;content:"";height:100%;left:0;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:auto 1rem;mask-size:auto 1rem;position:absolute;top:0;width:100%}.codeblock__wrapper--expanded .codeblock__expand{background:#2b9af3}.codeblock__wrapper--expanded .codeblock__expand:before{background:#fff}.codeblock__expand:focus:before,.codeblock__expand:hover:before{background:#06c}.codeblock__wrapper--expanded .codeblock__expand:focus:before,.codeblock__wrapper--expanded .codeblock__expand:hover:before{background:#fff}.codeblock__expand:focus{outline:.0625rem dashed currentcolor}.rhdocs .calloutlist>ol,.rhdocs .colist>ol{counter-reset:colist;list-style:none;margin:1rem 0 2rem;padding:0}.rhdocs .calloutlist>ol>li,.rhdocs .colist>ol>li{counter-increment:colist;font-size:1rem;margin:.5rem 0;padding-left:1.75rem;position:relative}.rhdocs .calloutlist>ol>li .colist-num,.rhdocs .colist>ol>li .colist-num{display:none}.calloutlist>ol>li:before,.colist>ol>li:before{content:counter(colist);left:0;position:absolute;top:.1875rem}.calloutlist dt{clear:left;float:left;margin:0;padding:0 .5rem 0 0}.included-in-guides[class],.included-in-guides[class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.included-in-guides[class][id]:last-child{margin-top:-2rem}.included-in-guides[class]:only-child{grid-column:1/-1}.included-in-guides[class] .additional-resources__heading,.included-in-guides[class] .heading,.included-in-guides[class] h1,.included-in-guides[class] h2,.included-in-guides[class] h3,.included-in-guides[class] h4,.included-in-guides[class] h5,.included-in-guides[class] h6,.included-in-guides[class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.included-in-guides[class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper .included-in-guides[class] ul{display:block}.included-in-guides[class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}.included-in-guides[class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.included-in-guides[class] li:only-child{grid-column:1/-1}.included-in-guides[class] li:last-child{border:0}@media (min-width:1100px){.included-in-guides[class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}.included-in-guides[class] li p:only-child{margin:0;padding:0}.included-in-guides[class] li a{text-decoration:none}.included-in-guides[class] li a:focus,.included-in-guides[class] li a:hover{text-decoration:underline}.menuseq{display:inline-flex;overflow:hidden;text-indent:-9999em}.menuseq .menu,.menuseq .menuitem,.menuseq .submenu{display:block;position:relative;text-indent:0}.menuseq .menu+.menu:before,.menuseq .menu+.menuitem:before,.menuseq .menu+.submenu:before,.menuseq .menuitem+.menu:before,.menuseq .menuitem+.menuitem:before,.menuseq .menuitem+.submenu:before,.menuseq .submenu+.menu:before,.menuseq .submenu+.menuitem:before,.menuseq .submenu+.submenu:before{content:">";display:inline-block;font-weight:700;padding:0 .25em}.related-topic-content__wrapper{margin:2em 0}.related-topic-content__wrapper--for-guide{margin-bottom:-2.5rem;padding-bottom:.0625rem;position:relative;z-index:1}.related-topic-content__wrapper--for-guide:before{background:#f0f0f0;content:"";display:block;height:100%;left:-3rem;position:absolute;right:-4.5rem;top:0;width:auto;z-index:-1}@media (min-width:1100px){.related-topic-content__wrapper--for-guide:before{left:-2.5rem;right:-3.625rem}}.related-topic-content__wrapper--for-guide summary{padding:1em 2em 1em 2.1875rem}@media (min-width:950px){.related-topic-content__inner-wrapper{display:grid;gap:2em;grid-template-columns:repeat(2,minmax(0,1fr))}}.local-render .rhdocs-content{margin:0 auto}.rhdocs cp-documentation{display:block;padding-bottom:2.5rem}.rhdocs cp-documentation.PFElement,.rhdocs cp-documentation[pfelement]{padding:0}rh-table{display:block}::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar{height:.625rem;width:.625rem}::-webkit-scrollbar,::-webkit-scrollbar-track,:host .rhdocs ::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar-track{background-color:#d6d6d6}::-webkit-scrollbar-thumb,:host .rhdocs ::-webkit-scrollbar-thumb{background-color:#8e8e8e}*,:host .rhdocs *{scrollbar-color:#8e8e8e #d6d6d6}.rhdocs p:empty,p:empty{display:none}.rhdocs[class] h1 code,.rhdocs[class] h2 code,.rhdocs[class] h3 code,.rhdocs[class] h4 code,.rhdocs[class] h5 code,.rhdocs[class] h6 code,[class] h1 code,[class] h2 code,[class] h3 code,[class] h4 code,[class] h5 code,[class] h6 code{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.pane-page-title h1,.rhdocs__header__primary-wrapper h1{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:2.25rem;line-height:1.333}.rhdocs details[class]{list-style:none;margin:1rem 0 3rem;padding:0}.rhdocs-toc[class]{background:#f2f2f2;margin:1rem 0 2rem;padding:1rem}.rhdocs-toc[class]>:last-child{margin-bottom:0}.rhdocs-toc[class] .rhdocs-toctitle{font-size:1.25rem;font-weight:400;line-height:1.6667;margin-top:0;text-transform:none}.rhdocs-toc[class] li{margin-bottom:.25em;padding-left:.5em}.preamble{margin:0 0 2rem}.sect1{margin:2rem 0 1rem}:host .sect1,cp-documentation .sect1{margin:0 0 2rem;padding:.0625rem 0 0}:host(.cp-documentation--has-external-header) .sect1:first-child>h2:first-child,:host(.cp-documentation--has-external-header) .sect1:first-child>h3:first-child{margin-top:0}.listingblock,.literalblock{margin:1rem 0}.quoteblock,.verseblock{border-left:.25rem solid #d2d2d2;margin:1rem 0;padding:1rem 1rem 1rem 2rem}.quoteblock.pullleft,.verseblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.quoteblock.pullleft,.verseblock.pullleft{margin-left:-1rem}}.quoteblock.pullright,.verseblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.quoteblock.pullright,.verseblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.quoteblock.pullright,.verseblock.pullright{margin-right:-10rem}}.quoteblock>:first-child,.verseblock>:first-child{margin-top:0}.quoteblock .content,.verseblock .content{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.25rem;line-height:1.6667}.quoteblock .attribution,.verseblock .attribution{font-size:.875rem;font-style:italic;font-weight:600;line-height:1.6667;text-transform:uppercase}.quoteblock .attribution .citetitle,.verseblock .attribution .citetitle{color:#585858}.quoteblock .attribution cite,.verseblock .attribution cite{font-size:1em}.quoteblock blockquote{font-style:italic;margin:0;padding:0}.quoteblock blockquote .content>:first-child{margin-top:0}.quoteblock blockquote .content>:first-child:before{color:#e00;content:"â€œ";display:block;float:left;font-size:2.75rem;font-style:normal;line-height:1.125em;margin-right:.5rem}.quoteblock blockquote .content>:first-child .content>:first-child:before{content:none}.imageblock{margin:1rem 0}.imageblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.imageblock.pullleft{margin-left:-1rem}}.imageblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.imageblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.imageblock.pullright{margin-right:-10rem}}.imageblock.interrupter{margin:2rem 0}@media (min-width:768px){.imageblock.interrupter{margin-left:-1rem;margin-right:-2rem}.imageblock.interrupter .caption{margin-left:1rem;margin-right:2rem}}@media (min-width:1100px){.imageblock.interrupter{margin-right:-10rem}.imageblock.interrupter .caption{margin-right:10rem}}.imageblock.interrupter img{max-width:100%}.imageblock .caption{color:#585858;display:block;font-size:.875rem;line-height:1.6667;margin:.5rem 0 0}.rhdocs-footnotes{border-top:.0625rem solid #d2d2d2;margin:3rem 0 1rem;padding:1rem 0 0}.rhdocs-footnotes>ol{margin:0;padding:0 0 0 1.5rem}@supports (counter-reset:footnotenum){.rhdocs-footnotes>ol{counter-reset:footnotenum;list-style:none;padding:0}.rhdocs-footnotes>ol>li{counter-increment:footnotenum}.rhdocs-footnotes>ol>li:before{color:#585858;content:"[" counter(footnotenum) "]";display:inline-block;margin-right:.25rem}}.rhdocs-footer{background:#ededed;color:#151515;font-size:.875rem;line-height:1.6667;margin:3rem 0 0;padding:1rem}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.visually-hidden{overflow:hidden;position:absolute;clip:rect(0,0,0,0);border:0;height:.0625rem;margin:-.0625rem;padding:0;width:.0625rem}.rh-docs-legal-notice{margin-top:4em}pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}code.language-none,code.language-text,code.language-txt,pre.language-none,pre.language-text,pre.language-txt{color:#151515}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#cceae7;color:#263238}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#cceae7;color:#263238}:not(pre)>code[class*=language-]{border-radius:.2em;padding:.1em;white-space:normal}.token.atrule{color:#40199a}.token.attr-name{color:#06c}.token.attr-value,.token.attribute{color:#b300b3}.token.boolean{color:#40199a}.token.builtin,.token.cdata,.token.char,.token.class,.token.class-name{color:#06c}.token.comment{color:#6a6e73}.token.constant{color:#40199a}.token.deleted{color:#c9190b}.token.doctype{color:#6a6e73}.token.entity{color:#c9190b}.token.function{color:#40199a}.token.hexcode{color:#b300b3}.token.id,.token.important{color:#40199a;font-weight:700}.token.inserted{color:#06c}.token.keyword{color:#40199a}.token.number{color:#b300b3}.token.operator{color:#06c}.token.prolog{color:#6a6e73}.token.property{color:#06c}.token.pseudo-class,.token.pseudo-element{color:#b300b3}.token.punctuation,.token.regex{color:#06c}.token.selector{color:#c9190b}.token.string{color:#b300b3}.token.symbol{color:#40199a}.token.unit{color:#b300b3}.token.url,.token.variable{color:#c9190b}.rhdocs.local-render{margin:0 auto;max-width:45.8125rem;padding:0 1.5rem}@media print{.field code,.field pre,code[class*=language-],pre,pre[class*=language-]{white-space:pre-wrap!important;word-wrap:break-word!important;overflow-wrap:break-word!important;word-break:break-word!important}}.book-nav__list[class]{display:flex;justify-content:space-between;line-height:var(--jupiter__lineHeight--xs,1.3333);list-style:none;margin:5rem 0 0;padding:0}@media (min-width:1200px){.book-nav__list[class]{display:grid;gap:2rem;grid-template-columns:repeat(2,minmax(0,1fr))}}.book-nav__item a{display:inline-block;font-size:.875rem;font-weight:500;padding-left:1.25rem;position:relative;text-transform:uppercase}.book-nav__item a:before{background:url(/sites/dxp-docs/penumbra-dist/jupiter/images/arrow-down-solid.svg) no-repeat;background-size:contain;content:"";display:block;height:.875rem;left:0;position:absolute;top:.125rem;transform:rotate(90deg);width:.875rem}.book>.titlepage:not(:last-child),.rhdocs .chapter,section[id]{padding-bottom:3.75rem}.book>.titlepage .chapter:last-child,.book>.titlepage section[id]:last-child,.chapter .chapter:last-child,.chapter section[id]:last-child,section[id] .chapter:last-child,section[id] section[id]:last-child{margin-bottom:-3.75rem}.rhdocs .codeblock__wrapper+section[id],pre+section[id]{padding-top:3.75rem}.rhdocs .cta-link{font-size:inherit}.rhdocs a{word-wrap:break-word;overflow-wrap:break-word}.rhdocs .caution,.rhdocs .important,.rhdocs .note,.rhdocs .tip,.rhdocs .warning{padding:.8888888889em;position:relative}.rhdocs .QSIPopOver{bottom:18.75rem!important;top:auto!important}.rhdocs .alert{position:relative}.rhdocs button.dismiss-button{background:none;border:0;cursor:pointer;height:2.5rem;margin-top:-1.25rem;padding:0;position:absolute;right:.3125rem;text-align:center;top:50%;width:2.5rem;z-index:50}.rhdocs button.dismiss-button:after{content:"\f109";display:inline-block;filter:alpha(opacity=30);font-family:rh-web-iconfont;font-size:1.3125rem;font-style:normal;font-variant:normal;font-weight:400;line-height:1;line-height:2.5rem;opacity:.3;text-decoration:inherit;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs .book>.titlepage,.rhdocs .chapter,.rhdocs section[id]{padding-bottom:var(--rh-space-4xl,64px)}.rhdocs .alert{border:0;border-radius:0}.rhdocs .alert>h2:first-child,.rhdocs .alert>h3:first-child,.rhdocs .alert>h4:first-child,.rhdocs .alert>h5:first-child,.rhdocs .alert>h6:first-child,.rhdocs .alert>p:first-child{margin-top:0!important}.rhdocs .alert>p:last-child{margin-bottom:0!important}.rhdocs .alert-w-icon[class]{padding-left:2.8125rem}.rhdocs .alert-w-icon .alert-icon{float:left;font-size:1.125rem;margin-left:-1.875rem;margin-right:.625rem}.rhdocs .alert-w-icon .alert-icon[class*=" rh-icon-"],.rhdocs .alert-w-icon .alert-icon[class^=rh-icon-]{font-size:2.25rem;line-height:1em;margin-left:-2.5rem;margin-top:-.375rem}.rhdocs .alert-w-icon .alert-icon[class*=" icon-innov-prev"],.rhdocs .alert-w-icon .alert-icon[class^=icon-innov-prev]{font-size:1.3125rem;margin-top:.25rem}.rhdocs .alert-w-icon.alert-plain{background:none;color:#151515;padding-left:5rem}.rhdocs .alert-w-icon.alert-plain .alert-icon{font-size:3rem;margin-left:-4.375rem;margin-right:0}.rhdocs .alert-w-icon.alert-plain.alert-success .alert-icon{color:#3f9c35}.rhdocs .alert-w-icon.alert-plain.alert-info .alert-icon{color:#0088ce}.rhdocs .alert-w-icon.alert-plain.alert-warning .alert-icon{color:#f0ab00}.rhdocs .alert-w-icon.alert-plain.alert-danger .alert-icon{color:#e00}#target_banner .copy-url{float:right;margin-top:0}#target_banner .dropdown-menu{font-size:inherit}.titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.para{margin:1.49963rem 0}.para[class]{margin-bottom:1.49963rem}dd{margin-bottom:2.5rem}.rhdocs .card-light,.rhdocs .card-light-gray,.rhdocs .card-light-grey{background:#f0f0f0;border:.0625rem solid #f0f0f0;color:#151515}.rhdocs .card-light-gray.push-bottom:first-child,.rhdocs .card-light-grey.push-bottom:first-child,.rhdocs .card-light.push-bottom:first-child{margin-bottom:3.125rem!important}.rhdocs .card-light a.card-link,.rhdocs .card-light h1,.rhdocs .card-light h2,.rhdocs .card-light h3,.rhdocs .card-light h4,.rhdocs .card-light h5,.rhdocs .card-light h6,.rhdocs .card-light-gray a.card-link,.rhdocs .card-light-gray h1,.rhdocs .card-light-gray h2,.rhdocs .card-light-gray h3,.rhdocs .card-light-gray h4,.rhdocs .card-light-gray h5,.rhdocs .card-light-gray h6,.rhdocs .card-light-grey a.card-link,.rhdocs .card-light-grey h1,.rhdocs .card-light-grey h2,.rhdocs .card-light-grey h3,.rhdocs .card-light-grey h4,.rhdocs .card-light-grey h5,.rhdocs .card-light-grey h6{color:#151515}.rhdocs .card-light-gray.card-active:after,.rhdocs .card-light-grey.card-active:after,.rhdocs .card-light.card-active:after{border-top-color:#f0f0f0}.rhdocs .card-md,.rhdocs .card-narrow{display:block;padding:1.1875rem;white-space:normal;word-wrap:break-word}.rhdocs .card .card-heading.card-heading-sm,.rhdocs .card-sm .card .card-heading{font-size:1.0625em;font-weight:500;line-height:1.5}.rhdocs .card .card-heading.card-heading-flush{margin-bottom:.25rem}.rhdocs .card .card-heading.card-heading-red{color:#d10000}.rhdocs .card>p{margin-top:0}.rhdocs .card>p:last-child{margin-bottom:0}.rhdocs .new-experience{background-color:#e7f1fa;border:.0625rem solid #bee1f4;font-size:1rem;margin:1.5rem;padding:1.5rem;position:relative;z-index:1}@media (min-width:48rem){.new-experience{display:flex}.new-experience--contained{left:50%;position:relative;transform:translateX(-50%);width:calc(100vw - 2.5rem)}}.new-experience__primary-content{flex-grow:1}@media (min-width:48rem){.new-experience__primary-content{margin-right:1.25rem}}.new-experience__title{font-size:inherit;font-weight:inherit;line-height:1.6;margin:0;padding:0}.new-experience__title+a,.new-experience__title+pfe-cta{display:inline-block;margin-top:1.5em}.new-experience__secondary-content{min-width:12.5rem}@media (min-width:48rem){.new-experience__secondary-content{text-align:right}}.example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:min-content 1fr}dl.calloutlist[class] dt{float:none;margin:0;padding:0}dl.calloutlist[class] dd{margin:0;padding:0}dl.calloutlist[class] dd>:first-child{margin-top:0}dl.calloutlist[class] dd>:last-child{margin-bottom:0}.toast{background-color:#000;background-color:rgba(0,0,0,.9);bottom:.9375rem;box-shadow:0 .125rem .3125rem 0 rgba(0,0,0,.26);color:#fff;left:.9375rem;max-width:32.8125rem;min-width:6.25rem;padding:.9375rem;position:fixed;right:.9375rem;transform:translate3d(0,150%,0);transition:transform .2s cubic-bezier(.465,.183,.153,.946);will-change:transform;z-index:999}.toast.show{transform:translateZ(0)}.toast a{color:#fff;text-decoration:underline}.toast a:focus,.toast a:hover{color:#2b9af3}.toast a.btn{text-decoration:none}.toast .btn.btn-link{color:#fff}.toast .close{color:#fff;opacity:.3;text-decoration:none}.toast .close:focus,.toast .close:hover{color:#fff;opacity:.5}.no-csstransforms3d.csstransitions .toast{transition:all .2s cubic-bezier(.465,.183,.153,.946)}.no-csstransforms3d .toast{opacity:0;visibility:hidden}.no-csstransforms3d .toast.show{opacity:1;visibility:visible}.annotator-outer[class][class]{display:none;flex-direction:column;flex-grow:1;height:auto;margin:0;position:static;width:auto}@media (min-width:1400px){.annotator-outer[class][class]{display:flex}}.annotator-frame[class] *{height:auto}@media (min-width:1400px){.annotator-frame .h-sidebar-iframe[class]{position:static;width:calc(100% + 1.5rem)}}.annotator-toolbar[class][class]{position:static;width:auto}.annotator-toolbar>ul,.annotator-toolbar>ul>li{display:block;height:auto;list-style:none;margin:0;padding:0;width:auto}.annotator-toolbar>ul>li{display:flex;justify-content:flex-end}.annotator-frame[class] .annotator-frame-button--sidebar_toggle,.annotator-outer .annotator-frame-button[class][class],.app-content-wrapper *{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif!important}.annotator-outer .annotator-frame-button[class][class]{font-size:.9375rem;font-weight:500;height:auto;line-height:1.333;margin-right:1.875rem;padding:.75em 1em;position:static}@media (min-width:1400px){.annotator-outer .annotator-frame-button[class][class]{margin-right:0}}.annotator-outer iframe{flex-grow:1;margin-bottom:1.25rem}@media (min-width:1400px){.annotator-outer iframe{min-height:37.5rem}}.producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.producttitle .productnumber{color:var(--jupiter__palette__red--50,#e00)}.cp-modal-open,.zoom-open{overflow:hidden}.cp-modal,.cp-video-modal,.zoom-modal{bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;outline:0;overflow:hidden;position:fixed;right:0;top:0;transition:all .2s cubic-bezier(.465,.183,.153,.946);z-index:1040;z-index:1050;-webkit-overflow-scrolling:touch}.rhdocs .in.cp-modal,.rhdocs .in.cp-video-modal,.rhdocs .in.zoom-modal{display:block;filter:alpha(opacity=100);opacity:1;overflow-x:hidden;overflow-y:auto}.rhdocs .cp-modal .close,.rhdocs .cp-video-modal .close,.rhdocs .zoom-modal .close{background-color:#fff;border-radius:50%;color:#1a1a1a;font-size:1.75rem;height:28px;height:1.75rem;line-height:1.75rem;margin-bottom:.375rem;margin-top:0;opacity:.9;position:absolute;right:-.5rem;text-shadow:none;top:0;width:28px;width:1.75rem}.cp-modal .close:after,.cp-video-modal .close:after,.zoom-modal .close:after{line-height:1.75rem}.cp-modal-wrap,.zoom-wrap{margin:.625rem;padding-top:.5rem;position:relative}@media (min-width:48rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{margin:2.8125rem auto;width:38.4375rem}}@media (min-width:62rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:49.8958rem}}@media (min-width:75rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:60.3125rem}}.rhdocs .cp-modal-body :last-child{margin-bottom:0}.rhdocs .cp-modal-backdrop,.rhdocs .zoom-backdrop{background-color:#000;bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;position:fixed;right:0;top:0;transition:opacity .2s cubic-bezier(.465,.183,.153,.946);z-index:1040}.rhdocs .in.cp-modal-backdrop,.rhdocs .in.zoom-backdrop{display:block;filter:alpha(opacity=80);opacity:.8}.rhdocs .cp-modal-body{background:#fff;padding:1.875rem}.rhdocs .cp-modal[data-cp-modal-video=true] .cp-modal-body,.rhdocs .cp-video-modal .cp-modal-body{padding:0}.rhdocs [data-action=zoom]{position:relative}.rhdocs [data-action=zoom]:after{background:rgba(0,0,0,.4);bottom:0;color:#fff;display:inline-block;font-family:rh-web-iconfont;font-style:normal;font-variant:normal;font-weight:400;line-height:1;padding:.375rem;position:absolute;right:0;text-decoration:inherit;text-decoration:none!important;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs [data-action=zoom]:focus:after,.rhdocs [data-action=zoom]:hover:after{background:rgba(0,0,0,.9)}.rhdocs .zoom-wrap .zoom-larger{text-align:center}.rhdocs .zoom-wrap .zoom-larger a{color:#fff}.rhdocs .zoom-wrap .zoom-larger a:focus,.rhdocs .zoom-wrap .zoom-larger a:hover{color:#fff;text-decoration:underline}.rhdocs .zoom-wrap .zoom-larger a:after{content:"â¿»";display:inline-block;margin-left:.25rem}.rhdocs .zoom-body{background:#fff;border-radius:.5rem;margin:0 0 1rem;padding:1rem;text-align:center}.rhdocs .zoom-body .video-wrapper{height:0;overflow:hidden;padding-bottom:56.25%;position:relative}.rhdocs .zoom-body .video-wrapper[data-aspect-ratio="4:3"]{padding-bottom:75%}.rhdocs .zoom-body iframe{height:100%;left:0;position:absolute;top:0;width:100%}.rhdocs .para>.title[class],.rhdocs p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0;text-transform:none}.rhdocs .para>.title[class]+.content>:first-child,.rhdocs .para>.title[class]+p,.rhdocs p.title[class]+.content>:first-child,.rhdocs p.title[class]+p{margin-top:0}.rhdocs [class] pre .caution,.rhdocs [class] pre .important,.rhdocs [class] pre .note,.rhdocs [class] pre .tip,.rhdocs [class] pre .warning{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.rhdocs [class] pre .caution:after,.rhdocs [class] pre .important:after,.rhdocs [class] pre .note:after,.rhdocs [class] pre .tip:after,.rhdocs [class] pre .warning:after{content:none}.rhdocs [class] code.email{background-color:transparent;font:inherit;padding:0}.rhdocs [class] .author{margin-bottom:1.5rem}.rhdocs [class] .author .author{margin-bottom:0}.rhdocs table{margin:2rem 0}.rhdocs [class] table{width:auto}.rhdocs table .table-contents table{max-width:100%;overflow:auto}.rhdocs rh-table table{margin:0;max-width:9999em;overflow:visible}.rhdocs td,.rhdocs th{border-left:0;padding:.5em 1rem;transition:background .25s ease-out}.rhdocs td.content--md[class][class],.rhdocs th.content--md[class][class]{min-width:13em}.rhdocs td.content--lg[class][class],.rhdocs th.content--lg[class][class]{min-width:20em}.rhdocs thead th{padding-top:1.5em}.rhdocs caption{color:currentColor;color:var(--pfe-table__caption--Color,currentColor);font-weight:700;margin-bottom:.5rem;margin-top:.5rem;text-align:center}.rhdocs .revhistory table td,.rhdocs .revhistory table th{border-color:transparent}.rhdocs .revhistory table td{padding:.625rem .875rem}.rhdocs .revhistory table.simplelist{margin:0}@media print{#masthead{display:none!important}}.rh-table--is-full-screen #to-top{display:none}.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:var(--rh-font-family-body-text,RedHatText,"Red Hat Text","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-body-copy-lage,1.125rem);line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs rh-codeblock::slotted(#content){border-radius:.25rem;padding:var (--rh-space-lg,16px)}.rhdocs rh-codeblock .screen{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs rh-codeblock[class][class][class][class][class]{max-width:99999em}.rhdocs .codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.rhdocs .codeblock__copy:focus{outline:.0625rem dashed currentcolor}.rhdocs .codeblock__copy svg#icon--copy{height:1rem;width:1rem}.rhdocs pre{border:0;max-height:-moz-max-content;max-height:max-content}.rhdocs pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre,.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre[class]{margin:0;padding:0;position:relative}.rhdocs code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs code.literal{background:#eee;border-radius:.25rem;color:#000;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs code.literal,.rhdocs kbd,.rhdocs span.keycap{font-family:RedHatMono,Red Hat Mono,Consolas,monospace}.rhdocs kbd,.rhdocs span.keycap{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ._additional-resources[class][class],.rhdocs ._additional-resources[class][class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.rhdocs ._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.rhdocs ._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.rhdocs ._additional-resources[class][class] li:last-child{border:0}.rhdocs section.section#additional_resource .additional-resources__heading,.rhdocs section.section#additional_resource .heading,.rhdocs section.section#additional_resource h1,.rhdocs section.section#additional_resource h2,.rhdocs section.section#additional_resource h3,.rhdocs section.section#additional_resource h4,.rhdocs section.section#additional_resource h5,.rhdocs section.section#additional_resource h6,.rhdocs section.section#additional_resource p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.rhdocs section.section:first-of-type{margin-top:var(--rh-space-4xl,64px)}.rhdocs section.section p{margin-bottom:var(--rh-space-lg,16px);margin-top:0;word-wrap:break-word}.rhdocs .section.section h1,.rhdocs .section.section h2,.rhdocs .section.section h3,.rhdocs .section.section h4,.rhdocs .section.section h5,.rhdocs .section.section h6,.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h1:first-of-type,.rhdocs h2:first-of-type,.rhdocs h3:first-of-type,.rhdocs h4:first-of-type,.rhdocs h5:first-of-type,.rhdocs h6:first-of-type{margin-top:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h2,.rhdocs section.section h2{font-size:var(--rh-font-size-heading-md,1.75rem)}.rhdocs h3,.rhdocs section.section h3{font-size:1.5rem;font-weight:400}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs dl{display:block;margin-block-end:1em;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.rhdocs .para{margin:1.49963rem 0}.rhdocs dl.calloutlist[class] dt{float:none;margin:0;padding:0}.rhdocs dl.calloutlist[class] dd>:last-child{margin-bottom:0}.rhdocs dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:fit-content(40%) 1fr}.rhdocs .calloutlist dt{clear:left;display:flex;flex-wrap:wrap;float:left;margin:0;padding:0 .5rem 0 0}.rhdocs .calloutlist dt a:not(:first-child){padding-left:4px}.rhdocs dl.calloutlist[class] dd{margin:0;padding:0}.rhdocs .callout,.rhdocs .colist>ol>li:before,.rhdocs .conum{background:#06c;border-radius:50%;color:#fff;display:inline-block;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:.75rem;font-style:normal;font-weight:600;height:1.25rem;line-height:1.35rem;padding:0;position:relative;text-align:center;top:-.125em;vertical-align:middle;width:1.25rem}.rhdocs img,.rhdocs object,.rhdocs svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs .titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.rhdocs[class] .author{margin-bottom:1.5rem}.rhdocs[class] .author .author{margin-bottom:0}.rhdocs .para>.title[class],p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0}.rhdocs .example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}.rhdocs code{background:#eee;color:#000;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs .para[class]{margin-bottom:1.49963rem}.rhdocs[class] code.email{background-color:transparent;font:inherit;padding:0}rh-alert.admonition #description,rh-alert.admonition p{font-size:var(--rh-font-size-body-text-md,1rem)}rh-alert{width:-moz-fit-content;width:fit-content}.rhdocs .producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.rhdocs dl{margin:1rem 0}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs ol ol{list-style:lower-roman}.rhdocs .codeblock--processed pf-clipboard-copy::part(input),.rhdocs .codeblock--processed pf-clipboard-copy::part(span){display:none}.token.tag{color:#c9190b}.calloutlist div.para{margin:0}rh-alert.admonition{margin-bottom:var(--rh-space-lg,1rem)}.guibutton,.guimenu,.guimenuitem{font-weight:700}.guibutton{font-size:90%;padding:.1875rem}.guibutton:before{content:"["}.guibutton:after{content:"]"}.docs-content-container,.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}pre[hidden]{display:none}.codeblock[class][class][class][class][class]{max-width:99999em}.codeblock__wrapper{background:var(--rh-color-surface-lighter,#f2f2f2);margin:1rem 0;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__inner-wrapper:after{content:"";display:block;min-height:.625rem;width:4.375rem}.codeblock__copy{--pfe-clipboard--icon--Color--hover:#06c;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));padding:.3125rem .375rem;position:absolute;top:1rem;width:1.75rem;z-index:2}.codeblock__inner-wrapper pre{border:0;max-height:-moz-max-content;max-height:max-content}.pfe-clipboard:not([copied]) .pfe-clipboard__text--success,:host(:not([copied])) .pfe-clipboard__text--success{display:none!important}.codeblock[class]{margin:0;overflow:visible;padding-right:0}pre{display:block;font-size:.8125rem;line-height:1.42857;margin:0 0 .625rem;word-break:break-all;word-wrap:break-word;background-color:var(--rh-color-surface-lighter,#f2f2f2);border:.0625rem solid #ccc;border-radius:.25rem;color:#333}.docs-content-container pre,.rhdocs pre{background:var(--rh-color-surface-lighter,#f2f2f2);color:#151515;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs pre[class]{line-height:1.6667;overflow-x:auto}rh-codeblock pre[class][class]{overflow-x:auto}.pfe-clipboard__text--success{background-color:#ddd;border:1px solid #000;border-radius:2px}*,:after,:before{box-sizing:border-box}:root{--rh-space-xs:4px;--rh-space-sm:6px;--rh-space-md:8px;--rh-space-lg:16px;--rh-space-xl:24px;--rh-space-2xl:32px;--rh-space-3xl:48px;--rh-space-4xl:64px;--rh-space-5xl:80px;--rh-space-6xl:96px;--rh-space-7xl:128px;--rh-font-size-body-text-xs:.75rem;--rh-font-size-body-text-sm:.875rem;--rh-font-size-body-text-md:1rem;--rh-font-size-body-text-lg:1.125rem;--rh-font-size-body-text-xl:1.25rem;--rh-font-size-body-text-2xl:1.5rem;--rh-font-size-heading-xs:1.25rem;--rh-font-size-heading-sm:1.5rem;--rh-font-size-heading-md:1.75rem;--rh-font-size-heading-lg:2.25rem;--rh-font-size-heading-xl:2.5rem;--rh-font-size-heading-2xl:3rem;--pfe-navigation--logo--maxWidth:200px;--pfe-navigation__logo--height:40px;--pfe-navigation--fade-transition-delay:500ms;--pfe-navigation__nav-bar--highlight-color:var(--rh-color-brand-red-on-dark,#e00);--pf-global--icon--FontSize--sm:.75rem}body,html{font-family:Red Hat Text,sans-serif;font-size:var(--rh-font-size-body-text-md,1rem);line-height:var(--rh-line-height-body-text,1.5);margin:0}h1,h2,h3,h4,h5,h6{font-family:Red Hat Display,sans-serif;font-weight:400;line-height:var(--rh-line-height-heading,1.3)}h1{font-size:var(--rh-font-size-heading-2xl,3rem);line-height:62px}h2{font-size:var(--rh-font-size-heading-xl,2.5rem);line-height:48px}h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}h4{font-size:var(--rh-font-size-heading-md,2.25rem)}h5{font-size:var(--rh-font-size-heading-sm,2.25rem)}h6{font-size:var(--rh-font-size-heading-xs,2.25rem)}main{line-height:30px}section{padding-bottom:3rem;padding-top:3rem}img{height:auto;max-width:100%}a{color:var(--rh-color-interactive-blue-darker,#06c);text-decoration:none}a:hover{color:var(--rh-color-interactive-blue-darkest,#004080)}rh-alert.html-container a{text-decoration:underline}.container{padding-left:12px;padding-right:12px}.container,.container-fluid{margin-left:auto;margin-right:auto;width:100%}.container-fluid{padding:12px}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{min-width:1140px}}@media (min-width:1400px){.container{min-width:1320px}}.grid{display:grid;gap:var(--rh-space-xl,24px)}.grid-center{margin:auto}.grid.grid-col-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-12{grid-template-columns:repeat(12,1fr)}@media (min-width:768px){.grid.grid-col-md-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-md-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-md-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-md-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-md-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-md-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-md-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-md-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-md-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-md-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-md-12{grid-template-columns:repeat(12,1fr)}}@media (min-width:992px){.grid.grid-col-lg-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-lg-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-lg-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-lg-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-lg-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-lg-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-lg-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-lg-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-lg-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-lg-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-lg-12{grid-template-columns:repeat(12,1fr)}}.span-1{grid-column:span 1}.span-2{grid-column:span 2}.span-3{grid-column:span 3}.span-4{grid-column:span 4}.span-5{grid-column:span 5}.span-6{grid-column:span 6}.span-7{grid-column:span 7}.span-8{grid-column:span 8}.span-9{grid-column:span 9}.span-10{grid-column:span 10}.span-11{grid-column:span 11}.span-12{grid-column:span 12}@media (min-width:399px){.span-xs-1{grid-column:span 1}.span-xs-2{grid-column:span 2}.span-xs-3{grid-column:span 3}.span-xs-4{grid-column:span 4}.span-xs-5{grid-column:span 5}.span-xs-6{grid-column:span 6}.span-xs-7{grid-column:span 7}.span-xs-8{grid-column:span 8}.span-xs-9{grid-column:span 9}.span-xs-10{grid-column:span 10}.span-xs-11{grid-column:span 11}.span-xs-12{grid-column:span 12}}@media (min-width:768px){.span-md-1{grid-column:span 1}.span-md-2{grid-column:span 2}.span-md-3{grid-column:span 3}.span-md-4{grid-column:span 4}.span-md-5{grid-column:span 5}.span-md-6{grid-column:span 6}.span-md-7{grid-column:span 7}.span-md-8{grid-column:span 8}.span-md-9{grid-column:span 9}.span-md-10{grid-column:span 10}.span-md-11{grid-column:span 11}.span-md-12{grid-column:span 12}}@media (min-width:992px){.span-lg-1{grid-column:span 1}.span-lg-2{grid-column:span 2}.span-lg-3{grid-column:span 3}.span-lg-4{grid-column:span 4}.span-lg-5{grid-column:span 5}.span-lg-6{grid-column:span 6}.span-lg-7{grid-column:span 7}.span-lg-8{grid-column:span 8}.span-lg-9{grid-column:span 9}.span-lg-10{grid-column:span 10}.span-lg-11{grid-column:span 11}.span-lg-12{grid-column:span 12}}@media (min-width:1025px){.span-xl-1{grid-column:span 1}.span-xl-2{grid-column:span 2}.span-xl-3{grid-column:span 3}.span-xl-4{grid-column:span 4}.span-xl-5{grid-column:span 5}.span-xl-6{grid-column:span 6}.span-xl-7{grid-column:span 7}.span-xl-8{grid-column:span 8}.span-xl-9{grid-column:span 9}.span-xl-10{grid-column:span 10}.span-xl-11{grid-column:span 11}.span-xl-12{grid-column:span 12}}@media (min-width:1200px){.span-2xl-1{grid-column:span 1}.span-2xl-2{grid-column:span 2}.span-2xl-3{grid-column:span 3}.span-2xl-4{grid-column:span 4}.span-2xl-5{grid-column:span 5}.span-2xl-6{grid-column:span 6}.span-2xl-7{grid-column:span 7}.span-2xl-8{grid-column:span 8}.span-2xl-9{grid-column:span 9}.span-2xl-10{grid-column:span 10}.span-2xl-11{grid-column:span 11}.span-2xl-12{grid-column:span 12}}.flex{display:flex;flex-direction:column;gap:var(--rh-space-lg,16px)}.flex-row{flex-direction:row}.flex-column{flex-direction:column}@media (min-width:768px){.flex-md-row{flex-direction:row}.flex-md-column{flex-direction:column}}.typography-h1{font-size:var(--rh-font-size-heading-2xl,3rem)}.typography-h2{font-size:var(--rh-font-size-heading-xl,2.5rem)}.typography-h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}.typography-h4{font-size:var(--rh-font-size-heading-md,1.75rem)}.typography-h5{font-size:var(--rh-font-size-heading-sm,1.5rem)}.typography-h6{font-size:var(--rh-font-size-heading-xs,1.25rem)}.content section{padding:0}.content h1,.content h2,.content h3,.content h4,.content h5,.content h6{margin:var(--rh-space-lg,16px) 0}.sr-only{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0}.list-unstyled{list-style:none;padding-left:0}.tooltip-content{align-items:center;display:flex;font-family:Red Hat Text;justify-content:center;text-transform:none}.tooltip-content .check-icon{margin-left:var(--rh-space-md,8px)}.doc-image-link{display:inline-block;text-decoration:none}.modal-img{display:block;width:100%}.modal-helper-text{margin-top:.5rem;text-align:center}.modal-helper-text a{color:#000;cursor:pointer}.modal-helper-text a:hover{text-decoration:underline}.modal-helper-text a:after{content:"⿻";margin-left:.25rem}pf-modal.pf-img-modal{--pf-c-modal-box--MaxHeight:90vh;overflow-y:scroll}pf-modal.pf-img-modal::part(close-button){background-color:#fff;border-radius:50%;color:#000;margin-right:-2rem;margin-top:-2rem}pf-modal.pf-img-modal::part(close-button):hover{opacity:.7}h2.truste-title{line-height:normal;margin-top:0}rh-alert p[slot=header]{color:#002952}@media (width < 992px){html:has(nav.mobile-nav .mobile-nav-wrapper){scroll-behavior:smooth;scroll-padding-top:4rem}html:has(nav.mobile-nav .mobile-jump-links){scroll-padding-top:7rem}html:has(nav.mobile-nav.hide-mobile-nav){scroll-padding-top:2rem}}.highlight{background:#fff4cc;color:#000}</style>
<style>rh-alert[data-v-84359384]{width:100%}</style>
<style>.search-btn[data-v-edc0d12c]{align-items:center;background-color:var(--rh-color-canvas-black,#151515);border:3px solid var(--rh-color-canvas-black,#151515);cursor:pointer;display:flex;flex-direction:column;height:100%;justify-content:center;outline:none;padding:14px var(--rh-space-md,8px)}.search-btn[data-v-edc0d12c]:focus{border-top:3px solid var(--rh-color-accent-brand-on-light,#e00);outline:2px dotted var(--rh-color-white,#fff)}.search-btn .search-icon[data-v-edc0d12c]{height:26px;padding:2px 0 var(--rh-space-xs,4px);width:20px}.search-btn .search-icon[data-v-edc0d12c],.search-icon-helper-text[data-v-edc0d12c]{color:var(--rh-color-white,#fff)}.search-mobile[data-v-edc0d12c]{margin-bottom:var(--rh-space-2xl,32px)}.search-mobile form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto}.search-box[data-v-edc0d12c]{width:35rem}nav[data-v-edc0d12c]{background-color:#151515;justify-content:space-between;width:100%}a[data-v-edc0d12c],a[data-v-edc0d12c]:visited{color:#fff;display:inline-block;font-size:var(--rh-font-size-body-text-md,1rem)}.skip-link[class][class][data-v-edc0d12c]{font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class][data-v-edc0d12c]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}.visually-hidden[data-v-edc0d12c]{border:1px solid #06c;height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);white-space:nowrap}h3[data-v-edc0d12c]{color:#464646;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-lg,1.125rem)}.language-picker[data-v-edc0d12c]{align-items:center;background-color:#fff;display:flex;flex-direction:column;padding:var(--rh-space-xl,24px);width:100%}.language-picker h3[data-v-edc0d12c]{margin:0;padding:0 1rem 1rem}.language-picker ul[data-v-edc0d12c]{margin:0;padding:0}.language-picker a[data-v-edc0d12c]{color:#06c}.language-picker li[data-v-edc0d12c]{list-style:none}.language-dropdown[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:block!important;position:absolute;right:0;width:100%;z-index:104}.pfe-navigation.pfe-navigation--processed>[slot=secondary-links][data-v-edc0d12c]{height:auto;overflow:visible;visibility:visible;width:auto}.upper-navigation[data-v-edc0d12c]{padding:0 var(--rh-space-2xl,32px)}.upper-nav-container[data-v-edc0d12c]{border-bottom:1px solid #404040;margin:0}.upper-nav-hidden[data-v-edc0d12c]:not(:focus):not(:active){clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.upper-nav-menu[data-v-edc0d12c]{align-items:center;display:flex;justify-content:flex-end;line-height:1.444;list-style:none;margin-bottom:0;margin-top:0;padding-left:0}.upper-nav-menu[data-v-edc0d12c],.upper-nav-menu>li[data-v-edc0d12c]{position:relative}.upper-nav-menu>li:not(:first-child)>a[data-v-edc0d12c]:before,.upper-nav-menu>li:not(:first-child)>button[data-v-edc0d12c]:before{background-color:#404040;content:"";height:40%;left:0;position:absolute;top:30%;width:1px}li[data-v-edc0d12c]{display:list-item;margin:0;padding:0;text-align:-webkit-match-parent}.upper-nav-menu button.upper-nav-links[data-v-edc0d12c]{border:0;border-top:3px solid transparent;cursor:pointer;line-height:1.444}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]{outline-color:#151515}.upper-nav-menu button.upper-nav-links[aria-expanded=true] .upper-nav-arrow[data-v-edc0d12c]{filter:invert(0) sepia(2%) saturate(21%) hue-rotate(257deg) brightness(108%) contrast(100%);transform:rotate(270deg)}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]:before{display:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]{background-color:var(--pfe-navigation--BackgroundColor,var(--pfe-theme--color--surface--darkest,#151515));border-top:3px solid transparent;color:#fff;display:block;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);outline:none;padding:12px 12px 14px;text-decoration:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:hover{border-top-color:#b8bbbe}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within{outline:1px dashed var(--rh-color-white,#fff);outline-offset:-1px}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within:before{display:none}.upper-nav-dropdown-container[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:none;padding:5px 30px 24px;position:absolute;right:0;top:100%;width:500px;z-index:105}.upper-nav-dropdown-container>ul[data-v-edc0d12c]{-moz-column-count:2;column-count:2;list-style-type:none;padding:0;width:auto}.upper-nav-dropdown-container>ul li[data-v-edc0d12c]{color:#151515;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);list-style-type:none;margin-bottom:0}.upper-nav-dropdown-container>ul li span[data-v-edc0d12c]{font-weight:var(--rh-font-weight-body-text-medium,500)}.upper-nav-dropdown-container>ul ul[data-v-edc0d12c]{padding-left:0;padding-top:9px}.upper-nav-dropdown-container>ul>li[data-v-edc0d12c]{padding-top:19px;-moz-column-break-inside:avoid;break-inside:avoid}.upper-nav-dropdown-container>ul>li>ul>li[data-v-edc0d12c]{line-height:1.45;padding:4px 0}.upper-nav-menu .upper-nav-arrow[data-v-edc0d12c]{display:inline-block;filter:invert(100%) sepia(8%) saturate(7%) hue-rotate(1turn) brightness(100%) contrast(93%);height:18px;margin-left:5px;transform:rotate(90deg);vertical-align:middle;width:8px}#pfe-navigation__secondary-links .show[data-v-edc0d12c],.upper-navigation .show[data-v-edc0d12c]{display:block}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:active,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:focus,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:hover{background-color:#fff;color:#151515}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]{background-color:#fff;border-top-color:#b8bbbe;color:#000;position:relative;z-index:1}.upper-nav-dropdown-container>ul a[data-v-edc0d12c]{color:var(--rh-color-accent-base-on-light,#06c);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;text-decoration:none}.pfe-navigation__search[data-v-edc0d12c]{background-color:var(--rh-color-white,#fff)}.pfe-navigation__search form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto;max-width:992px}pfe-navigation [slot=secondary-links] .buttons[data-v-edc0d12c]{display:flex;flex-wrap:wrap;gap:var(--rh-space-md,8px);margin-top:4px}pfe-navigation [slot=secondary-links] .buttons a[data-v-edc0d12c]{border:1px solid #d2d2d2;border-radius:3px;color:#06c;cursor:pointer;flex-basis:calc(50% - 5px);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-weight:var(--rh-font-weight-code-regular,400);padding:1em;text-align:center;text-decoration:none}pfe-navigation [slot=secondary-links] .mobile-lang-select[data-v-edc0d12c]{border:1px solid #d2d2d2;border-bottom-color:#3c3f42;cursor:pointer;display:flex;margin:3rem 0;position:relative}pfe-navigation [slot=secondary-links] .mobile-lang-select label[data-v-edc0d12c]{bottom:100%;color:#000;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;font-weight:500;margin-bottom:5px;position:absolute}pfe-navigation [slot=secondary-links] .mobile-lang-select select[data-v-edc0d12c]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-style:none;color:#000;flex-basis:100%;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:16px;line-height:24px;padding:6px 24px 6px 8px}select[data-v-edc0d12c]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position:98% 50%;background-repeat:no-repeat}#inputLabel[data-v-edc0d12c]{align-items:center;display:flex;position:relative}#inputLabel form[data-v-edc0d12c]{width:100%}.input-box[data-v-edc0d12c]{font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 8px;width:100%}.input-box[data-v-edc0d12c]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-box[data-v-edc0d12c]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}@media(max-width:960px){.search-box[data-v-edc0d12c]{width:28rem}}@media (max-width:768px){.right-navigation[data-v-edc0d12c],.upper-navigation[data-v-edc0d12c]{display:none}}@media (min-width:767px){.pfe-navigation__search form[data-v-edc0d12c]{padding:var(--rh-space-2xl,32px) 0}}</style>
<style>.element-invisible,.sr-only,.visually-hidden{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;white-space:nowrap}@keyframes reveal-nav{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@keyframes reveal-nav-parts{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}1%{visibility:visible}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@media print{.pfe-navigation__menu,pfe-navigation [slot]{display:none!important}}pfe-navigation{--pfe-broadcasted--text:var(--pfe-theme--color--text,#151515);--pfe-broadcasted--text--muted:var(--pfe-theme--color--text--muted,#6a6e73);--pfe-broadcasted--link:var(--pfe-theme--color--link,#06c);--pfe-broadcasted--link--hover:var(--pfe-theme--color--link--hover,#004080);--pfe-broadcasted--link--focus:var(--pfe-theme--color--link--focus,#004080);--pfe-broadcasted--link--visited:var(--pfe-theme--color--link--visited,#6753ac);--pfe-broadcasted--link-decoration:var(--pfe-theme--link-decoration,none);--pfe-broadcasted--link-decoration--hover:var(--pfe-theme--link-decoration--hover,underline);--pfe-broadcasted--link-decoration--focus:var(--pfe-theme--link-decoration--focus,underline);--pfe-broadcasted--link-decoration--visited:var(--pfe-theme--link-decoration--visited,none)}@supports (display:grid){pfe-navigation{animation:reveal-nav .1618s 4s 1 forwards;max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}pfe-navigation>*{animation:reveal-nav-parts .1618s 4s 1 forwards;opacity:0;transition:opacity .1618s ease-in-out;transition:opacity var(--pfe-reveal-duration,.1618s) ease-in-out;visibility:hidden}}pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed>*{animation:none;opacity:1;visibility:visible}pfe-navigation pfe-primary-detail{display:none}pfe-navigation[pfelement]{display:block}pfe-navigation-dropdown{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515)}#pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],#pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],#pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class],pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class]{display:none}#pfe-navigation,#pfe-navigation *,pfe-navigation,pfe-navigation *{box-sizing:border-box}#pfe-navigation [pfelement] .pfe-navigation__log-in-link,pfe-navigation [pfelement] .pfe-navigation__log-in-link{display:none}#pfe-navigation,pfe-navigation{align-items:stretch;background:#151515;background:var(--pfe-navigation__nav-bar--Background,#151515);color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;font-family:Red Hat Text,RedHatText,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamily,Red Hat Text,RedHatText,Arial,Helvetica,sans-serif);font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);height:auto;line-height:1.5;margin:0;max-width:9999em;min-height:72px;min-height:var(--pfe-navigation__nav-bar--Height,72px);padding:0 16px;position:relative;z-index:95;z-index:var(--pfe-navigation--ZIndex,var(--pfe-theme--zindex--navigation,95))}@media (min-width:768px){#pfe-navigation,pfe-navigation{flex-wrap:wrap;margin:0;max-width:9999em;padding:0 16px}}@media (min-width:1200px){#pfe-navigation,pfe-navigation{margin:0 auto;padding:0 32px}}#pfe-navigation .pfe-navigation__dropdown,#pfe-navigation pfe-navigation-dropdown,pfe-navigation .pfe-navigation__dropdown,pfe-navigation pfe-navigation-dropdown{display:none}#pfe-navigation>[slot=account],#pfe-navigation>[slot=search],#pfe-navigation>[slot=secondary-links],pfe-navigation>[slot=account],pfe-navigation>[slot=search],pfe-navigation>[slot=secondary-links]{height:0;overflow:hidden;visibility:hidden;width:0}@media (min-width:768px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{align-items:stretch;display:flex;flex-wrap:wrap}}@media (min-width:992px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{flex-wrap:nowrap}}#pfe-navigation .pfe-navigation__logo-wrapper,pfe-navigation .pfe-navigation__logo-wrapper{align-items:center;display:flex;justify-content:flex-start;margin:0;min-width:150px;padding:10px 16px 10px 0}@media (min-width:768px){.pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:auto}}.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:0}#pfe-navigation .pfe-navigation__logo-link,pfe-navigation .pfe-navigation__logo-link{border-radius:3px;display:block;margin-left:-8px;outline:0;padding:6px 8px;position:relative}#pfe-navigation .pfe-navigation__logo-link:focus,pfe-navigation .pfe-navigation__logo-link:focus{outline:0}#pfe-navigation .pfe-navigation__logo-link:focus:after,pfe-navigation .pfe-navigation__logo-link:focus:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:block;height:auto;width:100%}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{height:40px;height:var(--pfe-navigation__logo--height,40px);width:auto}}@media print{#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:none}}#pfe-navigation .pfe-navigation__logo-image:only-child,pfe-navigation .pfe-navigation__logo-image:only-child{display:block}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small{height:32px;height:var(--pfe-navigation__logo--height,32px)}}@media print{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen{display:none!important}}@media screen{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print{display:none!important}}#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print{display:inline-block!important}#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;justify-content:center;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{display:none!important}}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__fallback-links a[class]:focus,#pfe-navigation .pfe-navigation__fallback-links a[class]:hover,#pfe-navigation .pfe-navigation__log-in-link[class]:focus,#pfe-navigation .pfe-navigation__log-in-link[class]:hover,#pfe-navigation .pfe-navigation__menu-link[class]:focus,#pfe-navigation .pfe-navigation__menu-link[class]:hover,#pfe-navigation .pfe-navigation__secondary-link[class]:focus,#pfe-navigation .pfe-navigation__secondary-link[class]:hover,pfe-navigation .pfe-navigation__fallback-links a[class]:focus,pfe-navigation .pfe-navigation__fallback-links a[class]:hover,pfe-navigation .pfe-navigation__log-in-link[class]:focus,pfe-navigation .pfe-navigation__log-in-link[class]:hover,pfe-navigation .pfe-navigation__menu-link[class]:focus,pfe-navigation .pfe-navigation__menu-link[class]:hover,pfe-navigation .pfe-navigation__secondary-link[class]:focus,pfe-navigation .pfe-navigation__secondary-link[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__secondary-link:focus{outline:0}#pfe-navigation .pfe-navigation__fallback-links a:focus:after,#pfe-navigation .pfe-navigation__log-in-link:focus:after,#pfe-navigation .pfe-navigation__menu-link:focus:after,#pfe-navigation .pfe-navigation__secondary-link:focus:after,pfe-navigation .pfe-navigation__fallback-links a:focus:after,pfe-navigation .pfe-navigation__log-in-link:focus:after,pfe-navigation .pfe-navigation__menu-link:focus:after,pfe-navigation .pfe-navigation__secondary-link:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{pointer-events:none}#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding:0 16px 0 0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{display:block;height:18px}#pfe-navigation .pfe-navigation__fallback-links a[class],#pfe-navigation .pfe-navigation__fallback-links a[href],#pfe-navigation .pfe-navigation__log-in-link[class],#pfe-navigation .pfe-navigation__log-in-link[href],#pfe-navigation .pfe-navigation__menu-link[class],#pfe-navigation .pfe-navigation__menu-link[href],#pfe-navigation .pfe-navigation__secondary-link[class],#pfe-navigation .pfe-navigation__secondary-link[href],pfe-navigation .pfe-navigation__fallback-links a[class],pfe-navigation .pfe-navigation__fallback-links a[href],pfe-navigation .pfe-navigation__log-in-link[class],pfe-navigation .pfe-navigation__log-in-link[href],pfe-navigation .pfe-navigation__menu-link[class],pfe-navigation .pfe-navigation__menu-link[href],pfe-navigation .pfe-navigation__secondary-link[class],pfe-navigation .pfe-navigation__secondary-link[href]{align-items:center;justify-content:center}#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%;--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none!important}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation [slot=account]>a[href]:focus,#pfe-navigation [slot=account]>a[href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation [slot=account]>a[href]:focus,pfe-navigation [slot=account]>a[href]:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation [slot=account]>a[href]:focus,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation [slot=account]>a[href]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle:focus:after,#pfe-navigation [slot=account]>a[href]:focus:after,pfe-navigation .pfe-navigation__account-toggle:focus:after,pfe-navigation [slot=account]>a[href]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{pointer-events:none}@supports (display:grid){#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__account-toggle[class]:focus,#pfe-navigation .pfe-navigation__account-toggle[class]:hover,#pfe-navigation [slot=account]>a[href][class]:focus,#pfe-navigation [slot=account]>a[href][class]:hover,pfe-navigation .pfe-navigation__account-toggle[class]:focus,pfe-navigation .pfe-navigation__account-toggle[class]:hover,pfe-navigation [slot=account]>a[href][class]:focus,pfe-navigation [slot=account]>a[href][class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none}}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{--pfe-icon--size:18px;padding:2px 0 4px}@media (min-width:768px){#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{padding-right:0}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],#pfe-navigation [slot=account]>a[href][href]:focus,#pfe-navigation [slot=account]>a[href][href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation [slot=account]>a[href][href]:focus,pfe-navigation [slot=account]>a[href][href]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after{border:1px dashed #151515;border:1px dashed var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{font-size:inherit;list-style:none;margin:0;padding:0}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{align-items:stretch;display:flex}}#pfe-navigation .pfe-navigation__fallback-links li,#pfe-navigation .pfe-navigation__menu li,pfe-navigation .pfe-navigation__fallback-links li,pfe-navigation .pfe-navigation__menu li{font-size:inherit;margin:0;padding:0}#pfe-navigation .pfe-navigation__fallback-links li:before,#pfe-navigation .pfe-navigation__menu li:before,pfe-navigation .pfe-navigation__fallback-links li:before,pfe-navigation .pfe-navigation__menu li:before{content:none}#pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__fallback-links{margin-left:auto}#pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__menu-link{display:flex;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);white-space:nowrap}#pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed{display:block;padding:0}#pfe-navigation.pfe-navigation--processed:before,pfe-navigation.pfe-navigation--processed:before{content:none}#pfe-navigation.pfe-navigation--processed>[slot=account],#pfe-navigation.pfe-navigation--processed>[slot=search],#pfe-navigation.pfe-navigation--processed>[slot=secondary-links],pfe-navigation.pfe-navigation--processed>[slot=account],pfe-navigation.pfe-navigation--processed>[slot=search],pfe-navigation.pfe-navigation--processed>[slot=secondary-links]{height:auto;overflow:visible;visibility:visible;width:auto}#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,#pfe-navigation.pfe-navigation--processed>[slot],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed>[slot]{animation:none;opacity:1}#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{display:block;height:auto;list-style:none;margin:0 0 8px;padding:0;width:auto}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0 0 8px}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{display:none!important}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{pointer-events:none}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding:0 16px 0 0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{display:block;height:18px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed #fff;border:1px dashed var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{box-shadow:none}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{background:0 0;box-shadow:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column{position:relative}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper{display:block}#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{height:0;transition:height .25s ease-in-out;transition:var(--pfe-navigation--accordion-transition,height .25s ease-in-out)}@media (prefers-reduced-motion){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{transition:none}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:absolute;right:0;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:auto}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:0}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper{left:100vw;left:calc(100vw - 32px);left:calc(100vw - var(--pfe-navigation__mobile-dropdown--PaddingHorizontal,32px));position:absolute;top:0;width:100vw}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false],pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false]{height:100vh;height:calc(100vh - 72px);height:calc(100vh - var(--pfe-navigation__nav-bar--Height,72px));overflow-y:scroll}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 64px24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px) var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a{border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));display:inline-block}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6{margin:32px 0 .75em;margin:var(--pfe-navigation--gutter,32px) 0 .75em;padding:0;-moz-column-break-inside:avoid;break-inside:avoid;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);font-family:Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamilyHeadline,Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif);font-size:1.125rem;font-size:var(--pf-global--FontSize--lg,1.125rem);font-weight:500}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a{border:1px solid transparent;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li{margin:0 0 16px;-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--BackgroundColor,#e00);--pfe-cta--BackgroundColor--hover:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00);--pfe-theme--ui--border-width:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00)}pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul{list-style:none;margin:0;padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515);-moz-column-count:auto;column-count:auto;display:block;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);gap:0;margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:flex;flex-wrap:wrap;padding-bottom:32px;padding-top:32px}@supports (display:grid){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{display:grid;gap:32px;gap:var(--pfe-navigation--gutter,32px);grid-auto-flow:row;grid-template-columns:repeat(4,minmax(0,1fr))}}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:block;gap:0;margin-left:-16px;margin-right:-16px;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{transition-delay:0s;visibility:visible}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px;-moz-column-break-inside:avoid;break-inside:avoid}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid{max-width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown{background:#fff}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:32px 64px;padding:32px var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px)}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container{margin:0;padding:0;width:auto}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class]{padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown{visibility:hidden}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{padding:0}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:0 1px 2px rgba(0,0,0,.12);box-shadow:var(--pfe-navigation__dropdown--BoxShadow,0 1px 2px rgba(0,0,0,.12));max-width:100%;min-width:13em;padding:0 32px;position:absolute;top:100%}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:none;max-width:100%;position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{right:0}}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{width:100%}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{left:0;position:absolute;right:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{position:static}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown{width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles{padding-left:16px;padding-right:16px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form{align-items:center;display:flex}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{padding:10px;transition:box-shadow .2s}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{border:1px solid #f0f0f0;border-bottom-color:#8b8e91;color:#717579;flex-basis:0%;flex-grow:1;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);margin-right:8px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button{background-color:#e00;border:1px solid #e00;border-radius:2px;color:#fff;flex-basis:auto;flex-grow:0;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after{border:1px dashed #000;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{border-bottom:1px solid #d2d2d2;border-bottom:var(--pfe-navigation__dropdown--separator--Border,1px solid var(--pfe-theme--color--ui--border--lighter,#d2d2d2));display:block}@media (min-width:768px){#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:none}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__site-switcher__back-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:block}#pfe-navigation .pfe-navigation__site-switcher__back-button,pfe-navigation .pfe-navigation__site-switcher__back-button{background-color:transparent;border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);padding:21px 21px 21px 45px;position:relative;text-align:left;width:100%}#pfe-navigation .pfe-navigation__site-switcher__back-button:before,pfe-navigation .pfe-navigation__site-switcher__back-button:before{border:2px solid #06c;border:2px solid var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));border-right:0;border-top:0;content:"";display:block;height:8px;left:35px;position:absolute;right:auto;top:27px;transform:rotate(45deg);transform-origin:left top;width:8px}#pfe-navigation .pfe-navigation__site-switcher__back-button:focus,#pfe-navigation .pfe-navigation__site-switcher__back-button:hover,pfe-navigation .pfe-navigation__site-switcher__back-button:focus,pfe-navigation .pfe-navigation__site-switcher__back-button:hover{border:1px dashed #151515;border-top:1px dashed #151515;border:1px dashed var(--pfe-navigation__dropdown--Color,#151515);color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);outline:0}#pfe-navigation.pfe-navigation--processed site-switcher,pfe-navigation.pfe-navigation--processed site-switcher{-moz-columns:auto;columns:auto;display:block}#pfe-navigation.pfe-navigation--stuck,pfe-navigation.pfe-navigation--stuck{left:0;position:fixed;top:0;width:100%;z-index:95;z-index:var(--pfe-theme--zindex--navigation,95)}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner{opacity:1!important}#pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown{display:none!important}#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown{display:block!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item{display:block}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus{outline:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown{display:flex;flex-wrap:wrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope{flex-basis:25%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope{flex-basis:100%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope{margin-right:16px}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{display:flex;flex-direction:column;flex-wrap:nowrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{flex-basis:auto}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a{color:#fff!important;justify-content:center!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true]{color:#151515!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon{display:none!important}[id=pfe-navigation__account-dropdown][class][class]{display:block;height:auto;left:0;padding:0;position:absolute;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px);width:100%}[id=pfe-navigation__account-dropdown].pfe-navigation__dropdown-wrapper--invisible[class]{display:none}.pfe-navigation__dropdown-wrapper{overflow:hidden}@media (min-width:768px){.pfe-navigation__custom-dropdown--single-column{min-width:25em}}.pfe-navigation--collapse-secondary-links .pfe-navigation__custom-dropdown--single-column{min-width:0}.secondary-link__icon-wrapper{align-items:center;display:flex;justify-content:center}.secondary-link__alert-count{background:#06c;background:var(--pfe-navigation__nav-bar--alert-color,var(--pfe-theme--color--link,#06c));border-radius:20px;color:#fff;color:var(--pfe-navigation__nav-bar--Color--on-highlight,var(--pfe-theme--color--text--on-saturated,#fff));display:block;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);line-height:20px;margin:0 4px 0 2px;min-width:23px;overflow:hidden;padding:0 8px}.secondary-link__alert-count:empty{display:none}#pfe-navigation__1x-skip-links{left:0;position:absolute;top:0}#pfe-navigation__1x-skip-links,#pfe-navigation__1x-skip-links li{height:0;list-style:none;margin:0;padding:0;width:0}.skip-link[class][class]{font-size:.875rem;font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}pfe-navigation pfe-navigation-account[slot=account]{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));width:100%}</style>
<style>:host([size=sm]) #container[data-v-8589d091]{--_size:var(--pf-global--icon--FontSize--sm,12px)}.content-wrapper[data-v-8589d091]{height:auto;margin:0 auto;min-height:46vh}.content[data-v-8589d091]{max-width:1000px}#left-content[data-v-8589d091]{max-width:330px;z-index:1}.line-below-chp[data-v-8589d091]{margin:var(--rh-space-xl,24px) 0 var(--rh-space-3xl,48px)}.toc-container[data-v-8589d091]{border-right:1px solid var(--rh-color-gray-30,#c7c7c7);min-height:100vh;position:sticky;top:0;transition:transform .3s ease-in-out}nav#toc[data-v-8589d091]{height:auto;overflow-y:auto;padding-bottom:var(--rh-space-2xl,32px)}.max-height-85[data-v-8589d091]{max-height:85vh}.max-height-75[data-v-8589d091]{max-height:75vh}.toc-filter[data-v-8589d091]{background-color:#fff;padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px);position:sticky;top:-1px;width:100%;z-index:1}#text[data-v-8589d091],.toc-filter[data-v-8589d091]{align-items:center;display:flex}#text[data-v-8589d091]{flex:1;flex-direction:row}#search-icon[data-v-8589d091]{color:#151515;left:2.5rem;position:absolute;top:55%;transform:translateY(-50%)}pf-icon[data-v-8589d091]{--pf-icon--size:16px}#text:focus-within #icon[data-v-8589d091],#text:hover #icon[data-v-8589d091]{color:#151515}#text[data-v-8589d091]:after,#text[data-v-8589d091]:before{content:"";inset:0;pointer-events:none;position:absolute}#text-input[data-v-8589d091]:focus,#text-input:focus+#utilities[data-v-8589d091]{border-bottom:2px solid #06c;outline:none}#text-input[data-v-8589d091]{background-color:transparent;border:1px solid #f0f0f0;border-bottom-color:#8a8d90;color:#151515;font-family:inherit;font-size:100%;grid-area:text-input;line-height:1.5;overflow:hidden;padding:.375rem .25rem .375rem 2rem;position:relative;text-overflow:ellipsis;white-space:nowrap;width:100%}#utilities[data-v-8589d091]{align-items:center;border:1px solid #f0f0f0;border-bottom:1px solid #8a8d90;border-left:0;display:flex}#utilities rh-badge[data-v-8589d091]{border-radius:80px;font-weight:var(--rh-font-weight-heading-medium,500);--_background-color:#e0e0e0;margin-right:8px}#clear-button[data-v-8589d091]{--pf-c-button--PaddingTop:0.625rem;--pf-c-button--PaddingRight:.25rem;--pf-c-button--PaddingBottom:0.625rem;--pf-c-button--PaddingLeft:.25rem;margin-right:8px}#text-input.no-right-border[data-v-8589d091]{border-right:0}.btn-container[data-v-8589d091]{bottom:0;display:flex;justify-content:flex-end;padding:1rem;pointer-events:none;position:fixed;right:0;z-index:2}.top-scroll-btn[data-v-8589d091]{--pf-c-button--BorderRadius:64px;pointer-events:all}.focusable[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-interactive-blue,#06c)}.mobile-nav-wrapper[data-v-8589d091]{align-items:center;border-bottom:1px solid #c7c7c7;display:flex;height:auto;justify-content:space-between;padding:var(--rh-space-sm,.5rem)}.mobile-nav[data-v-8589d091]{align-items:center;background-color:var(--rh-color-bg-page,#fff);min-height:51px;position:sticky;top:0;z-index:5}.active-mobile-menu[data-v-8589d091]{color:#151515;padding-left:.5rem}.hidden[data-v-8589d091]{display:none}.mobile-nav-btn[data-v-8589d091]{background-color:transparent;border:none;font-family:inherit;font-size:.875rem;font-weight:500;margin:0;min-height:40px;min-width:40px}.border-right[data-v-8589d091]{border-right:1px solid #c7c7c7}.toc-focus-container[data-v-8589d091]{position:sticky;top:0;z-index:2}.toc-focus-btn[data-v-8589d091]{align-items:center;background-color:var(--rh-color-white,#fff);border:1px solid var(--rh-color-blue-50,#06c);border-radius:50%;cursor:pointer;display:flex;height:40px;justify-content:center;position:absolute;right:-20px;top:15px;width:40px}.toc-focus-btn[data-v-8589d091]:focus-visible,.toc-focus-btn[data-v-8589d091]:hover{background-color:var(--rh-color-blue-10,#e0f0ff);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2))}.toc-focus-btn[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-blue-50,#06c)}.toc-focus-btn-icon[data-v-8589d091]{color:var(--rh-color-blue-50,#06c)}.toc-wrapper[data-v-8589d091]{padding:0}.product-container[data-v-8589d091]{border-bottom:1px solid var(--rh-color-gray-30,#c7c7c7);padding:var(--rh-space-xl,24px) var(--rh-space-2xl,32px)}.product-container h1.product-title[data-v-8589d091]{font-size:var(--rh-font-size-code-xl,1.25rem);line-height:30px;margin-bottom:0;margin-top:0}.product-container .product-version[data-v-8589d091]{align-items:center;display:flex;flex-wrap:wrap;margin-top:var(--rh-space-lg,16px)}.product-version .version-label[data-v-8589d091]{color:var(--rh-color-canvas-black,#151515);font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:500}.product-version .version-select-dropdown[data-v-8589d091]{margin:var(--rh-space-md,8px) var(--rh-space-sm,6px);max-width:9.75rem;min-height:2rem;min-width:3rem;overflow:hidden;width:-moz-min-content;width:min-content;word-wrap:nowrap;-webkit-appearance:none;-moz-appearance:none;background:var(--rh-color-white,#fff);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position-x:85%;background-position-y:50%;background-repeat:no-repeat;border:1px solid var(--rh-color-gray-30,#c7c7c7);border-bottom:0;box-shadow:0 -1px 0 0 var(--rh-color-gray-60,#4d4d4d) inset;cursor:pointer;font-size:var(--rh-font-size-body-text-md,1rem);padding:var(--rh-space-md,8px);padding-right:24px;text-overflow:ellipsis}pf-popover[data-v-8589d091]{margin-top:var(--rh-space-md,8px);--pf-c-popover__arrow--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover__content--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover--BoxShadow:0px 4px 8px 0px #15151540;--pf-c-popover__title-text--Color:var(--rh-color-white,#fff);--pf-c-popover--MaxWidth:300px;--pf-c-popover--MinWidth:300px;--pf-c-popover--c-button--Top:20px;--pf-c-popover--c-button--Right:4px;--pf-c-button--m-plain--hover--Color:var(--rh-color-white,#fff)}pf-popover[data-v-8589d091]::part(content){padding:var(--rh-space-2xl,32px)}pf-popover[data-v-8589d091]::part(body){margin-top:var(--rh-space-lg,16px)}pf-popover[data-v-8589d091]::part(close-button){--pf-c-button--m-plain--focus--Color:var(--rh-color-gray-30,#c7c7c7);--pf-c-button--m-plain--Color:var(--rh-color-gray-30,#c7c7c7)}.popover-header-text[data-v-8589d091]{color:var(--rh-color-white,#fff);font-size:var(--rh-font-size-code-md,1rem);margin:0;max-width:80%;padding:0}.popover-body-link[data-v-8589d091]{color:var(--rh-color-blue-30,#92c5f9);text-decoration:none}.popover-trigger-btn[data-v-8589d091]{align-items:center;background:none;border:none;cursor:pointer;display:flex;justify-content:center}#first-button[data-v-8589d091]{width:80%}#second-button[data-v-8589d091]{text-align:right;width:20%}#toc-btn[data-v-8589d091]{text-align:left;width:100%}.toc-error[data-v-8589d091]{margin:0;max-width:100%}#layout label[data-v-8589d091]{font-weight:500}.page-layout-options[data-v-8589d091]{background-color:#fff;display:flex;flex-direction:column;padding-bottom:var(--rh-space-lg,16px)}.sticky-top[data-v-8589d091]{position:sticky;top:0}summary[data-v-8589d091]{cursor:pointer;list-style:none;position:relative}summary[data-v-8589d091]::-webkit-details-marker{display:none}details#jump-links-details .jump-links-heading[data-v-8589d091]{background-color:var(--rh-color-white,#fff);display:block;margin-top:var(--rh-space-lg,16px);padding:var(--rh-space-lg,16px) 0 0 var(--rh-space-xl,24px);position:sticky;top:0}details#jump-links-details .jump-links-heading[data-v-8589d091]:before{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;height:9px;left:2px;position:absolute;top:26px;transform:rotate(-135deg);width:9px}details#jump-links-details[open] .jump-links-heading[data-v-8589d091]:before{transform:rotate(135deg)}.table-of-contents>ol[data-v-8589d091]{list-style:none;margin:0;padding:0}nav.table-of-contents[data-v-8589d091]{z-index:1}nav.table-of-contents ol[data-v-8589d091]{list-style:none;margin:0;padding:0}#mobile-browse-docs[data-v-8589d091]{font-weight:var(--rh-font-weight-body-text-medium,500);padding-left:var(--rh-space-2xl,32px)}.docs-content-container[data-v-8589d091]{font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:1.6667;padding-left:6rem;padding-right:6rem;padding-top:var(--rh-space-3xl,4rem)}.chapter-title[data-v-8589d091]{font-family:Red Hat Display}h1.chapter-title[data-v-8589d091]{font-size:var(--rh-fontsize-heading-xl,2.25rem);line-height:46.8px;margin:0;padding:0}.chapter .section h4[data-v-8589d091]{font-size:24px;font-weight:400}.banner-wrapper[data-v-8589d091]{padding:3rem 6rem 0}.page-format-dropdown[data-v-8589d091]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#fff;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABtSURBVHgBhc4xCoAwDAXQxE6li0K76w0cPZqjHsEb6AlcHb2BR9ADdG7GmIKTWv0QSOAFPjrndgAo4TtHxszTD4JoVAhh1VoXiNgkUO+971Q8iGgxxlSy1jc3CGof39baWTrzNSOkkksEbG/oBGEJIn6gD3jAAAAAAElFTkSuQmCC");background-position:8.5rem;background-repeat:no-repeat;background-size:auto;border:1px solid #c7c7c7;box-shadow:inset 0 -1px 0 0 #4d4d4d;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-md,1rem);margin-top:var(--rh-space-xs,4px);max-width:168px;min-height:36px;min-width:168px;overflow:hidden;padding:0 var(--rh-space-xl,24px) 0 var(--rh-space-md,8px);text-overflow:ellipsis;white-space:nowrap}.content-format-selectors[data-v-8589d091]{color:#151515;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:var(--rh-font-weight-body-text-medium,500);margin-right:var(--rh-space-2xl,32px);max-width:250px;min-width:250px;padding-top:var(--rh-space-2xl,32px)}.chapter .section .simpara[data-v-8589d091],.chapter .section p[data-v-8589d091]{font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:30px}#toggle-focus-mode[data-v-8589d091]{padding-right:var(--rh-space-lg,1rem)}@keyframes slideaway-left-8589d091{0%{display:block}to{opacity:0;transform:translateX(-40px)}}@keyframes slideaway-right-8589d091{0%{display:block}to{opacity:0;transform:translateX(40px)}}@keyframes enter-left-8589d091{0%{display:none;transform:translateX(-40px)}to{opacity:1}}@keyframes enter-right-8589d091{0%{display:none;transform:translateX(40px)}to{opacity:1}}.hide-left[data-v-8589d091]{animation:slideaway-left-8589d091 .2s;display:none}.enter-left[data-v-8589d091]{animation:enter-left-8589d091 .3s;border-right:none;display:block}.enter-right[data-v-8589d091]{animation:enter-right-8589d091 .3s;display:block}.hide-right[data-v-8589d091]{animation:slideaway-right-8589d091 .2s;display:none}.toc-container.enter-toc-container-left[data-v-8589d091]{transform:translateX(-85%)}.alert-section[data-v-8589d091]{padding-bottom:3rem}rh-alert[data-v-8589d091]{width:auto}@media (min-width:992px){#mobile-nav[data-v-8589d091],#toc-list-mobile[data-v-8589d091]{display:none}}@media (min-width:992px) and (max-width:1400px){.docs-ocp-content-container[data-v-8589d091]{padding:var(--rh-space-4xl,64px) var(--rh-space-lg,16px) 0}}@media (width < 992px){#breadcrumbs[data-v-8589d091],.content-format-selectors[data-v-8589d091],.toc-container[data-v-8589d091]{display:none}#mobile-nav-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7}#toc-wrapper-mobile[data-v-8589d091]{padding:var(--rh-space-md,1.5rem)}.product-container[data-v-8589d091]{padding:var(--rh-space-2xl,32px) var(--rh-space-lg,16px)}.product-container.shrink-product-padding[data-v-8589d091]{padding:var(--rh-space-lg,16px)}.product-version .version-select-dropdown[data-v-8589d091]{margin:0 var(--rh-space-lg,16px)}#page-content-options-mobile[data-v-8589d091]{padding:var(--rh-space-lg,2rem)}label[for=page-format][data-v-8589d091],label[for=toggle-focus-mode][data-v-8589d091]{display:block}.page-format-dropdown[data-v-8589d091]{background-position:97%;max-width:100%}nav#mobile-toc-menu[data-v-8589d091]{max-height:50vh;overflow-y:scroll}.mobile-jump-links #first-button[data-v-8589d091]{width:100%}#jump-links-btn[data-v-8589d091]{text-align:left;width:100%}#mobile-jump-links-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7;padding:0 var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}.table-of-contents #browse-docs[data-v-8589d091]{margin-top:1rem;padding-top:var(--rh-space-md,1.5rem)}.mobile-nav[data-v-8589d091]{display:block}.hide-mobile-nav[data-v-8589d091],.mobile-nav[data-v-8589d091]{transition:transform .3s ease-in-out}.hide-mobile-nav[data-v-8589d091]{transform:translateY(-100%)}.docs-content-container[data-v-8589d091]{padding-left:1.25rem;padding-right:1.25rem;padding-top:var(--rh-space-xl,24px)}.banner-wrapper[data-v-8589d091]{padding:0 1rem}.toc-filter-mobile[data-v-8589d091]{align-items:center;display:flex;padding:var(--rh-space-lg,16px);width:100%}#text-input[data-v-8589d091]{padding-left:.5rem}.toc-filter[data-v-8589d091]{display:none}}@media (width <=576px){.content-format-selectors[data-v-8589d091]{display:none}}.informaltable[data-v-8589d091],.rhdocs .informaltable[data-v-8589d091],.rhdocs .table-contents[data-v-8589d091],.rhdocs .table-wrapper[data-v-8589d091],.table-contents[data-v-8589d091],.table-wrapper[data-v-8589d091]{max-height:var(--rh-table--maxHeight);overflow:auto}rh-table[data-v-8589d091]{display:block;margin:2rem 0;max-width:100%}.pvof-doc__wrapper[data-v-8589d091],.rhdocs[data-v-8589d091]{--rh-table--maxHeight:calc(100vh - 12.5rem)}</style>
<style>:is(rh-footer-block) a[data-v-97dd2752]{text-decoration:underline}</style>
<style>:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a{color:var(--rh-color-link-inline-on-dark,var(--rh-color-interactive-blue-lighter,#92c5f9));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:hover{color:var(--rh-color-link-inline-hover-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:is(:focus,:focus-within){color:var(--rh-color-link-inline-focus-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:visited{color:var(--rh-color-link-inline-visited-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a[slot^=logo]{display:block}:is(rh-footer) a[slot^=logo]>img{display:block;height:100%;height:var(--rh-size-icon-04,40px);width:auto}:is(rh-footer,rh-footer-universal,rh-global-footer) :is(h1,h2,h3,h4,h5,h6){font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);line-height:var(--rh-line-height-heading,1.3)}rh-footer [slot=links]:is(h1,h2,h3,h4,h5):nth-of-type(n+5){--_link-header-margin:calc(var(--rh-space-2xl, 32px) - var(--rh-space-lg, 16px))}rh-footer [slot^=links] a{gap:var(--rh-footer-links-gap,var(--rh-space-md,8px))}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] li{display:contents;margin:0;padding:0}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] a{color:var(--rh-color-text-primary-on-dark,#fff)!important;display:block;font-size:var(--rh-footer-link-font-size,var(--rh-font-size-body-text-sm,.875rem));width:-moz-fit-content;width:fit-content}:is(rh-footer-universal,rh-global-footer) [slot^=links] a{font-size:inherit}:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-lg,16px)}@media screen and (min-width:768px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-2xl,32px)}}@media screen and (min-width:1440px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-4xl,64px)}}rh-footer:not(:defined){background-color:var(--rh-color-surface-darker,#1f1f1f);display:grid;grid-template-areas:"footer" "global";grid-template-rows:1fr auto;min-height:var(--rh-footer-nojs-min-height,750px);width:100%}:is(rh-footer-universal,rh-global-footer):not(:defined):before{grid-area:global}rh-footer:not(:defined)>[slot=logo]{padding:var(--rh-space-2xl,32px) var(--_section-side-gap)}:is(rh-footer-universal,rh-global-footer):not(:defined)>*,rh-footer:not(:defined)>:not([slot=logo],:is(rh-footer-universal,rh-global-footer)){border:0;clip:rect(1px,1px,1px,1px);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}:is(rh-footer-universal,rh-global-footer):not(:defined){background-color:var(--rh-color-surface-darkest,#151515);display:block;min-height:176px;width:100%}rh-footer-universal rh-footer-copyright{grid-column:-1/1}</style>
<style>.status-legal .status-page-widget[data-v-5f538988]{display:block;margin:.5rem 0;width:11.3125rem;width:-moz-max-content;width:max-content}.status-page-widget[data-v-5f538988]{align-items:center;display:flex;flex-direction:row}.status-legal .status-page-widget .status-description[data-v-5f538988]{color:#ccc;font-weight:600;letter-spacing:.0125rem;line-height:1.5;margin-right:.5rem}.status-good[data-v-5f538988]{background-color:#3e8536}.status-critical[data-v-5f538988]{background-color:#a30100}.status-partial[data-v-5f538988]{background-color:#f5c12d}.status-maintentance[data-v-5f538988]{background-color:#316dc1}.status-minor[data-v-5f538988]{background-color:#b85c00}.status-description[data-v-5f538988]{color:#ccc;font-weight:500;letter-spacing:.2px;line-height:1.5}.current-status-indicator[data-v-5f538988]{border-radius:6px;display:inline-block;height:12px;margin:0 0 0 5px;width:12px}.current-status-indicator.small[data-v-5f538988]{border-radius:4px;display:inline-block;height:8px;margin:0 0 0 5px;width:8px}</style>
<style>.breadcrumbs[data-v-798f280c]{align-items:center;background-color:#f6f6f6;display:flex;gap:var(--rh-space-xl,24px);padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}nav[data-v-798f280c]{flex:1}ol[data-v-798f280c]{background-color:#f6f6f6;font-size:.875rem;list-style:none;margin:0;padding:0}li[data-v-798f280c]{color:#151515;display:inline}a[data-v-798f280c]:after{border-bottom-color:transparent;border-left-color:transparent;box-shadow:inset .25rem .25rem 0 .0625rem #8a8d8d;content:"";display:inline-block;height:1.07143em;margin:0 .5em;position:relative;right:0;top:.75em;transform:translateY(-.5em) rotate(135deg) scale(.5);width:1.07143em}</style>
<style>ol[data-v-fa0dae77]{margin:0;padding:0}li[data-v-fa0dae77],ol[data-v-fa0dae77],ul[data-v-fa0dae77]{list-style:none;margin:0}.chapter-title[data-v-fa0dae77]{font-size:1em}.sub-chapter-title[data-v-fa0dae77],.sub-chapter-title a[data-v-fa0dae77]{font-size:.875rem}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77],.heading[data-v-fa0dae77],.sub-nav .link[data-v-fa0dae77],.sub-nav .link .link[data-v-fa0dae77]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-fa0dae77]:hover,.link[data-v-fa0dae77]:hover,.sub-nav .link[data-v-fa0dae77]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}details[open]:first-of-type>.heading[data-v-fa0dae77]:after{transform:rotate(135deg)}.item[data-v-fa0dae77]{line-height:22px}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77]{color:var(--rh-color-text-primary-on-light,#151515)}.sub-nav[data-v-fa0dae77],.toc-wrapper[data-v-fa0dae77]{list-style:none;margin:0}.toc-wrapper[data-v-fa0dae77]{min-width:100%;padding:0}.sub-nav[data-v-fa0dae77]{font-size:1em;line-height:24px;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-fa0dae77]:hover{color:#151515}.active[data-v-fa0dae77]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.chapter-landing-page[data-v-fa0dae77]{font-weight:500}summary[data-v-fa0dae77]{cursor:pointer;list-style:none;position:relative}summary[data-v-fa0dae77]::-webkit-details-marker{display:none}@keyframes slideDown-fa0dae77{0%{height:0;opacity:0}to{height:var(--details-height-open,"100%");opacity:1}}html[data-v-fa0dae77]{--details-transition-time:400ms}details[data-v-fa0dae77]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-fa0dae77]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-fa0dae77]:after,details .heading[data-v-fa0dae77]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-fa0dae77]:after{height:8px;width:8px}</style>
<style>.item[data-v-b883c74f]{line-height:22px}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f]{color:var(--rh-color-text-primary-on-light,#151515)}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f],.heading[data-v-b883c74f],.sub-nav .link[data-v-b883c74f],.sub-nav .link .link[data-v-b883c74f]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-b883c74f]:hover,.link[data-v-b883c74f]:hover,.sub-nav .link[data-v-b883c74f]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}ol[data-v-b883c74f]{margin:0;padding:0}li[data-v-b883c74f],ol[data-v-b883c74f],ul[data-v-b883c74f]{list-style:none;margin:0}.chapter-title[data-v-b883c74f]{font-size:1em}.sub-nav[data-v-b883c74f]{font-size:1em;line-height:24px;list-style:none;margin:0;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-b883c74f]:hover{color:#151515}.active[data-v-b883c74f]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.sub-chapter-title[data-v-b883c74f],.sub-chapter-title a[data-v-b883c74f]{font-size:.875rem}summary[data-v-b883c74f]{cursor:pointer;list-style:none;position:relative}summary[data-v-b883c74f]::-webkit-details-marker{display:none}html[data-v-b883c74f]{--details-transition-time:400ms}.chapter-landing-page[data-v-b883c74f]{font-weight:500}details[open]:first-of-type>.heading[data-v-b883c74f]:after{transform:rotate(135deg)}details[data-v-b883c74f]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-b883c74f]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-b883c74f]:after,details .heading[data-v-b883c74f]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-b883c74f]:after{height:8px;width:8px}</style>
<style>.html-container[data-v-9c2a9ddb]{padding:2rem 1.5rem 0}rh-alert[data-v-9c2a9ddb]{color:#151515}@media (max-width:772px){.html-container[data-v-9c2a9ddb]{padding:3rem 1rem 0}}</style>
<style>.search-container[data-v-69710f44]{height:100%}.form-box[data-v-69710f44],.search-container[data-v-69710f44]{justify-content:center}.form-box[data-v-69710f44],.search-box[data-v-69710f44],.search-container[data-v-69710f44]{align-items:center;display:flex;width:100%}.search-box[data-v-69710f44]{justify-content:space-between;position:relative}ul[data-v-69710f44]{list-style-type:none}#search-list[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;box-shadow:0 4px 4px 0 #00000040;color:#151515;display:block;left:0;margin:0;padding:0;position:absolute;top:37px;width:100%;z-index:200}#search-list li[data-v-69710f44]{align-items:center;display:flex;justify-content:space-between;padding:.75rem}#search-list .active[data-v-69710f44],#search-list li[data-v-69710f44]:hover{background:#f0f0f0}.group-title[data-v-69710f44]{border-top:1px solid #4d4d4d;color:#4d4d4d;cursor:default;font-size:12px;font-weight:400;pointer-events:none}.group-title[data-v-69710f44],.group-title[data-v-69710f44]:hover{background:#fff}.search-item-text-elipsis[data-v-69710f44]{display:inline-block;max-width:48%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.search-item-text[data-v-69710f44]{padding-left:1.75rem}.search-item-chip[data-v-69710f44]{float:right}.search-product-version[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;border-radius:3px;font-size:1rem;font-weight:400;line-height:24px}.search-icon-form[data-v-69710f44]{color:var(--rh-color-gray-50,#707070);left:12px;position:absolute}.input-search-box[data-v-69710f44]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 40px;width:100%}.input-clear-btn[data-v-69710f44]{align-items:center;background-color:transparent;border:none;display:flex;height:36px;justify-content:center;margin-right:-30px;outline:none;transform:translateX(-30px)}.input-clear-btn[data-v-69710f44]:focus{border:1px solid var(--rh-color-accent-base-on-light,#06c)}.input-clear-btn:focus .input-clear-icon[data-v-69710f44]{color:var(--rh-color-canvas-black,#151515)}.input-clear-icon[data-v-69710f44]{color:#6b6e72;cursor:pointer}.input-clear-icon[data-v-69710f44]:hover{color:var(--rh-color-canvas-black,#151515)}.form-submit-btn[data-v-69710f44]::part(button){align-items:center;background-color:var(--rh-color-gray-20,#e0e0e0);border-radius:0;display:flex;height:36px;justify-content:center;--_default-border-color:var(--rh-color-gray-20,#e0e0e0)}.input-close-btn[data-v-69710f44]{background:none;border:none;cursor:pointer;margin:0 var(--rh-space-lg,16px)}.input-close-icon[data-v-69710f44]{color:var(--rh-color-white,#fff)}@media (max-width:992px){.form-box[data-v-69710f44]{gap:var(--rh-space-md,8px);margin:auto;width:100%}.input-search-box[data-v-69710f44]{border:1px solid var(--rh-color-gray-30,#c7c7c7)}.input-search-box[data-v-69710f44]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-search-box[data-v-69710f44]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.search-item-text-elipsis[data-v-69710f44]{max-width:60%}}@media (max-width:767px){.input-close-btn[data-v-69710f44]{display:none}.search-container[data-v-69710f44]{border:1px solid #f0f0f0}}</style>
<link rel="stylesheet" href="/_nuxt/entry.DNAluCmw.css" integrity="sha384-FnrZajt9k3u4tri3ClqikI96k+jP7kyrvgKKgdzBr5Y8CQEi3gusKE0+eMSLvGxm">
<link rel="stylesheet" href="/_nuxt/SearchAutocomplete.DkrJaF8R.css" integrity="sha384-Zw8gf6w7SrpWDmknvrab5QanIN+DSJRS/bPB9/lgDkhR7JhDmG/VF++MTMKU8mKB">
<link rel="stylesheet" href="/_nuxt/Breadcrumbs.BLkLxUMB.css" integrity="sha384-f6iEfCywVoZB0/hIKTRaxywtS21KzhBx2JOI/uVjjU9aqFcP7X9cqLH29w2HQvLe">
<link rel="stylesheet" href="/_nuxt/Alert.fTkXFs3h.css" integrity="sha384-yFMpT5E64LAQi3qJ10AJJ1oOH3DrI68OvLSjSivjNCQXZ25pmFxlPavPQ0TEyEpq">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C3PvZR0C.js" integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ds9UYxCD.js" integrity="sha384-PFyBx6Pvk48yXM+prD4CDErW/3HFtPEqORVyAch5qDvJSyubA93+vR4jsWGRQKZs">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BUXK7nH-.js" integrity="sha384-Kqf3r1QrD7+NOn9EuK/ba9sTBZjn7vLAjnCoRtq7IKz+QV0JUUBFf1Snf1yVkkgr">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BxBriHwM.js" integrity="sha384-bejD6BN5N1iVRo5Ymn+LdVN0jvrnJTzgqgFD9xQ5+Yi46U6ff+s5W2AISzRWvJaM">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DB5Lt3x5.js" integrity="sha384-Ae/gV/4Dt4jnJApC0CWbckKJ7omq+W9Hb4jjdMyhxGJpwk6FlO7pGYMD3bPO/h1y">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D8BFaW0S.js" integrity="sha384-/m09v/yYk14L9Hra6/9jYtMTn2IdkKQvzpFPRQ5P/baRKwdZQN98873hqvwuYXFS">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/_58Q44fW.js" integrity="sha384-EdSd8jpnetO/BWDAc8C4SpQExZ7pYjMygNPvbLmiA1TaYsNUdVOqIIyOIzaErEeU">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DOCUiUcq.js" integrity="sha384-9H868K5q7MLzC8TSRXT3pVqDzsOVxZLYvUQ8cLGpHPZCFEyEJjnwSHE+/7FWrJPV">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CiTVMRA7.js" integrity="sha384-xBIJ2xO0t62/oREKqSxPtW1tRxKY+5YYXbGcJ0QR9IRM28JhL+53NOiAvVFn3rmF">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CR3F0y4K.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Bn-QuJwp.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/T_zvNmZe.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Ciddaed-.js">
<link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/Footer_Cloud.DpSdW8MR.svg">
<script type="module">
      import "@rhds/elements/rh-cta/rh-cta.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@cpelements/pfe-navigation/dist/pfe-navigation.min.js";
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">import "@rhds/elements/rh-footer/rh-footer.js"</script>
<link rel="canonical" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index">
<script type="module">
      import "@rhds/elements/rh-alert/rh-alert.js";
      import "@rhds/elements/rh-code-block/rh-code-block.js";
      import '@rhds/elements/rh-cta/rh-cta.js';
      import '@patternfly/elements/pf-switch/pf-switch.js';
      import '@cpelements/rh-table/dist/rh-table.js';
      import '@patternfly/pfe-clipboard/dist/pfe-clipboard.min.js';
      import '@patternfly/elements/pf-button/pf-button.js';
      import '@patternfly/elements/pf-modal/pf-modal.js';
      import '@patternfly/elements/pf-icon/pf-icon.js';
      import '@patternfly/elements/pf-popover/pf-popover.js';
      import '@patternfly/elements/pf-tooltip/pf-tooltip.js';
      import '@rhds/elements/rh-badge/rh-badge.js';
      </script>
<meta name="description" content="Automating system administration by using RHEL system roles | Red Hat Documentation">
<meta name="app-version" content="v0.0.1">
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
        import "@patternfly/elements/pf-badge/pf-badge.js";
      </script>
<script type="module" src="/_nuxt/C3PvZR0C.js" crossorigin integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c"></script></head><body><div id="__nuxt"><!--[--><!--[--><!----><header data-v-edc0d12c><a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden" data-v-edc0d12c>Skip to navigation</a><a href="#main-content" class="skip-link visually-hidden" data-v-edc0d12c>Skip to content</a><nav id="upper-navigation" class="upper-navigation" aria-labelledby="upper-navigation-label" data-analytics-region="upper-navigation" data-v-edc0d12c><p id="upper-navigation-label" class="upper-nav-hidden" data-v-edc0d12c>Featured links</p><div class="upper-nav-container" data-v-edc0d12c><ul class="upper-nav-menu" data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/" class="upper-nav-links" data-analytics-text="Support" data-analytics-category="Featured Links" data-v-edc0d12c>Support</a></li><li data-v-edc0d12c><a href="https://console.redhat.com/" class="upper-nav-links" data-analytics-text="Console" data-analytics-category="Featured Links" data-v-edc0d12c>Console</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" class="upper-nav-links" data-analytics-text="Developers" data-analytics-category="Featured Links" data-v-edc0d12c>Developers</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" class="upper-nav-links" data-analytics-text="Start a trial" data-analytics-category="Featured Links" data-v-edc0d12c>Start a trial</a></li><li data-v-edc0d12c><button id="all-red-hat" class="upper-nav-links" data-analytics-text="All Red Hat" data-analytics-category="Featured Links" aria-expanded="false" data-analytics-linktype="tab" data-v-edc0d12c>All Red Hat<svg class="upper-nav-arrow" xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024" aria-hidden="true" data-v-edc0d12c=""><path d="M810.642 511.557c0 8.905-3.447 16.776-10.284 23.613L322.31 1013.216c-6.835 6.837-14.706 10.284-23.61 10.284s-16.776-3.447-23.613-10.284l-51.303-51.303c-6.837-6.837-10.284-14.707-10.284-23.612s3.447-16.775 10.284-23.61L626.972 511.5 223.784 108.31c-6.837-6.835-10.284-14.706-10.284-23.61s3.447-16.776 10.284-23.613l51.303-51.303C281.924 2.947 289.794-.5 298.7-.5s16.775 3.447 23.61 10.284L800.36 487.83c6.837 6.837 10.284 14.708 10.284 23.613v.114" data-v-edc0d12c=""/></svg></button><div class="upper-nav-dropdown-container" data-v-edc0d12c><ul data-v-edc0d12c><li data-v-edc0d12c><span data-v-edc0d12c>For customers</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/support" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Customer support" data-v-edc0d12c>Customer support</a></li><li data-v-edc0d12c><a href="/products" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Documentation" data-v-edc0d12c>Documentation</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/support/cases" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Support cases" data-v-edc0d12c>Support Cases</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/management" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Subscription management" data-v-edc0d12c>Subscription management</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/" data-analytics-category="All Red Hat|For customers" data-analytics-text="Red Hat Ecosystem Catalog" data-v-edc0d12c>Red Hat Ecosystem Catalog</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/partners" data-analytics-category="All Red Hat|For customers" data-analytics-text="Find a partner" data-v-edc0d12c>Find a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>For partners</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://connect.redhat.com/login" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner login" data-v-edc0d12c>Partner login</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/en/support" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner support" data-v-edc0d12c>Partner support</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Become a partner " data-v-edc0d12c>Become a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Try, buy, &amp; sell</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://marketplace.redhat.com/en-us" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Marketplace" data-v-edc0d12c>Red Hat Marketplace</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/store" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Store" data-v-edc0d12c>Red Hat Store</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/contact" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Contact sales" data-v-edc0d12c>Contact Sales</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Learning resources</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.redhat.com/en/services/training-and-certification" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Training and certification " data-v-edc0d12c>Training and certification</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" data-pzn-audience="developers|community" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="For developers" data-v-edc0d12c>For developers</a></li><li data-v-edc0d12c><a href="https://cloud.redhat.com/learn" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Hybrid cloud learning hub" data-v-edc0d12c>Hybrid cloud learning hub</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Interactive labs" data-v-edc0d12c>Interactive labs</a></li><li data-v-edc0d12c><a href="https://learn.redhat.com/" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Learning community" data-v-edc0d12c>Learning community</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/tv" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Red Hat TV" data-v-edc0d12c>Red Hat TV</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Open source communities</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.ansible.com/community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="Ansible" data-v-edc0d12c>Ansible</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/sysadmin/" id="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For system administrators" data-v-edc0d12c>For system administrators</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/architect/" data-pzn-audience="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For architects" data-v-edc0d12c>For architects</a></li></ul></li></ul></div></li></ul></div></nav><pfe-navigation full-width id="pfe-navigation" pf-sticky="true" lang="en" data-v-edc0d12c><nav class="pfe-navigation" aria-label="Main Navigation" data-v-edc0d12c><div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper" data-v-edc0d12c><a href="/en" class="pfe-navigation__logo-link" data-v-edc0d12c><img class="pfe-navigation__logo-image pfe-navigation__logo-image--screen pfe-navigation__logo-image--small" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" width="240" height="40" alt="Red Hat Documentation" data-v-edc0d12c></a></div></nav><span data-v-edc0d12c></span><div slot="secondary-links" data-v-edc0d12c><div class="hidden-at-desktop hidden-at-tablet search-mobile" data-v-edc0d12c><div id="search-form" class="search-container" opensearchbox="true" data-v-edc0d12c data-v-69710f44><form role="search" class="form-box" autocomplete="off" data-v-69710f44><div class="search-box" data-v-69710f44><pf-icon icon="search" size="md" class="search-icon-form" data-v-69710f44></pf-icon><input type="text" id="input-search" class="input-search-box" placeholder="Search documentation" value aria-autocomplete="list" data-v-69710f44><!----><!----><!----><rh-button disabled variant="tertiary" class="form-submit-btn" data-v-69710f44><img src="data:image/svg+xml,%3csvg%20width=&#39;14&#39;%20height=&#39;14&#39;%20viewBox=&#39;0%200%2014%2014&#39;%20fill=&#39;none&#39;%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3cpath%20d=&#39;M7%200L5.6%201.4L10.3%206H0V8H10.3L5.6%2012.6L7%2014L14%207L7%200Z&#39;%20fill=&#39;%23707070&#39;/%3e%3c/svg%3e" alt="Submit button" data-v-69710f44></rh-button></div></form><!----></div></div><div class="hidden-at-desktop hidden-at-tablet buttons" data-v-edc0d12c><a href="https://access.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Support" data-v-edc0d12c>Support</a><a href="https://console.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Console" data-v-edc0d12c>Console</a><a href="https://developers.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Developers" data-v-edc0d12c>Developers</a><a href="https://www.redhat.com/en/products/trials" data-analytics-category="More Red Hat" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a><a href="https://www.redhat.com/en/contact" data-analytics-category="More Red Hat" data-analytics-text="Contact" data-v-edc0d12c>Contact</a></div><div class="hidden-at-desktop hidden-at-tablet mobile-lang-select" data-v-edc0d12c><label for="lang_selection" data-v-edc0d12c>Select your language</label><select id="lang_selection" data-v-edc0d12c><!--[--><option value="en" xml:lang="en" hreflang="en" data-v-edc0d12c>English</option><option value="fr" xml:lang="fr" hreflang="fr" data-v-edc0d12c>Français</option><option value="ko" xml:lang="ko" hreflang="ko" data-v-edc0d12c>한국어</option><option value="ja" xml:lang="ja" hreflang="ja" data-v-edc0d12c>日本語</option><option value="zh-cn" xml:lang="zh-cn" hreflang="zh-cn" data-v-edc0d12c>中文 (中国)</option><option value="de" xml:lang="de" hreflang="de" data-v-edc0d12c>Deutsch</option><option value="it" xml:lang="it" hreflang="it" data-v-edc0d12c>Italiano</option><option value="pt-br" xml:lang="pt-br" hreflang="pt-br" data-v-edc0d12c>Português</option><option value="es" xml:lang="es" hreflang="es" data-v-edc0d12c>Español</option><!--]--></select></div></div></pfe-navigation></header><main id="main-content"><!--[--><!--[--><!--[--><!----><!----><!--]--><div class="breadcrumbs" id="breadcrumbs" data-v-8589d091 data-v-798f280c><nav aria-label="Breadcrumb" class="breadcrumb" data-v-798f280c><ol data-v-798f280c><li data-v-798f280c><a href="/" data-v-798f280c>Home</a></li><li data-v-798f280c><a href="/en/products" data-v-798f280c>Products</a></li><!--[--><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/" data-v-798f280c>Red Hat Enterprise Linux</a></li><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/9/" data-v-798f280c>9</a></li><li data-v-798f280c><!--[-->Automating system administration by using RHEL system roles<!--]--></li><!--]--></ol></nav><span data-v-798f280c></span></div><!----><nav id="mobile-nav" class="mobile-nav" aria-label="mobile menu" data-v-8589d091><div class="mobile-nav-wrapper" data-v-8589d091><div id="first-button" data-v-8589d091><button id="toc-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><span class="sr-only" data-v-8589d091>Open </span>Table of contents</button></div><div id="second-button" data-v-8589d091><button id="settings-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><pf-icon icon="cog" size="md" data-v-8589d091></pf-icon><span class="sr-only" data-v-8589d091>Open page settings</span></button></div></div><div id="mobile-nav-content-wrapper" class="hidden" role="navigation" tabindex="0" data-v-8589d091><div id="toc-mobile" class="hidden" aria-labelledby="toc-btn" data-v-8589d091><div class="shrink-product-padding product-container" id="product-container-mobile" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter-mobile" data-v-8589d091><span id="text" part="text" data-v-8589d091><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper-mobile" class="span-xs-12 span-sm-4 span-md-3" lang="en" data-v-8589d091><nav id="mobile-toc-menu" class="table-of-contents" aria-label="table of content - mobile" data-v-8589d091><!----></nav></div><!----></div><div id="page-content-options-mobile" class="hidden" aria-labelledby="settings-btn" data-v-8589d091><div class="page-layout-options" data-v-8589d091><label for="page-format-mobile" data-v-8589d091>Format</label><select id="page-format-mobile" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div></div></div><!----><!----></nav><div class="grid grid-col-12 content-wrapper" data-v-8589d091><aside id="left-content" class="span-xs-12 span-sm-4 span-md-3" lang="en-us" aria-label="left navigation" xml:lang="en-us" data-v-8589d091><div class="toc-container" id="toc-container" visible="true" data-v-8589d091><div class="toc-focus-container" id="toc-focus-container" data-v-8589d091><button class="toc-focus-btn" aria-label="toggle left menu" aria-controls="toc-container" aria-expanded="true" data-v-8589d091><pf-icon size="md" icon="angle-left" class="toc-focus-btn-icon" data-v-8589d091></pf-icon></button></div><div class="product-container" id="product-container-desktop" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter" id="toc-filter" data-v-8589d091><span id="text" part="text" data-v-8589d091><span id="search-icon" part="search-icon" data-v-8589d091><pf-icon icon="filter" size="md" data-v-8589d091></pf-icon></span><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper" class="toc-wrapper" data-v-8589d091><nav id="toc" class="max-height-85 table-of-contents" aria-label="Table of contents" data-v-8589d091><ol id="toc-list" data-v-8589d091><!--[--><li class="item chapter" data-v-fa0dae77><a class="link active" href id="chapter-index" data-v-fa0dae77>Automating system administration by using RHEL system roles</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Providing feedback on Red Hat documentation</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>1. Introduction to RHEL system roles</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>2. Preparing a control node and managed nodes to use RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Preparing a control node and managed nodes to use RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles" data-v-b883c74f>2.1. Preparing a control node on RHEL 9</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles" data-v-b883c74f>2.2. Preparing a managed node</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-ansible-vault_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>3. Ansible vault</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>4. Ansible IPMI modules in RHEL</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Ansible IPMI modules in RHEL</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_the-rhel_mgmt-collection_assembly_ansible-ipmi-modules-in-rhel" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-ref_the-rhel_mgmt-collection_assembly_ansible-ipmi-modules-in-rhel" data-v-b883c74f>4.1. The rhel_mgmt collection</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_example-using-the-ipmi_boot-module_assembly_ansible-ipmi-modules-in-rhel" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_example-using-the-ipmi_boot-module_assembly_ansible-ipmi-modules-in-rhel" data-v-b883c74f>4.2. Using the ipmi_boot module</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_example-using-the-ipmi_power-module_assembly_ansible-ipmi-modules-in-rhel" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_example-using-the-ipmi_power-module_assembly_ansible-ipmi-modules-in-rhel" data-v-b883c74f>4.3. Using the ipmi_power module</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>5. The Redfish modules in RHEL</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>The Redfish modules in RHEL</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_the-redfish-modules_assembly_the-redfish-modules-in-rhel" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-con_the-redfish-modules_assembly_the-redfish-modules-in-rhel" data-v-b883c74f>5.1. The Redfish modules</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_redfish-modules-parameters_assembly_the-redfish-modules-in-rhel" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-ref_redfish-modules-parameters_assembly_the-redfish-modules-in-rhel" data-v-b883c74f>5.2. Redfish modules parameters</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-the-redfish-info-module_assembly_the-redfish-modules-in-rhel" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_using-the-redfish-info-module_assembly_the-redfish-modules-in-rhel" data-v-b883c74f>5.3. Using the redfish_info module</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-the-redfish-command-module_assembly_the-redfish-modules-in-rhel" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_using-the-redfish-command-module_assembly_the-redfish-modules-in-rhel" data-v-b883c74f>5.4. Using the redfish_command module</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-the-redfish-config-module_assembly_the-redfish-modules-in-rhel" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_using-the-redfish-config-module_assembly_the-redfish-modules-in-rhel" data-v-b883c74f>5.5. Using the redfish_config module</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>6. Joining RHEL systems to an Active Directory by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Joining RHEL systems to an Active Directory by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles" data-v-b883c74f>6.1. Joining RHEL to an Active Directory domain by using the ad_integration RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>7. Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" data-v-b883c74f>7.1. Requesting a new certificate from an IdM CA by using the certificate RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles" data-v-b883c74f>7.2. Requesting a new self-signed certificate by using the certificate RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>8. Installing and configuring web console by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Installing and configuring web console by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_installing-the-web-console-by-using-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_installing-the-web-console-by-using-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role" data-v-b883c74f>8.1. Installing the web console by using the cockpit RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>9. Setting a custom cryptographic policy by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Setting a custom cryptographic policy by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role" data-v-b883c74f>9.1. Enhancing security with the FUTURE cryptographic policy using the crypto_policies RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>10. Configuring firewalld by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring firewalld by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_resetting-the-firewalld-settings-using-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_resetting-the-firewalld-settings-using-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles" data-v-b883c74f>10.1. Resetting the firewalld settings by using the firewall RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_forwarding-incoming-traffic-from-one-local-port-to-a-different-local-port_assembly_configuring-firewalld-using-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_forwarding-incoming-traffic-from-one-local-port-to-a-different-local-port_assembly_configuring-firewalld-using-system-roles" data-v-b883c74f>10.2. Forwarding incoming traffic in firewalld from one local port to a different local port by using the firewall RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-dmz-firewalld-zone-by-using-the-firewalld-rhel-system-role_assembly_configuring-firewalld-using-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-a-dmz-firewalld-zone-by-using-the-firewalld-rhel-system-role_assembly_configuring-firewalld-using-system-roles" data-v-b883c74f>10.3. Configuring a firewalld DMZ zone by using the firewall RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>11. Configuring a high-availability cluster by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring a high-availability cluster by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.1. Variables of the ha_cluster RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.2. Specifying an inventory for the ha_cluster RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.3. Creating pcsd TLS certificates and key files for a high availability cluster</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-no-resource-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-no-resource-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.4. Configuring a high availability cluster running no resources</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.5. Configuring a high availability cluster with fencing and resources</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-ha-cluster-with-resource-defaults_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-ha-cluster-with-resource-defaults_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.6. Configuring a high availability cluster with resource and resource operation defaults</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-with-stonith-levels-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-with-stonith-levels-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.7. Configuring a high availability cluster with fencing levels</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.8. Configuring a high availability cluster with resource constraints</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.9. Configuring Corosync values in a high availability cluster</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-hacluster-with-ACLS-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-hacluster-with-ACLS-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.10. Configuring a high availability cluster that implements access control lists (ACLs) by using the ha_cluster RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.11. Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-hacluster-with-placement-strategy-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-hacluster-with-placement-strategy-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.13. Configuring a placement strategy for a high availability cluster by using the RHEL ha_cluster RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-alerts-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-alerts-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.14. Configuring alerts for a high availability cluster by using the ha_cluster RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f><summary class="heading sub-chapter-title" id="configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role--summary" data-v-b883c74f>11.15. Configuring a high availability cluster using a quorum device</summary><ol id="sub-nav--configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>Configuring a high availability cluster using a quorum device</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.15.1. Configuring a quorum device</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-cluster-to-use-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-a-cluster-to-use-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.15.2. Configuring a cluster to use a quorum device</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-ha-cluster-with-node-attributes_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-ha-cluster-with-node-attributes_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.16. Configuring a high availability cluster with node attributes</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-http-ha-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-http-ha-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" data-v-b883c74f>11.17. Configuring an Apache HTTP server in a high availability cluster with the ha_cluster RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>12. Configuring the systemd journal by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-the-systemd-journal-by-using-the-journald-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring the systemd journal by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-persistent-logging-by-using-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-persistent-logging-by-using-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role" data-v-b883c74f>12.1. Configuring persistent logging by using the journald RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>13. Configuring automatic crash dumps by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring automatic crash dumps by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-kdump-using-rhel-system-roles_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-kdump-using-rhel-system-roles_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role" data-v-b883c74f>13.1. Configuring the kernel crash dumping mechanism by using the kdump RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>14. Configuring kernel parameters permanently by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring kernel parameters permanently by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role" data-v-b883c74f>14.1. Applying selected kernel parameters by using the kernel_settings RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>15. Configuring the GRUB 2 boot loader by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring the GRUB 2 boot loader by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#updating-the-existing-boot-loader-entries-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-updating-the-existing-boot-loader-entries-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles" data-v-b883c74f>15.1. Updating the existing boot loader entries by using the bootloader RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#securing-the-boot-menu-with-password-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-securing-the-boot-menu-with-password-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles" data-v-b883c74f>15.2. Securing the boot menu with password by using the bootloader RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-a-timeout-for-the-boot-loader-menu-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-setting-a-timeout-for-the-boot-loader-menu-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles" data-v-b883c74f>15.3. Setting a timeout for the boot loader menu by using the bootloader RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#collecting-the-boot-loader-configuration-information-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-collecting-the-boot-loader-configuration-information-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles" data-v-b883c74f>15.4. Collecting the boot loader configuration information by using the bootloader RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>16. Configuring logging by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring logging by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_filtering-logs-in-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_filtering-logs-in-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles" data-v-b883c74f>16.1. Filtering local log messages by using the logging RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#applying-a-remote-logging-solution-using-the-logging-system-role_configuring-logging-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-applying-a-remote-logging-solution-using-the-logging-system-role_configuring-logging-by-using-rhel-system-roles" data-v-b883c74f>16.2. Applying a remote logging solution by using the logging RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles" data-v-b883c74f><summary class="heading sub-chapter-title" id="assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles--summary" data-v-b883c74f>16.3. Using the logging RHEL system role with TLS</summary><ol id="sub-nav--assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles" data-v-b883c74f>Using the logging RHEL system role with TLS</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls" data-v-b883c74f>16.3.1. Configuring client logging with TLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls" data-v-b883c74f>16.3.2. Configuring server logging with TLS</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--assembly_using-the-logging-system-roles-with-relp" data-v-b883c74f><summary class="heading sub-chapter-title" id="assembly_using-the-logging-system-roles-with-relp--summary" data-v-b883c74f>16.4. Using the logging RHEL system roles with RELP</summary><ol id="sub-nav--assembly_using-the-logging-system-roles-with-relp" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-the-logging-system-roles-with-relp" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_using-the-logging-system-roles-with-relp" data-v-b883c74f>Using the logging RHEL system roles with RELP</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" data-v-b883c74f>16.4.1. Configuring client logging with RELP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp" data-v-b883c74f>16.4.2. Configuring server logging with RELP</a></li><!--]--><!--]--></ol></details></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>17. Configuring performance monitoring with PCP by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring performance monitoring with PCP by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" data-v-b883c74f>17.1. Configuring Performance Co-Pilot by using the metrics RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-performance-co-pilot-with-authentication-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-performance-co-pilot-with-authentication-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" data-v-b883c74f>17.2. Configuring Performance Co-Pilot with authentication by using the metrics RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role" data-v-b883c74f>17.3. Setting up Grafana by using the metrics RHEL system role to monitor multiple hosts with Performance Co-Pilot</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-web-hooks-in-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-web-hooks-in-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" data-v-b883c74f>17.4. Configuring web hooks in Performance Co-Pilot by using the metrics RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>18. Configuring Microsoft SQL Server by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring Microsoft SQL Server by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-existing-certificate-files_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-existing-certificate-files_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role" data-v-b883c74f>18.1. Installing and configuring SQL Server with an existing TLS certificate by using the microsoft.sql.server Ansible system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-the-certificate-role_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-the-certificate-role_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role" data-v-b883c74f>18.2. Installing and configuring SQL Server with a TLS certificate issued from IdM by using the microsoft.sql.server Ansible system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-up-custom-storage-paths-for-data-and-logs_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-setting-up-custom-storage-paths-for-data-and-logs_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role" data-v-b883c74f>18.3. Installing and configuring SQL Server with custom storage paths by using the microsoft.sql.server Ansible system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#preparing-and-running-a-playbook-to-enable-sql-server-authentication-with-active-directory_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-preparing-and-running-a-playbook-to-enable-sql-server-authentication-with-active-directory_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role" data-v-b883c74f>18.4. Installing and configuring SQL Server with AD integration by using the microsoft.sql.server Ansible system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>19. Configuring NBDE by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring NBDE by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles" data-v-b883c74f>19.1. Using the nbde_server RHEL system role for setting up multiple Tang servers</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles" data-v-b883c74f>19.2. Setting up Clevis clients with DHCP by using the nbde_client RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles" data-v-b883c74f>19.3. Setting up static-IP Clevis clients by using the nbde_client RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>20. Configuring network settings by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring network settings by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.1. Configuring an Ethernet connection with a static IP address by using the network RHEL system role with an interface name</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.2. Configuring an Ethernet connection with a static IP address by using the network RHEL system role with a device path</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.3. Configuring an Ethernet connection with a dynamic IP address by using the network RHEL system role with an interface name</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.4. Configuring an Ethernet connection with a dynamic IP address by using the network RHEL system role with a device path</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-vlan-tagging-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-vlan-tagging-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.5. Configuring VLAN tagging by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-network-bridge-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-a-network-bridge-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.6. Configuring a network bridge by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-a-network-bond-by-using-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_configuring-a-network-bond-by-using-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.7. Configuring a network bond by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-an-ipoib-connection-by-using-the-network-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-an-ipoib-connection-by-using-the-network-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.8. Configuring an IPoIB connection by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_routing-traffic-from-a-specific-subnet-to-a-different-default-gateway-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_routing-traffic-from-a-specific-subnet-to-a-different-default-gateway-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.9. Routing traffic from a specific subnet to a different default gateway by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-static-ethernet-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-a-static-ethernet-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.10. Configuring a static Ethernet connection with 802.1X network authentication by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-a-wifi-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_configuring-a-wifi-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.11. Configuring a wifi connection with 802.1X network authentication by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_setting-the-default-gateway-on-an-existing-connection-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_setting-the-default-gateway-on-an-existing-connection-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.12. Setting the default gateway on an existing connection by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-a-static-route-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_configuring-a-static-route-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.13. Configuring a static route by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-an-ethtool-offload-feature-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_configuring-an-ethtool-offload-feature-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.14. Configuring an ethtool offload feature by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-an-ethtool-coalesce-settings-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_configuring-an-ethtool-coalesce-settings-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.15. Configuring an ethtool coalesce settings by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_increasing-the-ring-buffer-size-to-reduce-a-high-packet-drop-rate-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_increasing-the-ring-buffer-size-to-reduce-a-high-packet-drop-rate-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.16. Increasing the ring buffer size to reduce a high packet drop rate by using the network RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_network-states-for-the-network-rhel-system-roles_assembly_configuring-network-settings-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-ref_network-states-for-the-network-rhel-system-roles_assembly_configuring-network-settings-by-using-rhel-system-roles" data-v-b883c74f>20.17. Network states for the network RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>21. Managing containers by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Managing containers by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-rootless-container-with-bind-mount_managing-containers-by-using-the-podman-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-creating-a-rootless-container-with-bind-mount_managing-containers-by-using-the-podman-rhel-system-role" data-v-b883c74f>21.1. Creating a rootless container with bind mount by using the podman RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-rootful-container-with-podman-volume_managing-containers-by-using-the-podman-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-creating-a-rootful-container-with-podman-volume_managing-containers-by-using-the-podman-rhel-system-role" data-v-b883c74f>21.2. Creating a rootful container with Podman volume by using the podman RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-quadlet-application-with-secrets_managing-containers-by-using-the-podman-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-creating-a-quadlet-application-with-secrets_managing-containers-by-using-the-podman-rhel-system-role" data-v-b883c74f>21.3. Creating a Quadlet application with secrets by using the podman RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>22. Configuring Postfix MTA by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring Postfix MTA by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-the-postfix-system-role-to-automate-basic-postfix-mta-administration_configuring-postfix-mta-by-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-using-the-postfix-system-role-to-automate-basic-postfix-mta-administration_configuring-postfix-mta-by-using-rhel-system-roles" data-v-b883c74f>22.1. Using the postfix RHEL system role to automate basic Postfix MTA administration</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>23. Installing and configuring PostgreSQL by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Installing and configuring PostgreSQL by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#introduction-to-the-postgresql-rhel-system-role_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-introduction-to-the-postgresql-rhel-system-role_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role" data-v-b883c74f>23.1. Introduction to the postgresql RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-postgresql-server-by-using-rhel-system-roles_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-the-postgresql-server-by-using-rhel-system-roles_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role" data-v-b883c74f>23.2. Configuring the PostgreSQL server by using the postgresql RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>24. Registering the system by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Registering the system by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#introduction-to-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-introduction-to-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.1. Introduction to the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#registering-system-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-registering-system-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.2. Registering a system by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#registering-system-with-satellite-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-registering-system-with-satellite-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.3. Registering a system with Satellite by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-insights-connection-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-insights-connection-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.4. Disabling the connection to Insights after the registration by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-repositories-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-repositories-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.5. Enabling repositories by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-release-versions-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-setting-release-versions-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.6. Setting release versions by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-proxy-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-proxy-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.7. Using a proxy server when registering the host by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-auto-updates-insights-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-auto-updates-insights-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.8. Disabling auto updates of Insights rules by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-insights-remediations-using-rhel-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-insights-remediations-using-rhel-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.9. Disabling Insights remediations by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-insights-tags-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-insights-tags-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.10. Configuring Insights tags by using the rhc RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#unregistering-a-system-using-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-unregistering-a-system-using-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system" data-v-b883c74f>24.11. Unregistering a system by using the rhc RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>25. Configuring SELinux by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring SELinux by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#introduction-to-the-selinux-system-role_configuring-selinux-using-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-introduction-to-the-selinux-system-role_configuring-selinux-using-system-roles" data-v-b883c74f>25.1. Introduction to the selinux RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_configuring-selinux-using-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_configuring-selinux-using-system-roles" data-v-b883c74f>25.2. Using the selinux RHEL system role to apply SELinux settings on multiple systems</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#managing-ports-by-using-the-selinux-rhel-system-role_configuring-selinux-using-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-managing-ports-by-using-the-selinux-rhel-system-role_configuring-selinux-using-system-roles" data-v-b883c74f>25.3. Managing ports by using the selinux RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>26. Restricting the execution of applications by using the fapolicyd RHEL system role</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Restricting the execution of applications by using the fapolicyd RHEL system role</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role" data-v-b883c74f>26.1. Preventing users from executing untrustworthy code by using the fapolicyd RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>27. Configuring the OpenSSH server and client by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring the OpenSSH server and client by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#sshd-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-sshd-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" data-v-b883c74f>27.1. How the sshd RHEL system role maps settings from a playbook to the configuration file</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" data-v-b883c74f>27.2. Configuring OpenSSH servers by using the sshd RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" data-v-b883c74f>27.3. Using the sshd RHEL system role for non-exclusive configuration</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_overriding-system-wide-crypto-policy-ssh-server-system-roles_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_overriding-system-wide-crypto-policy-ssh-server-system-roles_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" data-v-b883c74f>27.4. Overriding the system-wide cryptographic policy on an SSH server by using the sshd RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_ssh-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-ref_ssh-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" data-v-b883c74f>27.5. How the ssh RHEL system role maps settings from a playbook to the configuration file</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles" data-v-b883c74f>27.6. Configuring OpenSSH clients by using the ssh RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>28. Managing local storage by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Managing local storage by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#an-example-ansible-playbook-to-create-an-xfs-file-system_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-an-example-ansible-playbook-to-create-an-xfs-file-system_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.1. Creating an XFS file system on a block device by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.2. Persistently mounting a file system by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-or-resizing-logical-volume-using-storage-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-creating-or-resizing-logical-volume-using-storage-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.3. Creating or resizing a logical volume by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#an-example-ansible-playbook-to-enable-online-block-discard_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-an-example-ansible-playbook-to-enable-online-block-discard_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.4. Enabling online block discard by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#an-example-playbook-to-create-mount-an-ext4-file-system_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-an-example-playbook-to-create-mount-an-ext4-file-system_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.5. Creating and mounting an Ext4 file system by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#an-example-ansible-playbook-to-create-mount-ext3-file-system_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-an-example-ansible-playbook-to-create-mount-ext3-file-system_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.6. Creating and mounting an Ext3 file system by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#example-ansible-playbook-to-create-a-swap-partition-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-example-ansible-playbook-to-create-a-swap-partition-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.7. Creating a swap volume by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-raid-volume-using-the-storage-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-a-raid-volume-using-the-storage-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.8. Configuring a RAID volume by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-lvm-pool-with-raid-using-storage-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-lvm-pool-with-raid-using-storage-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.9. Configuring an LVM pool with RAID by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-stripe-size-for-raid-lvm-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-a-stripe-size-for-raid-lvm-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.10. Configuring a stripe size for RAID LVM volumes by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-an-lvm-vdo-volume-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-an-lvm-vdo-volume-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.11. Configuring an LVM-VDO volume by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-luks2-encrypted-volume-using-the-storage-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-creating-a-luks2-encrypted-volume-using-the-storage-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.12. Creating a LUKS2 encrypted volume by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-shared-lvm-devices-using-storage-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-creating-shared-lvm-devices-using-storage-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.13. Creating shared LVM devices using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#resizing-physical-volumes-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-resizing-physical-volumes-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.14. Resizing physical volumes by using the storage RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-an-encrypted-stratis-pool-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-creating-an-encrypted-stratis-pool-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles" data-v-b883c74f>28.15. Creating an encrypted Stratis pool by using the storage RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>29. Managing systemd units by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Managing systemd units by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#managing-services-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-managing-services-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role" data-v-b883c74f>29.1. Managing services by using the systemd RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-systemd-drop-in-files-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-deploying-systemd-drop-in-files-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role" data-v-b883c74f>29.2. Deploying systemd drop-in files by using the systemd RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-systemd-units-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-deploying-systemd-units-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role" data-v-b883c74f>29.3. Deploying systemd units by using the systemd RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>30. Configuring time synchronization by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring time synchronization by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-time-synchronization-over-ntp-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-time-synchronization-over-ntp-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles" data-v-b883c74f>30.1. Configuring time synchronization over NTP by using the timesync RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-time-synchronization-over-ntp-with-nts-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-configuring-time-synchronization-over-ntp-with-nts-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles" data-v-b883c74f>30.2. Configuring time synchronization over NTP with NTS by using the timesync RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>31. Configuring a system for session recording by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring a system for session recording by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" data-v-b883c74f>31.1. Configuring session recording for individual users by using the tlog RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-the-tlog-rhel-system-role-for-excluding-lists-of-groups-or-users_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-deploying-the-tlog-rhel-system-role-for-excluding-lists-of-groups-or-users_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles" data-v-b883c74f>31.2. Excluding certain users and groups from session recording by using the the tlog RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles--summary" data-v-fa0dae77>32. Configuring VPN connections with IPsec by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles" data-v-fa0dae77>Configuring VPN connections with IPsec by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" data-v-b883c74f>32.1. Creating a host-to-host VPN with IPsec by using the vpn RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" id="sub-link-to-automating_system_administration_by_using_rhel_system_roles-proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" data-v-b883c74f>32.2. Creating an opportunistic mesh VPN connection with IPsec by using the vpn RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#idm140064638241184" id="chapter-landing--automating_system_administration_by_using_rhel_system_roles-idm140064638241184" data-v-fa0dae77>Legal Notice</a></li><!--]--></ol></nav><!----></div></div></aside><article class="content span-xs-12 span-sm-6 span-md-12 span-lg-7" aria-live="polite" data-v-8589d091><!----><div lang="en-us" xml:lang="en-us" class="docs-content-container" data-v-8589d091><!----><!----><h1 data-id="content_chapter" class="chapter-title" data-v-8589d091>Automating system administration by using RHEL system roles</h1><hr class="line-below-chp" data-v-8589d091><section class="rhdocs" data-v-8589d091><body><div xml:lang="en-US" class="book" id="idm140064656299584"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">9</span></div><div><h3 class="subtitle">Consistent and repeatable configuration of RHEL deployments across multiple hosts with Red Hat Ansible Automation Platform playbooks</h3></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="#idm140064638241184">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				The Red Hat Enterprise Linux (RHEL) system roles are a collection of Ansible roles, modules, and playbooks that help automate the consistent and repeatable administration of RHEL systems. With RHEL system roles, you can efficiently manage large inventories of systems by running configuration playbooks from a single system.
			</div></div></div></div><hr></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Providing feedback on Red Hat documentation</h2></div></div></div><p class="_abstract _abstract">
			We appreciate your feedback on our documentation. Let us know how we can improve it.
		</p><div class="orderedlist"><p class="title"><strong>Submitting feedback through Jira (account required)</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in to the <a class="link" href="https://issues.redhat.com/projects/RHELDOCS/issues">Jira</a> website.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> in the top navigation bar
				</li><li class="listitem">
					Enter a descriptive title in the <span class="strong strong"><strong>Summary</strong></span> field.
				</li><li class="listitem">
					Enter your suggestion for improvement in the <span class="strong strong"><strong>Description</strong></span> field. Include links to the relevant parts of the documentation.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> at the bottom of the dialogue.
				</li></ol></div></section><section class="chapter" id="intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Introduction to RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			By using RHEL system roles, you can remotely manage the system configurations of multiple RHEL systems across major versions of RHEL.
		</p><div class="formalpara"><p class="title"><strong>Important terms and concepts</strong></p><p>
				The following describes important terms and concepts in an Ansible environment:
			</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Control node</span></dt><dd>
						A control node is the system from which you run Ansible commands and playbooks. Your control node can be an Ansible Automation Platform, Red Hat Satellite, or a RHEL 9, 8, or 7 host. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</dd><dt><span class="term">Managed node</span></dt><dd>
						Managed nodes are the servers and network devices that you manage with Ansible. Managed nodes are also sometimes called hosts. Ansible does not have to be installed on managed nodes. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a managed node</a>.
					</dd><dt><span class="term">Ansible playbook</span></dt><dd>
						In a playbook, you define the configuration you want to achieve on your managed nodes or a set of steps for the system on the managed node to perform. Playbooks are Ansible’s configuration, deployment, and orchestration language.
					</dd><dt><span class="term">Inventory</span></dt><dd>
						In an inventory file, you list the managed nodes and specify information such as IP address for each managed node. In the inventory, you can also organize the managed nodes by creating and nesting groups for easier scaling. An inventory file is also sometimes called a hostfile.
					</dd></dl></div><div class="formalpara"><p class="title"><strong>Available roles on a Red Hat Enterprise Linux 9 control node</strong></p><p>
				On a Red Hat Enterprise Linux 9 control node, the <code class="literal">rhel-system-roles</code> package provides the following roles:
			</p></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 25%; " class="col_1"><!--Empty--><col style="width: 25%; " class="col_2"><!--Empty--><col style="width: 50%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140064662486128" scope="col">Role name</th><th align="left" valign="top" id="idm140064662485040" scope="col">Role description</th><th align="left" valign="top" id="idm140064662483952" scope="col">Chapter title</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">certificate</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Certificate Issuance and Renewal
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Requesting certificates by using RHEL system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">cockpit</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Web console
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Installing and configuring web console with the cockpit RHEL system role
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">crypto_policies</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							System-wide cryptographic policies
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Setting a custom cryptographic policy across systems
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">firewall</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Firewalld
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring firewalld by using system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">ha_cluster</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							HA Cluster
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring a high-availability cluster by using system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">kdump</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Kernel Dumps
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring kdump by using RHEL system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">kernel_settings</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Kernel Settings
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Using Ansible roles to permanently configure kernel parameters
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">logging</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Logging
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Using the logging system role
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">metrics</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Metrics (PCP)
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Monitoring performance by using RHEL system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">network</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Networking
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Using the network RHEL system role to manage InfiniBand connections
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">nbde_client</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Network Bound Disk Encryption client
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Using the nbde_client and nbde_server system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">nbde_server</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Network Bound Disk Encryption server
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Using the nbde_client and nbde_server system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">postfix</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Postfix
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Variables of the postfix role in system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">postgresql</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							PostgreSQL
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Installing and configuring PostgreSQL by using the postgresql RHEL system role
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">selinux</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							SELinux
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring SELinux by using system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">ssh</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							SSH client
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring secure communication with the ssh system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">sshd</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							SSH server
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring secure communication with the ssh system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">storage</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Storage
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Managing local storage by using RHEL system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">tlog</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Terminal Session Recording
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring a system for session recording by using the tlog RHEL system role
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">timesync</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							Time Synchronization
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring time synchronization by using RHEL system roles
						</p>
						 </td></tr><tr><td align="left" valign="top" headers="idm140064662486128"> <p>
							<code class="literal">vpn</code>
						</p>
						 </td><td align="left" valign="top" headers="idm140064662485040"> <p>
							VPN
						</p>
						 </td><td align="left" valign="top" headers="idm140064662483952"> <p>
							Configuring VPN connections with IPsec by using the vpn RHEL system role
						</p>
						 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<a class="link" href="https://access.redhat.com/articles/3050101">Red Hat Enterprise Linux (RHEL) system roles</a>
				</li><li class="listitem">
					<code class="literal">/usr/share/ansible/roles/rhel-system-roles.<span class="emphasis"><em>&lt;role_name&gt;</em></span>/README.md</code> file
				</li><li class="listitem">
					<code class="literal">/usr/share/doc/rhel-system-roles/<span class="emphasis"><em>&lt;role_name&gt;</em></span>/</code> directory
				</li></ul></div></section><section class="chapter" id="assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Preparing a control node and managed nodes to use RHEL system roles</h2></div></div></div><p>
			Before you can use individual RHEL system roles to manage services and settings, you must prepare the control node and managed nodes.
		</p><section class="section" id="proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">2.1. Preparing a control node on RHEL 9</h3></div></div></div><p>
				Before using RHEL system roles, you must configure a control node. This system then configures the managed hosts from the inventory according to the playbooks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system is registered to the Customer Portal.
					</li><li class="listitem">
						A <code class="literal">Red Hat Enterprise Linux Server</code> subscription is attached to the system.
					</li><li class="listitem">
						Optional: An <code class="literal">Ansible Automation Platform</code> subscription is attached to the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a user named <code class="literal">ansible</code> to manage and run playbooks:
					</p><pre class="literallayout">[root@control-node]# <span class="strong strong"><strong>useradd ansible</strong></span></pre></li><li class="listitem"><p class="simpara">
						Switch to the newly created <code class="literal">ansible</code> user:
					</p><pre class="literallayout">[root@control-node]# <span class="strong strong"><strong>su - ansible</strong></span></pre><p class="simpara">
						Perform the rest of the procedure as this user.
					</p></li><li class="listitem"><p class="simpara">
						Create an SSH public and private key:
					</p><pre class="literallayout">[ansible@control-node]$ <span class="strong strong"><strong>ssh-keygen</strong></span>
Generating public/private rsa key pair.
Enter file in which to save the key (/home/ansible/.ssh/id_rsa):
Enter passphrase (empty for no passphrase): <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
Enter same passphrase again: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
...</pre><p class="simpara">
						Use the suggested default location for the key file.
					</p></li><li class="listitem">
						Optional: To prevent Ansible from prompting you for the SSH key password each time you establish a connection, configure an SSH agent.
					</li><li class="listitem"><p class="simpara">
						Create the <code class="literal">~/.ansible.cfg</code> file with the following content:
					</p><pre class="literallayout">[defaults]
inventory = /home/ansible/inventory
remote_user = ansible

[privilege_escalation]
become = True
become_method = sudo
become_user = root
become_ask_pass = True</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Settings in the <code class="literal">~/.ansible.cfg</code> file have a higher priority and override settings from the global <code class="literal">/etc/ansible/ansible.cfg</code> file.
						</p></div></rh-alert><p class="simpara">
						With these settings, Ansible performs the following actions:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Manages hosts in the specified inventory file.
							</li><li class="listitem">
								Uses the account set in the <code class="literal">remote_user</code> parameter when it establishes SSH connections to managed nodes.
							</li><li class="listitem">
								Uses the <code class="literal">sudo</code> utility to execute tasks on managed nodes as the <code class="literal">root</code> user.
							</li><li class="listitem">
								Prompts for the root password of the remote user every time you apply a playbook. This is recommended for security reasons.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Create an <code class="literal">~/inventory</code> file in INI or YAML format that lists the hostnames of managed hosts. You can also define groups of hosts in the inventory file. For example, the following is an inventory file in the INI format with three hosts and one host group named <code class="literal">US</code>:
					</p><pre class="literallayout">managed-node-01.example.com

[US]
managed-node-02.example.com ansible_host=192.0.2.100
managed-node-03.example.com</pre><p class="simpara">
						Note that the control node must be able to resolve the hostnames. If the DNS server cannot resolve certain hostnames, add the <code class="literal">ansible_host</code> parameter next to the host entry to specify its IP address.
					</p></li><li class="listitem"><p class="simpara">
						Install RHEL system roles:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								On a RHEL host without Ansible Automation Platform, install the <code class="literal">rhel-system-roles</code> package:
							</p><pre class="literallayout">[root@control-node]# <span class="strong strong"><strong>dnf install rhel-system-roles</strong></span></pre><p class="simpara">
								This command installs the collections in the <code class="literal">/usr/share/ansible/collections/ansible_collections/redhat/rhel_system_roles/</code> directory, and the <code class="literal">ansible-core</code> package as a dependency.
							</p></li><li class="listitem"><p class="simpara">
								On Ansible Automation Platform, perform the following steps as the <code class="literal">ansible</code> user:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/2.4/html/getting_started_with_automation_hub/configure-hub-primary">Define Red Hat automation hub as the primary source for content</a> in the <code class="literal">~/.ansible.cfg</code> file.
									</li><li class="listitem"><p class="simpara">
										Install the <code class="literal">redhat.rhel_system_roles</code> collection from Red Hat automation hub:
									</p><pre class="literallayout">[ansible@control-node]$ <span class="strong strong"><strong>ansible-galaxy collection install redhat.rhel_system_roles</strong></span></pre><p class="simpara">
										This command installs the collection in the <code class="literal">~/.ansible/collections/ansible_collections/redhat/rhel_system_roles/</code> directory.
									</p></li></ol></div></li></ul></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next step</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Prepare the managed nodes. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a managed node</a>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/6325611">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/253273">How to register and subscribe a system to the Red Hat Customer Portal using subscription-manager</a> (Red Hat Knowledgebase)
					</li><li class="listitem">
						The <code class="literal">ssh-keygen(1)</code> manual page
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh">Connecting to remote machines with SSH keys using ssh-agent</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html">Ansible configuration settings</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html">How to build your inventory</a>
					</li></ul></div></section><section class="section" id="proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">2.2. Preparing a managed node</h3></div></div></div><p>
				Managed nodes are the systems listed in the inventory and which will be configured by the control node according to the playbook. You do not have to install Ansible on managed hosts.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You prepared the control node. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li><li class="listitem"><p class="simpara">
						You have SSH access from the control node.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Direct SSH access as the <code class="literal">root</code> user is a security risk. To reduce this risk, you will create a local user on this node and configure a <code class="literal">sudo</code> policy when preparing a managed node. Ansible on the control node can then use the local user account to log in to the managed node and run playbooks as different users, such as <code class="literal">root</code>.
						</p></div></rh-alert></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a user named <code class="literal">ansible</code>:
					</p><pre class="literallayout">[root@managed-node-01]# <span class="strong strong"><strong>useradd ansible</strong></span></pre><p class="simpara">
						The control node later uses this user to establish an SSH connection to this host.
					</p></li><li class="listitem"><p class="simpara">
						Set a password for the <code class="literal">ansible</code> user:
					</p><pre class="literallayout">[root@managed-node-01]# <span class="strong strong"><strong>passwd ansible</strong></span>
Changing password for user ansible.
New password: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
Retype new password: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
passwd: all authentication tokens updated successfully.</pre><p class="simpara">
						You must enter this password when Ansible uses <code class="literal">sudo</code> to perform tasks as the <code class="literal">root</code> user.
					</p></li><li class="listitem"><p class="simpara">
						Install the <code class="literal">ansible</code> user’s SSH public key on the managed node:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Log in to the control node as the <code class="literal">ansible</code> user, and copy the SSH public key to the managed node:
							</p><pre class="literallayout">[ansible@control-node]$ <span class="strong strong"><strong>ssh-copy-id managed-node-01.example.com</strong></span>
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/ansible/.ssh/id_rsa.pub"
The authenticity of host 'managed-node-01.example.com (192.0.2.100)' can't be established.
ECDSA key fingerprint is SHA256:9bZ33GJNODK3zbNhybokN/6Mq7hu3vpBXDrCxe7NAvo.</pre></li><li class="listitem"><p class="simpara">
								When prompted, connect by entering <code class="literal">yes</code>:
							</p><pre class="literallayout">Are you sure you want to continue connecting (yes/no/[fingerprint])? <span class="strong strong"><strong>yes</strong></span>
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys</pre></li><li class="listitem"><p class="simpara">
								When prompted, enter the password:
							</p><pre class="literallayout">ansible@managed-node-01.example.com's password: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh 'managed-node-01.example.com'"
and check to make sure that only the key(s) you wanted were added.</pre></li><li class="listitem"><p class="simpara">
								Verify the SSH connection by remotely executing a command on the control node:
							</p><pre class="literallayout">[ansible@control-node]$ <span class="strong strong"><strong>ssh managed-node-01.example.com whoami</strong></span>
ansible</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Create a <code class="literal">sudo</code> configuration for the <code class="literal">ansible</code> user:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create and edit the <code class="literal">/etc/sudoers.d/ansible</code> file by using the <code class="literal">visudo</code> command:
							</p><pre class="literallayout">[root@managed-node-01]# <span class="strong strong"><strong>visudo /etc/sudoers.d/ansible</strong></span></pre><p class="simpara">
								The benefit of using <code class="literal">visudo</code> over a normal editor is that this utility provides basic checks, such as for parse errors, before installing the file.
							</p></li><li class="listitem"><p class="simpara">
								Configure a <code class="literal">sudoers</code> policy in the <code class="literal">/etc/sudoers.d/ansible</code> file that meets your requirements, for example:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										To grant permissions to the <code class="literal">ansible</code> user to run all commands as any user and group on this host after entering the <code class="literal">ansible</code> user’s password, use:
									</p><pre class="literallayout">ansible   ALL=(ALL) ALL</pre></li><li class="listitem"><p class="simpara">
										To grant permissions to the <code class="literal">ansible</code> user to run all commands as any user and group on this host without entering the <code class="literal">ansible</code> user’s password, use:
									</p><pre class="literallayout">ansible   ALL=(ALL) NOPASSWD: ALL</pre></li></ul></div></li></ol></div><p class="simpara">
						Alternatively, configure a more fine-granular policy that matches your security requirements. For further details on <code class="literal">sudoers</code> policies, see the <code class="literal">sudoers(5)</code> manual page.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that you can execute commands from the control node on an all managed nodes:
					</p><pre class="literallayout white-space-pre">[ansible@control-node]$ <span class="strong strong"><strong>ansible all -m ping</strong></span>
BECOME password: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
managed-node-01.example.com | <span class="strong strong"><strong>SUCCESS</strong></span> =&gt; {
    	"ansible_facts": {
    	    "discovered_interpreter_python": "/usr/bin/python3"
    	},
    	"changed": false,
    	"ping": "pong"
}
...</pre><p class="simpara">
						The hard-coded all group dynamically contains all hosts listed in the inventory file.
					</p></li><li class="listitem"><p class="simpara">
						Verify that privilege escalation works correctly by running the <code class="literal">whoami</code> utility on all managed nodes by using the Ansible <code class="literal">command</code> module:
					</p><pre class="literallayout">[ansible@control-node]$ <span class="strong strong"><strong>ansible all -m command -a whoami</strong></span>
BECOME password: <span class="strong strong"><strong><span class="emphasis"><em>&lt;password&gt;</em></span></strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
<span class="strong strong"><strong>root</strong></span>
...</pre><p class="simpara">
						If the command returns root, you configured <code class="literal">sudo</code> on the managed nodes correctly.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>
					</li><li class="listitem">
						<code class="literal">sudoers(5)</code> manual page
					</li></ul></div></section></section><section class="chapter" id="ansible-vault_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Ansible vault</h2></div></div></div><p class="_abstract _abstract">
			Sometimes your playbook needs to use sensitive data such as passwords, API keys, and other secrets to configure managed hosts. Storing this information in plain text in variables or other Ansible-compatible files is a security risk because any user with access to those files can read the sensitive data.
		</p><p>
			With Ansible vault, you can encrypt, decrypt, view, and edit sensitive information. They could be included as:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Inserted variable files in an Ansible Playbook
				</li><li class="listitem">
					Host and group variables
				</li><li class="listitem">
					Variable files passed as arguments when executing the playbook
				</li><li class="listitem">
					Variables defined in Ansible roles
				</li></ul></div><p>
			You can use Ansible vault to securely manage individual variables, entire files, or even structured data like YAML files. This data can then be safely stored in a version control system or shared with team members without exposing sensitive information.
		</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
				Files are protected with symmetric encryption of the Advanced Encryption Standard (AES256), where a single password or passphrase is used both to encrypt and decrypt the data. Note that the way this is done has not been formally audited by a third party.
			</p></div></rh-alert><p>
			To simplify management, it makes sense to set up your Ansible project so that sensitive variables and all other variables are kept in separate files, or directories. Then you can protect the files containing sensitive variables with the <code class="literal">ansible-vault</code> command.
		</p><div class="formalpara"><p class="title"><strong>Creating an encrypted file</strong></p><p>
				The following command prompts you for a new vault password. Then it opens a file for storing sensitive variables using the default editor.
			</p></div><pre class="literallayout"># <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre><div class="formalpara"><p class="title"><strong>Viewing an encrypted file</strong></p><p>
				The following command prompts you for your existing vault password. Then it displays the sensitive contents of an already encrypted file.
			</p></div><pre class="literallayout"># <span class="strong strong"><strong>ansible-vault view vault.yml</strong></span>
Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
my_secret: "yJJvPqhsiusmmPPZdnjndkdnYNDjdj782meUZcw"</pre><div class="formalpara"><p class="title"><strong>Editing an encrypted file</strong></p><p>
				The following command prompts you for your existing vault password. Then it opens the already encrypted file for you to update the sensitive variables using the default editor.
			</p></div><pre class="literallayout"># <span class="strong strong"><strong>ansible-vault edit vault.yml</strong></span>
Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre><div class="formalpara"><p class="title"><strong>Encrypting an existing file</strong></p><p>
				The following command prompts you for a new vault password. Then it encrypts an existing unencrypted file.
			</p></div><pre class="literallayout"># <span class="strong strong"><strong>ansible-vault encrypt vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Encryption successful</pre><div class="formalpara"><p class="title"><strong>Decrypting an existing file</strong></p><p>
				The following command prompts you for your existing vault password. Then it decrypts an existing encrypted file.
			</p></div><pre class="literallayout"># <span class="strong strong"><strong>ansible-vault decrypt vault.yml</strong></span>
Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Decryption successful</pre><div class="formalpara"><p class="title"><strong>Changing the password of an encrypted file</strong></p><p>
				The following command prompts you for your original vault password, then for the new vault password.
			</p></div><pre class="literallayout"># <span class="strong strong"><strong>ansible-vault rekey vault.yml</strong></span>
Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Rekey successful</pre><div class="formalpara"><p class="title"><strong>Basic application of Ansible vault variables in a playbook</strong></p><p>

</p><pre class="programlisting language-yaml">---
- name: Create user accounts for all servers
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Create user from vault.yml file
      user:
        name: "{{ username }}"
        password: "{{ pwhash }}"</pre>

			<p></p></div><p>
			You read-in the file with variables (<code class="literal">vault.yml</code>) in the <code class="literal">vars_files</code> section of your Ansible Playbook, and you use the curly brackets the same way you would do with your ordinary variables. Then you either run the playbook with the <code class="literal">ansible-playbook --ask-vault-pass</code> command and you enter the password manually. Or you save the password in a separate file and you run the playbook with the <code class="literal">ansible-playbook --vault-password-file /path/to/my/vault-password-file</code> command.
		</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<code class="literal">ansible-vault(1)</code>, <code class="literal">ansible-playbook(1)</code> man pages on your system
				</li><li class="listitem">
					<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Ansible vault</a>
				</li><li class="listitem">
					<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html#variables-and-vaults">Ansible vault Best Practices</a>
				</li></ul></div></section><section class="chapter" id="assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Ansible IPMI modules in RHEL</h2></div></div></div><section class="section" id="ref_the-rhel_mgmt-collection_assembly_ansible-ipmi-modules-in-rhel"><div class="titlepage"><div><div><h3 class="title">4.1. The <code class="literal">rhel_mgmt</code> collection</h3></div></div></div><p class="_abstract _abstract">
				The Intelligent Platform Management Interface (IPMI) is a specification for a set of standard protocols to communicate with baseboard management controller (BMC) devices. The <code class="literal">IPMI</code> modules allow you to enable and support hardware management automation. The <code class="literal">IPMI</code> modules are available in:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">rhel_mgmt</code> Collection. The package name is <code class="literal">ansible-collection-redhat-rhel_mgmt</code>.
					</li><li class="listitem">
						The RHEL 8 AppStream, as part of the new <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package.
					</li></ul></div><p>
				The following IPMI modules are available in the rhel_mgmt collection:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipmi_boot</code>: Management of boot device order
					</li><li class="listitem">
						<code class="literal">ipmi_power</code>: Power management for machine
					</li></ul></div><p>
				The mandatory parameters used for the IPMI Modules are:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipmi_boot</code> parameters:
					</li></ul></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140064661588208" scope="col">Module name</th><th align="left" valign="top" id="idm140064661587120" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140064661588208"> <p>
								name
							</p>
							 </td><td align="left" valign="top" headers="idm140064661587120"> <p>
								Hostname or ip address of the BMC
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064661588208"> <p>
								password
							</p>
							 </td><td align="left" valign="top" headers="idm140064661587120"> <p>
								Password to connect to the BMC
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064661588208"> <p>
								bootdev
							</p>
							 </td><td align="left" valign="top" headers="idm140064661587120"> <p>
								Device to be used on next boot
							</p>
							 <p>
								* network
							</p>
							 <p>
								* floppy
							</p>
							 <p>
								* hd
							</p>
							 <p>
								* safe
							</p>
							 <p>
								* optical
							</p>
							 <p>
								* setup
							</p>
							 <p>
								* default
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064661588208"> <p>
								User
							</p>
							 </td><td align="left" valign="top" headers="idm140064661587120"> <p>
								Username to connect to the BMC
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipmi_power</code> parameters:
					</li></ul></div><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140064658043360" scope="col">Module name</th><th align="left" valign="top" id="idm140064658042272" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140064658043360"> <p>
								name
							</p>
							 </td><td align="left" valign="top" headers="idm140064658042272"> <p>
								BMC Hostname or IP address
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064658043360"> <p>
								password
							</p>
							 </td><td align="left" valign="top" headers="idm140064658042272"> <p>
								Password to connect to the BMC
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064658043360"> <p>
								user
							</p>
							 </td><td align="left" valign="top" headers="idm140064658042272"> <p>
								Username to connect to the BMC
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064658043360"> <p>
								State
							</p>
							 </td><td align="left" valign="top" headers="idm140064658042272"> <p>
								Check if the machine is on the desired status
							</p>
							 <p>
								* on
							</p>
							 <p>
								* off
							</p>
							 <p>
								* shutdown
							</p>
							 <p>
								* reset
							</p>
							 <p>
								* boot
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="proc_example-using-the-ipmi_boot-module_assembly_ansible-ipmi-modules-in-rhel"><div class="titlepage"><div><div><h3 class="title">4.2. Using the <code class="literal">ipmi_boot</code> module</h3></div></div></div><p>
				The following example shows how to use the <code class="literal">ipmi_boot</code> module in a playbook to set a boot device for the next boot. For simplicity, the examples use the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">python3-pyghmi</code> package is installed either on the control node or the managed nodes.
					</li><li class="listitem">
						The IPMI BMC that you want to control is accessible over network from the control node or the managed host (if not using <code class="literal">localhost</code> as the managed host). Note that the host whose BMC is being configured by the module is generally different from the managed host, as the module contacts the BMC over the network using the IPMI protocol.
					</li><li class="listitem">
						You have credentials to access BMC with an appropriate level of access.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Set boot device to be used on next boot
  hosts: managed-node-01.example.com
  tasks:
    - name: Ensure boot device is HD
      redhat.rhel_mgmt.ipmi_boot:
        user: <span class="emphasis"><em>&lt;admin_user&gt;</em></span>
        password: <span class="emphasis"><em>&lt;password&gt;</em></span>
        bootdev: hd</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						When you run the playbook, Ansible returns <code class="literal">success</code>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_example-using-the-ipmi_power-module_assembly_ansible-ipmi-modules-in-rhel"><div class="titlepage"><div><div><h3 class="title">4.3. Using the <code class="literal">ipmi_power</code> module</h3></div></div></div><p>
				This example shows how to use the <code class="literal">ipmi_boot</code> module in a playbook to check if the system is turned on. For simplicity, the examples use the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">python3-pyghmi</code> package is installed either on the control node or the managed nodes.
					</li><li class="listitem">
						The IPMI BMC that you want to control is accessible over network from the control node or the managed host (if not using <code class="literal">localhost</code> as the managed host). Note that the host whose BMC is being configured by the module is generally different from the managed host, as the module contacts the BMC over the network using the IPMI protocol.
					</li><li class="listitem">
						You have credentials to access BMC with an appropriate level of access.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Power management
  hosts: managed-node-01.example.com
  tasks:
    - name: Ensure machine is powered on
      redhat.rhel_mgmt.ipmi_power:
        user: <span class="emphasis"><em>&lt;admin_user&gt;</em></span>
        password: <span class="emphasis"><em>&lt;password&gt;</em></span>
        state: on</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						When you run the playbook, Ansible returns <code class="literal">true</code>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md</code> file
					</li></ul></div></section></section><section class="chapter" id="assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 5. The Redfish modules in RHEL</h2></div></div></div><p>
			The Redfish modules for remote management of devices are now part of the <code class="literal">redhat.rhel_mgmt</code> Ansible collection. With the Redfish modules, you can easily use management automation on bare-metal servers and platform hardware by getting information about the servers or control them through an Out-Of-Band (OOB) controller, using the standard HTTPS transport and JSON format.
		</p><section class="section" id="con_the-redfish-modules_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h3 class="title">5.1. The Redfish modules</h3></div></div></div><p>
				The <code class="literal">redhat.rhel_mgmt</code> Ansible collection provides the Redfish modules to support hardware management in Ansible over Redfish. The <code class="literal">redhat.rhel_mgmt</code> collection is available in the <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package. To install it, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_installing-the-rhel-mgmt-collection-by-using-the-cli_assembly_ansible-ipmi-modules-in-rhel">Installing the redhat.rhel_mgmt Collection using the CLI</a>.
			</p><p>
				The following Redfish modules are available in the <code class="literal">redhat.rhel_mgmt</code> collection:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>redfish_info</strong></span></code>: The <code class="literal">redfish_info</code> module retrieves information about the remote Out-Of-Band (OOB) controller such as systems inventory.
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>redfish_command</strong></span></code>: The <code class="literal">redfish_command</code> module performs Out-Of-Band (OOB) controller operations like log management and user management, and power operations such as system restart, power on and off.
					</li><li class="listitem">
						<code class="literal"><span class="strong strong"><strong>redfish_config</strong></span></code>: The <code class="literal">redfish_config</code> module performs OOB controller operations such as changing OOB configuration, or setting the BIOS configuration.
					</li></ol></div></section><section class="section" id="ref_redfish-modules-parameters_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h3 class="title">5.2. Redfish modules parameters</h3></div></div></div><p>
				The parameters used for the Redfish modules are:
			</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140064660561440" scope="col"><code class="literal">redfish_info</code> parameters:</th><th align="left" valign="top" id="idm140064660560032" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140064660561440"> <p>
								<code class="literal">baseuri</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064660560032"> <p>
								(Mandatory) - Base URI of OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064660561440"> <p>
								<code class="literal">category</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064660560032"> <p>
								(Mandatory) - List of categories to execute on OOB controller. The default value is ["Systems"].
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064660561440"> <p>
								<code class="literal">command</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064660560032"> <p>
								(Mandatory) - List of commands to execute on OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064660561440"> <p>
								<code class="literal">username</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064660560032"> <p>
								Username for authentication to OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064660561440"> <p>
								<code class="literal">password</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064660560032"> <p>
								Password for authentication to OOB controller.
							</p>
							 </td></tr></tbody></table></rh-table><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140064650863856" scope="col"><code class="literal">redfish_command</code> parameters:</th><th align="left" valign="top" id="idm140064647141792" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140064650863856"> <p>
								<code class="literal">baseuri</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647141792"> <p>
								(Mandatory) - Base URI of OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064650863856"> <p>
								<code class="literal">category</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647141792"> <p>
								(Mandatory) - List of categories to execute on OOB controller. The default value is ["Systems"].
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064650863856"> <p>
								<code class="literal">command</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647141792"> <p>
								(Mandatory) - List of commands to execute on OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064650863856"> <p>
								<code class="literal">username</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647141792"> <p>
								Username for authentication to OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064650863856"> <p>
								<code class="literal">password</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647141792"> <p>
								Password for authentication to OOB controller.
							</p>
							 </td></tr></tbody></table></rh-table><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140064641210352" scope="col"><code class="literal">redfish_config</code> parameters:</th><th align="left" valign="top" id="idm140064641208944" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140064641210352"> <p>
								<code class="literal">baseuri</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064641208944"> <p>
								(Mandatory) - Base URI of OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064641210352"> <p>
								<code class="literal">category</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064641208944"> <p>
								(Mandatory) - List of categories to execute on OOB controller. The default value is ["Systems"].
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064641210352"> <p>
								<code class="literal">command</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064641208944"> <p>
								(Mandatory) - List of commands to execute on OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064641210352"> <p>
								<code class="literal">username</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064641208944"> <p>
								Username for authentication to OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064641210352"> <p>
								<code class="literal">password</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064641208944"> <p>
								Password for authentication to OOB controller.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064641210352"> <p>
								<code class="literal">bios_attributes</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064641208944"> <p>
								BIOS attributes to update.
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="proc_using-the-redfish-info-module_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h3 class="title">5.3. Using the <code class="literal">redfish_info</code> module</h3></div></div></div><p>
				The following example shows how to use the <code class="literal">redfish_info</code> module in a playbook to get information about the CPU inventory. For simplicity, the example uses the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">python3-pyghmi</code> package is installed either on the control node or the managed nodes.
					</li><li class="listitem">
						OOB controller access details.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage out-of-band controllers using Redfish APIs
  hosts: managed-node-01.example.com
  tasks:
    - name: Get CPU inventory
      redhat.rhel_mgmt.redfish_info:
        baseuri: "<span class="emphasis"><em>&lt;URI&gt;</em></span>"
        username: "<span class="emphasis"><em>&lt;username&gt;</em></span>"
        password: "<span class="emphasis"><em>&lt;password&gt;</em></span>"
        category: Systems
        command: GetCpuInventory
      register: result</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						When you run the playbook, Ansible returns the CPU inventory details.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_using-the-redfish-command-module_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h3 class="title">5.4. Using the <code class="literal">redfish_command</code> module</h3></div></div></div><p>
				The following example shows how to use the <code class="literal">redfish_command</code> module in a playbook to turn on a system. For simplicity, the example uses the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">python3-pyghmi</code> package is installed either on the control node or the managed nodes.
					</li><li class="listitem">
						OOB controller access details.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage out-of-band controllers using Redfish APIs
  hosts: managed-node-01.example.com
  tasks:
    - name: Power on system
      redhat.rhel_mgmt.redfish_command:
        baseuri: "<span class="emphasis"><em>&lt;URI&gt;</em></span>"
        username: "<span class="emphasis"><em>&lt;username&gt;</em></span>"
        password: "<span class="emphasis"><em>&lt;password&gt;</em></span>"
        category: Systems
        command: PowerOn</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system powers on.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md</code> file
					</li></ul></div></section><section class="section" id="proc_using-the-redfish-config-module_assembly_the-redfish-modules-in-rhel"><div class="titlepage"><div><div><h3 class="title">5.5. Using the <code class="literal">redfish_config</code> module</h3></div></div></div><p>
				The following example shows how to use the <code class="literal">redfish_config</code> module in a playbook to configure a system to boot with UEFI. For simplicity, the example uses the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The <code class="literal">ansible-collection-redhat-rhel_mgmt</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">python3-pyghmi</code> package is installed either on the control node or the managed nodes.
					</li><li class="listitem">
						OOB controller access details.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manages out-of-band controllers using Redfish APIs
  hosts: managed-node-01.example.com
  tasks:
    - name: Set BootMode to UEFI
      redhat.rhel_mgmt.redfish_config:
        baseuri: "<span class="emphasis"><em>&lt;URI&gt;</em></span>"
        username: "<span class="emphasis"><em>&lt;username&gt;</em></span>"
        password: "<span class="emphasis"><em>&lt;password&gt;</em></span>"
	category: Systems
        command: SetBiosAttributes
        bios_attributes:
          BootMode: Uefi</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system boot mode is set to UEFI.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md</code> file
					</li></ul></div></section></section><section class="chapter" id="integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Joining RHEL systems to an Active Directory by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			If your organization uses Microsoft Active Directory (AD) to centrally manage users, groups, and other resources, you can join your Red Hat Enterprise Linux (RHEL) host to this AD. For example, AD users can then log into RHEL and you can make services on the RHEL host available for authenticated AD users. By using the <code class="literal">ad_integration</code> RHEL system role, you can automate the integration of Red Hat Enterprise Linux system into an Active Directory (AD) domain.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				The <code class="literal">ad_integration</code> role is for deployments using direct AD integration without an Identity Management (IdM) environment. For IdM environments, use the <code class="literal">ansible-freeipa</code> roles.
			</p></div></rh-alert><section class="section" id="connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">6.1. Joining RHEL to an Active Directory domain by using the <code class="literal">ad_integration</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">ad_integration</code> RHEL system role to automate the process of joining RHEL to an Active Directory (AD) domain.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed node uses a DNS server that can resolve AD DNS entries.
					</li><li class="listitem">
						Credentials of an AD account which has permissions to join computers to the domain.
					</li><li class="listitem"><p class="simpara">
						The managed node can establish connections to AD domain controllers by using the following ports:
					</p><rh-table><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 20%; " class="col_2"><!--Empty--><col style="width: 20%; " class="col_3"><!--Empty--><col style="width: 40%; " class="col_4"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140064646940240" scope="col">Source Ports</th><th align="left" valign="top" id="idm140064646939152" scope="col">Destination Port</th><th align="left" valign="top" id="idm140064646938064" scope="col">Protocol</th><th align="left" valign="top" id="idm140064646936976" scope="col">Service</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										53
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										UDP and TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										DNS
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										389
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										UDP and TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										LDAP
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										636
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										LDAPS
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										88
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										UDP and TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										Kerberos
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										464
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										UDP and TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										Kerberos password change requests
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										3268
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										LDAP Global Catalog
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										3269
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										LDAPS Global Catalog
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										123
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										UDP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										NTP (if time synchronization is enabled)
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140064646940240"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140064646939152"> <p>
										323
									</p>
									 </td><td align="left" valign="top" headers="idm140064646938064"> <p>
										UDP
									</p>
									 </td><td align="left" valign="top" headers="idm140064646936976"> <p>
										NTP (if time synchronization is enabled)
									</p>
									 </td></tr></tbody></table></rh-table></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">usr: administrator
pwd: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Active Directory integration
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Join an Active Directory
      ansible.builtin.include_role:
        name: rhel-system-roles.ad_integration
      vars:
        ad_integration_user: "{{ usr }}"
        ad_integration_password: "{{ pwd }}"
        ad_integration_realm: "ad.example.com"
        ad_integration_allow_rc4_crypto: false
        ad_integration_timesync_source: "time_server.ad.example.com"</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ad_integration_allow_rc4_crypto: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd><p class="simpara">
									Configures whether the role activates the <code class="literal">AD-SUPPORT</code> crypto policy on the managed node. By default, RHEL does not support the weak RC4 encryption but, if Kerberos in your AD still requires RC4, you can enable this encryption type by setting <code class="literal">ad_integration_allow_rc4_crypto: true</code>.
								</p><p class="simpara">
									Omit this the variable or set it to <code class="literal">false</code> if Kerberos uses AES encryption.
								</p></dd><dt><span class="term"><code class="literal">ad_integration_timesync_source: <span class="emphasis"><em>&lt;time_server&gt;</em></span></code></span></dt><dd>
									Specifies the NTP server to use for time synchronization. Kerberos requires a synchronized time among AD domain controllers and domain members to prevent replay attacks. If you omit this variable, the <code class="literal">ad_integration</code> role does not utilize the <code class="literal">timesync</code> RHEL system role to configure time synchronization on the managed node.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check if AD users, such as <code class="literal">administrator</code>, are available locally on the managed node:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'getent passwd administrator@ad.example.com'</strong></span>
administrator@ad.example.com:*:1450400500:1450400513:Administrator:/home/administrator@ad.example.com:/bin/bash</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ad_integration/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section></section><section class="chapter" id="requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			Many services, such as web servers, use TLS to encrypt connections with clients. These services require a private key and a certificate, and a trusted certificate authority (CA) which signs the certificate.
		</p><p>
			By using the <code class="literal">certificate</code> RHEL system role, you can automate the generation of private keys on managed nodes. Additionally, the role configures the <code class="literal">certmonger</code> service to send the certificate signing request (CSR) to a CA, and the service automatically renews the certificate before it expires.
		</p><p>
			For testing purposes, you can use the <code class="literal">certificate</code> role to create self-signed certificates instead of requesting a signed certificate from a CA.
		</p><section class="section" id="requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">7.1. Requesting a new certificate from an IdM CA by using the <code class="literal">certificate</code> RHEL system role</h3></div></div></div><p>
				If a Red Hat Enterprise Linux host is a member of a RHEL Identity Management (IdM) environment, you can request TLS certificates from the IdM certificate authority (CA) and use them in the services that run on this host. By using the <code class="literal">certificate</code> RHEL system role, you can automate the process of creating a private key and letting the <code class="literal">certmonger</code> service request a certificate from the CA. By default, <code class="literal">certmonger</code> will also renew the certificate before it expires.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed node is a member of an IdM domain and the domain uses the IdM-integrated CA.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create certificates
  hosts: managed-node-01.example.com
  tasks:
    - name: Create a self-signed certificate
      ansible.builtin.include_role:
        name: rhel-system-roles.certificate
      vars:
        certificate_requests:
          - name: web-server
            ca: ipa
            dns: www.example.com
            principal: HTTP/www.example.com@EXAMPLE.COM
            run_before: systemctl stop httpd.service
            run_after: systemctl start httpd.service</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">name: <span class="emphasis"><em>&lt;path_or_file_name&gt;</em></span></code></span></dt><dd><p class="simpara">
									Defines the name or path of the generated private key and certificate file:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											If you set the variable to <code class="literal">web-server</code>, the role stores the private key in the <code class="literal">/etc/pki/tls/private/web-server.key</code> and the certificate in the <code class="literal">/etc/pki/tls/certs/web-server.crt</code> files.
										</li><li class="listitem"><p class="simpara">
											If you set the variable to a path, such as <code class="literal">/tmp/web-server</code>, the role stores the private key in the <code class="literal">/tmp/web-server.key</code> and the certificate in the <code class="literal">/tmp/web-server.crt</code> files.
										</p><p class="simpara">
											Note that the directory you use must have the <code class="literal">cert_t</code> SELinux context set. You can use the <code class="literal">selinux</code> RHEL system role to manage SELinux contexts.
										</p></li></ul></div></dd><dt><span class="term"><code class="literal">ca: ipa</code></span></dt><dd>
									Defines that the role requests the certificate from an IdM CA.
								</dd><dt><span class="term"><code class="literal">dns: <span class="emphasis"><em>&lt;hostname_or_list_of_hostnames&gt;</em></span></code></span></dt><dd>
									Sets the hostnames that the Subject Alternative Names (SAN) field in the issued certificate contains. You can use a wildcard (<code class="literal">*</code>) or specify multiple names in YAML list format.
								</dd><dt><span class="term"><code class="literal">principal: <span class="emphasis"><em>&lt;kerberos_principal&gt;</em></span></code></span></dt><dd>
									Optional: Sets the Kerberos principal that should be included in the certificate.
								</dd><dt><span class="term"><code class="literal">run_before: <span class="emphasis"><em>&lt;command&gt;</em></span></code></span></dt><dd>
									Optional: Defines a command that <code class="literal">certmonger</code> should execute before requesting the certificate from the CA.
								</dd><dt><span class="term"><code class="literal">run_after: <span class="emphasis"><em>&lt;command&gt;</em></span></code></span></dt><dd>
									Optional: Defines a command that <code class="literal">certmonger</code> should execute after it received the issued certificate from the CA.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List the certificates that the <code class="literal">certmonger</code> service manages:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'getcert list'</strong></span>
...
Number of certificates and requests being tracked: 1.
Request ID '20240918142211':
        status: MONITORING
        stuck: no
        key pair storage: type=FILE,location='/etc/pki/tls/private/web-server.key'
        certificate: type=FILE,location='/etc/pki/tls/certs/web-server.crt'
        CA: IPA
        issuer: CN=Certificate Authority,O=EXAMPLE.COM
        subject: CN=www.example.com
        issued: 2024-09-18 16:22:11 CEST
        expires: 2025-09-18 16:22:10 CEST
        dns: www.example.com
        key usage: digitalSignature,keyEncipherment
        eku: id-kp-serverAuth,id-kp-clientAuth
        pre-save command: systemctl stop httpd.service
        post-save command: systemctl start httpd.service
        track: yes
        auto-renew: yes</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/certificate/</code> directory
					</li></ul></div></section><section class="section" id="requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">7.2. Requesting a new self-signed certificate by using the <code class="literal">certificate</code> RHEL system role</h3></div></div></div><p>
				If you require a TLS certificate for a test environment, you can use a self-signed certificate. By using the <code class="literal">certificate</code> RHEL system role, you can automate the process of creating a private key and letting the <code class="literal">certmonger</code> service create a self-signed certificate. By default, <code class="literal">certmonger</code> will also renew the certificate before it expires.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create certificates
  hosts: managed-node-01.example.com
  tasks:
    - name: Create a self-signed certificate
      ansible.builtin.include_role:
        name: rhel-system-roles.certificate
      vars:
        certificate_requests:
          - name: web-server
            ca: self-sign
            dns: test.example.com</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">name: <span class="emphasis"><em>&lt;path_or_file_name&gt;</em></span></code></span></dt><dd><p class="simpara">
									Defines the name or path of the generated private key and certificate file:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											If you set the variable to <code class="literal">web-server</code>, the role stores the private key in the <code class="literal">/etc/pki/tls/private/web-server.key</code> and the certificate in the <code class="literal">/etc/pki/tls/certs/web-server.crt</code> files.
										</li><li class="listitem"><p class="simpara">
											If you set the variable to a path, such as <code class="literal">/tmp/web-server</code>, the role stores the private key in the <code class="literal">/tmp/web-server.key</code> and the certificate in the <code class="literal">/tmp/web-server.crt</code> files.
										</p><p class="simpara">
											Note that the directory you use must have the <code class="literal">cert_t</code> SELinux context set. You can use the <code class="literal">selinux</code> RHEL system role to manage SELinux contexts.
										</p></li></ul></div></dd><dt><span class="term"><code class="literal">ca: self-sign</code></span></dt><dd>
									Defines that the role created a self-signed certificate.
								</dd><dt><span class="term"><code class="literal">dns: <span class="emphasis"><em>&lt;hostname_or_list_of_hostnames&gt;</em></span></code></span></dt><dd>
									Sets the hostnames that the Subject Alternative Names (SAN) field in the issued certificate contains. You can use a wildcard (<code class="literal">*</code>) or specify multiple names in YAML list format.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List the certificates that the <code class="literal">certmonger</code> service manages:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'getcert list'</strong></span>
...
Number of certificates and requests being tracked: 1.
Request ID '20240918133610':
	status: MONITORING
	stuck: no
	key pair storage: type=FILE,location='/etc/pki/tls/private/web-server.key'
	certificate: type=FILE,location='/etc/pki/tls/certs/web-server.crt'
	CA: local
	issuer: CN=c32b16d7-5b1a4c5a-a953a711-c3ca58fb,CN=Local Signing Authority
	subject: CN=test.example.com
	issued: 2024-09-18 15:36:10 CEST
	expires: 2025-09-18 15:36:09 CEST
	dns: test.example.com
	key usage: digitalSignature,keyEncipherment
	eku: id-kp-serverAuth,id-kp-clientAuth
	pre-save command:
	post-save command:
	track: yes
	auto-renew: yes</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/certificate/</code> directory
					</li></ul></div></section></section><section class="chapter" id="assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Installing and configuring web console by using RHEL system roles</h2></div></div></div><p>
			With the <code class="literal">cockpit</code> RHEL system role, you can automatically deploy and enable the web console on multiple RHEL systems.
		</p><section class="section" id="proc_installing-the-web-console-by-using-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">8.1. Installing the web console by using the <code class="literal">cockpit</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">cockpit</code> system role to automate installing and enabling the RHEL web console on multiple systems.
			</p><p>
				In this example, you use the <code class="literal">cockpit</code> system role to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Install the RHEL web console.
					</li><li class="listitem">
						Configure the web console to use a custom port number (9050/tcp). By default, the web console uses port 9090.
					</li><li class="listitem">
						Allow the <code class="literal">firewalld</code> and <code class="literal">selinux</code> system roles to configure the system for opening new ports.
					</li><li class="listitem">
						Set the web console to use a certificate from the <code class="literal">ipa</code> trusted certificate authority instead of using a self-signed certificate.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You do not have to call the <code class="literal">firewall</code> or <code class="literal">certificate</code> system roles in the playbook to manage the firewall or create the certificate. The <code class="literal">cockpit</code> system role calls them automatically as needed.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example, <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage the RHEL web console
  hosts: managed-node-01.example.com
  tasks:
    - name: Install RHEL web console
      ansible.builtin.include_role:
        name: rhel-system-roles.cockpit
      vars:
        cockpit_packages: default
        cockpit_port: 9050
        cockpit_manage_selinux: true
        cockpit_manage_firewall: true
        cockpit_certificates:
          - name: /etc/cockpit/ws-certs.d/01-certificate
            dns: ['localhost', 'www.example.com']
            ca: ipa</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">cockpit_manage_selinux: true</code></span></dt><dd>
									Allow using the <code class="literal">selinux</code> system role to configure SELinux for setting up the correct port permissions on the <code class="literal">websm_port_t</code> SELinux type.
								</dd><dt><span class="term"><code class="literal">cockpit_manage_firewall: true</code></span></dt><dd>
									Allow the <code class="literal">cockpit</code> system role to use the <code class="literal">firewalld</code> system role for adding ports.
								</dd><dt><span class="term"><code class="literal">cockpit_certificates: &lt;YAML_dictionary&gt;</code></span></dt><dd><p class="simpara">
									By default, the RHEL web console uses a self-signed certificate. Alternatively, you can add the <code class="literal">cockpit_certificates</code> variable to the playbook and configure the role to request certificates from an IdM certificate authority (CA) or to use an existing certificate and private key that is available on the managed node.
								</p><p class="simpara">
									For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.cockpit/README.md</code> file on the control node.
								</p></dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.cockpit/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/cockpit</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL system roles</a>
					</li></ul></div></section></section><section class="chapter" id="setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Setting a custom cryptographic policy by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			Custom cryptographic policies are a set of rules and configurations that manage the use of cryptographic algorithms and protocols. These policies help you to maintain a protected, consistent, and manageable security environment across multiple systems and applications.
		</p><p>
			By using the <code class="literal">crypto_policies</code> RHEL system role, you can quickly and consistently configure custom cryptographic policies across many operating systems in an automated fashion.
		</p><section class="section" id="proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">9.1. Enhancing security with the <code class="literal">FUTURE</code> cryptographic policy using the <code class="literal">crypto_policies</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">crypto_policies</code> RHEL system role to configure the <code class="literal">FUTURE</code> policy on your managed nodes. This policy helps to achieve for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Future-proofing against emerging threats: anticipates advancements in computational power.
					</li><li class="listitem">
						Enhanced security: stronger encryption standards require longer key lengths and more secure algorithms.
					</li><li class="listitem">
						Compliance with high-security standards: for example in healthcare, telco, and finance the data sensitivity is high, and availability of strong cryptography is critical.
					</li></ul></div><p>
				Typically, <code class="literal">FUTURE</code> is suitable for environments handling highly sensitive data, preparing for future regulations, or adopting long-term security strategies.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Legacy systems or software does not have to support the more modern and stricter algorithms and protocols enforced by the <code class="literal">FUTURE</code> policy. For example, older systems might not support TLS 1.3 or larger key sizes. This could lead to compatibility problems.
				</p><p>
					Also, using strong algorithms usually increases the computational workload, which could negatively affect your system performance.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure cryptographic policies
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure the FUTURE cryptographic security policy on the managed node
      ansible.builtin.include_role:
        name: rhel-system-roles.crypto_policies
      vars:
        - crypto_policies_policy: <span class="emphasis"><em>FUTURE</em></span>
        - crypto_policies_reboot_ok: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">crypto_policies_policy: <span class="emphasis"><em>FUTURE</em></span></code></span></dt><dd>
									Configures the required cryptographic policy (<code class="literal">FUTURE</code>) on the managed node. It can be either the base policy or a base policy with some sub-policies. The specified base policy and sub-policies have to be available on the managed node. The default value is <code class="literal">null</code>. It means that the configuration is not changed and the <code class="literal">crypto_policies</code> RHEL system role will only collect the Ansible facts.
								</dd><dt><span class="term"><code class="literal">crypto_policies_reboot_ok: <span class="emphasis"><em>true</em></span></code></span></dt><dd>
									Causes the system to reboot after the cryptographic policy change to make sure all of the services and applications will read the new configuration files. The default value is <code class="literal">false</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Because the <code class="literal">FIPS:OSPP</code> system-wide subpolicy contains further restrictions for cryptographic algorithms required by the Common Criteria (CC) certification, the system is less interoperable after you set it. For example, you cannot use RSA and DH keys shorter than 3072 bits, additional SSH algorithms, and several TLS groups. Setting <code class="literal">FIPS:OSPP</code> also prevents connecting to Red Hat Content Delivery Network (CDN) structure. Furthermore, you cannot integrate Active Directory (AD) into the IdM deployments that use <code class="literal">FIPS:OSPP</code>, communication between RHEL hosts using <code class="literal">FIPS:OSPP</code> and AD domains might not work, or some AD accounts might not be able to authenticate.
				</p><p>
					Note that your <span class="strong strong"><strong>system is not CC-compliant</strong></span> after you set the <code class="literal">FIPS:OSPP</code> cryptographic subpolicy. The only correct way to make your RHEL system compliant with the CC standard is by following the guidance provided in the <code class="literal">cc-config</code> package. See the <a class="link" href="https://access.redhat.com/articles/compliance_activities_and_gov_standards#common-criteria-1">Common Criteria</a> section in the Compliance Activities and Government Standards Knowledgebase article for a list of certified RHEL versions, validation reports, and links to CC guides hosted at the <a class="link" href="https://www.niap-ccevs.org/">National Information Assurance Partnership (NIAP)</a> website.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the control node, create another playbook named, for example, <code class="literal">verify_playbook.yml</code>:
					</p><pre class="programlisting language-yaml">---
- name: Verification
  hosts: managed-node-01.example.com
  tasks:
    - name: Verify active cryptographic policy
      ansible.builtin.include_role:
        name: rhel-system-roles.crypto_policies
    - name: Display the currently active cryptographic policy
      ansible.builtin.debug:
        var: crypto_policies_active</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">crypto_policies_active</code></span></dt><dd>
									An exported Ansible fact that contains the currently active policy name in the format as accepted by the <code class="literal">crypto_policies_policy</code> variable.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/verify_playbook.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/verify_playbook.yml</strong></span>
TASK [debug] **************************
ok: [host] =&gt; {
    "crypto_policies_active": "FUTURE"
}</pre><p class="simpara">
						The <code class="literal">crypto_policies_active</code> variable shows the active policy on the managed node.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/crypto_policies/</code> directory
					</li><li class="listitem">
						<code class="literal">update-crypto-policies(8)</code> and <code class="literal">crypto-policies(7)</code> manual pages
					</li></ul></div></section></section><section class="chapter" id="assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Configuring <code class="literal">firewalld</code> by using RHEL system roles</h2></div></div></div><p>
			RHEL system roles is a set of contents for the Ansible automation utility. This content together with the Ansible automation utility provides a consistent configuration interface to remotely manage multiple systems at once.
		</p><p>
			The <code class="literal">rhel-system-roles</code> package contains the <code class="literal">rhel-system-roles.firewall</code> RHEL system role. This role was introduced for automated configurations of the <code class="literal">firewalld</code> service.
		</p><p>
			With the <code class="literal">firewall</code> RHEL system role you can configure many different <code class="literal">firewalld</code> parameters, for example:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Zones
				</li><li class="listitem">
					The services for which packets should be allowed
				</li><li class="listitem">
					Granting, rejection, or dropping of traffic access to ports
				</li><li class="listitem">
					Forwarding of ports or port ranges for a zone
				</li></ul></div><section class="section" id="proc_resetting-the-firewalld-settings-using-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles"><div class="titlepage"><div><div><h3 class="title">10.1. Resetting the <code class="literal">firewalld</code> settings by using the <code class="literal">firewall</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				Over time, updates to your firewall configuration can accumulate to the point, where they could lead to unintended security risks. With the <code class="literal">firewall</code> RHEL system role, you can reset the <code class="literal">firewalld</code> settings to their default state in an automated fashion. This way you can efficiently remove any unintentional or insecure firewall rules and simplify their management.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Reset firewalld example
  hosts: managed-node-01.example.com
  tasks:
    - name: Reset firewalld
      ansible.builtin.include_role:
        name: rhel-system-roles.firewall
      vars:
        firewall:
          - previous: replaced</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">previous: replaced</code></span></dt><dd><p class="simpara">
									Removes all existing user-defined settings and resets the <code class="literal">firewalld</code> settings to defaults. If you combine the <code class="literal">previous:replaced</code> parameter with other settings, the <code class="literal">firewall</code> role removes all existing settings before applying new ones.
								</p><p class="simpara">
									For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code> file on the control node.
								</p></dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Run this command on the control node to remotely check that all firewall configuration on your managed node was reset to its default values:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.command -a 'firewall-cmd --list-all-zones'</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/firewall/</code> directory
					</li></ul></div></section><section class="section" id="proc_forwarding-incoming-traffic-from-one-local-port-to-a-different-local-port_assembly_configuring-firewalld-using-system-roles"><div class="titlepage"><div><div><h3 class="title">10.2. Forwarding incoming traffic in <code class="literal">firewalld</code> from one local port to a different local port by using the <code class="literal">firewall</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">firewall</code> RHEL system role to remotely configure forwarding of incoming traffic from one local port to a different local port.
			</p><p>
				For example, if you have an environment where multiple services co-exist on the same machine and need the same default port, there are likely to become port conflicts. These conflicts can disrupt services and cause a downtime. With the <code class="literal">firewall</code> RHEL system role, you can efficiently forward traffic to alternative ports to ensure that your services can run simultaneously without modification to their configuration.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure firewalld
  hosts: managed-node-01.example.com
  tasks:
    - name: Forward incoming traffic on port 8080 to 443
      ansible.builtin.include_role:
        name: rhel-system-roles.firewall
      vars:
        firewall:
          - forward_port: 8080/tcp;443;
            state: enabled
            runtime: true
            permanent: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">forward_port: 8080/tcp;443</code></span></dt><dd>
									Traffic coming to the local port 8080 using the TCP protocol is forwarded to the port 443.
								</dd><dt><span class="term"><code class="literal">runtime: true</code></span></dt><dd><p class="simpara">
									Enables changes in the runtime configuration. The default is set to <code class="literal">true</code>.
								</p><p class="simpara">
									For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code> file on the control node.
								</p></dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node, run the following command to remotely check the forwarded-ports on your managed node:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.command -a 'firewall-cmd --list-forward-ports'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
port=8080:proto=tcp:toport=443:toaddr=</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/firewall/</code> directory
					</li></ul></div></section><section class="section" id="configuring-a-dmz-firewalld-zone-by-using-the-firewalld-rhel-system-role_assembly_configuring-firewalld-using-system-roles"><div class="titlepage"><div><div><h3 class="title">10.3. Configuring a <code class="literal">firewalld</code> DMZ zone by using the <code class="literal">firewall</code> RHEL system role</h3></div></div></div><p>
				As a system administrator, you can use the <code class="literal">firewall</code> RHEL system role to configure a <code class="literal">dmz</code> zone on the <span class="strong strong"><strong>enp1s0</strong></span> interface to permit <code class="literal">HTTPS</code> traffic to the zone. In this way, you enable external users to access your web servers.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure firewalld
  hosts: managed-node-01.example.com
  tasks:
    - name: Creating a DMZ with access to HTTPS port and masquerading for hosts in DMZ
      ansible.builtin.include_role:
        name: rhel-system-roles.firewall
      vars:
        firewall:
          - zone: dmz
            interface: enp1s0
            service: https
            state: enabled
            runtime: true
            permanent: true</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node, run the following command to remotely check the information about the <code class="literal">dmz</code> zone on your managed node:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.command -a 'firewall-cmd --zone=dmz --list-all'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
dmz (active)
  target: default
  icmp-block-inversion: no
  <span class="strong strong"><strong>interfaces: enp1s0</strong></span>
  sources:
  <span class="strong strong"><strong>services: https</strong></span> ssh
  ports:
  protocols:
  forward: no
  masquerade: no
  forward-ports:
  source-ports:
  icmp-blocks:</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/firewall/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Configuring a high-availability cluster by using RHEL system roles</h2></div></div></div><p>
			With the <code class="literal">ha_cluster</code> system role, you can configure and manage a high-availability cluster that uses the Pacemaker high availability cluster resource manager.
		</p><section class="section" id="ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.1. Variables of the <code class="literal">ha_cluster</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				In an <code class="literal">ha_cluster</code> RHEL system role playbook, you define the variables for a high availability cluster according to the requirements of your cluster deployment.
			</p><p>
				The variables you can set for an <code class="literal">ha_cluster</code> RHEL system role are as follows:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_enable_repos</code></span></dt><dd>
							A boolean flag that enables the repositories containing the packages that are needed by the <code class="literal">ha_cluster</code> RHEL system role. When this variable is set to <code class="literal">true</code>, the default value, you must have active subscription coverage for RHEL and the RHEL High Availability Add-On on the systems that you will use as your cluster members or the system role will fail.
						</dd><dt><span class="term"><code class="literal">ha_cluster_enable_repos_resilient_storage</code></span></dt><dd>
							(RHEL 9.4 and later) A boolean flag that enables the repositories containing resilient storage packages, such as <code class="literal">dlm</code> or <code class="literal">gfs2</code>. For this option to take effect, <code class="literal">ha_cluster_enable_repos</code> must be set to <code class="literal">true</code>. The default value of this variable is <code class="literal">false</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall</code></span></dt><dd><p class="simpara">
							(RHEL 9.2 and later) A boolean flag that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall. When <code class="literal">ha_cluster_manage_firewall</code> is set to <code class="literal">true</code>, the firewall high availability service and the <code class="literal">fence-virt</code> port are enabled. When <code class="literal">ha_cluster_manage_firewall</code> is set to <code class="literal">false</code>, the <code class="literal">ha_cluster</code> RHEL system role does not manage the firewall. If your system is running the <code class="literal">firewalld</code> service, you must set the parameter to <code class="literal">true</code> in your playbook.
						</p><p class="simpara">
							You can use the <code class="literal">ha_cluster_manage_firewall</code> parameter to add ports, but you cannot use the parameter to remove ports. To remove ports, use the <code class="literal">firewall</code> system role directly.
						</p><p class="simpara">
							As of RHEL 9.2, the firewall is no longer configured by default, because it is configured only when <code class="literal">ha_cluster_manage_firewall</code> is set to <code class="literal">true</code>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux</code></span></dt><dd><p class="simpara">
							(RHEL 9.2 and later) A boolean flag that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports belonging to the firewall high availability service using the <code class="literal">selinux</code> RHEL system role. When <code class="literal">ha_cluster_manage_selinux</code> is set to <code class="literal">true</code>, the ports belonging to the firewall high availability service are associated with the SELinux port type <code class="literal">cluster_port_t</code>. When <code class="literal">ha_cluster_manage_selinux</code> is set to <code class="literal">false</code>, the <code class="literal">ha_cluster</code> RHEL system role does not manage SELinux.
						</p><p class="simpara">
							If your system is running the <code class="literal">selinux</code> service, you must set this parameter to <code class="literal">true</code> in your playbook. Firewall configuration is a prerequisite for managing SELinux. If the firewall is not installed, the managing SELinux policy is skipped.
						</p><p class="simpara">
							You can use the <code class="literal">ha_cluster_manage_selinux</code> parameter to add policy, but you cannot use the parameter to remove policy. To remove policy, use the <code class="literal">selinux</code> RHEL system role directly.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_cluster_present</code></span></dt><dd><p class="simpara">
							A boolean flag which, if set to <code class="literal">true</code>, determines that HA cluster will be configured on the hosts according to the variables passed to the role. Any cluster configuration not specified in the playbook and not supported by the role will be lost.
						</p><p class="simpara">
							If <code class="literal">ha_cluster_cluster_present</code> is set to <code class="literal">false</code>, all HA cluster configuration will be removed from the target hosts.
						</p><p class="simpara">
							The default value of this variable is <code class="literal">true</code>.
						</p><p class="simpara">
							The following example playbook removes all cluster configuration on <code class="literal">node1</code> and <code class="literal">node2</code>
						</p><pre class="literallayout">- hosts: node1 node2
  vars:
    ha_cluster_cluster_present: false

  roles:
    - rhel-system-roles.ha_cluster</pre></dd><dt><span class="term"><code class="literal">ha_cluster_start_on_boot</code></span></dt><dd>
							A boolean flag that determines whether cluster services will be configured to start on boot. The default value of this variable is <code class="literal">true</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_install_cloud_agents</code></span></dt><dd>
							(RHEL 9.5 and later) A boolean flag that determines whether resource and fence agents for cloud environments are installed. These agents are not installed by default. Alternately, you can specify the packages for cloud environments by using the <code class="literal">ha_cluster_fence_agent_packages</code> and <code class="literal">ha_cluster_extra_packages</code> variables. The default value of this variable is <code class="literal">false</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_fence_agent_packages</code></span></dt><dd>
							List of fence agent packages to install. The default value of this variable is <code class="literal">fence-agents-all</code>, <code class="literal">fence-virt</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_extra_packages</code></span></dt><dd><p class="simpara">
							List of additional packages to be installed. The default value of this variable is no packages.
						</p><p class="simpara">
							This variable can be used to install additional packages not installed automatically by the role, for example custom resource agents.
						</p><p class="simpara">
							It is possible to specify fence agents as members of this list. However, <code class="literal">ha_cluster_fence_agent_packages</code> is the recommended role variable to use for specifying fence agents, so that its default value is overridden.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password</code></span></dt><dd>
							A string value that specifies the password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster. To protect sensitive data, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>. There is no default password value, and this variable must be specified.
						</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_qdevice_password</code></span></dt><dd>
							(RHEL 9.3 and later) A string value that specifies the password of the <code class="literal">hacluster</code> user for a quorum device. This parameter is needed only if the <code class="literal">ha_cluster_quorum</code> parameter is configured to use a quorum device of type <code class="literal">net</code> and the password of the <code class="literal">hacluster</code> user on the quorum device is different from the password of the <code class="literal">hacluster</code> user specified with the <code class="literal">ha_cluster_hacluster_password</code> parameter. The <code class="literal">hacluster</code> user has full access to a cluster. To protect sensitive data, vault encrypt the password, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>. There is no default value for this password.
						</dd><dt><span class="term"><code class="literal">ha_cluster_corosync_key_src</code></span></dt><dd><p class="simpara">
							The path to Corosync <code class="literal">authkey</code> file, which is the authentication and encryption key for Corosync communication. It is highly recommended that you have a unique <code class="literal">authkey</code> value for each cluster. The key should be 256 bytes of random data.
						</p><p class="simpara">
							If you specify a key for this variable, it is recommended that you vault encrypt the key, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p><p class="simpara">
							If no key is specified, a key already present on the nodes will be used. If nodes do not have the same key, a key from one node will be distributed to other nodes so that all nodes have the same key. If no node has a key, a new key will be generated and distributed to the nodes.
						</p><p class="simpara">
							If this variable is set, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this key.
						</p><p class="simpara">
							The default value of this variable is null.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_pacemaker_key_src</code></span></dt><dd><p class="simpara">
							The path to the Pacemaker <code class="literal">authkey</code> file, which is the authentication and encryption key for Pacemaker communication. It is highly recommended that you have a unique <code class="literal">authkey</code> value for each cluster. The key should be 256 bytes of random data.
						</p><p class="simpara">
							If you specify a key for this variable, it is recommended that you vault encrypt the key, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p><p class="simpara">
							If no key is specified, a key already present on the nodes will be used. If nodes do not have the same key, a key from one node will be distributed to other nodes so that all nodes have the same key. If no node has a key, a new key will be generated and distributed to the nodes.
						</p><p class="simpara">
							If this variable is set, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this key.
						</p><p class="simpara">
							The default value of this variable is null.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_fence_virt_key_src</code></span></dt><dd><p class="simpara">
							The path to the <code class="literal">fence-virt</code> or <code class="literal">fence-xvm</code> pre-shared key file, which is the location of the authentication key for the <code class="literal">fence-virt</code> or <code class="literal">fence-xvm</code> fence agent.
						</p><p class="simpara">
							If you specify a key for this variable, it is recommended that you vault encrypt the key, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p><p class="simpara">
							If no key is specified, a key already present on the nodes will be used. If nodes do not have the same key, a key from one node will be distributed to other nodes so that all nodes have the same key. If no node has a key, a new key will be generated and distributed to the nodes. If the <code class="literal">ha_cluster</code> RHEL system role generates a new key in this fashion, you should copy the key to your nodes' hypervisor to ensure that fencing works.
						</p><p class="simpara">
							If this variable is set, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this key.
						</p><p class="simpara">
							The default value of this variable is null.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_pcsd_public_key_srcr</code>, <code class="literal">ha_cluster_pcsd_private_key_src</code></span></dt><dd><p class="simpara">
							The path to the <code class="literal">pcsd</code> TLS certificate and private key. If this is not specified, a certificate-key pair already present on the nodes will be used. If a certificate-key pair is not present, a random new one will be generated.
						</p><p class="simpara">
							If you specify a private key value for this variable, it is recommended that you vault encrypt the key, as described in <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>.
						</p><p class="simpara">
							If these variables are set, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this certificate-key pair.
						</p><p class="simpara">
							The default value of these variables is null.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_pcsd_certificates</code></span></dt><dd><p class="simpara">
							(RHEL 9.2 and later) Creates a <code class="literal">pcsd</code> private key and certificate using the <code class="literal">certificate</code> RHEL system role.
						</p><p class="simpara">
							If your system is not configured with a <code class="literal">pcsd</code> private key and certificate, you can create them in one of two ways:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Set the <code class="literal">ha_cluster_pcsd_certificates</code> variable. When you set the <code class="literal">ha_cluster_pcsd_certificates</code> variable, the <code class="literal">certificate</code> RHEL system role is used internally and it creates the private key and certificate for <code class="literal">pcsd</code> as defined.
								</li><li class="listitem">
									Do not set the <code class="literal">ha_cluster_pcsd_public_key_src</code>, <code class="literal">ha_cluster_pcsd_private_key_src</code>, or the <code class="literal">ha_cluster_pcsd_certificates</code> variables. If you do not set any of these variables, the <code class="literal">ha_cluster</code> RHEL system role will create <code class="literal">pcsd</code> certificates by means of <code class="literal">pcsd</code> itself. The value of <code class="literal">ha_cluster_pcsd_certificates</code> is set to the value of the variable <code class="literal">certificate_requests</code> as specified in the <code class="literal">certificate</code> RHEL system role. For more information about the <code class="literal">certificate</code> RHEL system role, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL system roles</a>.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The following operational considerations apply to the use of the <code class="literal">ha_cluster_pcsd_certificate</code> variable:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Unless you are using IPA and joining the systems to an IPA domain, the <code class="literal">certificate</code> RHEL system role creates self-signed certificates. In this case, you must explicitly configure trust settings outside of the context of RHEL system roles. System roles do not support configuring trust settings.
								</li><li class="listitem">
									When you set the <code class="literal">ha_cluster_pcsd_certificates</code> variable, do not set the <code class="literal">ha_cluster_pcsd_public_key_src</code> and <code class="literal">ha_cluster_pcsd_private_key_src</code> variables.
								</li><li class="listitem">
									When you set the <code class="literal">ha_cluster_pcsd_certificates</code> variable, <code class="literal">ha_cluster_regenerate_keys</code> is ignored for this certificate - key pair.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The default value of this variable is <code class="literal">[]</code>.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that creates TLS certificates and key files in a high availability cluster, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Creating pcsd TLS certificates and key files for a high availability cluster</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_regenerate_keys</code></span></dt><dd>
							A boolean flag which, when set to <code class="literal">true</code>, determines that pre-shared keys and TLS certificates will be regenerated. For more information about when keys and certificates will be regenerated, see the descriptions of the <code class="literal">ha_cluster_corosync_key_src</code>, <code class="literal">ha_cluster_pacemaker_key_src</code>, <code class="literal">ha_cluster_fence_virt_key_src</code>, <code class="literal">ha_cluster_pcsd_public_key_src</code>, and <code class="literal">ha_cluster_pcsd_private_key_src</code> variables.
						</dd><dt><span class="term"><!--Empty--></span></dt><dd>
							The default value of this variable is <code class="literal">false</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_pcs_permission_list</code></span></dt><dd><p class="simpara">
							Configures permissions to manage a cluster using <code class="literal">pcsd</code>. The items you configure with this variable are as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">type</code> - <code class="literal">user</code> or <code class="literal">group</code>
								</li><li class="listitem">
									<code class="literal">name</code> - user or group name
								</li><li class="listitem"><p class="simpara">
									<code class="literal">allow_list</code> - Allowed actions for the specified user or group:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">read</code> - View cluster status and settings
										</li><li class="listitem">
											<code class="literal">write</code> - Modify cluster settings except permissions and ACLs
										</li><li class="listitem">
											<code class="literal">grant</code> - Modify cluster permissions and ACLs
										</li><li class="listitem">
											<code class="literal">full</code> - Unrestricted access to a cluster including adding and removing nodes and access to keys and certificates
										</li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the <code class="literal">ha_cluster_pcs_permission_list</code> variable and its default values are as follows:
						</p><pre class="literallayout">ha_cluster_pcs_permission_list:
  - type: group
    name: hacluster
    allow_list:
      - grant
      - read
      - write</pre></dd><dt><span class="term"><code class="literal">ha_cluster_cluster_name</code></span></dt><dd>
							The name of the cluster. This is a string value with a default of <code class="literal">my-cluster</code>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_transport</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) Sets the cluster transport method. The items you configure with this variable are as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">type</code> (optional) - Transport type: <code class="literal">knet</code>, <code class="literal">udp</code>, or <code class="literal">udpu</code>. The <code class="literal">udp</code> and <code class="literal">udpu</code> transport types support only one link. Encryption is always disabled for <code class="literal">udp</code> and <code class="literal">udpu</code>. Defaults to <code class="literal">knet</code> if not specified.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - List of name-value dictionaries with transport options.
								</li><li class="listitem">
									<code class="literal">links</code> (optional) - List of list of name-value dictionaries. Each list of name-value dictionaries holds options for one Corosync link. It is recommended that you set the <code class="literal">linknumber</code> value for each link. Otherwise, the first list of dictionaries is assigned by default to the first link, the second one to the second link, and so on.
								</li><li class="listitem">
									<code class="literal">compression</code> (optional) - List of name-value dictionaries configuring transport compression. Supported only with the <code class="literal">knet</code> transport type.
								</li><li class="listitem">
									<code class="literal">crypto</code> (optional) - List of name-value dictionaries configuring transport encryption. By default, encryption is enabled. Supported only with the <code class="literal">knet</code> transport type.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							For a list of allowed options, see the <code class="literal">pcs -h cluster setup</code> help page or the <code class="literal">setup</code> description in the <code class="literal">cluster</code> section of the <code class="literal">pcs</code>(8) man page. For more detailed descriptions, see the <code class="literal">corosync.conf</code>(5) man page.
						</p><p class="simpara">
							The structure of the <code class="literal">ha_cluster_transport</code> variable is as follows:
						</p><pre class="literallayout">ha_cluster_transport:
  type: knet
  options:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value
  links:
    -
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value
    -
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value
  compression:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value
  crypto:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that configures a transport method, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring Corosync values in a high availability cluster</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_totem</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) Configures Corosync totem. For a list of allowed options, see the <code class="literal">pcs -h cluster setup</code> help page or the <code class="literal">setup</code> description in the <code class="literal">cluster</code> section of the <code class="literal">pcs</code>(8) man page. For a more detailed description, see the <code class="literal">corosync.conf</code>(5) man page.
						</p><p class="simpara">
							The structure of the <code class="literal">ha_cluster_totem</code> variable is as follows:
						</p><pre class="literallayout">ha_cluster_totem:
  options:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that configures a Corosync totem, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring Corosync values in a high availability cluster</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_quorum</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) Configures cluster quorum. You can configure the following items for cluster quorum:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">options</code> (optional) - List of name-value dictionaries configuring quorum. Allowed options are: <code class="literal">auto_tie_breaker</code>, <code class="literal">last_man_standing</code>, <code class="literal">last_man_standing_window</code>, and <code class="literal">wait_for_all</code>. For information about quorum options, see the <code class="literal">votequorum</code>(5) man page.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">device</code> (optional) - (RHEL 9.2 and later) Configures the cluster to use a quorum device. By default, no quorum device is used.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">model</code> (mandatory) - Specifies a quorum device model. Only <code class="literal">net</code> is supported
										</li><li class="listitem"><p class="simpara">
											<code class="literal">model_options</code> (optional) - List of name-value dictionaries configuring the specified quorum device model. For model <code class="literal">net</code>, you must specify <code class="literal">host</code> and <code class="literal">algorithm</code> options.
										</p><p class="simpara">
											Use the <code class="literal">pcs-address</code> option to set a custom <code class="literal">pcsd</code> address and port to connect to the <code class="literal">qnetd</code> host. If you do not specify this option, the role connects to the default <code class="literal">pcsd</code> port on the <code class="literal">host</code>.
										</p></li><li class="listitem">
											<code class="literal">generic_options</code> (optional) - List of name-value dictionaries setting quorum device options that are not model specific.
										</li><li class="listitem"><p class="simpara">
											<code class="literal">heuristics_options</code> (optional) - List of name-value dictionaries configuring quorum device heuristics.
										</p><p class="simpara">
											For information about quorum device options, see the <code class="literal">corosync-qdevice</code>(8) man page. The generic options are <code class="literal">sync_timeout</code> and <code class="literal">timeout</code>. For model <code class="literal">net</code> options see the <code class="literal">quorum.device.net</code> section. For heuristics options, see the <code class="literal">quorum.device.heuristics</code> section.
										</p><p class="simpara">
											To regenerate a quorum device TLS certificate, set the <code class="literal">ha_cluster_regenerate_keys</code> variable to <code class="literal">true</code>.
										</p></li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the <code class="literal">ha_cluster_quorum</code> variable is as follows:
						</p><pre class="literallayout">ha_cluster_quorum:
  options:
    - name: option1_name
      value: option1_value
    - name: option2_name
      value: option2_value
  device:
    model: string
    model_options:
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value
    generic_options:
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value
    heuristics_options:
      - name: option1_name
        value: option1_value
      - name: option2_name
        value: option2_value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that configures cluster quorum, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring Corosync values in a high availability cluster</a>. For an example <code class="literal">ha_cluster</code> RHEL system role playbook that configures a cluster using a quorum device, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster using a quorum device</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_sbd_enabled</code></span></dt><dd>
							(RHEL 9.1 and later) A boolean flag which determines whether the cluster can use the SBD node fencing mechanism. The default value of this variable is <code class="literal">false</code>. For example <code class="literal">ha_cluster</code> system role playbooks that enable SBD, see <a class="link" href="#configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.11. Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable">Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable</a> and <a class="link" href="#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable">Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable</a>.
						</dd><dt><span class="term"><code class="literal">ha_cluster_sbd_options</code></span></dt><dd><p class="simpara">
							(RHEL 9.1 and later) List of name-value dictionaries specifying SBD options. For information about these options, see the <code class="literal">Configuration via environment</code> section of the <code class="literal">sbd</code>(8) man page.
						</p><p class="simpara">
							Supported options are:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">delay-start</code> - defaults to <code class="literal">false</code>, documented as <code class="literal">SBD_DELAY_START</code>
								</li><li class="listitem">
									<code class="literal">startmode</code> - defaults to <code class="literal">always</code>, documented as <code class="literal">SBD_START_MODE</code>
								</li><li class="listitem">
									<code class="literal">timeout-action</code> - defaults to <code class="literal">flush,reboot</code>, documented as <code class="literal">SBD_TIMEOUT_ACTION</code>
								</li><li class="listitem">
									<code class="literal">watchdog-timeout</code> - defaults to <code class="literal">5</code>, documented as <code class="literal">SBD_WATCHDOG_TIMEOUT</code>
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							Watchdog and SBD devices can be configured on a node to node basis in one of two variables:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">ha_cluster_node_options</code>, which you define in a playbook file (RHEL 9.5 and later). For an example <code class="literal">ha_cluster</code> RHEL system role playbook that uses the <code class="literal">ha_cluster_node_options</code> variable to configure node by node SBD options, see <a class="link" href="#configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.11. Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable">Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable</a>.
								</li><li class="listitem">
									<code class="literal">ha_cluster</code>, which you define in an inventory file. For an example procedure that configures node to node SBD options in an inventory file, see <a class="link" href="#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable">Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable</a>.
								</li></ul></div></dd><dt><span class="term"><code class="literal">ha_cluster_cluster_properties</code></span></dt><dd><p class="simpara">
							List of sets of cluster properties for Pacemaker cluster-wide configuration. Only one set of cluster properties is supported.
						</p><p class="simpara">
							The structure of a set of cluster properties is as follows:
						</p><pre class="literallayout">ha_cluster_cluster_properties:
  - attrs:
      - name: property1_name
        value: property1_value
      - name: property2_name
        value: property2_value</pre><p class="simpara">
							By default, no properties are set.
						</p><p class="simpara">
							The following example playbook configures a cluster consisting of <code class="literal">node1</code> and <code class="literal">node2</code> and sets the <code class="literal">stonith-enabled</code> and <code class="literal">no-quorum-policy</code> cluster properties.
						</p><pre class="literallayout">- hosts: node1 node2
  vars:
    ha_cluster_cluster_name: my-new-cluster
    ha_cluster_hacluster_password: password
    ha_cluster_cluster_properties:
      - attrs:
          - name: stonith-enabled
            value: 'true'
          - name: no-quorum-policy
            value: stop

  roles:
    - rhel-system-roles.ha_cluster</pre></dd><dt><span class="term"><code class="literal">ha_cluster_node_options</code></span></dt><dd><p class="simpara">
							(RHEL 9.4 and later) This variable defines settings which vary from one cluster node to another. It sets the options for the specified nodes, but does not specify which nodes form the cluster. You specify which nodes form the cluster with the <code class="literal">hosts</code> parameter in an inventory or a playbook.
						</p><p class="simpara">
							The items you configure with this variable are as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">node_name</code> (mandatory) - Name of the node for which to define Pacemaker node attributes. It must match a name defined for a node.
								</li><li class="listitem">
									<code class="literal">pcs_address</code> (optional) - (RHEL 9.5 and later) Address used by <code class="literal">pcs</code> to communicate with the node. You can specify a name, a FQDN or an IP address. You can specify a port as well.
								</li><li class="listitem">
									<code class="literal">corosync_addresses</code> (optional) - (RHEL 9.5 and later) List of addresses used by Corosync. All nodes must have the same number of addresses. The order of the addresses must be the same for all nodes, so that the addresses belonging to a particular link are specified in the same position for all nodes.
								</li><li class="listitem">
									<code class="literal">sbd_watchdog_modules</code> (optional) - (RHEL 9.5 and later) Watchdog kernel modules to be loaded, which create <code class="literal">/dev/watchdog*</code> devices. Defaults to an empty list if not set.
								</li><li class="listitem">
									<code class="literal">sbd_watchdog_modules_blocklist</code> (optional) - (RHEL 9.5 and later) Watchdog kernel modules to be unloaded and blocked. Defaults to an empty list if not set.
								</li><li class="listitem">
									<code class="literal">sbd_watchdog</code> (optional) - (RHEL 9.5 and later) Watchdog device to be used by SBD. Defaults to <code class="literal">/dev/watchdog</code> if not set.
								</li><li class="listitem">
									<code class="literal">sbd_devices</code> (optional) - (RHEL 9.5 and later) Devices to use for exchanging SBD messages and for monitoring. Defaults to an empty list if not set. Always refer to the devices using the long, stable device name (<code class="literal">/dev/disk/by-id/</code>).
								</li><li class="listitem">
									<code class="literal">attributes</code> (optional) - List of sets of Pacemaker node attributes for the node. Currently, only one set is supported. The first set is used and the rest are ignored.
								</li><li class="listitem">
									<code class="literal">utilization</code> (optional) - (RHEL 9.5 and later) List of sets of the node’s utilization. The field value must be an integer. Currently, only one set is supported. The first set is used and the rest are ignored.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the <code class="literal">ha_cluster_node_options</code> variable is as follows:
						</p><pre class="literallayout">ha_cluster_node_options:
  - node_name: node1
    pcs_address: node1-address
    corosync_addresses:
      - 192.168.1.11
      - 192.168.2.11
    sbd_watchdog_modules:
      - module1
      - module2
    sbd_watchdog_modules_blocklist:
      - module3
    sbd_watchdog: /dev/watchdog2
    sbd_devices:
      - /dev/disk/by-id/000001
      - /dev/disk/by-id/000002
      - /dev/disk/by-id/000003
    attributes:
      - attrs:
          - name: attribute1
            value: value1_node1
          - name: attribute2
            value: value2_node1
    utilization:
      - attrs:
          - name: utilization1
            value: value1_node1
          - name: utilization2
            value: value2_node1
  - node_name: node2
    pcs_address: node2-address:2224
    corosync_addresses:
      - 192.168.1.12
      - 192.168.2.12
    sbd_watchdog_modules:
      - module1
    sbd_watchdog_modules_blocklist:
      - module3
    sbd_watchdog: /dev/watchdog1
    sbd_devices:
      - /dev/disk/by-id/000001
      - /dev/disk/by-id/000002
      - /dev/disk/by-id/000003
    attributes:
      - attrs:
          - name: attribute1
            value: value1_node2
          - name: attribute2
            value: value2_node2
    utilization:
      - attrs:
          - name: utilization1
            value: value1_node2
          - name: utilization2
            value: value2_node2</pre><p class="simpara">
							By default, no node options are defined.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that includes node options configuration, see <a class="link" href="#configuring-ha-cluster-with-node-attributes_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.16. Configuring a high availability cluster with node attributes">Configuring a high availability cluster with node attributes</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives</code></span></dt><dd><p class="simpara">
							This variable defines pacemaker resources configured by the RHEL system role, including fencing resources. You can configure the following items for each resource:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (mandatory) - ID of a resource.
								</li><li class="listitem">
									<code class="literal">agent</code> (mandatory) - Name of a resource or fencing agent, for example <code class="literal">ocf:pacemaker:Dummy</code> or <code class="literal">stonith:fence_xvm</code>. It is mandatory to specify <code class="literal">stonith:</code> for STONITH agents. For resource agents, it is possible to use a short name, such as <code class="literal">Dummy</code>, instead of <code class="literal">ocf:pacemaker:Dummy</code>. However, if several agents with the same short name are installed, the role will fail as it will be unable to decide which agent should be used. Therefore, it is recommended that you use full names when specifying a resource agent.
								</li><li class="listitem">
									<code class="literal">instance_attrs</code> (optional) - List of sets of the resource’s instance attributes. Currently, only one set is supported. The exact names and values of attributes, as well as whether they are mandatory or not, depend on the resource or fencing agent.
								</li><li class="listitem">
									<code class="literal">meta_attrs</code> (optional) - List of sets of the resource’s meta attributes. Currently, only one set is supported.
								</li><li class="listitem">
									<code class="literal">copy_operations_from_agent</code> (optional) - (RHEL 9.3 and later) Resource agents usually define default settings for resource operations, such as <code class="literal">interval</code> and <code class="literal">timeout</code>, optimized for the specific agent. If this variable is set to <code class="literal">true</code>, then those settings are copied to the resource configuration. Otherwise, clusterwide defaults apply to the resource. If you also define resource operation defaults for the resource with the <code class="literal">ha_cluster_resource_operation_defaults</code> role variable, you can set this to <code class="literal">false</code>. The default value of this variable is <code class="literal">true</code>.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">operations</code> (optional) - List of the resource’s operations.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">action</code> (mandatory) - Operation action as defined by pacemaker and the resource or fencing agent.
										</li><li class="listitem">
											<code class="literal">attrs</code> (mandatory) - Operation options, at least one option must be specified. (RHEL 9.5 and later)
										</li></ul></div></li><li class="listitem">
									<code class="literal">utilization</code> (optional) - List of sets of the resource’s utilization. The <code class="literal">value</code> field must be an integer. Only one set is supported, so the first set is used and the rest are ignored.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the resource definition that you configure with the <code class="literal">ha_cluster</code> RHEL system role is as follows:
						</p><pre class="literallayout">  - id: resource-id
    agent: resource-agent
    instance_attrs:
      - attrs:
          - name: attribute1_name
            value: attribute1_value
          - name: attribute2_name
            value: attribute2_value
    meta_attrs:
      - attrs:
          - name: meta_attribute1_name
            value: meta_attribute1_value
          - name: meta_attribute2_name
            value: meta_attribute2_value
    copy_operations_from_agent: bool
    operations:
      - action: operation1-action
        attrs:
          - name: operation1_attribute1_name
            value: operation1_attribute1_value
          - name: operation1_attribute2_name
            value: operation1_attribute2_value
      - action: operation2-action
        attrs:
          - name: operation2_attribute1_name
            value: operation2_attribute1_value
          - name: operation2_attribute2_name
            value: operation2_attribute2_value</pre><p class="simpara">
							By default, no resources are defined.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that includes resource configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with fencing and resources</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_resource_groups</code></span></dt><dd><p class="simpara">
							This variable defines pacemaker resource groups configured by the system role. You can configure the following items for each resource group:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (mandatory) - ID of a group.
								</li><li class="listitem">
									<code class="literal">resources</code> (mandatory) - List of the group’s resources. Each resource is referenced by its ID and the resources must be defined in the <code class="literal">ha_cluster_resource_primitives</code> variable. At least one resource must be listed.
								</li><li class="listitem">
									<code class="literal">meta_attrs</code> (optional) - List of sets of the group’s meta attributes. Currently, only one set is supported.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the resource group definition that you configure with the <code class="literal">ha_cluster</code> RHEL system role is as follows:
						</p><pre class="literallayout">ha_cluster_resource_groups:
  - id: group-id
    resource_ids:
      - resource1-id
      - resource2-id
    meta_attrs:
      - attrs:
          - name: group_meta_attribute1_name
            value: group_meta_attribute1_value
          - name: group_meta_attribute2_name
            value: group_meta_attribute2_value</pre><p class="simpara">
							By default, no resource groups are defined.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that includes resource group configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with fencing and resources</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_resource_clones</code></span></dt><dd><p class="simpara">
							This variable defines pacemaker resource clones configured by the system role. You can configure the following items for a resource clone:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">resource_id</code> (mandatory) - Resource to be cloned. The resource must be defined in the <code class="literal">ha_cluster_resource_primitives</code> variable or the <code class="literal">ha_cluster_resource_groups</code> variable.
								</li><li class="listitem">
									<code class="literal">promotable</code> (optional) - Indicates whether the resource clone to be created is a promotable clone, indicated as <code class="literal">true</code> or <code class="literal">false</code>.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - Custom ID of the clone. If no ID is specified, it will be generated. A warning will be displayed if this option is not supported by the cluster.
								</li><li class="listitem">
									<code class="literal">meta_attrs</code> (optional) - List of sets of the clone’s meta attributes. Currently, only one set is supported.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the resource clone definition that you configure with the <code class="literal">ha_cluster</code> RHEL system role is as follows:
						</p><pre class="literallayout">ha_cluster_resource_clones:
  - resource_id: resource-to-be-cloned
    promotable: true
    id: custom-clone-id
    meta_attrs:
      - attrs:
          - name: clone_meta_attribute1_name
            value: clone_meta_attribute1_value
          - name: clone_meta_attribute2_name
            value: clone_meta_attribute2_value</pre><p class="simpara">
							By default, no resource clones are defined.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that includes resource clone configuration, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with fencing and resources</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_resource_defaults</code></span></dt><dd><p class="simpara">
							(RHEL 9.3 and later) This variable defines sets of resource defaults. You can define multiple sets of defaults and apply them to resources of specific agents using rules. The defaults you specify with the <code class="literal">ha_cluster_resource_defaults</code> variable do not apply to resources which override them with their own defined values.
						</p><p class="simpara">
							Only meta attributes can be specified as defaults.
						</p><p class="simpara">
							You can configure the following items for each defaults set:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the defaults set. If not specified, it is autogenerated.
								</li><li class="listitem">
									<code class="literal">rule</code> (optional) - Rule written using <code class="literal">pcs</code> syntax defining when and for which resources the set applies. For information on specifying a rule, see the <code class="literal">resource defaults set create</code> section of the <code class="literal">pcs</code>(8) man page.
								</li><li class="listitem">
									<code class="literal">score</code> (optional) - Weight of the defaults set.
								</li><li class="listitem">
									<code class="literal">attrs</code> (optional) - Meta attributes applied to resources as defaults.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the <code class="literal">ha_cluster_resource_defaults</code> variable is as follows:
						</p><pre class="literallayout">ha_cluster_resource_defaults:
  meta_attrs:
    - id: defaults-set-1-id
      rule: rule-string
      score: score-value
      attrs:
        - name: meta_attribute1_name
          value: meta_attribute1_value
        - name: meta_attribute2_name
          value: meta_attribute2_value
    - id: defaults-set-2-id
      rule: rule-string
      score: score-value
      attrs:
        - name: meta_attribute3_name
          value: meta_attribute3_value
        - name: meta_attribute4_name
          value: meta_attribute4_value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that configures resource defaults, see <a class="link" href="#configuring-ha-cluster-with-resource-defaults_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.6. Configuring a high availability cluster with resource and resource operation defaults">Configuring a high availability cluster with resource and resource operation defaults</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_resource_operation_defaults</code></span></dt><dd><p class="simpara">
							(RHEL 9.3 and later) This variable defines sets of resource operation defaults. You can define multiple sets of defaults and apply them to resources of specific agents and specific resource operations using rules. The defaults you specify with the <code class="literal">ha_cluster_resource_operation_defaults</code> variable do not apply to resource operations which override them with their own defined values. By default, the <code class="literal">ha_cluster</code> RHEL system role configures resources to define their own values for resource operations. For information about overriding these defaults with the <code class="literal">ha_cluster_resource_operations_defaults</code> variable, see the description of the <code class="literal">copy_operations_from_agent</code> item in <code class="literal">ha_cluster_resource_primitives</code>.
						</p><p class="simpara">
							Only meta attributes can be specified as defaults.
						</p><p class="simpara">
							The structure of the <code class="literal">ha_cluster_resource_operations_defaults</code> variable is the same as the structure for the <code class="literal">ha_cluster_resource_defaults</code> variable, with the exception of how you specify a rule. For information about specifying a rule to describe the resource operation to which a set applies, see the <code class="literal">resource op defaults set create</code> section of the <code class="literal">pcs</code>(8) man page.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_stonith_levels</code></span></dt><dd><p class="simpara">
							(RHEL 9.4 and later) This variable defines STONITH levels, also known as fencing topology. Fencing levels configure a cluster to use multiple devices to fence nodes. You can define alternative devices in case one device fails and you can require multiple devices to all be executed successfully to consider a node successfully fenced. For more information on fencing levels, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#proc_configuring-fencing-levels-configuring-fencing">Configuring fencing levels</a> in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters">Configuring and managing high availability clusters</a>.
						</p><p class="simpara">
							You can configure the following items when defining fencing levels:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">level</code> (mandatory) - Order in which to attempt the fencing level. Pacemaker attempts levels in ascending order until one succeeds.
								</li><li class="listitem">
									<code class="literal">target</code> (optional) - Name of a node this level applies to.
								</li><li class="listitem"><p class="simpara">
									You must specify one of the following three selections:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">target_pattern</code> - POSIX extended regular expression matching the names of the nodes this level applies to.
										</li><li class="listitem">
											<code class="literal">target_attribute</code> - Name of a node attribute that is set for the node this level applies to.
										</li><li class="listitem">
											<code class="literal">target_attribute</code> and <code class="literal">target_value</code> - Name and value of a node attribute that is set for the node this level applies to.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									<code class="literal">resouce_ids</code> (mandatory) - List of fencing resources that must all be tried for this level.
								</p><p class="simpara">
									By default, no fencing levels are defined.
								</p></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of the fencing levels definition that you configure with the <code class="literal">ha_cluster</code> RHEL system role is as follows:
						</p><pre class="literallayout">ha_cluster_stonith_levels:
  - level: 1..9
    target: node_name
    target_pattern: node_name_regular_expression
    target_attribute: node_attribute_name
    target_value: node_attribute_value
    resource_ids:
      - fence_device_1
      - fence_device_2
  - level: 1..9
    target: node_name
    target_pattern: node_name_regular_expression
    target_attribute: node_attribute_name
    target_value: node_attribute_value
    resource_ids:
      - fence_device_1
      - fence_device_2</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that configures fencing defaults, see <a class="link" href="#configuring-with-stonith-levels-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.7. Configuring a high availability cluster with fencing levels">Configuring a high availability cluster with fencing levels</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_constraints_location</code></span></dt><dd><p class="simpara">
							This variable defines resource location constraints. Resource location constraints indicate which nodes a resource can run on. You can specify a resources specified by a resource ID or by a pattern, which can match more than one resource. You can specify a node by a node name or by a rule.
						</p><p class="simpara">
							You can configure the following items for a resource location constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">resource</code> (mandatory) - Specification of a resource the constraint applies to.
								</li><li class="listitem">
									<code class="literal">node</code> (mandatory) - Name of a node the resource should prefer or avoid.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the constraint. If not specified, it will be autogenerated.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">options</code> (optional) - List of name-value dictionaries.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
											<code class="literal">score</code> - Sets the weight of the constraint.
										</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
													A positive <code class="literal">score</code> value means the resource prefers running on the node.
												</li><li class="listitem">
													A negative <code class="literal">score</code> value means the resource should avoid running on the node.
												</li><li class="listitem">
													A <code class="literal">score</code> value of <code class="literal">-INFINITY</code> means the resource must avoid running on the node.
												</li><li class="listitem">
													If <code class="literal">score</code> is not specified, the score value defaults to <code class="literal">INFINITY</code>.
												</li></ul></div></li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							By default no resource location constraints are defined.
						</p><p class="simpara">
							The structure of a resource location constraint specifying a resource ID and node name is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_location:
  - resource:
      id: resource-id
    node: node-name
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre><p class="simpara">
							The items that you configure for a resource location constraint that specifies a resource pattern are the same items that you configure for a resource location constraint that specifies a resource ID, with the exception of the resource specification itself. The item that you specify for the resource specification is as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">pattern</code> (mandatory) - POSIX extended regular expression resource IDs are matched against.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource location constraint specifying a resource pattern and node name is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_location:
  - resource:
      pattern: resource-pattern
    node: node-name
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: resource-discovery
        value: resource-discovery-value</pre><p class="simpara">
							You can configure the following items for a resource location constraint that specifies a resource ID and a rule:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource</code> (mandatory) - Specification of a resource the constraint applies to.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">role</code> (optional) - The resource role to which the constraint is limited: <code class="literal">Started</code>, <code class="literal">Unpromoted</code>, <code class="literal">Promoted</code>.
										</li></ul></div></li><li class="listitem">
									<code class="literal">rule</code> (mandatory) - Constraint rule written using <code class="literal">pcs</code> syntax. For further information, see the <code class="literal">constraint location</code> section of the <code class="literal">pcs</code>(8) man page.
								</li><li class="listitem">
									Other items to specify have the same meaning as for a resource constraint that does not specify a rule.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource location constraint that specifies a resource ID and a rule is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_location:
  - resource:
      id: resource-id
      role: resource-role
    rule: rule-string
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: resource-discovery
        value: resource-discovery-value</pre><p class="simpara">
							The items that you configure for a resource location constraint that specifies a resource pattern and a rule are the same items that you configure for a resource location constraint that specifies a resource ID and a rule, with the exception of the resource specification itself. The item that you specify for the resource specification is as follows:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">pattern</code> (mandatory) - POSIX extended regular expression resource IDs are matched against.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource location constraint that specifies a resource pattern and a rule is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_location:
  - resource:
      pattern: resource-pattern
      role: resource-role
    rule: rule-string
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: resource-discovery
        value: resource-discovery-value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that creates a cluster with resource constraints, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with resource constraints</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_constraints_colocation</code></span></dt><dd><p class="simpara">
							This variable defines resource colocation constraints. Resource colocation constraints indicate that the location of one resource depends on the location of another one. There are two types of colocation constraints: a simple colocation constraint for two resources, and a set colocation constraint for multiple resources.
						</p><p class="simpara">
							You can configure the following items for a simple resource colocation constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_follower</code> (mandatory) - A resource that should be located relative to <code class="literal">resource_leader</code>.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">role</code> (optional) - The resource role to which the constraint is limited: <code class="literal">Started</code>, <code class="literal">Unpromoted</code>, <code class="literal">Promoted</code>.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									<code class="literal">resource_leader</code> (mandatory) - The cluster will decide where to put this resource first and then decide where to put <code class="literal">resource_follower</code>.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">role</code> (optional) - The resource role to which the constraint is limited: <code class="literal">Started</code>, <code class="literal">Unpromoted</code>, <code class="literal">Promoted</code>.
										</li></ul></div></li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the constraint. If not specified, it will be autogenerated.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">options</code> (optional) - List of name-value dictionaries.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
											<code class="literal">score</code> - Sets the weight of the constraint.
										</p><div class="itemizedlist"><ul class="itemizedlist" type="square"><li class="listitem">
													Positive <code class="literal">score</code> values indicate the resources should run on the same node.
												</li><li class="listitem">
													Negative <code class="literal">score</code> values indicate the resources should run on different nodes.
												</li><li class="listitem">
													A <code class="literal">score</code> value of <code class="literal">+INFINITY</code> indicates the resources must run on the same node.
												</li><li class="listitem">
													A <code class="literal">score</code> value of <code class="literal">-INFINITY</code> indicates the resources must run on different nodes.
												</li><li class="listitem">
													If <code class="literal">score</code> is not specified, the score value defaults to <code class="literal">INFINITY</code>.
												</li></ul></div></li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							By default no resource colocation constraints are defined.
						</p><p class="simpara">
							The structure of a simple resource colocation constraint is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_colocation:
  - resource_follower:
      id: resource-id1
      role: resource-role1
    resource_leader:
      id: resource-id2
      role: resource-role2
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre><p class="simpara">
							You can configure the following items for a resource set colocation constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_sets</code> (mandatory) - List of resource sets.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">resource_ids</code> (mandatory) - List of resources in a set.
										</li><li class="listitem">
											<code class="literal">options</code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.
										</li></ul></div></li><li class="listitem">
									<code class="literal">id</code> (optional) - Same values as for a simple colocation constraint.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - Same values as for a simple colocation constraint.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource set colocation constraint is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_colocation:
  - resource_sets:
      - resource_ids:
          - resource-id1
          - resource-id2
        options:
          - name: option-name
            value: option-value
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that creates a cluster with resource constraints, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with resource constraints</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_constraints_order</code></span></dt><dd><p class="simpara">
							This variable defines resource order constraints. Resource order constraints indicate the order in which certain resource actions should occur. There are two types of resource order constraints: a simple order constraint for two resources, and a set order constraint for multiple resources.
						</p><p class="simpara">
							You can configure the following items for a simple resource order constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_first</code> (mandatory) - Resource that the <code class="literal">resource_then</code> resource depends on.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">action</code> (optional) - The action that must complete before an action can be initiated for the <code class="literal">resource_then</code> resource. Allowed values: <code class="literal">start</code>, <code class="literal">stop</code>, <code class="literal">promote</code>, <code class="literal">demote</code>.
										</li></ul></div></li><li class="listitem"><p class="simpara">
									<code class="literal">resource_then</code> (mandatory) - The dependent resource.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">action</code> (optional) - The action that the resource can execute only after the action on the <code class="literal">resource_first</code> resource has completed. Allowed values: <code class="literal">start</code>, <code class="literal">stop</code>, <code class="literal">promote</code>, <code class="literal">demote</code>.
										</li></ul></div></li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the constraint. If not specified, it will be autogenerated.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - List of name-value dictionaries.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							By default no resource order constraints are defined.
						</p><p class="simpara">
							The structure of a simple resource order constraint is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_order:
  - resource_first:
      id: resource-id1
      action: resource-action1
    resource_then:
      id: resource-id2
      action: resource-action2
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre><p class="simpara">
							You can configure the following items for a resource set order constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_sets</code> (mandatory) - List of resource sets.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">resource_ids</code> (mandatory) - List of resources in a set.
										</li><li class="listitem">
											<code class="literal">options</code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.
										</li></ul></div></li><li class="listitem">
									<code class="literal">id</code> (optional) - Same values as for a simple order constraint.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - Same values as for a simple order constraint.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource set order constraint is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_order:
  - resource_sets:
      - resource_ids:
          - resource-id1
          - resource-id2
        options:
          - name: option-name
            value: option-value
    id: constraint-id
    options:
      - name: score
        value: score-value
      - name: option-name
        value: option-value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that creates a cluster with resource constraints, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with resource constraints</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_constraints_ticket</code></span></dt><dd><p class="simpara">
							This variable defines resource ticket constraints. Resource ticket constraints indicate the resources that depend on a certain ticket. There are two types of resource ticket constraints: a simple ticket constraint for one resource, and a ticket order constraint for multiple resources.
						</p><p class="simpara">
							You can configure the following items for a simple resource ticket constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource</code> (mandatory) - Specification of a resource the constraint applies to.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">id</code> (mandatory) - Resource ID.
										</li><li class="listitem">
											<code class="literal">role</code> (optional) - The resource role to which the constraint is limited: <code class="literal">Started</code>, <code class="literal">Unpromoted</code>, <code class="literal">Promoted</code>.
										</li></ul></div></li><li class="listitem">
									<code class="literal">ticket</code> (mandatory) - Name of a ticket the resource depends on.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the constraint. If not specified, it will be autogenerated.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">options</code> (optional) - List of name-value dictionaries.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">loss-policy</code> (optional) - Action to perform on the resource if the ticket is revoked.
										</li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							By default no resource ticket constraints are defined.
						</p><p class="simpara">
							The structure of a simple resource ticket constraint is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_ticket:
  - resource:
      id: resource-id
      role: resource-role
    ticket: ticket-name
    id: constraint-id
    options:
      - name: loss-policy
        value: loss-policy-value
      - name: option-name
        value: option-value</pre><p class="simpara">
							You can configure the following items for a resource set ticket constraint:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									<code class="literal">resource_sets</code> (mandatory) - List of resource sets.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">resource_ids</code> (mandatory) - List of resources in a set.
										</li><li class="listitem">
											<code class="literal">options</code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.
										</li></ul></div></li><li class="listitem">
									<code class="literal">ticket</code> (mandatory) - Same value as for a simple ticket constraint.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - Same value as for a simple ticket constraint.
								</li><li class="listitem">
									<code class="literal">options</code> (optional) - Same values as for a simple ticket constraint.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of a resource set ticket constraint is as follows:
						</p><pre class="literallayout">ha_cluster_constraints_ticket:
  - resource_sets:
      - resource_ids:
          - resource-id1
          - resource-id2
        options:
          - name: option-name
            value: option-value
    ticket: ticket-name
    id: constraint-id
    options:
      - name: option-name
        value: option-value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that creates a cluster with resource constraints, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a high availability cluster with resource constraints</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_acls</code></span></dt><dd><p class="simpara">
							(RHEL 9.5 and later) This variable defines ACL roles, users and groups.
						</p><p class="simpara">
							You can configure the following items for <code class="literal">acl_roles</code>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (mandatory) - ID of an ACL role.
								</li><li class="listitem">
									<code class="literal">description</code> (optional) - Description of the ACL role.
								</li><li class="listitem"><p class="simpara">
									<code class="literal">permissions</code> (optional) - List of ACL role permissions.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
											<code class="literal">kind</code> (mandatory) - The access being granted. Allowed values are <code class="literal">read</code>, <code class="literal">write</code>, and <code class="literal">deny</code>.
										</li><li class="listitem">
											<code class="literal">xpath</code> (optional) - An XPath specification selecting an XML element in the CIB to which the permission applies. It is mandatory to specify exactly one of the items: <code class="literal">xpath</code> or <code class="literal">reference</code>.
										</li><li class="listitem">
											<code class="literal">reference</code> (optional) - The ID of an XML element in the CIB to which the permission applies. It is mandatory to specify exactly one of the items: xpath or reference. The ID must exist.
										</li></ul></div></li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							You can configure the following items for <code class="literal">acl_users</code>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (mandatory) - ID of an ACL user.
								</li><li class="listitem">
									<code class="literal">roles</code> (optional) - List of ACL Role IDs assigned to the user.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							You can configure the following items for <code class="literal">acl_group</code>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (mandatory) - ID of an ACL group.
								</li><li class="listitem">
									<code class="literal">roles</code> (optional) - List of ACL Role IDs assigned to the group.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of an ACL definition is as follows:
						</p><pre class="literallayout">ha_cluster_acls:
  acl_roles:
    - id: role-id-1
      description: role description
      permissions:
        - kind: access-type
          xpath: XPath expression
        - kind: access-type
          reference: cib-element-id
    - id: role-id-2
      permissions:
        - kind: access-type
          xpath: XPath expression
  acl_users:
    - id: user-name
      roles:
        - role-id-1
        - role-id-2
  acl_groups:
    - id: group-name
      roles:
        - role-id-2</pre><p class="simpara">
							To enable ACLS in the cluster, you must configure the <code class="literal">enable-acl</code> cluster property:
						</p><pre class="literallayout">ha_cluster_cluster_properties:
  - attrs:
      - name: enable-acl
        value: 'true'</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that creates a cluster with ACL roles, users, and groups, see <a class="link" href="#configuring-hacluster-with-ACLS-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.10. Configuring a high availability cluster that implements access control lists (ACLs) by using the ha_cluster RHEL system role">Configuring a high availability cluster that implements access control lists (ACLS) by using the RHEL system role</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_alerts</code></span></dt><dd><p class="simpara">
							(RHEL 9.5 and later) This variable defines Pacemaker alerts.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								The <code class="literal">ha_cluster</code> role configures the cluster to call external programs to handle alerts. You must provide the programs and distribute them to cluster nodes.
							</p></div></rh-alert><p class="simpara">
							You can configure the following items for <code class="literal">alerts</code>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">id</code> (mandatory) - ID of an alert
								</li><li class="listitem">
									<code class="literal">ipath</code> (mandatory) - Path to the alert agent executable.
								</li><li class="listitem">
									<code class="literal">description</code> (optional) - Description of the alert.
								</li><li class="listitem">
									<code class="literal">instance_attrs</code> (optional) - List of sets of the alert’s instance attributes.Only one set is supported. The first set is used and the rest are ignored.
								</li><li class="listitem">
									<code class="literal">meta_attrs</code> (optional) - List of sets of the alert’s meta attributes. Only one set is supported. The first set is used and the rest are ignored. *<code class="literal">recipients</code> (optional) - List of alert’s recipients.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							You can configure the following items for <code class="literal">recipients</code>:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">value</code> (mandatory) - Value of a recipient.
								</li><li class="listitem">
									<code class="literal">id</code> (optional) - ID of the recipient.
								</li><li class="listitem">
									<code class="literal">description</code> (optional) - Description of the recipient.
								</li><li class="listitem">
									<code class="literal">instance_attrs</code> (optional) - List of sets of the recipient’s instance attributes. Only one set is supported. The first set is used and the rest are ignored.
								</li><li class="listitem">
									<code class="literal">meta_attrs</code> (optional) - List of sets of the recipient’s meta attributes. Only one set is supported. The first set is used and the rest are ignored.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							The structure of an alert definition is as follows:
						</p><pre class="literallayout">ha_cluster_alerts:
  - id: alert1
    path: /alert1/path
    description: Alert1 description
    instance_attrs:
      - attrs:
        - name: alert_attr1_name
          value: alert_attr1_value
    meta_attrs:
      - attrs:
        - name: alert_meta_attr1_name
          value: alert_meta_attr1_value
    recipients:
      - value: recipient_value
        id: recipient1
        description: Recipient1 description
        instance_attrs:
          - attrs:
            - name: recipient_attr1_name
              value: recipient_attr1_value
        meta_attrs:
          - attrs:
            - name: recipient_meta_attr1_name
              value: recipient_meta_attr1_value</pre><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that configures a cluster with alerts, see <a class="link" href="#configuring-alerts-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.14. Configuring alerts for a high availability cluster by using the ha_cluster RHEL system role">Configuring alerts for a high availability cluster by using the ha_cluster RHEL system role</a>.
						</p></dd><dt><span class="term"><code class="literal">ha_cluster_qnetd</code></span></dt><dd><p class="simpara">
							(RHEL 9.2 and later) This variable configures a <code class="literal">qnetd</code> host which can then serve as an external quorum device for clusters.
						</p><p class="simpara">
							You can configure the following items for a <code class="literal">qnetd</code> host:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">present</code> (optional) - If <code class="literal">true</code>, configure a <code class="literal">qnetd</code> instance on the host. If <code class="literal">false</code>, remove <code class="literal">qnetd</code> configuration from the host. The default value is <code class="literal">false</code>. If you set this <code class="literal">true</code>, you must set <code class="literal">ha_cluster_cluster_present</code> to <code class="literal">false</code>.
								</li><li class="listitem">
									<code class="literal">start_on_boot</code> (optional) - Configures whether the <code class="literal">qnetd</code> instance should start automatically on boot. The default value is <code class="literal">true</code>.
								</li><li class="listitem">
									<code class="literal">regenerate_keys</code> (optional) - Set this variable to <code class="literal">true</code> to regenerate the <code class="literal">qnetd</code> TLS certificate. If you regenerate the certificate, you must either re-run the role for each cluster to connect it to the <code class="literal">qnetd</code> host again or run <code class="literal">pcs</code> manually.
								</li></ul></div></dd><dt><span class="term"><!--Empty--></span></dt><dd><p class="simpara">
							You cannot run <code class="literal">qnetd</code> on a cluster node because fencing would disrupt <code class="literal">qnetd</code> operation.
						</p><p class="simpara">
							For an example <code class="literal">ha_cluster</code> RHEL system role playbook that configures a cluster using a quorum device, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role">Configuring a cluster using a quorum device</a>.
						</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li></ul></div></section><section class="section" id="ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.2. Specifying an inventory for the <code class="literal">ha_cluster</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				When configuring an HA cluster using the <code class="literal">ha_cluster</code> RHEL system role playbook, you configure the names and addresses of the nodes for the cluster in an inventory.
			</p><p>
				For each node in an inventory, you can optionally specify the following items:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">node_name</code> - the name of a node in a cluster.
					</li><li class="listitem">
						<code class="literal">pcs_address</code> - an address used by <code class="literal">pcs</code> to communicate with the node. It can be a name, FQDN or an IP address and it can include a port number.
					</li><li class="listitem">
						<code class="literal">corosync_addresses</code> - list of addresses used by Corosync. All nodes which form a particular cluster must have the same number of addresses. The order of the addresses must be the same for all nodes, so that the addresses belonging to a particular link are specified in the same position for all nodes.
					</li></ul></div><p>
				The following example shows an inventory with targets <code class="literal">node1</code> and <code class="literal">node2</code>. <code class="literal">node1</code> and <code class="literal">node2</code> must be either fully qualified domain names or must otherwise be able to connect to the nodes as when, for example, the names are resolvable through the <code class="literal">/etc/hosts</code> file.
			</p><pre class="literallayout">all:
  hosts:
    node1:
      ha_cluster:
        node_name: node-A
        pcs_address: node1-address
        corosync_addresses:
          - 192.168.1.11
          - 192.168.2.11
    node2:
      ha_cluster:
        node_name: node-B
        pcs_address: node2-address:2224
        corosync_addresses:
          - 192.168.1.12
          - 192.168.2.12</pre><p>
				As of RHEL 9.1, you can optionally configure watchdog and SBD devices for each node in an inventory. All SBD devices must be shared to and accessible from all nodes. Watchdog devices can be different for each node as well. For an example procedure that configures SBD node fencing in an inventory file, see <a class="link" href="#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable">Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable</a>.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li></ul></div></section><section class="section" id="configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.3. Creating pcsd TLS certificates and key files for a high availability cluster</h3></div></div></div><p>
				(RHEL 9.2 and later) The connection between cluster nodes is secured using Transport Layer Security (TLS) encryption. By default, the <code class="literal">pcsd</code> daemon generates self-signed certificates. For many deployments, however, you may want to replace the default certificates with certificates issued by a certificate authority of your company and apply your company certificate policies for <code class="literal">pcsd</code>.
			</p><p>
				You can use the <code class="literal">ha_cluster</code> RHEL system role to create TLS certificates and key files in a high availability cluster. When you run this playbook, the <code class="literal">ha_cluster</code> RHEL system role uses the <code class="literal">certificate</code> RHEL system role internally to manage TLS certificates.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Create TLS certificates and key files in a high availability cluster
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_pcsd_certificates:
          - name: FILENAME
            common_name: "{{ ansible_hostname }}"
            ca: self-sign</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_pcsd_certificates: <span class="emphasis"><em>&lt;certificate_properties&gt;</em></span></code></span></dt><dd>
									A variable that creates a self-signed <code class="literal">pcsd</code> certificate and private key files in <code class="literal">/var/lib/pcsd</code>. In this example, the <code class="literal">pcsd</code> certificate has the file name <code class="literal">FILENAME.crt</code> and the key file is named <code class="literal">FILENAME.key</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li><li class="listitem">
						<a class="link" href="#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 7. Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles">Requesting certificates using RHEL system roles</a>
					</li></ul></div></section><section class="section" id="configuring-no-resource-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.4. Configuring a high availability cluster running no resources</h3></div></div></div><p>
				You can use the <code class="literal">ha_cluster</code> system role to configure a basic cluster in a simple, automatic way. Once you have created a basic cluster, you can use the <code class="literal">pcs</code> command-line interface to configure the other cluster components and behaviors on a resource-by-resource basis. The following example procedure configures a basic two-node cluster with no fencing configured using the minimum required parameters.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Create cluster with minimum required parameters and no fencing
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li></ul></div></section><section class="section" id="configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.5. Configuring a high availability cluster with fencing and resources</h3></div></div></div><p>
				The specific components of a cluster configuration depend on your individual needs, which vary between sites. The following example procedure shows the formats for configuring different cluster components by using the <code class="literal">ha_cluster</code> RHEL system role. The configured cluster includes a fencing device, cluster resources, resource groups, and a cloned resource.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Create cluster with fencing and resources
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_resource_primitives:
          - id: xvm-fencing
            agent: 'stonith:fence_xvm'
            instance_attrs:
              - attrs:
                  - name: pcmk_host_list
                    value: node1 node2
          - id: simple-resource
            agent: 'ocf:pacemaker:Dummy'
          - id: resource-with-options
            agent: 'ocf:pacemaker:Dummy'
            instance_attrs:
              - attrs:
                  - name: fake
                    value: fake-value
                  - name: passwd
                    value: passwd-value
            meta_attrs:
              - attrs:
                  - name: target-role
                    value: Started
                  - name: is-managed
                    value: 'true'
            operations:
              - action: start
                attrs:
                  - name: timeout
                    value: '30s'
              - action: monitor
                attrs:
                  - name: timeout
                    value: '5'
                  - name: interval
                    value: '1min'
          - id: dummy-1
            agent: 'ocf:pacemaker:Dummy'
          - id: dummy-2
            agent: 'ocf:pacemaker:Dummy'
          - id: dummy-3
            agent: 'ocf:pacemaker:Dummy'
          - id: simple-clone
            agent: 'ocf:pacemaker:Dummy'
          - id: clone-with-options
            agent: 'ocf:pacemaker:Dummy'
        ha_cluster_resource_groups:
          - id: simple-group
            resource_ids:
              - dummy-1
              - dummy-2
            meta_attrs:
              - attrs:
                  - name: target-role
                    value: Started
                  - name: is-managed
                    value: 'true'
          - id: cloned-group
            resource_ids:
              - dummy-3
        ha_cluster_resource_clones:
          - resource_id: simple-clone
          - resource_id: clone-with-options
            promotable: yes
            id: custom-clone-id
            meta_attrs:
              - attrs:
                  - name: clone-max
                    value: '2'
                  - name: clone-node-max
                    value: '1'
          - resource_id: cloned-group
            promotable: yes</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives: <span class="emphasis"><em>&lt;cluster_resources&gt;</em></span></code></span></dt><dd>
									A list of resource definitions for the Pacemaker resources configured by the ha_cluster RHEL system role, including fencing
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_groups: <span class="emphasis"><em>&lt;resource_groups&gt;</em></span></code></span></dt><dd>
									A list of resource group definitions configured by the <code class="literal">ha_cluster</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_clones: <span class="emphasis"><em>&lt;resource_clones&gt;</em></span></code></span></dt><dd>
									A list of resource clone definitions configured by the <code class="literal">ha_cluster</code> RHEL system role.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://content-stage.docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_configuring-fencing-configuring-and-managing-high-availability-clusters">Configuring fencing in a Red Hat High Availability cluster</a>
					</li></ul></div></section><section class="section" id="configuring-ha-cluster-with-resource-defaults_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.6. Configuring a high availability cluster with resource and resource operation defaults</h3></div></div></div><p>
				(RHEL 9.3 and later) In your cluster configuration, you can change the Pacemaker default values of a resource option for all resources. You can also change the default value for all resource operations in the cluster.
			</p><p>
				For information about changing the default value of a resource option, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#changing_the_default_value_of_a_resource_option">Changing the default value of a resource option</a>. For information about global resource operation defaults, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#proc_configuring-global-resource-operation-defaults-resource-monitoring-operations">Configuring global resource operation defaults</a>.
			</p><p>
				The following example procedure uses the <code class="literal">ha_cluster</code> RHEL system role to create a high availability cluster that defines resource and resource operation defaults.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Create cluster with fencing and resource operation defaults
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        # Set a different <code class="literal">resource-stickiness</code> value during
        # and outside work hours. This allows resources to
        # automatically move back to their most
        # preferred hosts, but at a time that
        # does not interfere with business activities.
        ha_cluster_resource_defaults:
          meta_attrs:
            - id: core-hours
              rule: date-spec hours=9-16 weekdays=1-5
              score: 2
              attrs:
                - name: resource-stickiness
                  value: INFINITY
            - id: after-hours
              score: 1
              attrs:
                - name: resource-stickiness
                  value: 0
        # Default the timeout on all 10-second-interval
        # monitor actions on IPaddr2 resources to 8 seconds.
        ha_cluster_resource_operation_defaults:
          meta_attrs:
            - rule: resource ::IPaddr2 and op monitor interval=10s
              score: INFINITY
              attrs:
                - name: timeout
                  value: 8s</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_defaults: <span class="emphasis"><em>&lt;resource_defaults&gt;</em></span></code></span></dt><dd>
									A variable that defines sets of resource defaults.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_operation_defaults: <span class="emphasis"><em>&lt;resource_operation_defaults&gt;</em></span></code></span></dt><dd>
									A variable that defines sets of resource operation defaults.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li></ul></div></section><section class="section" id="configuring-with-stonith-levels-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.7. Configuring a high availability cluster with fencing levels</h3></div></div></div><p>
				(RHEL 9.4 and later) When you configure multiple fencing devices for a node, you need to define fencing levels for those devices to determine the order that Pacemaker will use the devices to attempt to fence a node. For information about fencing levels, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#proc_configuring-fencing-levels-configuring-fencing">Configuring fencing levels</a>.
			</p><p>
				The following example procedure uses the <code class="literal">ha_cluster</code> RHEL system role to create a high availability cluster that defines fencing levels.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span>
fence1_password: <span class="emphasis"><em>&lt;fence1_password&gt;</em></span>
fence2_password: <span class="emphasis"><em>&lt;fence2_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>. This example playbook file configures a cluster running the <code class="literal">firewalld</code> and <code class="literal">selinux</code> services.
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Configure a cluster that defines fencing levels
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_resource_primitives:
          - id: apc1
            agent: 'stonith:fence_apc_snmp'
            instance_attrs:
              - attrs:
                  - name: ip
                    value: apc1.example.com
                  - name: username
                    value: user
                  - name: password
                    value: "{{ fence1_password }}"
                  - name: pcmk_host_map
                    value: node1:1;node2:2
          - id: apc2
            agent: 'stonith:fence_apc_snmp'
            instance_attrs:
              - attrs:
                  - name: ip
                    value: apc2.example.com
                  - name: username
                    value: user
                  - name: password
                    value: "{{ fence2_password }}"
                  - name: pcmk_host_map
                    value: node1:1;node2:2
        # Nodes have redundant power supplies, apc1 and apc2. Cluster must
        # ensure that when attempting to reboot a node, both power
        # supplies # are turned off before either power supply is turned
        # back on.
        ha_cluster_stonith_levels:
          - level: 1
            target: node1
            resource_ids:
              - apc1
              - apc2
          - level: 1
            target: node2
            resource_ids:
              - apc1
              - apc2</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives: <span class="emphasis"><em>&lt;cluster_resources&gt;</em></span></code></span></dt><dd>
									A list of resource definitions for the Pacemaker resources configured by the ha_cluster RHEL system role, including fencing
								</dd><dt><span class="term"><code class="literal">ha_cluster_stonith_levels: <span class="emphasis"><em>&lt;stonith_levels&gt;</em></span></code></span></dt><dd>
									A variable that defines STONITH levels, also known as fencing topology, which configure a cluster to use multiple devices to fence nodes.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li></ul></div></section><section class="section" id="configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.8. Configuring a high availability cluster with resource constraints</h3></div></div></div><p>
				When configuring a cluster, you can specify the behavior of the cluster resources to be in line with your application requirements. You can control the behavior of cluster resources by configuring resource constraints.
			</p><p>
				You can define the following categories of resource constraints:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Location constraints, which determine which nodes a resource can run on. For information about location constraints, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_determining-which-node-a-resource-runs-on-configuring-and-managing-high-availability-clusters">Determining which nodes a resource can run on</a>.
					</li><li class="listitem">
						Ordering constraints, which determine the order in which the resources are run. For information about ordering constraints, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_determining-resource-order.adoc-configuring-and-managing-high-availability-clusters">Determing the order in which cluster resources are run</a>.
					</li><li class="listitem">
						Colocation constraints, which specify that the location of one resource depends on the location of another resource. For information about colocation constraints, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_colocating-cluster-resources.adoc_configuring-and-managing-high-availability-clusters">Colocating cluster resources</a>.
					</li><li class="listitem">
						Ticket constraints, which indicate the resources that depend on a particular Booth ticket. For information about Booth ticket constraints, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#writing-cluster-alert-agent-configuring-pacemaker-alert-agents">Multi-site Pacemaker clusters</a>.
					</li></ul></div><p>
				The following example procedure uses the <code class="literal">ha_cluster</code> RHEL system role to create a high availability cluster that includes resource location constraints, resource colocation constraints, resource order constraints, and resource ticket constraints.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Create cluster with resource constraints
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        # In order to use constraints, we need resources
        # the constraints will apply to.
        ha_cluster_resource_primitives:
          - id: xvm-fencing
            agent: 'stonith:fence_xvm'
            instance_attrs:
              - attrs:
                  - name: pcmk_host_list
                    value: node1 node2
          - id: dummy-1
            agent: 'ocf:pacemaker:Dummy'
          - id: dummy-2
            agent: 'ocf:pacemaker:Dummy'
          - id: dummy-3
            agent: 'ocf:pacemaker:Dummy'
          - id: dummy-4
            agent: 'ocf:pacemaker:Dummy'
          - id: dummy-5
            agent: 'ocf:pacemaker:Dummy'
          - id: dummy-6
            agent: 'ocf:pacemaker:Dummy'
        # location constraints
        ha_cluster_constraints_location:
          # resource ID and node name
          - resource:
              id: dummy-1
            node: node1
            options:
              - name: score
                value: 20
          # resource pattern and node name
          - resource:
              pattern: dummy-\d+
            node: node1
            options:
              - name: score
                value: 10
          # resource ID and rule
          - resource:
              id: dummy-2
            rule: '#uname eq node2 and date in_range 2022-01-01 to 2022-02-28'
          # resource pattern and rule
          - resource:
              pattern: dummy-\d+
            rule: node-type eq weekend and date-spec weekdays=6-7
        # colocation constraints
        ha_cluster_constraints_colocation:
          # simple constraint
          - resource_leader:
              id: dummy-3
            resource_follower:
              id: dummy-4
            options:
              - name: score
                value: -5
          # set constraint
          - resource_sets:
              - resource_ids:
                  - dummy-1
                  - dummy-2
              - resource_ids:
                  - dummy-5
                  - dummy-6
                options:
                  - name: sequential
                    value: "false"
            options:
              - name: score
                value: 20
        # order constraints
        ha_cluster_constraints_order:
          # simple constraint
          - resource_first:
              id: dummy-1
            resource_then:
              id: dummy-6
            options:
              - name: symmetrical
                value: "false"
          # set constraint
          - resource_sets:
              - resource_ids:
                  - dummy-1
                  - dummy-2
                options:
                  - name: require-all
                    value: "false"
                  - name: sequential
                    value: "false"
              - resource_ids:
                  - dummy-3
              - resource_ids:
                  - dummy-4
                  - dummy-5
                options:
                  - name: sequential
                    value: "false"
        # ticket constraints
        ha_cluster_constraints_ticket:
          # simple constraint
          - resource:
              id: dummy-1
            ticket: ticket1
            options:
              - name: loss-policy
                value: stop
          # set constraint
          - resource_sets:
              - resource_ids:
                  - dummy-3
                  - dummy-4
                  - dummy-5
            ticket: ticket2
            options:
              - name: loss-policy
                value: fence</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives: <span class="emphasis"><em>&lt;cluster_resources&gt;</em></span></code></span></dt><dd>
									A list of resource definitions for the Pacemaker resources configured by the ha_cluster RHEL system role, including fencing
								</dd><dt><span class="term"><code class="literal">ha_cluster_constraints_location: <span class="emphasis"><em>&lt;location_constraints&gt;</em></span></code></span></dt><dd>
									A variable that defines resource location constraints.
								</dd><dt><span class="term"><code class="literal">ha_cluster_constraints_colocation: <span class="emphasis"><em>&lt;colocation_constraints&gt;</em></span></code></span></dt><dd>
									A variable that defines resource colocation constraints.
								</dd><dt><span class="term"><code class="literal">ha_cluster_constraints_order: <span class="emphasis"><em>&lt;order_constraints&gt;</em></span></code></span></dt><dd>
									A variable that defines resource order constraints.
								</dd><dt><span class="term"><code class="literal">ha_cluster_constraints_ticket: <span class="emphasis"><em>&lt;ticket_constraints&gt;</em></span></code></span></dt><dd>
									A variable that defines Booth ticket constraints.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li></ul></div></section><section class="section" id="configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.9. Configuring Corosync values in a high availability cluster</h3></div></div></div><p class="_abstract _abstract">
				(RHEL 9.1 and later) The <code class="literal">corosync.conf</code> file provides the cluster parameters used by Corosync, the cluster membership and messaging layer that Pacemaker is built on. For your system configuration, you can change some of the default parameters in the <code class="literal">corosync.conf</code> file. In general, you should not edit the <code class="literal">corosync.conf</code> file directly. You can, however, configure Corosync values by using the <code class="literal">ha_cluster</code> RHEL system role.
			</p><p>
				The following example procedure uses the <code class="literal">ha_cluster</code> RHEL system role to create a high availability cluster that configures Corosync values.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Create cluster that configures Corosync values
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_transport:
          type: knet
          options:
            - name: ip_version
              value: ipv4-6
            - name: link_mode
              value: active
          links:
            -
              - name: linknumber
                value: 1
              - name: link_priority
                value: 5
            -
              - name: linknumber
                value: 0
              - name: link_priority
                value: 10
          compression:
            - name: level
              value: 5
            - name: model
              value: zlib
          crypto:
            - name: cipher
              value: none
            - name: hash
              value: none
        ha_cluster_totem:
          options:
            - name: block_unlisted_ips
              value: 'yes'
            - name: send_join
              value: 0
        ha_cluster_quorum:
          options:
            - name: auto_tie_breaker
              value: 1
            - name: wait_for_all
              value: 1</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_transport: <span class="emphasis"><em>&lt;transport_method&gt;</em></span></code></span></dt><dd>
									A variable that sets the cluster transport method.
								</dd><dt><span class="term"><code class="literal">ha_cluster_totem: <span class="emphasis"><em>&lt;totem_options&gt;</em></span></code></span></dt><dd>
									A variable that configures Corosync totem options.
								</dd><dt><span class="term"><code class="literal">ha_cluster_quorum: <span class="emphasis"><em>&lt;quorum_options&gt;</em></span></code></span></dt><dd>
									A variable that configures cluster quorum options.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li></ul></div></section><section class="section" id="configuring-hacluster-with-ACLS-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.10. Configuring a high availability cluster that implements access control lists (ACLs) by using the <code class="literal">ha_cluster</code> RHEL system role</h3></div></div></div><p>
				(RHEL 9.5 and later) The <code class="literal">pcs</code> administration account for a cluster is <code class="literal">hacluster</code>. Using access control lists (ACLs), you can grant permission for specific local users other than user <code class="literal">hacluster</code> to manage a Pacemaker cluster. A common use case for this feature is to restrict unauthorized users from accessing business-sensitive information.
			</p><p>
				By default, ACLs are not enabled. Consequently, any member of the group <code class="literal">haclient</code> on all nodes has full local read and write access to the cluster configuratioan. Users who are not members of <code class="literal">haclient</code> have no access. When ACLs are enabled, however, even users who are members of the <code class="literal">haclient</code> group have access only to what has been granted to that user by the ACLs. The <code class="literal">root</code> and <code class="literal">hacluster</code> user accounts always have full access to the cluster configuration, even when ACLs are enabled.
			</p><p>
				When you set permissions for local users with ACLs, you create a role which defines the permissions for that role. You then assign that role to a user. If you assign multiple roles to the same user, any deny permission takes precedence, then write, then read.
			</p><p>
				The following example procedure uses the <code class="literal">ha_cluster</code> RHEL system role to create in an automated fashion a high availability cluster that implements ACLs to control access to the cluster configuration.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Configure a cluster with ACLs assigned
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
          ha_cluster_cluster_name: my-new-cluster
          ha_cluster_hacluster_password: "{{ cluster_password }}"
          ha_cluster_manage_firewall: true
          ha_cluster_manage_selinux: true
          # To use an ACL role permission reference, the reference must exist in CIB.
          ha_cluster_resource_primitives:
            - id: not-for-operator
              agent: 'ocf:pacemaker:Dummy'
          # ACLs must be enabled (using the enable-acl cluster property) in order to be effective.
          ha_cluster_cluster_properties:
            - attrs:
                - name: enable-acl
                  value: 'true'
          ha_cluster_acls:
            acl_roles:
              - id: operator
                description: HA cluster operator
                permissions:
                  - kind: write
                    xpath: //crm_config//nvpair[@name='maintenance-mode']
                  - kind: deny
                    reference: not-for-operator
              - id: administrator
                permissions:
                  - kind: write
                    xpath: /cib
            acl_users:
              - id: alice
                roles:
                  - operator
                  - administrator
              - id: bob
                roles:
                  - administrator
            acl_groups:
              - id: admins
                roles:
                  - administrator</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives: <span class="emphasis"><em>&lt;cluster resources&gt;</em></span></code></span></dt><dd>
									A list of resource definitions for the Pacemaker resources configured by the <code class="literal">ha_cluster</code> RHEL system role, including fencing resources.
								</dd><dt><span class="term"><code class="literal">ha_cluster_cluster_properties: <span class="emphasis"><em>&lt;cluster properties&gt;</em></span></code></span></dt><dd>
									A list of sets of cluster properties for Pacemaker cluster-wide configuration.
								</dd><dt><span class="term"><code class="literal">ha_cluster_acls: <span class="emphasis"><em>&lt;dictionary&gt;</em></span></code></span></dt><dd>
									A dictionary of ACL role, user, and group values.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles">Ansible vault</a>
					</li></ul></div></section><section class="section" id="configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.11. Configuring a high availability cluster with SBD node fencing by using the <code class="literal">ha_cluster_node_options</code> variable</h3></div></div></div><p>
				You must configure a Red Hat high availability cluster with at least one fencing device to ensure the cluster-provided services remain available when a node in the cluster encounters a problem. If your environment does not allow for a remotely accessible power switch to fence a cluster node, you can configure fencing by using a STONITH Block Device (SBD). This device provides a node fencing mechanism for Pacemaker-based clusters through the exchange of messages by means of shared block storage. SBD integrates with Pacemaker, a watchdog device and, optionally, shared storage to arrange for nodes to reliably self-terminate when fencing is required.
			</p><p>
				You can use the <code class="literal">ha_cluster</code> RHEL system role to configure SBD fencing in an automated fashion. With <code class="literal">ha_cluster</code>, you can configure watchdog and SBD devices on a node-to-node basis by using one of two variables:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ha_cluster_node_options</code>: (RHEL 9.5 and later) This is a single variable you define in a playbook file. It is a list of dictionaries where each dictionary defines options for one node.
					</li><li class="listitem">
						<code class="literal">ha_cluster</code>: (RHEL 9.1 and later) A dictionary that defines options for one node only. You configure the <code class="literal">ha_cluster</code> variable in an inventory file. To set different values for each node, you define the variable separately for each node.
					</li></ul></div><p>
				If both the <code class="literal">ha_cluster_node_options</code> and <code class="literal">ha_cluster</code> variables contain SBD options, those in <code class="literal">ha_cluster_node_options</code> have precedence.
			</p><p>
				This example procedure uses the <code class="literal">ha_cluster_node_options</code> variable in a playbook file to configure node addresses and SBD options on a per-node basis. For an example procedure that uses the <code class="literal">ha_cluster</code> variable in an inventory file, see <a class="link" href="#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable">Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable</a>.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Configure a cluster with SBD fencing
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        my_sbd_devices:
          # This variable is indirectly used by various variables of the <code class="literal">ha_cluster</code> RHEL system role.
          # Its purpose is to define SBD devices once so they do not need
          # to be repeated several times in the role variables.
          - /dev/disk/by-id/000001
          - /dev/disk/by-id/000002
          - /dev/disk/by-id/000003
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_sbd_enabled: true
        ha_cluster_sbd_options:
          - name: delay-start
            value: 'no'
          - name: startmode
            value: always
          - name: timeout-action
            value: 'flush,reboot'
          - name: watchdog-timeout
            value: 30
        ha_cluster_node_options:
          - node_name: node1
            sbd_watchdog_modules:
              - iTCO_wdt
            sbd_watchdog_modules_blocklist:
              - ipmi_watchdog
            sbd_watchdog: /dev/watchdog1
            sbd_devices: "{{ my_sbd_devices }}"
          - node_name: node2
            sbd_watchdog_modules:
              - iTCO_wdt
            sbd_watchdog_modules_blocklist:
              - ipmi_watchdog
            sbd_watchdog: /dev/watchdog1
            sbd_devices: "{{ my_sbd_devices }}"
        # Best practice for setting SBD timeouts:
        # watchdog-timeout * 2 = msgwait-timeout (set automatically)
        # msgwait-timeout * 1.2 = stonith-timeout
        ha_cluster_cluster_properties:
          - attrs:
              - name: stonith-timeout
                value: 72
        ha_cluster_resource_primitives:
          - id: fence_sbd
            agent: 'stonith:fence_sbd'
            instance_attrs:
              - attrs:
                  - name: devices
                    value: "{{ my_sbd_devices | join(',') }}"
                  - name: pcmk_delay_base
                    value: 30</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_sbd_enabled: true</code></span></dt><dd>
									A variable that determines whether the cluster can use the SBD node fencing mechanism.
								</dd><dt><span class="term"><code class="literal">ha_cluster_sbd_options: <span class="emphasis"><em>&lt;sbd options&gt;</em></span></code></span></dt><dd>
									A list of name-value dictionaries specifying SBD options. For information about these options, see the <code class="literal">Configuration via environment</code> section of the <code class="literal">sbd</code>(8) man page on your system.
								</dd><dt><span class="term"><code class="literal">ha_cluster_node_options: <span class="emphasis"><em>&lt;node options&gt;</em></span></code></span></dt><dd><p class="simpara">
									A variable that defines settings which vary from one cluster node to another. You can configure the following SBD and watchdog items:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">sbd_watchdog_modules</code> - Modules to be loaded, which create <code class="literal">/dev/watchdog*</code> devices.
										</li><li class="listitem">
											<code class="literal">sbd_watchdog_modules_blocklist</code> - Watchdog kernel modules to be unloaded and blocked.
										</li><li class="listitem">
											<code class="literal">sbd_watchdog</code> - Watchdog device to be used by SBD.
										</li><li class="listitem">
											<code class="literal">sbd_devices</code> - Devices to use for exchanging SBD messages and for monitoring. Always refer to the devices using the long, stable device name (<code class="literal">/dev/disk/by-id/</code>).
										</li></ul></div></dd><dt><span class="term"><code class="literal">ha_cluster_cluster_properties: <span class="emphasis"><em>&lt;cluster properties&gt;</em></span></code></span></dt><dd>
									A list of sets of cluster properties for Pacemaker cluster-wide configuration.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives: <span class="emphasis"><em>&lt;cluster resources&gt;</em></span></code></span></dt><dd>
									A list of resource definitions for the Pacemaker resources configured by the <code class="literal">ha_cluster</code> RHEL system role, including fencing resources.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Red Hat Knowledgebase article <a class="link" href="https://access.redhat.com/articles/2943361">Exploring RHEL High Availability’s Components - sbd and fence_sbd</a>
					</li><li class="listitem">
						Red Hat Knowledgebase article <a class="link" href="https://access.redhat.com/articles/2941601">Design Guidance for RHEL High Availability Clusters - sbd Considerations</a>
					</li><li class="listitem">
						Red Hat Knowledgebase article <a class="link" href="https://access.redhat.com/articles/2800691">Support Policies for RHEL High Availability Clusters - sbd and fence_sbd</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles">Ansible vault</a>
					</li></ul></div></section><section class="section" id="configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.12. Configuring a high availability cluster with SBD node fencing by using the <code class="literal">ha_cluster</code> variable</h3></div></div></div><p>
				You must configure a Red Hat high availability cluster with at least one fencing device to ensure the cluster-provided services remain available when a node in the cluster encounters a problem. If your environment does not allow for a remotely accessible power switch to fence a cluster node, you can configure fencing by using a STONITH Block Device (SBD). This device provides a node fencing mechanism for Pacemaker-based clusters through the exchange of messages by means of shared block storage. SBD integrates with Pacemaker, a watchdog device and, optionally, shared storage to arrange for nodes to reliably self-terminate when fencing is required.
			</p><p>
				You can use the <code class="literal">ha_cluster</code> RHEL system role to configure SBD fencing in an automated fashion. With <code class="literal">ha_cluster</code>, you can configure watchdog and SBD devices on a node-to-node basis by using one of two variables:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ha_cluster_node_options</code>: (RHEL 9.5 and later) This is a single variable you define in a playbook file. It is a list of dictionaries where each dictionary defines options for one node.
					</li><li class="listitem">
						<code class="literal">ha_cluster</code>: (RHEL 9.1 and later) A dictionary that defines options for one node only. You configure the <code class="literal">ha_cluster</code> variable in an inventory file. To set different values for each node, you define the variable separately for each node.
					</li></ul></div><p>
				If both the <code class="literal">ha_cluster_node_options</code> and <code class="literal">ha_cluster</code> variables contain SBD options, those in <code class="literal">ha_cluster_node_options</code> have precedence.
			</p><p>
				If both the <code class="literal">ha_cluster_node_options</code> and <code class="literal">ha_cluster</code> variables contain SBD options, those in <code class="literal">ha_cluster_node_options</code> have precedence.`
			</p><p>
				The following example procedure uses the <code class="literal">ha_cluster</code> system role to create a high availability cluster with SBD fencing. This example procedure uses the <code class="literal">ha_cluster</code> variable in an inventory file to configure node addresses and SBD options on a per-node basis. For an example procedure that uses the <code class="literal">ha_cluster_node_options</code> variable in a playbook file, see <a class="link" href="#configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.11. Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable">Configuring a high availability cluster with SBD node fencing by using the ha_cluster_nodes_options variable</a>.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file for your cluster that configures watchdog and SBD devices for each node by using the <code class="literal">ha_cluster</code> variable, as in the following exampla;e
					</p><pre class="literallayout">all:
  hosts:
    node1:
      ha_cluster:
        sbd_watchdog_modules:
          - iTCO_wdt
        sbd_watchdog_modules_blocklist:
          - ipmi_watchdog
        sbd_watchdog: /dev/watchdog1
        sbd_devices:
          - /dev/disk/by-id/000001
          - /dev/disk/by-id/000001
          - /dev/disk/by-id/000003
    node2:
      ha_cluster:
        sbd_watchdog_modules:
          - iTCO_wdt
        sbd_watchdog_modules_blocklist:
          - ipmi_watchdog
        sbd_watchdog: /dev/watchdog1
        sbd_devices:
          - /dev/disk/by-id/000001
          - /dev/disk/by-id/000002
          - /dev/disk/by-id/000003</pre><p class="simpara">
						The SBD and watchdog settings specified in the example inventory include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">sbd_watchdog_modules</code></span></dt><dd>
									Watchdog kernel modules to be loaded, which create <code class="literal">/dev/watchdog*</code> devices.
								</dd><dt><span class="term"><code class="literal">sbd_watchdog_modules_blocklist</code></span></dt><dd>
									Watchdog kernel modules to be unloaded and blocked.
								</dd><dt><span class="term"><code class="literal">sbd_watchdog</code></span></dt><dd>
									Watchdog device to be used by SBD.
								</dd><dt><span class="term"><code class="literal">sbd_devices</code></span></dt><dd>
									Devices to use for exchanging SBD messages and for monitoring. Always refer to the devices using the long, stable device name (<code class="literal">/dev/disk/by-id/</code>).
								</dd></dl></div><p class="simpara">
						For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</p></li><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, as in the following example. Since you have specified the SBD and watchog variables in an inventory, you do not need to include them in the playbook.
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Configure a cluster with sbd fencing devices configured in an inventory file
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
          ha_cluster_cluster_name: my-new-cluster
          ha_cluster_hacluster_password: "{{ cluster_password }}"
          ha_cluster_manage_firewall: true
          ha_cluster_manage_selinux: true
          ha_cluster_sbd_enabled: true
          ha_cluster_sbd_options:
            - name: delay-start
              value: 'no'
            - name: startmode
              value: always
            - name: timeout-action
              value: 'flush,reboot'
            - name: watchdog-timeout
              value: 30
          # Best practice for setting SBD timeouts:
          # watchdog-timeout * 2 = msgwait-timeout (set automatically)
          # msgwait-timeout * 1.2 = stonith-timeout
          ha_cluster_cluster_properties:
            - attrs:
                - name: stonith-timeout
                  value: 72
          ha_cluster_resource_primitives:
            - id: fence_sbd
              agent: 'stonith:fence_sbd'
              instance_attrs:
                - attrs:
                    # taken from host_vars
                    # this only works if all nodes have the same sbd_devices
                    - name: devices
                      value: "{{ ha_cluster.sbd_devices | join(',') }}"
                    - name: pcmk_delay_base
                      value: 30</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>cluster_name</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>password</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_sbd_enabled: true</code></span></dt><dd>
									A variable that determines whether the cluster can use the SBD node fencing mechanism.
								</dd><dt><span class="term"><code class="literal">ha_cluster_sbd_options: <span class="emphasis"><em>sbd options</em></span></code></span></dt><dd>
									A list of name-value dictionaries specifying SBD options. For information about these options, see the <code class="literal">Configuration via environment</code> section of the <code class="literal">sbd</code>(8) man page on your system.
								</dd><dt><span class="term"><code class="literal">ha_cluster_cluster_properties: <span class="emphasis"><em>cluster properties</em></span></code></span></dt><dd>
									A list of sets of cluster properties for Pacemaker cluster-wide configuration.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives: <span class="emphasis"><em>cluster resources</em></span></code></span></dt><dd>
									A list of resource definitions for the Pacemaker resources configured by the <code class="literal">ha_cluster</code> RHEL system role, including fencing resources.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Red Hat Knowledgebase article <a class="link" href="https://access.redhat.com/articles/2943361">Exploring RHEL High Availability’s Components - sbd and fence_sbd</a>
					</li><li class="listitem">
						Red Hat Knowledgebase article <a class="link" href="https://access.redhat.com/articles/2941601">Design Guidance for RHEL High Availability Clusters - sbd Considerations</a>
					</li><li class="listitem">
						Red Hat Knowledgebase article <a class="link" href="https://access.redhat.com/articles/2800691">Support Policies for RHEL High Availability Clusters - sbd and fence_sbd</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles">Ansible vault</a>
					</li></ul></div></section><section class="section" id="configuring-hacluster-with-placement-strategy-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.13. Configuring a placement strategy for a high availability cluster by using the RHEL <code class="literal">ha_cluster</code> RHEL system role</h3></div></div></div><p>
				(RHEL 9.5 and later) A Pacemaker cluster allocates resources according to a resource allocation score. By default, if the resource allocation scores on all the nodes are equal, Pacemaker allocates the resource to the node with the smallest number of allocated resources. If the resources in your cluster use significantly different proportions of a node’s capacities, such as memory or I/O, the default behavior may not be the best strategy for balancing your system’s workload. In this case, you can customize an allocation strategy by configuring utilization attributes and placement strategies for nodes and resources.
			</p><p>
				For detailed information about configuring utilization attributes and placement strategies, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#proc_setting-shutdown-lock-configuring-resources-to-remain-stopped">Configuring a node placement strategy</a>.
			</p><p>
				This example procedure uses the <code class="literal">ha_cluster</code> RHEL system role to create a high availability cluster in an automated fashion that configures utilization attributes to define a placement strategy.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Configure a cluster with utilization attributes
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
          ha_cluster_cluster_name: my-new-cluster
          ha_cluster_hacluster_password: "{{ cluster_password }}"
          ha_cluster_manage_firewall: true
          ha_cluster_manage_selinux: true
          ha_cluster_cluster_properties:
            - attrs:
                - name: placement-strategy
                  value: utilization
          ha_cluster_node_options:
            - node_name: node1
              utilization:
                - attrs:
                    - name: utilization1
                      value: 1
                    - name: utilization2
                      value: 2
            - node_name: node2
              utilization:
                - attrs:
                    - name: utilization1
                      value: 3
                    - name: utilization2
                      value: 4
          ha_cluster_resource_primitives:
            - id: resource1
              agent: 'ocf:pacemaker:Dummy'
              utilization:
                - attrs:
                    - name: utilization1
                      value: 2
                    - name: utilization2
                      value: 3</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_cluster_properties: <span class="emphasis"><em>&lt;cluster properties&gt;</em></span></code></span></dt><dd>
									List of sets of cluster properties for Pacemaker cluster-wide configuration. For utilization to have an effect, the <code class="literal">placement-strategy</code> property must be set and its value must be different from the value <code class="literal">default</code>.
								</dd><dt><span class="term">`ha_cluster_node_options: <span class="emphasis"><em>&lt;node options&gt;</em></span></span></dt><dd>
									A variable that defines various settings which vary from cluster node to cluster node.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives: <span class="emphasis"><em>&lt;cluster resources&gt;</em></span></code></span></dt><dd><p class="simpara">
									A list of resource definitions for the Pacemaker resources configured by the <code class="literal">ha_cluster</code> RHEL system role, including fencing resources.
								</p><p class="simpara">
									For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
								</p></dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles">Ansible vault</a>
					</li></ul></div></section><section class="section" id="configuring-alerts-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.14. Configuring alerts for a high availability cluster by using the <code class="literal">ha_cluster</code> RHEL system role</h3></div></div></div><p>
				(RHEL 9.5 and later) When a Pacemaker event occurs, such as a resource or a node failure or a configuration change, you may want to take some external action. For example, you may want to send an email message or log to a file or update a monitoring system.
			</p><p>
				You can configure your system to take an external action by using alert agents. These are external programs that the cluster calls in the same manner as the cluster calls resource agents to handle resource configuration and operation. The cluster passes information about the event to the agent through environment variables.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role configures the cluster to call external programs to handle alerts. However, you must provide these programs and distribute them to cluster nodes.
				</p></div></rh-alert><p>
				For more detailed information about alert agents, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_configuring-pacemaker-alert-agents_configuring-and-managing-high-availability-clusters">Triggering scripts for cluster events</a>.
			</p><p>
				This example procedure uses the <code class="literal">ha_cluster</code> RHEL system role to create a high availability cluster in an automated fashion that configures a Pacemaker alert.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Configure a cluster with alerts
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
          ha_cluster_cluster_name: my-new-cluster
          ha_cluster_hacluster_password: "{{ cluster_password }}"
          ha_cluster_manage_firewall: true
          ha_cluster_manage_selinux: true
          ha_cluster_alerts:
            - id: alert1
              path: /alert1/path
              description: <span class="emphasis"><em>Alert1 description</em></span>
              instance_attrs:
                - attrs:
                    - name: <span class="emphasis"><em>alert_attr1_name</em></span>
                      value: <span class="emphasis"><em>alert_attr1_value</em></span>
              meta_attrs:
                - attrs:
                    - name: <span class="emphasis"><em>alert_meta_attr1_name</em></span>
                      value: <span class="emphasis"><em>alert_meta_attr1_value</em></span>
              recipients:
                - value: recipient_value
                  id: recipient1
                  description: Recipient1 description
                  instance_attrs:
                    - attrs:
                        - name: <span class="emphasis"><em>recipient_attr1_name</em></span>
                          value: <span class="emphasis"><em>recipient_attr1_value</em></span>
                  meta_attrs:
                    - attrs:
                        - name: <span class="emphasis"><em>recipient_meta_attr1_name</em></span>
                          value: <span class="emphasis"><em>recipient_meta_attr1_value</em></span></pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_alerts: <span class="emphasis"><em>&lt;alert definitions&gt;</em></span></code></span></dt><dd><p class="simpara">
									A variable that defines Pacemaker alerts.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">id</code> - ID of an alert.
										</li><li class="listitem">
											<code class="literal">path</code> - Path to the alert agent executable.
										</li><li class="listitem">
											<code class="literal">description</code>- Description of the alert.
										</li><li class="listitem">
											<code class="literal">instance_attrs</code> - List of sets of the alert’s instance attributes. Currently, only one set is supported, so the first set is used and the rest are ignored.
										</li><li class="listitem">
											<code class="literal">meta_attrs</code> - List of sets of the alert’s meta attributes. Currently, only one set is supported, so the first set is used and the rest are ignored.
										</li><li class="listitem">
											<code class="literal">recipients</code> - List of alert’s recipients.
										</li><li class="listitem">
											<code class="literal">value</code>- Value of a recipient.
										</li><li class="listitem">
											<code class="literal">id</code> - ID of the recipient.
										</li><li class="listitem">
											<code class="literal">description</code> - Description of the recipient.
										</li><li class="listitem">
											<code class="literal">instance_attrs</code> -List of sets of the recipient’s instance attributes. Currently, only one set is supported, so the first set is used and the rest are ignored.
										</li><li class="listitem">
											<code class="literal">meta_attrs</code> - List of sets of the recipient’s meta attributes. Currently, only one set is supported, so the first set is used and the rest are ignored.
										</li></ul></div></dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles">Ansible vault</a>
					</li></ul></div></section><section class="section" id="configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.15. Configuring a high availability cluster using a quorum device</h3></div></div></div><p>
				(RHEL 9.2 and later) Your cluster can sustain more node failures than standard quorum rules permit when you configure a separate quorum device. The quorum device acts as a lightweight arbitration device for the cluster. A quorum device is recommended for clusters with an even number of nodes. With two-node clusters, the use of a quorum device can better determine which node survives in a split-brain situation.
			</p><p>
				For information about quorum devices, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_configuring-quorum-devices-configuring-and-managing-high-availability-clusters">Configuring quorum devices</a>.
			</p><p>
				To configure a high availability cluster with a separate quorum device by using the <code class="literal">ha_cluster</code> RHEL system role, first set up the quorum device. After setting up the quorum device, you can use the device in any number of clusters.
			</p><section class="section" id="configuring-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h4 class="title">11.15.1. Configuring a quorum device</h4></div></div></div><p>
					To configure a quorum device using the <code class="literal">ha_cluster</code> RHEL system role, follow the steps in this example procedure. Note that you cannot run a quorum device on a cluster node.
				</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
						The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							The system that you will use to run the quorum device has active subscription coverage for RHEL and the RHEL High Availability Add-On.
						</li><li class="listitem">
							The inventory file specifies the quorum devices as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Store your sensitive variables in an encrypted file:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Create the vault:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
									After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
								</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
									Save the changes, and close the editor. Ansible encrypts the data in the vault.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook-qdevice.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure a host with a quorum device
  hosts: nodeQ
  vars_files:
    - vault.yml
  tasks:
    - name: Create a quorum device for the cluster
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_present: false
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_qnetd:
          present: true</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_present: false</code></span></dt><dd>
										A variable that, if set to <code class="literal">false</code>, determines that all cluster configuration will be removed from the target host.
									</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
										The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
									</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
										A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
									</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
										A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
									</dd><dt><span class="term"><code class="literal">ha_cluster_qnetd: <span class="emphasis"><em>&lt;quorum_device_options&gt;</em></span></code></span></dt><dd>
										A variable that configures a <code class="literal">qnetd</code> host.
									</dd></dl></div></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook-qdevice.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook-qdevice.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
						</li></ul></div></section><section class="section" id="configuring-a-cluster-to-use-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h4 class="title">11.15.2. Configuring a cluster to use a quorum device</h4></div></div></div><p>
					To configure a cluster to use a quorum device, follow the steps in this example procedure.
				</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
						The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
						</li><li class="listitem">
							The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
						</li><li class="listitem">
							You have configured a quorum device.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook-cluster-qdevice.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure a cluster to use a quorum device
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Create cluster that uses a quorum device
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_quorum:
          device:
            model: net
            model_options:
              - name: host
                value: nodeQ
              - name: algorithm
                value: lms</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
										The name of the cluster you are creating.
									</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
										The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
									</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
										A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
									</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
										A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
									</dd><dt><span class="term"><code class="literal">ha_cluster_quorum: <span class="emphasis"><em>&lt;quorum_parameters&gt;</em></span></code></span></dt><dd>
										A variable that configures cluster quorum which you can use to specify that the cluster uses a quorum device.
									</dd></dl></div></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook-cluster-qdevice.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook-cluster-qdevice.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
						</li></ul></div></section></section><section class="section" id="configuring-ha-cluster-with-node-attributes_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.16. Configuring a high availability cluster with node attributes</h3></div></div></div><p>
				(RHEL 9.4 and later) You can use Pacemaker rules to make your configuration more dynamic. For example, you can use a node attribute to assign machines to different processing groups based on time and then use that attribute when creating location constraints.
			</p><p>
				Node attribute expressions are used to control a resource based on the attributes defined by a node or nodes. For information on node attributes, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_determining-resource-location-with-rules-configuring-and-managing-high-availability-clusters">Determining resource location with rules</a>.
			</p><p>
				The following example procedure uses the <code class="literal">ha_cluster</code> RHEL system role to create a high availability cluster that configures node attributes.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: node1 node2
  vars_files:
    - vault.yml
  tasks:
    - name: Create a cluster that defines node attributes
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_cluster_name: my-new-cluster
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_node_options:
          - node_name: node1
            attributes:
              - attrs:
                  - name: attribute1
                    value: value1A
                  - name: attribute2
                    value: value2A
          - node_name: node2
            attributes:
              - attrs:
                  - name: attribute1
                    value: value1B
                  - name: attribute2
                    value: value2B</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_node_options: <span class="emphasis"><em>&lt;node_settings&gt;</em></span></code></span></dt><dd>
									A variable that defines various settings that vary from one cluster node to another.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
								<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#ref_pacemaker-rules.adoc-determining-resource-location-with-rules">Pacemaker rules</a>
							</li></ul></div></li></ol></div></section><section class="section" id="configuring-http-ha-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">11.17. Configuring an Apache HTTP server in a high availability cluster with the <code class="literal">ha_cluster</code> RHEL system role</h3></div></div></div><p>
				High availability clusters provide highly available services by eliminating single points of failure and by failing over services from one cluster node to another in case a node becomes inoperative. Red Hat provides a variety of documentation for planning, configuring, and maintaining a Red Hat high availability cluster. For a listing of articles that provide indexes to the various areas of Red Hat cluster documentation, see the <a class="link" href="https://access.redhat.com/articles/6565761">Red Hat High Availability Add-On Documentation Guide</a>.
			</p><p>
				The following example use case configures an active/passive Apache HTTP server in a two-node Red Hat Enterprise Linux High Availability Add-On cluster by using the <code class="literal">ha_cluster</code> RHEL system role. In this use case, clients access the Apache HTTP server through a floating IP address. The web server runs on one of two nodes in the cluster. If the node on which the web server is running becomes inoperative, the web server starts up again on the second node of the cluster with minimal service interruption.
			</p><p>
				This example uses an APC power switch with a host name of <code class="literal">zapc.example.com</code>. If the cluster does not use any other fence agents, you can optionally list only the fence agents your cluster requires when defining the <code class="literal">ha_cluster_fence_agent_packages</code> variable, as in this example.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">ha_cluster</code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.
					</li><li class="listitem">
						The inventory file specifies the cluster nodes as described in <a class="link" href="#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role" title="11.2. Specifying an inventory for the ha_cluster RHEL system role">Specifying an inventory for the ha_cluster RHEL system role</a>. For general information about creating an inventory file, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles">Preparing a control node on RHEL 9</a>.
					</li><li class="listitem">
						You have configured an LVM logical volume with an XFS file system, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_configuring-active-passive-http-server-in-a-cluster-configuring-and-managing-high-availability-clusters#proc_configuring-lvm-volume-with-ext4-file-system-configuring-ha-http">Configuring an LVM volume with an XFS file system in a Pacemaker cluster</a>.
					</li><li class="listitem">
						You have configured an Apache HTTP server, as described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_configuring-active-passive-http-server-in-a-cluster-configuring-and-managing-high-availability-clusters#proc_configuring-apache-http-web-server-configuring-ha-http">Configuring an Apache HTTP Server</a>.
					</li><li class="listitem">
						Your system includes an APC power switch that will be used to fence the cluster nodes.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">cluster_password: <span class="emphasis"><em>&lt;cluster_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a high availability cluster
  hosts: z1.example.com z2.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Configure active/passive Apache server in a high availability cluster
      ansible.builtin.include_role:
        name: rhel-system-roles.ha_cluster
      vars:
        ha_cluster_hacluster_password: "{{ cluster_password }}"
        ha_cluster_cluster_name: my_cluster
        ha_cluster_manage_firewall: true
        ha_cluster_manage_selinux: true
        ha_cluster_fence_agent_packages:
          - fence-agents-apc-snmp
        ha_cluster_resource_primitives:
          - id: myapc
            agent: stonith:fence_apc_snmp
            instance_attrs:
              - attrs:
                  - name: ipaddr
                    value: zapc.example.com
                  - name: pcmk_host_map
                    value: z1.example.com:1;z2.example.com:2
                  - name: login
                    value: apc
                  - name: passwd
                    value: apc
          - id: my_lvm
            agent: ocf:heartbeat:LVM-activate
            instance_attrs:
              - attrs:
                  - name: vgname
                    value: my_vg
                  - name: vg_access_mode
                    value: system_id
          - id: my_fs
            agent: Filesystem
            instance_attrs:
              - attrs:
                  - name: device
                    value: /dev/my_vg/my_lv
                  - name: directory
                    value: /var/www
                  - name: fstype
                    value: xfs
          - id: VirtualIP
            agent: IPaddr2
            instance_attrs:
              - attrs:
                  - name: ip
                    value: 198.51.100.3
                  - name: cidr_netmask
                    value: 24
          - id: Website
            agent: apache
            instance_attrs:
              - attrs:
                  - name: configfile
                    value: /etc/httpd/conf/httpd.conf
                  - name: statusurl
                    value: http://127.0.0.1/server-status
        ha_cluster_resource_groups:
          - id: apachegroup
            resource_ids:
              - my_lvm
              - my_fs
              - VirtualIP
              - Website</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ha_cluster_cluster_name: <span class="emphasis"><em>&lt;cluster_name&gt;</em></span></code></span></dt><dd>
									The name of the cluster you are creating.
								</dd><dt><span class="term"><code class="literal">ha_cluster_hacluster_password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The password of the <code class="literal">hacluster</code> user. The <code class="literal">hacluster</code> user has full access to a cluster.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_firewall: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the firewall.
								</dd><dt><span class="term"><code class="literal">ha_cluster_manage_selinux: true</code></span></dt><dd>
									A variable that determines whether the <code class="literal">ha_cluster</code> RHEL system role manages the ports of the firewall high availability service using the <code class="literal">selinux</code> RHEL system role.
								</dd><dt><span class="term"><code class="literal">ha_cluster_fence_agent_packages: <span class="emphasis"><em>&lt;fence_agent_packages&gt;</em></span></code></span></dt><dd>
									A list of fence agent packages to install.
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_primitives: <span class="emphasis"><em>&lt;cluster_resources&gt;</em></span></code></span></dt><dd>
									A list of resource definitions for the Pacemaker resources configured by the ha_cluster RHEL system role, including fencing
								</dd><dt><span class="term"><code class="literal">ha_cluster_resource_groups: <span class="emphasis"><em>&lt;resource_groups&gt;</em></span></code></span></dt><dd>
									A list of resource group definitions configured by the <code class="literal">ha_cluster</code> RHEL system role.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						When you use the <code class="literal">apache</code> resource agent to manage Apache, it does not use <code class="literal">systemd</code>. Because of this, you must edit the <code class="literal">logrotate</code> script supplied with Apache so that it does not use <code class="literal">systemctl</code> to reload Apache.
					</p><p class="simpara">
						Remove the following line in the <code class="literal">/etc/logrotate.d/httpd</code> file on each node in the cluster.
					</p><pre class="programlisting language-bash"># /bin/systemctl reload httpd.service &gt; /dev/null 2&gt;/dev/null || true</pre><p class="simpara">
						Replace the line you removed with the following three lines, specifying <code class="literal">/var/run/httpd-<span class="emphasis"><em>website</em></span>.pid</code> as the PID file path where <span class="emphasis"><em>website</em></span> is the name of the Apache resource. In this example, the Apache resource name is <code class="literal">Website</code>.
					</p><pre class="programlisting language-bash">/usr/bin/test -f /var/run/httpd-Website.pid &gt;/dev/null 2&gt;/dev/null &amp;&amp;
/usr/bin/ps -q $(/usr/bin/cat /var/run/httpd-Website.pid) &gt;/dev/null 2&gt;/dev/null &amp;&amp;
/usr/sbin/httpd -f /etc/httpd/conf/httpd.conf -c "PidFile /var/run/httpd-Website.pid" -k graceful &gt; /dev/null 2&gt;/dev/null || true</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						From one of the nodes in the cluster, check the status of the cluster. Note that all four resources are running on the same node, <code class="literal">z1.example.com</code>.
					</p><p class="simpara">
						If you find that the resources you configured are not running, you can run the <code class="literal command">pcs resource debug-start <span class="emphasis"><em>resource</em></span></code> command to test the resource configuration.
					</p><pre class="literallayout">[root@z1 ~]# <span class="strong strong"><strong>pcs status</strong></span>
Cluster name: my_cluster
Last updated: Wed Jul 31 16:38:51 2013
Last change: Wed Jul 31 16:42:14 2013 via crm_attribute on z1.example.com
Stack: corosync
Current DC: z2.example.com (2) - partition with quorum
Version: 1.1.10-5.el7-9abe687
2 Nodes configured
6 Resources configured

Online: [ z1.example.com z2.example.com ]

Full list of resources:
 myapc  (stonith:fence_apc_snmp):       Started z1.example.com
 Resource Group: apachegroup
     my_lvm     (ocf::heartbeat:LVM-activate):   Started z1.example.com
     my_fs      (ocf::heartbeat:Filesystem):    Started z1.example.com
     VirtualIP  (ocf::heartbeat:IPaddr2):       Started z1.example.com
     Website    (ocf::heartbeat:apache):        Started z1.example.com</pre></li><li class="listitem"><p class="simpara">
						Once the cluster is up and running, you can point a browser to the IP address you defined as the <code class="literal">IPaddr2</code> resource to view the sample display, consisting of the simple word "Hello".
					</p><pre class="literallayout">Hello</pre></li><li class="listitem"><p class="simpara">
						To test whether the resource group running on <code class="literal">z1.example.com</code> fails over to node <code class="literal">z2.example.com</code>, put node <code class="literal">z1.example.com</code> in <code class="literal">standby</code> mode, after which the node will no longer be able to host resources.
					</p><pre class="literallayout">[root@z1 ~]# <span class="strong strong"><strong>pcs node standby z1.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						After putting node <code class="literal">z1</code> in <code class="literal">standby</code> mode, check the cluster status from one of the nodes in the cluster. Note that the resources should now all be running on <code class="literal">z2</code>.
					</p><pre class="literallayout">[root@z1 ~]# <span class="strong strong"><strong>pcs status</strong></span>
Cluster name: my_cluster
Last updated: Wed Jul 31 17:16:17 2013
Last change: Wed Jul 31 17:18:34 2013 via crm_attribute on z1.example.com
Stack: corosync
Current DC: z2.example.com (2) - partition with quorum
Version: 1.1.10-5.el7-9abe687
2 Nodes configured
6 Resources configured

Node z1.example.com (1): standby
Online: [ z2.example.com ]

Full list of resources:

 myapc  (stonith:fence_apc_snmp):       Started z1.example.com
 Resource Group: apachegroup
     my_lvm     (ocf::heartbeat:LVM-activate):  Started z2.example.com
     my_fs      (ocf::heartbeat:Filesystem):    Started z2.example.com
     VirtualIP  (ocf::heartbeat:IPaddr2):       Started z2.example.com
     Website    (ocf::heartbeat:apache):        Started z2.example.com</pre><p class="simpara">
						The web site at the defined IP address should still display, without interruption.
					</p></li><li class="listitem"><p class="simpara">
						To remove <code class="literal">z1</code> from <code class="literal">standby</code> mode, enter the following command.
					</p><pre class="literallayout">[root@z1 ~]# <span class="strong strong"><strong>pcs node unstandby z1.example.com</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Removing a node from <code class="literal">standby</code> mode does not in itself cause the resources to fail back over to that node. This will depend on the <code class="literal">resource-stickiness</code> value for the resources. For information about the <code class="literal">resource-stickiness</code> meta attribute, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_determining-which-node-a-resource-runs-on-configuring-and-managing-high-availability-clusters#proc_setting-resource-stickiness-determining-which-node-a-resource-runs-on">Configuring a resource to prefer its current node</a>.
						</p></div></rh-alert></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ha_cluster/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 12. Configuring the <code class="literal">systemd</code> journal by using RHEL system roles</h2></div></div></div><p>
			With the <code class="literal">journald</code> RHEL system role you can automate the <code class="literal">systemd</code> journal, and configure persistent logging by using the Red Hat Ansible Automation Platform.
		</p><section class="section" id="configuring-persistent-logging-by-using-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">12.1. Configuring persistent logging by using the <code class="literal">journald</code> RHEL system role</h3></div></div></div><p>
				By default, the <code class="literal">systemd</code> journal stores logs only in a small ring buffer in <code class="literal">/run/log/journal</code>, which is not persistent. Rebooting the system also removes journal database logs. You can configure persistent logging consistently on multiple systems by using the <code class="literal">journald</code> RHEL system role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure journald
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure persistent logging
      ansible.builtin.include_role:
        name: rhel-system-roles.journald
      vars:
        journald_persistent: true
        journald_max_disk_size: <span class="emphasis"><em>&lt;size&gt;</em></span>
        journald_per_user: true
        journald_sync_interval: <span class="emphasis"><em>&lt;interval&gt;</em></span></pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">journald_persistent: true</code></span></dt><dd>
									Enables persistent logging.
								</dd><dt><span class="term"><code class="literal">journald_max_disk_size: <span class="emphasis"><em>&lt;size&gt;</em></span></code></span></dt><dd>
									Specifies the maximum size of disk space for journal files in MB, for example, <code class="literal">2048</code>.
								</dd><dt><span class="term"><code class="literal">journald_per_user: true</code></span></dt><dd>
									Configures <code class="literal">journald</code> to keep log data separate for each user.
								</dd><dt><span class="term"><code class="literal">journald_sync_interval: <span class="emphasis"><em>&lt;interval&gt;</em></span></code></span></dt><dd><p class="simpara">
									Sets the synchronization interval in minutes, for example, <code class="literal">1</code>.
								</p><p class="simpara">
									For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.journald/README.md</code> file on the control node.
								</p></dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.journald/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/journald/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Configuring automatic crash dumps by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			To manage kdump using Ansible, you can use the <code class="literal">kdump</code> role, which is one of the RHEL system roles available in RHEL 9.
		</p><p>
			Using the <code class="literal">kdump</code> role enables you to specify where to save the contents of the system’s memory for later analysis.
		</p><section class="section" id="configuring-kdump-using-rhel-system-roles_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">13.1. Configuring the kernel crash dumping mechanism by using the <code class="literal">kdump</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				Kernel crash dumping is a crucial feature for diagnosing and troubleshooting system issues. When your system encounters a kernel panic or other critical failure, crash kernel dumping allows you to capture a memory dump (core dump) of the kernel’s state at the time of the failure.
			</p><p>
				By using an Ansible playbook, you can set kernel crash dump parameters on multiple systems using the <code class="literal">kdump</code> RHEL system role. This ensures consistent settings across all managed nodes for the <code class="literal">kdump</code> service.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">kdump</code> system role replaces the content in the <code class="literal">/etc/kdump.conf</code> and <code class="literal">/etc/sysconfig/kdump</code> configuration files. Previous settings are changed to those specified in the role variables, and lost if they are not specified in the role variables.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuring kernel crash dumping
  hosts: managed-node-01.example.com
  tasks:
    - name: Setting the kdump directory.
      ansible.builtin.include_role:
        name: rhel-system-roles.kdump
      vars:
        kdump_target:
          type: raw
          location: /dev/sda1
        kdump_path: /var/crash/vmcore
        kernel_settings_reboot_ok: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">kdump_target: <span class="emphasis"><em>&lt;type_and_location&gt;</em></span></code></span></dt><dd>
									Writes <code class="literal">vmcore</code> to a location other than the root file system. The <code class="literal">location</code> refers to a partition (by name, label, or UUID) when the <code class="literal">type</code> is raw or file system.
								</dd><dt><span class="term"><code class="literal">kernel_settings_reboot_ok: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd>
									The default is <code class="literal">false</code>. If set to <code class="literal">true</code>, the system role will determine if a reboot of the managed host is necessary for the requested changes to take effect and reboot it. If set to <code class="literal">false</code>, the role will return the variable <code class="literal">kernel_settings_reboot_required</code> with a value of <code class="literal">true</code>, indicating that a reboot is required. In this case, a user must reboot the managed node manually.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.kdump/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify the kernel crash dump parameters:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'grep crashkernel /proc/cmdline'</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.kdump/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/kdump/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Configuring kernel parameters permanently by using RHEL system roles</h2></div></div></div><p>
			You can use the <code class="literal">kernel_settings</code> RHEL system role to configure kernel parameters on multiple clients at once. This solution:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Provides a friendly interface with efficient input setting.
				</li><li class="listitem">
					Keeps all intended kernel parameters in one place.
				</li></ul></div><p>
			After you run the <code class="literal">kernel_settings</code> role from the control machine, the kernel parameters are applied to the managed systems immediately and persist across reboots.
		</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
				Note that RHEL system role delivered over RHEL channels are available to RHEL customers as an RPM package in the default AppStream repository. RHEL system role are also available as a collection to customers with Ansible subscriptions over Ansible Automation Hub.
			</p></div></rh-alert><section class="section" id="applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">14.1. Applying selected kernel parameters by using the <code class="literal">kernel_settings</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">kernel_settings</code> RHEL system role to remotely configure various kernel parameters across multiple managed operating systems with persistent effects. For example, you can configure:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Transparent hugepages to increase performance by reducing the overhead of managing smaller pages.
					</li><li class="listitem">
						The largest packet sizes are to be transmitted over the network with the loopback interface.
					</li><li class="listitem">
						Limits on files, which can be opened simultaneously.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuring kernel settings
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure hugepages, packet size for loopback device, and limits on simultaneously open files.
      ansible.builtin.include_role:
        name: rhel-system-roles.kernel_settings
      vars:
        kernel_settings_sysctl:
          - name: fs.file-max
            value: 400000
          - name: kernel.threads-max
            value: 65536
        kernel_settings_sysfs:
          - name: /sys/class/net/lo/mtu
            value: 65000
        kernel_settings_transparent_hugepages: madvise
        kernel_settings_reboot_ok: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">kernel_settings_sysfs: <span class="emphasis"><em>&lt;list_of_sysctl_settings&gt;</em></span></code></span></dt><dd>
									A YAML list of <code class="literal">sysctl</code> settings and the values you want to assign to these settings.
								</dd><dt><span class="term"><code class="literal">kernel_settings_transparent_hugepages: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									Controls the memory subsystem Transparent Huge Pages (THP) setting. You can disable THP support (<code class="literal">never</code>), enable it system wide (<code class="literal">always</code>) or inside <code class="literal">MAD_HUGEPAGE</code> regions (<code class="literal">madvise</code>).
								</dd><dt><span class="term"><code class="literal">kernel_settings_reboot_ok: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd>
									The default is <code class="literal">false</code>. If set to <code class="literal">true</code>, the system role will determine if a reboot of the managed host is necessary for the requested changes to take effect and reboot it. If set to <code class="literal">false</code>, the role will return the variable <code class="literal">kernel_settings_reboot_required</code> with a value of <code class="literal">true</code>, indicating that a reboot is required. In this case, a user must reboot the managed node manually.
								</dd></dl></div></li></ol></div><p>
				For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.kdump/README.md</code> file on the control node.
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify the affected kernel parameters:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'sysctl fs.file-max kernel.threads-max net.ipv6.conf.lo.mtu'</strong></span>
# <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'cat /sys/kernel/mm/transparent_hugepage/enabled'</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.kernel_settings/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/kernel_settings/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 15. Configuring the GRUB 2 boot loader by using RHEL system roles</h2></div></div></div><p>
			By using the <code class="literal">bootloader</code> RHEL system role, you can automate the configuration and management tasks related to the GRUB2 boot loader.
		</p><p>
			This role currently supports configuring the GRUB2 boot loader, which runs on the following CPU architectures:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					AMD and Intel 64-bit architectures (x86-64)
				</li><li class="listitem">
					The 64-bit ARM architecture (ARMv8.0)
				</li><li class="listitem">
					IBM Power Systems, Little Endian (POWER9)
				</li></ul></div><section class="section" id="updating-the-existing-boot-loader-entries-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">15.1. Updating the existing boot loader entries by using the <code class="literal">bootloader</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">bootloader</code> RHEL system role to update the existing entries in the GRUB2 boot menu in an automated fashion. This way you can efficiently pass specific kernel command-line parameters that can optimize the performance or behavior of your systems.
			</p><p>
				For example, if you leverage systems, where detailed boot messages from the kernel and init system are not necessary, use <code class="literal">bootloader</code> to apply the <code class="literal">quiet</code> parameter to your existing boot loader entries on your managed nodes to achieve a cleaner, less cluttered, and more user-friendly booting experience.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You identified the kernel that corresponds to the boot loader entry you want to update.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuration and management of GRUB2 boot loader
  hosts: managed-node-01.example.com
  tasks:
    - name: Update existing boot loader entries
      ansible.builtin.include_role:
        name: rhel-system-roles.bootloader
      vars:
        bootloader_settings:
          - kernel:
              path: /boot/vmlinuz-5.14.0-362.24.1.el9_3.aarch64
            options:
              - name: quiet
                state: present
        bootloader_reboot_ok: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">kernel</code></span></dt><dd>
									Specifies the kernel connected with the boot loader entry that you want to update.
								</dd><dt><span class="term"><code class="literal">options</code></span></dt><dd>
									Specifies the kernel command-line parameters to update for your chosen boot loader entry (kernel).
								</dd><dt><span class="term"><code class="literal">bootloader_reboot_ok: <span class="emphasis"><em>true</em></span></code></span></dt><dd>
									The role detects that a reboot is needed for the changes to take effect and performs a restart of the managed node.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that your specified boot loader entry has updated kernel command-line parameters:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.command -a 'grubby --info=ALL'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
...
index=1
kernel="/boot/vmlinuz-5.14.0-362.24.1.el9_3.aarch64"
args="ro crashkernel=1G-4G:256M,4G-64G:320M,64G-:576M rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap $tuned_params <span class="strong strong"><strong>quiet</strong></span>"
root="/dev/mapper/rhel-root"
initrd="/boot/initramfs-5.14.0-362.24.1.el9_3.aarch64.img $tuned_initrd"
title="Red Hat Enterprise Linux (5.14.0-362.24.1.el9_3.aarch64) 9.4 (Plow)"
id="2c9ec787230141a9b087f774955795ab-5.14.0-362.24.1.el9_3.aarch64"
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/bootloader/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks.html">Working With Playbooks</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html">Using Variables</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html">Roles</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#configuring-kernel-command-line-parameters_managing-monitoring-and-updating-the-kernel">Configuring kernel command-line parameters</a>
					</li></ul></div></section><section class="section" id="securing-the-boot-menu-with-password-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">15.2. Securing the boot menu with password by using the <code class="literal">bootloader</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">bootloader</code> RHEL system role to set a password to the GRUB2 boot menu in an automated fashion. This way you can efficiently prevent unauthorized users from modifying boot parameters, and to have better control over the system boot.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">pwd: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuration and management of GRUB2 boot loader
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Set the bootloader password
      ansible.builtin.include_role:
        name: rhel-system-roles.bootloader
      vars:
        bootloader_password: "{{ pwd }}"
        bootloader_reboot_ok: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">bootloader_password: <span class="emphasis"><em>"{{ pwd }}"</em></span></code></span></dt><dd>
									The variable ensures protection of boot parameters with a password.
								</dd><dt><span class="term"><code class="literal">bootloader_reboot_ok: <span class="emphasis"><em>true</em></span></code></span></dt><dd>
									The role detects that a reboot is needed for the changes to take effect and performs a restart of the managed node.
								</dd></dl></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Changing the boot loader password is not an idempotent transaction. This means that if you apply the same Ansible playbook again, the result will not be the same, and the state of the managed node will change.
						</p></div></rh-alert><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On your managed node during the GRUB2 boot menu screen, press the <kbd class="keycap">e</kbd> key for edit.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/cd35c09a617934aa83c413f94deb1c9a/bootloader_password_verification1.png" alt="GRUB2 boot loader menu"></div></div></li><li class="listitem"><p class="simpara">
						You will be prompted for a username and a password:
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/1d6466a16badfca79aff8cbb9eba7cb2/bootloader_password_verification2.png" alt="GRUB2 menu lock"></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">Enter username: root</code></span></dt><dd>
									The boot loader username is always <code class="literal">root</code> and you do not need to specify it in your Ansible playbook.
								</dd><dt><span class="term"><code class="literal">Enter password: <span class="emphasis"><em>&lt;password&gt;</em></span></code></span></dt><dd>
									The boot loader password corresponds to the <code class="literal">pwd</code> variable that you defined in the <code class="literal">vault.yml</code> file.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						You can view or edit configuration of the particular boot loader entry:
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/960bfee9d3a0f90d4e48b74ee4388b0c/bootloader_password_verification3.png" alt="GRUB2 boot loader entry details"></div></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/bootloader/</code> directory
					</li></ul></div></section><section class="section" id="setting-a-timeout-for-the-boot-loader-menu-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">15.3. Setting a timeout for the boot loader menu by using the <code class="literal">bootloader</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">bootloader</code> RHEL system role to configure a timeout for the GRUB2 boot loader menu in an automated fashion. This way you can efficiently update a period of time during which you can intervene and select a non-default boot entry for various purposes.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuration and management of GRUB2 boot loader
  hosts: managed-node-01.example.com
  tasks:
    - name: Update the boot loader timeout
      ansible.builtin.include_role:
        name: rhel-system-roles.bootloader
      vars:
        bootloader_timeout: 10</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">bootloader_timeout: 10</code></span></dt><dd>
									Input an integer to control for how long the GRUB2 boot loader menu is displayed before booting the default entry.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Remotely restart your managed node:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.reboot</strong></span>
managed-node-01.example.com | CHANGED =&gt; {
    "changed": true,
    "elapsed": 21,
    "rebooted": true
}</pre></li><li class="listitem"><p class="simpara">
						On the managed node, observe the GRUB2 boot menu screen.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/4799ebe2185bd3c825a53458bc866301/bootloader_timeout_verification.png" alt="GRUB2 boot loader menu timeout"></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">The highlighted entry will be executed automatically in 10s</code></span></dt><dd><p class="simpara">
									For how long this boot menu is displayed before GRUB2 automatically uses the default entry.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
											Alternative: you can remotely query for the "timeout" settings in the <code class="literal">/boot/grub2/grub.cfg</code> file of your managed node:
										</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.command -a "grep 'timeout' /boot/grub2/grub.cfg"</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
if [ x$feature_timeout_style = xy ] ; then
  set timeout_style=menu
  <span class="strong strong"><strong>set timeout=10</strong></span>
# Fallback normal timeout code in case the timeout_style feature is
  <span class="strong strong"><strong>set timeout=10</strong></span>
if [ x$feature_timeout_style = xy ] ; then
    set timeout_style=menu
    <span class="strong strong"><strong>set timeout=10</strong></span>
    set orig_timeout_style=${timeout_style}
    set orig_timeout=${timeout}
      # timeout_style=menu + timeout=0 avoids the countdown code keypress check
      set timeout_style=menu
      <span class="strong strong"><strong>set timeout=10</strong></span>
      set timeout_style=hidden
      <span class="strong strong"><strong>set timeout=10</strong></span>
if [ x$feature_timeout_style = xy ]; then
  if [ "${menu_show_once_timeout}" ]; then
    set timeout_style=menu
    <span class="strong strong"><strong>set timeout=10</strong></span>
    unset menu_show_once_timeout
    save_env menu_show_once_timeout</pre></li></ul></div></dd></dl></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/bootloader/</code> directory
					</li></ul></div></section><section class="section" id="collecting-the-boot-loader-configuration-information-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">15.4. Collecting the boot loader configuration information by using the <code class="literal">bootloader</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">bootloader</code> RHEL system role to gather information about the GRUB2 boot loader entries in an automated fashion. This way you can quickly identify that your systems are set up to boot correctly, all entries point to the right kernels and initial RAM disk images.
			</p><p>
				As a result, you can for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Prevent boot failures.
					</li><li class="listitem">
						Revert to a known good state when troubleshooting.
					</li><li class="listitem">
						Be sure that security-related kernel command-line parameters are correctly configured.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuration and management of GRUB2 boot loader
  hosts: managed-node-01.example.com
  tasks:
    - name: Gather information about the boot loader configuration
      ansible.builtin.include_role:
        name: rhel-system-roles.bootloader
      vars:
        bootloader_gather_facts: true

    - name: Display the collected boot loader configuration information
      debug:
        var: bootloader_facts</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						After you run the preceding playbook on the control node, you will see a similar command-line output as in the following example:
					</p><pre class="literallayout">...
    "bootloader_facts": [
        {
            "args": "ro crashkernel=1G-4G:256M,4G-64G:320M,64G-:576M rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap $tuned_params quiet",
            "default": true,
            "id": "2c9ec787230141a9b087f774955795ab-5.14.0-362.24.1.el9_3.aarch64",
            "index": "1",
            "initrd": "/boot/initramfs-5.14.0-362.24.1.el9_3.aarch64.img $tuned_initrd",
            "kernel": "/boot/vmlinuz-5.14.0-362.24.1.el9_3.aarch64",
            "root": "/dev/mapper/rhel-root",
            "title": "Red Hat Enterprise Linux (5.14.0-362.24.1.el9_3.aarch64) 9.4 (Plow)"
        }
    ]
...</pre><p class="simpara">
						The command-line output shows the following notable configuration information about the boot entry:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">args</code></span></dt><dd>
									Command-line parameters passed to the kernel by the GRUB2 boot loader during the boot process. They configure various settings and behaviors of the kernel, initramfs, and other boot-time components.
								</dd><dt><span class="term"><code class="literal">id</code></span></dt><dd>
									Unique identifier assigned to each boot entry in a boot loader menu. It consists of machine ID and the kernel version.
								</dd><dt><span class="term"><code class="literal">root</code></span></dt><dd>
									The root filesystem for the kernel to mount and use as the primary filesystem during the boot.
								</dd></dl></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/bootloader/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#what-boot-entries-are_configuring-kernel-command-line-parameters">Understanding boot entries</a>
					</li></ul></div></section></section><section class="chapter" id="configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 16. Configuring logging by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			You can use the <code class="literal">logging</code> RHEL system role to configure your local and remote hosts as logging servers in an automated fashion to collect logs from many client systems.
		</p><p>
			Logging solutions provide multiple ways of reading logs and multiple logging outputs.
		</p><p>
			For example, a logging system can receive the following inputs:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Local files
				</li><li class="listitem">
					<code class="literal">systemd/journal</code>
				</li><li class="listitem">
					Another logging system over the network
				</li></ul></div><p>
			In addition, a logging system can have the following outputs:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Logs stored in the local files in the <code class="literal">/var/log/</code> directory
				</li><li class="listitem">
					Logs sent to Elasticsearch engine
				</li><li class="listitem">
					Logs forwarded to another logging system
				</li></ul></div><p>
			With the <code class="literal">logging</code> RHEL system role, you can combine the inputs and outputs to fit your scenario. For example, you can configure a logging solution that stores inputs from <code class="literal">journal</code> in a local file, whereas inputs read from files are both forwarded to another logging system and stored in the local log files.
		</p><section class="section" id="proc_filtering-logs-in-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">16.1. Filtering local log messages by using the <code class="literal">logging</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can use the property-based filter of the <code class="literal">logging</code> RHEL system role to filter your local log messages based on various conditions. As a result, you can achieve for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Log clarity: In a high-traffic environment, logs can grow rapidly. The focus on specific messages, like errors, can help to identify problems faster.
					</li><li class="listitem">
						Optimized system performance: Excessive amount of logs is usually connected with system performance degradation. Selective logging for only the important events can prevent resource depletion, which enables your systems to run more efficiently.
					</li><li class="listitem">
						Enhanced security: Efficient filtering through security messages, like system errors and failed logins, helps to capture only the relevant logs. This is important for detecting breaches and meeting compliance standards.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Deploy the logging solution
  hosts: managed-node-01.example.com
  tasks:
    - name: Filter logs based on a specific value they contain
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: files_input
            type: basics
        logging_outputs:
          - name: files_output0
            type: files
            property: msg
            property_op: contains
            property_value: error
            path: /var/log/errors.log
          - name: files_output1
            type: files
            property: msg
            property_op: "!contains"
            property_value: error
            path: /var/log/others.log
        logging_flows:
          - name: flow0
            inputs: [files_input]
            outputs: [files_output0, files_output1]</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_inputs</code></span></dt><dd>
									Defines a list of logging input dictionaries. The <code class="literal">type: basics</code> option covers inputs from <code class="literal">systemd</code> journal or Unix socket.
								</dd><dt><span class="term"><code class="literal">logging_outputs</code></span></dt><dd>
									Defines a list of logging output dictionaries. The <code class="literal">type: files</code> option supports storing logs in the local files, usually in the <code class="literal">/var/log/</code> directory. The <code class="literal">property: msg</code>; <code class="literal">property: contains</code>; and <code class="literal">property_value: error</code> options specify that all logs that contain the <code class="literal">error</code> string are stored in the <code class="literal">/var/log/errors.log</code> file. The <code class="literal">property: msg</code>; <code class="literal">property: !contains</code>; and <code class="literal">property_value: error</code> options specify that all other logs are put in the <code class="literal">/var/log/others.log</code> file. You can replace the <code class="literal">error</code> value with the string by which you want to filter.
								</dd><dt><span class="term"><code class="literal">logging_flows</code></span></dt><dd>
									Defines a list of logging flow dictionaries to specify relationships between <code class="literal">logging_inputs</code> and <code class="literal">logging_outputs</code>. The <code class="literal">inputs: [files_input]</code> option specifies a list of inputs, from which processing of logs starts. The <code class="literal">outputs: [files_output0, files_output1]</code> option specifies a list of outputs, to which the logs are sent.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the managed node, test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-6.el8, config validation run...
rsyslogd: End of config validation run. Bye.</pre></li><li class="listitem"><p class="simpara">
						On the managed node, verify that the system sends messages that contain the <code class="literal">error</code> string to the log:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Send a test message:
							</p><pre class="literallayout"># <span class="strong strong"><strong>logger error</strong></span></pre></li><li class="listitem"><p class="simpara">
								View the <code class="literal">/var/log/errors.log</code> log, for example:
							</p><pre class="literallayout"># <span class="strong strong"><strong>cat /var/log/errors.log</strong></span>
Aug  5 13:48:31 <span class="emphasis"><em>hostname</em></span> root[6778]: error</pre><p class="simpara">
								Where <code class="literal"><span class="emphasis"><em>hostname</em></span></code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case <code class="literal">root</code>.
							</p></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
					</li><li class="listitem">
						<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
					</li></ul></div></section><section class="section" id="applying-a-remote-logging-solution-using-the-logging-system-role_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">16.2. Applying a remote logging solution by using the <code class="literal">logging</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">logging</code> RHEL system role to configure a remote logging solution, where one or more clients take logs from the <code class="literal">systemd-journal</code> service and forward them to a remote server. The server receives remote input from the <code class="literal">remote_rsyslog</code> and <code class="literal">remote_files</code> configurations, and outputs the logs to local files in directories named by remote host names.
			</p><p>
				As a result, you can cover use cases where you need for example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Centralized log management: Collecting, accessing, and managing log messages of multiple machines from a single storage point simplifies day-to-day monitoring and troubleshooting tasks. Also, this use case reduces the need to log into individual machines to check the log messages.
					</li><li class="listitem">
						Enhanced security: Storing log messages in one central place increases chances they are in a secure and tamper-proof environment. Such an environment makes it easier to detect and respond to security incidents more effectively and to meet audit requirements.
					</li><li class="listitem">
						Improved efficiency in log analysis: Correlating log messages from multiple systems is important for fast troubleshooting of complex problems that span multiple machines or services. That way you can quickly analyze and cross-reference events from different sources.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						Define the ports in the SELinux policy of the server or client system and open the firewall for those ports. The default SELinux policy includes ports 601, 514, 6514, 10514, and 20514. To use a different port, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations">modify the SELinux policy on the client and server systems</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Deploy the logging solution
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure the server to receive remote input
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: remote_udp_input
            type: remote
            udp_ports: [ 601 ]
          - name: remote_tcp_input
            type: remote
            tcp_ports: [ 601 ]
        logging_outputs:
          - name: remote_files_output
            type: remote_files
        logging_flows:
          - name: flow_0
            inputs: [remote_udp_input, remote_tcp_input]
            outputs: [remote_files_output]

- name: Deploy the logging solution
  hosts: managed-node-02.example.com
  tasks:
    - name: Configure the server to output the logs to local files in directories named by remote host names
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: basic_input
            type: basics
        logging_outputs:
          - name: forward_output0
            type: forwards
            severity: info
            target: <span class="emphasis"><em>&lt;host1.example.com&gt;</em></span>
            udp_port: 601
          - name: forward_output1
            type: forwards
            facility: mail
            target: <span class="emphasis"><em>&lt;host1.example.com&gt;</em></span>
            tcp_port: 601
        logging_flows:
          - name: flows0
            inputs: [basic_input]
            outputs: [forward_output0, forward_output1]

[basic_input]
[forward_output0, forward_output1]</pre><p class="simpara">
						The settings specified in the first play of the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_inputs</code></span></dt><dd>
									Defines a list of logging input dictionaries. The <code class="literal">type: remote</code> option covers remote inputs from the other logging system over the network. The <code class="literal">udp_ports: [ 601 ]</code> option defines a list of UDP port numbers to monitor. The <code class="literal">tcp_ports: [ 601 ]</code> option defines a list of TCP port numbers to monitor. If both <code class="literal">udp_ports</code> and <code class="literal">tcp_ports</code> is set, <code class="literal">udp_ports</code> is used and <code class="literal">tcp_ports</code> is dropped.
								</dd><dt><span class="term"><code class="literal">logging_outputs</code></span></dt><dd>
									Defines a list of logging output dictionaries. The <code class="literal">type: remote_files</code> option makes output store logs to the local files per remote host and program name originated the logs.
								</dd><dt><span class="term"><code class="literal">logging_flows</code></span></dt><dd>
									Defines a list of logging flow dictionaries to specify relationships between <code class="literal">logging_inputs</code> and <code class="literal">logging_outputs</code>. The <code class="literal">inputs: [remote_udp_input, remote_tcp_input]</code> option specifies a list of inputs, from which processing of logs starts. The <code class="literal">outputs: [remote_files_output]</code> option specifies a list of outputs, to which the logs are sent.
								</dd></dl></div><p class="simpara">
						The settings specified in the second play of the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_inputs</code></span></dt><dd>
									Defines a list of logging input dictionaries. The <code class="literal">type: basics</code> option covers inputs from <code class="literal">systemd</code> journal or Unix socket.
								</dd><dt><span class="term"><code class="literal">logging_outputs</code></span></dt><dd>
									Defines a list of logging output dictionaries. The <code class="literal">type: forwards</code> option supports sending logs to the remote logging server over the network. The <code class="literal">severity: info</code> option refers to log messages of the informative importance. The <code class="literal">facility: mail</code> option refers to the type of system program that is generating the log message. The <code class="literal">target: <span class="emphasis"><em>&lt;host1.example.com&gt;</em></span></code> option specifies the hostname of the remote logging server. The <code class="literal">udp_port: 601</code>/<code class="literal">tcp_port: 601</code> options define the UDP/TCP ports on which the remote logging server listens.
								</dd><dt><span class="term"><code class="literal">logging_flows</code></span></dt><dd>
									Defines a list of logging flow dictionaries to specify relationships between <code class="literal">logging_inputs</code> and <code class="literal">logging_outputs</code>. The <code class="literal">inputs: [basic_input]</code> option specifies a list of inputs, from which processing of logs starts. The <code class="literal">outputs: [forward_output0, forward_output1]</code> option specifies a list of outputs, to which the logs are sent.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On both the client and the server system, test the syntax of the <code class="literal">/etc/rsyslog.conf</code> file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>rsyslogd -N 1</strong></span>
rsyslogd: version 8.1911.0-6.el8, config validation run (level 1), master config /etc/rsyslog.conf
rsyslogd: End of config validation run. Bye.</pre></li><li class="listitem"><p class="simpara">
						Verify that the client system sends messages to the server:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								On the client system, send a test message:
							</p><pre class="literallayout"># <span class="strong strong"><strong>logger test</strong></span></pre></li><li class="listitem"><p class="simpara">
								On the server system, view the <code class="literal">/var/log/<span class="emphasis"><em>&lt;host2.example.com&gt;</em></span>/messages</code> log, for example:
							</p><pre class="literallayout"># <span class="strong strong"><strong>cat /var/log/<span class="emphasis"><em>&lt;host2.example.com&gt;</em></span>/messages</strong></span>
Aug  5 13:48:31 <span class="emphasis"><em>&lt;host2.example.com&gt;</em></span> root[6778]: test</pre><p class="simpara">
								Where <code class="literal"><span class="emphasis"><em>&lt;host2.example.com&gt;</em></span></code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case <code class="literal">root</code>.
							</p></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
					</li><li class="listitem">
						<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
					</li></ul></div></section><section class="section" id="assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">16.3. Using the <code class="literal">logging</code> RHEL system role with TLS</h3></div></div></div><p class="_abstract _abstract">
				Transport Layer Security (TLS) is a cryptographic protocol designed to allow secure communication over the computer network.
			</p><p>
				You can use the <code class="literal">logging</code> RHEL system role to configure a secure transfer of log messages, where one or more clients take logs from the <code class="literal">systemd-journal</code> service and transfer them to a remote server while using TLS.
			</p><p>
				Typically, TLS for transferring logs in a remote logging solution is used when sending sensitive data over less trusted or public networks, such as the Internet. Also, by using certificates in TLS you can ensure that the client is forwarding logs to the correct and trusted server. This prevents attacks like "man-in-the-middle".
			</p><section class="section" id="configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls"><div class="titlepage"><div><div><h4 class="title">16.3.1. Configuring client logging with TLS</h4></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> RHEL system role to configure logging on RHEL clients and transfer logs to a remote logging system using TLS encryption.
				</p><p>
					This procedure creates a private key and a certificate. Next, it configures TLS on all hosts in the clients group in the Ansible inventory. The TLS protocol encrypts the message transmission for secure transfer of logs over the network.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						You do not have to call the <code class="literal">certificate</code> RHEL system role in the playbook to create the certificate. The <code class="literal">logging</code> RHEL system role calls it automatically when the <code class="literal">logging_certificates</code> variable is set.
					</p><p>
						In order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							The managed nodes are enrolled in an IdM domain.
						</li><li class="listitem">
							If the logging server you want to configure on the manage node runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS extension "Extended Master Secret" enforced</a> Knowledgebase article.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure remote logging solution using TLS for secure transfer of logs
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploying files input and forwards output with certs
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_certificates:
          - name: logging_cert
            dns: ['localhost', 'www.example.com']
            ca: ipa
        logging_pki_files:
          - ca_cert: /local/path/to/ca_cert.pem
            cert: /local/path/to/logging_cert.pem
            private_key: /local/path/to/logging_cert.pem
        logging_inputs:
          - name: input_name
            type: files
            input_log_path: /var/log/containers/*.log
        logging_outputs:
          - name: output_name
            type: forwards
            target: your_target_host
            tcp_port: 514
            tls: true
            pki_authmode: x509/name
            permitted_server: 'server.example.com'
        logging_flows:
          - name: flow_name
            inputs: [input_name]
            outputs: [output_name]</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_certificates</code></span></dt><dd>
										The value of this parameter is passed on to <code class="literal">certificate_requests</code> in the <code class="literal">certificate</code> RHEL system role and used to create a private key and certificate.
									</dd><dt><span class="term"><code class="literal">logging_pki_files</code></span></dt><dd><p class="simpara">
										Using this parameter, you can configure the paths and other settings that logging uses to find the CA, certificate, and key files used for TLS, specified with one or more of the following sub-parameters: <code class="literal">ca_cert</code>, <code class="literal">ca_cert_src</code>, <code class="literal">cert</code>, <code class="literal">cert_src</code>, <code class="literal">private_key</code>, <code class="literal">private_key_src</code>, and <code class="literal">tls</code>.
									</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
											If you are using <code class="literal">logging_certificates</code> to create the files on the managed node, do not use <code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, and <code class="literal">private_key_src</code>, which are used to copy files not created by <code class="literal">logging_certificates</code>.
										</p></div></rh-alert></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to the CA certificate file on the managed node. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to the certificate file on the managed node. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to the private key file on the managed node. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents the path to the CA certificate file on the control node which is copied to the target host to the location specified by <code class="literal">ca_cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the path to a certificate file on the control node which is copied to the target host to the location specified by <code class="literal">cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the path to a private key file on the control node which is copied to the target host to the location specified by <code class="literal">private_key</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd>
										Setting this parameter to <code class="literal">true</code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set <code class="literal">tls: false</code>.
									</dd></dl></div><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
						</li><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/certificate/</code> directory
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL system roles</a>.
						</li><li class="listitem">
							<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
						</li></ul></div></section><section class="section" id="configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls"><div class="titlepage"><div><div><h4 class="title">16.3.2. Configuring server logging with TLS</h4></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> RHEL system role to configure logging on RHEL servers and set them to receive logs from a remote logging system using TLS encryption.
				</p><p>
					This procedure creates a private key and a certificate. Next, it configures TLS on all hosts in the server group in the Ansible inventory.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						You do not have to call the <code class="literal">certificate</code> RHEL system role in the playbook to create the certificate. The <code class="literal">logging</code> RHEL system role calls it automatically.
					</p><p>
						In order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							The managed nodes are enrolled in an IdM domain.
						</li><li class="listitem">
							If the logging server you want to configure on the manage node runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS extension "Extended Master Secret" enforced</a> Knowledgebase article.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure remote logging solution using TLS for secure transfer of logs
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploying remote input and remote_files output with certs
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_certificates:
          - name: logging_cert
            dns: ['localhost', 'www.example.com']
            ca: ipa
        logging_pki_files:
          - ca_cert: /local/path/to/ca_cert.pem
            cert: /local/path/to/logging_cert.pem
            private_key: /local/path/to/logging_cert.pem
        logging_inputs:
          - name: input_name
            type: remote
            tcp_ports: 514
            tls: true
            permitted_clients: ['clients.example.com']
        logging_outputs:
          - name: output_name
            type: remote_files
            remote_log_path: /var/log/remote/%FROMHOST%/%PROGRAMNAME:::secpath-replace%.log
            async_writing: true
            client_count: 20
            io_buffer_size: 8192
        logging_flows:
          - name: flow_name
            inputs: [input_name]
            outputs: [output_name]</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">logging_certificates</code></span></dt><dd>
										The value of this parameter is passed on to <code class="literal">certificate_requests</code> in the <code class="literal">certificate</code> RHEL system role and used to create a private key and certificate.
									</dd><dt><span class="term"><code class="literal">logging_pki_files</code></span></dt><dd><p class="simpara">
										Using this parameter, you can configure the paths and other settings that logging uses to find the CA, certificate, and key files used for TLS, specified with one or more of the following sub-parameters: <code class="literal">ca_cert</code>, <code class="literal">ca_cert_src</code>, <code class="literal">cert</code>, <code class="literal">cert_src</code>, <code class="literal">private_key</code>, <code class="literal">private_key_src</code>, and <code class="literal">tls</code>.
									</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
											If you are using <code class="literal">logging_certificates</code> to create the files on the managed node, do not use <code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, and <code class="literal">private_key_src</code>, which are used to copy files not created by <code class="literal">logging_certificates</code>.
										</p></div></rh-alert></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to the CA certificate file on the managed node. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to the certificate file on the managed node. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to the private key file on the managed node. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents the path to the CA certificate file on the control node which is copied to the target host to the location specified by <code class="literal">ca_cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the path to a certificate file on the control node which is copied to the target host to the location specified by <code class="literal">cert</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the path to a private key file on the control node which is copied to the target host to the location specified by <code class="literal">private_key</code>. Do not use this if using <code class="literal">logging_certificates</code>.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd>
										Setting this parameter to <code class="literal">true</code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set <code class="literal">tls: false</code>.
									</dd></dl></div><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">Requesting certificates using RHEL system roles</a>.
						</li><li class="listitem">
							<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
						</li></ul></div></section></section><section class="section" id="assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h3 class="title">16.4. Using the <code class="literal">logging</code> RHEL system roles with RELP</h3></div></div></div><p class="_abstract _abstract">
				Reliable Event Logging Protocol (RELP) is a networking protocol for data and message logging over the TCP network. It ensures reliable delivery of event messages and you can use it in environments that do not tolerate any message loss.
			</p><p>
				The RELP sender transfers log entries in the form of commands and the receiver acknowledges them once they are processed. To ensure consistency, RELP stores the transaction number to each transferred command for any kind of message recovery.
			</p><p>
				You can consider a remote logging system in between the RELP Client and RELP Server. The RELP Client transfers the logs to the remote logging system and the RELP Server receives all the logs sent by the remote logging system. To achieve that use case, you can use the <code class="literal">logging</code> RHEL system role to configure the logging system to reliably send and receive log entries.
			</p><section class="section" id="configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h4 class="title">16.4.1. Configuring client logging with RELP</h4></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> RHEL system role to configure a transfer of log messages stored locally to the remote logging system with RELP.
				</p><p>
					This procedure configures RELP on all hosts in the <code class="literal">clients</code> group in the Ansible inventory. The RELP configuration uses Transport Layer Security (TLS) to encrypt the message transmission for secure transfer of logs over the network.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure client-side of the remote logging solution using RELP
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploy basic input and RELP output
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: basic_input
            type: basics
        logging_outputs:
          - name: relp_client
            type: relp
            target: logging.server.com
            port: 20514
            tls: true
            ca_cert: /etc/pki/tls/certs/ca.pem
            cert: /etc/pki/tls/certs/client-cert.pem
            private_key: /etc/pki/tls/private/client-key.pem
            pki_authmode: name
            permitted_servers:
              - '*.server.example.com'
        logging_flows:
          - name: example_flow
            inputs: [basic_input]
            outputs: [relp_client]</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">target</code></span></dt><dd>
										This is a required parameter that specifies the host name where the remote logging system is running.
									</dd><dt><span class="term"><code class="literal">port</code></span></dt><dd>
										Port number the remote logging system is listening.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd><p class="simpara">
										Ensures secure transfer of logs over the network. If you do not want a secure wrapper you can set the <code class="literal">tls</code> variable to <code class="literal">false</code>. By default <code class="literal">tls</code> parameter is set to true while working with RELP and requires key/certificates and triplets {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} and/or {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>}.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												If the {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>} triplet is set, the default locations <code class="literal">/etc/pki/tls/certs</code> and <code class="literal">/etc/pki/tls/private</code> are used as the destination on the managed node to transfer files from control node. In this case, the file names are identical to the original ones in the triplet
											</li><li class="listitem">
												If the {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} triplet is set, files are expected to be on the default path before the logging configuration.
											</li><li class="listitem">
												If both triplets are set, files are transferred from local path from control node to specific path of the managed node.
											</li></ul></div></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to CA certificate. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to certificate. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to private key. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents local CA certificate file path which is copied to the managed node. If <code class="literal">ca_cert</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the local certificate file path which is copied to the managed node. If <code class="literal">cert</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the local key file path which is copied to the managed node. If <code class="literal">private_key</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">pki_authmode</code></span></dt><dd>
										Accepts the authentication mode as <code class="literal">name</code> or <code class="literal">fingerprint</code>.
									</dd><dt><span class="term"><code class="literal">permitted_servers</code></span></dt><dd>
										List of servers that will be allowed by the logging client to connect and send logs over TLS.
									</dd><dt><span class="term"><code class="literal">inputs</code></span></dt><dd>
										List of logging input dictionary.
									</dd><dt><span class="term"><code class="literal">outputs</code></span></dt><dd>
										List of logging output dictionary.
									</dd></dl></div><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
						</li><li class="listitem">
							<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
						</li></ul></div></section><section class="section" id="configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp"><div class="titlepage"><div><div><h4 class="title">16.4.2. Configuring server logging with RELP</h4></div></div></div><p class="_abstract _abstract">
					You can use the <code class="literal">logging</code> RHEL system role to configure a server for receiving log messages from the remote logging system with RELP.
				</p><p>
					This procedure configures RELP on all hosts in the <code class="literal">server</code> group in the Ansible inventory. The RELP configuration uses TLS to encrypt the message transmission for secure transfer of logs over the network.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: Configure server-side of the remote logging solution using RELP
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploying remote input and remote_files output
      ansible.builtin.include_role:
        name: rhel-system-roles.logging
      vars:
        logging_inputs:
          - name: relp_server
            type: relp
            port: 20514
            tls: true
            ca_cert: /etc/pki/tls/certs/ca.pem
            cert: /etc/pki/tls/certs/server-cert.pem
            private_key: /etc/pki/tls/private/server-key.pem
            pki_authmode: name
            permitted_clients:
              - '*example.client.com'
        logging_outputs:
          - name: remote_files_output
            type: remote_files
        logging_flows:
          - name: example_flow
            inputs: relp_server
            outputs: remote_files_output</pre><p class="simpara">
							The settings specified in the example playbook include the following:
						</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">port</code></span></dt><dd>
										Port number the remote logging system is listening.
									</dd><dt><span class="term"><code class="literal">tls</code></span></dt><dd><p class="simpara">
										Ensures secure transfer of logs over the network. If you do not want a secure wrapper you can set the <code class="literal">tls</code> variable to <code class="literal">false</code>. By default <code class="literal">tls</code> parameter is set to true while working with RELP and requires key/certificates and triplets {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} and/or {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>}.
									</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
												If the {<code class="literal">ca_cert_src</code>, <code class="literal">cert_src</code>, <code class="literal">private_key_src</code>} triplet is set, the default locations <code class="literal">/etc/pki/tls/certs</code> and <code class="literal">/etc/pki/tls/private</code> are used as the destination on the managed node to transfer files from control node. In this case, the file names are identical to the original ones in the triplet
											</li><li class="listitem">
												If the {<code class="literal">ca_cert</code>, <code class="literal">cert</code>, <code class="literal">private_key</code>} triplet is set, files are expected to be on the default path before the logging configuration.
											</li><li class="listitem">
												If both triplets are set, files are transferred from local path from control node to specific path of the managed node.
											</li></ul></div></dd><dt><span class="term"><code class="literal">ca_cert</code></span></dt><dd>
										Represents the path to CA certificate. Default path is <code class="literal">/etc/pki/tls/certs/ca.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">cert</code></span></dt><dd>
										Represents the path to the certificate. Default path is <code class="literal">/etc/pki/tls/certs/server-cert.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">private_key</code></span></dt><dd>
										Represents the path to private key. Default path is <code class="literal">/etc/pki/tls/private/server-key.pem</code> and the file name is set by the user.
									</dd><dt><span class="term"><code class="literal">ca_cert_src</code></span></dt><dd>
										Represents local CA certificate file path which is copied to the managed node. If <code class="literal">ca_cert</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">cert_src</code></span></dt><dd>
										Represents the local certificate file path which is copied to the managed node. If <code class="literal">cert</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">private_key_src</code></span></dt><dd>
										Represents the local key file path which is copied to the managed node. If <code class="literal">private_key</code> is specified, it is copied to the location.
									</dd><dt><span class="term"><code class="literal">pki_authmode</code></span></dt><dd>
										Accepts the authentication mode as <code class="literal">name</code> or <code class="literal">fingerprint</code>.
									</dd><dt><span class="term"><code class="literal">permitted_clients</code></span></dt><dd>
										List of clients that will be allowed by the logging server to connect and send logs over TLS.
									</dd><dt><span class="term"><code class="literal">inputs</code></span></dt><dd>
										List of logging input dictionary.
									</dd><dt><span class="term"><code class="literal">outputs</code></span></dt><dd>
										List of logging output dictionary.
									</dd></dl></div><p class="simpara">
							For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file on the control node.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.logging/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/logging/</code> directory
						</li><li class="listitem">
							<code class="literal">rsyslog.conf(5)</code> and <code class="literal">syslog(3)</code> manual pages
						</li></ul></div></section></section></section><section class="chapter" id="monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 17. Configuring performance monitoring with PCP by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			Performance Co-Pilot (PCP) is a system performance analysis toolkit. You can use it to record and analyze performance data from many components on a Red Hat Enterprise Linux system.
		</p><p>
			You can use the <code class="literal">metrics</code> RHEL system role to automate the installation and configuration of PCP, and the role can configure Grafana to visualize PCP metrics.
		</p><section class="section" id="configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">17.1. Configuring Performance Co-Pilot by using the <code class="literal">metrics</code> RHEL system role</h3></div></div></div><p>
				You can use Performance Co-Pilot (PCP) to monitor many metrics, such as CPU utilization and memory usage. For example, this can help to identify resource and performance bottlenecks. By using the <code class="literal">metrics</code> RHEL system role, you can remotely configure PCP on multiple hosts to record metrics.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Monitoring performance metrics
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure Performance Co-Pilot
      ansible.builtin.include_role:
        name: rhel-system-roles.metrics
      vars:
        metrics_retention_days: 14
        metrics_manage_firewall: true
        metrics_manage_selinux: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">metrics_retention_days: <span class="emphasis"><em>&lt;number&gt;</em></span></code></span></dt><dd>
									Sets the number of days after which the <code class="literal">pmlogger_daily</code> systemd timer removes old PCP archives.
								</dd><dt><span class="term"><code class="literal">metrics_manage_firewall: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd>
									Defines whether the role should open the required ports in the <code class="literal">firewalld</code> service. If you want to remotely access PCP on the managed nodes, set this variable to <code class="literal">true</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Query a metric, for example:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'pminfo -f kernel.all.load'</strong></span></pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Next step</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Optional: <a class="link" href="#setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role" title="17.3. Setting up Grafana by using the metrics RHEL system role to monitor multiple hosts with Performance Co-Pilot">Configure Grafana to monitor PCP hosts and visualize metrics</a>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/metrics/</code> directory
					</li></ul></div></section><section class="section" id="configuring-performance-co-pilot-with-authentication-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">17.2. Configuring Performance Co-Pilot with authentication by using the <code class="literal">metrics</code> RHEL system role</h3></div></div></div><p>
				You can enable authentication in Performance Co-Pilot (PCP) so that the <code class="literal">pmcd</code> service and Performance Metrics Domain Agents (PDMAs) can determine whether the user running the monitoring tools is allowed to perform an action. Authenticated users have access to metrics with sensitive information. Additionally, certain agents require authentication. For example, the <code class="literal">bpftrace</code> agent uses authentication to identify whether a user is allowed to load <code class="literal">bpftrace</code> scripts into the kernel to generate metrics.
			</p><p>
				By using the <code class="literal">metrics</code> RHEL system role, you can remotely configure PCP with authentication on multiple hosts.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">metrics_usr: <span class="emphasis"><em>&lt;username&gt;</em></span>
metrics_pwd: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Monitoring performance metrics
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure Performance Co-Pilot
      ansible.builtin.include_role:
        name: rhel-system-roles.metrics
      vars:
        metrics_retention_days: 14
        metrics_manage_firewall: true
        metrics_manage_selinux: true
	metrics_username: "{{ metrics_usr }}"
        metrics_password: "{{ metrics_pwd }}"</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">metrics_retention_days: <span class="emphasis"><em>&lt;number&gt;</em></span></code></span></dt><dd>
									Sets the number of days after which the <code class="literal">pmlogger_daily</code> systemd timer removes old PCP archives.
								</dd><dt><span class="term"><code class="literal">metrics_manage_firewall: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd>
									Defines whether the role should open the required ports in the <code class="literal">firewalld</code> service. If you want to remotely access PCP on the managed nodes, set this variable to <code class="literal">true</code>.
								</dd><dt><span class="term"><code class="literal">metrics_username: <span class="emphasis"><em>&lt;username&gt;</em></span></code></span></dt><dd>
									The role creates this user locally on the managed node, adds the credentials to the <code class="literal">/etc/pcp/passwd.db</code> Simple Authentication and Security Layer (SASL) database, and configures authentication in PCP. Additionally, if you set <code class="literal">metrics_from_bpftrace: true</code> in the playbook, PCP uses this account to register <code class="literal">bpftrace</code> scripts.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On a host with the <code class="literal">pcp</code> package installed, query a metric that requires authentication:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Query the metrics by using the credentials that you used in the playbook:
							</p><pre class="literallayout"># <span class="strong strong"><strong>pminfo -fmdt -h pcp://managed-node-01.example.com?username=<span class="emphasis"><em>&lt;user&gt;</em></span> proc.fd.count</strong></span>
Password: <span class="emphasis"><em>&lt;password&gt;</em></span>

proc.fd.count
    inst [844 or "000844 /var/lib/pcp/pmdas/proc/pmdaproc"] value 5</pre><p class="simpara">
								If the command succeeds, it returns the value of the <code class="literal">proc.fd.count</code> metric.
							</p></li><li class="listitem"><p class="simpara">
								Run the command again, but omit the username to verify that the command fails for unauthenticated users:
							</p><pre class="literallayout"># <span class="strong strong"><strong>pminfo -fmdt -h pcp://managed-node-01.example.com proc.fd.count</strong></span>

proc.fd.count
Error: No permission to perform requested operation</pre></li></ol></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Next step</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Optional: <a class="link" href="#setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role" title="17.3. Setting up Grafana by using the metrics RHEL system role to monitor multiple hosts with Performance Co-Pilot">Configure Grafana to monitor PCP hosts and visualize metrics</a>.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/metrics/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section><section class="section" id="setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">17.3. Setting up Grafana by using the <code class="literal">metrics</code> RHEL system role to monitor multiple hosts with Performance Co-Pilot</h3></div></div></div><p>
				If you have already configured Performance Co-Pilot (PCP) on multiple hosts, you can use an instance of Grafana to visualize the metrics for these hosts. You can display the live data and, if the PCP data is stored in a Redis database, also past data.
			</p><p>
				By using the <code class="literal">metrics</code> RHEL system role, you can automate the process of setting up Grafana, the PCP plug-in, the optional Redis database, and the configuration of the data sources.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you use the <code class="literal">metrics</code> role to install Grafana on a host, the role also installs automatically PCP on this host.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						<a class="link" href="#configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" title="17.1. Configuring Performance Co-Pilot by using the metrics RHEL system role">PCP is configured for remote access on the hosts you want to monitor</a>.
					</li><li class="listitem">
						The host on which you want to install Grafana can access port 44321 on the PCP nodes you plan to monitor.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">grafana_admin_pwd: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Monitoring performance metrics
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Set up Grafana to monitor multiple hosts
      ansible.builtin.include_role:
        name: rhel-system-roles.metrics
      vars:
        metrics_graph_service: true
        metrics_query_service: true
        metrics_monitored_hosts:
          - <span class="emphasis"><em>&lt;pcp_host_1.example.com&gt;</em></span>
          - <span class="emphasis"><em>&lt;pcp_host_2.example.com&gt;</em></span>
        metrics_manage_firewall: true
        metrics_manage_selinux: true

    - name: Set Grafana admin password
      ansible.builtin.shell:
        cmd: grafana-cli admin reset-admin-password "{{ grafana_admin_pwd }}"</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">metrics_graph_service: true</code></span></dt><dd>
									Installs Grafana and the PCP plug-in. Additionally, the role adds the <code class="literal">PCP Vector</code>, <code class="literal">PCP Redis</code>, and <code class="literal">PCP bpftrace</code> data sources to Grafana.
								</dd><dt><span class="term"><code class="literal">metrics_query_service: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd>
									Defines whether the role should install and configure Redis for centralized metric recording. If enabled, data collected from PCP clients is stored in Redis and, as a result, you can also display historical data instead of only live data.
								</dd><dt><span class="term"><code class="literal">metrics_monitored_hosts: <span class="emphasis"><em>&lt;list_of_hosts&gt;</em></span></code></span></dt><dd>
									Defines the list of hosts to monitor. In Grafana, you can then display the data of these hosts and, additionally, the host that runs Grafana.
								</dd><dt><span class="term"><code class="literal">metrics_manage_firewall: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd>
									Defines whether the role should open the required ports in the <code class="literal">firewalld</code> service. If you set this variable to <code class="literal">true</code>, you can, for example, access Grafana remotely.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open <code class="literal">http://<span class="emphasis"><em>&lt;grafana_server_IP_or_hostname&gt;</em></span>:3000</code> in your browser, and log in as the <code class="literal">admin</code> user with the password you set in the procedure.
					</li><li class="listitem"><p class="simpara">
						Display monitoring data:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To display live data:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Click <span class="guimenu">Menu</span> → <span class="guisubmenu">Apps</span> → <span class="guisubmenu">Performance Co-Pilot</span> → <span class="guimenuitem">PCP Vector Checklist</span>
									</li><li class="listitem">
										By default, the graphs display metrics from the host that runs Grafana. To switch to a different host, enter the hostname in the <code class="literal">hostspec</code> field and press <kbd class="keycap">Enter</kbd>.
									</li></ol></div></li><li class="listitem">
								To display historical data stored in a Redis database: <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/monitoring_and_managing_system_status_and_performance/setting-up-graphical-representation-of-pcp-metrics_monitoring-and-managing-system-status-and-performance#creating-panel-and-alerts-in-pcp-redis-data-source_setting-up-graphical-representation-of-pcp-metrics">Create a panel with a PCP Redis data source</a>. This requires that you set <code class="literal">metrics_query_service: true</code> in the playbook.
							</li></ul></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/metrics/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section><section class="section" id="configuring-web-hooks-in-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">17.4. Configuring web hooks in Performance Co-Pilot by using the <code class="literal">metrics</code> RHEL system role</h3></div></div></div><p>
				The Performance Co-Pilot (PCP) suite contains the performance metrics inference engine (PMIE) service. This service evaluates performance rules in real time. For example, you can use the default rules to detect excessive swap activities.
			</p><p>
				You can configure a host as a central PCP management site that collects the monitoring data from multiple PCP nodes. If a rule matches, this central host sends a notification to a web hook to notify other services. For example, the web hook can trigger Event-Driven Ansible to run on Ansible Automation Platform template or playbook on the host that had caused the event.
			</p><p>
				By using the <code class="literal">metrics</code> RHEL system role, you can automate the configuration of a central PCP management host that notifies a web hook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						<a class="link" href="#configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role" title="17.1. Configuring Performance Co-Pilot by using the metrics RHEL system role">PCP is configured for remote access on the hosts you want to monitor</a>.
					</li><li class="listitem">
						The host on which you want to configure PMIE can access port 44321 on the PCP nodes you plan to monitor.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Monitoring performance metrics
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure PMIE web hooks
      ansible.builtin.include_role:
        name: redhat.rhel_system_roles.metrics
      vars:
        metrics_manage_firewall: true
        metrics_retention_days: 7
        metrics_monitored_hosts:
          - pcp-node-01.example.com
          - pcp-node-02.example.com
        metrics_webhook_endpoint: "https://&lt;webserver&gt;:&lt;port&gt;/&lt;endpoint&gt;"</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">metrics_retention_days: <span class="emphasis"><em>&lt;number&gt;</em></span></code></span></dt><dd>
									Sets the number of days after which the <code class="literal">pmlogger_daily</code> systemd timer removes old PCP archives.
								</dd><dt><span class="term"><code class="literal">metrics_manage_firewall: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd>
									Defines whether the role should open the required ports in the <code class="literal">firewalld</code> service. If you want to remotely access PCP on the managed nodes, set this variable to <code class="literal">true</code>.
								</dd><dt><span class="term"><code class="literal">metrics_monitored_hosts: <span class="emphasis"><em>&lt;list_of_hosts&gt;</em></span></code></span></dt><dd>
									Specifies the hosts to observe.
								</dd><dt><span class="term"><code class="literal">metrics_webhook_endpoint: <span class="emphasis"><em>&lt;URL&gt;</em></span></code></span></dt><dd>
									Sets the web hook endpoint to which the performance metrics inference engine (PMIE) sends notifications about detected performance issues. By default, these issues are logged to the local system only.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ ansible-playbook --syntax-check ~/playbook.yml</pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook ~/playbook.yml</pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the configuration summary on <code class="literal">managed-node-node-01.example.com</code>:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'pcp summary'</strong></span>
Performance Co-Pilot configuration on managed-node-01.example.com:

 platform: Linux managed-node-node-01.example.com 5.14.0-427.el9.x86_64 #1 SMP PREEMPT_DYNAMIC Fri Feb 23 01:51:18 EST 2024 x86_64
 hardware: 8 cpus, 1 disk, 1 node, 1773MB RAM
 timezone: CEST-2
 services: pmcd pmproxy
 pmcd: Version 6.2.0-1, 12 agents, 6 clients
 pmda: root pmcd proc pmproxy xfs linux nfsclient mmv kvm jbd2
       dm openmetrics
 pmlogger: primary logger: /var/log/pcp/pmlogger/managed-node-node-01.example.com/20240510.16.25
           pcp-node-01.example.com: /var/log/pmlogger/pcp-node-01.example.com/20240510.16.25
           pcp-node-02.example.com: /var/log/pmlogger/pcp-node-02.example.com/20240510.16.25
 pmie: primary engine: /var/log/pcp/pmie/managed-node-node-01.example.com/pmie.log
       pcp-node-01.example.com: : /var/log/pcp/pmie/pcp-node-01.example.com/pmie.log
       pcp-node-02.example.com: : /var/log/pcp/pmie/pcp-node-02.example.com/pmie.log</pre><p class="simpara">
						The last three lines confirm that PMIE is configured to monitor three systems.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/metrics/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/blog/automate-performance-management-performance-co-pilot">Automate performance management with Performance Co-Pilot using Event-Driven Ansible</a> blog post
					</li></ul></div></section></section><section class="chapter" id="assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 18. Configuring Microsoft SQL Server by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			You can use the <code class="literal">microsoft.sql.server</code> Ansible system role to automate the installation and management of Microsoft SQL Server. This role also optimizes Red Hat Enterprise Linux (RHEL) to improve the performance and throughput of SQL Server by applying the <code class="literal">mssql</code> TuneD profile.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				During the installation, the role adds repositories for SQL Server and related packages to the managed hosts. Packages in these repositories are provided, maintained, and hosted by Microsoft.
			</p></div></rh-alert><section class="section" id="installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-existing-certificate-files_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role"><div class="titlepage"><div><div><h3 class="title">18.1. Installing and configuring SQL Server with an existing TLS certificate by using the <code class="literal">microsoft.sql.server</code> Ansible system role</h3></div></div></div><p>
				If your application requires a Microsoft SQL Server database, you can configure SQL Server with TLS encryption to enable secure communication between the application and the database. By using the <code class="literal">microsoft.sql.server</code> Ansible system role, you can automate this process and remotely install and configure SQL Server with TLS encryption. In the playbook, you can use an existing private key and a TLS certificate that was issued by a certificate authority (CA).
			</p><p>
				Depending on the RHEL version on the managed host, the version of SQL Server that you can install differs:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						RHEL 7.9: SQL Server 2017 and 2019
					</li><li class="listitem">
						RHEL 8: SQL Server 2017, 2019, and 2022
					</li><li class="listitem">
						RHEL 9.4 and later: SQL Server 2022
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You installed the <code class="literal">ansible-collection-microsoft-sql</code> package or the <a class="link" href="https://console.redhat.com/ansible/automation-hub/repo/published/microsoft/sql"><code class="literal">microsoft.sql</code></a> collection on the control node.
					</li><li class="listitem">
						The managed node has 2 GB or more RAM installed.
					</li><li class="listitem">
						The managed node uses one of the following versions: RHEL 7.9, RHEL 8, RHEL 9.4 or later.
					</li><li class="listitem">
						You stored the certificate in the <code class="literal">sql_crt.pem</code> file in the same directory as the playbook.
					</li><li class="listitem">
						You stored the private key in the <code class="literal">sql_cert.key</code> file in the same directory as the playbook.
					</li><li class="listitem">
						SQL clients trust the CA that issued the certificate.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">sa_pwd: <span class="emphasis"><em>&lt;sa_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Installing and configuring Microsoft SQL Server
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: SQL Server with an existing private key and certificate
      ansible.builtin.include_role:
        name: microsoft.sql.server
      vars:
        mssql_accept_microsoft_odbc_driver_17_for_sql_server_eula: true
        mssql_accept_microsoft_cli_utilities_for_sql_server_eula: true
        mssql_accept_microsoft_sql_server_standard_eula: true

        mssql_version: 2022
        mssql_password: "{{ sa_pwd  }}"
        mssql_edition: Developer
        mssql_tcp_port: 1433
        mssql_manage_firewall: true

        mssql_tls_enable: true
        mssql_tls_cert: sql_crt.pem
        mssql_tls_private_key: sql_cert.key
        mssql_tls_version: 1.2
        mssql_tls_force: true</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">mssql_tls_enable: true</code></span></dt><dd>
									Enables TLS encryption. If you enable this setting, you must also define <code class="literal">mssql_tls_cert</code> and <code class="literal">mssql_tls_private_key</code>.
								</dd><dt><span class="term"><code class="literal">mssql_tls_cert: <span class="emphasis"><em>&lt;path&gt;</em></span></code></span></dt><dd>
									Sets the path to the TLS certificate stored on the control node. The role copies this file to the <code class="literal">/etc/pki/tls/certs/</code> directory on the managed node.
								</dd><dt><span class="term"><code class="literal">mssql_tls_private_key: <span class="emphasis"><em>&lt;path&gt;</em></span></code></span></dt><dd>
									Sets the path to the TLS private key on the control node. The role copies this file to the <code class="literal">/etc/pki/tls/private/</code> directory on the managed node.
								</dd><dt><span class="term"><code class="literal">mssql_tls_force: true</code></span></dt><dd>
									Replaces the TLS certificate and private key in their destination directories if they exist.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/microsoft.sql-server/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the SQL Server host, use the <code class="literal">sqlcmd</code> utility with the <code class="literal">-N</code> parameter to establish an encrypted connection to SQL server and run a query, for example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>/opt/mssql-tools/bin/sqlcmd -N -S server.example.com -U "sa" -P <span class="emphasis"><em>&lt;sa_password&gt;</em></span> -Q 'SELECT SYSTEM_USER'</strong></span></pre><p class="simpara">
						If the command succeeds, the connection to the server was TLS encrypted.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/microsoft.sql-server/README.md</code> file
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section><section class="section" id="installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-the-certificate-role_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role"><div class="titlepage"><div><div><h3 class="title">18.2. Installing and configuring SQL Server with a TLS certificate issued from IdM by using the <code class="literal">microsoft.sql.server</code> Ansible system role</h3></div></div></div><p>
				If your application requires a Microsoft SQL Server database, you can configure SQL Server with TLS encryption to enable secure communication between the application and the database. If the SQL Server host is a member in a Red Hat Identity Management (IdM) domain, the <code class="literal">certmonger</code> service can manage the certificate request and future renewals.
			</p><p>
				By using the <code class="literal">microsoft.sql.server</code> Ansible system role, you can automate this process. You can remotely install and configure SQL Server with TLS encryption, and the <code class="literal">microsoft.sql.server</code> role uses the <code class="literal">certificate</code> Ansible system role to configure <code class="literal">certmonger</code> and request a certificate from IdM.
			</p><p>
				Depending on the RHEL version on the managed host, the version of SQL Server that you can install differs:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						RHEL 7.9: SQL Server 2017 and 2019
					</li><li class="listitem">
						RHEL 8: SQL Server 2017, 2019, and 2022
					</li><li class="listitem">
						RHEL 9.4 and later: SQL Server 2022
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You installed the <code class="literal">ansible-collection-microsoft-sql</code> package or the <a class="link" href="https://console.redhat.com/ansible/automation-hub/repo/published/microsoft/sql"><code class="literal">microsoft.sql</code></a> collection on the control node.
					</li><li class="listitem">
						The managed node has 2 GB or more RAM installed.
					</li><li class="listitem">
						The managed node uses one of the following versions: RHEL 7.9, RHEL 8, RHEL 9.4 or later.
					</li><li class="listitem">
						You enrolled the managed node in a Red Hat Identity Management (IdM) domain.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">sa_pwd: <span class="emphasis"><em>&lt;sa_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Installing and configuring Microsoft SQL Server
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: SQL Server with certificates issued by Red Hat IdM
      ansible.builtin.include_role:
        name: microsoft.sql.server
      vars:
        mssql_accept_microsoft_odbc_driver_17_for_sql_server_eula: true
        mssql_accept_microsoft_cli_utilities_for_sql_server_eula: true
        mssql_accept_microsoft_sql_server_standard_eula: true

        mssql_version: 2022
        mssql_password: "{{ sa_pwd  }}"
        mssql_edition: Developer
        mssql_tcp_port: 1433
        mssql_manage_firewall: true

        mssql_tls_enable: true
        mssql_tls_certificates:
          - name: sql_cert
            dns: server.example.com
            ca: ipa</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">mssql_tls_enable: true</code></span></dt><dd>
									Enables TLS encryption. If you enable this setting, you must also define <code class="literal">mssql_tls_certificates</code>.
								</dd><dt><span class="term"><code class="literal">mssql_tls_certificates</code></span></dt><dd>
									A list of YAML dictionaries with settings for the <code class="literal">certificate</code> role.
								</dd><dt><span class="term"><code class="literal">name: <span class="emphasis"><em>&lt;file_name&gt;</em></span></code></span></dt><dd>
									Defines the base name of the certificate and private key. The <code class="literal">certificate</code> role stores the certificate in the <code class="literal">/etc/pki/tls/certs/<span class="emphasis"><em>&lt;file_name&gt;</em></span>.crt</code> and the private key in the <code class="literal">/etc/pki/tls/private/<span class="emphasis"><em>&lt;file_name&gt;</em></span>.key</code> file.
								</dd><dt><span class="term"><code class="literal">dns: <span class="emphasis"><em>&lt;hostname_or_list_of_hostnames&gt;</em></span></code></span></dt><dd>
									Sets the hostnames that the Subject Alternative Names (SAN) field in the issued certificate contains. You can use a wildcard (<code class="literal">*</code>) or specify multiple names in YAML list format.
								</dd><dt><span class="term"><code class="literal">ca: <span class="emphasis"><em>&lt;ca_type&gt;</em></span></code></span></dt><dd>
									Defines how the <code class="literal">certificate</code> role requests the certificate. Set the variable to <code class="literal">ipa</code> if the host is enrolled in an IdM domain or <code class="literal">self-sign</code> to request a self-signed certificate.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/microsoft.sql-server/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the SQL Server host, use the <code class="literal">sqlcmd</code> utility with the <code class="literal">-N</code> parameter to establish an encrypted connection to SQL server and run a query, for example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>/opt/mssql-tools/bin/sqlcmd -N -S server.example.com -U "sa" -P <span class="emphasis"><em>&lt;sa_password&gt;</em></span> -Q 'SELECT SYSTEM_USER'</strong></span></pre><p class="simpara">
						If the command succeeds, the connection to the server was TLS encrypted.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/microsoft.sql-server/README.md</code> file
					</li><li class="listitem">
						<a class="link" href="#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 7. Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles">Requesting certificates by using RHEL system roles</a>
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section><section class="section" id="setting-up-custom-storage-paths-for-data-and-logs_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role"><div class="titlepage"><div><div><h3 class="title">18.3. Installing and configuring SQL Server with custom storage paths by using the <code class="literal">microsoft.sql.server</code> Ansible system role</h3></div></div></div><p>
				When you use the <code class="literal">microsoft.sql.server</code> Ansible system role to install and configure a new SQL Server, you can customize the paths and modes of the data and log directories. For example, configure custom paths if you want to store databases and log files in a different directory with more storage.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					If you change the data or log path and re-run the playbook, the previously-used directories and all their content remains at the original path. Only new databases and logs are stored in the new location.
				</p></div></rh-alert><rh-table id="idm140064647601200"><table class="gt-4-cols lt-7-rows"><caption>Table 18.1. SQL Server default settings for data and log directories</caption><colgroup><col style="width: 17%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 17%; " class="col_3"><!--Empty--><col style="width: 17%; " class="col_4"><!--Empty--><col style="width: 17%; " class="col_5"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140064647593536" scope="col">Type</th><th align="left" valign="top" id="idm140064647592448" scope="col">Directory</th><th align="left" valign="top" id="idm140064647591360" scope="col">Mode</th><th align="left" valign="top" id="idm140064647590272" scope="col">Owner</th><th align="left" valign="top" id="idm140064647589184" scope="col">Group</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140064647593536"> <p>
								Data
							</p>
							 </td><td align="left" valign="top" headers="idm140064647592448"> <p>
								<code class="literal">/var/opt/mssql/data/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647591360"> <p>
								<a href="#ftn.mssqldirmode" class="footnote"><sup class="footnote" id="mssqldirmode">[a]</sup></a>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647590272"> <p>
								<code class="literal">mssql</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647589184"> <p>
								<code class="literal">mssql</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140064647593536"> <p>
								Logs
							</p>
							 </td><td align="left" valign="top" headers="idm140064647592448"> <p>
								<code class="literal">/var/opt/mssql/los/</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647591360"> <p>
								<a href="#ftn.mssqldirmode" class="footnoteref"><sup class="footnoteref">[a]</sup></a>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647590272"> <p>
								<code class="literal">mssql</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140064647589184"> <p>
								<code class="literal">mssql</code>
							</p>
							 </td></tr></tbody><tbody class="footnotes"><tr><td colspan="5"><div id="ftn.mssqldirmode" class="footnote"><div class="para"><a href="#mssqldirmode" class="simpara"><sup class="simpara">[a] </sup></a>
									If the directory exists, the role preserves the mode. If the directory does not exist, the role applies the default <code class="literal">umask</code> on the managed node when it creates the directory.
								</div></div></td></tr></tbody></table></rh-table><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You installed the <code class="literal">ansible-collection-microsoft-sql</code> package or the <a class="link" href="https://console.redhat.com/ansible/automation-hub/repo/published/microsoft/sql"><code class="literal">microsoft.sql</code></a> collection on the control node.
					</li><li class="listitem">
						The managed node has 2 GB or more RAM installed.
					</li><li class="listitem">
						The managed node uses one of the following versions: RHEL 7.9, RHEL 8, RHEL 9.4 or later.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">sa_pwd: <span class="emphasis"><em>&lt;sa_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Edit an existing playbook file, for example <code class="literal">~/playbook.yml</code>, and add the storage and log-related variables:
					</p><pre class="programlisting language-yaml">---
- name: Installing and configuring Microsoft SQL Server
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: SQL Server with custom storage paths
      ansible.builtin.include_role:
        name: microsoft.sql.server
      vars:
        mssql_accept_microsoft_odbc_driver_17_for_sql_server_eula: true
        mssql_accept_microsoft_cli_utilities_for_sql_server_eula: true
        mssql_accept_microsoft_sql_server_standard_eula: true

        mssql_version: 2022
        mssql_password: "{{ sa_pwd  }}"
        mssql_edition: Developer
        mssql_tcp_port: 1433
        mssql_manage_firewall: true

        <span class="strong strong"><strong>mssql_datadir: /var/lib/mssql/</strong></span>
        <span class="strong strong"><strong>mssql_datadir_mode: '0700'</strong></span>
        <span class="strong strong"><strong>mssql_logdir: /var/log/mssql/</strong></span>
        <span class="strong strong"><strong>mssql_logdir_mode: '0700'</strong></span></pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">mssql_datadir_mode</code> and <code class="literal">mssql_logdir_mode</code></span></dt><dd>
									Set the permission modes. Specify the value in single quotes to ensure that the role parses the value as a string and not as an octal number.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/microsoft.sql-server/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the mode of the data directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ls -ld /var/lib/mssql/'</strong></span>
drwx------. 12 mssql mssql 4096 Jul  3 13:53 /var/lib/mssql/</pre></li><li class="listitem"><p class="simpara">
						Display the mode of the log directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ls -ld /var/log/mssql/'</strong></span>
drwx------. 12 mssql mssql 4096 Jul  3 13:53 /var/log/mssql/</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/microsoft.sql-server/README.md</code> file
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section><section class="section" id="preparing-and-running-a-playbook-to-enable-sql-server-authentication-with-active-directory_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role"><div class="titlepage"><div><div><h3 class="title">18.4. Installing and configuring SQL Server with AD integration by using the <code class="literal">microsoft.sql.server</code> Ansible system role</h3></div></div></div><p>
				You can integrate Microsoft SQL Server into an Active Directory (AD) to enable AD users to authenticate to SQL Server. By using the <code class="literal">microsoft.sql.server</code> Ansible system role, you can automate this process and remotely install and configure SQL Server accordingly. Note that you must still perform manual steps in AD and SQL Server after you run the playbook.
			</p><p>
				Depending on the RHEL version on the managed host, the version of SQL Server that you can install differs:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						RHEL 7.9: SQL Server 2017 and 2019
					</li><li class="listitem">
						RHEL 8: SQL Server 2017, 2019, and 2022
					</li><li class="listitem">
						RHEL 9.4 and later: SQL Server 2022
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You installed the <code class="literal">ansible-collection-microsoft-sql</code> package or the <a class="link" href="https://console.redhat.com/ansible/automation-hub/repo/published/microsoft/sql"><code class="literal">microsoft.sql</code></a> collection on the control node.
					</li><li class="listitem">
						The managed node has 2 GB or more RAM installed.
					</li><li class="listitem">
						The managed node uses one of the following versions: RHEL 7.9, RHEL 8, RHEL 9.4 or later.
					</li><li class="listitem">
						An AD domain is available in the network.
					</li><li class="listitem">
						A reverse DNS (RDNS) zone exists in AD, and it contains Pointer (PTR) resource records for each AD domain controller (DC).
					</li><li class="listitem">
						The managed host’s network settings use an AD DNS server.
					</li><li class="listitem"><p class="simpara">
						The managed host can resolve the following DNS entries:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Both the hostnames and the fully-qualified domain names (FQDNs) of the AD DCs resolve to their IP addresses.
							</li><li class="listitem">
								The IP addresses of the AD DCs resolve to their FQDNs.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">sa_pwd: <span class="emphasis"><em>&lt;sa_password&gt;</em></span>
sql_pwd: <span class="emphasis"><em>&lt;SQL_AD_password&gt;</em></span>
ad_admin_pwd: <span class="emphasis"><em>&lt;AD_admin_password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Installing and configuring Microsoft SQL Server
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: SQL Server with AD authentication
      ansible.builtin.include_role:
        name: microsoft.sql.server
      vars:
        mssql_accept_microsoft_odbc_driver_17_for_sql_server_eula: true
        mssql_accept_microsoft_cli_utilities_for_sql_server_eula: true
        mssql_accept_microsoft_sql_server_standard_eula: true

        mssql_version: 2022
        mssql_password: "{{ sa_pwd }}"
        mssql_edition: Developer
        mssql_tcp_port: 1433
        mssql_manage_firewall: true

        mssql_ad_configure: true
        mssql_ad_join: true
        mssql_ad_sql_user: sqluser
        mssql_ad_sql_password: "{{ sql_pwd }}"
        ad_integration_realm: ad.example.com
        ad_integration_user: Administrator
        ad_integration_password: "{{ ad_admin_pwd }}"</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">mssql_ad_configure: true</code></span></dt><dd>
									Enables authentication against AD.
								</dd><dt><span class="term"><code class="literal">mssql_ad_join: true</code></span></dt><dd>
									Uses the <code class="literal">ad_integration</code> RHEL system role to join the managed node to AD. The role uses the settings from the <code class="literal">ad_integration_realm</code>, <code class="literal">ad_integration_user</code>, and <code class="literal">ad_integration_password</code> variables to join the domain.
								</dd><dt><span class="term"><code class="literal">mssql_ad_sql_user: <span class="emphasis"><em>&lt;username&gt;</em></span></code></span></dt><dd>
									Sets the name of an AD account that the role should create in AD and SQL Server for administration purposes.
								</dd><dt><span class="term"><code class="literal">ad_integration_user: <span class="emphasis"><em>&lt;AD_user&gt;</em></span></code></span></dt><dd>
									Sets the name of an AD user with privileges to join machines to the domain and to create the AD user specified in <code class="literal">mssql_ad_sql_user</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/microsoft.sql-server/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						In your AD domain, enable 128 bit and 256 bit Kerberos authentication for the AD SQL user which you specified in the playbook. Use one of the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								In the <span class="strong strong"><strong>Active Directory Users and Computers</strong></span> application:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Navigate to <span class="strong strong"><strong>ad.example.com</strong></span> &gt; <span class="strong strong"><strong>Users</strong></span> &gt; <span class="strong strong"><strong>sqluser</strong></span> &gt; <span class="strong strong"><strong>Accounts</strong></span>.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Account options</strong></span> list, select <span class="strong strong"><strong>This account supports Kerberos AES 128 bit encryption</strong></span> and <span class="strong strong"><strong>This account supports Kerberos AES 256 bit encryption</strong></span>.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Apply</strong></span>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								In PowerShell in admin mode, enter:
							</p><pre class="literallayout">C:\&gt; <span class="strong strong"><strong>Set-ADUser -Identity <code class="literal">sqluser</code> -KerberosEncryptionType AES128,AES256</strong></span></pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Authorize AD users that should be able to authenticate to SQL Server. On the SQL Server, perform the following steps:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Obtain a Kerberos ticket for the <code class="literal">Administrator</code> user:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit Administrator@ad.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
								Authorize an AD user:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>/opt/mssql-tools/bin/sqlcmd -S. -Q 'CREATE LOGIN [AD\&lt;AD_user&gt;] FROM WINDOWS;'</strong></span></pre><p class="simpara">
								Repeat this step for every AD user who should be able to access SQL Server.
							</p></li></ol></div></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the managed node that runs SQL Server:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Obtain a Kerberos ticket for an AD user:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit <span class="emphasis"><em>&lt;AD_user&gt;</em></span>@ad.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
								Use the <code class="literal">sqlcmd</code> utility to log in to SQL Server and run a query, for example:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>/opt/mssql-tools/bin/sqlcmd -S. -Q 'SELECT SYSTEM_USER'</strong></span></pre></li></ol></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/microsoft.sql-server/README.md</code> file
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section></section><section class="chapter" id="configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 19. Configuring NBDE by using RHEL system roles</h2></div></div></div><p>
			You can use the <code class="literal">nbde_client</code> and <code class="literal">nbde_server</code> RHEL system roles for automated deployments of Policy-Based Decryption (PBD) solutions using Clevis and Tang. The <code class="literal">rhel-system-roles</code> package contains these system roles, the related examples, and also the reference documentation.
		</p><section class="section" id="using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">19.1. Using the <code class="literal">nbde_server</code> RHEL system role for setting up multiple Tang servers</h3></div></div></div><p>
				By using the <code class="literal">nbde_server</code> system role, you can deploy and manage a Tang server as part of an automated disk encryption solution. This role supports the following features:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Rotating Tang keys
					</li><li class="listitem">
						Deploying and backing up Tang keys
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Deploy a Tang server
- hosts: tang.server.example.com
- tasks:
  - name: Install and configure periodic key rotation
    ansible.builtin.include_role:
        name: rhel-system-roles.nbde_server
    vars:
      nbde_server_rotate_keys: yes
      nbde_server_manage_firewall: true
      nbde_server_manage_selinux: true</pre><p class="simpara">
						This example playbook ensures deploying of your Tang server and a key rotation.
					</p><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">nbde_server_manage_firewall: true</code></span></dt><dd>
									Use the <code class="literal">firewall</code> system role to manage ports used by the <code class="literal">nbde_server</code> role.
								</dd><dt><span class="term"><code class="literal">nbde_server_manage_selinux: true</code></span></dt><dd><p class="simpara">
									Use the <code class="literal">selinux</code> system role to manage ports used by the <code class="literal">nbde_server</code> role.
								</p><p class="simpara">
									For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_server/README.md</code> file on the control node.
								</p></dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On your NBDE client, verify that your Tang server works correctly by using the following command. The command must return the identical message you pass for encryption and decryption:
					</p><pre class="screen"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'echo test | clevis encrypt tang '{"url":"<span class="emphasis"><em>&lt;tang.server.example.com&gt;</em></span>"}' -y | clevis decrypt'</strong></span>
test</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_server/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/nbde_server/</code> directory
					</li></ul></div></section><section class="section" id="using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">19.2. Setting up Clevis clients with DHCP by using the <code class="literal">nbde_client</code> RHEL system role</h3></div></div></div><p>
				The <code class="literal">nbde_client</code> system role enables you to deploy multiple Clevis clients in an automated way.
			</p><p>
				This role supports binding a LUKS-encrypted volume to one or more Network-Bound (NBDE) servers - Tang servers. You can either preserve the existing volume encryption with a passphrase or remove it. After removing the passphrase, you can unlock the volume only using NBDE. This is useful when a volume is initially encrypted using a temporary key or password that you should remove after you provision the system.
			</p><p>
				If you provide both a passphrase and a key file, the role uses what you have provided first. If it does not find any of these valid, it attempts to retrieve a passphrase from an existing binding.
			</p><p>
				Policy-Based Decryption (PBD) defines a binding as a mapping of a device to a slot. This means that you can have multiple bindings for the same device. The default slot is slot 1.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal">nbde_client</code> system role supports only Tang bindings. Therefore, you cannot use it for TPM2 bindings.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						A volume that is already encrypted by using LUKS.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure clients for unlocking of encrypted volumes by Tang servers
  hosts: managed-node-01.example.com
  tasks:
    - name: Create NBDE client bindings
      ansible.builtin.include_role:
        name: rhel-system-roles.nbde_client
      vars:
        nbde_client_bindings:
          - device: /dev/rhel/root
            encryption_key_src: /etc/luks/keyfile
            nbde_client_early_boot: true
            state: present
            servers:
              - http://server1.example.com
              - http://server2.example.com
          - device: /dev/rhel/swap
            encryption_key_src: /etc/luks/keyfile
            servers:
              - http://server1.example.com
              - http://server2.example.com</pre><p class="simpara">
						This example playbook configures Clevis clients for automated unlocking of two LUKS-encrypted volumes when at least one of two Tang servers is available.
					</p><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">state: present</code></span></dt><dd>
									The values of <code class="literal">state</code> indicate the configuration after you run the playbook. Use the <code class="literal">present</code> value for either creating a new binding or updating an existing one. Contrary to a <code class="literal">clevis luks bind</code> command, you can use <code class="literal">state: present</code> also for overwriting an existing binding in its device slot. The <code class="literal">absent</code> value removes a specified binding.
								</dd><dt><span class="term"><code class="literal">nbde_client_early_boot: true</code></span></dt><dd><p class="simpara">
									The <code class="literal">nbde_client</code> role ensures that networking for a Tang pin is available during early boot by default. If you scenario requires to disable this feature, add the <code class="literal">nbde_client_early_boot: false</code> variable to your playbook.
								</p><p class="simpara">
									For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md</code> file on the control node.
								</p></dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On your NBDE client, check that the encrypted volume that should be automatically unlocked by your Tang servers contain the corresponding information in its LUKS pins:
					</p><pre class="screen"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'clevis luks list -d /dev/rhel/root'</strong></span>
1: tang '{"url":"<span class="emphasis"><em>&lt;http://server1.example.com/&gt;</em></span>"}'
2: tang '{"url":"<span class="emphasis"><em>&lt;http://server2.example.com/&gt;</em></span>"}'</pre></li><li class="listitem"><p class="simpara">
						If you do not use the <code class="literal">nbde_client_early_boot: false</code> variable, verify that the bindings are available for the early boot, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'lsinitrd | grep clevis-luks'</strong></span>
lrwxrwxrwx   1 root     root           48 Jan  4 02:56 etc/systemd/system/cryptsetup.target.wants/clevis-luks-askpass.path -&gt; /usr/lib/systemd/system/clevis-luks-askpass.path
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/nbde_client/</code> directory
					</li></ul></div></section><section class="section" id="setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">19.3. Setting up static-IP Clevis clients by using the <code class="literal">nbde_client</code> RHEL system role</h3></div></div></div><p>
				The <code class="literal">nbde_client</code> RHEL system role supports only scenarios with Dynamic Host Configuration Protocol (DHCP). On an NBDE client with static IP configuration, you must pass your network configuration as a kernel boot parameter.
			</p><p>
				Typically, administrators want to reuse a playbook and not maintain individual playbooks for each host to which Ansible assigns static IP addresses during early boot. In this case, you can use variables in the playbook and provide the settings in an external file. As a result, you need only one playbook and one file with the settings.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						A volume that is already encrypted by using LUKS.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a file with the network settings of your hosts, for example, <code class="literal">static-ip-settings-clients.yml</code>, and add the values you want to dynamically assign to the hosts:
					</p><pre class="programlisting language-yaml">clients:
  managed-node-01.example.com:
    ip_v4: 192.0.2.1
    gateway_v4: 192.0.2.254
    netmask_v4: 255.255.255.0
    interface: enp1s0
  managed-node-02.example.com:
    ip_v4: 192.0.2.2
    gateway_v4: 192.0.2.254
    netmask_v4: 255.255.255.0
    interface: enp1s0</pre></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example, <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">- name: Configure clients for unlocking of encrypted volumes by Tang servers
  hosts: managed-node-01.example.com,managed-node-02.example.com
  vars_files:
    - ~/static-ip-settings-clients.yml
  tasks:
    - name: Create NBDE client bindings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        nbde_client_bindings:
          - device: /dev/rhel/root
            encryption_key_src: /etc/luks/keyfile
            servers:
              - http://server1.example.com
              - http://server2.example.com
          - device: /dev/rhel/swap
            encryption_key_src: /etc/luks/keyfile
            servers:
              - http://server1.example.com
              - http://server2.example.com

    - name: Configure a Clevis client with static IP address during early boot
      ansible.builtin.include_role:
        name: rhel-system-roles.bootloader
      vars:
        bootloader_settings:
          - kernel: ALL
            options:
              - name: ip
                value: "{{ clients[inventory_hostname]['ip_v4'] }}::{{ clients[inventory_hostname]['gateway_v4'] }}:{{ clients[inventory_hostname]['netmask_v4'] }}::{{ clients[inventory_hostname]['interface'] }}:none"</pre><p class="simpara">
						This playbook reads certain values dynamically for each host listed in the <code class="literal">~/static-ip-settings-clients.yml</code> file.
					</p><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/nbde_client/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/sysadmin/network-confi-initrd">Looking forward to Linux network configuration in the initial ramdisk (initrd)</a> (Red Hat Enable Sysadmin)
					</li></ul></div></section></section><section class="chapter" id="assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 20. Configuring network settings by using RHEL system roles</h2></div></div></div><p>
			By using the <code class="literal">network</code> RHEL system role, you can automate network-related configuration and management tasks.
		</p><section class="section" id="configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.1. Configuring an Ethernet connection with a static IP address by using the <code class="literal">network</code> RHEL system role with an interface name</h3></div></div></div><p class="_abstract _abstract">
				To connect a Red Hat Enterprise Linux host to an Ethernet network, create a NetworkManager connection profile for the network device. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure an Ethernet connection with static IP addresses, gateways, and DNS settings, and assign them to a specified interface name.
			</p><p>
				Typically, administrators want to reuse a playbook and not maintain individual playbooks for each host to which Ansible should assign static IP addresses. In this case, you can use variables in the playbook and maintain the settings in the inventory. As a result, you need only one playbook to dynamically assign individual settings to multiple hosts.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						A physical or virtual Ethernet device exists in the server configuration.
					</li><li class="listitem">
						The managed nodes use NetworkManager to configure the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Edit the <code class="literal">~/inventory</code> file, and append the host-specific settings to the host entries:
					</p><pre class="programlisting language-ini">managed-node-01.example.com <span class="strong strong"><strong>interface=enp1s0 ip_v4=192.0.2.1/24 ip_v6=2001:db8:1::1/64 gateway_v4=192.0.2.254 gateway_v6=2001:db8:1::fffe</strong></span>

managed-node-02.example.com <span class="strong strong"><strong>interface=enp1s0 ip_v4=192.0.2.2/24 ip_v6=2001:db8:1::2/64 gateway_v4=192.0.2.254 gateway_v6=2001:db8:1::fffe</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com,managed-node-02.example.com
  tasks:
    - name: Ethernet connection profile with static IP address settings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: "{{ interface }}"
            interface_name: "{{ interface }}"
            type: ethernet
            autoconnect: yes
            ip:
              address:
                - "{{ ip_v4 }}"
                - "{{ ip_v6 }}"
              gateway4: "{{ gateway_v4 }}"
              gateway6: "{{ gateway_v6 }}"
              dns:
                - 192.0.2.200
                - 2001:db8:1::ffbb
              dns_search:
                - example.com
            state: up</pre><p class="simpara">
						This playbook reads certain values dynamically for each host from the inventory file and uses static values in the playbook for settings which are the same for all hosts.
					</p><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Query the Ansible facts of the managed node and verify the active network settings:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.setup</strong></span>
...
        "ansible_default_ipv4": {
            "address": "192.0.2.1",
            "alias": "enp1s0",
            "broadcast": "192.0.2.255",
            "gateway": "192.0.2.254",
            "interface": "enp1s0",
            "macaddress": "52:54:00:17:b8:b6",
            "mtu": 1500,
            "netmask": "255.255.255.0",
            "network": "192.0.2.0",
            "prefix": "24",
            "type": "ether"
        },
        "ansible_default_ipv6": {
            "address": "2001:db8:1::1",
            "gateway": "2001:db8:1::fffe",
            "interface": "enp1s0",
            "macaddress": "52:54:00:17:b8:b6",
            "mtu": 1500,
            "prefix": "64",
            "scope": "global",
            "type": "ether"
        },
        ...
        "ansible_dns": {
            "nameservers": [
                "192.0.2.1",
                "2001:db8:1::ffbb"
            ],
            "search": [
                "example.com"
            ]
        },
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.2. Configuring an Ethernet connection with a static IP address by using the <code class="literal">network</code> RHEL system role with a device path</h3></div></div></div><p class="_abstract _abstract">
				To connect a Red Hat Enterprise Linux host to an Ethernet network, create a NetworkManager connection profile for the network device. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure an Ethernet connection with static IP addresses, gateways, and DNS settings, and assign them to a device based on its path instead of its name.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						A physical or virtual Ethernet device exists in the servers configuration.
					</li><li class="listitem">
						The managed nodes use NetworkManager to configure the network.
					</li><li class="listitem">
						You know the path of the device. You can display the device path by using the <code class="literal">udevadm info /sys/class/net/<span class="emphasis"><em>&lt;device_name&gt;</em></span> | grep ID_PATH=</code> command.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Ethernet connection profile with static IP address settings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: example
            match:
              path:
                - pci-0000:00:0[1-3].0
                - &amp;!pci-0000:00:02.0
            type: ethernet
            autoconnect: yes
            ip:
              address:
                - 192.0.2.1/24
                - 2001:db8:1::1/64
              gateway4: 192.0.2.254
              gateway6: 2001:db8:1::fffe
              dns:
                - 192.0.2.200
                - 2001:db8:1::ffbb
              dns_search:
                - example.com
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">match</code></span></dt><dd>
									Defines that a condition must be met in order to apply the settings. You can only use this variable with the <code class="literal">path</code> option.
								</dd><dt><span class="term"><code class="literal">path</code></span></dt><dd>
									Defines the persistent path of a device. You can set it as a fixed path or an expression. Its value can contain modifiers and wildcards. The example applies the settings to devices that match PCI ID <code class="literal">0000:00:0[1-3].0</code>, but not <code class="literal">0000:00:02.0</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Query the Ansible facts of the managed node and verify the active network settings:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.setup</strong></span>
...
        "ansible_default_ipv4": {
            "address": "192.0.2.1",
            "alias": "enp1s0",
            "broadcast": "192.0.2.255",
            "gateway": "192.0.2.254",
            "interface": "enp1s0",
            "macaddress": "52:54:00:17:b8:b6",
            "mtu": 1500,
            "netmask": "255.255.255.0",
            "network": "192.0.2.0",
            "prefix": "24",
            "type": "ether"
        },
        "ansible_default_ipv6": {
            "address": "2001:db8:1::1",
            "gateway": "2001:db8:1::fffe",
            "interface": "enp1s0",
            "macaddress": "52:54:00:17:b8:b6",
            "mtu": 1500,
            "prefix": "64",
            "scope": "global",
            "type": "ether"
        },
        ...
        "ansible_dns": {
            "nameservers": [
                "192.0.2.1",
                "2001:db8:1::ffbb"
            ],
            "search": [
                "example.com"
            ]
        },
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.3. Configuring an Ethernet connection with a dynamic IP address by using the <code class="literal">network</code> RHEL system role with an interface name</h3></div></div></div><p class="_abstract _abstract">
				To connect a Red Hat Enterprise Linux host to an Ethernet network, create a NetworkManager connection profile for the network device. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure an Ethernet connection that retrieves its IP addresses, gateways, and DNS settings from a DHCP server and IPv6 stateless address autoconfiguration (SLAAC). With this role you can assign the connection profile to the specified interface name.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						A physical or virtual Ethernet device exists in the servers configuration.
					</li><li class="listitem">
						A DHCP server and SLAAC are available in the network.
					</li><li class="listitem">
						The managed nodes use the NetworkManager service to configure the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Ethernet connection profile with dynamic IP address settings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: enp1s0
            interface_name: enp1s0
            type: ethernet
            autoconnect: yes
            ip:
              dhcp4: yes
              auto6: yes
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">dhcp4: yes</code></span></dt><dd>
									Enables automatic IPv4 address assignment from DHCP, PPP, or similar services.
								</dd><dt><span class="term"><code class="literal">auto6: yes</code></span></dt><dd>
									Enables IPv6 auto-configuration. By default, NetworkManager uses Router Advertisements. If the router announces the <code class="literal">managed</code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Query the Ansible facts of the managed node and verify that the interface received IP addresses and DNS settings:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.setup</strong></span>
...
        "ansible_default_ipv4": {
            "address": "192.0.2.1",
            "alias": "enp1s0",
            "broadcast": "192.0.2.255",
            "gateway": "192.0.2.254",
            "interface": "enp1s0",
            "macaddress": "52:54:00:17:b8:b6",
            "mtu": 1500,
            "netmask": "255.255.255.0",
            "network": "192.0.2.0",
            "prefix": "24",
            "type": "ether"
        },
        "ansible_default_ipv6": {
            "address": "2001:db8:1::1",
            "gateway": "2001:db8:1::fffe",
            "interface": "enp1s0",
            "macaddress": "52:54:00:17:b8:b6",
            "mtu": 1500,
            "prefix": "64",
            "scope": "global",
            "type": "ether"
        },
        ...
        "ansible_dns": {
            "nameservers": [
                "192.0.2.1",
                "2001:db8:1::ffbb"
            ],
            "search": [
                "example.com"
            ]
        },
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.4. Configuring an Ethernet connection with a dynamic IP address by using the <code class="literal">network</code> RHEL system role with a device path</h3></div></div></div><p class="_abstract _abstract">
				To connect a Red Hat Enterprise Linux host to an Ethernet network, create a NetworkManager connection profile for the network device. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure an Ethernet connection that retrieves its IP addresses, gateways, and DNS settings from a DHCP server and IPv6 stateless address autoconfiguration (SLAAC). The role can assign the connection profile to a device based on its path instead of an interface name.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						A physical or virtual Ethernet device exists in the servers configuration.
					</li><li class="listitem">
						A DHCP server and SLAAC are available in the network.
					</li><li class="listitem">
						The managed hosts use NetworkManager to configure the network.
					</li><li class="listitem">
						You know the path of the device. You can display the device path by using the <code class="literal">udevadm info /sys/class/net/<span class="emphasis"><em>&lt;device_name&gt;</em></span> | grep ID_PATH=</code> command.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Ethernet connection profile with dynamic IP address settings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: example
            match:
              path:
                - pci-0000:00:0[1-3].0
                - &amp;!pci-0000:00:02.0
            type: ethernet
            autoconnect: yes
            ip:
              dhcp4: yes
              auto6: yes
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">match: path</code></span></dt><dd>
									Defines that a condition must be met in order to apply the settings. You can only use this variable with the <code class="literal">path</code> option.
								</dd><dt><span class="term"><code class="literal">path: <span class="emphasis"><em>&lt;path_and_expressions&gt;</em></span></code></span></dt><dd>
									Defines the persistent path of a device. You can set it as a fixed path or an expression. Its value can contain modifiers and wildcards. The example applies the settings to devices that match PCI ID <code class="literal">0000:00:0[1-3].0</code>, but not <code class="literal">0000:00:02.0</code>.
								</dd><dt><span class="term"><code class="literal">dhcp4: yes</code></span></dt><dd>
									Enables automatic IPv4 address assignment from DHCP, PPP, or similar services.
								</dd><dt><span class="term"><code class="literal">auto6: yes</code></span></dt><dd>
									Enables IPv6 auto-configuration. By default, NetworkManager uses Router Advertisements. If the router announces the <code class="literal">managed</code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Query the Ansible facts of the managed node and verify that the interface received IP addresses and DNS settings:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.setup</strong></span>
...
        "ansible_default_ipv4": {
            "address": "192.0.2.1",
            "alias": "enp1s0",
            "broadcast": "192.0.2.255",
            "gateway": "192.0.2.254",
            "interface": "enp1s0",
            "macaddress": "52:54:00:17:b8:b6",
            "mtu": 1500,
            "netmask": "255.255.255.0",
            "network": "192.0.2.0",
            "prefix": "24",
            "type": "ether"
        },
        "ansible_default_ipv6": {
            "address": "2001:db8:1::1",
            "gateway": "2001:db8:1::fffe",
            "interface": "enp1s0",
            "macaddress": "52:54:00:17:b8:b6",
            "mtu": 1500,
            "prefix": "64",
            "scope": "global",
            "type": "ether"
        },
        ...
        "ansible_dns": {
            "nameservers": [
                "192.0.2.1",
                "2001:db8:1::ffbb"
            ],
            "search": [
                "example.com"
            ]
        },
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="configuring-vlan-tagging-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.5. Configuring VLAN tagging by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				If your network uses Virtual Local Area Networks (VLANs) to separate network traffic into logical networks, create a NetworkManager connection profile to configure VLAN tagging. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure VLAN tagging and, if a connection profile for the VLAN’s parent device does not exists, the role can create it as well.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If the VLAN device requires an IP address, default gateway, and DNS settings, configure them on the VLAN device and not on the parent device.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: VLAN connection profile with Ethernet port
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          # Ethernet profile
          - name: enp1s0
            type: ethernet
            interface_name: enp1s0
            autoconnect: yes
            state: up
            ip:
              dhcp4: no
              auto6: no

          # VLAN profile
          - name: enp1s0.10
            type: vlan
            vlan:
              id: 10
            ip:
              dhcp4: yes
              auto6: yes
            parent: enp1s0
            state: up</pre><p class="simpara">
						e settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">type: <span class="emphasis"><em>&lt;profile_type&gt;</em></span></code></span></dt><dd>
									Sets the type of the profile to create. The example playbook creates two connection profiles: One for the parent Ethernet device and one for the VLAN device.
								</dd><dt><span class="term"><code class="literal">dhcp4: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									If set to <code class="literal">yes</code>, automatic IPv4 address assignment from DHCP, PPP, or similar services is enabled. Disable the IP address configuration on the parent device.
								</dd><dt><span class="term"><code class="literal">auto6: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									If set to <code class="literal">yes</code>, IPv6 auto-configuration is enabled. In this case, by default, NetworkManager uses Router Advertisements and, if the router announces the <code class="literal">managed</code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server. Disable the IP address configuration on the parent device.
								</dd><dt><span class="term"><code class="literal">parent: <span class="emphasis"><em>&lt;parent_device&gt;</em></span></code></span></dt><dd>
									Sets the parent device of the VLAN connection profile. In the example, the parent is the Ethernet interface.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify the VLAN settings:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ip -d addr show enp1s0.10'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
4: vlan10@enp1s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether 52:54:00:72:2f:6e brd ff:ff:ff:ff:ff:ff promiscuity 0
    vlan protocol 802.1Q id 10 &lt;REORDER_HDR&gt; numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535
    ...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="configuring-a-network-bridge-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.6. Configuring a network bridge by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can connect multiple networks on layer 2 of the Open Systems Interconnection (OSI) model by creating a network bridge. To configure a bridge, create a connection profile in NetworkManager. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure a bridge and, if a connection profile for the bridge’s parent device does not exists, the role can create it as well.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you want to assign IP addresses, gateways, and DNS settings to a bridge, configure them on the bridge and not on its ports.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						Two or more physical or virtual network devices are installed on the server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Bridge connection profile with two Ethernet ports
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          # Bridge profile
          - name: bridge0
            type: bridge
            interface_name: bridge0
            ip:
              dhcp4: yes
              auto6: yes
            state: up

          # Port profile for the 1st Ethernet device
          - name: bridge0-port1
            interface_name: enp7s0
            type: ethernet
            controller: bridge0
            port_type: bridge
            state: up

          # Port profile for the 2nd Ethernet device
          - name: bridge0-port2
            interface_name: enp8s0
            type: ethernet
            controller: bridge0
            port_type: bridge
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">type: <span class="emphasis"><em>&lt;profile_type&gt;</em></span></code></span></dt><dd>
									Sets the type of the profile to create. The example playbook creates three connection profiles: One for the bridge and two for the Ethernet devices.
								</dd><dt><span class="term"><code class="literal">dhcp4: yes</code></span></dt><dd>
									Enables automatic IPv4 address assignment from DHCP, PPP, or similar services.
								</dd><dt><span class="term"><code class="literal">auto6: yes</code></span></dt><dd>
									Enables IPv6 auto-configuration. By default, NetworkManager uses Router Advertisements. If the router announces the <code class="literal">managed</code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the link status of Ethernet devices that are ports of a specific bridge:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ip link show master bridge0'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
3: enp7s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bridge0 state UP mode DEFAULT group default qlen 1000
    link/ether 52:54:00:62:61:0e brd ff:ff:ff:ff:ff:ff
4: enp8s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bridge0 state UP mode DEFAULT group default qlen 1000
    link/ether 52:54:00:9e:f1:ce brd ff:ff:ff:ff:ff:ff</pre></li><li class="listitem"><p class="simpara">
						Display the status of Ethernet devices that are ports of any bridge device:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'bridge link show'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
3: enp7s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master bridge0 state forwarding priority 32 cost 100
4: enp8s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master bridge0 state listening priority 32 cost 100</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="proc_configuring-a-network-bond-by-using-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.7. Configuring a network bond by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can combine network interfaces in a bond to provide a logical interface with higher throughput or redundancy. To configure a bond, create a NetworkManager connection profile. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure a network bond and, if a connection profile for the bond’s parent device does not exist, the role can create it as well.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						Two or more physical or virtual network devices are installed on the server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Bond connection profile with two Ethernet ports
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          # Bond profile
          - name: bond0
            type: bond
            interface_name: bond0
            ip:
              dhcp4: yes
              auto6: yes
            bond:
              mode: active-backup
            state: up

          # Port profile for the 1st Ethernet device
          - name: bond0-port1
            interface_name: enp7s0
            type: ethernet
            controller: bond0
            state: up

          # Port profile for the 2nd Ethernet device
          - name: bond0-port2
            interface_name: enp8s0
            type: ethernet
            controller: bond0
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">type: <span class="emphasis"><em>&lt;profile_type&gt;</em></span></code></span></dt><dd>
									Sets the type of the profile to create. The example playbook creates three connection profiles: One for the bond and two for the Ethernet devices.
								</dd><dt><span class="term"><code class="literal">dhcp4: yes</code></span></dt><dd>
									Enables automatic IPv4 address assignment from DHCP, PPP, or similar services.
								</dd><dt><span class="term"><code class="literal">auto6: yes</code></span></dt><dd>
									Enables IPv6 auto-configuration. By default, NetworkManager uses Router Advertisements. If the router announces the <code class="literal">managed</code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server.
								</dd><dt><span class="term"><code class="literal">mode: <span class="emphasis"><em>&lt;bond_mode&gt;</em></span></code></span></dt><dd><p class="simpara">
									Sets the bonding mode. Possible values are:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">balance-rr</code> (default)
										</li><li class="listitem">
											<code class="literal">active-backup</code>
										</li><li class="listitem">
											<code class="literal">balance-xor</code>
										</li><li class="listitem">
											<code class="literal">broadcast</code>
										</li><li class="listitem">
											<code class="literal">802.3ad</code>
										</li><li class="listitem">
											<code class="literal">balance-tlb</code>
										</li><li class="listitem">
											<code class="literal">balance-alb</code>.
										</li></ul></div><p class="simpara">
									Depending on the mode you set, you need to set additional variables in the playbook.
								</p></dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Temporarily remove the network cable from one of the network devices and check if the other device in the bond handling the traffic.
					</p><p class="simpara">
						Note that there is no method to properly test link failure events using software utilities. Tools that deactivate connections, such as <code class="literal">nmcli</code>, show only the bonding driver’s ability to handle port configuration changes and not actual link failure events.
					</p></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="configuring-an-ipoib-connection-by-using-the-network-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.8. Configuring an IPoIB connection by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p>
				You can use IP over InfiniBand (IPoIB) to send IP packets over an InfiniBand interface. To configure IPoIB, create a NetworkManager connection profile. By using Ansible and the <code class="literal">network</code> system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure IPoIB and, if a connection profile for the InfiniBand’s parent device does not exists, the role can create it as well.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						An InfiniBand device named <code class="literal">mlx4_ib0</code> is installed in the managed nodes.
					</li><li class="listitem">
						The managed nodes use NetworkManager to configure the network.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: IPoIB connection profile with static IP address settings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          # InfiniBand connection mlx4_ib0
          - name: mlx4_ib0
            interface_name: mlx4_ib0
            type: infiniband

          # IPoIB device mlx4_ib0.8002 on top of mlx4_ib0
          - name: mlx4_ib0.8002
            type: infiniband
            autoconnect: yes
            infiniband:
              p_key: 0x8002
              transport_mode: datagram
            parent: mlx4_ib0
            ip:
              address:
                - 192.0.2.1/24
                - 2001:db8:1::1/64
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">type: <span class="emphasis"><em>&lt;profile_type&gt;</em></span></code></span></dt><dd>
									Sets the type of the profile to create. The example playbook creates two connection profiles: One for the InfiniBand connection and one for the IPoIB device.
								</dd><dt><span class="term"><code class="literal">parent: <span class="emphasis"><em>&lt;parent_device&gt;</em></span></code></span></dt><dd>
									Sets the parent device of the IPoIB connection profile.
								</dd><dt><span class="term"><code class="literal">p_key: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									Sets the InfiniBand partition key. If you set this variable, do not set <code class="literal">interface_name</code> on the IPoIB device.
								</dd><dt><span class="term"><code class="literal">transport_mode: <span class="emphasis"><em>&lt;mode&gt;</em></span></code></span></dt><dd>
									Sets the IPoIB connection operation mode. You can set this variable to <code class="literal">datagram</code> (default) or <code class="literal">connected</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the IP settings of the <code class="literal">mlx4_ib0.8002</code> device:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ip address show mlx4_ib0.8002'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
...
inet <span class="emphasis"><em>192.0.2.1/24 brd 192.0.2.255</em></span> scope global noprefixroute ib0.8002
   valid_lft forever preferred_lft forever
inet6 <span class="emphasis"><em>2001:db8:1::1/64</em></span> scope link tentative noprefixroute
   valid_lft forever preferred_lft forever</pre></li><li class="listitem"><p class="simpara">
						Display the partition key (P_Key) of the <code class="literal">mlx4_ib0.8002</code> device:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'cat /sys/class/net/mlx4_ib0.8002/pkey'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
0x8002</pre></li><li class="listitem"><p class="simpara">
						Display the mode of the <code class="literal">mlx4_ib0.8002</code> device:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'cat /sys/class/net/mlx4_ib0.8002/mode'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
datagram</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="proc_routing-traffic-from-a-specific-subnet-to-a-different-default-gateway-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.9. Routing traffic from a specific subnet to a different default gateway by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p>
				You can use policy-based routing to configure a different default gateway for traffic from certain subnets. For example, you can configure RHEL as a router that, by default, routes all traffic to internet provider A using the default route. However, traffic received from the internal workstations subnet is routed to provider B. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use the <code class="literal">network</code> RHEL system role to configure the connection profiles, including routing tables and rules.
			</p><p>
				This procedure assumes the following network topology:
			</p><p>
				<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/13d0843cf47a810942ae325682f70d0c/policy-based-routing.png" alt="policy based routing"></span>

			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes uses the <code class="literal">NetworkManager</code> and <code class="literal">firewalld</code> services.
					</li><li class="listitem"><p class="simpara">
						The managed nodes you want to configure has four network interfaces:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">enp7s0</code> interface is connected to the network of provider A. The gateway IP in the provider’s network is <code class="literal">198.51.100.2</code>, and the network uses a <code class="literal">/30</code> network mask.
							</li><li class="listitem">
								The <code class="literal">enp1s0</code> interface is connected to the network of provider B. The gateway IP in the provider’s network is <code class="literal">192.0.2.2</code>, and the network uses a <code class="literal">/30</code> network mask.
							</li><li class="listitem">
								The <code class="literal">enp8s0</code> interface is connected to the <code class="literal">10.0.0.0/24</code> subnet with internal workstations.
							</li><li class="listitem">
								The <code class="literal">enp9s0</code> interface is connected to the <code class="literal">203.0.113.0/24</code> subnet with the company’s servers.
							</li></ul></div></li><li class="listitem">
						Hosts in the internal workstations subnet use <code class="literal">10.0.0.1</code> as the default gateway. In the procedure, you assign this IP address to the <code class="literal">enp8s0</code> network interface of the router.
					</li><li class="listitem">
						Hosts in the server subnet use <code class="literal">203.0.113.1</code> as the default gateway. In the procedure, you assign this IP address to the <code class="literal">enp9s0</code> network interface of the router.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuring policy-based routing
  hosts: managed-node-01.example.com
  tasks:
    - name: Routing traffic from a specific subnet to a different default gateway
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: Provider-A
            interface_name: enp7s0
            type: ethernet
            autoconnect: True
            ip:
              address:
                - 198.51.100.1/30
              gateway4: 198.51.100.2
              dns:
                - 198.51.100.200
            state: up
            zone: external

          - name: Provider-B
            interface_name: enp1s0
            type: ethernet
            autoconnect: True
            ip:
              address:
                - 192.0.2.1/30
              route:
                - network: 0.0.0.0
                  prefix: 0
                  gateway: 192.0.2.2
                  table: 5000
            state: up
            zone: external

          - name: Internal-Workstations
            interface_name: enp8s0
            type: ethernet
            autoconnect: True
            ip:
              address:
                - 10.0.0.1/24
              route:
                - network: 10.0.0.0
                  prefix: 24
                  table: 5000
              routing_rule:
                - priority: 5
                  from: 10.0.0.0/24
                  table: 5000
            state: up
            zone: trusted

          - name: Servers
            interface_name: enp9s0
            type: ethernet
            autoconnect: True
            ip:
              address:
                - 203.0.113.1/24
            state: up
            zone: trusted</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">table: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									Assigns the route from the same list entry as the <code class="literal">table</code> variable to the specified routing table.
								</dd><dt><span class="term"><code class="literal">routing_rule: <span class="emphasis"><em>&lt;list&gt;</em></span></code></span></dt><dd>
									Defines the priority of the specified routing rule and from a connection profile to which routing table the rule is assigned.
								</dd><dt><span class="term"><code class="literal">zone: <span class="emphasis"><em>&lt;zone_name&gt;</em></span></code></span></dt><dd>
									Assigns the network interface from a connection profile to the specified <code class="literal">firewalld</code> zone.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On a RHEL host in the internal workstation subnet:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Install the <code class="literal">traceroute</code> package:
							</p><pre class="literallayout"># <span class="strong strong"><strong>dnf install traceroute</strong></span></pre></li><li class="listitem"><p class="simpara">
								Use the <code class="literal">traceroute</code> utility to display the route to a host on the internet:
							</p><pre class="literallayout"># <span class="strong strong"><strong>traceroute redhat.com</strong></span>
traceroute to redhat.com (209.132.183.105), 30 hops max, 60 byte packets
 1  10.0.0.1 (10.0.0.1)     0.337 ms  0.260 ms  0.223 ms
 2  192.0.2.1 (192.0.2.1)   0.884 ms  1.066 ms  1.248 ms
 ...</pre><p class="simpara">
								The output of the command displays that the router sends packets over <code class="literal">192.0.2.1</code>, which is the network of provider B.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						On a RHEL host in the server subnet:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Install the <code class="literal">traceroute</code> package:
							</p><pre class="literallayout"># <span class="strong strong"><strong>dnf install traceroute</strong></span></pre></li><li class="listitem"><p class="simpara">
								Use the <code class="literal">traceroute</code> utility to display the route to a host on the internet:
							</p><pre class="literallayout"># <span class="strong strong"><strong>traceroute redhat.com</strong></span>
traceroute to redhat.com (209.132.183.105), 30 hops max, 60 byte packets
 1  203.0.113.1 (203.0.113.1)    2.179 ms  2.073 ms  1.944 ms
 2  198.51.100.2 (198.51.100.2)  1.868 ms  1.798 ms  1.549 ms
 ...</pre><p class="simpara">
								The output of the command displays that the router sends packets over <code class="literal">198.51.100.2</code>, which is the network of provider A.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						On the RHEL router that you configured using the RHEL system role:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Display the rule list:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ip rule list</strong></span>
0:      from all lookup local
<span class="strong strong"><strong>5</strong></span>:    <span class="strong strong"><strong>from 10.0.0.0/24 lookup 5000</strong></span>
32766:  from all lookup main
32767:  from all lookup default</pre><p class="simpara">
								By default, RHEL contains rules for the tables <code class="literal">local</code>, <code class="literal">main</code>, and <code class="literal">default</code>.
							</p></li><li class="listitem"><p class="simpara">
								Display the routes in table <code class="literal">5000</code>:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ip route list table 5000</strong></span>
0.0.0.0/0 via 192.0.2.2 dev enp1s0 proto static metric 100
10.0.0.0/24 dev enp8s0 proto static scope link src 192.0.2.1 metric 102</pre></li><li class="listitem"><p class="simpara">
								Display the interfaces and firewall zones:
							</p><pre class="literallayout"># <span class="strong strong"><strong>firewall-cmd --get-active-zones</strong></span>
external
  interfaces: enp1s0 enp7s0
trusted
  interfaces: enp8s0 enp9s0</pre></li><li class="listitem"><p class="simpara">
								Verify that the <code class="literal">external</code> zone has masquerading enabled:
							</p><pre class="literallayout"># <span class="strong strong"><strong>firewall-cmd --info-zone=external</strong></span>
external (active)
  target: default
  icmp-block-inversion: no
  interfaces: enp1s0 enp7s0
  sources:
  services: ssh
  ports:
  protocols:
  <span class="strong strong"><strong>masquerade: yes</strong></span>
  ...</pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="configuring-a-static-ethernet-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.10. Configuring a static Ethernet connection with 802.1X network authentication by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				Network Access Control (NAC) protects a network from unauthorized clients. You can specify the details that are required for the authentication in NetworkManager connection profiles to enable clients to access the network. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use an Ansible playbook to copy a private key, a certificate, and the CA certificate to the client, and then use the <code class="literal">network</code> RHEL system role to configure a connection profile with 802.1X network authentication.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The network supports 802.1X network authentication.
					</li><li class="listitem">
						The managed nodes use NetworkManager.
					</li><li class="listitem"><p class="simpara">
						The following files required for the TLS authentication exist on the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The client key is stored in the <code class="literal">/srv/data/client.key</code> file.
							</li><li class="listitem">
								The client certificate is stored in the <code class="literal">/srv/data/client.crt</code> file.
							</li><li class="listitem">
								The Certificate Authority (CA) certificate is stored in the <code class="literal">/srv/data/ca.crt</code> file.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">pwd: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure an Ethernet connection with 802.1X authentication
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Copy client key for 802.1X authentication
      ansible.builtin.copy:
        src: "/srv/data/client.key"
        dest: "/etc/pki/tls/private/client.key"
        mode: 0600

    - name: Copy client certificate for 802.1X authentication
      ansible.builtin.copy:
        src: "/srv/data/client.crt"
        dest: "/etc/pki/tls/certs/client.crt"

    - name: Copy CA certificate for 802.1X authentication
      ansible.builtin.copy:
        src: "/srv/data/ca.crt"
        dest: "/etc/pki/ca-trust/source/anchors/ca.crt"

    - name: Ethernet connection profile with static IP address settings and 802.1X
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: enp1s0
            type: ethernet
            autoconnect: yes
            ip:
              address:
                - 192.0.2.1/24
                - 2001:db8:1::1/64
              gateway4: 192.0.2.254
              gateway6: 2001:db8:1::fffe
              dns:
                - 192.0.2.200
                - 2001:db8:1::ffbb
              dns_search:
                - example.com
            ieee802_1x:
              identity: <span class="emphasis"><em>&lt;user_name&gt;</em></span>
              eap: tls
              private_key: "/etc/pki/tls/private/client.key"
              private_key_password: "{{ pwd }}"
              client_cert: "/etc/pki/tls/certs/client.crt"
              ca_cert: "/etc/pki/ca-trust/source/anchors/ca.crt"
              domain_suffix_match: example.com
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ieee802_1x</code></span></dt><dd>
									This variable contains the 802.1X-related settings.
								</dd><dt><span class="term"><code class="literal">eap: tls</code></span></dt><dd>
									Configures the profile to use the certificate-based <code class="literal">TLS</code> authentication method for the Extensible Authentication Protocol (EAP).
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Access resources on the network that require network authentication.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section><section class="section" id="proc_configuring-a-wifi-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.11. Configuring a wifi connection with 802.1X network authentication by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				Network Access Control (NAC) protects a network from unauthorized clients. You can specify the details that are required for the authentication in NetworkManager connection profiles to enable clients to access the network. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				You can use an Ansible playbook to copy a private key, a certificate, and the CA certificate to the client, and then use the <code class="literal">network</code> RHEL system role to configure a connection profile with 802.1X network authentication.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The network supports 802.1X network authentication.
					</li><li class="listitem">
						You installed the <code class="literal">wpa_supplicant</code> package on the managed node.
					</li><li class="listitem">
						DHCP is available in the network of the managed node.
					</li><li class="listitem"><p class="simpara">
						The following files required for TLS authentication exist on the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The client key is stored in the <code class="literal">/srv/data/client.key</code> file.
							</li><li class="listitem">
								The client certificate is stored in the <code class="literal">/srv/data/client.crt</code> file.
							</li><li class="listitem">
								The CA certificate is stored in the <code class="literal">/srv/data/ca.crt</code> file.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">pwd: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure a wifi connection with 802.1X authentication
  hosts: managed-node-01.example.com
  tasks:
    - name: Copy client key for 802.1X authentication
      ansible.builtin.copy:
        src: "/srv/data/client.key"
        dest: "/etc/pki/tls/private/client.key"
        mode: 0400

    - name: Copy client certificate for 802.1X authentication
      ansible.builtin.copy:
        src: "/srv/data/client.crt"
        dest: "/etc/pki/tls/certs/client.crt"

    - name: Copy CA certificate for 802.1X authentication
      ansible.builtin.copy:
        src: "/srv/data/ca.crt"
        dest: "/etc/pki/ca-trust/source/anchors/ca.crt"

    - name: Wifi connection profile with dynamic IP address settings and 802.1X
      ansible.builtin.import_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: Wifi connection profile with dynamic IP address settings and 802.1X
            interface_name: wlp1s0
            state: up
            type: wireless
            autoconnect: yes
            ip:
              dhcp4: true
              auto6: true
            wireless:
              ssid: "Example-wifi"
              key_mgmt: "wpa-eap"
            ieee802_1x:
              identity: <span class="emphasis"><em>&lt;user_name&gt;</em></span>
              eap: tls
              private_key: "/etc/pki/tls/client.key"
              private_key_password: "{{ pwd }}"
              private_key_password_flags: none
              client_cert: "/etc/pki/tls/client.pem"
              ca_cert: "/etc/pki/tls/cacert.pem"
              domain_suffix_match: "example.com"</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ieee802_1x</code></span></dt><dd>
									This variable contains the 802.1X-related settings.
								</dd><dt><span class="term"><code class="literal">eap: tls</code></span></dt><dd>
									Configures the profile to use the certificate-based <code class="literal">TLS</code> authentication method for the Extensible Authentication Protocol (EAP).
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles">Ansible vault</a>
					</li></ul></div></section><section class="section" id="proc_setting-the-default-gateway-on-an-existing-connection-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.12. Setting the default gateway on an existing connection by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				A host forwards a network packet to its default gateway if the packet’s destination can neither be reached through the directly-connected networks nor through any of the routes configured on the host. To configure the default gateway of a host, set it in the NetworkManager connection profile of the interface that is connected to the same network as the default gateway. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><p>
				In most situations, administrators set the default gateway when they create a connection. However, you can also set or update the default gateway setting on a previously-created connection.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					You cannot use the <code class="literal">network</code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Ethernet connection profile with static IP address settings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: enp1s0
            type: ethernet
            autoconnect: yes
            ip:
              address:
                - 198.51.100.20/24
                - 2001:db8:1::1/64
              <span class="strong strong"><strong>gateway4: 198.51.100.254</strong></span>
              <span class="strong strong"><strong>gateway6: 2001:db8:1::fffe</strong></span>
              dns:
                - 198.51.100.200
                - 2001:db8:1::ffbb
              dns_search:
                - example.com
            state: up</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Query the Ansible facts of the managed node and verify the active network settings:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.setup</strong></span>
...
        "ansible_default_ipv4": {
	    ...
            "gateway": "198.51.100.254",
            "interface": "enp1s0",
	    ...
        },
        "ansible_default_ipv6": {
	    ...
            "gateway": "2001:db8:1::fffe",
            "interface": "enp1s0",
	    ...
	}
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="proc_configuring-a-static-route-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.13. Configuring a static route by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				A static route ensures that you can send traffic to a destination that cannot be reached through the default gateway. You configure static routes in the NetworkManager connection profile of the interface that is connected to the same network as the next hop. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					You cannot use the <code class="literal">network</code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Ethernet connection profile with static IP address settings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: enp7s0
            type: ethernet
            autoconnect: yes
            ip:
              address:
                - 192.0.2.1/24
                - 2001:db8:1::1/64
              gateway4: 192.0.2.254
              gateway6: 2001:db8:1::fffe
              dns:
                - 192.0.2.200
                - 2001:db8:1::ffbb
              dns_search:
                - example.com
              <span class="strong strong"><strong>route:</strong></span>
                <span class="strong strong"><strong>- network: 198.51.100.0</strong></span>
                  <span class="strong strong"><strong>prefix: 24</strong></span>
                  <span class="strong strong"><strong>gateway: 192.0.2.10</strong></span>
                <span class="strong strong"><strong>- network: 2001:db8:2::</strong></span>
                  <span class="strong strong"><strong>prefix: 64</strong></span>
                  <span class="strong strong"><strong>gateway: 2001:db8:1::10</strong></span>
            state: up</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the IPv4 routes:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ip -4 route'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
...
198.51.100.0/24 via 192.0.2.10 dev enp7s0</pre></li><li class="listitem"><p class="simpara">
						Display the IPv6 routes:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ip -6 route'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
...
2001:db8:2::/64 via 2001:db8:1::10 dev enp7s0 metric 1024 pref medium</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="proc_configuring-an-ethtool-offload-feature-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.14. Configuring an <code class="literal">ethtool</code> offload feature by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				Network interface controllers can use the TCP offload engine (TOE) to offload processing certain operations to the network controller. This improves the network throughput. You configure offload features in the connection profile of the network interface. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					You cannot use the <code class="literal">network</code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Ethernet connection profile with dynamic IP address settings and offload features
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: enp1s0
            type: ethernet
            autoconnect: yes
            ip:
              dhcp4: yes
              auto6: yes
            <span class="strong strong"><strong>ethtool:</strong></span>
              <span class="strong strong"><strong>features:</strong></span>
                <span class="strong strong"><strong>gro: no</strong></span>
                <span class="strong strong"><strong>gso: yes</strong></span>
                <span class="strong strong"><strong>tx_sctp_segmentation: no</strong></span>
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">gro: no</code></span></dt><dd>
									Disables Generic receive offload (GRO).
								</dd><dt><span class="term"><code class="literal">gso: yes</code></span></dt><dd>
									Enables Generic segmentation offload (GSO).
								</dd><dt><span class="term"><code class="literal">tx_sctp_segmentation: no</code></span></dt><dd>
									Disables TX stream control transmission protocol (SCTP) segmentation.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Query the Ansible facts of the managed node and verify the offload settings:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m ansible.builtin.setup</strong></span>
...
        "ansible_enp1s0": {
            "active": true,
            "device": "enp1s0",
	    "features": {
	        ...
		"rx_gro_hw": "off,
	        ...
		"tx_gso_list": "on,
	        ...
		"tx_sctp_segmentation": "off",
		...
            }
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="proc_configuring-an-ethtool-coalesce-settings-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.15. Configuring an <code class="literal">ethtool</code> coalesce settings by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				By using interrupt coalescing, the system collects network packets and generates a single interrupt for multiple packets. This increases the amount of data sent to the kernel with one hardware interrupt, which reduces the interrupt load, and maximizes the throughput. You configure coalesce settings in the connection profile of the network interface. By using Ansible and the <code class="literal">network</code> RHEL role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					You cannot use the <code class="literal">network</code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Ethernet connection profile with dynamic IP address settings and coalesce settings
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: enp1s0
            type: ethernet
            autoconnect: yes
            ip:
              dhcp4: yes
              auto6: yes
            <span class="strong strong"><strong>ethtool:</strong></span>
              <span class="strong strong"><strong>coalesce:</strong></span>
                <span class="strong strong"><strong>rx_frames: 128</strong></span>
                <span class="strong strong"><strong>tx_frames: 128</strong></span>
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">rx_frames: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									Sets the number of RX frames.
								</dd><dt><span class="term"><code class="literal">gso: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									Sets the number of TX frames.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the current offload features of the network device:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ethtool -c enp1s0'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
...
rx-frames:	128
...
tx-frames:	128
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="proc_increasing-the-ring-buffer-size-to-reduce-a-high-packet-drop-rate-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.16. Increasing the ring buffer size to reduce a high packet drop rate by using the <code class="literal">network</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				Increase the size of an Ethernet device’s ring buffers if the packet drop rate causes applications to report a loss of data, timeouts, or other issues.
			</p><p>
				Ring buffers are circular buffers where an overflow overwrites existing data. The network card assigns a transmit (TX) and receive (RX) ring buffer. Receive ring buffers are shared between the device driver and the network interface controller (NIC). Data can move from NIC to the kernel through either hardware interrupts or software interrupts, also called SoftIRQs.
			</p><p>
				The kernel uses the RX ring buffer to store incoming packets until the device driver can process them. The device driver drains the RX ring, typically by using SoftIRQs, which puts the incoming packets into a kernel data structure called an <code class="literal">sk_buff</code> or <code class="literal">skb</code> to begin its journey through the kernel and up to the application that owns the relevant socket.
			</p><p>
				The kernel uses the TX ring buffer to hold outgoing packets which should be sent to the network. These ring buffers reside at the bottom of the stack and are a crucial point at which packet drop can occur, which in turn will adversely affect network performance.
			</p><p>
				You configure ring buffer settings in the NetworkManager connection profiles. By using Ansible and the <code class="literal">network</code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					You cannot use the <code class="literal">network</code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You know the maximum ring buffer sizes that the device supports.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configure the network
  hosts: managed-node-01.example.com
  tasks:
    - name: Ethernet connection profile with dynamic IP address setting and increased ring buffer sizes
      ansible.builtin.include_role:
        name: rhel-system-roles.network
      vars:
        network_connections:
          - name: enp1s0
            type: ethernet
            autoconnect: yes
            ip:
              dhcp4: yes
              auto6: yes
            <span class="strong strong"><strong>ethtool:</strong></span>
              <span class="strong strong"><strong>ring:</strong></span>
                <span class="strong strong"><strong>rx: 4096</strong></span>
                <span class="strong strong"><strong>tx: 4096</strong></span>
            state: up</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">rx: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									Sets the maximum number of received ring buffer entries.
								</dd><dt><span class="term"><code class="literal">tx: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									Sets the maximum number of transmitted ring buffer entries.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the maximum ring buffer sizes:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ethtool -g enp1s0'</strong></span>
managed-node-01.example.com | CHANGED | rc=0 &gt;&gt;
...
Current hardware settings:
RX:             4096
RX Mini:        0
RX Jumbo:       0
TX:             4096</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section><section class="section" id="ref_network-states-for-the-network-rhel-system-roles_assembly_configuring-network-settings-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">20.17. Network states for the <code class="literal">network</code> RHEL system role</h3></div></div></div><p>
				The <code class="literal">network</code> RHEL system role supports state configurations in playbooks to configure the devices. For this, use the <code class="literal">network_state</code> variable followed by the state configurations.
			</p><p>
				Benefits of using the <code class="literal">network_state</code> variable in a playbook:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Using the declarative method with the state configurations, you can configure interfaces, and the NetworkManager creates a profile for these interfaces in the background.
					</li><li class="listitem">
						With the <code class="literal">network_state</code> variable, you can specify the options that you require to change, and all the other options will remain the same as they are. However, with the <code class="literal">network_connections</code> variable, you must specify all settings to change the network connection profile.
					</li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					You can set only Nmstate YAML instructions in <code class="literal">network_state</code>. These instructions differ from the variables you can set in <code class="literal">network_connections</code>.
				</p></div></rh-alert><p>
				For example, to create an Ethernet connection with dynamic IP address settings, use the following <code class="literal">vars</code> block in your playbook:
			</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Playbook with state configurations
							</p>
							 </td><td align="left" valign="top"> <p>
								Regular playbook
							</p>
							 </td></tr><tr><td align="left" valign="top">
<pre class="programlisting language-yaml">vars:
  network_state:
    interfaces:
    - name: enp7s0
      type: ethernet
      state: up
      ipv4:
        enabled: true
        auto-dns: true
        auto-gateway: true
        auto-routes: true
        dhcp: true
      ipv6:
        enabled: true
        auto-dns: true
        auto-gateway: true
        auto-routes: true
        autoconf: true
        dhcp: true</pre>
							 </td><td align="left" valign="top">
<pre class="programlisting language-yaml">vars:
  network_connections:
    - name: enp7s0
      interface_name: enp7s0
      type: ethernet
      autoconnect: yes
      ip:
        dhcp4: yes
        auto6: yes
      state: up</pre>
							 </td></tr></tbody></table></rh-table><p>
				For example, to only change the connection status of dynamic IP address settings that you created as above, use the following <code class="literal">vars</code> block in your playbook:
			</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><tbody><tr><td align="left" valign="top"> <p>
								Playbook with state configurations
							</p>
							 </td><td align="left" valign="top"> <p>
								Regular playbook
							</p>
							 </td></tr><tr><td align="left" valign="top">
<pre class="programlisting language-yaml">vars:
  network_state:
    interfaces:
    - name: enp7s0
      type: ethernet
      state: down</pre>
							 </td><td align="left" valign="top">
<pre class="programlisting language-yaml">vars:
  network_connections:
    - name: enp7s0
      interface_name: enp7s0
      type: ethernet
      autoconnect: yes
      ip:
        dhcp4: yes
        auto6: yes
      state: down</pre>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.network/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/network/</code> directory
					</li></ul></div></section></section><section class="chapter" id="managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 21. Managing containers by using RHEL system roles</h2></div></div></div><p>
			With the <code class="literal">podman</code> RHEL system role, you can manage Podman configuration, containers, and <code class="literal">systemd</code> services that run Podman containers.
		</p><section class="section" id="creating-a-rootless-container-with-bind-mount_managing-containers-by-using-the-podman-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">21.1. Creating a rootless container with bind mount by using the <code class="literal">podman</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">podman</code> RHEL system role to create rootless containers with bind mount by running an Ansible playbook and with that, manage your application configuration.
			</p><p>
				The example Ansible playbook starts two Kubernetes pods: one for a database and another for a web application. The database pod configuration is specified in the playbook, while the web application pod is defined in an external YAML file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The user and group <code class="literal">webapp</code> exist, and must be listed in the <code class="literal">/etc/subuid</code> and <code class="literal">/etc/subgid</code> files on the host.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">- name: Configure Podman
  hosts: managed-node-01.example.com
  tasks:
    - name: Create a web application and a database
      ansible.builtin.include_role:
        name: rhel-system-roles.podman
      vars:
        podman_create_host_directories: true
        podman_firewall:
          - port: 8080-8081/tcp
            state: enabled
          - port: 12340/tcp
            state: enabled
        podman_selinux_ports:
          - ports: 8080-8081
            setype: http_port_t
        podman_kube_specs:
          - state: started
            run_as_user: dbuser
            run_as_group: dbgroup
            kube_file_content:
              apiVersion: v1
              kind: Pod
              metadata:
                name: db
              spec:
                containers:
                  - name: db
                    image:  quay.io/linux-system-roles/mysql:5.6
                    ports:
                      - containerPort: 1234
                        hostPort: 12340
                    volumeMounts:
                      - mountPath: /var/lib/db:Z
                        name: db
                volumes:
                  - name: db
                    hostPath:
                      path: /var/lib/db
          - state: started
            run_as_user: webapp
            run_as_group: webapp
            kube_file_src: /path/to/webapp.yml</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">run_as_user</code> and <code class="literal">run_as_group</code></span></dt><dd>
									Specify that containers are rootless.
								</dd><dt><span class="term"><code class="literal">kube_file_content</code></span></dt><dd><p class="simpara">
									Contains a Kubernetes YAML file defining the first container named <code class="literal">db</code>. You can generate the Kubernetes YAML file by using the <code class="literal">podman kube generate</code> command.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											The <code class="literal">db</code> container is based on the <code class="literal">quay.io/db/db:stable</code> container image.
										</li><li class="listitem">
											The <code class="literal">db</code> bind mount maps the <code class="literal">/var/lib/db</code> directory on the host to the <code class="literal">/var/lib/db</code> directory in the container. The <code class="literal">Z</code> flag labels the content with a private unshared label, therefore, only the <code class="literal">db</code> container can access the content.
										</li></ul></div></dd><dt><span class="term"><code class="literal">kube_file_src: <span class="emphasis"><em>&lt;path&gt;</em></span></code></span></dt><dd>
									Defines the second container. The content of the <code class="literal">/path/to/webapp.yml</code> file on the controller node will be copied to the <code class="literal">kube_file</code> field on the managed node.
								</dd><dt><span class="term"><code class="literal">volumes: <span class="emphasis"><em>&lt;list&gt;</em></span></code></span></dt><dd>
									A YAML list to define the source of the data to provide in one or more containers. For example, a local disk on the host (<code class="literal">hostPath</code>) or other disk device.
								</dd><dt><span class="term"><code class="literal">volumeMounts: <span class="emphasis"><em>&lt;list&gt;</em></span></code></span></dt><dd>
									A YAML list to define the destination where the individual container will mount a given volume.
								</dd><dt><span class="term"><code class="literal">podman_create_host_directories: true</code></span></dt><dd>
									Creates the directory on the host. This instructs the role to check the kube specification for <code class="literal">hostPath</code> volumes and create those directories on the host. If you need more control over the ownership and permissions, use <code class="literal">podman_host_directories</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.podman/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.podman/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/podman/</code> directory
					</li></ul></div></section><section class="section" id="creating-a-rootful-container-with-podman-volume_managing-containers-by-using-the-podman-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">21.2. Creating a rootful container with Podman volume by using the <code class="literal">podman</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">podman</code> RHEL system role to create a rootful container with a Podman volume by running an Ansible playbook and with that, manage your application configuration.
			</p><p>
				The example Ansible playbook deploys a Kubernetes pod named <code class="literal">ubi8-httpd</code> running an HTTP server container from the <code class="literal">registry.access.redhat.com/ubi8/httpd-24</code> image. The container’s web content is mounted from a persistent volume named <code class="literal">ubi8-html-volume</code>. By default, the <code class="literal">podman</code> role creates rootful containers.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">- name: Configure Podman
  hosts: managed-node-01.example.com
  tasks:
    - name: Start Apache server on port 8080
      ansible.builtin.include_role:
        name: rhel-system-roles.podman
  vars:
    podman_firewall:
      - port: 8080/tcp
        state: enabled
    podman_kube_specs:
      - state: started
        kube_file_content:
          apiVersion: v1
          kind: Pod
          metadata:
            name: ubi8-httpd
          spec:
            containers:
              - name: ubi8-httpd
                image: registry.access.redhat.com/ubi8/httpd-24
                ports:
                  - containerPort: 8080
                    hostPort: 8080
                volumeMounts:
                  - mountPath: /var/www/html:Z
                    name: ubi8-html
            volumes:
              - name: ubi8-html
                persistentVolumeClaim:
                  claimName: ubi8-html-volume</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">kube_file_content</code></span></dt><dd><p class="simpara">
									Contains a Kubernetes YAML file defining the first container named <code class="literal">db</code>. You can generate the Kubernetes YAML file by using the <code class="literal">podman kube generate</code> command.
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											The <code class="literal">ubi8-httpd</code> container is based on the <code class="literal">registry.access.redhat.com/ubi8/httpd-24</code> container image.
										</li><li class="listitem">
											The <code class="literal">ubi8-html-volume</code> maps the <code class="literal">/var/www/html</code> directory on the host to the container. The <code class="literal">Z</code> flag labels the content with a private unshared label, therefore, only the <code class="literal">ubi8-httpd</code> container can access the content.
										</li><li class="listitem">
											The pod mounts the existing persistent volume named <code class="literal">ubi8-html-volume</code> with the mount path <code class="literal">/var/www/html</code>.
										</li></ul></div></dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.podman/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.podman/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/podman/</code> directory
					</li></ul></div></section><section class="section" id="creating-a-quadlet-application-with-secrets_managing-containers-by-using-the-podman-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">21.3. Creating a Quadlet application with secrets by using the <code class="literal">podman</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">podman</code> RHEL system role to create a Quadlet application with secrets by running an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The certificate and the corresponding private key that the web server in the container should use are stored in the <code class="literal">~/certificate.pem</code> and <code class="literal">~/key.pem</code> files.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the contents of the certificate and private key files:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cat ~/certificate.pem</strong></span>
-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----

$ <span class="strong strong"><strong>cat ~/key.pem</strong></span>
-----BEGIN PRIVATE KEY-----
...
-----END PRIVATE KEY-----</pre><p class="simpara">
						You require this information in a later step.
					</p></li><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">root_password: <span class="emphasis"><em>&lt;root_password&gt;</em></span>
certificate: |-
  -----BEGIN CERTIFICATE-----
  ...
  -----END CERTIFICATE-----
key: |-
  -----BEGIN PRIVATE KEY-----
  ...
  -----END PRIVATE KEY-----</pre><p class="simpara">
								Ensure that all lines in the <code class="literal">certificate</code> and <code class="literal">key</code> variables start with two spaces.
							</p></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">- name: Deploy a wordpress CMS with MySQL database
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
  - name: Create and run the container
    ansible.builtin.include_role:
      name: rhel-system-roles.podman
    vars:
      podman_create_host_directories: true
      podman_activate_systemd_unit: false
      podman_quadlet_specs:
        - name: quadlet-demo
          type: network
          file_content: |
            [Network]
            Subnet=192.168.30.0/24
            Gateway=192.168.30.1
            Label=app=wordpress
        - file_src: quadlet-demo-mysql.volume
        - template_src: quadlet-demo-mysql.container.j2
        - file_src: envoy-proxy-configmap.yml
        - file_src: quadlet-demo.yml
        - file_src: quadlet-demo.kube
          activate_systemd_unit: true
      podman_firewall:
        - port: 8000/tcp
          state: enabled
        - port: 9000/tcp
          state: enabled
      podman_secrets:
        - name: mysql-root-password-container
          state: present
          skip_existing: true
          data: "{{ root_password }}"
        - name: mysql-root-password-kube
          state: present
          skip_existing: true
          data: |
            apiVersion: v1
            data:
              password: "{{ root_password | b64encode }}"
            kind: Secret
            metadata:
              name: mysql-root-password-kube
        - name: envoy-certificates
          state: present
          skip_existing: true
          data: |
            apiVersion: v1
            data:
              certificate.key: {{ key | b64encode }}
              certificate.pem: {{ certificate | b64encode }}
            kind: Secret
            metadata:
              name: envoy-certificates</pre><p class="simpara">
						The procedure creates a WordPress content management system paired with a MySQL database. The <code class="literal">podman_quadlet_specs role</code> variable defines a set of configurations for the Quadlet, which refers to a group of containers or services that work together in a certain way. It includes the following specifications:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The Wordpress network is defined by the <code class="literal">quadlet-demo</code> network unit.
							</li><li class="listitem">
								The volume configuration for MySQL container is defined by the <code class="literal">file_src: quadlet-demo-mysql.volume</code> field.
							</li><li class="listitem">
								The <code class="literal">template_src: quadlet-demo-mysql.container.j2</code> field is used to generate a configuration for the MySQL container.
							</li><li class="listitem">
								Two YAML files follow: <code class="literal">file_src: envoy-proxy-configmap.yml</code> and <code class="literal">file_src: quadlet-demo.yml</code>. Note that .yml is not a valid Quadlet unit type, therefore these files will just be copied and not processed as a Quadlet specification.
							</li><li class="listitem">
								The Wordpress and envoy proxy containers and configuration are defined by the <code class="literal">file_src: quadlet-demo.kube</code> field. The kube unit refers to the previous YAML files in the <code class="literal">[Kube]</code> section as <code class="literal">Yaml=quadlet-demo.yml</code> and <code class="literal">ConfigMap=envoy-proxy-configmap.yml</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.podman/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/podman/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 22. Configuring Postfix MTA by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			With the <code class="literal">postfix</code> RHEL system role, you can consistently streamline automated configurations of the Postfix service, a Sendmail-compatible mail transfer agent (MTA) with modular design and a variety of configuration options. The <code class="literal">rhel-system-roles</code> package contains this RHEL system role, and also the reference documentation.
		</p><section class="section" id="using-the-postfix-system-role-to-automate-basic-postfix-mta-administration_configuring-postfix-mta-by-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">22.1. Using the <code class="literal">postfix</code> RHEL system role to automate basic Postfix MTA administration</h3></div></div></div><p>
				You can install, configure and start the Postfix Mail Transfer Agent on the managed nodes by using the <code class="literal">postfix</code> RHEL system role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage postfix
  hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.postfix
  vars:
    postfix_conf:
      relay_domains: $mydestination
        relayhost: example.com</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If you want Postfix to use a different hostname than the fully-qualified domain name (FQDN) that is returned by the <code class="literal">gethostname()</code> function, add the <code class="literal">myhostname</code> parameter under the <code class="literal">postfix_conf:</code> line in the file:
							</p><pre class="screen">myhostname = smtp.example.com</pre></li><li class="listitem"><p class="simpara">
								If the domain name differs from the domain name in the <code class="literal">myhostname</code> parameter, add the <code class="literal">mydomain</code> parameter. Otherwise, the <code class="literal">$myhostname</code> minus the first component is used.
							</p><pre class="screen">mydomain = <span class="emphasis"><em>&lt;example.com&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								Use <code class="literal">postfix_manage_firewall: true</code> variable to ensure that the SMTP port is open in the firewall on the servers.
							</p><p class="simpara">
								Manage the SMTP related ports, <code class="literal">25/tcp</code>, <code class="literal">465/tcp</code>, and <code class="literal">587/tcp</code>. If the variable is set to <code class="literal">false</code>, the <code class="literal">postfix</code> role does not manage the firewall. The default is <code class="literal">false</code>.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									The <code class="literal">postfix_manage_firewall</code> variable is limited to adding ports. It cannot be used for removing ports. If you want to remove ports, use the <code class="literal">firewall</code> RHEL system role directly.
								</p></div></rh-alert></li><li class="listitem"><p class="simpara">
								If your scenario involves using non-standard ports, set the <code class="literal">postfix_manage_selinux: true</code> variable to ensure that the port is properly labeled for SELinux on the servers.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									The <code class="literal">postfix_manage_selinux</code> variable is limited to adding rules to the SELinux policy. It cannot remove rules from the policy. If you want to remove rules, use the <code class="literal">selinux</code> RHEL system role directly.
								</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.postfix/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/postfix/</code> directory
					</li></ul></div></section></section><section class="chapter" id="installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 23. Installing and configuring PostgreSQL by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			As a system administrator, you can use the <code class="literal">postgresql</code> RHEL system role to install, configure, manage, start, and improve performance of the PostgreSQL server.
		</p><section class="section" id="introduction-to-the-postgresql-rhel-system-role_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">23.1. Introduction to the <code class="literal">postgresql</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				To install, configure, manage, and start the PostgreSQL server using Ansible, you can use the <code class="literal">postgresql</code> RHEL system role.
			</p><p>
				You can also use the <code class="literal">postgresql</code> role to optimize the database server settings and improve performance.
			</p><p>
				The role supports the currently released and supported versions of PostgreSQL on RHEL 8 and RHEL 9 managed nodes.
			</p></section><section class="section" id="configuring-the-postgresql-server-by-using-rhel-system-roles_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">23.2. Configuring the PostgreSQL server by using the <code class="literal">postgresql</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">postgresql</code> RHEL system role to install, configure, manage, and start the PostgreSQL server.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">postgresql</code> role replaces PostgreSQL configuration files in the <code class="literal">/var/lib/pgsql/data/</code> directory on the managed hosts. Previous settings are changed to those specified in the role variables, and lost if they are not specified in the role variables.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage PostgreSQL
  hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.postgresql
  vars:
    postgresql_version: "13"</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.postgresql/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/postgresql/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_using_database_servers/using-postgresql_configuring-and-using-database-servers">Using PostgreSQL</a>
					</li></ul></div></section></section><section class="chapter" id="using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 24. Registering the system by using RHEL system roles</h2></div></div></div><p>
			The <code class="literal">rhc</code> RHEL system role enables administrators to automate the registration of multiple systems with Red Hat Subscription Management (RHSM) and Satellite servers. The role also supports Insights-related configuration and management tasks by using Ansible.
		</p><section class="section" id="introduction-to-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.1. Introduction to the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				RHEL system role is a set of roles that provides a consistent configuration interface to remotely manage multiple systems. The remote host configuration (<code class="literal">rhc</code>) RHEL system role enables administrators to easily register RHEL systems to Red Hat Subscription Management (RHSM) and Satellite servers. By default, when you register a system by using the <code class="literal">rhc</code> RHEL system role, the system is connected to Insights. Additionally, with the <code class="literal">rhc</code> RHEL system role, you can:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Configure connections to Red Hat Insights
					</li><li class="listitem">
						Enable and disable repositories
					</li><li class="listitem">
						Configure the proxy to use for the connection
					</li><li class="listitem">
						Configure insights remediations and, auto updates
					</li><li class="listitem">
						Set the release of the system
					</li><li class="listitem">
						Configure insights tags
					</li></ul></div></section><section class="section" id="registering-system-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.2. Registering a system by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				You can register your system to Red Hat by using the <code class="literal">rhc</code> RHEL system role. By default, the <code class="literal">rhc</code> RHEL system role connects the system to Red Hat Insights when you register it.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">activationKey: <span class="emphasis"><em>&lt;activation_key&gt;</em></span>
username: <span class="emphasis"><em>&lt;username&gt;</em></span>
password: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To register by using an activation key and organization ID (recommended), use the following playbook:
							</p><pre class="programlisting language-yaml">---
- name: Registering system using activation key and organization ID
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_auth:
      activation_keys:
        keys:
          -  "{{ activationKey }}"
    rhc_organization: organizationID</pre></li><li class="listitem"><p class="simpara">
								To register by using a username and password, use the following playbook:
							</p><pre class="programlisting language-yaml">---
- name: Registering system with username and password
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  vars:
    rhc_auth:
      login:
        username: "{{ username }}"
        password: "{{ password }}"
  roles:
    - role: rhel-system-roles.rhc</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible Vault</a>
					</li></ul></div></section><section class="section" id="registering-system-with-satellite-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.3. Registering a system with Satellite by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				When organizations use Satellite to manage systems, it is necessary to register the system through Satellite. You can remotely register your system with Satellite by using the <code class="literal">rhc</code> RHEL system role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">activationKey: <span class="emphasis"><em>&lt;activation_key&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Register to the custom registration server and CDN
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_auth:
      login:
        activation_keys:
          keys:
            - "{{ activationKey }}"
        rhc_organization: organizationID
    rhc_server:
      hostname: example.com
        port: 443
        prefix: /rhsm
    rhc_baseurl: http://example.com/pulp/content</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible Vault</a>
					</li></ul></div></section><section class="section" id="configuring-insights-connection-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.4. Disabling the connection to Insights after the registration by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				When you register a system by using the <code class="literal">rhc</code> RHEL system role, the role by default, enables the connection to Red Hat Insights. You can disable it by using the <code class="literal">rhc</code> RHEL system role, if not required.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Disable Insights connection
  hosts: managed-node-01.example.com
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_insights:
      state: absent</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li></ul></div></section><section class="section" id="configuring-repositories-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.5. Enabling repositories by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				You can remotely enable or disable repositories on managed nodes by using the <code class="literal">rhc</code> RHEL system role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You have details of the repositories which you want to enable or disable on the managed nodes.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To enable a repository:
							</p><pre class="programlisting language-yaml">---
- name: Enable repository
  hosts: managed-node-01.example.com
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_repositories:
      - {name: "RepositoryName", state: enabled}</pre></li><li class="listitem"><p class="simpara">
								To disable a repository:
							</p><pre class="programlisting language-yaml">---
- name: Disable repository
  hosts: managed-node-01.example.com
  vars:
    rhc_repositories:
      - {name: "RepositoryName", state: disabled}
  roles:
    - role: rhel-system-roles.rhc</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li></ul></div></section><section class="section" id="setting-release-versions-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.6. Setting release versions by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				You can limit the system to use only repositories for a particular minor RHEL version instead of the latest one. This way, you can lock your system to a specific minor RHEL version.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You know the minor RHEL version to which you want to lock the system. Note that you can only lock the system to the RHEL minor version that the host currently runs or a later minor version.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Set Release
  hosts: managed-node-01.example.com
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_release: "8.6"</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li></ul></div></section><section class="section" id="configuring-proxy-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.7. Using a proxy server when registering the host by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				If your security restrictions allow access to the Internet only through a proxy server, you can specify the proxy’s settings in the playbook when you register the system using the <code class="literal">rhc</code> RHEL system role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">username: <span class="emphasis"><em>&lt;username&gt;</em></span>
password: <span class="emphasis"><em>&lt;password&gt;</em></span>
proxy_username: <span class="emphasis"><em>&lt;proxyusernme&gt;</em></span>
proxy_password: <span class="emphasis"><em>&lt;proxypassword&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								To register to the Red Hat Customer Portal by using a proxy:
							</p><pre class="programlisting language-yaml">---
- name: Register using proxy
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_auth:
      login:
        username: "{{ username }}"
        password: "{{ password }}"
    rhc_proxy:
      hostname: proxy.example.com
      port: 3128
      username: "{{ proxy_username }}"
      password: "{{ proxy_password }}"</pre></li><li class="listitem"><p class="simpara">
								To remove the proxy server from the configuration of the Red Hat Subscription Manager service:
							</p><pre class="programlisting language-yaml">---
- name: To stop using proxy server for registration
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  vars:
    rhc_auth:
      login:
        username: "{{ username }}"
        password: "{{ password }}"
    rhc_proxy: {"state":"absent"}
  roles:
    - role: rhel-system-roles.rhc</pre></li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible Vault</a>
					</li></ul></div></section><section class="section" id="configuring-auto-updates-insights-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.8. Disabling auto updates of Insights rules by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				You can disable the automatic collection rule updates for Red Hat Insights by using the <code class="literal">rhc</code> RHEL system role. By default, when you connect your system to Red Hat Insights, this option is enabled. You can disable it by using the <code class="literal">rhc</code> RHEL system role.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you disable this feature, you risk using outdated rule definition files and not getting the most recent validation updates.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">username: <span class="emphasis"><em>&lt;username&gt;</em></span>
password: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Disable Red Hat Insights autoupdates
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_auth:
      login:
        username: "{{ username }}"
        password: "{{ password }}"
    rhc_insights:
      autoupdate: false
      state: present</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible Vault</a>
					</li></ul></div></section><section class="section" id="configuring-insights-remediations-using-rhel-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.9. Disabling Insights remediations by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				You can configure systems to automatically update the dynamic configuration by using the <code class="literal">rhc</code> RHEL system role. When you connect your system to Red hat Insights, it is enabled by default. You can disable it, if not required.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Enabling remediation with the <code class="literal">rhc</code> RHEL system role ensures your system is ready to be remediated when connected directly to Red Hat. For systems connected to a Satellite, or Capsule, enabling remediation must be achieved differently. For more information about Red Hat Insights remediations, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/red_hat_insights_remediations_guide/index">Red Hat Insights Remediations Guide</a>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						You have Insights remediations enabled.
					</li><li class="listitem">
						You have registered the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Disable remediation
  hosts: managed-node-01.example.com
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_insights:
      remediation: absent
      state: present</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li></ul></div></section><section class="section" id="configuring-insights-tags-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.10. Configuring Insights tags by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				You can use tags for system filtering and grouping. You can also customize tags based on the requirements.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">username: <span class="emphasis"><em>&lt;username&gt;</em></span>
password: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Creating tags
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_auth:
      login:
        username: "{{ username }}"
        password: "{{ password }}"
    rhc_insights:
      tags:
        group: group-name-value
        location: location-name-value
        description:
          - RHEL8
          - SAP
        sample_key:value
      state: present</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible Vault</a>
					</li></ul></div></section><section class="section" id="unregistering-a-system-using-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system"><div class="titlepage"><div><div><h3 class="title">24.11. Unregistering a system by using the <code class="literal">rhc</code> RHEL system role</h3></div></div></div><p>
				You can unregister the system from Red Hat if you no longer need the subscription service.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The system is already registered.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Unregister the system
  hosts: managed-node-01.example.com
  roles:
    - role: rhel-system-roles.rhc
  vars:
    rhc_state: absent</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/rhc/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 25. Configuring SELinux by using RHEL system roles</h2></div></div></div><p>
			You can configure and manage SELinux permissions on other systems by using the <code class="literal">selinux</code> RHEL system role.
		</p><section class="section" id="introduction-to-the-selinux-system-role_configuring-selinux-using-system-roles"><div class="titlepage"><div><div><h3 class="title">25.1. Introduction to the <code class="literal">selinux</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				RHEL system roles is a collection of Ansible roles and modules that provide a consistent configuration interface to remotely manage multiple RHEL systems. You can perform the following actions by using the <code class="literal">selinux</code> RHEL system role:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Cleaning local policy modifications related to SELinux booleans, file contexts, ports, and logins.
					</li><li class="listitem">
						Setting SELinux policy booleans, file contexts, ports, and logins.
					</li><li class="listitem">
						Restoring file contexts on specified files or directories.
					</li><li class="listitem">
						Managing SELinux modules.
					</li></ul></div><p>
				The <code class="literal">/usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml</code> example playbook installed by the <code class="literal">rhel-system-roles</code> package demonstrates how to set the targeted policy in enforcing mode. The playbook also applies several local policy modifications and restores file contexts in the <code class="literal">/tmp/test_dir/</code> directory.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/selinux/</code> directory
					</li></ul></div></section><section class="section" id="using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_configuring-selinux-using-system-roles"><div class="titlepage"><div><div><h3 class="title">25.2. Using the <code class="literal">selinux</code> RHEL system role to apply SELinux settings on multiple systems</h3></div></div></div><p>
				With the <code class="literal">selinux</code> RHEL system role, you can prepare and apply an Ansible playbook with your verified SELinux settings.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Prepare your playbook. You can either start from scratch or modify the example playbook installed as a part of the <code class="literal">rhel-system-roles</code> package:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml <span class="emphasis"><em>&lt;my-selinux-playbook.yml&gt;</em></span></strong></span>
# <span class="strong strong"><strong>vi <span class="emphasis"><em>&lt;my-selinux-playbook.yml&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Change the content of the playbook to fit your scenario. For example, the following part ensures that the system installs and enables the <code class="literal">selinux-local-1.pp</code> SELinux module:
					</p><pre class="screen">selinux_modules:
- { path: "selinux-local-1.pp", priority: "400" }</pre></li><li class="listitem">
						Save the changes, and exit the text editor.
					</li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>&lt;my-selinux-playbook.yml&gt;</em></span> --syntax-check</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run your playbook:
					</p><pre class="screen">$ <span class="strong strong"><strong>ansible-playbook <span class="emphasis"><em>&lt;my-selinux-playbook.yml&gt;</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/selinux/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/articles/7047896">SELinux hardening with Ansible</a> Knowledgebase article
					</li></ul></div></section><section class="section" id="managing-ports-by-using-the-selinux-rhel-system-role_configuring-selinux-using-system-roles"><div class="titlepage"><div><div><h3 class="title">25.3. Managing ports by using the <code class="literal">selinux</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can automate managing port access in SELinux consistently across multiple systems by using the <code class="literal">selinux</code> RHEL system role. This might be useful, for example, when configuring an Apache HTTP server to listen on a different port. You can do this by creating a playbook with the <code class="literal">selinux</code> RHEL system role that assigns the <code class="literal">http_port_t</code> SELinux type to a specific port number. After you run the playbook on the managed nodes, specific services defined in the SELinux policy can access this port.
			</p><p>
				You can automate managing port access in SELinux either by using the <code class="literal">seport</code> module, which is quicker than using the entire role, or by using the <code class="literal">selinux</code> RHEL system role, which is more useful when you also make other changes in SELinux configuration. The methods are equivalent, in fact the <code class="literal">selinux</code> RHEL system role uses the <code class="literal">seport</code> module when configuring ports. Each of the methods has the same effect as entering the command <code class="literal">semanage port -a -t http_port_t -p tcp <span class="emphasis"><em>&lt;port_number&gt;</em></span></code> on the managed node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						Optional: To verify port status by using the <code class="literal">semanage</code> command, the <code class="literal">policycoreutils-python-utils</code> package must be installed.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To configure just the port number without making other changes, use the <code class="literal">seport</code> module:
					</p><pre class="programlisting language-yaml">- name: Allow Apache to listen on tcp port <span class="emphasis"><em>&lt;port_number&gt;</em></span>
  community.general.seport:
    ports: <span class="emphasis"><em>&lt;port_number&gt;</em></span>
    proto: tcp
    setype: http_port_t
    state: present</pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;port_number&gt;</em></span></code> with the port number to which you want to assign the <code class="literal">http_port_t</code> type.
					</p></li><li class="listitem"><p class="simpara">
						For more complex configuration of the managed nodes that involves other customizations of SELinux, use the <code class="literal">selinux</code> RHEL system role. Create a playbook file, for example, <code class="literal">~/playbook.yml</code>, and add the following content:
					</p><pre class="programlisting language-yaml">---
- name: Modify SELinux port mapping example
  hosts: all
  vars:
    # Map tcp port <span class="emphasis"><em>&lt;port_number&gt;</em></span> to the 'http_port_t' SELinux port type
    selinux_ports:
      - ports: <span class="emphasis"><em>&lt;port_number&gt;</em></span>
        proto: tcp
        setype: http_port_t
        state: present

  tasks:
    - name: Include selinux role
      ansible.builtin.include_role:
        name: rhel-system-roles.selinux</pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;port_number&gt;</em></span></code> with the port number to which you want to assign the <code class="literal">http_port_t</code> type.
					</p></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the port is assigned to the <code class="literal">http_port_t</code> type:
					</p><pre class="screen"># <span class="strong strong"><strong>semanage port --list | grep http_port_t</strong></span>
http_port_t                	tcp  	<span class="emphasis"><em>&lt;port_number&gt;</em></span>, 80, 81, 443, 488, 8008, 8009, 8443, 9000</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/selinux/</code> directory
					</li></ul></div></section></section><section class="chapter" id="restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 26. Restricting the execution of applications by using the <code class="literal">fapolicyd</code> RHEL system role</h2></div></div></div><p>
			By using the <code class="literal">fapolicyd</code> software framework, you can restrict the execution of applications based on a user-defined policy and the framework verifies the integrity of applications before execution. This an efficient method to prevent running untrustworthy and possibly malicious applications. You can automate the installation and configuration of <code class="literal">fapolicyd</code> by using the <code class="literal">fapolicyd</code> RHEL system role.
		</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
				The <code class="literal">fapolicyd</code> service prevents only the execution of unauthorized applications that run as regular users, and not as <code class="literal">root</code>.
			</p></div></rh-alert><section class="section" id="preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">26.1. Preventing users from executing untrustworthy code by using the <code class="literal">fapolicyd</code> RHEL system role</h3></div></div></div><p>
				You can automate the installation and configuration of the <code class="literal">fapolicyd</code> service by using the <code class="literal">fapolicyd</code> RHEL system role. With this role, you can remotely configure the service to allow users to execute only trusted applications, for example, the ones which are listed in the RPM database and in an allow list. Additionally, the service can perform integrity checks before it executes an allowed application.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Configuring fapolicyd
  hosts: managed-node-01.example.com
  tasks:
    - name: Allow only executables installed from RPM database and specific files
      ansible.builtin.include_role:
        name: rhel-system-roles.fapolicyd
      vars:
        fapolicyd_setup_permissive: false
        fapolicyd_setup_integrity: sha256
        fapolicyd_setup_trust: rpmdb,file
        fapolicyd_add_trusted_file:
          - <span class="emphasis"><em>&lt;path_to_allowed_command&gt;</em></span>
          - <span class="emphasis"><em>&lt;path_to_allowed_service&gt;</em></span></pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">fapolicyd_setup_permissive: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code> </span></dt><dd>
									Enables or disables sending policy decisions to the kernel for enforcement. Set this variable for debugging and testing purposes to <code class="literal">false</code>.
								</dd><dt><span class="term"><code class="literal">fapolicyd_setup_integrity: <span class="emphasis"><em>&lt;type_type&gt;</em></span></code></span></dt><dd><p class="simpara">
									Defines the integrity checking method. You can set one of the following values:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											<code class="literal">none</code> (default): Disables integrity checking.
										</li><li class="listitem">
											<code class="literal">size</code>: The service compares only the file sizes of allowed applications.
										</li><li class="listitem">
											<code class="literal">ima</code>: The service checks the SHA-256 hash that the kernel’s Integrity Measurement Architecture (IMA) stored in a file’s extended attribute. Additionally, the service performs a size check. Note that the role does not configure the IMA kernel subsystem. To use this option, you must manually configure the IMA subsystem.
										</li><li class="listitem">
											<code class="literal">sha256</code>: The service compares the SHA-256 hash of allowed applications.
										</li></ul></div></dd><dt><span class="term"><code class="literal">fapolicyd_setup_trust: <span class="emphasis"><em>&lt;trust_backends&gt;</em></span></code> </span></dt><dd>
									Defines the list of trust backends. If you include the <code class="literal">file</code> backend, specify the allowed executable files in the <code class="literal">fapolicyd_add_trusted_file</code> list.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.fapolicyd.README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml --syntax-check</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Execute a binary application that is not on the allow list as a user:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'su -c "/bin/not_authorized_application " <span class="emphasis"><em>&lt;user_name&gt;</em></span>'</strong></span>
bash: line 1: /bin/not_authorized_application: Operation not permitted non-zero return code</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.fapolicyd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/fapolicyd/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 27. Configuring the OpenSSH server and client by using RHEL system roles</h2></div></div></div><p>
			You can use the <code class="literal">sshd</code> RHEL system role to configure OpenSSH servers and the <code class="literal">ssh</code> RHEL system role to configure OpenSSH clients consistently, in an automated fashion, and on any number of RHEL systems at the same time. Such configurations are necessary for any system where secure remote interaction is needed, for example:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Remote system administration: securely connecting to your machine from another computer using an SSH client.
				</li><li class="listitem">
					Secure file transfers: the Secure File Transfer Protocol (SFTP) provided by OpenSSH enable you to securely transfer files between your local machine and a remote system.
				</li><li class="listitem">
					Automated DevOps pipelines: automating software deployments that require secure connection to remote servers (CI/CD pipelines).
				</li><li class="listitem">
					Tunneling and port forwarding: forwarding a local port to access a web service on a remote server behind a firewall. For example a remote database or a development server.
				</li><li class="listitem">
					Key-based authentication: more secure alternative to password-based logins.
				</li><li class="listitem">
					Certificate-based authentication: centralized trust management and better scalability.
				</li><li class="listitem">
					Enhanced security: disabling root logins, restricting user access, enforcing strong encryption and other such forms of hardening ensures stronger system security.
				</li></ul></div><section class="section" id="sshd-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">27.1. How the <code class="literal">sshd</code> RHEL system role maps settings from a playbook to the configuration file</h3></div></div></div><p class="_abstract _abstract">
				In the <code class="literal">sshd</code> RHEL system role playbook, you can define the parameters for the server SSH configuration file.
			</p><p>
				If you do not specify these settings, the role produces the <code class="literal">sshd_config</code> file that matches the RHEL defaults.
			</p><p>
				In all cases, booleans correctly render as <code class="literal">yes</code> and <code class="literal">no</code> in the final configuration on your managed nodes. You can use lists to define multi-line configuration items. For example:
			</p><pre class="screen">sshd_ListenAddress:
  - 0.0.0.0
  - '::'</pre><p>
				renders as:
			</p><pre class="screen">ListenAddress 0.0.0.0
ListenAddress ::</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/sshd/</code> directory
					</li></ul></div></section><section class="section" id="configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">27.2. Configuring OpenSSH servers by using the <code class="literal">sshd</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">sshd</code> RHEL system role to configure multiple OpenSSH servers. These ensure secure communication environment for remote users by providing namely:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Management of incoming SSH connections from remote clients
					</li><li class="listitem">
						Credentials verification
					</li><li class="listitem">
						Secure data transfer and command execution
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You can use the <code class="literal">sshd</code> RHEL system role alongside with other RHEL system roles that change SSHD configuration, for example the Identity Management RHEL system roles. To prevent the configuration from being overwritten, ensure the <code class="literal">sshd</code> RHEL system role uses namespaces (RHEL 8 and earlier versions) or a drop-in directory (RHEL 9).
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: SSH server configuration
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure sshd to prevent root and password login except from particular subnet
      ansible.builtin.include_role:
        name: rhel-system-roles.sshd
      vars:
        sshd:
          PermitRootLogin: no
          PasswordAuthentication: no
          Match:
            - Condition: "Address 192.0.2.0/24"
              PermitRootLogin: yes
              PasswordAuthentication: yes</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">PasswordAuthentication: yes|no</code></span></dt><dd>
									Controls whether the OpenSSH server (<code class="literal">sshd</code>) accepts authentication from clients that use the username and password combination.
								</dd><dt><span class="term"><code class="literal">Match:</code></span></dt><dd>
									The match block allows the <code class="literal">root</code> user login using password only from the subnet <code class="literal">192.0.2.0/24</code>.
								</dd></dl></div><p class="simpara">
						For details about the role variables and the OpenSSH configuration options used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file and the <code class="literal">sshd_config(5)</code> manual page on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the SSH server:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;ssh_server&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Verify the contents of the <code class="literal">sshd_config</code> file on the SSH server:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cat /etc/ssh/sshd_config.d/00-ansible_system_role.conf</strong></span>
#
# Ansible managed
#
PasswordAuthentication no
PermitRootLogin no
Match Address 192.0.2.0/24
  PasswordAuthentication yes
  PermitRootLogin yes</pre></li><li class="listitem"><p class="simpara">
						Check that you can connect to the server as root from the <code class="literal">192.0.2.0/24</code> subnet:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Determine your IP address:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>hostname -I</strong></span>
192.0.2.1</pre><p class="simpara">
								If the IP address is within the <code class="literal">192.0.2.1</code> - <code class="literal">192.0.2.254</code> range, you can connect to the server.
							</p></li><li class="listitem"><p class="simpara">
								Connect to the server as <code class="literal">root</code>:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh root@<span class="emphasis"><em>&lt;ssh_server&gt;</em></span></strong></span></pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/sshd/</code> directory
					</li></ul></div></section><section class="section" id="proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">27.3. Using the <code class="literal">sshd</code> RHEL system role for non-exclusive configuration</h3></div></div></div><p>
				By default, applying the <code class="literal">sshd</code> RHEL system role overwrites the entire configuration. This may be problematic if you have previously adjusted the configuration, for example, with a different RHEL system role or a playbook. To apply the <code class="literal">sshd</code> RHEL system role for only selected configuration options while keeping other options in place, you can use the non-exclusive configuration.
			</p><p>
				You can apply a non-exclusive configuration:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						In RHEL 8 and earlier by using a configuration snippet.
					</li><li class="listitem">
						In RHEL 9 and later by using files in a drop-in directory. The default configuration file is already placed in the drop-in directory as <code class="literal">/etc/ssh/sshd_config.d/00-ansible_system_role.conf</code>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								For managed nodes that run RHEL 8 or earlier:
							</p><pre class="programlisting language-yaml">---
- name: Non-exclusive sshd configuration
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure SSHD to accept environment variables
      ansible.builtin.include_role:
        name: rhel-system-roles.sshd
      vars:
        sshd_config_namespace: <span class="emphasis"><em>&lt;my-application&gt;</em></span>
        sshd:
          # Environment variables to accept
          AcceptEnv:
            LANG
            LS_COLORS
            EDITOR</pre></li><li class="listitem"><p class="simpara">
								For managed nodes that run RHEL 9 or later:
							</p><pre class="programlisting language-yaml">- name: Non-exclusive sshd configuration
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure sshd to accept environment variables
      ansible.builtin.include_role:
        name: rhel-system-roles.sshd
      vars:
        sshd_config_file: /etc/ssh/sshd_config.d/<span class="emphasis"><em>&lt;42-my-application&gt;</em></span>.conf
        sshd:
          # Environment variables to accept
          AcceptEnv:
            LANG
            LS_COLORS
            EDITOR</pre><p class="simpara">
								The settings specified in the example playbooks include the following:
							</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">sshd_config_namespace: <span class="emphasis"><em>&lt;my-application&gt;</em></span></code></span></dt><dd>
											The role places the configuration that you specify in the playbook to configuration snippets in the existing configuration file under the given namespace. You need to select a different namespace when running the role from different context.
										</dd><dt><span class="term"><code class="literal">sshd_config_file: /etc/ssh/sshd_config.d/<span class="emphasis"><em>&lt;42-my-application&gt;</em></span>.conf</code></span></dt><dd>
											In the <code class="literal">sshd_config_file</code> variable, define the <code class="literal">.conf</code> file into which the <code class="literal">sshd</code> system role writes the configuration options. Use a two-digit prefix, for example <code class="literal"><span class="emphasis"><em>42-</em></span></code> to specify the order in which the configuration files will be applied.
										</dd><dt><span class="term"><code class="literal">AcceptEnv:</code></span></dt><dd><p class="simpara">
											Controls which environment variables the OpenSSH server (<code class="literal">sshd</code>) will accept from a client:
										</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
													<code class="literal">LANG</code>: defines the language and locale settings.
												</li><li class="listitem">
													<code class="literal">LS_COLORS</code>: defines the displaying color scheme for the <code class="literal">ls</code> command in the terminal.
												</li><li class="listitem">
													<code class="literal">EDITOR</code>: specifies the default text editor for the command-line programs that need to open an editor.
												</li></ul></div></dd></dl></div><p class="simpara">
								For details about the role variables and the OpenSSH configuration options used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file and the <code class="literal">sshd_config(5)</code> manual page on the control node.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify the configuration on the SSH server:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								For managed nodes that run RHEL 8 or earlier:
							</p><pre class="literallayout"># <span class="strong strong"><strong>cat /etc/ssh/sshd_config</strong></span>
...
# BEGIN sshd system role managed block: namespace <span class="emphasis"><em>&lt;my-application&gt;</em></span>
Match all
  AcceptEnv LANG LS_COLORS EDITOR
# END sshd system role managed block: namespace <span class="emphasis"><em>&lt;my-application&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								For managed nodes that run RHEL 9 or later:
							</p><pre class="literallayout"># <span class="strong strong"><strong>cat /etc/ssh/sshd_config.d/42-my-application.conf</strong></span>
# Ansible managed
#
AcceptEnv LANG LS_COLORS EDITOR</pre></li></ul></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/sshd/</code> directory
					</li><li class="listitem">
						<code class="literal">sshd_config(5)</code> manual page
					</li></ul></div></section><section class="section" id="proc_overriding-system-wide-crypto-policy-ssh-server-system-roles_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">27.4. Overriding the system-wide cryptographic policy on an SSH server by using the <code class="literal">sshd</code> RHEL system role</h3></div></div></div><p>
				When the default cryptographic settings do not meet certain security or compatibility needs, you may want to override the system-wide cryptographic policy on the OpenSSH server using the <code class="literal">sshd</code> RHEL system role. Especially, in the following notable situations:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Compatibility with older clients: necessity to use weaker-than-default encryption algorithms, key exchange protocols, or ciphers.
					</li><li class="listitem">
						Enforcing stronger security policies: simultaneously, you can disable weaker algorithms. Such a measure could exceed the default system cryptographic policies, especially in the highly secure and regulated environments.
					</li><li class="listitem">
						Performance considerations: the system defaults could enforce stronger algorithms that can be computationally intensive for some systems.
					</li><li class="listitem">
						Customizing for specific security needs: adapting for unique requirements that are not covered by the default cryptographic policies.
					</li></ul></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					It is not possible to override all aspects of the cryptographic policies from the <code class="literal">sshd</code> RHEL system role. For example, SHA1 signatures might be forbidden on a different layer so for a more generic solution, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles">Setting a custom cryptographic policy by using RHEL system roles</a>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">- name: Deploy SSH configuration for OpenSSH server
  hosts: managed-node-01.example.com
  tasks:
    - name: Overriding the system-wide cryptographic policy
      ansible.builtin.include_role:
        name: rhel-system-roles.sshd
      vars:
        sshd_sysconfig: true
        sshd_sysconfig_override_crypto_policy: true
        sshd_KexAlgorithms: ecdh-sha2-nistp521
        sshd_Ciphers: aes256-ctr
        sshd_MACs: hmac-sha2-512-etm@openssh.com
        sshd_HostKeyAlgorithms: rsa-sha2-512,rsa-sha2-256</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">sshd_KexAlgorithms</code></span></dt><dd>
									You can choose key exchange algorithms, for example, <code class="literal">ecdh-sha2-nistp256</code>, <code class="literal">ecdh-sha2-nistp384</code>, <code class="literal">ecdh-sha2-nistp521</code>,<code class="literal">diffie-hellman-group14-sha1</code>, or <code class="literal">diffie-hellman-group-exchange-sha256</code>.
								</dd><dt><span class="term"><code class="literal">sshd_Ciphers</code></span></dt><dd>
									You can choose ciphers, for example, <code class="literal">aes128-ctr</code>, <code class="literal">aes192-ctr</code>, or <code class="literal">aes256-ctr</code>.
								</dd><dt><span class="term"><code class="literal">sshd_MACs</code></span></dt><dd>
									You can choose MACs, for example, <code class="literal">hmac-sha2-256</code>, <code class="literal">hmac-sha2-512</code>, or <code class="literal">hmac-sha1</code>.
								</dd><dt><span class="term"><code class="literal">sshd_HostKeyAlgorithms</code></span></dt><dd>
									You can choose a public key algorithm, for example, <code class="literal">ecdsa-sha2-nistp256</code>, <code class="literal">ecdsa-sha2-nistp384</code>, <code class="literal">ecdsa-sha2-nistp521</code>, or <code class="literal">ssh-rsa</code>.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file on the control node.
					</p><div class="informalexample"><p>
						On RHEL 9 managed nodes, the system role writes the configuration into the <code class="literal">/etc/ssh/sshd_config.d/00-ansible_system_role.conf</code> file, where cryptographic options are applied automatically. You can change the file by using the <code class="literal">sshd_config_file</code> variable. However, to ensure the configuration is effective, use a file name that lexicographically precedes the <code class="literal">/etc/ssh/sshd_config.d/50-redhat.conf</code> file, which includes the configured crypto policies.
					</p><p>
						On RHEL 8 managed nodes, you must enable override by setting the <code class="literal">sshd_sysconfig_override_crypto_policy</code> and <code class="literal">sshd_sysconfig</code> variables to <code class="literal">true</code>.
					</p></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You can verify the success of the procedure by using the verbose SSH connection and check the defined variables in the following output:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh -vvv <span class="emphasis"><em>&lt;ssh_server&gt;</em></span></strong></span>
...
debug2: peer server KEXINIT proposal
debug2: KEX algorithms: ecdh-sha2-nistp521
debug2: host key algorithms: rsa-sha2-512,rsa-sha2-256
debug2: ciphers ctos: aes256-ctr
debug2: ciphers stoc: aes256-ctr
debug2: MACs ctos: hmac-sha2-512-etm@openssh.com
debug2: MACs stoc: hmac-sha2-512-etm@openssh.com
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/sshd/</code> directory
					</li></ul></div></section><section class="section" id="ref_ssh-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">27.5. How the <code class="literal">ssh</code> RHEL system role maps settings from a playbook to the configuration file</h3></div></div></div><p class="_abstract _abstract">
				In the <code class="literal">ssh</code> RHEL system role playbook, you can define the parameters for the client SSH configuration file.
			</p><p>
				If you do not specify these settings, the role produces a global <code class="literal">ssh_config</code> file that matches the RHEL defaults.
			</p><p>
				In all the cases, booleans correctly render as <code class="literal">yes</code> or <code class="literal">no</code> in the final configuration on your managed nodes. You can use lists to define multi-line configuration items. For example:
			</p><pre class="screen">LocalForward:
  - 22 localhost:2222
  - 403 localhost:4003</pre><p>
				renders as:
			</p><pre class="screen">LocalForward 22 localhost:2222
LocalForward 403 localhost:4003</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The configuration options are case sensitive.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ssh/</code> directory
					</li></ul></div></section><section class="section" id="proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">27.6. Configuring OpenSSH clients by using the <code class="literal">ssh</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">ssh</code> RHEL system role to configure multiple OpenSSH clients. These enable the local user to establish a secure connection with the remote OpenSSH server by ensuring namely:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Secure connection initiation
					</li><li class="listitem">
						Credentials provision
					</li><li class="listitem">
						Negotiation with the OpenSSH server on the encryption method used for the secure communication channel
					</li><li class="listitem">
						Ability to send files securely to and from the OpenSSH server
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You can use the <code class="literal">ssh</code> RHEL system role alongside with other system roles that change SSH configuration, for example the Identity Management RHEL system roles. To prevent the configuration from being overwritten, make sure that the <code class="literal">ssh</code> RHEL system role uses a drop-in directory (default in RHEL 8 and later).
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: SSH client configuration
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure ssh clients
      ansible.builtin.include_role:
        name: rhel-system-roles.ssh
      vars:
        ssh_user: root
        ssh:
          Compression: true
          GSSAPIAuthentication: no
          ControlMaster: auto
          ControlPath: ~/.ssh/.cm%C
          Host:
            - Condition: example
              Hostname: server.example.com
              User: user1
        ssh_ForwardX11: no</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ssh_user: root</code></span></dt><dd>
									Configures the <code class="literal">root</code> user’s SSH client preferences on the managed nodes with certain configuration specifics.
								</dd><dt><span class="term"><code class="literal">Compression: true</code></span></dt><dd>
									Compression is enabled.
								</dd><dt><span class="term"><code class="literal">ControlMaster: auto</code></span></dt><dd>
									ControlMaster multiplexing is set to <code class="literal">auto</code>.
								</dd><dt><span class="term"><code class="literal">Host</code></span></dt><dd>
									Creates alias <code class="literal">example</code> for connecting to the <code class="literal">server.example.com</code> host as a user called <code class="literal">user1</code>.
								</dd><dt><span class="term"><code class="literal">ssh_ForwardX11: no</code></span></dt><dd>
									X11 forwarding is disabled.
								</dd></dl></div><p class="simpara">
						For details about the role variables and the OpenSSH configuration options used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md</code> file and the <code class="literal">ssh_config(5)</code> manual page on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the managed node has the correct configuration by displaying the SSH configuration file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>cat ~/root/.ssh/config</strong></span>
# Ansible managed
Compression yes
ControlMaster auto
ControlPath ~/.ssh/.cm%C
ForwardX11 no
GSSAPIAuthentication no
Host example
  Hostname example.com
  User user1</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ssh/</code> directory
					</li><li class="listitem">
						<code class="literal">ssh_config(5)</code> manual page
					</li></ul></div></section></section><section class="chapter" id="managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 28. Managing local storage by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			To manage LVM and local file systems (FS) by using Ansible, you can use the <code class="literal">storage</code> role, which is one of the RHEL system roles available in RHEL 9.
		</p><p>
			Using the <code class="literal">storage</code> role enables you to automate administration of file systems on disks and logical volumes on multiple machines and across all versions of RHEL starting with RHEL 7.7.
		</p><section class="section" id="an-example-ansible-playbook-to-create-an-xfs-file-system_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.1. Creating an XFS file system on a block device by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				The example Ansible playbook applies the <code class="literal">storage</code> role to create an XFS file system on a block device using the default parameters.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal">storage</code> role can create a file system only on an unpartitioned, whole disk or a logical volume (LV). It cannot create the file system on a partition.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.storage
  vars:
    storage_volumes:
      - name: barefs
        type: disk
        disks:
          - sdb
        fs_type: xfs</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The volume name (<code class="literal"><span class="emphasis"><em>barefs</em></span></code> in the example) is currently arbitrary. The <code class="literal">storage</code> role identifies the volume by the disk device listed under the <code class="literal">disks:</code> attribute.
							</li><li class="listitem">
								You can omit the <code class="literal">fs_type: xfs</code> line because XFS is the default file system in RHEL 9.
							</li><li class="listitem"><p class="simpara">
								To create the file system on an LV, provide the LVM setup under the <code class="literal">disks:</code> attribute, including the enclosing volume group. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_logical_volumes/managing-lvm-logical-volumes_configuring-and-managing-logical-volumes#an-example-playbook-to-manage-logical-volumes_managing-lvm-logical-volumes-using-rhel-system-roles">Managing logical volumes by using the storage RHEL system role</a>.
							</p><p class="simpara">
								Do not provide the path to the LV device.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.2. Persistently mounting a file system by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				The example Ansible applies the <code class="literal">storage</code> role to immediately and persistently mount an XFS file system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.storage
  vars:
    storage_volumes:
      - name: barefs
        type: disk
        disks:
          - sdb
        fs_type: xfs
        mount_point: /mnt/data
        mount_user: somebody
        mount_group: somegroup
        mount_mode: 0755</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								This playbook adds the file system to the <code class="literal">/etc/fstab</code> file, and mounts the file system immediately.
							</li><li class="listitem">
								If the file system on the <code class="literal">/dev/sdb</code> device or the mount point directory do not exist, the playbook creates them.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="creating-or-resizing-logical-volume-using-storage-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.3. Creating or resizing a logical volume by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				<span id="an-example-playbook-to-manage-logical-volumes_managing-local-storage-using-rhel-system-roles"><!--Empty--></span>
			</p><p>
				Use the <code class="literal">storage</code> role to perform the following tasks:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						To create an LVM logical volume in a volume group consisting of many disks
					</li><li class="listitem">
						To resize an existing file system on LVM
					</li><li class="listitem">
						To express an LVM volume size in percentage of the pool’s total size
					</li></ul></div><p>
				If the volume group does not exist, the role creates it. If a logical volume exists in the volume group, it is resized if the size does not match what is specified in the playbook.
			</p><p>
				If you are reducing a logical volume, to prevent data loss you must ensure that the file system on that logical volume is not using the space in the logical volume that is being reduced.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  tasks:
    - name: Create logical volume
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_pools:
          - name: myvg
            disks:
              - sda
              - sdb
              - sdc
            volumes:
              - name: mylv
                size: 2G
                fs_type: ext4
                mount_point: /mnt/data</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">size: <span class="emphasis"><em>&lt;size&gt;</em></span></code></span></dt><dd>
									You must specify the size by using units (for example, GiB) or percentage (for example, 60%).
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that specified volume has been created or resized to the requested size:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'lvs myvg'</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="an-example-ansible-playbook-to-enable-online-block-discard_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.4. Enabling online block discard by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				You can mount an XFS file system with the online block discard option to automatically discard unused blocks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  tasks:
    - name: Enable online block discard
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_volumes:
          - name: barefs
            type: disk
            disks:
              - sdb
            fs_type: xfs
            mount_point: /mnt/data
            mount_options: discard</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that online block discard option is enabled:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'findmnt /mnt/data'</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="an-example-playbook-to-create-mount-an-ext4-file-system_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.5. Creating and mounting an Ext4 file system by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				The example Ansible playbook applies the <code class="literal">storage</code> role to create and mount an Ext4 file system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.storage
  vars:
    storage_volumes:
      - name: barefs
        type: disk
        disks:
          - sdb
        fs_type: ext4
        fs_label: label-name
        mount_point: /mnt/data</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The playbook creates the file system on the <code class="literal">/dev/sdb</code> disk.
							</li><li class="listitem">
								The playbook persistently mounts the file system at the <code class="literal">/mnt/data</code> directory.
							</li><li class="listitem">
								The label of the file system is <code class="literal">label-name</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="an-example-ansible-playbook-to-create-mount-ext3-file-system_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.6. Creating and mounting an Ext3 file system by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				The example Ansible playbook applies the <code class="literal">storage</code> role to create and mount an Ext3 file system.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- hosts: all
  roles:
    - rhel-system-roles.storage
  vars:
    storage_volumes:
      - name: barefs
        type: disk
        disks:
          - sdb
        fs_type: ext3
        fs_label: label-name
        mount_point: /mnt/data
        mount_user: somebody
        mount_group: somegroup
        mount_mode: 0755</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The playbook creates the file system on the <code class="literal">/dev/sdb</code> disk.
							</li><li class="listitem">
								The playbook persistently mounts the file system at the <code class="literal">/mnt/data</code> directory.
							</li><li class="listitem">
								The label of the file system is <code class="literal">label-name</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="example-ansible-playbook-to-create-a-swap-partition-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.7. Creating a swap volume by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				This section provides an example Ansible playbook. This playbook applies the <code class="literal">storage</code> role to create a swap volume, if it does not exist, or to modify the swap volume, if it already exist, on a block device by using the default parameters.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Create a disk device with swap
  hosts: managed-node-01.example.com
  roles:
    - rhel-system-roles.storage
  vars:
    storage_volumes:
      - name: swap_fs
        type: disk
        disks:
          - /dev/sdb
        size: 15 GiB
        fs_type: swap</pre><p class="simpara">
						The volume name (<code class="literal"><span class="emphasis"><em>swap_fs</em></span></code> in the example) is currently arbitrary. The <code class="literal">storage</code> role identifies the volume by the disk device listed under the <code class="literal">disks:</code> attribute.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="configuring-a-raid-volume-using-the-storage-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.8. Configuring a RAID volume by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				With the <code class="literal">storage</code> system role, you can configure a RAID volume on RHEL by using Red Hat Ansible Automation Platform and Ansible-Core. Create an Ansible playbook with the parameters to configure a RAID volume to suit your requirements.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Device names might change in certain circumstances, for example, when you add a new disk to a system. Therefore, to prevent data loss, use persistent naming attributes in the playbook. For more information about persistent naming attributes, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_storage_devices/persistent-naming-attributes_managing-storage-devices#persistent-naming-attributes_managing-storage-devices">Persistent naming attributes</a>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  tasks:
    - name: Create a RAID on sdd, sde, sdf, and sdg
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_safe_mode: false
        storage_volumes:
          - name: data
            type: raid
            disks: [sdd, sde, sdf, sdg]
            raid_level: raid0
            raid_chunk_size: 32 KiB
            mount_point: /mnt/data
            state: present</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the array was correctly created:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'mdadm --detail /dev/md/data'</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="configuring-lvm-pool-with-raid-using-storage-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.9. Configuring an LVM pool with RAID by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				With the <code class="literal">storage</code> system role, you can configure an LVM pool with RAID on RHEL by using Red Hat Ansible Automation Platform. You can set up an Ansible playbook with the available parameters to configure an LVM pool with RAID.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure LVM pool with RAID
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_safe_mode: false
        storage_pools:
          - name: my_pool
            type: lvm
            disks: [sdh, sdi]
            raid_level: raid1
            volumes:
              - name: my_volume
                size: "1 GiB"
                mount_point: "/mnt/app/shared"
                fs_type: xfs
                state: present</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that your pool is on RAID:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'lsblk'</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_storage_devices/index#managing-raid_managing-storage-devices">Managing RAID</a>
					</li></ul></div></section><section class="section" id="configuring-a-stripe-size-for-raid-lvm-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.10. Configuring a stripe size for RAID LVM volumes by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				With the <code class="literal">storage</code> system role, you can configure a stripe size for RAID LVM volumes on RHEL by using Red Hat Ansible Automation Platform. You can set up an Ansible playbook with the available parameters to configure an LVM pool with RAID.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure stripe size for RAID LVM volumes
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_safe_mode: false
        storage_pools:
          - name: my_pool
            type: lvm
            disks: [sdh, sdi]
            volumes:
              - name: my_volume
                size: "1 GiB"
                mount_point: "/mnt/app/shared"
                fs_type: xfs
                raid_level: raid0
                raid_stripe_size: "256 KiB"
                state: present</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that stripe size is set to the required size:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'lvs -o+stripesize /dev/my_pool/my_volume'</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux//9/html-single/managing_storage_devices/index#managing-raid_managing-storage-devices">Managing RAID</a>
					</li></ul></div></section><section class="section" id="configuring-an-lvm-vdo-volume-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.11. Configuring an LVM-VDO volume by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				<span id="example-ansible-playbook-to-compress-and-deduplicate-a-vdo-volume-on-lvm-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><!--Empty--></span>
			</p><p>
				You can use the <code class="literal">storage</code> RHEL system role to create a VDO volume on LVM (LVM-VDO) with enabled compression and deduplication.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Because of the <code class="literal">storage</code> system role use of LVM-VDO, only one volume can be created per pool.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  tasks:
    - name: Create LVM-VDO volume under volume group 'myvg'
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_pools:
          - name: myvg
            disks:
              - /dev/sdb
            volumes:
              - name: mylv1
                compression: true
                deduplication: true
                vdo_pool_size: 10 GiB
                size: 30 GiB
                mount_point: /mnt/app/shared</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">vdo_pool_size: <span class="emphasis"><em>&lt;size&gt;</em></span></code></span></dt><dd>
									The actual size that the volume takes on the device. You can specify the size in human-readable format, such as 10 GiB. If you do not specify a unit, it defaults to bytes.
								</dd><dt><span class="term"><code class="literal">size: <span class="emphasis"><em>&lt;size&gt;</em></span></code></span></dt><dd>
									The virtual size of VDO volume.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						View the current status of compression and deduplication:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'lvs -o+vdo_compression,vdo_compression_state,vdo_deduplication,vdo_index_state'</strong></span>
  LV       VG      Attr       LSize   Pool   Origin Data%  Meta%  Move Log Cpy%Sync Convert VDOCompression VDOCompressionState VDODeduplication VDOIndexState
  mylv1   myvg   vwi-a-v---   3.00t vpool0                                                         enabled              online          enabled        online</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="creating-a-luks2-encrypted-volume-using-the-storage-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.12. Creating a LUKS2 encrypted volume by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">storage</code> role to create and configure a volume encrypted with LUKS by running an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">luks_password: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Create and configure a volume encrypted with LUKS
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_volumes:
          - name: barefs
            type: disk
            disks:
              - sdb
            fs_type: xfs
            fs_label: <span class="emphasis"><em>&lt;label&gt;</em></span>
            mount_point: /mnt/data
            encryption: true
            encryption_password: "{{ luks_password }}"</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Find the <code class="literal">luksUUID</code> value of the LUKS encrypted volume:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'cryptsetup luksUUID /dev/sdb'</strong></span>

4e4e7970-1822-470e-b55a-e91efe5d0f5c</pre></li><li class="listitem"><p class="simpara">
						View the encryption status of the volume:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'cryptsetup status luks-4e4e7970-1822-470e-b55a-e91efe5d0f5c'</strong></span>

/dev/mapper/luks-4e4e7970-1822-470e-b55a-e91efe5d0f5c is active and is in use.
  type:    LUKS2
  cipher:  aes-xts-plain64
  keysize: 512 bits
  key location: keyring
  device:  /dev/sdb
...</pre></li><li class="listitem"><p class="simpara">
						Verify the created LUKS encrypted volume:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'cryptsetup luksDump /dev/sdb'</strong></span>

LUKS header information
Version:        2
Epoch:          3
Metadata area:  16384 [bytes]
Keyslots area:  16744448 [bytes]
UUID:           4e4e7970-1822-470e-b55a-e91efe5d0f5c
Label:          (no label)
Subsystem:      (no subsystem)
Flags:          (no flags)

Data segments:
  0: crypt
        offset: 16777216 [bytes]
        length: (whole device)
        cipher: aes-xts-plain64
        sector: 512 [bytes]
...</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_storage_devices/encrypting-block-devices-using-luks_managing-storage-devices">Encrypting block devices by using LUKS</a>
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section><section class="section" id="creating-shared-lvm-devices-using-storage-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.13. Creating shared LVM devices using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">storage</code> RHEL system role to create shared LVM devices if you want your multiple systems to access the same storage at the same time.
			</p><p>
				This can bring the following notable benefits:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Resource sharing
					</li><li class="listitem">
						Flexibility in managing storage resources
					</li><li class="listitem">
						Simplification of storage management tasks
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						<code class="literal">lvmlockd</code> is configured on the managed node. For more information, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/configuring_and_managing_logical_volumes/configuring-lvm-on-shared-storage_configuring-and-managing-logical-volumes#configuring-lvm-on-san-multiple_configuring-lvm-on-shared-storage">Configuring LVM to share SAN disks among multiple machines</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  become: true
  tasks:
    - name: Create shared LVM device
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_pools:
          - name: <span class="emphasis"><em>vg1</em></span>
            disks: <span class="emphasis"><em>/dev/vdb</em></span>
            type: lvm
            <span class="strong strong"><strong>shared: true</strong></span>
            state: present
            volumes:
              - name: <span class="emphasis"><em>lv1</em></span>
                size: 4g
                mount_point: <span class="emphasis"><em>/opt/test1</em></span>
        storage_safe_mode: false
        storage_use_partitions: true</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="resizing-physical-volumes-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.14. Resizing physical volumes by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				With the <code class="literal">storage</code> system role, you can resize LVM physical volumes after resizing the underlying storage or disks from outside of the host. For example, you increased the size of a virtual disk and want to use the extra space in an existing LVM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The size of the underlying block storage has been changed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  tasks:
    - name: Resize LVM PV size
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_pools:
           - name: <span class="emphasis"><em>myvg</em></span>
             disks: <span class="emphasis"><em>["sdf"]</em></span>
             type: lvm
             <span class="strong strong"><strong>grow_to_fill: true</strong></span></pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the new physical volume size:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'pvs'</strong></span>
PV         VG   Fmt Attr PSize PFree
<span class="emphasis"><em>/dev/sdf1</em></span> <span class="emphasis"><em>myvg</em></span> lvm2 a-- 1,99g 1,99g</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li></ul></div></section><section class="section" id="creating-an-encrypted-stratis-pool-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">28.15. Creating an encrypted Stratis pool by using the <code class="literal">storage</code> RHEL system role</h3></div></div></div><p>
				To secure your data, you can create an encrypted Stratis pool with the <code class="literal">storage</code> RHEL system role. In addition to a passphrase, you can use Clevis and Tang or TPM protection as an encryption method.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					You can configure Stratis encryption only on the entire pool.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">luks_password: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Manage local storage
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Create a new encrypted Stratis pool with Clevis and Tang
      ansible.builtin.include_role:
        name: rhel-system-roles.storage
      vars:
        storage_pools:
           - name: mypool
             disks:
               - sdd
               - sde
             <span class="strong strong"><strong>type: stratis</strong></span>
             <span class="strong strong"><strong>encryption: true</strong></span>
             encryption_password: "{{ luks_password }}"
             encryption_clevis_pin: tang
             encryption_tang_url: tang-server.example.com:7500</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">encryption_password</code></span></dt><dd>
									Password or passphrase used to unlock the LUKS volumes.
								</dd><dt><span class="term"><code class="literal">encryption_clevis_pin</code></span></dt><dd>
									Clevis method that you can use to encrypt the created pool. You can use <code class="literal">tang</code> and <code class="literal">tpm2</code>.
								</dd><dt><span class="term"><code class="literal">encryption_tang_url</code></span></dt><dd>
									URL of the Tang server.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the pool was created with Clevis and Tang configured:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'sudo stratis report'</strong></span>
...
                        "clevis_config": {
                            "thp": "j-G4ddvdbVfxpnUbgxlpbe3KutSKmcHttILAtAkMTNA",
                            "url": "tang-server.example.com:7500"
                        },
                        "clevis_pin": "tang",
                        "in_use": true,
                        "key_description": "blivet-mypool",</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.storage/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/storage/</code> directory
					</li><li class="listitem">
						<a class="link" href="#ansible-vault_automating-system-administration-by-using-rhel-system-roles" title="Chapter 3. Ansible vault">Ansible vault</a>
					</li></ul></div></section></section><section class="chapter" id="managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 29. Managing <code class="literal">systemd</code> units by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			By using the <code class="literal">systemd</code> RHEL system role, you can automate certain systemd-related tasks and perform them remotely. You can use the role for the following actions:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Manage services
				</li><li class="listitem">
					Deploy units
				</li><li class="listitem">
					Deploy drop-in files
				</li></ul></div><section class="section" id="managing-services-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">29.1. Managing services by using the systemd RHEL system role</h3></div></div></div><p>
				You can automate and remotely manage systemd units, such as starting or enabling services, by using the <code class="literal">systemd</code> RHEL system role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content. Use only the variables depending on what actions you want to perform.
					</p><pre class="programlisting language-yaml">---
- name: Managing systemd services
  hosts: managed-node-01.example.com
  tasks:
    - name: Perform action on systemd units
      ansible.builtin.include_role:
        name: rhel-system-roles.systemd
      vars:
        systemd_started_units:
          - <span class="emphasis"><em>&lt;systemd_unit_1&gt;</em></span>.service
        systemd_stopped_units:
          - <span class="emphasis"><em>&lt;systemd_unit_2&gt;</em></span>.service
        systemd_restarted_units:
          - <span class="emphasis"><em>&lt;systemd_unit_3&gt;</em></span>.service
        systemd_reloaded_units:
          - <span class="emphasis"><em>&lt;systemd_unit_4&gt;</em></span>.service
        systemd_enabled_units:
          - <span class="emphasis"><em>&lt;systemd_unit_5&gt;</em></span>.service
        systemd_disabled_units:
          - <span class="emphasis"><em>&lt;systemd_unit_6&gt;</em></span>.service
        systemd_masked_units:
          - <span class="emphasis"><em>&lt;systemd_unit_7&gt;</em></span>.service
        systemd_unmasked_units:
          - <span class="emphasis"><em>&lt;systemd_unit_8&gt;</em></span>.service</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/systemd/</code> directory
					</li></ul></div></section><section class="section" id="deploying-systemd-drop-in-files-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">29.2. Deploying systemd drop-in files by using the systemd RHEL system role</h3></div></div></div><p>
				Systemd applies drop-in files on top of setting it reads for a unit from other locations. Therefore, you can modify unit settings with drop-in files without changing the original unit file. By using the <code class="literal">systemd</code> RHEL system role, you can automate the process of deploying drop-in files.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					The role uses the hard-coded file name <code class="literal">99-override.conf</code> to store drop-in files in <code class="literal">/etc/systemd/system/<span class="emphasis"><em>&lt;name&gt;</em></span>._&lt;unit_type&gt;/</code>. Note that it overrides existing files with this name in the destination directory.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a Jinja2 template with the systemd drop-in file contents. For example, create the <code class="literal">~/sshd.service.conf.j2</code> file with the following content:
					</p><pre class="programlisting language-bash">{{ ansible_managed | comment }}
[Unit]
After=
After=network.target sshd-keygen.target network-online.target</pre><p class="simpara">
						This drop-in file specifies the same units in the <code class="literal">After</code> setting as the original <code class="literal">/usr/lib/systemd/system/sshd.service</code> file and, additionally, <code class="literal">network-online.target</code>. With this extra target, <code class="literal">sshd</code> starts after the network interfaces are actived and have IP addresses assigned. This ensures that <code class="literal">sshd</code> can bind to all IP addresses.
					</p><p class="simpara">
						Use the <code class="literal"><span class="emphasis"><em>&lt;name&gt;</em></span>.<span class="emphasis"><em>&lt;unit_type&gt;</em></span>.conf.j2</code> convention for the file name. For example, to add a drop-in for the <code class="literal">sshd.service</code> unit, you must name the file <code class="literal">sshd.service.conf.j2</code>. Place the file in the same directory as the playbook.
					</p></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Managing systemd services
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploy an sshd.service systemd drop-in file
      ansible.builtin.include_role:
        name: rhel-system-roles.systemd
      vars:
         systemd_dropins:
           - sshd.service.conf.j2</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">systemd_dropins: <span class="emphasis"><em>&lt;list_of_files&gt;</em></span></code></span></dt><dd>
									Specifies the names of the drop-in files to deploy in YAML list format.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the role placed the drop-in file in the correct location:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ls /etc/systemd/system/sshd.service.d/'</strong></span>
99-override.conf</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/systemd/</code> directory
					</li></ul></div></section><section class="section" id="deploying-systemd-units-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role"><div class="titlepage"><div><div><h3 class="title">29.3. Deploying systemd units by using the systemd RHEL system role</h3></div></div></div><p>
				You can create unit files for custom applications, and systemd reads them from the <code class="literal">/etc/systemd/system/</code> directory. By using the <code class="literal">systemd</code> RHEL system role, you can automate the deployment of custom unit files.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a Jinja2 template with the custom systemd unit file contents. For example, create the <code class="literal">~/example.service.j2</code> file with the contents for your service:
					</p><pre class="programlisting language-bash">{{ ansible_managed | comment }}
[Unit]
Description=Example systemd service unit file

[Service]
ExecStart=/bin/true</pre><p class="simpara">
						Use the <code class="literal"><span class="emphasis"><em>&lt;name&gt;</em></span>.<span class="emphasis"><em>&lt;unit_type&gt;</em></span>.j2</code> convention for the file name. For example, to create the <code class="literal">example.service</code> unit, you must name the file <code class="literal">example.service.j2</code>. Place the file in the same directory as the playbook.
					</p></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Managing systemd services
  hosts: managed-node-01.example.com
  tasks:
    - name: Deploy, enable, and start a custom systemd service
      ansible.builtin.include_role:
        name: rhel-system-roles.systemd
      vars:
         systemd_unit_file_templates:
           - example.service.j2
         systemd_enabled_units:
           - example.service
         systemd_started_units:
           - example.service</pre><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Verify that the service is enabled and started:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'systemctl status example.service'</strong></span>
...
● example.service - A service for demonstrating purposes
   Loaded: loaded (/etc/systemd/system/example.service; <span class="strong strong"><strong>enabled</strong></span>; vendor preset: disabled)
   Active: <span class="strong strong"><strong>active</strong></span> (running) since Thu 2024-07-04 15:59:18 CEST; 10min ago
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/systemd/</code> directory
					</li></ul></div></section></section><section class="chapter" id="configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 30. Configuring time synchronization by using RHEL system roles</h2></div></div></div><p>
			The Network Time Protocol (NTP) and Precision Time Protocol (PTP) are standards to synchronize the clock of computers over a network. An accurate time synchronization in networks is important because certain services rely on it. For example, Kerberos tolerates only a small time difference between the server and client to prevent replay attacks.
		</p><p>
			You can set the time service to configure in the <code class="literal">timesync_ntp_provider</code> variable of a playbook. If you do not set this variable, the role determines the time service based on the following factors:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					On RHEL 8 and later: <code class="literal">chronyd</code>
				</li><li class="listitem">
					On RHEL 6 and 7: <code class="literal">chronyd</code> (default) or, if already installed <code class="literal">ntpd</code>.
				</li></ul></div><section class="section" id="configuring-time-synchronization-over-ntp-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles"><div class="titlepage"><div><div><h3 class="title">30.1. Configuring time synchronization over NTP by using the timesync RHEL system role</h3></div></div></div><p>
				The Network Time Protocol (NTP) synchronizes the time of a host with an NTP server over a network. In IT networks, services rely on a correct system time, for example, for security and logging purposes. By using the <code class="literal">timesync</code> RHEL system role, you can automate the configuration of Red Hat Enterprise Linux NTP clients in your network and keep the time synchronized.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">timesync</code> RHEL system role replaces the configuration of the specified given or detected provider service on the managed host. Consequently, all settings are lost if they are not specified in the playbook.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Managing time synchronization
  hosts: managed-node-01.example.com
  tasks:
    - name: Configuring NTP with an internal server (preferred) and a public server pool as fallback
      ansible.builtin.include_role:
        name: rhel-system-roles.timesync
      vars:
        timesync_ntp_servers:
        - hostname: time.example.com
          trusted: yes
          prefer: yes
          iburst: yes
        - hostname: 0.rhel.pool.ntp.org
          pool: yes
          iburst: yes</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">pool: <span class="emphasis"><em>&lt;yes|no&gt;</em></span></code></span></dt><dd>
									Flags a source as an NTP pool rather than an individual host. In this case, the service expects that the name resolves to multiple IP addresses which can change over time.
								</dd><dt><span class="term"><code class="literal">iburst: <span class="emphasis"><em>yes</em></span></code></span></dt><dd>
									Enables fast initial synchronization.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.timesync/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display the details about the time sources:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								If the managed node runs the <code class="literal">chronyd</code> service, enter:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'chronyc sources'</strong></span>
MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================
^* time.example.com              1  10   377   210   +159us[  +55us] +/-   12ms
^? ntp.example.org               2   9   377   409  +1120us[+1021us] +/-   42ms
^? time.us.example.net           2   9   377   992   -329us[ -386us] +/-   15ms
...</pre></li><li class="listitem"><p class="simpara">
								If the managed node runs the <code class="literal">ntpd</code> service, enter:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ntpq -p'</strong></span>
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*time.example.com .PTB.           1 u    2   64   77   23.585  967.902   0.684
- ntp.example.or 192.0.2.17       2 u    -   64   77   27.090  966.755   0.468
+time.us.example 198.51.100.19    2 u   65   64   37   18.497  968.463   1.588
...</pre></li></ul></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.time_sync/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/time_sync/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/63376">Are the rhel.pool.ntp.org NTP servers supported by Red Hat?</a> (Red Hat Knowledgebase)
					</li></ul></div></section><section class="section" id="configuring-time-synchronization-over-ntp-with-nts-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles"><div class="titlepage"><div><div><h3 class="title">30.2. Configuring time synchronization over NTP with NTS by using the timesync RHEL system role</h3></div></div></div><p>
				The Network Time Protocol (NTP) synchronizes the time of a host with an NTP server over a network. By using the Network Time Security (NTS) mechanism, clients establish a TLS-encrypted connection to the server and authenticate NTP packets. In IT networks, services rely on a correct system time, for example, for security and logging purposes. By using the <code class="literal">timesync</code> RHEL system role, you can automate the configuration of Red Hat Enterprise Linux NTP clients in your network and keep the time synchronized over NTS.
			</p><p>
				Note that you cannot mix NTS servers with non-NTS servers. In mixed configurations, NTS servers are trusted and clients do not fall back to unauthenticated NTP sources because they can be exploited in man-in-the-middle (MITM) attacks. For further details, see the <code class="literal">authselectmode</code> parameter description in the <code class="literal">chrony.conf(5)</code> man page on your system.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The <code class="literal">timesync</code> RHEL system role replaces the configuration of the specified given or detected provider service on the managed host. Consequently, all settings are lost if they are not specified in the playbook.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed nodes use <code class="literal">chronyd</code>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Managing time synchronization
  hosts: managed-node-01.example.com
  tasks:
    - name: Configuring NTP with NTS-enabled servers
      ansible.builtin.include_role:
        name: rhel-system-roles.timesync
      vars:
        timesync_ntp_servers:
        - hostname: ptbtime1.ptb.de
          nts: yes
          iburst: yes</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">iburst: <span class="emphasis"><em>yes</em></span></code></span></dt><dd>
									Enables fast initial synchronization.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.timesync/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If the managed node runs the <code class="literal">chronyd</code> service:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Display the details about the time sources:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'chronyc sources'</strong></span>
MS Name/IP address         Stratum Poll Reach LastRx Last sample
===============================================================================
^* ptbtime1.ptb.de               1   6    17    55    -13us[  -54us] +/-   12ms
^- ptbtime2.ptb.de               1   6    17    56   -257us[ -297us] +/-   12ms</pre></li><li class="listitem"><p class="simpara">
								For sources with NTS enabled, display information that is specific to authentication of NTP sources:
							</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'chronyc -N authdata'</strong></span>
Name/IP address             Mode KeyID Type KLen Last Atmp  NAK Cook CLen
=========================================================================
ptbtime1.ptb.de              NTS     1   15  256  229    0    0    8  100
ptbtime2.ptb.de              NTS     1   15  256  230    0    0    8  100</pre><p class="simpara">
								Verify that the reported cookies in the <code class="literal">Cook</code> column is larger than 0.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						If the managed node runs the <code class="literal">ntpd</code> service, enter:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'ntpq -p'</strong></span>
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*ptbtime1.ptb.de .PTB.            1 8    2   64   77   23.585  967.902   0.684
-ptbtime2.ptb.de .PTB.            1 8   30   64   78   24.653  993.937   0.765</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.time_sync/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/time_sync/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/63376">Are the rhel.pool.ntp.org NTP servers supported by Red Hat?</a> (Red Hat Knowledgebase)
					</li></ul></div></section></section><section class="chapter" id="configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 31. Configuring a system for session recording by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			Use the <code class="literal">tlog</code> RHEL system role to record and monitor terminal session activities on your managed nodes in an automatic fashion. You can configure the recording to take place per user or user group by means of the <code class="literal">SSSD</code> service.
		</p><p>
			The session recording solution in the tlog RHEL system role consists of the following components:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The <code class="literal">tlog</code> utility
				</li><li class="listitem">
					System Security Services Daemon (SSSD)
				</li><li class="listitem">
					Optional: The web console interface
				</li></ul></div><section class="section" id="deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">31.1. Configuring session recording for individual users by using the <code class="literal">tlog</code> RHEL system role</h3></div></div></div><p>
				Prepare and apply an Ansible playbook to configure a RHEL system to log session recording data to the <code class="literal">systemd</code> journal.
			</p><p>
				With that, you can enable recording the terminal output and input of a specific user during their sessions, when the user logs in on the console, or by SSH.
			</p><p>
				The playbook installs <code class="literal">tlog-rec-session</code>, a terminal session I/O logging program, that acts as the login shell for a user. The role creates an SSSD configuration drop file, and this file defines for which users and groups the login shell should be used. Additionally, if the <code class="literal">cockpit</code> package is installed on the system, the playbook also installs the <code class="literal">cockpit-session-recording</code> package, which is a <code class="literal">Cockpit</code> module that allows you to view and play recordings in the web console interface.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Deploy session recording
  hosts: managed-node-01.example.com
  tasks:
    - name: Enable session recording for specific users
      ansible.builtin.include_role:
        name: rhel-system-roles.tlog
  vars:
    tlog_scope_sssd: some
    tlog_users_sssd:
      - &lt;recorded_user&gt;</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">tlog_scope_sssd: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									The <code class="literal">some</code> value specifies you want to record only certain users and groups, not <code class="literal">all</code> or <code class="literal">none</code>.
								</dd><dt><span class="term"><code class="literal">tlog_users_sssd:: <span class="emphasis"><em>&lt;list_of_users&gt;</em></span></code></span></dt><dd>
									A YAML list of users you want to record a session from. Note that the role does not add users if they do not exist.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the SSSD drop-in file’s content:
					</p><pre class="literallayout"># <span class="strong strong"><strong>cd /etc/sssd/conf.d/sssd-session-recording.conf</strong></span></pre><p class="simpara">
						You can see that the file contains the parameters you set in the playbook.
					</p></li><li class="listitem">
						Log in as a user whose session will be recorded, perform some actions, and log out.
					</li><li class="listitem"><p class="simpara">
						As the <code class="literal">root</code> user:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Display the list of recorded sessions:
							</p><pre class="literallayout"># <span class="strong strong"><strong>journalctl _COMM=tlog-rec-sessio</strong></span>
Nov 12 09:17:30 managed-node-01.example.com -tlog-rec-session[1546]: {"ver":"2.3","host":"managed-node-01.example.com","rec":"07418f2b0f334c1696c10cbe6f6f31a6-60a-e4a2","user":"demo-user",...
...</pre><p class="simpara">
								You require the value of the <code class="literal">rec</code> (recording ID) field in the next step.
							</p><p class="simpara">
								Note that the value of the <code class="literal">_COMM</code> field is shortened due to t a 15 character limit.
							</p></li><li class="listitem"><p class="simpara">
								Play back a session:
							</p><pre class="literallayout"># <span class="strong strong"><strong>tlog-play -r journal -M TLOG_REC=<span class="emphasis"><em>&lt;recording_id&gt;</em></span></strong></span></pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.tlog/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/tlog/</code> directory
					</li></ul></div></section><section class="section" id="deploying-the-tlog-rhel-system-role-for-excluding-lists-of-groups-or-users_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">31.2. Excluding certain users and groups from session recording by using the the <code class="literal">tlog</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">tlog_exclude_users_sssd</code> and <code class="literal">tlog_exclude_groups_sssd</code> role variables from the <code class="literal">tlog</code> RHEL system role to exclude users or groups from having their sessions recorded and logged in the <code class="literal">systemd</code> journal.
			</p><p>
				The playbook installs <code class="literal">tlog-rec-session</code>, a terminal session I/O logging program, that acts as the login shell for a user. The role creates an SSSD configuration drop file, and this file defines for which users and groups the login shell should be used. Additionally, if the <code class="literal">cockpit</code> package is installed on the system, the playbook also installs the <code class="literal">cockpit-session-recording</code> package, which is a <code class="literal">Cockpit</code> module that allows you to view and play recordings in the web console interface.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Deploy session recording excluding users and groups
  hosts: managed-node-01.example.com
  tasks:
    - name: Exclude users and groups
      ansible.builtin.include_role:
        name: rhel-system-roles.tlog
      vars:
        tlog_scope_sssd: all
        tlog_exclude_users_sssd:
          - jeff
          - james
        tlog_exclude_groups_sssd:
          - admins</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">tlog_scope_sssd: <span class="emphasis"><em>&lt;value&gt;</em></span></code></span></dt><dd>
									The value <code class="literal">all</code> specifies that you want to record all users and groups.
								</dd><dt><span class="term"><code class="literal">tlog_exclude_users_sssd: <span class="emphasis"><em>&lt;user_list&gt;</em></span></code></span></dt><dd>
									A YAML list of users user names you want to exclude from the session recording.
								</dd><dt><span class="term"><code class="literal">tlog_exclude_groups_sssd: <span class="emphasis"><em>&lt;group_list&gt;</em></span></code></span></dt><dd>
									A YAML list of groups you want to exclude from the session recording.
								</dd></dl></div></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check the SSSD drop-in file’s content:
					</p><pre class="literallayout"># <span class="strong strong"><strong>cat /etc/sssd/conf.d/sssd-session-recording.conf</strong></span></pre><p class="simpara">
						You can see that the file contains the parameters you set in the playbook.
					</p></li><li class="listitem">
						Log in as a user whose session will be recorded, perform some actions, and log out.
					</li><li class="listitem"><p class="simpara">
						As the <code class="literal">root</code> user:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Display the list of recorded sessions:
							</p><pre class="literallayout"># <span class="strong strong"><strong>journalctl _COMM=tlog-rec-sessio</strong></span>
Nov 12 09:17:30 managed-node-01.example.com -tlog-rec-session[1546]: {"ver":"2.3","host":"managed-node-01.example.com","rec":"07418f2b0f334c1696c10cbe6f6f31a6-60a-e4a2","user":"demo-user",...
...</pre><p class="simpara">
								You require the value of the <code class="literal">rec</code> (recording ID) field in the next step.
							</p><p class="simpara">
								Note that the value of the <code class="literal">_COMM</code> field is shortened due to t a 15 character limit.
							</p></li><li class="listitem"><p class="simpara">
								Play back a session:
							</p><pre class="literallayout"># <span class="strong strong"><strong>tlog-play -r journal -M TLOG_REC=<span class="emphasis"><em>&lt;recording_id&gt;</em></span></strong></span></pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.tlog/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/tlog/</code> directory
					</li></ul></div></section></section><section class="chapter" id="assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles"><div class="titlepage"><div><div><h2 class="title">Chapter 32. Configuring VPN connections with IPsec by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			With the <code class="literal">vpn</code> system role, you can configure VPN connections on RHEL systems by using Red Hat Ansible Automation Platform. You can use it to set up host-to-host, network-to-network, VPN Remote Access Server, and mesh configurations.
		</p><p>
			For host-to-host connections, the role sets up a VPN tunnel between each pair of hosts in the list of <code class="literal">vpn_connections</code> using the default parameters, including generating keys as needed. Alternatively, you can configure it to create an opportunistic mesh configuration between all hosts listed. The role assumes that the names of the hosts under <code class="literal">hosts</code> are the same as the names of the hosts used in the Ansible inventory, and that you can use those names to configure the tunnels.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				The <code class="literal">vpn</code> RHEL system role currently supports only Libreswan, which is an IPsec implementation, as the VPN provider.
			</p></div></rh-alert><section class="section" id="proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role"><div class="titlepage"><div><div><h3 class="title">32.1. Creating a host-to-host VPN with IPsec by using the <code class="literal">vpn</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">vpn</code> system role to configure host-to-host connections by running an Ansible playbook on the control node, which configures all managed nodes listed in an inventory file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">- name: Host to host VPN
  hosts: managed-node-01.example.com, managed-node-02.example.com
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - hosts:
          managed-node-01.example.com:
          managed-node-02.example.com:
    vpn_manage_firewall: true
    vpn_manage_selinux: true</pre><p class="simpara">
						This playbook configures the connection <code class="literal">managed-node-01.example.com-to-managed-node-02.example.com</code> by using pre-shared key authentication with keys auto-generated by the system role. Because <code class="literal">vpn_manage_firewall</code> and <code class="literal">vpn_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">vpn</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">vpn</code> role.
					</p><p class="simpara">
						To configure connections from managed hosts to external hosts that are not listed in the inventory file, add the following section to the <code class="literal">vpn_connections</code> list of hosts:
					</p><pre class="programlisting language-yaml">    vpn_connections:
      - hosts:
          managed-node-01.example.com:
          <span class="strong strong"><strong><span class="emphasis"><em>&lt;external_node&gt;</em></span>:</strong></span>
            <span class="strong strong"><strong>hostname: <span class="emphasis"><em>&lt;IP_address_or_hostname&gt;</em></span></strong></span></pre><p class="simpara">
						This configures one additional connection: <code class="literal">managed-node-01.example.com-to-<span class="emphasis"><em>&lt;external_node&gt;</em></span></code>
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							The connections are configured only on the managed nodes and not on the external node.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Optional: You can specify multiple VPN connections for the managed nodes by using additional sections within <code class="literal">vpn_connections</code>, for example, a control plane and a data plane:
					</p><pre class="programlisting language-yaml">- name: Multiple VPN
  hosts: managed-node-01.example.com, managed-node-02.example.com
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - name: control_plane_vpn
        hosts:
          managed-node-01.example.com:
            hostname: 192.0.2.0 # IP for the control plane
          managed-node-02.example.com:
            hostname: 192.0.2.1
      - name: data_plane_vpn
        hosts:
          managed-node-01.example.com:
            hostname: 10.0.0.1 # IP for the data plane
          managed-node-02.example.com:
            hostname: 10.0.0.2</pre></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the managed nodes, confirm that the connection is successfully loaded:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipsec status | grep <span class="emphasis"><em>&lt;connection_name&gt;</em></span></strong></span></pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;connection_name&gt;</em></span></code> with the name of the connection from this node, for example <code class="literal">managed_node1-to-managed_node2</code>.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							By default, the role generates a descriptive name for each connection it creates from the perspective of each system. For example, when creating a connection between <code class="literal">managed_node1</code> and <code class="literal">managed_node2</code>, the descriptive name of this connection on <code class="literal">managed_node1</code> is <code class="literal">managed_node1-to-managed_node2</code> but on <code class="literal">managed_node2</code> the connection is named <code class="literal">managed_node2-to-managed_node1</code>.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						On the managed nodes, confirm that the connection is successfully started:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipsec trafficstatus | grep <span class="emphasis"><em>&lt;connection_name&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: If a connection does not successfully load, manually add the connection by entering the following command. This provides more specific information indicating why the connection failed to establish:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipsec auto --add <span class="emphasis"><em>&lt;connection_name&gt;</em></span></strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Any errors that may occur during the process of loading and starting the connection are reported in the <code class="literal">/var/log/pluto.log</code> file. Because these logs are hard to parse, manually add the connection to obtain log messages from the standard output instead.
						</p></div></rh-alert></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.vpn/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/vpn/</code> directory
					</li></ul></div></section><section class="section" id="proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role"><div class="titlepage"><div><div><h3 class="title">32.2. Creating an opportunistic mesh VPN connection with IPsec by using the <code class="literal">vpn</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">vpn</code> system role to configure an opportunistic mesh VPN connection that uses certificates for authentication by running an Ansible playbook on the control node, which will configure all the managed nodes listed in an inventory file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles" title="Chapter 2. Preparing a control node and managed nodes to use RHEL system roles">You have prepared the control node and the managed nodes</a>.
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The IPsec Network Security Services (NSS) crypto library in the <code class="literal">/etc/ipsec.d/</code> directory contains the necessary certificates.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">- name: <span class="emphasis"><em>Mesh VPN</em></span>
  hosts: managed-node-01.example.com, managed-node-02.example.com, managed-node-03.example.com
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - opportunistic: true
        auth_method: cert
        policies:
          - policy: private
            cidr: default
          - policy: private-or-clear
            cidr: 198.51.100.0/24
          - policy: private
            cidr: 192.0.2.0/24
          - policy: clear
            cidr: 192.0.2.7/32
    vpn_manage_firewall: true
    vpn_manage_selinux: true</pre><p class="simpara">
						Authentication with certificates is configured by defining the <code class="literal">auth_method: cert</code> parameter in the playbook. By default, the node name is used as the certificate nickname. In this example, this is <code class="literal">managed-node-01.example.com</code>. You can define different certificate names by using the <code class="literal">cert_name</code> attribute in your inventory.
					</p><p class="simpara">
						In this example procedure, the control node, which is the system from which you will run the Ansible playbook, shares the same classless inter-domain routing (CIDR) number as both of the managed nodes (192.0.2.0/24) and has the IP address 192.0.2.7. Therefore, the control node falls under the private policy which is automatically created for CIDR 192.0.2.0/24.
					</p><p class="simpara">
						To prevent SSH connection loss during the play, a clear policy for the control node is included in the list of policies. Note that there is also an item in the policies list where the CIDR is equal to default. This is because this playbook overrides the rule from the default policy to make it private instead of private-or-clear.
					</p><p class="simpara">
						Because <code class="literal">vpn_manage_firewall</code> and <code class="literal">vpn_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">vpn</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">vpn</code> role.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.vpn/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/vpn/</code> directory
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140064638241184"><h2 class="legalnotice">Legal Notice</h2><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2024 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></body></section><!----></div></article><aside id="layout" class="span-xs-12 span-sm-2 span-md-2 content-format-selectors" aria-label="Select page format" data-v-8589d091><div class="sticky-top page-layout-options" data-v-8589d091><label for="page-format" data-v-8589d091>Format</label><select id="page-format" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div><!----></aside></div><div class="btn-container hidden" data-v-8589d091><pf-button class="top-scroll-btn" icon="angle-up" icon-set="fas" icon-position="right" data-v-8589d091>Back to top</pf-button></div><!--]--><!--]--></main><rh-footer data-analytics-region="page-footer" data-v-97dd2752><a slot="logo" href="/en" data-analytics-category="Footer" data-analytics-text="Logo" data-v-97dd2752><img alt="Red Hat logo" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" loading="lazy" width="222" height="40" data-v-97dd2752></a><rh-footer-social-link slot="social-links" icon="github" data-v-97dd2752><a href="https://github.com/redhat-documentation" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="LinkedIn" data-v-97dd2752>Github</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="reddit" data-v-97dd2752><a href="https://www.reddit.com/r/redhat/" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="YouTube" data-v-97dd2752>Reddit</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="youtube" data-v-97dd2752><a href="https://www.youtube.com/@redhat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Facebook" data-v-97dd2752>Youtube</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="twitter" data-v-97dd2752><a href="https://twitter.com/RedHat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Twitter" data-v-97dd2752>Twitter</a></rh-footer-social-link><h3 slot="links" data-analytics-text="Learn" data-v-97dd2752>Learn</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://developers.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Developer resources" data-v-97dd2752>Developer resources</a></li><li data-v-97dd2752><a href="https://cloud.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Cloud learning hub" data-v-97dd2752>Cloud learning hub</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="Footer|Learn" data-analytics-text="Interactive labs" data-v-97dd2752>Interactive labs</a></li><li data-v-97dd2752><a href="https://www.redhat.com/services/training-and-certification" data-analytics-category="Footer|Learn" data-analytics-text="Training and certification" data-v-97dd2752>Training and certification</a></li><li data-v-97dd2752><a href="https://access.redhat.com/support" data-analytics-category="Footer|Learn" data-analytics-text="Customer support" data-v-97dd2752>Customer support</a></li><li data-v-97dd2752><a href="/products" data-analytics-category="Footer|Learn" data-analytics-text="See all documentation" data-v-97dd2752>See all documentation</a></li></ul><h3 slot="links" data-analytics-text="Try buy sell" data-v-97dd2752>Try, buy, &amp; sell</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/products/trials" data-analytics-category="Footer|Try buy sell" data-analytics-text="Product trial center" data-v-97dd2752>Product trial center</a></li><li data-v-97dd2752><a href="https://marketplace.redhat.com" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Marketplace" data-v-97dd2752>Red Hat Marketplace</a></li><li data-v-97dd2752><a href="https://catalog.redhat.com/" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Ecosystem Catalog" data-v-97dd2752>Red Hat Ecosystem Catalog</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/store" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Store" data-v-97dd2752>Red Hat Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/japan-buy" data-analytics-category="Footer|Try buy sell" data-analytics-text="Buy online (Japan)" data-v-97dd2752>Buy online (Japan)</a></li></ul><h3 slot="links" data-analytics-text="Communities" data-v-97dd2752>Communities</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://access.redhat.com/community" data-analytics-category="Footer|Communities" data-analytics-text="Customer Portal Community" data-v-97dd2752>Customer Portal Community</a></li><li data-v-97dd2752><a href="https://www.redhat.com/events" data-analytics-category="Footer|Communities" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/our-community-contributions" data-analytics-category="Footer|Communities" data-analytics-text="How we contribute" data-v-97dd2752>How we contribute</a></li></ul><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat Documentation" data-v-97dd2752>About Red Hat Documentation</h3><p data-v-97dd2752>We help Red Hat users innovate and achieve their goals with our products and services with content they can trust.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="Making open source more inclusive" data-v-97dd2752>Making open source more inclusive</h3><p data-v-97dd2752>Red Hat is committed to replacing problematic language in our code, documentation, and web properties. For more details, see the <a href=" https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language" data-analytics-category="Footer|Making open source more inclusive" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a>.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</h3><p data-v-97dd2752>We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.</p></rh-footer-block><rh-footer-universal slot="universal" data-v-97dd2752><h3 slot="links-primary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-primary" data-analytics-region="page-footer-bottom-primary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/company" data-analytics-category="Footer|Corporate" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/jobs" data-analytics-category="Footer|Corporate" data-analytics-text="Jobs" data-v-97dd2752>Jobs</a></li><li data-v-97dd2752><a href="https://redhat.com/en/events" data-analytics-category="Footer|Corporate" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/office-locations" data-analytics-category="Footer|Corporate" data-analytics-text="Locations" data-v-97dd2752>Locations</a></li><li data-v-97dd2752><a href="https://redhat.com/en/contact" data-analytics-category="Footer|Corporate" data-analytics-text="Contact Red Hat" data-v-97dd2752>Contact Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/blog" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/our-culture/diversity-equity-inclusion" data-analytics-category="Footer|Corporate" data-analytics-text="Diversity equity and inclusion" data-v-97dd2752>Diversity, equity, and inclusion</a></li><li data-v-97dd2752><a href="https://coolstuff.redhat.com/" data-analytics-category="Footer|Corporate" data-analytics-text="Cool Stuff Store" data-v-97dd2752>Cool Stuff Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/summit" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Summit" data-v-97dd2752>Red Hat Summit</a></li></ul><span data-v-97dd2752 data-v-5f538988></span><rh-footer-copyright slot="links-secondary" data-v-97dd2752>© 2024 Red Hat, Inc.</rh-footer-copyright><h3 slot="links-secondary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-secondary" data-analytics-region="page-footer-bottom-secondary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/privacy-policy" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Privacy statement" data-v-97dd2752>Privacy statement</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/terms-use" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Terms of use" data-v-97dd2752>Terms of use</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/all-policies-guidelines" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="All policies and guidelines" data-v-97dd2752>All policies and guidelines</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/digital-accessibility" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Digital accessibility" class="active" data-v-97dd2752>Digital accessibility</a></li><li data-v-97dd2752><span id="teconsent" data-v-97dd2752></span></li></ul></rh-footer-universal></rh-footer><div id="consent_blackbar" style="position:fixed;bottom:0;width:100%;z-index:5;padding:10px;"></div><!--]--><!--]--></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["ShallowReactive",1],{"data":2,"state":923,"once":927,"_errors":928,"serverRendered":15,"path":930},["ShallowReactive",3],{"s8LoCEfG4A":4,"uUstF4AIyn":10,"Pn02PlJOas":851,"rFVLKcOK8e":922},[5,6,7,8,9],"fr-fr","ko-kr","zh-cn","en-us","ja-jp",{"name":11,"html":12,"type":-1,"toc":13,"breadcrumbs":750,"error":18,"title":758,"productName":752,"productVersions":767,"pagination":796,"redirect":832,"canonicalLinks":833,"openShiftProducts":835,"tocFromVolume":-1,"jumpLinks":850},"Automating system administration by using RHEL system roles","\u003Cbody>\u003Cdiv xml:lang=\"en-US\" class=\"book\" id=\"idm140064656299584\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv class=\"producttitle\">\u003Cspan class=\"productname\">Red Hat Enterprise Linux\u003C/span> \u003Cspan class=\"productnumber\">9\u003C/span>\u003C/div>\u003Cdiv>\u003Ch3 class=\"subtitle\">Consistent and repeatable configuration of RHEL deployments across multiple hosts with Red Hat Ansible Automation Platform playbooks\u003C/h3>\u003C/div>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"authorgroup\">\u003Cspan class=\"orgname\">Red Hat\u003C/span> \u003Cspan class=\"orgdiv\">Customer Content Services\u003C/span>\u003C/div>\u003C/div>\u003Cdiv>\u003Ca href=\"#idm140064638241184\">Legal Notice\u003C/a>\u003C/div>\u003Cdiv>\u003Cdiv class=\"abstract\">\u003Cp class=\"title\">\u003Cstrong>Abstract\u003C/strong>\u003C/p>\u003Cdiv class=\"para\">\n\t\t\t\tThe Red Hat Enterprise Linux (RHEL) system roles are a collection of Ansible roles, modules, and playbooks that help automate the consistent and repeatable administration of RHEL systems. With RHEL system roles, you can efficiently manage large inventories of systems by running configuration playbooks from a single system.\n\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003Chr/>\u003C/div>\u003Csection class=\"preface\" id=\"proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Providing feedback on Red Hat documentation\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWe appreciate your feedback on our documentation. Let us know how we can improve it.\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Submitting feedback through Jira (account required)\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLog in to the \u003Ca class=\"link\" href=\"https://issues.redhat.com/projects/RHELDOCS/issues\">Jira\u003C/a> website.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> in the top navigation bar\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter a descriptive title in the \u003Cspan class=\"strong strong\">\u003Cstrong>Summary\u003C/strong>\u003C/span> field.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter your suggestion for improvement in the \u003Cspan class=\"strong strong\">\u003Cstrong>Description\u003C/strong>\u003C/span> field. Include links to the relevant parts of the documentation.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> at the bottom of the dialogue.\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 1. Introduction to RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tBy using RHEL system roles, you can remotely manage the system configurations of multiple RHEL systems across major versions of RHEL.\n\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Important terms and concepts\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\tThe following describes important terms and concepts in an Ansible environment:\n\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Control node\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\tA control node is the system from which you run Ansible commands and playbooks. Your control node can be an Ansible Automation Platform, Red Hat Satellite, or a RHEL 9, 8, or 7 host. For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Managed node\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\tManaged nodes are the servers and network devices that you manage with Ansible. Managed nodes are also sometimes called hosts. Ansible does not have to be installed on managed nodes. For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a managed node\u003C/a>.\n\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Ansible playbook\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\tIn a playbook, you define the configuration you want to achieve on your managed nodes or a set of steps for the system on the managed node to perform. Playbooks are Ansible’s configuration, deployment, and orchestration language.\n\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Inventory\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\tIn an inventory file, you list the managed nodes and specify information such as IP address for each managed node. In the inventory, you can also organize the managed nodes by creating and nesting groups for easier scaling. An inventory file is also sometimes called a hostfile.\n\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Available roles on a Red Hat Enterprise Linux 9 control node\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\tOn a Red Hat Enterprise Linux 9 control node, the \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package provides the following roles:\n\t\t\t\u003C/p>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 25%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064662486128\" scope=\"col\">Role name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064662485040\" scope=\"col\">Role description\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064662483952\" scope=\"col\">Chapter title\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">certificate\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tCertificate Issuance and Renewal\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tRequesting certificates by using RHEL system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">cockpit\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tWeb console\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tInstalling and configuring web console with the cockpit RHEL system role\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">crypto_policies\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tSystem-wide cryptographic policies\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tSetting a custom cryptographic policy across systems\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">firewall\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tFirewalld\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring firewalld by using system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ha_cluster\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tHA Cluster\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring a high-availability cluster by using system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">kdump\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tKernel Dumps\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring kdump by using RHEL system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">kernel_settings\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tKernel Settings\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tUsing Ansible roles to permanently configure kernel parameters\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">logging\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tLogging\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tUsing the logging system role\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">metrics\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tMetrics (PCP)\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tMonitoring performance by using RHEL system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">network\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tNetworking\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tUsing the network RHEL system role to manage InfiniBand connections\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">nbde_client\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tNetwork Bound Disk Encryption client\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tUsing the nbde_client and nbde_server system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">nbde_server\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tNetwork Bound Disk Encryption server\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tUsing the nbde_client and nbde_server system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">postfix\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tPostfix\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tVariables of the postfix role in system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">postgresql\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tPostgreSQL\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tInstalling and configuring PostgreSQL by using the postgresql RHEL system role\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">selinux\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tSELinux\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring SELinux by using system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tSSH client\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring secure communication with the ssh system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sshd\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tSSH server\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring secure communication with the ssh system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">storage\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tStorage\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tManaging local storage by using RHEL system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">tlog\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tTerminal Session Recording\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring a system for session recording by using the tlog RHEL system role\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">timesync\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tTime Synchronization\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring time synchronization by using RHEL system roles\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662486128\"> \u003Cp>\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">vpn\u003C/code>\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662485040\"> \u003Cp>\n\t\t\t\t\t\t\tVPN\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064662483952\"> \u003Cp>\n\t\t\t\t\t\t\tConfiguring VPN connections with IPsec by using the vpn RHEL system role\n\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/3050101\">Red Hat Enterprise Linux (RHEL) system roles\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.\u003Cspan class=\"emphasis\">\u003Cem>&lt;role_name&gt;\u003C/em>\u003C/span>/README.md\u003C/code> file\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/\u003Cspan class=\"emphasis\">\u003Cem>&lt;role_name&gt;\u003C/em>\u003C/span>/\u003C/code> directory\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tBefore you can use individual RHEL system roles to manage services and settings, you must prepare the control node and managed nodes.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.1. Preparing a control node on RHEL 9\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBefore using RHEL system roles, you must configure a control node. This system then configures the managed hosts from the inventory according to the playbooks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system is registered to the Customer Portal.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA \u003Ccode class=\"literal\">Red Hat Enterprise Linux Server\u003C/code> subscription is attached to the system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: An \u003Ccode class=\"literal\">Ansible Automation Platform\u003C/code> subscription is attached to the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a user named \u003Ccode class=\"literal\">ansible\u003C/code> to manage and run playbooks:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@control-node]# \u003Cspan class=\"strong strong\">\u003Cstrong>useradd ansible\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSwitch to the newly created \u003Ccode class=\"literal\">ansible\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@control-node]# \u003Cspan class=\"strong strong\">\u003Cstrong>su - ansible\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPerform the rest of the procedure as this user.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an SSH public and private key:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ansible@control-node]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-keygen\u003C/strong>\u003C/span>\nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/ansible/.ssh/id_rsa):\nEnter passphrase (empty for no passphrase): \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter same passphrase again: \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the suggested default location for the key file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: To prevent Ansible from prompting you for the SSH key password each time you establish a connection, configure an SSH agent.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the \u003Ccode class=\"literal\">~/.ansible.cfg\u003C/code> file with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[defaults]\ninventory = /home/ansible/inventory\nremote_user = ansible\n\n[privilege_escalation]\nbecome = True\nbecome_method = sudo\nbecome_user = root\nbecome_ask_pass = True\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tSettings in the \u003Ccode class=\"literal\">~/.ansible.cfg\u003C/code> file have a higher priority and override settings from the global \u003Ccode class=\"literal\">/etc/ansible/ansible.cfg\u003C/code> file.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWith these settings, Ansible performs the following actions:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tManages hosts in the specified inventory file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUses the account set in the \u003Ccode class=\"literal\">remote_user\u003C/code> parameter when it establishes SSH connections to managed nodes.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUses the \u003Ccode class=\"literal\">sudo\u003C/code> utility to execute tasks on managed nodes as the \u003Ccode class=\"literal\">root\u003C/code> user.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tPrompts for the root password of the remote user every time you apply a playbook. This is recommended for security reasons.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an \u003Ccode class=\"literal\">~/inventory\u003C/code> file in INI or YAML format that lists the hostnames of managed hosts. You can also define groups of hosts in the inventory file. For example, the following is an inventory file in the INI format with three hosts and one host group named \u003Ccode class=\"literal\">US\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">managed-node-01.example.com\n\n[US]\nmanaged-node-02.example.com ansible_host=192.0.2.100\nmanaged-node-03.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that the control node must be able to resolve the hostnames. If the DNS server cannot resolve certain hostnames, add the \u003Ccode class=\"literal\">ansible_host\u003C/code> parameter next to the host entry to specify its IP address.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall RHEL system roles:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOn a RHEL host without Ansible Automation Platform, install the \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@control-node]# \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install rhel-system-roles\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis command installs the collections in the \u003Ccode class=\"literal\">/usr/share/ansible/collections/ansible_collections/redhat/rhel_system_roles/\u003C/code> directory, and the \u003Ccode class=\"literal\">ansible-core\u003C/code> package as a dependency.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOn Ansible Automation Platform, perform the following steps as the \u003Ccode class=\"literal\">ansible\u003C/code> user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_ansible_automation_platform/2.4/html/getting_started_with_automation_hub/configure-hub-primary\">Define Red Hat automation hub as the primary source for content\u003C/a> in the \u003Ccode class=\"literal\">~/.ansible.cfg\u003C/code> file.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">redhat.rhel_system_roles\u003C/code> collection from Red Hat automation hub:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ansible@control-node]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-galaxy collection install redhat.rhel_system_roles\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tThis command installs the collection in the \u003Ccode class=\"literal\">~/.ansible/collections/ansible_collections/redhat/rhel_system_roles/\u003C/code> directory.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next step\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPrepare the managed nodes. For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a managed node\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6325611\">Scope of support for the Ansible Core package included in the RHEL 9 and RHEL 8.6 and later AppStream repositories\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/253273\">How to register and subscribe a system to the Red Hat Customer Portal using subscription-manager\u003C/a> (Red Hat Knowledgebase)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ssh-keygen(1)\u003C/code> manual page\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh\">Connecting to remote machines with SSH keys using ssh-agent\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/reference_appendices/config.html\">Ansible configuration settings\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html\">How to build your inventory\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.2. Preparing a managed node\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tManaged nodes are the systems listed in the inventory and which will be configured by the control node according to the playbook. You do not have to install Ansible on managed hosts.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou prepared the control node. For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have SSH access from the control node.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tDirect SSH access as the \u003Ccode class=\"literal\">root\u003C/code> user is a security risk. To reduce this risk, you will create a local user on this node and configure a \u003Ccode class=\"literal\">sudo\u003C/code> policy when preparing a managed node. Ansible on the control node can then use the local user account to log in to the managed node and run playbooks as different users, such as \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a user named \u003Ccode class=\"literal\">ansible\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@managed-node-01]# \u003Cspan class=\"strong strong\">\u003Cstrong>useradd ansible\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe control node later uses this user to establish an SSH connection to this host.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet a password for the \u003Ccode class=\"literal\">ansible\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@managed-node-01]# \u003Cspan class=\"strong strong\">\u003Cstrong>passwd ansible\u003C/strong>\u003C/span>\nChanging password for user ansible.\nNew password: \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nRetype new password: \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\npasswd: all authentication tokens updated successfully.\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou must enter this password when Ansible uses \u003Ccode class=\"literal\">sudo\u003C/code> to perform tasks as the \u003Ccode class=\"literal\">root\u003C/code> user.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">ansible\u003C/code> user’s SSH public key on the managed node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLog in to the control node as the \u003Ccode class=\"literal\">ansible\u003C/code> user, and copy the SSH public key to the managed node:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ansible@control-node]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-copy-id managed-node-01.example.com\u003C/strong>\u003C/span>\n/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: \"/home/ansible/.ssh/id_rsa.pub\"\nThe authenticity of host 'managed-node-01.example.com (192.0.2.100)' can't be established.\nECDSA key fingerprint is SHA256:9bZ33GJNODK3zbNhybokN/6Mq7hu3vpBXDrCxe7NAvo.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhen prompted, connect by entering \u003Ccode class=\"literal\">yes\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Are you sure you want to continue connecting (yes/no/[fingerprint])? \u003Cspan class=\"strong strong\">\u003Cstrong>yes\u003C/strong>\u003C/span>\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhen prompted, enter the password:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ansible@managed-node-01.example.com's password: \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nNumber of key(s) added: 1\n\nNow try logging into the machine, with:   \"ssh 'managed-node-01.example.com'\"\nand check to make sure that only the key(s) you wanted were added.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tVerify the SSH connection by remotely executing a command on the control node:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ansible@control-node]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh managed-node-01.example.com whoami\u003C/strong>\u003C/span>\nansible\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">sudo\u003C/code> configuration for the \u003Ccode class=\"literal\">ansible\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate and edit the \u003Ccode class=\"literal\">/etc/sudoers.d/ansible\u003C/code> file by using the \u003Ccode class=\"literal\">visudo\u003C/code> command:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@managed-node-01]# \u003Cspan class=\"strong strong\">\u003Cstrong>visudo /etc/sudoers.d/ansible\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe benefit of using \u003Ccode class=\"literal\">visudo\u003C/code> over a normal editor is that this utility provides basic checks, such as for parse errors, before installing the file.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConfigure a \u003Ccode class=\"literal\">sudoers\u003C/code> policy in the \u003Ccode class=\"literal\">/etc/sudoers.d/ansible\u003C/code> file that meets your requirements, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tTo grant permissions to the \u003Ccode class=\"literal\">ansible\u003C/code> user to run all commands as any user and group on this host after entering the \u003Ccode class=\"literal\">ansible\u003C/code> user’s password, use:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ansible   ALL=(ALL) ALL\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tTo grant permissions to the \u003Ccode class=\"literal\">ansible\u003C/code> user to run all commands as any user and group on this host without entering the \u003Ccode class=\"literal\">ansible\u003C/code> user’s password, use:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ansible   ALL=(ALL) NOPASSWD: ALL\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, configure a more fine-granular policy that matches your security requirements. For further details on \u003Ccode class=\"literal\">sudoers\u003C/code> policies, see the \u003Ccode class=\"literal\">sudoers(5)\u003C/code> manual page.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that you can execute commands from the control node on an all managed nodes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout white-space-pre\">[ansible@control-node]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible all -m ping\u003C/strong>\u003C/span>\nBECOME password: \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | \u003Cspan class=\"strong strong\">\u003Cstrong>SUCCESS\u003C/strong>\u003C/span> =&gt; {\n    \t\"ansible_facts\": {\n    \t    \"discovered_interpreter_python\": \"/usr/bin/python3\"\n    \t},\n    \t\"changed\": false,\n    \t\"ping\": \"pong\"\n}\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe hard-coded all group dynamically contains all hosts listed in the inventory file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that privilege escalation works correctly by running the \u003Ccode class=\"literal\">whoami\u003C/code> utility on all managed nodes by using the Ansible \u003Ccode class=\"literal\">command\u003C/code> module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ansible@control-node]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible all -m command -a whoami\u003C/strong>\u003C/span>\nBECOME password: \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n\u003Cspan class=\"strong strong\">\u003Cstrong>root\u003C/strong>\u003C/span>\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the command returns root, you configured \u003Ccode class=\"literal\">sudo\u003C/code> on the managed nodes correctly.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sudoers(5)\u003C/code> manual page\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"ansible-vault_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 3. Ansible vault\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tSometimes your playbook needs to use sensitive data such as passwords, API keys, and other secrets to configure managed hosts. Storing this information in plain text in variables or other Ansible-compatible files is a security risk because any user with access to those files can read the sensitive data.\n\t\t\u003C/p>\u003Cp>\n\t\t\tWith Ansible vault, you can encrypt, decrypt, view, and edit sensitive information. They could be included as:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tInserted variable files in an Ansible Playbook\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tHost and group variables\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tVariable files passed as arguments when executing the playbook\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tVariables defined in Ansible roles\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tYou can use Ansible vault to securely manage individual variables, entire files, or even structured data like YAML files. This data can then be safely stored in a version control system or shared with team members without exposing sensitive information.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tFiles are protected with symmetric encryption of the Advanced Encryption Standard (AES256), where a single password or passphrase is used both to encrypt and decrypt the data. Note that the way this is done has not been formally audited by a third party.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\tTo simplify management, it makes sense to set up your Ansible project so that sensitive variables and all other variables are kept in separate files, or directories. Then you can protect the files containing sensitive variables with the \u003Ccode class=\"literal\">ansible-vault\u003C/code> command.\n\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Creating an encrypted file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\tThe following command prompts you for a new vault password. Then it opens a file for storing sensitive variables using the default editor.\n\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Viewing an encrypted file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\tThe following command prompts you for your existing vault password. Then it displays the sensitive contents of an already encrypted file.\n\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault view vault.yml\u003C/strong>\u003C/span>\nVault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nmy_secret: \"yJJvPqhsiusmmPPZdnjndkdnYNDjdj782meUZcw\"\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Editing an encrypted file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\tThe following command prompts you for your existing vault password. Then it opens the already encrypted file for you to update the sensitive variables using the default editor.\n\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault edit vault.yml\u003C/strong>\u003C/span>\nVault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Encrypting an existing file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\tThe following command prompts you for a new vault password. Then it encrypts an existing unencrypted file.\n\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault encrypt vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nEncryption successful\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Decrypting an existing file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\tThe following command prompts you for your existing vault password. Then it decrypts an existing encrypted file.\n\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault decrypt vault.yml\u003C/strong>\u003C/span>\nVault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nDecryption successful\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Changing the password of an encrypted file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\tThe following command prompts you for your original vault password, then for the new vault password.\n\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault rekey vault.yml\u003C/strong>\u003C/span>\nVault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nRekey successful\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Basic application of Ansible vault variables in a playbook\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\n\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create user accounts for all servers\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create user from vault.yml file\n      user:\n        name: \"{{ username }}\"\n        password: \"{{ pwhash }}\"\u003C/pre>\n\n\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\tYou read-in the file with variables (\u003Ccode class=\"literal\">vault.yml\u003C/code>) in the \u003Ccode class=\"literal\">vars_files\u003C/code> section of your Ansible Playbook, and you use the curly brackets the same way you would do with your ordinary variables. Then you either run the playbook with the \u003Ccode class=\"literal\">ansible-playbook --ask-vault-pass\u003C/code> command and you enter the password manually. Or you save the password in a separate file and you run the playbook with the \u003Ccode class=\"literal\">ansible-playbook --vault-password-file /path/to/my/vault-password-file\u003C/code> command.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ccode class=\"literal\">ansible-vault(1)\u003C/code>, \u003Ccode class=\"literal\">ansible-playbook(1)\u003C/code> man pages on your system\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Ansible vault\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html#variables-and-vaults\">Ansible vault Best Practices\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 4. Ansible IPMI modules in RHEL\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Csection class=\"section\" id=\"ref_the-rhel_mgmt-collection_assembly_ansible-ipmi-modules-in-rhel\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.1. The \u003Ccode class=\"literal\">rhel_mgmt\u003C/code> collection\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Intelligent Platform Management Interface (IPMI) is a specification for a set of standard protocols to communicate with baseboard management controller (BMC) devices. The \u003Ccode class=\"literal\">IPMI\u003C/code> modules allow you to enable and support hardware management automation. The \u003Ccode class=\"literal\">IPMI\u003C/code> modules are available in:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rhel_mgmt\u003C/code> Collection. The package name is \u003Ccode class=\"literal\">ansible-collection-redhat-rhel_mgmt\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe RHEL 8 AppStream, as part of the new \u003Ccode class=\"literal\">ansible-collection-redhat-rhel_mgmt\u003C/code> package.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe following IPMI modules are available in the rhel_mgmt collection:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipmi_boot\u003C/code>: Management of boot device order\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipmi_power\u003C/code>: Power management for machine\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe mandatory parameters used for the IPMI Modules are:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipmi_boot\u003C/code> parameters:\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064661588208\" scope=\"col\">Module name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064661587120\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064661588208\"> \u003Cp>\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064661587120\"> \u003Cp>\n\t\t\t\t\t\t\t\tHostname or ip address of the BMC\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064661588208\"> \u003Cp>\n\t\t\t\t\t\t\t\tpassword\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064661587120\"> \u003Cp>\n\t\t\t\t\t\t\t\tPassword to connect to the BMC\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064661588208\"> \u003Cp>\n\t\t\t\t\t\t\t\tbootdev\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064661587120\"> \u003Cp>\n\t\t\t\t\t\t\t\tDevice to be used on next boot\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* network\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* floppy\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* hd\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* safe\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* optical\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* setup\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* default\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064661588208\"> \u003Cp>\n\t\t\t\t\t\t\t\tUser\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064661587120\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsername to connect to the BMC\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipmi_power\u003C/code> parameters:\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064658043360\" scope=\"col\">Module name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064658042272\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064658043360\"> \u003Cp>\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064658042272\"> \u003Cp>\n\t\t\t\t\t\t\t\tBMC Hostname or IP address\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064658043360\"> \u003Cp>\n\t\t\t\t\t\t\t\tpassword\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064658042272\"> \u003Cp>\n\t\t\t\t\t\t\t\tPassword to connect to the BMC\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064658043360\"> \u003Cp>\n\t\t\t\t\t\t\t\tuser\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064658042272\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsername to connect to the BMC\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064658043360\"> \u003Cp>\n\t\t\t\t\t\t\t\tState\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064658042272\"> \u003Cp>\n\t\t\t\t\t\t\t\tCheck if the machine is on the desired status\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* on\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* off\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* shutdown\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* reset\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* boot\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"proc_example-using-the-ipmi_boot-module_assembly_ansible-ipmi-modules-in-rhel\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.2. Using the \u003Ccode class=\"literal\">ipmi_boot\u003C/code> module\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe following example shows how to use the \u003Ccode class=\"literal\">ipmi_boot\u003C/code> module in a playbook to set a boot device for the next boot. For simplicity, the examples use the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ansible-collection-redhat-rhel_mgmt\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">python3-pyghmi\u003C/code> package is installed either on the control node or the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IPMI BMC that you want to control is accessible over network from the control node or the managed host (if not using \u003Ccode class=\"literal\">localhost\u003C/code> as the managed host). Note that the host whose BMC is being configured by the module is generally different from the managed host, as the module contacts the BMC over the network using the IPMI protocol.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have credentials to access BMC with an appropriate level of access.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Set boot device to be used on next boot\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ensure boot device is HD\n      redhat.rhel_mgmt.ipmi_boot:\n        user: \u003Cspan class=\"emphasis\">\u003Cem>&lt;admin_user&gt;\u003C/em>\u003C/span>\n        password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\n        bootdev: hd\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tWhen you run the playbook, Ansible returns \u003Ccode class=\"literal\">success\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_example-using-the-ipmi_power-module_assembly_ansible-ipmi-modules-in-rhel\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.3. Using the \u003Ccode class=\"literal\">ipmi_power\u003C/code> module\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThis example shows how to use the \u003Ccode class=\"literal\">ipmi_boot\u003C/code> module in a playbook to check if the system is turned on. For simplicity, the examples use the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ansible-collection-redhat-rhel_mgmt\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">python3-pyghmi\u003C/code> package is installed either on the control node or the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IPMI BMC that you want to control is accessible over network from the control node or the managed host (if not using \u003Ccode class=\"literal\">localhost\u003C/code> as the managed host). Note that the host whose BMC is being configured by the module is generally different from the managed host, as the module contacts the BMC over the network using the IPMI protocol.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have credentials to access BMC with an appropriate level of access.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Power management\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ensure machine is powered on\n      redhat.rhel_mgmt.ipmi_power:\n        user: \u003Cspan class=\"emphasis\">\u003Cem>&lt;admin_user&gt;\u003C/em>\u003C/span>\n        password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\n        state: on\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tWhen you run the playbook, Ansible returns \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 5. The Redfish modules in RHEL\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tThe Redfish modules for remote management of devices are now part of the \u003Ccode class=\"literal\">redhat.rhel_mgmt\u003C/code> Ansible collection. With the Redfish modules, you can easily use management automation on bare-metal servers and platform hardware by getting information about the servers or control them through an Out-Of-Band (OOB) controller, using the standard HTTPS transport and JSON format.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"con_the-redfish-modules_assembly_the-redfish-modules-in-rhel\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.1. The Redfish modules\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">redhat.rhel_mgmt\u003C/code> Ansible collection provides the Redfish modules to support hardware management in Ansible over Redfish. The \u003Ccode class=\"literal\">redhat.rhel_mgmt\u003C/code> collection is available in the \u003Ccode class=\"literal\">ansible-collection-redhat-rhel_mgmt\u003C/code> package. To install it, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_installing-the-rhel-mgmt-collection-by-using-the-cli_assembly_ansible-ipmi-modules-in-rhel\">Installing the redhat.rhel_mgmt Collection using the CLI\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following Redfish modules are available in the \u003Ccode class=\"literal\">redhat.rhel_mgmt\u003C/code> collection:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"strong strong\">\u003Cstrong>redfish_info\u003C/strong>\u003C/span>\u003C/code>: The \u003Ccode class=\"literal\">redfish_info\u003C/code> module retrieves information about the remote Out-Of-Band (OOB) controller such as systems inventory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"strong strong\">\u003Cstrong>redfish_command\u003C/strong>\u003C/span>\u003C/code>: The \u003Ccode class=\"literal\">redfish_command\u003C/code> module performs Out-Of-Band (OOB) controller operations like log management and user management, and power operations such as system restart, power on and off.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">\u003Cspan class=\"strong strong\">\u003Cstrong>redfish_config\u003C/strong>\u003C/span>\u003C/code>: The \u003Ccode class=\"literal\">redfish_config\u003C/code> module performs OOB controller operations such as changing OOB configuration, or setting the BIOS configuration.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_redfish-modules-parameters_assembly_the-redfish-modules-in-rhel\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.2. Redfish modules parameters\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe parameters used for the Redfish modules are:\n\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064660561440\" scope=\"col\">\u003Ccode class=\"literal\">redfish_info\u003C/code> parameters:\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064660560032\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660561440\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">baseuri\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660560032\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - Base URI of OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660561440\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">category\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660560032\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - List of categories to execute on OOB controller. The default value is [\"Systems\"].\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660561440\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">command\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660560032\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - List of commands to execute on OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660561440\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">username\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660560032\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsername for authentication to OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660561440\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064660560032\"> \u003Cp>\n\t\t\t\t\t\t\t\tPassword for authentication to OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064650863856\" scope=\"col\">\u003Ccode class=\"literal\">redfish_command\u003C/code> parameters:\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064647141792\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064650863856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">baseuri\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647141792\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - Base URI of OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064650863856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">category\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647141792\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - List of categories to execute on OOB controller. The default value is [\"Systems\"].\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064650863856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">command\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647141792\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - List of commands to execute on OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064650863856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">username\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647141792\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsername for authentication to OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064650863856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647141792\"> \u003Cp>\n\t\t\t\t\t\t\t\tPassword for authentication to OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064641210352\" scope=\"col\">\u003Ccode class=\"literal\">redfish_config\u003C/code> parameters:\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064641208944\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641210352\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">baseuri\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641208944\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - Base URI of OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641210352\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">category\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641208944\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - List of categories to execute on OOB controller. The default value is [\"Systems\"].\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641210352\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">command\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641208944\"> \u003Cp>\n\t\t\t\t\t\t\t\t(Mandatory) - List of commands to execute on OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641210352\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">username\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641208944\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsername for authentication to OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641210352\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">password\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641208944\"> \u003Cp>\n\t\t\t\t\t\t\t\tPassword for authentication to OOB controller.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641210352\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">bios_attributes\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064641208944\"> \u003Cp>\n\t\t\t\t\t\t\t\tBIOS attributes to update.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-the-redfish-info-module_assembly_the-redfish-modules-in-rhel\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.3. Using the \u003Ccode class=\"literal\">redfish_info\u003C/code> module\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe following example shows how to use the \u003Ccode class=\"literal\">redfish_info\u003C/code> module in a playbook to get information about the CPU inventory. For simplicity, the example uses the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ansible-collection-redhat-rhel_mgmt\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">python3-pyghmi\u003C/code> package is installed either on the control node or the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOOB controller access details.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage out-of-band controllers using Redfish APIs\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Get CPU inventory\n      redhat.rhel_mgmt.redfish_info:\n        baseuri: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;URI&gt;\u003C/em>\u003C/span>\"\n        username: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\"\n        password: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\"\n        category: Systems\n        command: GetCpuInventory\n      register: result\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tWhen you run the playbook, Ansible returns the CPU inventory details.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-the-redfish-command-module_assembly_the-redfish-modules-in-rhel\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.4. Using the \u003Ccode class=\"literal\">redfish_command\u003C/code> module\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe following example shows how to use the \u003Ccode class=\"literal\">redfish_command\u003C/code> module in a playbook to turn on a system. For simplicity, the example uses the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ansible-collection-redhat-rhel_mgmt\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">python3-pyghmi\u003C/code> package is installed either on the control node or the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOOB controller access details.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage out-of-band controllers using Redfish APIs\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Power on system\n      redhat.rhel_mgmt.redfish_command:\n        baseuri: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;URI&gt;\u003C/em>\u003C/span>\"\n        username: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\"\n        password: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\"\n        category: Systems\n        command: PowerOn\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system powers on.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-the-redfish-config-module_assembly_the-redfish-modules-in-rhel\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.5. Using the \u003Ccode class=\"literal\">redfish_config\u003C/code> module\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe following example shows how to use the \u003Ccode class=\"literal\">redfish_config\u003C/code> module in a playbook to configure a system to boot with UEFI. For simplicity, the example uses the same host as the Ansible control host and managed host, thus executing the modules on the same host where the playbook is executed.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ansible-collection-redhat-rhel_mgmt\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">python3-pyghmi\u003C/code> package is installed either on the control node or the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOOB controller access details.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manages out-of-band controllers using Redfish APIs\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Set BootMode to UEFI\n      redhat.rhel_mgmt.redfish_config:\n        baseuri: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;URI&gt;\u003C/em>\u003C/span>\"\n        username: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\"\n        password: \"\u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\"\n\tcategory: Systems\n        command: SetBiosAttributes\n        bios_attributes:\n          BootMode: Uefi\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system boot mode is set to UEFI.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/collections/ansible_collections/redhat/rhel_mgmt/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 6. Joining RHEL systems to an Active Directory by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIf your organization uses Microsoft Active Directory (AD) to centrally manage users, groups, and other resources, you can join your Red Hat Enterprise Linux (RHEL) host to this AD. For example, AD users can then log into RHEL and you can make services on the RHEL host available for authenticated AD users. By using the \u003Ccode class=\"literal\">ad_integration\u003C/code> RHEL system role, you can automate the integration of Red Hat Enterprise Linux system into an Active Directory (AD) domain.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">ad_integration\u003C/code> role is for deployments using direct AD integration without an Identity Management (IdM) environment. For IdM environments, use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> roles.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.1. Joining RHEL to an Active Directory domain by using the \u003Ccode class=\"literal\">ad_integration\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ad_integration\u003C/code> RHEL system role to automate the process of joining RHEL to an Active Directory (AD) domain.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node uses a DNS server that can resolve AD DNS entries.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCredentials of an AD account which has permissions to join computers to the domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe managed node can establish connections to AD domain controllers by using the following ports:\n\t\t\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 40%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064646940240\" scope=\"col\">Source Ports\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064646939152\" scope=\"col\">Destination Port\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064646938064\" scope=\"col\">Protocol\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064646936976\" scope=\"col\">Service\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t53\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP and TCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tDNS\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t389\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP and TCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tLDAP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t636\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tTCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tLDAPS\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t88\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP and TCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tKerberos\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t464\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP and TCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tKerberos password change requests\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t3268\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tTCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tLDAP Global Catalog\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t3269\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tTCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tLDAPS Global Catalog\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t123\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tNTP (if time synchronization is enabled)\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646940240\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646939152\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t323\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646938064\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064646936976\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tNTP (if time synchronization is enabled)\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">usr: administrator\npwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Active Directory integration\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Join an Active Directory\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ad_integration\n      vars:\n        ad_integration_user: \"{{ usr }}\"\n        ad_integration_password: \"{{ pwd }}\"\n        ad_integration_realm: \"ad.example.com\"\n        ad_integration_allow_rc4_crypto: false\n        ad_integration_timesync_source: \"time_server.ad.example.com\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ad_integration_allow_rc4_crypto: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tConfigures whether the role activates the \u003Ccode class=\"literal\">AD-SUPPORT\u003C/code> crypto policy on the managed node. By default, RHEL does not support the weak RC4 encryption but, if Kerberos in your AD still requires RC4, you can enable this encryption type by setting \u003Ccode class=\"literal\">ad_integration_allow_rc4_crypto: true\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tOmit this the variable or set it to \u003Ccode class=\"literal\">false\u003C/code> if Kerberos uses AES encryption.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ad_integration_timesync_source: \u003Cspan class=\"emphasis\">\u003Cem>&lt;time_server&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSpecifies the NTP server to use for time synchronization. Kerberos requires a synchronized time among AD domain controllers and domain members to prevent replay attacks. If you omit this variable, the \u003Ccode class=\"literal\">ad_integration\u003C/code> role does not utilize the \u003Ccode class=\"literal\">timesync\u003C/code> RHEL system role to configure time synchronization on the managed node.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck if AD users, such as \u003Ccode class=\"literal\">administrator\u003C/code>, are available locally on the managed node:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'getent passwd administrator@ad.example.com'\u003C/strong>\u003C/span>\nadministrator@ad.example.com:*:1450400500:1450400513:Administrator:/home/administrator@ad.example.com:/bin/bash\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ad_integration/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 7. Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tMany services, such as web servers, use TLS to encrypt connections with clients. These services require a private key and a certificate, and a trusted certificate authority (CA) which signs the certificate.\n\t\t\u003C/p>\u003Cp>\n\t\t\tBy using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role, you can automate the generation of private keys on managed nodes. Additionally, the role configures the \u003Ccode class=\"literal\">certmonger\u003C/code> service to send the certificate signing request (CSR) to a CA, and the service automatically renews the certificate before it expires.\n\t\t\u003C/p>\u003Cp>\n\t\t\tFor testing purposes, you can use the \u003Ccode class=\"literal\">certificate\u003C/code> role to create self-signed certificates instead of requesting a signed certificate from a CA.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.1. Requesting a new certificate from an IdM CA by using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf a Red Hat Enterprise Linux host is a member of a RHEL Identity Management (IdM) environment, you can request TLS certificates from the IdM certificate authority (CA) and use them in the services that run on this host. By using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role, you can automate the process of creating a private key and letting the \u003Ccode class=\"literal\">certmonger\u003C/code> service request a certificate from the CA. By default, \u003Ccode class=\"literal\">certmonger\u003C/code> will also renew the certificate before it expires.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node is a member of an IdM domain and the domain uses the IdM-integrated CA.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create certificates\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Create a self-signed certificate\n      ansible.builtin.include_role:\n        name: rhel-system-roles.certificate\n      vars:\n        certificate_requests:\n          - name: web-server\n            ca: ipa\n            dns: www.example.com\n            principal: HTTP/www.example.com@EXAMPLE.COM\n            run_before: systemctl stop httpd.service\n            run_after: systemctl start httpd.service\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;path_or_file_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tDefines the name or path of the generated private key and certificate file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tIf you set the variable to \u003Ccode class=\"literal\">web-server\u003C/code>, the role stores the private key in the \u003Ccode class=\"literal\">/etc/pki/tls/private/web-server.key\u003C/code> and the certificate in the \u003Ccode class=\"literal\">/etc/pki/tls/certs/web-server.crt\u003C/code> files.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tIf you set the variable to a path, such as \u003Ccode class=\"literal\">/tmp/web-server\u003C/code>, the role stores the private key in the \u003Ccode class=\"literal\">/tmp/web-server.key\u003C/code> and the certificate in the \u003Ccode class=\"literal\">/tmp/web-server.crt\u003C/code> files.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tNote that the directory you use must have the \u003Ccode class=\"literal\">cert_t\u003C/code> SELinux context set. You can use the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role to manage SELinux contexts.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca: ipa\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines that the role requests the certificate from an IdM CA.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dns: \u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname_or_list_of_hostnames&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the hostnames that the Subject Alternative Names (SAN) field in the issued certificate contains. You can use a wildcard (\u003Ccode class=\"literal\">*\u003C/code>) or specify multiple names in YAML list format.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">principal: \u003Cspan class=\"emphasis\">\u003Cem>&lt;kerberos_principal&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tOptional: Sets the Kerberos principal that should be included in the certificate.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">run_before: \u003Cspan class=\"emphasis\">\u003Cem>&lt;command&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tOptional: Defines a command that \u003Ccode class=\"literal\">certmonger\u003C/code> should execute before requesting the certificate from the CA.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">run_after: \u003Cspan class=\"emphasis\">\u003Cem>&lt;command&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tOptional: Defines a command that \u003Ccode class=\"literal\">certmonger\u003C/code> should execute after it received the issued certificate from the CA.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList the certificates that the \u003Ccode class=\"literal\">certmonger\u003C/code> service manages:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'getcert list'\u003C/strong>\u003C/span>\n...\nNumber of certificates and requests being tracked: 1.\nRequest ID '20240918142211':\n        status: MONITORING\n        stuck: no\n        key pair storage: type=FILE,location='/etc/pki/tls/private/web-server.key'\n        certificate: type=FILE,location='/etc/pki/tls/certs/web-server.crt'\n        CA: IPA\n        issuer: CN=Certificate Authority,O=EXAMPLE.COM\n        subject: CN=www.example.com\n        issued: 2024-09-18 16:22:11 CEST\n        expires: 2025-09-18 16:22:10 CEST\n        dns: www.example.com\n        key usage: digitalSignature,keyEncipherment\n        eku: id-kp-serverAuth,id-kp-clientAuth\n        pre-save command: systemctl stop httpd.service\n        post-save command: systemctl start httpd.service\n        track: yes\n        auto-renew: yes\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/certificate/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.2. Requesting a new self-signed certificate by using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf you require a TLS certificate for a test environment, you can use a self-signed certificate. By using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role, you can automate the process of creating a private key and letting the \u003Ccode class=\"literal\">certmonger\u003C/code> service create a self-signed certificate. By default, \u003Ccode class=\"literal\">certmonger\u003C/code> will also renew the certificate before it expires.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create certificates\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Create a self-signed certificate\n      ansible.builtin.include_role:\n        name: rhel-system-roles.certificate\n      vars:\n        certificate_requests:\n          - name: web-server\n            ca: self-sign\n            dns: test.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;path_or_file_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tDefines the name or path of the generated private key and certificate file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tIf you set the variable to \u003Ccode class=\"literal\">web-server\u003C/code>, the role stores the private key in the \u003Ccode class=\"literal\">/etc/pki/tls/private/web-server.key\u003C/code> and the certificate in the \u003Ccode class=\"literal\">/etc/pki/tls/certs/web-server.crt\u003C/code> files.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tIf you set the variable to a path, such as \u003Ccode class=\"literal\">/tmp/web-server\u003C/code>, the role stores the private key in the \u003Ccode class=\"literal\">/tmp/web-server.key\u003C/code> and the certificate in the \u003Ccode class=\"literal\">/tmp/web-server.crt\u003C/code> files.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tNote that the directory you use must have the \u003Ccode class=\"literal\">cert_t\u003C/code> SELinux context set. You can use the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role to manage SELinux contexts.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca: self-sign\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines that the role created a self-signed certificate.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dns: \u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname_or_list_of_hostnames&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the hostnames that the Subject Alternative Names (SAN) field in the issued certificate contains. You can use a wildcard (\u003Ccode class=\"literal\">*\u003C/code>) or specify multiple names in YAML list format.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList the certificates that the \u003Ccode class=\"literal\">certmonger\u003C/code> service manages:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'getcert list'\u003C/strong>\u003C/span>\n...\nNumber of certificates and requests being tracked: 1.\nRequest ID '20240918133610':\n\tstatus: MONITORING\n\tstuck: no\n\tkey pair storage: type=FILE,location='/etc/pki/tls/private/web-server.key'\n\tcertificate: type=FILE,location='/etc/pki/tls/certs/web-server.crt'\n\tCA: local\n\tissuer: CN=c32b16d7-5b1a4c5a-a953a711-c3ca58fb,CN=Local Signing Authority\n\tsubject: CN=test.example.com\n\tissued: 2024-09-18 15:36:10 CEST\n\texpires: 2025-09-18 15:36:09 CEST\n\tdns: test.example.com\n\tkey usage: digitalSignature,keyEncipherment\n\teku: id-kp-serverAuth,id-kp-clientAuth\n\tpre-save command:\n\tpost-save command:\n\ttrack: yes\n\tauto-renew: yes\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/certificate/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 8. Installing and configuring web console by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tWith the \u003Ccode class=\"literal\">cockpit\u003C/code> RHEL system role, you can automatically deploy and enable the web console on multiple RHEL systems.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"proc_installing-the-web-console-by-using-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.1. Installing the web console by using the \u003Ccode class=\"literal\">cockpit\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">cockpit\u003C/code> system role to automate installing and enabling the RHEL web console on multiple systems.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn this example, you use the \u003Ccode class=\"literal\">cockpit\u003C/code> system role to:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tInstall the RHEL web console.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tConfigure the web console to use a custom port number (9050/tcp). By default, the web console uses port 9090.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAllow the \u003Ccode class=\"literal\">firewalld\u003C/code> and \u003Ccode class=\"literal\">selinux\u003C/code> system roles to configure the system for opening new ports.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSet the web console to use a certificate from the \u003Ccode class=\"literal\">ipa\u003C/code> trusted certificate authority instead of using a self-signed certificate.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou do not have to call the \u003Ccode class=\"literal\">firewall\u003C/code> or \u003Ccode class=\"literal\">certificate\u003C/code> system roles in the playbook to manage the firewall or create the certificate. The \u003Ccode class=\"literal\">cockpit\u003C/code> system role calls them automatically as needed.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example, \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage the RHEL web console\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Install RHEL web console\n      ansible.builtin.include_role:\n        name: rhel-system-roles.cockpit\n      vars:\n        cockpit_packages: default\n        cockpit_port: 9050\n        cockpit_manage_selinux: true\n        cockpit_manage_firewall: true\n        cockpit_certificates:\n          - name: /etc/cockpit/ws-certs.d/01-certificate\n            dns: ['localhost', 'www.example.com']\n            ca: ipa\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cockpit_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tAllow using the \u003Ccode class=\"literal\">selinux\u003C/code> system role to configure SELinux for setting up the correct port permissions on the \u003Ccode class=\"literal\">websm_port_t\u003C/code> SELinux type.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cockpit_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tAllow the \u003Ccode class=\"literal\">cockpit\u003C/code> system role to use the \u003Ccode class=\"literal\">firewalld\u003C/code> system role for adding ports.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cockpit_certificates: &lt;YAML_dictionary&gt;\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tBy default, the RHEL web console uses a self-signed certificate. Alternatively, you can add the \u003Ccode class=\"literal\">cockpit_certificates\u003C/code> variable to the playbook and configure the role to request certificates from an IdM certificate authority (CA) or to use an existing certificate and private key that is available on the managed node.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.cockpit/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.cockpit/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/cockpit\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">Requesting certificates using RHEL system roles\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 9. Setting a custom cryptographic policy by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tCustom cryptographic policies are a set of rules and configurations that manage the use of cryptographic algorithms and protocols. These policies help you to maintain a protected, consistent, and manageable security environment across multiple systems and applications.\n\t\t\u003C/p>\u003Cp>\n\t\t\tBy using the \u003Ccode class=\"literal\">crypto_policies\u003C/code> RHEL system role, you can quickly and consistently configure custom cryptographic policies across many operating systems in an automated fashion.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.1. Enhancing security with the \u003Ccode class=\"literal\">FUTURE\u003C/code> cryptographic policy using the \u003Ccode class=\"literal\">crypto_policies\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">crypto_policies\u003C/code> RHEL system role to configure the \u003Ccode class=\"literal\">FUTURE\u003C/code> policy on your managed nodes. This policy helps to achieve for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFuture-proofing against emerging threats: anticipates advancements in computational power.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnhanced security: stronger encryption standards require longer key lengths and more secure algorithms.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCompliance with high-security standards: for example in healthcare, telco, and finance the data sensitivity is high, and availability of strong cryptography is critical.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tTypically, \u003Ccode class=\"literal\">FUTURE\u003C/code> is suitable for environments handling highly sensitive data, preparing for future regulations, or adopting long-term security strategies.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tLegacy systems or software does not have to support the more modern and stricter algorithms and protocols enforced by the \u003Ccode class=\"literal\">FUTURE\u003C/code> policy. For example, older systems might not support TLS 1.3 or larger key sizes. This could lead to compatibility problems.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tAlso, using strong algorithms usually increases the computational workload, which could negatively affect your system performance.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure cryptographic policies\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure the FUTURE cryptographic security policy on the managed node\n      ansible.builtin.include_role:\n        name: rhel-system-roles.crypto_policies\n      vars:\n        - crypto_policies_policy: \u003Cspan class=\"emphasis\">\u003Cem>FUTURE\u003C/em>\u003C/span>\n        - crypto_policies_reboot_ok: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">crypto_policies_policy: \u003Cspan class=\"emphasis\">\u003Cem>FUTURE\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tConfigures the required cryptographic policy (\u003Ccode class=\"literal\">FUTURE\u003C/code>) on the managed node. It can be either the base policy or a base policy with some sub-policies. The specified base policy and sub-policies have to be available on the managed node. The default value is \u003Ccode class=\"literal\">null\u003C/code>. It means that the configuration is not changed and the \u003Ccode class=\"literal\">crypto_policies\u003C/code> RHEL system role will only collect the Ansible facts.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">crypto_policies_reboot_ok: \u003Cspan class=\"emphasis\">\u003Cem>true\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tCauses the system to reboot after the cryptographic policy change to make sure all of the services and applications will read the new configuration files. The default value is \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tBecause the \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> system-wide subpolicy contains further restrictions for cryptographic algorithms required by the Common Criteria (CC) certification, the system is less interoperable after you set it. For example, you cannot use RSA and DH keys shorter than 3072 bits, additional SSH algorithms, and several TLS groups. Setting \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> also prevents connecting to Red Hat Content Delivery Network (CDN) structure. Furthermore, you cannot integrate Active Directory (AD) into the IdM deployments that use \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code>, communication between RHEL hosts using \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> and AD domains might not work, or some AD accounts might not be able to authenticate.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tNote that your \u003Cspan class=\"strong strong\">\u003Cstrong>system is not CC-compliant\u003C/strong>\u003C/span> after you set the \u003Ccode class=\"literal\">FIPS:OSPP\u003C/code> cryptographic subpolicy. The only correct way to make your RHEL system compliant with the CC standard is by following the guidance provided in the \u003Ccode class=\"literal\">cc-config\u003C/code> package. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/compliance_activities_and_gov_standards#common-criteria-1\">Common Criteria\u003C/a> section in the Compliance Activities and Government Standards Knowledgebase article for a list of certified RHEL versions, validation reports, and links to CC guides hosted at the \u003Ca class=\"link\" href=\"https://www.niap-ccevs.org/\">National Information Assurance Partnership (NIAP)\u003C/a> website.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node, create another playbook named, for example, \u003Ccode class=\"literal\">verify_playbook.yml\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Verification\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Verify active cryptographic policy\n      ansible.builtin.include_role:\n        name: rhel-system-roles.crypto_policies\n    - name: Display the currently active cryptographic policy\n      ansible.builtin.debug:\n        var: crypto_policies_active\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">crypto_policies_active\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tAn exported Ansible fact that contains the currently active policy name in the format as accepted by the \u003Ccode class=\"literal\">crypto_policies_policy\u003C/code> variable.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/verify_playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/verify_playbook.yml\u003C/strong>\u003C/span>\nTASK [debug] **************************\nok: [host] =&gt; {\n    \"crypto_policies_active\": \"FUTURE\"\n}\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">crypto_policies_active\u003C/code> variable shows the active policy on the managed node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.crypto_policies/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/crypto_policies/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> and \u003Ccode class=\"literal\">crypto-policies(7)\u003C/code> manual pages\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 10. Configuring \u003Ccode class=\"literal\">firewalld\u003C/code> by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tRHEL system roles is a set of contents for the Ansible automation utility. This content together with the Ansible automation utility provides a consistent configuration interface to remotely manage multiple systems at once.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package contains the \u003Ccode class=\"literal\">rhel-system-roles.firewall\u003C/code> RHEL system role. This role was introduced for automated configurations of the \u003Ccode class=\"literal\">firewalld\u003C/code> service.\n\t\t\u003C/p>\u003Cp>\n\t\t\tWith the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role you can configure many different \u003Ccode class=\"literal\">firewalld\u003C/code> parameters, for example:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tZones\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe services for which packets should be allowed\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tGranting, rejection, or dropping of traffic access to ports\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tForwarding of ports or port ranges for a zone\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"proc_resetting-the-firewalld-settings-using-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.1. Resetting the \u003Ccode class=\"literal\">firewalld\u003C/code> settings by using the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tOver time, updates to your firewall configuration can accumulate to the point, where they could lead to unintended security risks. With the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role, you can reset the \u003Ccode class=\"literal\">firewalld\u003C/code> settings to their default state in an automated fashion. This way you can efficiently remove any unintentional or insecure firewall rules and simplify their management.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Reset firewalld example\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Reset firewalld\n      ansible.builtin.include_role:\n        name: rhel-system-roles.firewall\n      vars:\n        firewall:\n          - previous: replaced\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">previous: replaced\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tRemoves all existing user-defined settings and resets the \u003Ccode class=\"literal\">firewalld\u003C/code> settings to defaults. If you combine the \u003Ccode class=\"literal\">previous:replaced\u003C/code> parameter with other settings, the \u003Ccode class=\"literal\">firewall\u003C/code> role removes all existing settings before applying new ones.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun this command on the control node to remotely check that all firewall configuration on your managed node was reset to its default values:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.command -a 'firewall-cmd --list-all-zones'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/firewall/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_forwarding-incoming-traffic-from-one-local-port-to-a-different-local-port_assembly_configuring-firewalld-using-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.2. Forwarding incoming traffic in \u003Ccode class=\"literal\">firewalld\u003C/code> from one local port to a different local port by using the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role to remotely configure forwarding of incoming traffic from one local port to a different local port.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, if you have an environment where multiple services co-exist on the same machine and need the same default port, there are likely to become port conflicts. These conflicts can disrupt services and cause a downtime. With the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role, you can efficiently forward traffic to alternative ports to ensure that your services can run simultaneously without modification to their configuration.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure firewalld\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Forward incoming traffic on port 8080 to 443\n      ansible.builtin.include_role:\n        name: rhel-system-roles.firewall\n      vars:\n        firewall:\n          - forward_port: 8080/tcp;443;\n            state: enabled\n            runtime: true\n            permanent: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">forward_port: 8080/tcp;443\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tTraffic coming to the local port 8080 using the TCP protocol is forwarded to the port 443.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">runtime: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tEnables changes in the runtime configuration. The default is set to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node, run the following command to remotely check the forwarded-ports on your managed node:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.command -a 'firewall-cmd --list-forward-ports'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\nport=8080:proto=tcp:toport=443:toaddr=\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/firewall/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-dmz-firewalld-zone-by-using-the-firewalld-rhel-system-role_assembly_configuring-firewalld-using-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.3. Configuring a \u003Ccode class=\"literal\">firewalld\u003C/code> DMZ zone by using the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs a system administrator, you can use the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role to configure a \u003Ccode class=\"literal\">dmz\u003C/code> zone on the \u003Cspan class=\"strong strong\">\u003Cstrong>enp1s0\u003C/strong>\u003C/span> interface to permit \u003Ccode class=\"literal\">HTTPS\u003C/code> traffic to the zone. In this way, you enable external users to access your web servers.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure firewalld\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Creating a DMZ with access to HTTPS port and masquerading for hosts in DMZ\n      ansible.builtin.include_role:\n        name: rhel-system-roles.firewall\n      vars:\n        firewall:\n          - zone: dmz\n            interface: enp1s0\n            service: https\n            state: enabled\n            runtime: true\n            permanent: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node, run the following command to remotely check the information about the \u003Ccode class=\"literal\">dmz\u003C/code> zone on your managed node:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.command -a 'firewall-cmd --zone=dmz --list-all'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\ndmz (active)\n  target: default\n  icmp-block-inversion: no\n  \u003Cspan class=\"strong strong\">\u003Cstrong>interfaces: enp1s0\u003C/strong>\u003C/span>\n  sources:\n  \u003Cspan class=\"strong strong\">\u003Cstrong>services: https\u003C/strong>\u003C/span> ssh\n  ports:\n  protocols:\n  forward: no\n  masquerade: no\n  forward-ports:\n  source-ports:\n  icmp-blocks:\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.firewall/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/firewall/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 11. Configuring a high-availability cluster by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tWith the \u003Ccode class=\"literal\">ha_cluster\u003C/code> system role, you can configure and manage a high-availability cluster that uses the Pacemaker high availability cluster resource manager.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.1. Variables of the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn an \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook, you define the variables for a high availability cluster according to the requirements of your cluster deployment.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe variables you can set for an \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role are as follows:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_enable_repos\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tA boolean flag that enables the repositories containing the packages that are needed by the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role. When this variable is set to \u003Ccode class=\"literal\">true\u003C/code>, the default value, you must have active subscription coverage for RHEL and the RHEL High Availability Add-On on the systems that you will use as your cluster members or the system role will fail.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_enable_repos_resilient_storage\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t(RHEL 9.4 and later) A boolean flag that enables the repositories containing resilient storage packages, such as \u003Ccode class=\"literal\">dlm\u003C/code> or \u003Ccode class=\"literal\">gfs2\u003C/code>. For this option to take effect, \u003Ccode class=\"literal\">ha_cluster_enable_repos\u003C/code> must be set to \u003Ccode class=\"literal\">true\u003C/code>. The default value of this variable is \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.2 and later) A boolean flag that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall. When \u003Ccode class=\"literal\">ha_cluster_manage_firewall\u003C/code> is set to \u003Ccode class=\"literal\">true\u003C/code>, the firewall high availability service and the \u003Ccode class=\"literal\">fence-virt\u003C/code> port are enabled. When \u003Ccode class=\"literal\">ha_cluster_manage_firewall\u003C/code> is set to \u003Ccode class=\"literal\">false\u003C/code>, the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role does not manage the firewall. If your system is running the \u003Ccode class=\"literal\">firewalld\u003C/code> service, you must set the parameter to \u003Ccode class=\"literal\">true\u003C/code> in your playbook.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">ha_cluster_manage_firewall\u003C/code> parameter to add ports, but you cannot use the parameter to remove ports. To remove ports, use the \u003Ccode class=\"literal\">firewall\u003C/code> system role directly.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAs of RHEL 9.2, the firewall is no longer configured by default, because it is configured only when \u003Ccode class=\"literal\">ha_cluster_manage_firewall\u003C/code> is set to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.2 and later) A boolean flag that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports belonging to the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role. When \u003Ccode class=\"literal\">ha_cluster_manage_selinux\u003C/code> is set to \u003Ccode class=\"literal\">true\u003C/code>, the ports belonging to the firewall high availability service are associated with the SELinux port type \u003Ccode class=\"literal\">cluster_port_t\u003C/code>. When \u003Ccode class=\"literal\">ha_cluster_manage_selinux\u003C/code> is set to \u003Ccode class=\"literal\">false\u003C/code>, the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role does not manage SELinux.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf your system is running the \u003Ccode class=\"literal\">selinux\u003C/code> service, you must set this parameter to \u003Ccode class=\"literal\">true\u003C/code> in your playbook. Firewall configuration is a prerequisite for managing SELinux. If the firewall is not installed, the managing SELinux policy is skipped.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">ha_cluster_manage_selinux\u003C/code> parameter to add policy, but you cannot use the parameter to remove policy. To remove policy, use the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role directly.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_present\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tA boolean flag which, if set to \u003Ccode class=\"literal\">true\u003C/code>, determines that HA cluster will be configured on the hosts according to the variables passed to the role. Any cluster configuration not specified in the playbook and not supported by the role will be lost.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf \u003Ccode class=\"literal\">ha_cluster_cluster_present\u003C/code> is set to \u003Ccode class=\"literal\">false\u003C/code>, all HA cluster configuration will be removed from the target hosts.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe default value of this variable is \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe following example playbook removes all cluster configuration on \u003Ccode class=\"literal\">node1\u003C/code> and \u003Ccode class=\"literal\">node2\u003C/code>\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">- hosts: node1 node2\n  vars:\n    ha_cluster_cluster_present: false\n\n  roles:\n    - rhel-system-roles.ha_cluster\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_start_on_boot\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tA boolean flag that determines whether cluster services will be configured to start on boot. The default value of this variable is \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_install_cloud_agents\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t(RHEL 9.5 and later) A boolean flag that determines whether resource and fence agents for cloud environments are installed. These agents are not installed by default. Alternately, you can specify the packages for cloud environments by using the \u003Ccode class=\"literal\">ha_cluster_fence_agent_packages\u003C/code> and \u003Ccode class=\"literal\">ha_cluster_extra_packages\u003C/code> variables. The default value of this variable is \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_fence_agent_packages\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tList of fence agent packages to install. The default value of this variable is \u003Ccode class=\"literal\">fence-agents-all\u003C/code>, \u003Ccode class=\"literal\">fence-virt\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_extra_packages\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tList of additional packages to be installed. The default value of this variable is no packages.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis variable can be used to install additional packages not installed automatically by the role, for example custom resource agents.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIt is possible to specify fence agents as members of this list. However, \u003Ccode class=\"literal\">ha_cluster_fence_agent_packages\u003C/code> is the recommended role variable to use for specifying fence agents, so that its default value is overridden.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tA string value that specifies the password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster. To protect sensitive data, vault encrypt the password, as described in \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>. There is no default password value, and this variable must be specified.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_qdevice_password\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t(RHEL 9.3 and later) A string value that specifies the password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user for a quorum device. This parameter is needed only if the \u003Ccode class=\"literal\">ha_cluster_quorum\u003C/code> parameter is configured to use a quorum device of type \u003Ccode class=\"literal\">net\u003C/code> and the password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user on the quorum device is different from the password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user specified with the \u003Ccode class=\"literal\">ha_cluster_hacluster_password\u003C/code> parameter. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster. To protect sensitive data, vault encrypt the password, as described in \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>. There is no default value for this password.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_corosync_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe path to Corosync \u003Ccode class=\"literal\">authkey\u003C/code> file, which is the authentication and encryption key for Corosync communication. It is highly recommended that you have a unique \u003Ccode class=\"literal\">authkey\u003C/code> value for each cluster. The key should be 256 bytes of random data.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf you specify a key for this variable, it is recommended that you vault encrypt the key, as described in \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf no key is specified, a key already present on the nodes will be used. If nodes do not have the same key, a key from one node will be distributed to other nodes so that all nodes have the same key. If no node has a key, a new key will be generated and distributed to the nodes.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf this variable is set, \u003Ccode class=\"literal\">ha_cluster_regenerate_keys\u003C/code> is ignored for this key.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe default value of this variable is null.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_pacemaker_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe path to the Pacemaker \u003Ccode class=\"literal\">authkey\u003C/code> file, which is the authentication and encryption key for Pacemaker communication. It is highly recommended that you have a unique \u003Ccode class=\"literal\">authkey\u003C/code> value for each cluster. The key should be 256 bytes of random data.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf you specify a key for this variable, it is recommended that you vault encrypt the key, as described in \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf no key is specified, a key already present on the nodes will be used. If nodes do not have the same key, a key from one node will be distributed to other nodes so that all nodes have the same key. If no node has a key, a new key will be generated and distributed to the nodes.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf this variable is set, \u003Ccode class=\"literal\">ha_cluster_regenerate_keys\u003C/code> is ignored for this key.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe default value of this variable is null.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_fence_virt_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe path to the \u003Ccode class=\"literal\">fence-virt\u003C/code> or \u003Ccode class=\"literal\">fence-xvm\u003C/code> pre-shared key file, which is the location of the authentication key for the \u003Ccode class=\"literal\">fence-virt\u003C/code> or \u003Ccode class=\"literal\">fence-xvm\u003C/code> fence agent.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf you specify a key for this variable, it is recommended that you vault encrypt the key, as described in \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf no key is specified, a key already present on the nodes will be used. If nodes do not have the same key, a key from one node will be distributed to other nodes so that all nodes have the same key. If no node has a key, a new key will be generated and distributed to the nodes. If the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role generates a new key in this fashion, you should copy the key to your nodes' hypervisor to ensure that fencing works.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf this variable is set, \u003Ccode class=\"literal\">ha_cluster_regenerate_keys\u003C/code> is ignored for this key.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe default value of this variable is null.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_pcsd_public_key_srcr\u003C/code>, \u003Ccode class=\"literal\">ha_cluster_pcsd_private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe path to the \u003Ccode class=\"literal\">pcsd\u003C/code> TLS certificate and private key. If this is not specified, a certificate-key pair already present on the nodes will be used. If a certificate-key pair is not present, a random new one will be generated.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf you specify a private key value for this variable, it is recommended that you vault encrypt the key, as described in \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf these variables are set, \u003Ccode class=\"literal\">ha_cluster_regenerate_keys\u003C/code> is ignored for this certificate-key pair.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe default value of these variables is null.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_pcsd_certificates\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.2 and later) Creates a \u003Ccode class=\"literal\">pcsd\u003C/code> private key and certificate using the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf your system is not configured with a \u003Ccode class=\"literal\">pcsd\u003C/code> private key and certificate, you can create them in one of two ways:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ha_cluster_pcsd_certificates\u003C/code> variable. When you set the \u003Ccode class=\"literal\">ha_cluster_pcsd_certificates\u003C/code> variable, the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role is used internally and it creates the private key and certificate for \u003Ccode class=\"literal\">pcsd\u003C/code> as defined.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tDo not set the \u003Ccode class=\"literal\">ha_cluster_pcsd_public_key_src\u003C/code>, \u003Ccode class=\"literal\">ha_cluster_pcsd_private_key_src\u003C/code>, or the \u003Ccode class=\"literal\">ha_cluster_pcsd_certificates\u003C/code> variables. If you do not set any of these variables, the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role will create \u003Ccode class=\"literal\">pcsd\u003C/code> certificates by means of \u003Ccode class=\"literal\">pcsd\u003C/code> itself. The value of \u003Ccode class=\"literal\">ha_cluster_pcsd_certificates\u003C/code> is set to the value of the variable \u003Ccode class=\"literal\">certificate_requests\u003C/code> as specified in the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role. For more information about the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">Requesting certificates using RHEL system roles\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe following operational considerations apply to the use of the \u003Ccode class=\"literal\">ha_cluster_pcsd_certificate\u003C/code> variable:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tUnless you are using IPA and joining the systems to an IPA domain, the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role creates self-signed certificates. In this case, you must explicitly configure trust settings outside of the context of RHEL system roles. System roles do not support configuring trust settings.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tWhen you set the \u003Ccode class=\"literal\">ha_cluster_pcsd_certificates\u003C/code> variable, do not set the \u003Ccode class=\"literal\">ha_cluster_pcsd_public_key_src\u003C/code> and \u003Ccode class=\"literal\">ha_cluster_pcsd_private_key_src\u003C/code> variables.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tWhen you set the \u003Ccode class=\"literal\">ha_cluster_pcsd_certificates\u003C/code> variable, \u003Ccode class=\"literal\">ha_cluster_regenerate_keys\u003C/code> is ignored for this certificate - key pair.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe default value of this variable is \u003Ccode class=\"literal\">[]\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that creates TLS certificates and key files in a high availability cluster, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Creating pcsd TLS certificates and key files for a high availability cluster\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_regenerate_keys\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tA boolean flag which, when set to \u003Ccode class=\"literal\">true\u003C/code>, determines that pre-shared keys and TLS certificates will be regenerated. For more information about when keys and certificates will be regenerated, see the descriptions of the \u003Ccode class=\"literal\">ha_cluster_corosync_key_src\u003C/code>, \u003Ccode class=\"literal\">ha_cluster_pacemaker_key_src\u003C/code>, \u003Ccode class=\"literal\">ha_cluster_fence_virt_key_src\u003C/code>, \u003Ccode class=\"literal\">ha_cluster_pcsd_public_key_src\u003C/code>, and \u003Ccode class=\"literal\">ha_cluster_pcsd_private_key_src\u003C/code> variables.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe default value of this variable is \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_pcs_permission_list\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tConfigures permissions to manage a cluster using \u003Ccode class=\"literal\">pcsd\u003C/code>. The items you configure with this variable are as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">type\u003C/code> - \u003Ccode class=\"literal\">user\u003C/code> or \u003Ccode class=\"literal\">group\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">name\u003C/code> - user or group name\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">allow_list\u003C/code> - Allowed actions for the specified user or group:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">read\u003C/code> - View cluster status and settings\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">write\u003C/code> - Modify cluster settings except permissions and ACLs\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">grant\u003C/code> - Modify cluster permissions and ACLs\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">full\u003C/code> - Unrestricted access to a cluster including adding and removing nodes and access to keys and certificates\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the \u003Ccode class=\"literal\">ha_cluster_pcs_permission_list\u003C/code> variable and its default values are as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_pcs_permission_list:\n  - type: group\n    name: hacluster\n    allow_list:\n      - grant\n      - read\n      - write\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe name of the cluster. This is a string value with a default of \u003Ccode class=\"literal\">my-cluster\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_transport\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.1 and later) Sets the cluster transport method. The items you configure with this variable are as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">type\u003C/code> (optional) - Transport type: \u003Ccode class=\"literal\">knet\u003C/code>, \u003Ccode class=\"literal\">udp\u003C/code>, or \u003Ccode class=\"literal\">udpu\u003C/code>. The \u003Ccode class=\"literal\">udp\u003C/code> and \u003Ccode class=\"literal\">udpu\u003C/code> transport types support only one link. Encryption is always disabled for \u003Ccode class=\"literal\">udp\u003C/code> and \u003Ccode class=\"literal\">udpu\u003C/code>. Defaults to \u003Ccode class=\"literal\">knet\u003C/code> if not specified.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries with transport options.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">links\u003C/code> (optional) - List of list of name-value dictionaries. Each list of name-value dictionaries holds options for one Corosync link. It is recommended that you set the \u003Ccode class=\"literal\">linknumber\u003C/code> value for each link. Otherwise, the first list of dictionaries is assigned by default to the first link, the second one to the second link, and so on.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">compression\u003C/code> (optional) - List of name-value dictionaries configuring transport compression. Supported only with the \u003Ccode class=\"literal\">knet\u003C/code> transport type.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">crypto\u003C/code> (optional) - List of name-value dictionaries configuring transport encryption. By default, encryption is enabled. Supported only with the \u003Ccode class=\"literal\">knet\u003C/code> transport type.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor a list of allowed options, see the \u003Ccode class=\"literal\">pcs -h cluster setup\u003C/code> help page or the \u003Ccode class=\"literal\">setup\u003C/code> description in the \u003Ccode class=\"literal\">cluster\u003C/code> section of the \u003Ccode class=\"literal\">pcs\u003C/code>(8) man page. For more detailed descriptions, see the \u003Ccode class=\"literal\">corosync.conf\u003C/code>(5) man page.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the \u003Ccode class=\"literal\">ha_cluster_transport\u003C/code> variable is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_transport:\n  type: knet\n  options:\n    - name: option1_name\n      value: option1_value\n    - name: option2_name\n      value: option2_value\n  links:\n    -\n      - name: option1_name\n        value: option1_value\n      - name: option2_name\n        value: option2_value\n    -\n      - name: option1_name\n        value: option1_value\n      - name: option2_name\n        value: option2_value\n  compression:\n    - name: option1_name\n      value: option1_value\n    - name: option2_name\n      value: option2_value\n  crypto:\n    - name: option1_name\n      value: option1_value\n    - name: option2_name\n      value: option2_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that configures a transport method, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring Corosync values in a high availability cluster\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_totem\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.1 and later) Configures Corosync totem. For a list of allowed options, see the \u003Ccode class=\"literal\">pcs -h cluster setup\u003C/code> help page or the \u003Ccode class=\"literal\">setup\u003C/code> description in the \u003Ccode class=\"literal\">cluster\u003C/code> section of the \u003Ccode class=\"literal\">pcs\u003C/code>(8) man page. For a more detailed description, see the \u003Ccode class=\"literal\">corosync.conf\u003C/code>(5) man page.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the \u003Ccode class=\"literal\">ha_cluster_totem\u003C/code> variable is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_totem:\n  options:\n    - name: option1_name\n      value: option1_value\n    - name: option2_name\n      value: option2_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that configures a Corosync totem, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring Corosync values in a high availability cluster\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_quorum\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.1 and later) Configures cluster quorum. You can configure the following items for cluster quorum:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries configuring quorum. Allowed options are: \u003Ccode class=\"literal\">auto_tie_breaker\u003C/code>, \u003Ccode class=\"literal\">last_man_standing\u003C/code>, \u003Ccode class=\"literal\">last_man_standing_window\u003C/code>, and \u003Ccode class=\"literal\">wait_for_all\u003C/code>. For information about quorum options, see the \u003Ccode class=\"literal\">votequorum\u003C/code>(5) man page.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">device\u003C/code> (optional) - (RHEL 9.2 and later) Configures the cluster to use a quorum device. By default, no quorum device is used.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">model\u003C/code> (mandatory) - Specifies a quorum device model. Only \u003Ccode class=\"literal\">net\u003C/code> is supported\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">model_options\u003C/code> (optional) - List of name-value dictionaries configuring the specified quorum device model. For model \u003Ccode class=\"literal\">net\u003C/code>, you must specify \u003Ccode class=\"literal\">host\u003C/code> and \u003Ccode class=\"literal\">algorithm\u003C/code> options.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">pcs-address\u003C/code> option to set a custom \u003Ccode class=\"literal\">pcsd\u003C/code> address and port to connect to the \u003Ccode class=\"literal\">qnetd\u003C/code> host. If you do not specify this option, the role connects to the default \u003Ccode class=\"literal\">pcsd\u003C/code> port on the \u003Ccode class=\"literal\">host\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">generic_options\u003C/code> (optional) - List of name-value dictionaries setting quorum device options that are not model specific.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">heuristics_options\u003C/code> (optional) - List of name-value dictionaries configuring quorum device heuristics.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tFor information about quorum device options, see the \u003Ccode class=\"literal\">corosync-qdevice\u003C/code>(8) man page. The generic options are \u003Ccode class=\"literal\">sync_timeout\u003C/code> and \u003Ccode class=\"literal\">timeout\u003C/code>. For model \u003Ccode class=\"literal\">net\u003C/code> options see the \u003Ccode class=\"literal\">quorum.device.net\u003C/code> section. For heuristics options, see the \u003Ccode class=\"literal\">quorum.device.heuristics\u003C/code> section.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tTo regenerate a quorum device TLS certificate, set the \u003Ccode class=\"literal\">ha_cluster_regenerate_keys\u003C/code> variable to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the \u003Ccode class=\"literal\">ha_cluster_quorum\u003C/code> variable is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_quorum:\n  options:\n    - name: option1_name\n      value: option1_value\n    - name: option2_name\n      value: option2_value\n  device:\n    model: string\n    model_options:\n      - name: option1_name\n        value: option1_value\n      - name: option2_name\n        value: option2_value\n    generic_options:\n      - name: option1_name\n        value: option1_value\n      - name: option2_name\n        value: option2_value\n    heuristics_options:\n      - name: option1_name\n        value: option1_value\n      - name: option2_name\n        value: option2_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that configures cluster quorum, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring Corosync values in a high availability cluster\u003C/a>. For an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that configures a cluster using a quorum device, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a high availability cluster using a quorum device\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_sbd_enabled\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t(RHEL 9.1 and later) A boolean flag which determines whether the cluster can use the SBD node fencing mechanism. The default value of this variable is \u003Ccode class=\"literal\">false\u003C/code>. For example \u003Ccode class=\"literal\">ha_cluster\u003C/code> system role playbooks that enable SBD, see \u003Ca class=\"link\" href=\"#configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.11. Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable\">Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable\u003C/a> and \u003Ca class=\"link\" href=\"#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable\">Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable\u003C/a>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_sbd_options\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.1 and later) List of name-value dictionaries specifying SBD options. For information about these options, see the \u003Ccode class=\"literal\">Configuration via environment\u003C/code> section of the \u003Ccode class=\"literal\">sbd\u003C/code>(8) man page.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tSupported options are:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">delay-start\u003C/code> - defaults to \u003Ccode class=\"literal\">false\u003C/code>, documented as \u003Ccode class=\"literal\">SBD_DELAY_START\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">startmode\u003C/code> - defaults to \u003Ccode class=\"literal\">always\u003C/code>, documented as \u003Ccode class=\"literal\">SBD_START_MODE\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">timeout-action\u003C/code> - defaults to \u003Ccode class=\"literal\">flush,reboot\u003C/code>, documented as \u003Ccode class=\"literal\">SBD_TIMEOUT_ACTION\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">watchdog-timeout\u003C/code> - defaults to \u003Ccode class=\"literal\">5\u003C/code>, documented as \u003Ccode class=\"literal\">SBD_WATCHDOG_TIMEOUT\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tWatchdog and SBD devices can be configured on a node to node basis in one of two variables:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code>, which you define in a playbook file (RHEL 9.5 and later). For an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that uses the \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> variable to configure node by node SBD options, see \u003Ca class=\"link\" href=\"#configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.11. Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable\">Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ha_cluster\u003C/code>, which you define in an inventory file. For an example procedure that configures node to node SBD options in an inventory file, see \u003Ca class=\"link\" href=\"#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable\">Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable\u003C/a>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_properties\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tList of sets of cluster properties for Pacemaker cluster-wide configuration. Only one set of cluster properties is supported.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a set of cluster properties is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_cluster_properties:\n  - attrs:\n      - name: property1_name\n        value: property1_value\n      - name: property2_name\n        value: property2_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default, no properties are set.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe following example playbook configures a cluster consisting of \u003Ccode class=\"literal\">node1\u003C/code> and \u003Ccode class=\"literal\">node2\u003C/code> and sets the \u003Ccode class=\"literal\">stonith-enabled\u003C/code> and \u003Ccode class=\"literal\">no-quorum-policy\u003C/code> cluster properties.\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">- hosts: node1 node2\n  vars:\n    ha_cluster_cluster_name: my-new-cluster\n    ha_cluster_hacluster_password: password\n    ha_cluster_cluster_properties:\n      - attrs:\n          - name: stonith-enabled\n            value: 'true'\n          - name: no-quorum-policy\n            value: stop\n\n  roles:\n    - rhel-system-roles.ha_cluster\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.4 and later) This variable defines settings which vary from one cluster node to another. It sets the options for the specified nodes, but does not specify which nodes form the cluster. You specify which nodes form the cluster with the \u003Ccode class=\"literal\">hosts\u003C/code> parameter in an inventory or a playbook.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe items you configure with this variable are as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">node_name\u003C/code> (mandatory) - Name of the node for which to define Pacemaker node attributes. It must match a name defined for a node.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">pcs_address\u003C/code> (optional) - (RHEL 9.5 and later) Address used by \u003Ccode class=\"literal\">pcs\u003C/code> to communicate with the node. You can specify a name, a FQDN or an IP address. You can specify a port as well.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">corosync_addresses\u003C/code> (optional) - (RHEL 9.5 and later) List of addresses used by Corosync. All nodes must have the same number of addresses. The order of the addresses must be the same for all nodes, so that the addresses belonging to a particular link are specified in the same position for all nodes.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sbd_watchdog_modules\u003C/code> (optional) - (RHEL 9.5 and later) Watchdog kernel modules to be loaded, which create \u003Ccode class=\"literal\">/dev/watchdog*\u003C/code> devices. Defaults to an empty list if not set.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sbd_watchdog_modules_blocklist\u003C/code> (optional) - (RHEL 9.5 and later) Watchdog kernel modules to be unloaded and blocked. Defaults to an empty list if not set.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sbd_watchdog\u003C/code> (optional) - (RHEL 9.5 and later) Watchdog device to be used by SBD. Defaults to \u003Ccode class=\"literal\">/dev/watchdog\u003C/code> if not set.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sbd_devices\u003C/code> (optional) - (RHEL 9.5 and later) Devices to use for exchanging SBD messages and for monitoring. Defaults to an empty list if not set. Always refer to the devices using the long, stable device name (\u003Ccode class=\"literal\">/dev/disk/by-id/\u003C/code>).\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">attributes\u003C/code> (optional) - List of sets of Pacemaker node attributes for the node. Currently, only one set is supported. The first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">utilization\u003C/code> (optional) - (RHEL 9.5 and later) List of sets of the node’s utilization. The field value must be an integer. Currently, only one set is supported. The first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> variable is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_node_options:\n  - node_name: node1\n    pcs_address: node1-address\n    corosync_addresses:\n      - 192.168.1.11\n      - 192.168.2.11\n    sbd_watchdog_modules:\n      - module1\n      - module2\n    sbd_watchdog_modules_blocklist:\n      - module3\n    sbd_watchdog: /dev/watchdog2\n    sbd_devices:\n      - /dev/disk/by-id/000001\n      - /dev/disk/by-id/000002\n      - /dev/disk/by-id/000003\n    attributes:\n      - attrs:\n          - name: attribute1\n            value: value1_node1\n          - name: attribute2\n            value: value2_node1\n    utilization:\n      - attrs:\n          - name: utilization1\n            value: value1_node1\n          - name: utilization2\n            value: value2_node1\n  - node_name: node2\n    pcs_address: node2-address:2224\n    corosync_addresses:\n      - 192.168.1.12\n      - 192.168.2.12\n    sbd_watchdog_modules:\n      - module1\n    sbd_watchdog_modules_blocklist:\n      - module3\n    sbd_watchdog: /dev/watchdog1\n    sbd_devices:\n      - /dev/disk/by-id/000001\n      - /dev/disk/by-id/000002\n      - /dev/disk/by-id/000003\n    attributes:\n      - attrs:\n          - name: attribute1\n            value: value1_node2\n          - name: attribute2\n            value: value2_node2\n    utilization:\n      - attrs:\n          - name: utilization1\n            value: value1_node2\n          - name: utilization2\n            value: value2_node2\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default, no node options are defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that includes node options configuration, see \u003Ca class=\"link\" href=\"#configuring-ha-cluster-with-node-attributes_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.16. Configuring a high availability cluster with node attributes\">Configuring a high availability cluster with node attributes\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis variable defines pacemaker resources configured by the RHEL system role, including fencing resources. You can configure the following items for each resource:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - ID of a resource.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">agent\u003C/code> (mandatory) - Name of a resource or fencing agent, for example \u003Ccode class=\"literal\">ocf:pacemaker:Dummy\u003C/code> or \u003Ccode class=\"literal\">stonith:fence_xvm\u003C/code>. It is mandatory to specify \u003Ccode class=\"literal\">stonith:\u003C/code> for STONITH agents. For resource agents, it is possible to use a short name, such as \u003Ccode class=\"literal\">Dummy\u003C/code>, instead of \u003Ccode class=\"literal\">ocf:pacemaker:Dummy\u003C/code>. However, if several agents with the same short name are installed, the role will fail as it will be unable to decide which agent should be used. Therefore, it is recommended that you use full names when specifying a resource agent.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">instance_attrs\u003C/code> (optional) - List of sets of the resource’s instance attributes. Currently, only one set is supported. The exact names and values of attributes, as well as whether they are mandatory or not, depend on the resource or fencing agent.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">meta_attrs\u003C/code> (optional) - List of sets of the resource’s meta attributes. Currently, only one set is supported.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">copy_operations_from_agent\u003C/code> (optional) - (RHEL 9.3 and later) Resource agents usually define default settings for resource operations, such as \u003Ccode class=\"literal\">interval\u003C/code> and \u003Ccode class=\"literal\">timeout\u003C/code>, optimized for the specific agent. If this variable is set to \u003Ccode class=\"literal\">true\u003C/code>, then those settings are copied to the resource configuration. Otherwise, clusterwide defaults apply to the resource. If you also define resource operation defaults for the resource with the \u003Ccode class=\"literal\">ha_cluster_resource_operation_defaults\u003C/code> role variable, you can set this to \u003Ccode class=\"literal\">false\u003C/code>. The default value of this variable is \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">operations\u003C/code> (optional) - List of the resource’s operations.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">action\u003C/code> (mandatory) - Operation action as defined by pacemaker and the resource or fencing agent.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">attrs\u003C/code> (mandatory) - Operation options, at least one option must be specified. (RHEL 9.5 and later)\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">utilization\u003C/code> (optional) - List of sets of the resource’s utilization. The \u003Ccode class=\"literal\">value\u003C/code> field must be an integer. Only one set is supported, so the first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the resource definition that you configure with the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">  - id: resource-id\n    agent: resource-agent\n    instance_attrs:\n      - attrs:\n          - name: attribute1_name\n            value: attribute1_value\n          - name: attribute2_name\n            value: attribute2_value\n    meta_attrs:\n      - attrs:\n          - name: meta_attribute1_name\n            value: meta_attribute1_value\n          - name: meta_attribute2_name\n            value: meta_attribute2_value\n    copy_operations_from_agent: bool\n    operations:\n      - action: operation1-action\n        attrs:\n          - name: operation1_attribute1_name\n            value: operation1_attribute1_value\n          - name: operation1_attribute2_name\n            value: operation1_attribute2_value\n      - action: operation2-action\n        attrs:\n          - name: operation2_attribute1_name\n            value: operation2_attribute1_value\n          - name: operation2_attribute2_name\n            value: operation2_attribute2_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default, no resources are defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that includes resource configuration, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a high availability cluster with fencing and resources\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_groups\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis variable defines pacemaker resource groups configured by the system role. You can configure the following items for each resource group:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - ID of a group.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resources\u003C/code> (mandatory) - List of the group’s resources. Each resource is referenced by its ID and the resources must be defined in the \u003Ccode class=\"literal\">ha_cluster_resource_primitives\u003C/code> variable. At least one resource must be listed.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">meta_attrs\u003C/code> (optional) - List of sets of the group’s meta attributes. Currently, only one set is supported.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the resource group definition that you configure with the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_resource_groups:\n  - id: group-id\n    resource_ids:\n      - resource1-id\n      - resource2-id\n    meta_attrs:\n      - attrs:\n          - name: group_meta_attribute1_name\n            value: group_meta_attribute1_value\n          - name: group_meta_attribute2_name\n            value: group_meta_attribute2_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default, no resource groups are defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that includes resource group configuration, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a high availability cluster with fencing and resources\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_clones\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis variable defines pacemaker resource clones configured by the system role. You can configure the following items for a resource clone:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_id\u003C/code> (mandatory) - Resource to be cloned. The resource must be defined in the \u003Ccode class=\"literal\">ha_cluster_resource_primitives\u003C/code> variable or the \u003Ccode class=\"literal\">ha_cluster_resource_groups\u003C/code> variable.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">promotable\u003C/code> (optional) - Indicates whether the resource clone to be created is a promotable clone, indicated as \u003Ccode class=\"literal\">true\u003C/code> or \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - Custom ID of the clone. If no ID is specified, it will be generated. A warning will be displayed if this option is not supported by the cluster.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">meta_attrs\u003C/code> (optional) - List of sets of the clone’s meta attributes. Currently, only one set is supported.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the resource clone definition that you configure with the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_resource_clones:\n  - resource_id: resource-to-be-cloned\n    promotable: true\n    id: custom-clone-id\n    meta_attrs:\n      - attrs:\n          - name: clone_meta_attribute1_name\n            value: clone_meta_attribute1_value\n          - name: clone_meta_attribute2_name\n            value: clone_meta_attribute2_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default, no resource clones are defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that includes resource clone configuration, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a high availability cluster with fencing and resources\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_defaults\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.3 and later) This variable defines sets of resource defaults. You can define multiple sets of defaults and apply them to resources of specific agents using rules. The defaults you specify with the \u003Ccode class=\"literal\">ha_cluster_resource_defaults\u003C/code> variable do not apply to resources which override them with their own defined values.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOnly meta attributes can be specified as defaults.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for each defaults set:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - ID of the defaults set. If not specified, it is autogenerated.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rule\u003C/code> (optional) - Rule written using \u003Ccode class=\"literal\">pcs\u003C/code> syntax defining when and for which resources the set applies. For information on specifying a rule, see the \u003Ccode class=\"literal\">resource defaults set create\u003C/code> section of the \u003Ccode class=\"literal\">pcs\u003C/code>(8) man page.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">score\u003C/code> (optional) - Weight of the defaults set.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">attrs\u003C/code> (optional) - Meta attributes applied to resources as defaults.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the \u003Ccode class=\"literal\">ha_cluster_resource_defaults\u003C/code> variable is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_resource_defaults:\n  meta_attrs:\n    - id: defaults-set-1-id\n      rule: rule-string\n      score: score-value\n      attrs:\n        - name: meta_attribute1_name\n          value: meta_attribute1_value\n        - name: meta_attribute2_name\n          value: meta_attribute2_value\n    - id: defaults-set-2-id\n      rule: rule-string\n      score: score-value\n      attrs:\n        - name: meta_attribute3_name\n          value: meta_attribute3_value\n        - name: meta_attribute4_name\n          value: meta_attribute4_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that configures resource defaults, see \u003Ca class=\"link\" href=\"#configuring-ha-cluster-with-resource-defaults_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.6. Configuring a high availability cluster with resource and resource operation defaults\">Configuring a high availability cluster with resource and resource operation defaults\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_operation_defaults\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.3 and later) This variable defines sets of resource operation defaults. You can define multiple sets of defaults and apply them to resources of specific agents and specific resource operations using rules. The defaults you specify with the \u003Ccode class=\"literal\">ha_cluster_resource_operation_defaults\u003C/code> variable do not apply to resource operations which override them with their own defined values. By default, the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role configures resources to define their own values for resource operations. For information about overriding these defaults with the \u003Ccode class=\"literal\">ha_cluster_resource_operations_defaults\u003C/code> variable, see the description of the \u003Ccode class=\"literal\">copy_operations_from_agent\u003C/code> item in \u003Ccode class=\"literal\">ha_cluster_resource_primitives\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOnly meta attributes can be specified as defaults.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the \u003Ccode class=\"literal\">ha_cluster_resource_operations_defaults\u003C/code> variable is the same as the structure for the \u003Ccode class=\"literal\">ha_cluster_resource_defaults\u003C/code> variable, with the exception of how you specify a rule. For information about specifying a rule to describe the resource operation to which a set applies, see the \u003Ccode class=\"literal\">resource op defaults set create\u003C/code> section of the \u003Ccode class=\"literal\">pcs\u003C/code>(8) man page.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_stonith_levels\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.4 and later) This variable defines STONITH levels, also known as fencing topology. Fencing levels configure a cluster to use multiple devices to fence nodes. You can define alternative devices in case one device fails and you can require multiple devices to all be executed successfully to consider a node successfully fenced. For more information on fencing levels, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#proc_configuring-fencing-levels-configuring-fencing\">Configuring fencing levels\u003C/a> in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters\">Configuring and managing high availability clusters\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items when defining fencing levels:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">level\u003C/code> (mandatory) - Order in which to attempt the fencing level. Pacemaker attempts levels in ascending order until one succeeds.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">target\u003C/code> (optional) - Name of a node this level applies to.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tYou must specify one of the following three selections:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">target_pattern\u003C/code> - POSIX extended regular expression matching the names of the nodes this level applies to.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">target_attribute\u003C/code> - Name of a node attribute that is set for the node this level applies to.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">target_attribute\u003C/code> and \u003Ccode class=\"literal\">target_value\u003C/code> - Name and value of a node attribute that is set for the node this level applies to.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resouce_ids\u003C/code> (mandatory) - List of fencing resources that must all be tried for this level.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tBy default, no fencing levels are defined.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of the fencing levels definition that you configure with the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_stonith_levels:\n  - level: 1..9\n    target: node_name\n    target_pattern: node_name_regular_expression\n    target_attribute: node_attribute_name\n    target_value: node_attribute_value\n    resource_ids:\n      - fence_device_1\n      - fence_device_2\n  - level: 1..9\n    target: node_name\n    target_pattern: node_name_regular_expression\n    target_attribute: node_attribute_name\n    target_value: node_attribute_value\n    resource_ids:\n      - fence_device_1\n      - fence_device_2\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that configures fencing defaults, see \u003Ca class=\"link\" href=\"#configuring-with-stonith-levels-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.7. Configuring a high availability cluster with fencing levels\">Configuring a high availability cluster with fencing levels\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_constraints_location\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis variable defines resource location constraints. Resource location constraints indicate which nodes a resource can run on. You can specify a resources specified by a resource ID or by a pattern, which can match more than one resource. You can specify a node by a node name or by a rule.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a resource location constraint:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource\u003C/code> (mandatory) - Specification of a resource the constraint applies to.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">node\u003C/code> (mandatory) - Name of a node the resource should prefer or avoid.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - ID of the constraint. If not specified, it will be autogenerated.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">score\u003C/code> - Sets the weight of the constraint.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"square\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA positive \u003Ccode class=\"literal\">score\u003C/code> value means the resource prefers running on the node.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA negative \u003Ccode class=\"literal\">score\u003C/code> value means the resource should avoid running on the node.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA \u003Ccode class=\"literal\">score\u003C/code> value of \u003Ccode class=\"literal\">-INFINITY\u003C/code> means the resource must avoid running on the node.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tIf \u003Ccode class=\"literal\">score\u003C/code> is not specified, the score value defaults to \u003Ccode class=\"literal\">INFINITY\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default no resource location constraints are defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a resource location constraint specifying a resource ID and node name is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_location:\n  - resource:\n      id: resource-id\n    node: node-name\n    id: constraint-id\n    options:\n      - name: score\n        value: score-value\n      - name: option-name\n        value: option-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe items that you configure for a resource location constraint that specifies a resource pattern are the same items that you configure for a resource location constraint that specifies a resource ID, with the exception of the resource specification itself. The item that you specify for the resource specification is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">pattern\u003C/code> (mandatory) - POSIX extended regular expression resource IDs are matched against.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a resource location constraint specifying a resource pattern and node name is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_location:\n  - resource:\n      pattern: resource-pattern\n    node: node-name\n    id: constraint-id\n    options:\n      - name: score\n        value: score-value\n      - name: resource-discovery\n        value: resource-discovery-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a resource location constraint that specifies a resource ID and a rule:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource\u003C/code> (mandatory) - Specification of a resource the constraint applies to.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - Resource ID.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">role\u003C/code> (optional) - The resource role to which the constraint is limited: \u003Ccode class=\"literal\">Started\u003C/code>, \u003Ccode class=\"literal\">Unpromoted\u003C/code>, \u003Ccode class=\"literal\">Promoted\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rule\u003C/code> (mandatory) - Constraint rule written using \u003Ccode class=\"literal\">pcs\u003C/code> syntax. For further information, see the \u003Ccode class=\"literal\">constraint location\u003C/code> section of the \u003Ccode class=\"literal\">pcs\u003C/code>(8) man page.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tOther items to specify have the same meaning as for a resource constraint that does not specify a rule.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a resource location constraint that specifies a resource ID and a rule is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_location:\n  - resource:\n      id: resource-id\n      role: resource-role\n    rule: rule-string\n    id: constraint-id\n    options:\n      - name: score\n        value: score-value\n      - name: resource-discovery\n        value: resource-discovery-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe items that you configure for a resource location constraint that specifies a resource pattern and a rule are the same items that you configure for a resource location constraint that specifies a resource ID and a rule, with the exception of the resource specification itself. The item that you specify for the resource specification is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">pattern\u003C/code> (mandatory) - POSIX extended regular expression resource IDs are matched against.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a resource location constraint that specifies a resource pattern and a rule is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_location:\n  - resource:\n      pattern: resource-pattern\n      role: resource-role\n    rule: rule-string\n    id: constraint-id\n    options:\n      - name: score\n        value: score-value\n      - name: resource-discovery\n        value: resource-discovery-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that creates a cluster with resource constraints, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a high availability cluster with resource constraints\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_constraints_colocation\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis variable defines resource colocation constraints. Resource colocation constraints indicate that the location of one resource depends on the location of another one. There are two types of colocation constraints: a simple colocation constraint for two resources, and a set colocation constraint for multiple resources.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a simple resource colocation constraint:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_follower\u003C/code> (mandatory) - A resource that should be located relative to \u003Ccode class=\"literal\">resource_leader\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - Resource ID.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">role\u003C/code> (optional) - The resource role to which the constraint is limited: \u003Ccode class=\"literal\">Started\u003C/code>, \u003Ccode class=\"literal\">Unpromoted\u003C/code>, \u003Ccode class=\"literal\">Promoted\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_leader\u003C/code> (mandatory) - The cluster will decide where to put this resource first and then decide where to put \u003Ccode class=\"literal\">resource_follower\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - Resource ID.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">role\u003C/code> (optional) - The resource role to which the constraint is limited: \u003Ccode class=\"literal\">Started\u003C/code>, \u003Ccode class=\"literal\">Unpromoted\u003C/code>, \u003Ccode class=\"literal\">Promoted\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - ID of the constraint. If not specified, it will be autogenerated.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">score\u003C/code> - Sets the weight of the constraint.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"square\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tPositive \u003Ccode class=\"literal\">score\u003C/code> values indicate the resources should run on the same node.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tNegative \u003Ccode class=\"literal\">score\u003C/code> values indicate the resources should run on different nodes.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA \u003Ccode class=\"literal\">score\u003C/code> value of \u003Ccode class=\"literal\">+INFINITY\u003C/code> indicates the resources must run on the same node.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tA \u003Ccode class=\"literal\">score\u003C/code> value of \u003Ccode class=\"literal\">-INFINITY\u003C/code> indicates the resources must run on different nodes.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tIf \u003Ccode class=\"literal\">score\u003C/code> is not specified, the score value defaults to \u003Ccode class=\"literal\">INFINITY\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default no resource colocation constraints are defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a simple resource colocation constraint is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_colocation:\n  - resource_follower:\n      id: resource-id1\n      role: resource-role1\n    resource_leader:\n      id: resource-id2\n      role: resource-role2\n    id: constraint-id\n    options:\n      - name: score\n        value: score-value\n      - name: option-name\n        value: option-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a resource set colocation constraint:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_sets\u003C/code> (mandatory) - List of resource sets.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_ids\u003C/code> (mandatory) - List of resources in a set.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - Same values as for a simple colocation constraint.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - Same values as for a simple colocation constraint.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a resource set colocation constraint is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_colocation:\n  - resource_sets:\n      - resource_ids:\n          - resource-id1\n          - resource-id2\n        options:\n          - name: option-name\n            value: option-value\n    id: constraint-id\n    options:\n      - name: score\n        value: score-value\n      - name: option-name\n        value: option-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that creates a cluster with resource constraints, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a high availability cluster with resource constraints\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_constraints_order\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis variable defines resource order constraints. Resource order constraints indicate the order in which certain resource actions should occur. There are two types of resource order constraints: a simple order constraint for two resources, and a set order constraint for multiple resources.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a simple resource order constraint:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_first\u003C/code> (mandatory) - Resource that the \u003Ccode class=\"literal\">resource_then\u003C/code> resource depends on.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - Resource ID.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">action\u003C/code> (optional) - The action that must complete before an action can be initiated for the \u003Ccode class=\"literal\">resource_then\u003C/code> resource. Allowed values: \u003Ccode class=\"literal\">start\u003C/code>, \u003Ccode class=\"literal\">stop\u003C/code>, \u003Ccode class=\"literal\">promote\u003C/code>, \u003Ccode class=\"literal\">demote\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_then\u003C/code> (mandatory) - The dependent resource.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - Resource ID.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">action\u003C/code> (optional) - The action that the resource can execute only after the action on the \u003Ccode class=\"literal\">resource_first\u003C/code> resource has completed. Allowed values: \u003Ccode class=\"literal\">start\u003C/code>, \u003Ccode class=\"literal\">stop\u003C/code>, \u003Ccode class=\"literal\">promote\u003C/code>, \u003Ccode class=\"literal\">demote\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - ID of the constraint. If not specified, it will be autogenerated.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default no resource order constraints are defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a simple resource order constraint is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_order:\n  - resource_first:\n      id: resource-id1\n      action: resource-action1\n    resource_then:\n      id: resource-id2\n      action: resource-action2\n    id: constraint-id\n    options:\n      - name: score\n        value: score-value\n      - name: option-name\n        value: option-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a resource set order constraint:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_sets\u003C/code> (mandatory) - List of resource sets.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_ids\u003C/code> (mandatory) - List of resources in a set.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - Same values as for a simple order constraint.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - Same values as for a simple order constraint.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a resource set order constraint is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_order:\n  - resource_sets:\n      - resource_ids:\n          - resource-id1\n          - resource-id2\n        options:\n          - name: option-name\n            value: option-value\n    id: constraint-id\n    options:\n      - name: score\n        value: score-value\n      - name: option-name\n        value: option-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that creates a cluster with resource constraints, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a high availability cluster with resource constraints\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_constraints_ticket\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis variable defines resource ticket constraints. Resource ticket constraints indicate the resources that depend on a certain ticket. There are two types of resource ticket constraints: a simple ticket constraint for one resource, and a ticket order constraint for multiple resources.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a simple resource ticket constraint:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource\u003C/code> (mandatory) - Specification of a resource the constraint applies to.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - Resource ID.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">role\u003C/code> (optional) - The resource role to which the constraint is limited: \u003Ccode class=\"literal\">Started\u003C/code>, \u003Ccode class=\"literal\">Unpromoted\u003C/code>, \u003Ccode class=\"literal\">Promoted\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ticket\u003C/code> (mandatory) - Name of a ticket the resource depends on.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - ID of the constraint. If not specified, it will be autogenerated.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">loss-policy\u003C/code> (optional) - Action to perform on the resource if the ticket is revoked.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default no resource ticket constraints are defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a simple resource ticket constraint is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_ticket:\n  - resource:\n      id: resource-id\n      role: resource-role\n    ticket: ticket-name\n    id: constraint-id\n    options:\n      - name: loss-policy\n        value: loss-policy-value\n      - name: option-name\n        value: option-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a resource set ticket constraint:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_sets\u003C/code> (mandatory) - List of resource sets.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">resource_ids\u003C/code> (mandatory) - List of resources in a set.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - List of name-value dictionaries fine-tuning how resources in the sets are treated by the constraint.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ticket\u003C/code> (mandatory) - Same value as for a simple ticket constraint.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - Same value as for a simple ticket constraint.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">options\u003C/code> (optional) - Same values as for a simple ticket constraint.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of a resource set ticket constraint is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_constraints_ticket:\n  - resource_sets:\n      - resource_ids:\n          - resource-id1\n          - resource-id2\n        options:\n          - name: option-name\n            value: option-value\n    ticket: ticket-name\n    id: constraint-id\n    options:\n      - name: option-name\n        value: option-value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that creates a cluster with resource constraints, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a high availability cluster with resource constraints\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_acls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.5 and later) This variable defines ACL roles, users and groups.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for \u003Ccode class=\"literal\">acl_roles\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - ID of an ACL role.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">description\u003C/code> (optional) - Description of the ACL role.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">permissions\u003C/code> (optional) - List of ACL role permissions.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">kind\u003C/code> (mandatory) - The access being granted. Allowed values are \u003Ccode class=\"literal\">read\u003C/code>, \u003Ccode class=\"literal\">write\u003C/code>, and \u003Ccode class=\"literal\">deny\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">xpath\u003C/code> (optional) - An XPath specification selecting an XML element in the CIB to which the permission applies. It is mandatory to specify exactly one of the items: \u003Ccode class=\"literal\">xpath\u003C/code> or \u003Ccode class=\"literal\">reference\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">reference\u003C/code> (optional) - The ID of an XML element in the CIB to which the permission applies. It is mandatory to specify exactly one of the items: xpath or reference. The ID must exist.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for \u003Ccode class=\"literal\">acl_users\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - ID of an ACL user.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">roles\u003C/code> (optional) - List of ACL Role IDs assigned to the user.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for \u003Ccode class=\"literal\">acl_group\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - ID of an ACL group.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">roles\u003C/code> (optional) - List of ACL Role IDs assigned to the group.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of an ACL definition is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_acls:\n  acl_roles:\n    - id: role-id-1\n      description: role description\n      permissions:\n        - kind: access-type\n          xpath: XPath expression\n        - kind: access-type\n          reference: cib-element-id\n    - id: role-id-2\n      permissions:\n        - kind: access-type\n          xpath: XPath expression\n  acl_users:\n    - id: user-name\n      roles:\n        - role-id-1\n        - role-id-2\n  acl_groups:\n    - id: group-name\n      roles:\n        - role-id-2\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo enable ACLS in the cluster, you must configure the \u003Ccode class=\"literal\">enable-acl\u003C/code> cluster property:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_cluster_properties:\n  - attrs:\n      - name: enable-acl\n        value: 'true'\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that creates a cluster with ACL roles, users, and groups, see \u003Ca class=\"link\" href=\"#configuring-hacluster-with-ACLS-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.10. Configuring a high availability cluster that implements access control lists (ACLs) by using the ha_cluster RHEL system role\">Configuring a high availability cluster that implements access control lists (ACLS) by using the RHEL system role\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_alerts\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.5 and later) This variable defines Pacemaker alerts.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> role configures the cluster to call external programs to handle alerts. You must provide the programs and distribute them to cluster nodes.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for \u003Ccode class=\"literal\">alerts\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (mandatory) - ID of an alert\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipath\u003C/code> (mandatory) - Path to the alert agent executable.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">description\u003C/code> (optional) - Description of the alert.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">instance_attrs\u003C/code> (optional) - List of sets of the alert’s instance attributes.Only one set is supported. The first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">meta_attrs\u003C/code> (optional) - List of sets of the alert’s meta attributes. Only one set is supported. The first set is used and the rest are ignored. *\u003Ccode class=\"literal\">recipients\u003C/code> (optional) - List of alert’s recipients.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for \u003Ccode class=\"literal\">recipients\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">value\u003C/code> (mandatory) - Value of a recipient.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> (optional) - ID of the recipient.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">description\u003C/code> (optional) - Description of the recipient.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">instance_attrs\u003C/code> (optional) - List of sets of the recipient’s instance attributes. Only one set is supported. The first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">meta_attrs\u003C/code> (optional) - List of sets of the recipient’s meta attributes. Only one set is supported. The first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe structure of an alert definition is as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ha_cluster_alerts:\n  - id: alert1\n    path: /alert1/path\n    description: Alert1 description\n    instance_attrs:\n      - attrs:\n        - name: alert_attr1_name\n          value: alert_attr1_value\n    meta_attrs:\n      - attrs:\n        - name: alert_meta_attr1_name\n          value: alert_meta_attr1_value\n    recipients:\n      - value: recipient_value\n        id: recipient1\n        description: Recipient1 description\n        instance_attrs:\n          - attrs:\n            - name: recipient_attr1_name\n              value: recipient_attr1_value\n        meta_attrs:\n          - attrs:\n            - name: recipient_meta_attr1_name\n              value: recipient_meta_attr1_value\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that configures a cluster with alerts, see \u003Ca class=\"link\" href=\"#configuring-alerts-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.14. Configuring alerts for a high availability cluster by using the ha_cluster RHEL system role\">Configuring alerts for a high availability cluster by using the ha_cluster RHEL system role\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_qnetd\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t(RHEL 9.2 and later) This variable configures a \u003Ccode class=\"literal\">qnetd\u003C/code> host which can then serve as an external quorum device for clusters.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can configure the following items for a \u003Ccode class=\"literal\">qnetd\u003C/code> host:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">present\u003C/code> (optional) - If \u003Ccode class=\"literal\">true\u003C/code>, configure a \u003Ccode class=\"literal\">qnetd\u003C/code> instance on the host. If \u003Ccode class=\"literal\">false\u003C/code>, remove \u003Ccode class=\"literal\">qnetd\u003C/code> configuration from the host. The default value is \u003Ccode class=\"literal\">false\u003C/code>. If you set this \u003Ccode class=\"literal\">true\u003C/code>, you must set \u003Ccode class=\"literal\">ha_cluster_cluster_present\u003C/code> to \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">start_on_boot\u003C/code> (optional) - Configures whether the \u003Ccode class=\"literal\">qnetd\u003C/code> instance should start automatically on boot. The default value is \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">regenerate_keys\u003C/code> (optional) - Set this variable to \u003Ccode class=\"literal\">true\u003C/code> to regenerate the \u003Ccode class=\"literal\">qnetd\u003C/code> TLS certificate. If you regenerate the certificate, you must either re-run the role for each cluster to connect it to the \u003Ccode class=\"literal\">qnetd\u003C/code> host again or run \u003Ccode class=\"literal\">pcs\u003C/code> manually.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003C!--Empty-->\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou cannot run \u003Ccode class=\"literal\">qnetd\u003C/code> on a cluster node because fencing would disrupt \u003Ccode class=\"literal\">qnetd\u003C/code> operation.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor an example \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook that configures a cluster using a quorum device, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">Configuring a cluster using a quorum device\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.2. Specifying an inventory for the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWhen configuring an HA cluster using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role playbook, you configure the names and addresses of the nodes for the cluster in an inventory.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor each node in an inventory, you can optionally specify the following items:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">node_name\u003C/code> - the name of a node in a cluster.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pcs_address\u003C/code> - an address used by \u003Ccode class=\"literal\">pcs\u003C/code> to communicate with the node. It can be a name, FQDN or an IP address and it can include a port number.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">corosync_addresses\u003C/code> - list of addresses used by Corosync. All nodes which form a particular cluster must have the same number of addresses. The order of the addresses must be the same for all nodes, so that the addresses belonging to a particular link are specified in the same position for all nodes.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe following example shows an inventory with targets \u003Ccode class=\"literal\">node1\u003C/code> and \u003Ccode class=\"literal\">node2\u003C/code>. \u003Ccode class=\"literal\">node1\u003C/code> and \u003Ccode class=\"literal\">node2\u003C/code> must be either fully qualified domain names or must otherwise be able to connect to the nodes as when, for example, the names are resolvable through the \u003Ccode class=\"literal\">/etc/hosts\u003C/code> file.\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">all:\n  hosts:\n    node1:\n      ha_cluster:\n        node_name: node-A\n        pcs_address: node1-address\n        corosync_addresses:\n          - 192.168.1.11\n          - 192.168.2.11\n    node2:\n      ha_cluster:\n        node_name: node-B\n        pcs_address: node2-address:2224\n        corosync_addresses:\n          - 192.168.1.12\n          - 192.168.2.12\u003C/pre>\u003Cp>\n\t\t\t\tAs of RHEL 9.1, you can optionally configure watchdog and SBD devices for each node in an inventory. All SBD devices must be shared to and accessible from all nodes. Watchdog devices can be different for each node as well. For an example procedure that configures SBD node fencing in an inventory file, see \u003Ca class=\"link\" href=\"#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable\">Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable\u003C/a>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.3. Creating pcsd TLS certificates and key files for a high availability cluster\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t(RHEL 9.2 and later) The connection between cluster nodes is secured using Transport Layer Security (TLS) encryption. By default, the \u003Ccode class=\"literal\">pcsd\u003C/code> daemon generates self-signed certificates. For many deployments, however, you may want to replace the default certificates with certificates issued by a certificate authority of your company and apply your company certificate policies for \u003Ccode class=\"literal\">pcsd\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create TLS certificates and key files in a high availability cluster. When you run this playbook, the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role uses the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role internally to manage TLS certificates.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create TLS certificates and key files in a high availability cluster\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_pcsd_certificates:\n          - name: FILENAME\n            common_name: \"{{ ansible_hostname }}\"\n            ca: self-sign\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_pcsd_certificates: \u003Cspan class=\"emphasis\">\u003Cem>&lt;certificate_properties&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that creates a self-signed \u003Ccode class=\"literal\">pcsd\u003C/code> certificate and private key files in \u003Ccode class=\"literal\">/var/lib/pcsd\u003C/code>. In this example, the \u003Ccode class=\"literal\">pcsd\u003C/code> certificate has the file name \u003Ccode class=\"literal\">FILENAME.crt\u003C/code> and the key file is named \u003Ccode class=\"literal\">FILENAME.key\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 7. Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles\">Requesting certificates using RHEL system roles\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-no-resource-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.4. Configuring a high availability cluster running no resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ha_cluster\u003C/code> system role to configure a basic cluster in a simple, automatic way. Once you have created a basic cluster, you can use the \u003Ccode class=\"literal\">pcs\u003C/code> command-line interface to configure the other cluster components and behaviors on a resource-by-resource basis. The following example procedure configures a basic two-node cluster with no fencing configured using the minimum required parameters.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create cluster with minimum required parameters and no fencing\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.5. Configuring a high availability cluster with fencing and resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe specific components of a cluster configuration depend on your individual needs, which vary between sites. The following example procedure shows the formats for configuring different cluster components by using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role. The configured cluster includes a fencing device, cluster resources, resource groups, and a cloned resource.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create cluster with fencing and resources\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_resource_primitives:\n          - id: xvm-fencing\n            agent: 'stonith:fence_xvm'\n            instance_attrs:\n              - attrs:\n                  - name: pcmk_host_list\n                    value: node1 node2\n          - id: simple-resource\n            agent: 'ocf:pacemaker:Dummy'\n          - id: resource-with-options\n            agent: 'ocf:pacemaker:Dummy'\n            instance_attrs:\n              - attrs:\n                  - name: fake\n                    value: fake-value\n                  - name: passwd\n                    value: passwd-value\n            meta_attrs:\n              - attrs:\n                  - name: target-role\n                    value: Started\n                  - name: is-managed\n                    value: 'true'\n            operations:\n              - action: start\n                attrs:\n                  - name: timeout\n                    value: '30s'\n              - action: monitor\n                attrs:\n                  - name: timeout\n                    value: '5'\n                  - name: interval\n                    value: '1min'\n          - id: dummy-1\n            agent: 'ocf:pacemaker:Dummy'\n          - id: dummy-2\n            agent: 'ocf:pacemaker:Dummy'\n          - id: dummy-3\n            agent: 'ocf:pacemaker:Dummy'\n          - id: simple-clone\n            agent: 'ocf:pacemaker:Dummy'\n          - id: clone-with-options\n            agent: 'ocf:pacemaker:Dummy'\n        ha_cluster_resource_groups:\n          - id: simple-group\n            resource_ids:\n              - dummy-1\n              - dummy-2\n            meta_attrs:\n              - attrs:\n                  - name: target-role\n                    value: Started\n                  - name: is-managed\n                    value: 'true'\n          - id: cloned-group\n            resource_ids:\n              - dummy-3\n        ha_cluster_resource_clones:\n          - resource_id: simple-clone\n          - resource_id: clone-with-options\n            promotable: yes\n            id: custom-clone-id\n            meta_attrs:\n              - attrs:\n                  - name: clone-max\n                    value: '2'\n                  - name: clone-node-max\n                    value: '1'\n          - resource_id: cloned-group\n            promotable: yes\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_resources&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource definitions for the Pacemaker resources configured by the ha_cluster RHEL system role, including fencing\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_groups: \u003Cspan class=\"emphasis\">\u003Cem>&lt;resource_groups&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource group definitions configured by the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_clones: \u003Cspan class=\"emphasis\">\u003Cem>&lt;resource_clones&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource clone definitions configured by the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://content-stage.docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_configuring-fencing-configuring-and-managing-high-availability-clusters\">Configuring fencing in a Red Hat High Availability cluster\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-ha-cluster-with-resource-defaults_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.6. Configuring a high availability cluster with resource and resource operation defaults\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t(RHEL 9.3 and later) In your cluster configuration, you can change the Pacemaker default values of a resource option for all resources. You can also change the default value for all resource operations in the cluster.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor information about changing the default value of a resource option, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#changing_the_default_value_of_a_resource_option\">Changing the default value of a resource option\u003C/a>. For information about global resource operation defaults, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#proc_configuring-global-resource-operation-defaults-resource-monitoring-operations\">Configuring global resource operation defaults\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create a high availability cluster that defines resource and resource operation defaults.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create cluster with fencing and resource operation defaults\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        # Set a different \u003Ccode class=\"literal\">resource-stickiness\u003C/code> value during\n        # and outside work hours. This allows resources to\n        # automatically move back to their most\n        # preferred hosts, but at a time that\n        # does not interfere with business activities.\n        ha_cluster_resource_defaults:\n          meta_attrs:\n            - id: core-hours\n              rule: date-spec hours=9-16 weekdays=1-5\n              score: 2\n              attrs:\n                - name: resource-stickiness\n                  value: INFINITY\n            - id: after-hours\n              score: 1\n              attrs:\n                - name: resource-stickiness\n                  value: 0\n        # Default the timeout on all 10-second-interval\n        # monitor actions on IPaddr2 resources to 8 seconds.\n        ha_cluster_resource_operation_defaults:\n          meta_attrs:\n            - rule: resource ::IPaddr2 and op monitor interval=10s\n              score: INFINITY\n              attrs:\n                - name: timeout\n                  value: 8s\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_defaults: \u003Cspan class=\"emphasis\">\u003Cem>&lt;resource_defaults&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines sets of resource defaults.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_operation_defaults: \u003Cspan class=\"emphasis\">\u003Cem>&lt;resource_operation_defaults&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines sets of resource operation defaults.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-with-stonith-levels-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.7. Configuring a high availability cluster with fencing levels\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t(RHEL 9.4 and later) When you configure multiple fencing devices for a node, you need to define fencing levels for those devices to determine the order that Pacemaker will use the devices to attempt to fence a node. For information about fencing levels, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#proc_configuring-fencing-levels-configuring-fencing\">Configuring fencing levels\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create a high availability cluster that defines fencing levels.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\nfence1_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;fence1_password&gt;\u003C/em>\u003C/span>\nfence2_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;fence2_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>. This example playbook file configures a cluster running the \u003Ccode class=\"literal\">firewalld\u003C/code> and \u003Ccode class=\"literal\">selinux\u003C/code> services.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Configure a cluster that defines fencing levels\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_resource_primitives:\n          - id: apc1\n            agent: 'stonith:fence_apc_snmp'\n            instance_attrs:\n              - attrs:\n                  - name: ip\n                    value: apc1.example.com\n                  - name: username\n                    value: user\n                  - name: password\n                    value: \"{{ fence1_password }}\"\n                  - name: pcmk_host_map\n                    value: node1:1;node2:2\n          - id: apc2\n            agent: 'stonith:fence_apc_snmp'\n            instance_attrs:\n              - attrs:\n                  - name: ip\n                    value: apc2.example.com\n                  - name: username\n                    value: user\n                  - name: password\n                    value: \"{{ fence2_password }}\"\n                  - name: pcmk_host_map\n                    value: node1:1;node2:2\n        # Nodes have redundant power supplies, apc1 and apc2. Cluster must\n        # ensure that when attempting to reboot a node, both power\n        # supplies # are turned off before either power supply is turned\n        # back on.\n        ha_cluster_stonith_levels:\n          - level: 1\n            target: node1\n            resource_ids:\n              - apc1\n              - apc2\n          - level: 1\n            target: node2\n            resource_ids:\n              - apc1\n              - apc2\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_resources&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource definitions for the Pacemaker resources configured by the ha_cluster RHEL system role, including fencing\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_stonith_levels: \u003Cspan class=\"emphasis\">\u003Cem>&lt;stonith_levels&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines STONITH levels, also known as fencing topology, which configure a cluster to use multiple devices to fence nodes.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.8. Configuring a high availability cluster with resource constraints\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen configuring a cluster, you can specify the behavior of the cluster resources to be in line with your application requirements. You can control the behavior of cluster resources by configuring resource constraints.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can define the following categories of resource constraints:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLocation constraints, which determine which nodes a resource can run on. For information about location constraints, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_determining-which-node-a-resource-runs-on-configuring-and-managing-high-availability-clusters\">Determining which nodes a resource can run on\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOrdering constraints, which determine the order in which the resources are run. For information about ordering constraints, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_determining-resource-order.adoc-configuring-and-managing-high-availability-clusters\">Determing the order in which cluster resources are run\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tColocation constraints, which specify that the location of one resource depends on the location of another resource. For information about colocation constraints, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_colocating-cluster-resources.adoc_configuring-and-managing-high-availability-clusters\">Colocating cluster resources\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTicket constraints, which indicate the resources that depend on a particular Booth ticket. For information about Booth ticket constraints, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#writing-cluster-alert-agent-configuring-pacemaker-alert-agents\">Multi-site Pacemaker clusters\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe following example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create a high availability cluster that includes resource location constraints, resource colocation constraints, resource order constraints, and resource ticket constraints.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create cluster with resource constraints\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        # In order to use constraints, we need resources\n        # the constraints will apply to.\n        ha_cluster_resource_primitives:\n          - id: xvm-fencing\n            agent: 'stonith:fence_xvm'\n            instance_attrs:\n              - attrs:\n                  - name: pcmk_host_list\n                    value: node1 node2\n          - id: dummy-1\n            agent: 'ocf:pacemaker:Dummy'\n          - id: dummy-2\n            agent: 'ocf:pacemaker:Dummy'\n          - id: dummy-3\n            agent: 'ocf:pacemaker:Dummy'\n          - id: dummy-4\n            agent: 'ocf:pacemaker:Dummy'\n          - id: dummy-5\n            agent: 'ocf:pacemaker:Dummy'\n          - id: dummy-6\n            agent: 'ocf:pacemaker:Dummy'\n        # location constraints\n        ha_cluster_constraints_location:\n          # resource ID and node name\n          - resource:\n              id: dummy-1\n            node: node1\n            options:\n              - name: score\n                value: 20\n          # resource pattern and node name\n          - resource:\n              pattern: dummy-\\d+\n            node: node1\n            options:\n              - name: score\n                value: 10\n          # resource ID and rule\n          - resource:\n              id: dummy-2\n            rule: '#uname eq node2 and date in_range 2022-01-01 to 2022-02-28'\n          # resource pattern and rule\n          - resource:\n              pattern: dummy-\\d+\n            rule: node-type eq weekend and date-spec weekdays=6-7\n        # colocation constraints\n        ha_cluster_constraints_colocation:\n          # simple constraint\n          - resource_leader:\n              id: dummy-3\n            resource_follower:\n              id: dummy-4\n            options:\n              - name: score\n                value: -5\n          # set constraint\n          - resource_sets:\n              - resource_ids:\n                  - dummy-1\n                  - dummy-2\n              - resource_ids:\n                  - dummy-5\n                  - dummy-6\n                options:\n                  - name: sequential\n                    value: \"false\"\n            options:\n              - name: score\n                value: 20\n        # order constraints\n        ha_cluster_constraints_order:\n          # simple constraint\n          - resource_first:\n              id: dummy-1\n            resource_then:\n              id: dummy-6\n            options:\n              - name: symmetrical\n                value: \"false\"\n          # set constraint\n          - resource_sets:\n              - resource_ids:\n                  - dummy-1\n                  - dummy-2\n                options:\n                  - name: require-all\n                    value: \"false\"\n                  - name: sequential\n                    value: \"false\"\n              - resource_ids:\n                  - dummy-3\n              - resource_ids:\n                  - dummy-4\n                  - dummy-5\n                options:\n                  - name: sequential\n                    value: \"false\"\n        # ticket constraints\n        ha_cluster_constraints_ticket:\n          # simple constraint\n          - resource:\n              id: dummy-1\n            ticket: ticket1\n            options:\n              - name: loss-policy\n                value: stop\n          # set constraint\n          - resource_sets:\n              - resource_ids:\n                  - dummy-3\n                  - dummy-4\n                  - dummy-5\n            ticket: ticket2\n            options:\n              - name: loss-policy\n                value: fence\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_resources&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource definitions for the Pacemaker resources configured by the ha_cluster RHEL system role, including fencing\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_constraints_location: \u003Cspan class=\"emphasis\">\u003Cem>&lt;location_constraints&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines resource location constraints.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_constraints_colocation: \u003Cspan class=\"emphasis\">\u003Cem>&lt;colocation_constraints&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines resource colocation constraints.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_constraints_order: \u003Cspan class=\"emphasis\">\u003Cem>&lt;order_constraints&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines resource order constraints.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_constraints_ticket: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ticket_constraints&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines Booth ticket constraints.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.9. Configuring Corosync values in a high availability cluster\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t(RHEL 9.1 and later) The \u003Ccode class=\"literal\">corosync.conf\u003C/code> file provides the cluster parameters used by Corosync, the cluster membership and messaging layer that Pacemaker is built on. For your system configuration, you can change some of the default parameters in the \u003Ccode class=\"literal\">corosync.conf\u003C/code> file. In general, you should not edit the \u003Ccode class=\"literal\">corosync.conf\u003C/code> file directly. You can, however, configure Corosync values by using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create a high availability cluster that configures Corosync values.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create cluster that configures Corosync values\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_transport:\n          type: knet\n          options:\n            - name: ip_version\n              value: ipv4-6\n            - name: link_mode\n              value: active\n          links:\n            -\n              - name: linknumber\n                value: 1\n              - name: link_priority\n                value: 5\n            -\n              - name: linknumber\n                value: 0\n              - name: link_priority\n                value: 10\n          compression:\n            - name: level\n              value: 5\n            - name: model\n              value: zlib\n          crypto:\n            - name: cipher\n              value: none\n            - name: hash\n              value: none\n        ha_cluster_totem:\n          options:\n            - name: block_unlisted_ips\n              value: 'yes'\n            - name: send_join\n              value: 0\n        ha_cluster_quorum:\n          options:\n            - name: auto_tie_breaker\n              value: 1\n            - name: wait_for_all\n              value: 1\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_transport: \u003Cspan class=\"emphasis\">\u003Cem>&lt;transport_method&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that sets the cluster transport method.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_totem: \u003Cspan class=\"emphasis\">\u003Cem>&lt;totem_options&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that configures Corosync totem options.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_quorum: \u003Cspan class=\"emphasis\">\u003Cem>&lt;quorum_options&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that configures cluster quorum options.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-hacluster-with-ACLS-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.10. Configuring a high availability cluster that implements access control lists (ACLs) by using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t(RHEL 9.5 and later) The \u003Ccode class=\"literal\">pcs\u003C/code> administration account for a cluster is \u003Ccode class=\"literal\">hacluster\u003C/code>. Using access control lists (ACLs), you can grant permission for specific local users other than user \u003Ccode class=\"literal\">hacluster\u003C/code> to manage a Pacemaker cluster. A common use case for this feature is to restrict unauthorized users from accessing business-sensitive information.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy default, ACLs are not enabled. Consequently, any member of the group \u003Ccode class=\"literal\">haclient\u003C/code> on all nodes has full local read and write access to the cluster configuratioan. Users who are not members of \u003Ccode class=\"literal\">haclient\u003C/code> have no access. When ACLs are enabled, however, even users who are members of the \u003Ccode class=\"literal\">haclient\u003C/code> group have access only to what has been granted to that user by the ACLs. The \u003Ccode class=\"literal\">root\u003C/code> and \u003Ccode class=\"literal\">hacluster\u003C/code> user accounts always have full access to the cluster configuration, even when ACLs are enabled.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWhen you set permissions for local users with ACLs, you create a role which defines the permissions for that role. You then assign that role to a user. If you assign multiple roles to the same user, any deny permission takes precedence, then write, then read.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create in an automated fashion a high availability cluster that implements ACLs to control access to the cluster configuration.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Configure a cluster with ACLs assigned\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n          ha_cluster_cluster_name: my-new-cluster\n          ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n          ha_cluster_manage_firewall: true\n          ha_cluster_manage_selinux: true\n          # To use an ACL role permission reference, the reference must exist in CIB.\n          ha_cluster_resource_primitives:\n            - id: not-for-operator\n              agent: 'ocf:pacemaker:Dummy'\n          # ACLs must be enabled (using the enable-acl cluster property) in order to be effective.\n          ha_cluster_cluster_properties:\n            - attrs:\n                - name: enable-acl\n                  value: 'true'\n          ha_cluster_acls:\n            acl_roles:\n              - id: operator\n                description: HA cluster operator\n                permissions:\n                  - kind: write\n                    xpath: //crm_config//nvpair[@name='maintenance-mode']\n                  - kind: deny\n                    reference: not-for-operator\n              - id: administrator\n                permissions:\n                  - kind: write\n                    xpath: /cib\n            acl_users:\n              - id: alice\n                roles:\n                  - operator\n                  - administrator\n              - id: bob\n                roles:\n                  - administrator\n            acl_groups:\n              - id: admins\n                roles:\n                  - administrator\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster resources&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource definitions for the Pacemaker resources configured by the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role, including fencing resources.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_properties: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster properties&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of sets of cluster properties for Pacemaker cluster-wide configuration.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_acls: \u003Cspan class=\"emphasis\">\u003Cem>&lt;dictionary&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA dictionary of ACL role, user, and group values.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.11. Configuring a high availability cluster with SBD node fencing by using the \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> variable\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou must configure a Red Hat high availability cluster with at least one fencing device to ensure the cluster-provided services remain available when a node in the cluster encounters a problem. If your environment does not allow for a remotely accessible power switch to fence a cluster node, you can configure fencing by using a STONITH Block Device (SBD). This device provides a node fencing mechanism for Pacemaker-based clusters through the exchange of messages by means of shared block storage. SBD integrates with Pacemaker, a watchdog device and, optionally, shared storage to arrange for nodes to reliably self-terminate when fencing is required.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to configure SBD fencing in an automated fashion. With \u003Ccode class=\"literal\">ha_cluster\u003C/code>, you can configure watchdog and SBD devices on a node-to-node basis by using one of two variables:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code>: (RHEL 9.5 and later) This is a single variable you define in a playbook file. It is a list of dictionaries where each dictionary defines options for one node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ha_cluster\u003C/code>: (RHEL 9.1 and later) A dictionary that defines options for one node only. You configure the \u003Ccode class=\"literal\">ha_cluster\u003C/code> variable in an inventory file. To set different values for each node, you define the variable separately for each node.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIf both the \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> and \u003Ccode class=\"literal\">ha_cluster\u003C/code> variables contain SBD options, those in \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> have precedence.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis example procedure uses the \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> variable in a playbook file to configure node addresses and SBD options on a per-node basis. For an example procedure that uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> variable in an inventory file, see \u003Ca class=\"link\" href=\"#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable\">Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable\u003C/a>.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Configure a cluster with SBD fencing\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        my_sbd_devices:\n          # This variable is indirectly used by various variables of the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role.\n          # Its purpose is to define SBD devices once so they do not need\n          # to be repeated several times in the role variables.\n          - /dev/disk/by-id/000001\n          - /dev/disk/by-id/000002\n          - /dev/disk/by-id/000003\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_sbd_enabled: true\n        ha_cluster_sbd_options:\n          - name: delay-start\n            value: 'no'\n          - name: startmode\n            value: always\n          - name: timeout-action\n            value: 'flush,reboot'\n          - name: watchdog-timeout\n            value: 30\n        ha_cluster_node_options:\n          - node_name: node1\n            sbd_watchdog_modules:\n              - iTCO_wdt\n            sbd_watchdog_modules_blocklist:\n              - ipmi_watchdog\n            sbd_watchdog: /dev/watchdog1\n            sbd_devices: \"{{ my_sbd_devices }}\"\n          - node_name: node2\n            sbd_watchdog_modules:\n              - iTCO_wdt\n            sbd_watchdog_modules_blocklist:\n              - ipmi_watchdog\n            sbd_watchdog: /dev/watchdog1\n            sbd_devices: \"{{ my_sbd_devices }}\"\n        # Best practice for setting SBD timeouts:\n        # watchdog-timeout * 2 = msgwait-timeout (set automatically)\n        # msgwait-timeout * 1.2 = stonith-timeout\n        ha_cluster_cluster_properties:\n          - attrs:\n              - name: stonith-timeout\n                value: 72\n        ha_cluster_resource_primitives:\n          - id: fence_sbd\n            agent: 'stonith:fence_sbd'\n            instance_attrs:\n              - attrs:\n                  - name: devices\n                    value: \"{{ my_sbd_devices | join(',') }}\"\n                  - name: pcmk_delay_base\n                    value: 30\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_sbd_enabled: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the cluster can use the SBD node fencing mechanism.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_sbd_options: \u003Cspan class=\"emphasis\">\u003Cem>&lt;sbd options&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of name-value dictionaries specifying SBD options. For information about these options, see the \u003Ccode class=\"literal\">Configuration via environment\u003C/code> section of the \u003Ccode class=\"literal\">sbd\u003C/code>(8) man page on your system.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_node_options: \u003Cspan class=\"emphasis\">\u003Cem>&lt;node options&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tA variable that defines settings which vary from one cluster node to another. You can configure the following SBD and watchdog items:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sbd_watchdog_modules\u003C/code> - Modules to be loaded, which create \u003Ccode class=\"literal\">/dev/watchdog*\u003C/code> devices.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sbd_watchdog_modules_blocklist\u003C/code> - Watchdog kernel modules to be unloaded and blocked.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sbd_watchdog\u003C/code> - Watchdog device to be used by SBD.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sbd_devices\u003C/code> - Devices to use for exchanging SBD messages and for monitoring. Always refer to the devices using the long, stable device name (\u003Ccode class=\"literal\">/dev/disk/by-id/\u003C/code>).\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_properties: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster properties&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of sets of cluster properties for Pacemaker cluster-wide configuration.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster resources&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource definitions for the Pacemaker resources configured by the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role, including fencing resources.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRed Hat Knowledgebase article \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2943361\">Exploring RHEL High Availability’s Components - sbd and fence_sbd\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRed Hat Knowledgebase article \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2941601\">Design Guidance for RHEL High Availability Clusters - sbd Considerations\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRed Hat Knowledgebase article \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2800691\">Support Policies for RHEL High Availability Clusters - sbd and fence_sbd\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.12. Configuring a high availability cluster with SBD node fencing by using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> variable\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou must configure a Red Hat high availability cluster with at least one fencing device to ensure the cluster-provided services remain available when a node in the cluster encounters a problem. If your environment does not allow for a remotely accessible power switch to fence a cluster node, you can configure fencing by using a STONITH Block Device (SBD). This device provides a node fencing mechanism for Pacemaker-based clusters through the exchange of messages by means of shared block storage. SBD integrates with Pacemaker, a watchdog device and, optionally, shared storage to arrange for nodes to reliably self-terminate when fencing is required.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to configure SBD fencing in an automated fashion. With \u003Ccode class=\"literal\">ha_cluster\u003C/code>, you can configure watchdog and SBD devices on a node-to-node basis by using one of two variables:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code>: (RHEL 9.5 and later) This is a single variable you define in a playbook file. It is a list of dictionaries where each dictionary defines options for one node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ha_cluster\u003C/code>: (RHEL 9.1 and later) A dictionary that defines options for one node only. You configure the \u003Ccode class=\"literal\">ha_cluster\u003C/code> variable in an inventory file. To set different values for each node, you define the variable separately for each node.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIf both the \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> and \u003Ccode class=\"literal\">ha_cluster\u003C/code> variables contain SBD options, those in \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> have precedence.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf both the \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> and \u003Ccode class=\"literal\">ha_cluster\u003C/code> variables contain SBD options, those in \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> have precedence.`\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> system role to create a high availability cluster with SBD fencing. This example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> variable in an inventory file to configure node addresses and SBD options on a per-node basis. For an example procedure that uses the \u003Ccode class=\"literal\">ha_cluster_node_options\u003C/code> variable in a playbook file, see \u003Ca class=\"link\" href=\"#configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.11. Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable\">Configuring a high availability cluster with SBD node fencing by using the ha_cluster_nodes_options variable\u003C/a>.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file for your cluster that configures watchdog and SBD devices for each node by using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> variable, as in the following exampla;e\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">all:\n  hosts:\n    node1:\n      ha_cluster:\n        sbd_watchdog_modules:\n          - iTCO_wdt\n        sbd_watchdog_modules_blocklist:\n          - ipmi_watchdog\n        sbd_watchdog: /dev/watchdog1\n        sbd_devices:\n          - /dev/disk/by-id/000001\n          - /dev/disk/by-id/000001\n          - /dev/disk/by-id/000003\n    node2:\n      ha_cluster:\n        sbd_watchdog_modules:\n          - iTCO_wdt\n        sbd_watchdog_modules_blocklist:\n          - ipmi_watchdog\n        sbd_watchdog: /dev/watchdog1\n        sbd_devices:\n          - /dev/disk/by-id/000001\n          - /dev/disk/by-id/000002\n          - /dev/disk/by-id/000003\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe SBD and watchdog settings specified in the example inventory include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sbd_watchdog_modules\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tWatchdog kernel modules to be loaded, which create \u003Ccode class=\"literal\">/dev/watchdog*\u003C/code> devices.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sbd_watchdog_modules_blocklist\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tWatchdog kernel modules to be unloaded and blocked.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sbd_watchdog\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tWatchdog device to be used by SBD.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sbd_devices\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDevices to use for exchanging SBD messages and for monitoring. Always refer to the devices using the long, stable device name (\u003Ccode class=\"literal\">/dev/disk/by-id/\u003C/code>).\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, as in the following example. Since you have specified the SBD and watchog variables in an inventory, you do not need to include them in the playbook.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Configure a cluster with sbd fencing devices configured in an inventory file\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n          ha_cluster_cluster_name: my-new-cluster\n          ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n          ha_cluster_manage_firewall: true\n          ha_cluster_manage_selinux: true\n          ha_cluster_sbd_enabled: true\n          ha_cluster_sbd_options:\n            - name: delay-start\n              value: 'no'\n            - name: startmode\n              value: always\n            - name: timeout-action\n              value: 'flush,reboot'\n            - name: watchdog-timeout\n              value: 30\n          # Best practice for setting SBD timeouts:\n          # watchdog-timeout * 2 = msgwait-timeout (set automatically)\n          # msgwait-timeout * 1.2 = stonith-timeout\n          ha_cluster_cluster_properties:\n            - attrs:\n                - name: stonith-timeout\n                  value: 72\n          ha_cluster_resource_primitives:\n            - id: fence_sbd\n              agent: 'stonith:fence_sbd'\n              instance_attrs:\n                - attrs:\n                    # taken from host_vars\n                    # this only works if all nodes have the same sbd_devices\n                    - name: devices\n                      value: \"{{ ha_cluster.sbd_devices | join(',') }}\"\n                    - name: pcmk_delay_base\n                      value: 30\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>cluster_name\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>password\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_sbd_enabled: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the cluster can use the SBD node fencing mechanism.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_sbd_options: \u003Cspan class=\"emphasis\">\u003Cem>sbd options\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of name-value dictionaries specifying SBD options. For information about these options, see the \u003Ccode class=\"literal\">Configuration via environment\u003C/code> section of the \u003Ccode class=\"literal\">sbd\u003C/code>(8) man page on your system.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_properties: \u003Cspan class=\"emphasis\">\u003Cem>cluster properties\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of sets of cluster properties for Pacemaker cluster-wide configuration.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives: \u003Cspan class=\"emphasis\">\u003Cem>cluster resources\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource definitions for the Pacemaker resources configured by the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role, including fencing resources.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRed Hat Knowledgebase article \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2943361\">Exploring RHEL High Availability’s Components - sbd and fence_sbd\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRed Hat Knowledgebase article \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2941601\">Design Guidance for RHEL High Availability Clusters - sbd Considerations\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRed Hat Knowledgebase article \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2800691\">Support Policies for RHEL High Availability Clusters - sbd and fence_sbd\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-hacluster-with-placement-strategy-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.13. Configuring a placement strategy for a high availability cluster by using the RHEL \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t(RHEL 9.5 and later) A Pacemaker cluster allocates resources according to a resource allocation score. By default, if the resource allocation scores on all the nodes are equal, Pacemaker allocates the resource to the node with the smallest number of allocated resources. If the resources in your cluster use significantly different proportions of a node’s capacities, such as memory or I/O, the default behavior may not be the best strategy for balancing your system’s workload. In this case, you can customize an allocation strategy by configuring utilization attributes and placement strategies for nodes and resources.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor detailed information about configuring utilization attributes and placement strategies, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#proc_setting-shutdown-lock-configuring-resources-to-remain-stopped\">Configuring a node placement strategy\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create a high availability cluster in an automated fashion that configures utilization attributes to define a placement strategy.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Configure a cluster with utilization attributes\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n          ha_cluster_cluster_name: my-new-cluster\n          ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n          ha_cluster_manage_firewall: true\n          ha_cluster_manage_selinux: true\n          ha_cluster_cluster_properties:\n            - attrs:\n                - name: placement-strategy\n                  value: utilization\n          ha_cluster_node_options:\n            - node_name: node1\n              utilization:\n                - attrs:\n                    - name: utilization1\n                      value: 1\n                    - name: utilization2\n                      value: 2\n            - node_name: node2\n              utilization:\n                - attrs:\n                    - name: utilization1\n                      value: 3\n                    - name: utilization2\n                      value: 4\n          ha_cluster_resource_primitives:\n            - id: resource1\n              agent: 'ocf:pacemaker:Dummy'\n              utilization:\n                - attrs:\n                    - name: utilization1\n                      value: 2\n                    - name: utilization2\n                      value: 3\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_properties: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster properties&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tList of sets of cluster properties for Pacemaker cluster-wide configuration. For utilization to have an effect, the \u003Ccode class=\"literal\">placement-strategy\u003C/code> property must be set and its value must be different from the value \u003Ccode class=\"literal\">default\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">`ha_cluster_node_options: \u003Cspan class=\"emphasis\">\u003Cem>&lt;node options&gt;\u003C/em>\u003C/span>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines various settings which vary from cluster node to cluster node.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster resources&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tA list of resource definitions for the Pacemaker resources configured by the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role, including fencing resources.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-alerts-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.14. Configuring alerts for a high availability cluster by using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t(RHEL 9.5 and later) When a Pacemaker event occurs, such as a resource or a node failure or a configuration change, you may want to take some external action. For example, you may want to send an email message or log to a file or update a monitoring system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can configure your system to take an external action by using alert agents. These are external programs that the cluster calls in the same manner as the cluster calls resource agents to handle resource configuration and operation. The cluster passes information about the event to the agent through environment variables.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role configures the cluster to call external programs to handle alerts. However, you must provide these programs and distribute them to cluster nodes.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tFor more detailed information about alert agents, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_configuring-pacemaker-alert-agents_configuring-and-managing-high-availability-clusters\">Triggering scripts for cluster events\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create a high availability cluster in an automated fashion that configures a Pacemaker alert.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Configure a cluster with alerts\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n          ha_cluster_cluster_name: my-new-cluster\n          ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n          ha_cluster_manage_firewall: true\n          ha_cluster_manage_selinux: true\n          ha_cluster_alerts:\n            - id: alert1\n              path: /alert1/path\n              description: \u003Cspan class=\"emphasis\">\u003Cem>Alert1 description\u003C/em>\u003C/span>\n              instance_attrs:\n                - attrs:\n                    - name: \u003Cspan class=\"emphasis\">\u003Cem>alert_attr1_name\u003C/em>\u003C/span>\n                      value: \u003Cspan class=\"emphasis\">\u003Cem>alert_attr1_value\u003C/em>\u003C/span>\n              meta_attrs:\n                - attrs:\n                    - name: \u003Cspan class=\"emphasis\">\u003Cem>alert_meta_attr1_name\u003C/em>\u003C/span>\n                      value: \u003Cspan class=\"emphasis\">\u003Cem>alert_meta_attr1_value\u003C/em>\u003C/span>\n              recipients:\n                - value: recipient_value\n                  id: recipient1\n                  description: Recipient1 description\n                  instance_attrs:\n                    - attrs:\n                        - name: \u003Cspan class=\"emphasis\">\u003Cem>recipient_attr1_name\u003C/em>\u003C/span>\n                          value: \u003Cspan class=\"emphasis\">\u003Cem>recipient_attr1_value\u003C/em>\u003C/span>\n                  meta_attrs:\n                    - attrs:\n                        - name: \u003Cspan class=\"emphasis\">\u003Cem>recipient_meta_attr1_name\u003C/em>\u003C/span>\n                          value: \u003Cspan class=\"emphasis\">\u003Cem>recipient_meta_attr1_value\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_alerts: \u003Cspan class=\"emphasis\">\u003Cem>&lt;alert definitions&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tA variable that defines Pacemaker alerts.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> - ID of an alert.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">path\u003C/code> - Path to the alert agent executable.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">description\u003C/code>- Description of the alert.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">instance_attrs\u003C/code> - List of sets of the alert’s instance attributes. Currently, only one set is supported, so the first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">meta_attrs\u003C/code> - List of sets of the alert’s meta attributes. Currently, only one set is supported, so the first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">recipients\u003C/code> - List of alert’s recipients.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">value\u003C/code>- Value of a recipient.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">id\u003C/code> - ID of the recipient.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">description\u003C/code> - Description of the recipient.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">instance_attrs\u003C/code> -List of sets of the recipient’s instance attributes. Currently, only one set is supported, so the first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">meta_attrs\u003C/code> - List of sets of the recipient’s meta attributes. Currently, only one set is supported, so the first set is used and the rest are ignored.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.15. Configuring a high availability cluster using a quorum device\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t(RHEL 9.2 and later) Your cluster can sustain more node failures than standard quorum rules permit when you configure a separate quorum device. The quorum device acts as a lightweight arbitration device for the cluster. A quorum device is recommended for clusters with an even number of nodes. With two-node clusters, the use of a quorum device can better determine which node survives in a split-brain situation.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor information about quorum devices, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_configuring-quorum-devices-configuring-and-managing-high-availability-clusters\">Configuring quorum devices\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo configure a high availability cluster with a separate quorum device by using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role, first set up the quorum device. After setting up the quorum device, you can use the device in any number of clusters.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">11.15.1. Configuring a quorum device\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tTo configure a quorum device using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role, follow the steps in this example procedure. Note that you cannot run a quorum device on a cluster node.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe system that you will use to run the quorum device has active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe inventory file specifies the quorum devices as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook-qdevice.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure a host with a quorum device\n  hosts: nodeQ\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create a quorum device for the cluster\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_present: false\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_qnetd:\n          present: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_present: false\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tA variable that, if set to \u003Ccode class=\"literal\">false\u003C/code>, determines that all cluster configuration will be removed from the target host.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_qnetd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;quorum_device_options&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tA variable that configures a \u003Ccode class=\"literal\">qnetd\u003C/code> host.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook-qdevice.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook-qdevice.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-cluster-to-use-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">11.15.2. Configuring a cluster to use a quorum device\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tTo configure a cluster to use a quorum device, follow the steps in this example procedure.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou have configured a quorum device.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook-cluster-qdevice.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure a cluster to use a quorum device\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create cluster that uses a quorum device\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_quorum:\n          device:\n            model: net\n            model_options:\n              - name: host\n                value: nodeQ\n              - name: algorithm\n                value: lms\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_quorum: \u003Cspan class=\"emphasis\">\u003Cem>&lt;quorum_parameters&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tA variable that configures cluster quorum which you can use to specify that the cluster uses a quorum device.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook-cluster-qdevice.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook-cluster-qdevice.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"configuring-ha-cluster-with-node-attributes_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.16. Configuring a high availability cluster with node attributes\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t(RHEL 9.4 and later) You can use Pacemaker rules to make your configuration more dynamic. For example, you can use a node attribute to assign machines to different processing groups based on time and then use that attribute when creating location constraints.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNode attribute expressions are used to control a resource based on the attributes defined by a node or nodes. For information on node attributes, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#assembly_determining-resource-location-with-rules-configuring-and-managing-high-availability-clusters\">Determining resource location with rules\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example procedure uses the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role to create a high availability cluster that configures node attributes.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: node1 node2\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create a cluster that defines node attributes\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_cluster_name: my-new-cluster\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_node_options:\n          - node_name: node1\n            attributes:\n              - attrs:\n                  - name: attribute1\n                    value: value1A\n                  - name: attribute2\n                    value: value2A\n          - node_name: node2\n            attributes:\n              - attrs:\n                  - name: attribute1\n                    value: value1B\n                  - name: attribute2\n                    value: value2B\u003C/pre>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_node_options: \u003Cspan class=\"emphasis\">\u003Cem>&lt;node_settings&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that defines various settings that vary from one cluster node to another.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/configuring_and_managing_high_availability_clusters/index#ref_pacemaker-rules.adoc-determining-resource-location-with-rules\">Pacemaker rules\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-http-ha-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.17. Configuring an Apache HTTP server in a high availability cluster with the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tHigh availability clusters provide highly available services by eliminating single points of failure and by failing over services from one cluster node to another in case a node becomes inoperative. Red Hat provides a variety of documentation for planning, configuring, and maintaining a Red Hat high availability cluster. For a listing of articles that provide indexes to the various areas of Red Hat cluster documentation, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6565761\">Red Hat High Availability Add-On Documentation Guide\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example use case configures an active/passive Apache HTTP server in a two-node Red Hat Enterprise Linux High Availability Add-On cluster by using the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role. In this use case, clients access the Apache HTTP server through a floating IP address. The web server runs on one of two nodes in the cluster. If the node on which the web server is running becomes inoperative, the web server starts up again on the second node of the cluster with minimal service interruption.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis example uses an APC power switch with a host name of \u003Ccode class=\"literal\">zapc.example.com\u003C/code>. If the cluster does not use any other fence agents, you can optionally list only the fence agents your cluster requires when defining the \u003Ccode class=\"literal\">ha_cluster_fence_agent_packages\u003C/code> variable, as in this example.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role replaces any existing cluster configuration on the specified nodes. Any settings not specified in the playbook will be lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe systems that you will use as your cluster members have active subscription coverage for RHEL and the RHEL High Availability Add-On.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe inventory file specifies the cluster nodes as described in \u003Ca class=\"link\" href=\"#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role\" title=\"11.2. Specifying an inventory for the ha_cluster RHEL system role\">Specifying an inventory for the ha_cluster RHEL system role\u003C/a>. For general information about creating an inventory file, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles\">Preparing a control node on RHEL 9\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured an LVM logical volume with an XFS file system, as described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_configuring-active-passive-http-server-in-a-cluster-configuring-and-managing-high-availability-clusters#proc_configuring-lvm-volume-with-ext4-file-system-configuring-ha-http\">Configuring an LVM volume with an XFS file system in a Pacemaker cluster\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured an Apache HTTP server, as described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_configuring-active-passive-http-server-in-a-cluster-configuring-and-managing-high-availability-clusters#proc_configuring-apache-http-web-server-configuring-ha-http\">Configuring an Apache HTTP Server\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour system includes an APC power switch that will be used to fence the cluster nodes.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">cluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a high availability cluster\n  hosts: z1.example.com z2.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Configure active/passive Apache server in a high availability cluster\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ha_cluster\n      vars:\n        ha_cluster_hacluster_password: \"{{ cluster_password }}\"\n        ha_cluster_cluster_name: my_cluster\n        ha_cluster_manage_firewall: true\n        ha_cluster_manage_selinux: true\n        ha_cluster_fence_agent_packages:\n          - fence-agents-apc-snmp\n        ha_cluster_resource_primitives:\n          - id: myapc\n            agent: stonith:fence_apc_snmp\n            instance_attrs:\n              - attrs:\n                  - name: ipaddr\n                    value: zapc.example.com\n                  - name: pcmk_host_map\n                    value: z1.example.com:1;z2.example.com:2\n                  - name: login\n                    value: apc\n                  - name: passwd\n                    value: apc\n          - id: my_lvm\n            agent: ocf:heartbeat:LVM-activate\n            instance_attrs:\n              - attrs:\n                  - name: vgname\n                    value: my_vg\n                  - name: vg_access_mode\n                    value: system_id\n          - id: my_fs\n            agent: Filesystem\n            instance_attrs:\n              - attrs:\n                  - name: device\n                    value: /dev/my_vg/my_lv\n                  - name: directory\n                    value: /var/www\n                  - name: fstype\n                    value: xfs\n          - id: VirtualIP\n            agent: IPaddr2\n            instance_attrs:\n              - attrs:\n                  - name: ip\n                    value: 198.51.100.3\n                  - name: cidr_netmask\n                    value: 24\n          - id: Website\n            agent: apache\n            instance_attrs:\n              - attrs:\n                  - name: configfile\n                    value: /etc/httpd/conf/httpd.conf\n                  - name: statusurl\n                    value: http://127.0.0.1/server-status\n        ha_cluster_resource_groups:\n          - id: apachegroup\n            resource_ids:\n              - my_lvm\n              - my_fs\n              - VirtualIP\n              - Website\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_cluster_name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe name of the cluster you are creating.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_hacluster_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe password of the \u003Ccode class=\"literal\">hacluster\u003C/code> user. The \u003Ccode class=\"literal\">hacluster\u003C/code> user has full access to a cluster.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the firewall.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA variable that determines whether the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role manages the ports of the firewall high availability service using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_fence_agent_packages: \u003Cspan class=\"emphasis\">\u003Cem>&lt;fence_agent_packages&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of fence agent packages to install.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_primitives: \u003Cspan class=\"emphasis\">\u003Cem>&lt;cluster_resources&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource definitions for the Pacemaker resources configured by the ha_cluster RHEL system role, including fencing\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ha_cluster_resource_groups: \u003Cspan class=\"emphasis\">\u003Cem>&lt;resource_groups&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of resource group definitions configured by the \u003Ccode class=\"literal\">ha_cluster\u003C/code> RHEL system role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen you use the \u003Ccode class=\"literal\">apache\u003C/code> resource agent to manage Apache, it does not use \u003Ccode class=\"literal\">systemd\u003C/code>. Because of this, you must edit the \u003Ccode class=\"literal\">logrotate\u003C/code> script supplied with Apache so that it does not use \u003Ccode class=\"literal\">systemctl\u003C/code> to reload Apache.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRemove the following line in the \u003Ccode class=\"literal\">/etc/logrotate.d/httpd\u003C/code> file on each node in the cluster.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-bash\"># /bin/systemctl reload httpd.service &gt; /dev/null 2&gt;/dev/null || true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace the line you removed with the following three lines, specifying \u003Ccode class=\"literal\">/var/run/httpd-\u003Cspan class=\"emphasis\">\u003Cem>website\u003C/em>\u003C/span>.pid\u003C/code> as the PID file path where \u003Cspan class=\"emphasis\">\u003Cem>website\u003C/em>\u003C/span> is the name of the Apache resource. In this example, the Apache resource name is \u003Ccode class=\"literal\">Website\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-bash\">/usr/bin/test -f /var/run/httpd-Website.pid &gt;/dev/null 2&gt;/dev/null &amp;&amp;\n/usr/bin/ps -q $(/usr/bin/cat /var/run/httpd-Website.pid) &gt;/dev/null 2&gt;/dev/null &amp;&amp;\n/usr/sbin/httpd -f /etc/httpd/conf/httpd.conf -c \"PidFile /var/run/httpd-Website.pid\" -k graceful &gt; /dev/null 2&gt;/dev/null || true\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFrom one of the nodes in the cluster, check the status of the cluster. Note that all four resources are running on the same node, \u003Ccode class=\"literal\">z1.example.com\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you find that the resources you configured are not running, you can run the \u003Ccode class=\"literal command\">pcs resource debug-start \u003Cspan class=\"emphasis\">\u003Cem>resource\u003C/em>\u003C/span>\u003C/code> command to test the resource configuration.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@z1 ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>pcs status\u003C/strong>\u003C/span>\nCluster name: my_cluster\nLast updated: Wed Jul 31 16:38:51 2013\nLast change: Wed Jul 31 16:42:14 2013 via crm_attribute on z1.example.com\nStack: corosync\nCurrent DC: z2.example.com (2) - partition with quorum\nVersion: 1.1.10-5.el7-9abe687\n2 Nodes configured\n6 Resources configured\n\nOnline: [ z1.example.com z2.example.com ]\n\nFull list of resources:\n myapc  (stonith:fence_apc_snmp):       Started z1.example.com\n Resource Group: apachegroup\n     my_lvm     (ocf::heartbeat:LVM-activate):   Started z1.example.com\n     my_fs      (ocf::heartbeat:Filesystem):    Started z1.example.com\n     VirtualIP  (ocf::heartbeat:IPaddr2):       Started z1.example.com\n     Website    (ocf::heartbeat:apache):        Started z1.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOnce the cluster is up and running, you can point a browser to the IP address you defined as the \u003Ccode class=\"literal\">IPaddr2\u003C/code> resource to view the sample display, consisting of the simple word \"Hello\".\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Hello\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo test whether the resource group running on \u003Ccode class=\"literal\">z1.example.com\u003C/code> fails over to node \u003Ccode class=\"literal\">z2.example.com\u003C/code>, put node \u003Ccode class=\"literal\">z1.example.com\u003C/code> in \u003Ccode class=\"literal\">standby\u003C/code> mode, after which the node will no longer be able to host resources.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@z1 ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>pcs node standby z1.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter putting node \u003Ccode class=\"literal\">z1\u003C/code> in \u003Ccode class=\"literal\">standby\u003C/code> mode, check the cluster status from one of the nodes in the cluster. Note that the resources should now all be running on \u003Ccode class=\"literal\">z2\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@z1 ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>pcs status\u003C/strong>\u003C/span>\nCluster name: my_cluster\nLast updated: Wed Jul 31 17:16:17 2013\nLast change: Wed Jul 31 17:18:34 2013 via crm_attribute on z1.example.com\nStack: corosync\nCurrent DC: z2.example.com (2) - partition with quorum\nVersion: 1.1.10-5.el7-9abe687\n2 Nodes configured\n6 Resources configured\n\nNode z1.example.com (1): standby\nOnline: [ z2.example.com ]\n\nFull list of resources:\n\n myapc  (stonith:fence_apc_snmp):       Started z1.example.com\n Resource Group: apachegroup\n     my_lvm     (ocf::heartbeat:LVM-activate):  Started z2.example.com\n     my_fs      (ocf::heartbeat:Filesystem):    Started z2.example.com\n     VirtualIP  (ocf::heartbeat:IPaddr2):       Started z2.example.com\n     Website    (ocf::heartbeat:apache):        Started z2.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe web site at the defined IP address should still display, without interruption.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo remove \u003Ccode class=\"literal\">z1\u003C/code> from \u003Ccode class=\"literal\">standby\u003C/code> mode, enter the following command.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@z1 ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>pcs node unstandby z1.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tRemoving a node from \u003Ccode class=\"literal\">standby\u003C/code> mode does not in itself cause the resources to fail back over to that node. This will depend on the \u003Ccode class=\"literal\">resource-stickiness\u003C/code> value for the resources. For information about the \u003Ccode class=\"literal\">resource-stickiness\u003C/code> meta attribute, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_high_availability_clusters/assembly_determining-which-node-a-resource-runs-on-configuring-and-managing-high-availability-clusters#proc_setting-resource-stickiness-determining-which-node-a-resource-runs-on\">Configuring a resource to prefer its current node\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ha_cluster/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ha_cluster/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 12. Configuring the \u003Ccode class=\"literal\">systemd\u003C/code> journal by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tWith the \u003Ccode class=\"literal\">journald\u003C/code> RHEL system role you can automate the \u003Ccode class=\"literal\">systemd\u003C/code> journal, and configure persistent logging by using the Red Hat Ansible Automation Platform.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-persistent-logging-by-using-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.1. Configuring persistent logging by using the \u003Ccode class=\"literal\">journald\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, the \u003Ccode class=\"literal\">systemd\u003C/code> journal stores logs only in a small ring buffer in \u003Ccode class=\"literal\">/run/log/journal\u003C/code>, which is not persistent. Rebooting the system also removes journal database logs. You can configure persistent logging consistently on multiple systems by using the \u003Ccode class=\"literal\">journald\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure journald\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure persistent logging\n      ansible.builtin.include_role:\n        name: rhel-system-roles.journald\n      vars:\n        journald_persistent: true\n        journald_max_disk_size: \u003Cspan class=\"emphasis\">\u003Cem>&lt;size&gt;\u003C/em>\u003C/span>\n        journald_per_user: true\n        journald_sync_interval: \u003Cspan class=\"emphasis\">\u003Cem>&lt;interval&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">journald_persistent: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables persistent logging.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">journald_max_disk_size: \u003Cspan class=\"emphasis\">\u003Cem>&lt;size&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSpecifies the maximum size of disk space for journal files in MB, for example, \u003Ccode class=\"literal\">2048\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">journald_per_user: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tConfigures \u003Ccode class=\"literal\">journald\u003C/code> to keep log data separate for each user.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">journald_sync_interval: \u003Cspan class=\"emphasis\">\u003Cem>&lt;interval&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tSets the synchronization interval in minutes, for example, \u003Ccode class=\"literal\">1\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.journald/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.journald/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/journald/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 13. Configuring automatic crash dumps by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tTo manage kdump using Ansible, you can use the \u003Ccode class=\"literal\">kdump\u003C/code> role, which is one of the RHEL system roles available in RHEL 9.\n\t\t\u003C/p>\u003Cp>\n\t\t\tUsing the \u003Ccode class=\"literal\">kdump\u003C/code> role enables you to specify where to save the contents of the system’s memory for later analysis.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-kdump-using-rhel-system-roles_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.1. Configuring the kernel crash dumping mechanism by using the \u003Ccode class=\"literal\">kdump\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tKernel crash dumping is a crucial feature for diagnosing and troubleshooting system issues. When your system encounters a kernel panic or other critical failure, crash kernel dumping allows you to capture a memory dump (core dump) of the kernel’s state at the time of the failure.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy using an Ansible playbook, you can set kernel crash dump parameters on multiple systems using the \u003Ccode class=\"literal\">kdump\u003C/code> RHEL system role. This ensures consistent settings across all managed nodes for the \u003Ccode class=\"literal\">kdump\u003C/code> service.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">kdump\u003C/code> system role replaces the content in the \u003Ccode class=\"literal\">/etc/kdump.conf\u003C/code> and \u003Ccode class=\"literal\">/etc/sysconfig/kdump\u003C/code> configuration files. Previous settings are changed to those specified in the role variables, and lost if they are not specified in the role variables.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuring kernel crash dumping\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Setting the kdump directory.\n      ansible.builtin.include_role:\n        name: rhel-system-roles.kdump\n      vars:\n        kdump_target:\n          type: raw\n          location: /dev/sda1\n        kdump_path: /var/crash/vmcore\n        kernel_settings_reboot_ok: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kdump_target: \u003Cspan class=\"emphasis\">\u003Cem>&lt;type_and_location&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tWrites \u003Ccode class=\"literal\">vmcore\u003C/code> to a location other than the root file system. The \u003Ccode class=\"literal\">location\u003C/code> refers to a partition (by name, label, or UUID) when the \u003Ccode class=\"literal\">type\u003C/code> is raw or file system.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kernel_settings_reboot_ok: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe default is \u003Ccode class=\"literal\">false\u003C/code>. If set to \u003Ccode class=\"literal\">true\u003C/code>, the system role will determine if a reboot of the managed host is necessary for the requested changes to take effect and reboot it. If set to \u003Ccode class=\"literal\">false\u003C/code>, the role will return the variable \u003Ccode class=\"literal\">kernel_settings_reboot_required\u003C/code> with a value of \u003Ccode class=\"literal\">true\u003C/code>, indicating that a reboot is required. In this case, a user must reboot the managed node manually.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.kdump/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the kernel crash dump parameters:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'grep crashkernel /proc/cmdline'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.kdump/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/kdump/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 14. Configuring kernel parameters permanently by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tYou can use the \u003Ccode class=\"literal\">kernel_settings\u003C/code> RHEL system role to configure kernel parameters on multiple clients at once. This solution:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tProvides a friendly interface with efficient input setting.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tKeeps all intended kernel parameters in one place.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tAfter you run the \u003Ccode class=\"literal\">kernel_settings\u003C/code> role from the control machine, the kernel parameters are applied to the managed systems immediately and persist across reboots.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tNote that RHEL system role delivered over RHEL channels are available to RHEL customers as an RPM package in the default AppStream repository. RHEL system role are also available as a collection to customers with Ansible subscriptions over Ansible Automation Hub.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.1. Applying selected kernel parameters by using the \u003Ccode class=\"literal\">kernel_settings\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">kernel_settings\u003C/code> RHEL system role to remotely configure various kernel parameters across multiple managed operating systems with persistent effects. For example, you can configure:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTransparent hugepages to increase performance by reducing the overhead of managing smaller pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe largest packet sizes are to be transmitted over the network with the loopback interface.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLimits on files, which can be opened simultaneously.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuring kernel settings\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure hugepages, packet size for loopback device, and limits on simultaneously open files.\n      ansible.builtin.include_role:\n        name: rhel-system-roles.kernel_settings\n      vars:\n        kernel_settings_sysctl:\n          - name: fs.file-max\n            value: 400000\n          - name: kernel.threads-max\n            value: 65536\n        kernel_settings_sysfs:\n          - name: /sys/class/net/lo/mtu\n            value: 65000\n        kernel_settings_transparent_hugepages: madvise\n        kernel_settings_reboot_ok: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kernel_settings_sysfs: \u003Cspan class=\"emphasis\">\u003Cem>&lt;list_of_sysctl_settings&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA YAML list of \u003Ccode class=\"literal\">sysctl\u003C/code> settings and the values you want to assign to these settings.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kernel_settings_transparent_hugepages: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tControls the memory subsystem Transparent Huge Pages (THP) setting. You can disable THP support (\u003Ccode class=\"literal\">never\u003C/code>), enable it system wide (\u003Ccode class=\"literal\">always\u003C/code>) or inside \u003Ccode class=\"literal\">MAD_HUGEPAGE\u003C/code> regions (\u003Ccode class=\"literal\">madvise\u003C/code>).\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kernel_settings_reboot_ok: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe default is \u003Ccode class=\"literal\">false\u003C/code>. If set to \u003Ccode class=\"literal\">true\u003C/code>, the system role will determine if a reboot of the managed host is necessary for the requested changes to take effect and reboot it. If set to \u003Ccode class=\"literal\">false\u003C/code>, the role will return the variable \u003Ccode class=\"literal\">kernel_settings_reboot_required\u003C/code> with a value of \u003Ccode class=\"literal\">true\u003C/code>, indicating that a reboot is required. In this case, a user must reboot the managed node manually.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.kdump/README.md\u003C/code> file on the control node.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the affected kernel parameters:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'sysctl fs.file-max kernel.threads-max net.ipv6.conf.lo.mtu'\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'cat /sys/kernel/mm/transparent_hugepage/enabled'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.kernel_settings/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/kernel_settings/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 15. Configuring the GRUB 2 boot loader by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tBy using the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role, you can automate the configuration and management tasks related to the GRUB2 boot loader.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis role currently supports configuring the GRUB2 boot loader, which runs on the following CPU architectures:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tAMD and Intel 64-bit architectures (x86-64)\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe 64-bit ARM architecture (ARMv8.0)\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tIBM Power Systems, Little Endian (POWER9)\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"updating-the-existing-boot-loader-entries-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.1. Updating the existing boot loader entries by using the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role to update the existing entries in the GRUB2 boot menu in an automated fashion. This way you can efficiently pass specific kernel command-line parameters that can optimize the performance or behavior of your systems.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, if you leverage systems, where detailed boot messages from the kernel and init system are not necessary, use \u003Ccode class=\"literal\">bootloader\u003C/code> to apply the \u003Ccode class=\"literal\">quiet\u003C/code> parameter to your existing boot loader entries on your managed nodes to achieve a cleaner, less cluttered, and more user-friendly booting experience.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou identified the kernel that corresponds to the boot loader entry you want to update.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuration and management of GRUB2 boot loader\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Update existing boot loader entries\n      ansible.builtin.include_role:\n        name: rhel-system-roles.bootloader\n      vars:\n        bootloader_settings:\n          - kernel:\n              path: /boot/vmlinuz-5.14.0-362.24.1.el9_3.aarch64\n            options:\n              - name: quiet\n                state: present\n        bootloader_reboot_ok: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kernel\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSpecifies the kernel connected with the boot loader entry that you want to update.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">options\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSpecifies the kernel command-line parameters to update for your chosen boot loader entry (kernel).\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">bootloader_reboot_ok: \u003Cspan class=\"emphasis\">\u003Cem>true\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe role detects that a reboot is needed for the changes to take effect and performs a restart of the managed node.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that your specified boot loader entry has updated kernel command-line parameters:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.command -a 'grubby --info=ALL'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n...\nindex=1\nkernel=\"/boot/vmlinuz-5.14.0-362.24.1.el9_3.aarch64\"\nargs=\"ro crashkernel=1G-4G:256M,4G-64G:320M,64G-:576M rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap $tuned_params \u003Cspan class=\"strong strong\">\u003Cstrong>quiet\u003C/strong>\u003C/span>\"\nroot=\"/dev/mapper/rhel-root\"\ninitrd=\"/boot/initramfs-5.14.0-362.24.1.el9_3.aarch64.img $tuned_initrd\"\ntitle=\"Red Hat Enterprise Linux (5.14.0-362.24.1.el9_3.aarch64) 9.4 (Plow)\"\nid=\"2c9ec787230141a9b087f774955795ab-5.14.0-362.24.1.el9_3.aarch64\"\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/bootloader/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/playbooks.html\">Working With Playbooks\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html\">Using Variables\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html\">Roles\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#configuring-kernel-command-line-parameters_managing-monitoring-and-updating-the-kernel\">Configuring kernel command-line parameters\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"securing-the-boot-menu-with-password-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.2. Securing the boot menu with password by using the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role to set a password to the GRUB2 boot menu in an automated fashion. This way you can efficiently prevent unauthorized users from modifying boot parameters, and to have better control over the system boot.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuration and management of GRUB2 boot loader\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Set the bootloader password\n      ansible.builtin.include_role:\n        name: rhel-system-roles.bootloader\n      vars:\n        bootloader_password: \"{{ pwd }}\"\n        bootloader_reboot_ok: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">bootloader_password: \u003Cspan class=\"emphasis\">\u003Cem>\"{{ pwd }}\"\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe variable ensures protection of boot parameters with a password.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">bootloader_reboot_ok: \u003Cspan class=\"emphasis\">\u003Cem>true\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe role detects that a reboot is needed for the changes to take effect and performs a restart of the managed node.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tChanging the boot loader password is not an idempotent transaction. This means that if you apply the same Ansible playbook again, the result will not be the same, and the state of the managed node will change.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your managed node during the GRUB2 boot menu screen, press the \u003Ckbd class=\"keycap\">e\u003C/kbd> key for edit.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/cd35c09a617934aa83c413f94deb1c9a/bootloader_password_verification1.png\" alt=\"GRUB2 boot loader menu\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou will be prompted for a username and a password:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/1d6466a16badfca79aff8cbb9eba7cb2/bootloader_password_verification2.png\" alt=\"GRUB2 menu lock\"/>\u003C/div>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">Enter username: root\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe boot loader username is always \u003Ccode class=\"literal\">root\u003C/code> and you do not need to specify it in your Ansible playbook.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">Enter password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe boot loader password corresponds to the \u003Ccode class=\"literal\">pwd\u003C/code> variable that you defined in the \u003Ccode class=\"literal\">vault.yml\u003C/code> file.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can view or edit configuration of the particular boot loader entry:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/960bfee9d3a0f90d4e48b74ee4388b0c/bootloader_password_verification3.png\" alt=\"GRUB2 boot loader entry details\"/>\u003C/div>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/bootloader/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-a-timeout-for-the-boot-loader-menu-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.3. Setting a timeout for the boot loader menu by using the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role to configure a timeout for the GRUB2 boot loader menu in an automated fashion. This way you can efficiently update a period of time during which you can intervene and select a non-default boot entry for various purposes.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuration and management of GRUB2 boot loader\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Update the boot loader timeout\n      ansible.builtin.include_role:\n        name: rhel-system-roles.bootloader\n      vars:\n        bootloader_timeout: 10\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">bootloader_timeout: 10\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tInput an integer to control for how long the GRUB2 boot loader menu is displayed before booting the default entry.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRemotely restart your managed node:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.reboot\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED =&gt; {\n    \"changed\": true,\n    \"elapsed\": 21,\n    \"rebooted\": true\n}\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed node, observe the GRUB2 boot menu screen.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/4799ebe2185bd3c825a53458bc866301/bootloader_timeout_verification.png\" alt=\"GRUB2 boot loader menu timeout\"/>\u003C/div>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">The highlighted entry will be executed automatically in 10s\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor how long this boot menu is displayed before GRUB2 automatically uses the default entry.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tAlternative: you can remotely query for the \"timeout\" settings in the \u003Ccode class=\"literal\">/boot/grub2/grub.cfg\u003C/code> file of your managed node:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.command -a \"grep 'timeout' /boot/grub2/grub.cfg\"\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\nif [ x$feature_timeout_style = xy ] ; then\n  set timeout_style=menu\n  \u003Cspan class=\"strong strong\">\u003Cstrong>set timeout=10\u003C/strong>\u003C/span>\n# Fallback normal timeout code in case the timeout_style feature is\n  \u003Cspan class=\"strong strong\">\u003Cstrong>set timeout=10\u003C/strong>\u003C/span>\nif [ x$feature_timeout_style = xy ] ; then\n    set timeout_style=menu\n    \u003Cspan class=\"strong strong\">\u003Cstrong>set timeout=10\u003C/strong>\u003C/span>\n    set orig_timeout_style=${timeout_style}\n    set orig_timeout=${timeout}\n      # timeout_style=menu + timeout=0 avoids the countdown code keypress check\n      set timeout_style=menu\n      \u003Cspan class=\"strong strong\">\u003Cstrong>set timeout=10\u003C/strong>\u003C/span>\n      set timeout_style=hidden\n      \u003Cspan class=\"strong strong\">\u003Cstrong>set timeout=10\u003C/strong>\u003C/span>\nif [ x$feature_timeout_style = xy ]; then\n  if [ \"${menu_show_once_timeout}\" ]; then\n    set timeout_style=menu\n    \u003Cspan class=\"strong strong\">\u003Cstrong>set timeout=10\u003C/strong>\u003C/span>\n    unset menu_show_once_timeout\n    save_env menu_show_once_timeout\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/bootloader/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"collecting-the-boot-loader-configuration-information-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.4. Collecting the boot loader configuration information by using the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">bootloader\u003C/code> RHEL system role to gather information about the GRUB2 boot loader entries in an automated fashion. This way you can quickly identify that your systems are set up to boot correctly, all entries point to the right kernels and initial RAM disk images.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAs a result, you can for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPrevent boot failures.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRevert to a known good state when troubleshooting.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tBe sure that security-related kernel command-line parameters are correctly configured.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuration and management of GRUB2 boot loader\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Gather information about the boot loader configuration\n      ansible.builtin.include_role:\n        name: rhel-system-roles.bootloader\n      vars:\n        bootloader_gather_facts: true\n\n    - name: Display the collected boot loader configuration information\n      debug:\n        var: bootloader_facts\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter you run the preceding playbook on the control node, you will see a similar command-line output as in the following example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">...\n    \"bootloader_facts\": [\n        {\n            \"args\": \"ro crashkernel=1G-4G:256M,4G-64G:320M,64G-:576M rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap $tuned_params quiet\",\n            \"default\": true,\n            \"id\": \"2c9ec787230141a9b087f774955795ab-5.14.0-362.24.1.el9_3.aarch64\",\n            \"index\": \"1\",\n            \"initrd\": \"/boot/initramfs-5.14.0-362.24.1.el9_3.aarch64.img $tuned_initrd\",\n            \"kernel\": \"/boot/vmlinuz-5.14.0-362.24.1.el9_3.aarch64\",\n            \"root\": \"/dev/mapper/rhel-root\",\n            \"title\": \"Red Hat Enterprise Linux (5.14.0-362.24.1.el9_3.aarch64) 9.4 (Plow)\"\n        }\n    ]\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe command-line output shows the following notable configuration information about the boot entry:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">args\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tCommand-line parameters passed to the kernel by the GRUB2 boot loader during the boot process. They configure various settings and behaviors of the kernel, initramfs, and other boot-time components.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">id\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tUnique identifier assigned to each boot entry in a boot loader menu. It consists of machine ID and the kernel version.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">root\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe root filesystem for the kernel to mount and use as the primary filesystem during the boot.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.bootloader/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/bootloader/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/managing_monitoring_and_updating_the_kernel/index#what-boot-entries-are_configuring-kernel-command-line-parameters\">Understanding boot entries\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 16. Configuring logging by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure your local and remote hosts as logging servers in an automated fashion to collect logs from many client systems.\n\t\t\u003C/p>\u003Cp>\n\t\t\tLogging solutions provide multiple ways of reading logs and multiple logging outputs.\n\t\t\u003C/p>\u003Cp>\n\t\t\tFor example, a logging system can receive the following inputs:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLocal files\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ccode class=\"literal\">systemd/journal\u003C/code>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tAnother logging system over the network\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tIn addition, a logging system can have the following outputs:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLogs stored in the local files in the \u003Ccode class=\"literal\">/var/log/\u003C/code> directory\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tLogs sent to Elasticsearch engine\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tLogs forwarded to another logging system\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tWith the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role, you can combine the inputs and outputs to fit your scenario. For example, you can configure a logging solution that stores inputs from \u003Ccode class=\"literal\">journal\u003C/code> in a local file, whereas inputs read from files are both forwarded to another logging system and stored in the local log files.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"proc_filtering-logs-in-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.1. Filtering local log messages by using the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the property-based filter of the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to filter your local log messages based on various conditions. As a result, you can achieve for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog clarity: In a high-traffic environment, logs can grow rapidly. The focus on specific messages, like errors, can help to identify problems faster.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptimized system performance: Excessive amount of logs is usually connected with system performance degradation. Selective logging for only the important events can prevent resource depletion, which enables your systems to run more efficiently.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnhanced security: Efficient filtering through security messages, like system errors and failed logins, helps to capture only the relevant logs. This is important for detecting breaches and meeting compliance standards.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Deploy the logging solution\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Filter logs based on a specific value they contain\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: files_input\n            type: basics\n        logging_outputs:\n          - name: files_output0\n            type: files\n            property: msg\n            property_op: contains\n            property_value: error\n            path: /var/log/errors.log\n          - name: files_output1\n            type: files\n            property: msg\n            property_op: \"!contains\"\n            property_value: error\n            path: /var/log/others.log\n        logging_flows:\n          - name: flow0\n            inputs: [files_input]\n            outputs: [files_output0, files_output1]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging input dictionaries. The \u003Ccode class=\"literal\">type: basics\u003C/code> option covers inputs from \u003Ccode class=\"literal\">systemd\u003C/code> journal or Unix socket.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging output dictionaries. The \u003Ccode class=\"literal\">type: files\u003C/code> option supports storing logs in the local files, usually in the \u003Ccode class=\"literal\">/var/log/\u003C/code> directory. The \u003Ccode class=\"literal\">property: msg\u003C/code>; \u003Ccode class=\"literal\">property: contains\u003C/code>; and \u003Ccode class=\"literal\">property_value: error\u003C/code> options specify that all logs that contain the \u003Ccode class=\"literal\">error\u003C/code> string are stored in the \u003Ccode class=\"literal\">/var/log/errors.log\u003C/code> file. The \u003Ccode class=\"literal\">property: msg\u003C/code>; \u003Ccode class=\"literal\">property: !contains\u003C/code>; and \u003Ccode class=\"literal\">property_value: error\u003C/code> options specify that all other logs are put in the \u003Ccode class=\"literal\">/var/log/others.log\u003C/code> file. You can replace the \u003Ccode class=\"literal\">error\u003C/code> value with the string by which you want to filter.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_flows\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging flow dictionaries to specify relationships between \u003Ccode class=\"literal\">logging_inputs\u003C/code> and \u003Ccode class=\"literal\">logging_outputs\u003C/code>. The \u003Ccode class=\"literal\">inputs: [files_input]\u003C/code> option specifies a list of inputs, from which processing of logs starts. The \u003Ccode class=\"literal\">outputs: [files_output0, files_output1]\u003C/code> option specifies a list of outputs, to which the logs are sent.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed node, test the syntax of the \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rsyslogd -N 1\u003C/strong>\u003C/span>\nrsyslogd: version 8.1911.0-6.el8, config validation run...\nrsyslogd: End of config validation run. Bye.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed node, verify that the system sends messages that contain the \u003Ccode class=\"literal\">error\u003C/code> string to the log:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSend a test message:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logger error\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tView the \u003Ccode class=\"literal\">/var/log/errors.log\u003C/code> log, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /var/log/errors.log\u003C/strong>\u003C/span>\nAug  5 13:48:31 \u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span> root[6778]: error\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>hostname\u003C/em>\u003C/span>\u003C/code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"applying-a-remote-logging-solution-using-the-logging-system-role_configuring-logging-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.2. Applying a remote logging solution by using the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure a remote logging solution, where one or more clients take logs from the \u003Ccode class=\"literal\">systemd-journal\u003C/code> service and forward them to a remote server. The server receives remote input from the \u003Ccode class=\"literal\">remote_rsyslog\u003C/code> and \u003Ccode class=\"literal\">remote_files\u003C/code> configurations, and outputs the logs to local files in directories named by remote host names.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAs a result, you can cover use cases where you need for example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCentralized log management: Collecting, accessing, and managing log messages of multiple machines from a single storage point simplifies day-to-day monitoring and troubleshooting tasks. Also, this use case reduces the need to log into individual machines to check the log messages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnhanced security: Storing log messages in one central place increases chances they are in a secure and tamper-proof environment. Such an environment makes it easier to detect and respond to security incidents more effectively and to meet audit requirements.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tImproved efficiency in log analysis: Correlating log messages from multiple systems is important for fast troubleshooting of complex problems that span multiple machines or services. That way you can quickly analyze and cross-reference events from different sources.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDefine the ports in the SELinux policy of the server or client system and open the firewall for those ports. The default SELinux policy includes ports 601, 514, 6514, 10514, and 20514. To use a different port, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations\">modify the SELinux policy on the client and server systems\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Deploy the logging solution\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure the server to receive remote input\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: remote_udp_input\n            type: remote\n            udp_ports: [ 601 ]\n          - name: remote_tcp_input\n            type: remote\n            tcp_ports: [ 601 ]\n        logging_outputs:\n          - name: remote_files_output\n            type: remote_files\n        logging_flows:\n          - name: flow_0\n            inputs: [remote_udp_input, remote_tcp_input]\n            outputs: [remote_files_output]\n\n- name: Deploy the logging solution\n  hosts: managed-node-02.example.com\n  tasks:\n    - name: Configure the server to output the logs to local files in directories named by remote host names\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: basic_input\n            type: basics\n        logging_outputs:\n          - name: forward_output0\n            type: forwards\n            severity: info\n            target: \u003Cspan class=\"emphasis\">\u003Cem>&lt;host1.example.com&gt;\u003C/em>\u003C/span>\n            udp_port: 601\n          - name: forward_output1\n            type: forwards\n            facility: mail\n            target: \u003Cspan class=\"emphasis\">\u003Cem>&lt;host1.example.com&gt;\u003C/em>\u003C/span>\n            tcp_port: 601\n        logging_flows:\n          - name: flows0\n            inputs: [basic_input]\n            outputs: [forward_output0, forward_output1]\n\n[basic_input]\n[forward_output0, forward_output1]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the first play of the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging input dictionaries. The \u003Ccode class=\"literal\">type: remote\u003C/code> option covers remote inputs from the other logging system over the network. The \u003Ccode class=\"literal\">udp_ports: [ 601 ]\u003C/code> option defines a list of UDP port numbers to monitor. The \u003Ccode class=\"literal\">tcp_ports: [ 601 ]\u003C/code> option defines a list of TCP port numbers to monitor. If both \u003Ccode class=\"literal\">udp_ports\u003C/code> and \u003Ccode class=\"literal\">tcp_ports\u003C/code> is set, \u003Ccode class=\"literal\">udp_ports\u003C/code> is used and \u003Ccode class=\"literal\">tcp_ports\u003C/code> is dropped.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging output dictionaries. The \u003Ccode class=\"literal\">type: remote_files\u003C/code> option makes output store logs to the local files per remote host and program name originated the logs.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_flows\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging flow dictionaries to specify relationships between \u003Ccode class=\"literal\">logging_inputs\u003C/code> and \u003Ccode class=\"literal\">logging_outputs\u003C/code>. The \u003Ccode class=\"literal\">inputs: [remote_udp_input, remote_tcp_input]\u003C/code> option specifies a list of inputs, from which processing of logs starts. The \u003Ccode class=\"literal\">outputs: [remote_files_output]\u003C/code> option specifies a list of outputs, to which the logs are sent.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the second play of the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging input dictionaries. The \u003Ccode class=\"literal\">type: basics\u003C/code> option covers inputs from \u003Ccode class=\"literal\">systemd\u003C/code> journal or Unix socket.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging output dictionaries. The \u003Ccode class=\"literal\">type: forwards\u003C/code> option supports sending logs to the remote logging server over the network. The \u003Ccode class=\"literal\">severity: info\u003C/code> option refers to log messages of the informative importance. The \u003Ccode class=\"literal\">facility: mail\u003C/code> option refers to the type of system program that is generating the log message. The \u003Ccode class=\"literal\">target: \u003Cspan class=\"emphasis\">\u003Cem>&lt;host1.example.com&gt;\u003C/em>\u003C/span>\u003C/code> option specifies the hostname of the remote logging server. The \u003Ccode class=\"literal\">udp_port: 601\u003C/code>/\u003Ccode class=\"literal\">tcp_port: 601\u003C/code> options define the UDP/TCP ports on which the remote logging server listens.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_flows\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines a list of logging flow dictionaries to specify relationships between \u003Ccode class=\"literal\">logging_inputs\u003C/code> and \u003Ccode class=\"literal\">logging_outputs\u003C/code>. The \u003Ccode class=\"literal\">inputs: [basic_input]\u003C/code> option specifies a list of inputs, from which processing of logs starts. The \u003Ccode class=\"literal\">outputs: [forward_output0, forward_output1]\u003C/code> option specifies a list of outputs, to which the logs are sent.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn both the client and the server system, test the syntax of the \u003Ccode class=\"literal\">/etc/rsyslog.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>rsyslogd -N 1\u003C/strong>\u003C/span>\nrsyslogd: version 8.1911.0-6.el8, config validation run (level 1), master config /etc/rsyslog.conf\nrsyslogd: End of config validation run. Bye.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the client system sends messages to the server:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOn the client system, send a test message:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>logger test\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOn the server system, view the \u003Ccode class=\"literal\">/var/log/\u003Cspan class=\"emphasis\">\u003Cem>&lt;host2.example.com&gt;\u003C/em>\u003C/span>/messages\u003C/code> log, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /var/log/\u003Cspan class=\"emphasis\">\u003Cem>&lt;host2.example.com&gt;\u003C/em>\u003C/span>/messages\u003C/strong>\u003C/span>\nAug  5 13:48:31 \u003Cspan class=\"emphasis\">\u003Cem>&lt;host2.example.com&gt;\u003C/em>\u003C/span> root[6778]: test\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhere \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;host2.example.com&gt;\u003C/em>\u003C/span>\u003C/code> is the host name of the client system. Note that the log contains the user name of the user that entered the logger command, in this case \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.3. Using the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role with TLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTransport Layer Security (TLS) is a cryptographic protocol designed to allow secure communication over the computer network.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure a secure transfer of log messages, where one or more clients take logs from the \u003Ccode class=\"literal\">systemd-journal\u003C/code> service and transfer them to a remote server while using TLS.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTypically, TLS for transferring logs in a remote logging solution is used when sending sensitive data over less trusted or public networks, such as the Internet. Also, by using certificates in TLS you can ensure that the client is forwarding logs to the correct and trusted server. This prevents attacks like \"man-in-the-middle\".\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">16.3.1. Configuring client logging with TLS\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure logging on RHEL clients and transfer logs to a remote logging system using TLS encryption.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis procedure creates a private key and a certificate. Next, it configures TLS on all hosts in the clients group in the Ansible inventory. The TLS protocol encrypts the message transmission for secure transfer of logs over the network.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tYou do not have to call the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role in the playbook to create the certificate. The \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role calls it automatically when the \u003Ccode class=\"literal\">logging_certificates\u003C/code> variable is set.\n\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\tIn order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe managed nodes are enrolled in an IdM domain.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIf the logging server you want to configure on the manage node runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS extension \"Extended Master Secret\" enforced\u003C/a> Knowledgebase article.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure remote logging solution using TLS for secure transfer of logs\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploying files input and forwards output with certs\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_certificates:\n          - name: logging_cert\n            dns: ['localhost', 'www.example.com']\n            ca: ipa\n        logging_pki_files:\n          - ca_cert: /local/path/to/ca_cert.pem\n            cert: /local/path/to/logging_cert.pem\n            private_key: /local/path/to/logging_cert.pem\n        logging_inputs:\n          - name: input_name\n            type: files\n            input_log_path: /var/log/containers/*.log\n        logging_outputs:\n          - name: output_name\n            type: forwards\n            target: your_target_host\n            tcp_port: 514\n            tls: true\n            pki_authmode: x509/name\n            permitted_server: 'server.example.com'\n        logging_flows:\n          - name: flow_name\n            inputs: [input_name]\n            outputs: [output_name]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_certificates\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThe value of this parameter is passed on to \u003Ccode class=\"literal\">certificate_requests\u003C/code> in the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role and used to create a private key and certificate.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_pki_files\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tUsing this parameter, you can configure the paths and other settings that logging uses to find the CA, certificate, and key files used for TLS, specified with one or more of the following sub-parameters: \u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>, and \u003Ccode class=\"literal\">tls\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\tIf you are using \u003Ccode class=\"literal\">logging_certificates\u003C/code> to create the files on the managed node, do not use \u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, and \u003Ccode class=\"literal\">private_key_src\u003C/code>, which are used to copy files not created by \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the CA certificate file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/ca.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the certificate file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/server-cert.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the private key file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/private/server-key.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the CA certificate file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">ca_cert\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to a certificate file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">cert\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to a private key file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">private_key\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tSetting this parameter to \u003Ccode class=\"literal\">true\u003C/code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set \u003Ccode class=\"literal\">tls: false\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.certificate/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/certificate/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">Requesting certificates using RHEL system roles\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">16.3.2. Configuring server logging with TLS\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure logging on RHEL servers and set them to receive logs from a remote logging system using TLS encryption.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis procedure creates a private key and a certificate. Next, it configures TLS on all hosts in the server group in the Ansible inventory.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tYou do not have to call the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role in the playbook to create the certificate. The \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role calls it automatically.\n\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\tIn order for the CA to be able to sign the created certificate, the managed nodes must be enrolled in an IdM domain.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe managed nodes are enrolled in an IdM domain.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIf the logging server you want to configure on the manage node runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS extension \"Extended Master Secret\" enforced\u003C/a> Knowledgebase article.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure remote logging solution using TLS for secure transfer of logs\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploying remote input and remote_files output with certs\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_certificates:\n          - name: logging_cert\n            dns: ['localhost', 'www.example.com']\n            ca: ipa\n        logging_pki_files:\n          - ca_cert: /local/path/to/ca_cert.pem\n            cert: /local/path/to/logging_cert.pem\n            private_key: /local/path/to/logging_cert.pem\n        logging_inputs:\n          - name: input_name\n            type: remote\n            tcp_ports: 514\n            tls: true\n            permitted_clients: ['clients.example.com']\n        logging_outputs:\n          - name: output_name\n            type: remote_files\n            remote_log_path: /var/log/remote/%FROMHOST%/%PROGRAMNAME:::secpath-replace%.log\n            async_writing: true\n            client_count: 20\n            io_buffer_size: 8192\n        logging_flows:\n          - name: flow_name\n            inputs: [input_name]\n            outputs: [output_name]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_certificates\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThe value of this parameter is passed on to \u003Ccode class=\"literal\">certificate_requests\u003C/code> in the \u003Ccode class=\"literal\">certificate\u003C/code> RHEL system role and used to create a private key and certificate.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">logging_pki_files\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tUsing this parameter, you can configure the paths and other settings that logging uses to find the CA, certificate, and key files used for TLS, specified with one or more of the following sub-parameters: \u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>, and \u003Ccode class=\"literal\">tls\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\tIf you are using \u003Ccode class=\"literal\">logging_certificates\u003C/code> to create the files on the managed node, do not use \u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, and \u003Ccode class=\"literal\">private_key_src\u003C/code>, which are used to copy files not created by \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the CA certificate file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/ca.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the certificate file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/server-cert.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the private key file on the managed node. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/private/server-key.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the CA certificate file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">ca_cert\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to a certificate file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">cert\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to a private key file on the control node which is copied to the target host to the location specified by \u003Ccode class=\"literal\">private_key\u003C/code>. Do not use this if using \u003Ccode class=\"literal\">logging_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tSetting this parameter to \u003Ccode class=\"literal\">true\u003C/code> ensures secure transfer of logs over the network. If you do not want a secure wrapper, you can set \u003Ccode class=\"literal\">tls: false\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/automating_system_administration_by_using_rhel_system_roles/index#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">Requesting certificates using RHEL system roles\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"assembly_using-the-logging-system-roles-with-relp\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.4. Using the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system roles with RELP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tReliable Event Logging Protocol (RELP) is a networking protocol for data and message logging over the TCP network. It ensures reliable delivery of event messages and you can use it in environments that do not tolerate any message loss.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe RELP sender transfers log entries in the form of commands and the receiver acknowledges them once they are processed. To ensure consistency, RELP stores the transaction number to each transferred command for any kind of message recovery.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can consider a remote logging system in between the RELP Client and RELP Server. The RELP Client transfers the logs to the remote logging system and the RELP Server receives all the logs sent by the remote logging system. To achieve that use case, you can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure the logging system to reliably send and receive log entries.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">16.4.1. Configuring client logging with RELP\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure a transfer of log messages stored locally to the remote logging system with RELP.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis procedure configures RELP on all hosts in the \u003Ccode class=\"literal\">clients\u003C/code> group in the Ansible inventory. The RELP configuration uses Transport Layer Security (TLS) to encrypt the message transmission for secure transfer of logs over the network.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure client-side of the remote logging solution using RELP\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploy basic input and RELP output\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: basic_input\n            type: basics\n        logging_outputs:\n          - name: relp_client\n            type: relp\n            target: logging.server.com\n            port: 20514\n            tls: true\n            ca_cert: /etc/pki/tls/certs/ca.pem\n            cert: /etc/pki/tls/certs/client-cert.pem\n            private_key: /etc/pki/tls/private/client-key.pem\n            pki_authmode: name\n            permitted_servers:\n              - '*.server.example.com'\n        logging_flows:\n          - name: example_flow\n            inputs: [basic_input]\n            outputs: [relp_client]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">target\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tThis is a required parameter that specifies the host name where the remote logging system is running.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">port\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tPort number the remote logging system is listening.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tEnsures secure transfer of logs over the network. If you do not want a secure wrapper you can set the \u003Ccode class=\"literal\">tls\u003C/code> variable to \u003Ccode class=\"literal\">false\u003C/code>. By default \u003Ccode class=\"literal\">tls\u003C/code> parameter is set to true while working with RELP and requires key/certificates and triplets {\u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>} and/or {\u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>}.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf the {\u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>} triplet is set, the default locations \u003Ccode class=\"literal\">/etc/pki/tls/certs\u003C/code> and \u003Ccode class=\"literal\">/etc/pki/tls/private\u003C/code> are used as the destination on the managed node to transfer files from control node. In this case, the file names are identical to the original ones in the triplet\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf the {\u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>} triplet is set, files are expected to be on the default path before the logging configuration.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf both triplets are set, files are transferred from local path from control node to specific path of the managed node.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to CA certificate. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/ca.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to certificate. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/server-cert.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to private key. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/private/server-key.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents local CA certificate file path which is copied to the managed node. If \u003Ccode class=\"literal\">ca_cert\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the local certificate file path which is copied to the managed node. If \u003Ccode class=\"literal\">cert\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the local key file path which is copied to the managed node. If \u003Ccode class=\"literal\">private_key\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">pki_authmode\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tAccepts the authentication mode as \u003Ccode class=\"literal\">name\u003C/code> or \u003Ccode class=\"literal\">fingerprint\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">permitted_servers\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of servers that will be allowed by the logging client to connect and send logs over TLS.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of logging input dictionary.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of logging output dictionary.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">16.4.2. Configuring server logging with RELP\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">logging\u003C/code> RHEL system role to configure a server for receiving log messages from the remote logging system with RELP.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tThis procedure configures RELP on all hosts in the \u003Ccode class=\"literal\">server\u003C/code> group in the Ansible inventory. The RELP configuration uses TLS to encrypt the message transmission for secure transfer of logs over the network.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure server-side of the remote logging solution using RELP\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploying remote input and remote_files output\n      ansible.builtin.include_role:\n        name: rhel-system-roles.logging\n      vars:\n        logging_inputs:\n          - name: relp_server\n            type: relp\n            port: 20514\n            tls: true\n            ca_cert: /etc/pki/tls/certs/ca.pem\n            cert: /etc/pki/tls/certs/server-cert.pem\n            private_key: /etc/pki/tls/private/server-key.pem\n            pki_authmode: name\n            permitted_clients:\n              - '*example.client.com'\n        logging_outputs:\n          - name: remote_files_output\n            type: remote_files\n        logging_flows:\n          - name: example_flow\n            inputs: relp_server\n            outputs: remote_files_output\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">port\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tPort number the remote logging system is listening.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tEnsures secure transfer of logs over the network. If you do not want a secure wrapper you can set the \u003Ccode class=\"literal\">tls\u003C/code> variable to \u003Ccode class=\"literal\">false\u003C/code>. By default \u003Ccode class=\"literal\">tls\u003C/code> parameter is set to true while working with RELP and requires key/certificates and triplets {\u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>} and/or {\u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>}.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf the {\u003Ccode class=\"literal\">ca_cert_src\u003C/code>, \u003Ccode class=\"literal\">cert_src\u003C/code>, \u003Ccode class=\"literal\">private_key_src\u003C/code>} triplet is set, the default locations \u003Ccode class=\"literal\">/etc/pki/tls/certs\u003C/code> and \u003Ccode class=\"literal\">/etc/pki/tls/private\u003C/code> are used as the destination on the managed node to transfer files from control node. In this case, the file names are identical to the original ones in the triplet\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf the {\u003Ccode class=\"literal\">ca_cert\u003C/code>, \u003Ccode class=\"literal\">cert\u003C/code>, \u003Ccode class=\"literal\">private_key\u003C/code>} triplet is set, files are expected to be on the default path before the logging configuration.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tIf both triplets are set, files are transferred from local path from control node to specific path of the managed node.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to CA certificate. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/ca.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to the certificate. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/certs/server-cert.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the path to private key. Default path is \u003Ccode class=\"literal\">/etc/pki/tls/private/server-key.pem\u003C/code> and the file name is set by the user.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca_cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents local CA certificate file path which is copied to the managed node. If \u003Ccode class=\"literal\">ca_cert\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">cert_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the local certificate file path which is copied to the managed node. If \u003Ccode class=\"literal\">cert\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">private_key_src\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tRepresents the local key file path which is copied to the managed node. If \u003Ccode class=\"literal\">private_key\u003C/code> is specified, it is copied to the location.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">pki_authmode\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tAccepts the authentication mode as \u003Ccode class=\"literal\">name\u003C/code> or \u003Ccode class=\"literal\">fingerprint\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">permitted_clients\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of clients that will be allowed by the logging server to connect and send logs over TLS.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">inputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of logging input dictionary.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">outputs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\tList of logging output dictionary.\n\t\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.logging/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/logging/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rsyslog.conf(5)\u003C/code> and \u003Ccode class=\"literal\">syslog(3)\u003C/code> manual pages\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 17. Configuring performance monitoring with PCP by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tPerformance Co-Pilot (PCP) is a system performance analysis toolkit. You can use it to record and analyze performance data from many components on a Red Hat Enterprise Linux system.\n\t\t\u003C/p>\u003Cp>\n\t\t\tYou can use the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role to automate the installation and configuration of PCP, and the role can configure Grafana to visualize PCP metrics.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.1. Configuring Performance Co-Pilot by using the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use Performance Co-Pilot (PCP) to monitor many metrics, such as CPU utilization and memory usage. For example, this can help to identify resource and performance bottlenecks. By using the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role, you can remotely configure PCP on multiple hosts to record metrics.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Monitoring performance metrics\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure Performance Co-Pilot\n      ansible.builtin.include_role:\n        name: rhel-system-roles.metrics\n      vars:\n        metrics_retention_days: 14\n        metrics_manage_firewall: true\n        metrics_manage_selinux: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_retention_days: \u003Cspan class=\"emphasis\">\u003Cem>&lt;number&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the number of days after which the \u003Ccode class=\"literal\">pmlogger_daily\u003C/code> systemd timer removes old PCP archives.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_manage_firewall: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines whether the role should open the required ports in the \u003Ccode class=\"literal\">firewalld\u003C/code> service. If you want to remotely access PCP on the managed nodes, set this variable to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tQuery a metric, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'pminfo -f kernel.all.load'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next step\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: \u003Ca class=\"link\" href=\"#setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role\" title=\"17.3. Setting up Grafana by using the metrics RHEL system role to monitor multiple hosts with Performance Co-Pilot\">Configure Grafana to monitor PCP hosts and visualize metrics\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/metrics/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-performance-co-pilot-with-authentication-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.2. Configuring Performance Co-Pilot with authentication by using the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can enable authentication in Performance Co-Pilot (PCP) so that the \u003Ccode class=\"literal\">pmcd\u003C/code> service and Performance Metrics Domain Agents (PDMAs) can determine whether the user running the monitoring tools is allowed to perform an action. Authenticated users have access to metrics with sensitive information. Additionally, certain agents require authentication. For example, the \u003Ccode class=\"literal\">bpftrace\u003C/code> agent uses authentication to identify whether a user is allowed to load \u003Ccode class=\"literal\">bpftrace\u003C/code> scripts into the kernel to generate metrics.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy using the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role, you can remotely configure PCP with authentication on multiple hosts.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">metrics_usr: \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\nmetrics_pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Monitoring performance metrics\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure Performance Co-Pilot\n      ansible.builtin.include_role:\n        name: rhel-system-roles.metrics\n      vars:\n        metrics_retention_days: 14\n        metrics_manage_firewall: true\n        metrics_manage_selinux: true\n\tmetrics_username: \"{{ metrics_usr }}\"\n        metrics_password: \"{{ metrics_pwd }}\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_retention_days: \u003Cspan class=\"emphasis\">\u003Cem>&lt;number&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the number of days after which the \u003Ccode class=\"literal\">pmlogger_daily\u003C/code> systemd timer removes old PCP archives.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_manage_firewall: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines whether the role should open the required ports in the \u003Ccode class=\"literal\">firewalld\u003C/code> service. If you want to remotely access PCP on the managed nodes, set this variable to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_username: \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe role creates this user locally on the managed node, adds the credentials to the \u003Ccode class=\"literal\">/etc/pcp/passwd.db\u003C/code> Simple Authentication and Security Layer (SASL) database, and configures authentication in PCP. Additionally, if you set \u003Ccode class=\"literal\">metrics_from_bpftrace: true\u003C/code> in the playbook, PCP uses this account to register \u003Ccode class=\"literal\">bpftrace\u003C/code> scripts.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn a host with the \u003Ccode class=\"literal\">pcp\u003C/code> package installed, query a metric that requires authentication:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tQuery the metrics by using the credentials that you used in the playbook:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>pminfo -fmdt -h pcp://managed-node-01.example.com?username=\u003Cspan class=\"emphasis\">\u003Cem>&lt;user&gt;\u003C/em>\u003C/span> proc.fd.count\u003C/strong>\u003C/span>\nPassword: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\n\nproc.fd.count\n    inst [844 or \"000844 /var/lib/pcp/pmdas/proc/pmdaproc\"] value 5\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the command succeeds, it returns the value of the \u003Ccode class=\"literal\">proc.fd.count\u003C/code> metric.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRun the command again, but omit the username to verify that the command fails for unauthenticated users:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>pminfo -fmdt -h pcp://managed-node-01.example.com proc.fd.count\u003C/strong>\u003C/span>\n\nproc.fd.count\nError: No permission to perform requested operation\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next step\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: \u003Ca class=\"link\" href=\"#setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role\" title=\"17.3. Setting up Grafana by using the metrics RHEL system role to monitor multiple hosts with Performance Co-Pilot\">Configure Grafana to monitor PCP hosts and visualize metrics\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/metrics/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.3. Setting up Grafana by using the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role to monitor multiple hosts with Performance Co-Pilot\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf you have already configured Performance Co-Pilot (PCP) on multiple hosts, you can use an instance of Grafana to visualize the metrics for these hosts. You can display the live data and, if the PCP data is stored in a Redis database, also past data.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy using the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role, you can automate the process of setting up Grafana, the PCP plug-in, the optional Redis database, and the configuration of the data sources.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you use the \u003Ccode class=\"literal\">metrics\u003C/code> role to install Grafana on a host, the role also installs automatically PCP on this host.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role\" title=\"17.1. Configuring Performance Co-Pilot by using the metrics RHEL system role\">PCP is configured for remote access on the hosts you want to monitor\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host on which you want to install Grafana can access port 44321 on the PCP nodes you plan to monitor.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">grafana_admin_pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Monitoring performance metrics\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Set up Grafana to monitor multiple hosts\n      ansible.builtin.include_role:\n        name: rhel-system-roles.metrics\n      vars:\n        metrics_graph_service: true\n        metrics_query_service: true\n        metrics_monitored_hosts:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;pcp_host_1.example.com&gt;\u003C/em>\u003C/span>\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;pcp_host_2.example.com&gt;\u003C/em>\u003C/span>\n        metrics_manage_firewall: true\n        metrics_manage_selinux: true\n\n    - name: Set Grafana admin password\n      ansible.builtin.shell:\n        cmd: grafana-cli admin reset-admin-password \"{{ grafana_admin_pwd }}\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_graph_service: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tInstalls Grafana and the PCP plug-in. Additionally, the role adds the \u003Ccode class=\"literal\">PCP Vector\u003C/code>, \u003Ccode class=\"literal\">PCP Redis\u003C/code>, and \u003Ccode class=\"literal\">PCP bpftrace\u003C/code> data sources to Grafana.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_query_service: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines whether the role should install and configure Redis for centralized metric recording. If enabled, data collected from PCP clients is stored in Redis and, as a result, you can also display historical data instead of only live data.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_monitored_hosts: \u003Cspan class=\"emphasis\">\u003Cem>&lt;list_of_hosts&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines the list of hosts to monitor. In Grafana, you can then display the data of these hosts and, additionally, the host that runs Grafana.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_manage_firewall: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines whether the role should open the required ports in the \u003Ccode class=\"literal\">firewalld\u003C/code> service. If you set this variable to \u003Ccode class=\"literal\">true\u003C/code>, you can, for example, access Grafana remotely.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen \u003Ccode class=\"literal\">http://\u003Cspan class=\"emphasis\">\u003Cem>&lt;grafana_server_IP_or_hostname&gt;\u003C/em>\u003C/span>:3000\u003C/code> in your browser, and log in as the \u003Ccode class=\"literal\">admin\u003C/code> user with the password you set in the procedure.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay monitoring data:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo display live data:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"guimenu\">Menu\u003C/span> → \u003Cspan class=\"guisubmenu\">Apps\u003C/span> → \u003Cspan class=\"guisubmenu\">Performance Co-Pilot\u003C/span> → \u003Cspan class=\"guimenuitem\">PCP Vector Checklist\u003C/span>\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tBy default, the graphs display metrics from the host that runs Grafana. To switch to a different host, enter the hostname in the \u003Ccode class=\"literal\">hostspec\u003C/code> field and press \u003Ckbd class=\"keycap\">Enter\u003C/kbd>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tTo display historical data stored in a Redis database: \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/monitoring_and_managing_system_status_and_performance/setting-up-graphical-representation-of-pcp-metrics_monitoring-and-managing-system-status-and-performance#creating-panel-and-alerts-in-pcp-redis-data-source_setting-up-graphical-representation-of-pcp-metrics\">Create a panel with a PCP Redis data source\u003C/a>. This requires that you set \u003Ccode class=\"literal\">metrics_query_service: true\u003C/code> in the playbook.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/metrics/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-web-hooks-in-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.4. Configuring web hooks in Performance Co-Pilot by using the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Performance Co-Pilot (PCP) suite contains the performance metrics inference engine (PMIE) service. This service evaluates performance rules in real time. For example, you can use the default rules to detect excessive swap activities.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can configure a host as a central PCP management site that collects the monitoring data from multiple PCP nodes. If a rule matches, this central host sends a notification to a web hook to notify other services. For example, the web hook can trigger Event-Driven Ansible to run on Ansible Automation Platform template or playbook on the host that had caused the event.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy using the \u003Ccode class=\"literal\">metrics\u003C/code> RHEL system role, you can automate the configuration of a central PCP management host that notifies a web hook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role\" title=\"17.1. Configuring Performance Co-Pilot by using the metrics RHEL system role\">PCP is configured for remote access on the hosts you want to monitor\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host on which you want to configure PMIE can access port 44321 on the PCP nodes you plan to monitor.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Monitoring performance metrics\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure PMIE web hooks\n      ansible.builtin.include_role:\n        name: redhat.rhel_system_roles.metrics\n      vars:\n        metrics_manage_firewall: true\n        metrics_retention_days: 7\n        metrics_monitored_hosts:\n          - pcp-node-01.example.com\n          - pcp-node-02.example.com\n        metrics_webhook_endpoint: \"https://&lt;webserver&gt;:&lt;port&gt;/&lt;endpoint&gt;\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_retention_days: \u003Cspan class=\"emphasis\">\u003Cem>&lt;number&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the number of days after which the \u003Ccode class=\"literal\">pmlogger_daily\u003C/code> systemd timer removes old PCP archives.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_manage_firewall: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines whether the role should open the required ports in the \u003Ccode class=\"literal\">firewalld\u003C/code> service. If you want to remotely access PCP on the managed nodes, set this variable to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_monitored_hosts: \u003Cspan class=\"emphasis\">\u003Cem>&lt;list_of_hosts&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSpecifies the hosts to observe.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">metrics_webhook_endpoint: \u003Cspan class=\"emphasis\">\u003Cem>&lt;URL&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the web hook endpoint to which the performance metrics inference engine (PMIE) sends notifications about detected performance issues. By default, these issues are logged to the local system only.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --syntax-check ~/playbook.yml\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook ~/playbook.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the configuration summary on \u003Ccode class=\"literal\">managed-node-node-01.example.com\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'pcp summary'\u003C/strong>\u003C/span>\nPerformance Co-Pilot configuration on managed-node-01.example.com:\n\n platform: Linux managed-node-node-01.example.com 5.14.0-427.el9.x86_64 #1 SMP PREEMPT_DYNAMIC Fri Feb 23 01:51:18 EST 2024 x86_64\n hardware: 8 cpus, 1 disk, 1 node, 1773MB RAM\n timezone: CEST-2\n services: pmcd pmproxy\n pmcd: Version 6.2.0-1, 12 agents, 6 clients\n pmda: root pmcd proc pmproxy xfs linux nfsclient mmv kvm jbd2\n       dm openmetrics\n pmlogger: primary logger: /var/log/pcp/pmlogger/managed-node-node-01.example.com/20240510.16.25\n           pcp-node-01.example.com: /var/log/pmlogger/pcp-node-01.example.com/20240510.16.25\n           pcp-node-02.example.com: /var/log/pmlogger/pcp-node-02.example.com/20240510.16.25\n pmie: primary engine: /var/log/pcp/pmie/managed-node-node-01.example.com/pmie.log\n       pcp-node-01.example.com: : /var/log/pcp/pmie/pcp-node-01.example.com/pmie.log\n       pcp-node-02.example.com: : /var/log/pcp/pmie/pcp-node-02.example.com/pmie.log\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe last three lines confirm that PMIE is configured to monitor three systems.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.metrics/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/metrics/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/automate-performance-management-performance-co-pilot\">Automate performance management with Performance Co-Pilot using Event-Driven Ansible\u003C/a> blog post\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 18. Configuring Microsoft SQL Server by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can use the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role to automate the installation and management of Microsoft SQL Server. This role also optimizes Red Hat Enterprise Linux (RHEL) to improve the performance and throughput of SQL Server by applying the \u003Ccode class=\"literal\">mssql\u003C/code> TuneD profile.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tDuring the installation, the role adds repositories for SQL Server and related packages to the managed hosts. Packages in these repositories are provided, maintained, and hosted by Microsoft.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-existing-certificate-files_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.1. Installing and configuring SQL Server with an existing TLS certificate by using the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf your application requires a Microsoft SQL Server database, you can configure SQL Server with TLS encryption to enable secure communication between the application and the database. By using the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role, you can automate this process and remotely install and configure SQL Server with TLS encryption. In the playbook, you can use an existing private key and a TLS certificate that was issued by a certificate authority (CA).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDepending on the RHEL version on the managed host, the version of SQL Server that you can install differs:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 7.9: SQL Server 2017 and 2019\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 8: SQL Server 2017, 2019, and 2022\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 9.4 and later: SQL Server 2022\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou installed the \u003Ccode class=\"literal\">ansible-collection-microsoft-sql\u003C/code> package or the \u003Ca class=\"link\" href=\"https://console.redhat.com/ansible/automation-hub/repo/published/microsoft/sql\">\u003Ccode class=\"literal\">microsoft.sql\u003C/code>\u003C/a> collection on the control node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node has 2 GB or more RAM installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node uses one of the following versions: RHEL 7.9, RHEL 8, RHEL 9.4 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou stored the certificate in the \u003Ccode class=\"literal\">sql_crt.pem\u003C/code> file in the same directory as the playbook.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou stored the private key in the \u003Ccode class=\"literal\">sql_cert.key\u003C/code> file in the same directory as the playbook.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSQL clients trust the CA that issued the certificate.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">sa_pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;sa_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Installing and configuring Microsoft SQL Server\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: SQL Server with an existing private key and certificate\n      ansible.builtin.include_role:\n        name: microsoft.sql.server\n      vars:\n        mssql_accept_microsoft_odbc_driver_17_for_sql_server_eula: true\n        mssql_accept_microsoft_cli_utilities_for_sql_server_eula: true\n        mssql_accept_microsoft_sql_server_standard_eula: true\n\n        mssql_version: 2022\n        mssql_password: \"{{ sa_pwd  }}\"\n        mssql_edition: Developer\n        mssql_tcp_port: 1433\n        mssql_manage_firewall: true\n\n        mssql_tls_enable: true\n        mssql_tls_cert: sql_crt.pem\n        mssql_tls_private_key: sql_cert.key\n        mssql_tls_version: 1.2\n        mssql_tls_force: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_tls_enable: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables TLS encryption. If you enable this setting, you must also define \u003Ccode class=\"literal\">mssql_tls_cert\u003C/code> and \u003Ccode class=\"literal\">mssql_tls_private_key\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_tls_cert: \u003Cspan class=\"emphasis\">\u003Cem>&lt;path&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the path to the TLS certificate stored on the control node. The role copies this file to the \u003Ccode class=\"literal\">/etc/pki/tls/certs/\u003C/code> directory on the managed node.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_tls_private_key: \u003Cspan class=\"emphasis\">\u003Cem>&lt;path&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the path to the TLS private key on the control node. The role copies this file to the \u003Ccode class=\"literal\">/etc/pki/tls/private/\u003C/code> directory on the managed node.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_tls_force: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tReplaces the TLS certificate and private key in their destination directories if they exist.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/microsoft.sql-server/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the SQL Server host, use the \u003Ccode class=\"literal\">sqlcmd\u003C/code> utility with the \u003Ccode class=\"literal\">-N\u003C/code> parameter to establish an encrypted connection to SQL server and run a query, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>/opt/mssql-tools/bin/sqlcmd -N -S server.example.com -U \"sa\" -P \u003Cspan class=\"emphasis\">\u003Cem>&lt;sa_password&gt;\u003C/em>\u003C/span> -Q 'SELECT SYSTEM_USER'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the command succeeds, the connection to the server was TLS encrypted.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/microsoft.sql-server/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-the-certificate-role_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.2. Installing and configuring SQL Server with a TLS certificate issued from IdM by using the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf your application requires a Microsoft SQL Server database, you can configure SQL Server with TLS encryption to enable secure communication between the application and the database. If the SQL Server host is a member in a Red Hat Identity Management (IdM) domain, the \u003Ccode class=\"literal\">certmonger\u003C/code> service can manage the certificate request and future renewals.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBy using the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role, you can automate this process. You can remotely install and configure SQL Server with TLS encryption, and the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> role uses the \u003Ccode class=\"literal\">certificate\u003C/code> Ansible system role to configure \u003Ccode class=\"literal\">certmonger\u003C/code> and request a certificate from IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDepending on the RHEL version on the managed host, the version of SQL Server that you can install differs:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 7.9: SQL Server 2017 and 2019\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 8: SQL Server 2017, 2019, and 2022\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 9.4 and later: SQL Server 2022\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou installed the \u003Ccode class=\"literal\">ansible-collection-microsoft-sql\u003C/code> package or the \u003Ca class=\"link\" href=\"https://console.redhat.com/ansible/automation-hub/repo/published/microsoft/sql\">\u003Ccode class=\"literal\">microsoft.sql\u003C/code>\u003C/a> collection on the control node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node has 2 GB or more RAM installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node uses one of the following versions: RHEL 7.9, RHEL 8, RHEL 9.4 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou enrolled the managed node in a Red Hat Identity Management (IdM) domain.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">sa_pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;sa_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Installing and configuring Microsoft SQL Server\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: SQL Server with certificates issued by Red Hat IdM\n      ansible.builtin.include_role:\n        name: microsoft.sql.server\n      vars:\n        mssql_accept_microsoft_odbc_driver_17_for_sql_server_eula: true\n        mssql_accept_microsoft_cli_utilities_for_sql_server_eula: true\n        mssql_accept_microsoft_sql_server_standard_eula: true\n\n        mssql_version: 2022\n        mssql_password: \"{{ sa_pwd  }}\"\n        mssql_edition: Developer\n        mssql_tcp_port: 1433\n        mssql_manage_firewall: true\n\n        mssql_tls_enable: true\n        mssql_tls_certificates:\n          - name: sql_cert\n            dns: server.example.com\n            ca: ipa\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_tls_enable: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables TLS encryption. If you enable this setting, you must also define \u003Ccode class=\"literal\">mssql_tls_certificates\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_tls_certificates\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA list of YAML dictionaries with settings for the \u003Ccode class=\"literal\">certificate\u003C/code> role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;file_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines the base name of the certificate and private key. The \u003Ccode class=\"literal\">certificate\u003C/code> role stores the certificate in the \u003Ccode class=\"literal\">/etc/pki/tls/certs/\u003Cspan class=\"emphasis\">\u003Cem>&lt;file_name&gt;\u003C/em>\u003C/span>.crt\u003C/code> and the private key in the \u003Ccode class=\"literal\">/etc/pki/tls/private/\u003Cspan class=\"emphasis\">\u003Cem>&lt;file_name&gt;\u003C/em>\u003C/span>.key\u003C/code> file.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dns: \u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname_or_list_of_hostnames&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the hostnames that the Subject Alternative Names (SAN) field in the issued certificate contains. You can use a wildcard (\u003Ccode class=\"literal\">*\u003C/code>) or specify multiple names in YAML list format.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ca: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca_type&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines how the \u003Ccode class=\"literal\">certificate\u003C/code> role requests the certificate. Set the variable to \u003Ccode class=\"literal\">ipa\u003C/code> if the host is enrolled in an IdM domain or \u003Ccode class=\"literal\">self-sign\u003C/code> to request a self-signed certificate.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/microsoft.sql-server/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the SQL Server host, use the \u003Ccode class=\"literal\">sqlcmd\u003C/code> utility with the \u003Ccode class=\"literal\">-N\u003C/code> parameter to establish an encrypted connection to SQL server and run a query, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>/opt/mssql-tools/bin/sqlcmd -N -S server.example.com -U \"sa\" -P \u003Cspan class=\"emphasis\">\u003Cem>&lt;sa_password&gt;\u003C/em>\u003C/span> -Q 'SELECT SYSTEM_USER'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the command succeeds, the connection to the server was TLS encrypted.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/microsoft.sql-server/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 7. Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles\">Requesting certificates by using RHEL system roles\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-up-custom-storage-paths-for-data-and-logs_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.3. Installing and configuring SQL Server with custom storage paths by using the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen you use the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role to install and configure a new SQL Server, you can customize the paths and modes of the data and log directories. For example, configure custom paths if you want to store databases and log files in a different directory with more storage.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you change the data or log path and re-run the playbook, the previously-used directories and all their content remains at the original path. Only new databases and logs are stored in the new location.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-table id=\"idm140064647601200\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 18.1. SQL Server default settings for data and log directories\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 17%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 17%; \" class=\"col_5\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064647593536\" scope=\"col\">Type\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064647592448\" scope=\"col\">Directory\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064647591360\" scope=\"col\">Mode\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064647590272\" scope=\"col\">Owner\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140064647589184\" scope=\"col\">Group\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647593536\"> \u003Cp>\n\t\t\t\t\t\t\t\tData\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647592448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/var/opt/mssql/data/\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647591360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ca href=\"#ftn.mssqldirmode\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"mssqldirmode\">[a]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647590272\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">mssql\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647589184\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">mssql\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647593536\"> \u003Cp>\n\t\t\t\t\t\t\t\tLogs\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647592448\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/var/opt/mssql/los/\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647591360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ca href=\"#ftn.mssqldirmode\" class=\"footnoteref\">\u003Csup class=\"footnoteref\">[a]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647590272\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">mssql\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140064647589184\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">mssql\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003Ctbody class=\"footnotes\">\u003Ctr>\u003Ctd colspan=\"5\">\u003Cdiv id=\"ftn.mssqldirmode\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#mssqldirmode\" class=\"simpara\">\u003Csup class=\"simpara\">[a] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\t\tIf the directory exists, the role preserves the mode. If the directory does not exist, the role applies the default \u003Ccode class=\"literal\">umask\u003C/code> on the managed node when it creates the directory.\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/div>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou installed the \u003Ccode class=\"literal\">ansible-collection-microsoft-sql\u003C/code> package or the \u003Ca class=\"link\" href=\"https://console.redhat.com/ansible/automation-hub/repo/published/microsoft/sql\">\u003Ccode class=\"literal\">microsoft.sql\u003C/code>\u003C/a> collection on the control node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node has 2 GB or more RAM installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node uses one of the following versions: RHEL 7.9, RHEL 8, RHEL 9.4 or later.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">sa_pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;sa_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit an existing playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, and add the storage and log-related variables:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Installing and configuring Microsoft SQL Server\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: SQL Server with custom storage paths\n      ansible.builtin.include_role:\n        name: microsoft.sql.server\n      vars:\n        mssql_accept_microsoft_odbc_driver_17_for_sql_server_eula: true\n        mssql_accept_microsoft_cli_utilities_for_sql_server_eula: true\n        mssql_accept_microsoft_sql_server_standard_eula: true\n\n        mssql_version: 2022\n        mssql_password: \"{{ sa_pwd  }}\"\n        mssql_edition: Developer\n        mssql_tcp_port: 1433\n        mssql_manage_firewall: true\n\n        \u003Cspan class=\"strong strong\">\u003Cstrong>mssql_datadir: /var/lib/mssql/\u003C/strong>\u003C/span>\n        \u003Cspan class=\"strong strong\">\u003Cstrong>mssql_datadir_mode: '0700'\u003C/strong>\u003C/span>\n        \u003Cspan class=\"strong strong\">\u003Cstrong>mssql_logdir: /var/log/mssql/\u003C/strong>\u003C/span>\n        \u003Cspan class=\"strong strong\">\u003Cstrong>mssql_logdir_mode: '0700'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_datadir_mode\u003C/code> and \u003Ccode class=\"literal\">mssql_logdir_mode\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSet the permission modes. Specify the value in single quotes to ensure that the role parses the value as a string and not as an octal number.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/microsoft.sql-server/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the mode of the data directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ls -ld /var/lib/mssql/'\u003C/strong>\u003C/span>\ndrwx------. 12 mssql mssql 4096 Jul  3 13:53 /var/lib/mssql/\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the mode of the log directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ls -ld /var/log/mssql/'\u003C/strong>\u003C/span>\ndrwx------. 12 mssql mssql 4096 Jul  3 13:53 /var/log/mssql/\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/microsoft.sql-server/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"preparing-and-running-a-playbook-to-enable-sql-server-authentication-with-active-directory_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.4. Installing and configuring SQL Server with AD integration by using the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can integrate Microsoft SQL Server into an Active Directory (AD) to enable AD users to authenticate to SQL Server. By using the \u003Ccode class=\"literal\">microsoft.sql.server\u003C/code> Ansible system role, you can automate this process and remotely install and configure SQL Server accordingly. Note that you must still perform manual steps in AD and SQL Server after you run the playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDepending on the RHEL version on the managed host, the version of SQL Server that you can install differs:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 7.9: SQL Server 2017 and 2019\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 8: SQL Server 2017, 2019, and 2022\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRHEL 9.4 and later: SQL Server 2022\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou installed the \u003Ccode class=\"literal\">ansible-collection-microsoft-sql\u003C/code> package or the \u003Ca class=\"link\" href=\"https://console.redhat.com/ansible/automation-hub/repo/published/microsoft/sql\">\u003Ccode class=\"literal\">microsoft.sql\u003C/code>\u003C/a> collection on the control node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node has 2 GB or more RAM installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node uses one of the following versions: RHEL 7.9, RHEL 8, RHEL 9.4 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn AD domain is available in the network.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA reverse DNS (RDNS) zone exists in AD, and it contains Pointer (PTR) resource records for each AD domain controller (DC).\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed host’s network settings use an AD DNS server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe managed host can resolve the following DNS entries:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tBoth the hostnames and the fully-qualified domain names (FQDNs) of the AD DCs resolve to their IP addresses.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IP addresses of the AD DCs resolve to their FQDNs.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">sa_pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;sa_password&gt;\u003C/em>\u003C/span>\nsql_pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;SQL_AD_password&gt;\u003C/em>\u003C/span>\nad_admin_pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;AD_admin_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Installing and configuring Microsoft SQL Server\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: SQL Server with AD authentication\n      ansible.builtin.include_role:\n        name: microsoft.sql.server\n      vars:\n        mssql_accept_microsoft_odbc_driver_17_for_sql_server_eula: true\n        mssql_accept_microsoft_cli_utilities_for_sql_server_eula: true\n        mssql_accept_microsoft_sql_server_standard_eula: true\n\n        mssql_version: 2022\n        mssql_password: \"{{ sa_pwd }}\"\n        mssql_edition: Developer\n        mssql_tcp_port: 1433\n        mssql_manage_firewall: true\n\n        mssql_ad_configure: true\n        mssql_ad_join: true\n        mssql_ad_sql_user: sqluser\n        mssql_ad_sql_password: \"{{ sql_pwd }}\"\n        ad_integration_realm: ad.example.com\n        ad_integration_user: Administrator\n        ad_integration_password: \"{{ ad_admin_pwd }}\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_ad_configure: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables authentication against AD.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_ad_join: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tUses the \u003Ccode class=\"literal\">ad_integration\u003C/code> RHEL system role to join the managed node to AD. The role uses the settings from the \u003Ccode class=\"literal\">ad_integration_realm\u003C/code>, \u003Ccode class=\"literal\">ad_integration_user\u003C/code>, and \u003Ccode class=\"literal\">ad_integration_password\u003C/code> variables to join the domain.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mssql_ad_sql_user: \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the name of an AD account that the role should create in AD and SQL Server for administration purposes.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ad_integration_user: \u003Cspan class=\"emphasis\">\u003Cem>&lt;AD_user&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the name of an AD user with privileges to join machines to the domain and to create the AD user specified in \u003Ccode class=\"literal\">mssql_ad_sql_user\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/microsoft.sql-server/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn your AD domain, enable 128 bit and 256 bit Kerberos authentication for the AD SQL user which you specified in the playbook. Use one of the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Active Directory Users and Computers\u003C/strong>\u003C/span> application:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tNavigate to \u003Cspan class=\"strong strong\">\u003Cstrong>ad.example.com\u003C/strong>\u003C/span> &gt; \u003Cspan class=\"strong strong\">\u003Cstrong>Users\u003C/strong>\u003C/span> &gt; \u003Cspan class=\"strong strong\">\u003Cstrong>sqluser\u003C/strong>\u003C/span> &gt; \u003Cspan class=\"strong strong\">\u003Cstrong>Accounts\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Account options\u003C/strong>\u003C/span> list, select \u003Cspan class=\"strong strong\">\u003Cstrong>This account supports Kerberos AES 128 bit encryption\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>This account supports Kerberos AES 256 bit encryption\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Apply\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn PowerShell in admin mode, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">C:\\&gt; \u003Cspan class=\"strong strong\">\u003Cstrong>Set-ADUser -Identity \u003Ccode class=\"literal\">sqluser\u003C/code> -KerberosEncryptionType AES128,AES256\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAuthorize AD users that should be able to authenticate to SQL Server. On the SQL Server, perform the following steps:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tObtain a Kerberos ticket for the \u003Ccode class=\"literal\">Administrator\u003C/code> user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit Administrator@ad.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAuthorize an AD user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>/opt/mssql-tools/bin/sqlcmd -S. -Q 'CREATE LOGIN [AD\\&lt;AD_user&gt;] FROM WINDOWS;'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRepeat this step for every AD user who should be able to access SQL Server.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed node that runs SQL Server:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tObtain a Kerberos ticket for an AD user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit \u003Cspan class=\"emphasis\">\u003Cem>&lt;AD_user&gt;\u003C/em>\u003C/span>@ad.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">sqlcmd\u003C/code> utility to log in to SQL Server and run a query, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>/opt/mssql-tools/bin/sqlcmd -S. -Q 'SELECT SYSTEM_USER'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/microsoft.sql-server/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 19. Configuring NBDE by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tYou can use the \u003Ccode class=\"literal\">nbde_client\u003C/code> and \u003Ccode class=\"literal\">nbde_server\u003C/code> RHEL system roles for automated deployments of Policy-Based Decryption (PBD) solutions using Clevis and Tang. The \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package contains these system roles, the related examples, and also the reference documentation.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.1. Using the \u003Ccode class=\"literal\">nbde_server\u003C/code> RHEL system role for setting up multiple Tang servers\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy using the \u003Ccode class=\"literal\">nbde_server\u003C/code> system role, you can deploy and manage a Tang server as part of an automated disk encryption solution. This role supports the following features:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRotating Tang keys\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDeploying and backing up Tang keys\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Deploy a Tang server\n- hosts: tang.server.example.com\n- tasks:\n  - name: Install and configure periodic key rotation\n    ansible.builtin.include_role:\n        name: rhel-system-roles.nbde_server\n    vars:\n      nbde_server_rotate_keys: yes\n      nbde_server_manage_firewall: true\n      nbde_server_manage_selinux: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis example playbook ensures deploying of your Tang server and a key rotation.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nbde_server_manage_firewall: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">firewall\u003C/code> system role to manage ports used by the \u003Ccode class=\"literal\">nbde_server\u003C/code> role.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nbde_server_manage_selinux: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">selinux\u003C/code> system role to manage ports used by the \u003Ccode class=\"literal\">nbde_server\u003C/code> role.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_server/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your NBDE client, verify that your Tang server works correctly by using the following command. The command must return the identical message you pass for encryption and decryption:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'echo test | clevis encrypt tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;tang.server.example.com&gt;\u003C/em>\u003C/span>\"}' -y | clevis decrypt'\u003C/strong>\u003C/span>\ntest\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_server/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/nbde_server/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.2. Setting up Clevis clients with DHCP by using the \u003Ccode class=\"literal\">nbde_client\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">nbde_client\u003C/code> system role enables you to deploy multiple Clevis clients in an automated way.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis role supports binding a LUKS-encrypted volume to one or more Network-Bound (NBDE) servers - Tang servers. You can either preserve the existing volume encryption with a passphrase or remove it. After removing the passphrase, you can unlock the volume only using NBDE. This is useful when a volume is initially encrypted using a temporary key or password that you should remove after you provision the system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you provide both a passphrase and a key file, the role uses what you have provided first. If it does not find any of these valid, it attempts to retrieve a passphrase from an existing binding.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tPolicy-Based Decryption (PBD) defines a binding as a mapping of a device to a slot. This means that you can have multiple bindings for the same device. The default slot is slot 1.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">nbde_client\u003C/code> system role supports only Tang bindings. Therefore, you cannot use it for TPM2 bindings.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA volume that is already encrypted by using LUKS.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure clients for unlocking of encrypted volumes by Tang servers\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Create NBDE client bindings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.nbde_client\n      vars:\n        nbde_client_bindings:\n          - device: /dev/rhel/root\n            encryption_key_src: /etc/luks/keyfile\n            nbde_client_early_boot: true\n            state: present\n            servers:\n              - http://server1.example.com\n              - http://server2.example.com\n          - device: /dev/rhel/swap\n            encryption_key_src: /etc/luks/keyfile\n            servers:\n              - http://server1.example.com\n              - http://server2.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis example playbook configures Clevis clients for automated unlocking of two LUKS-encrypted volumes when at least one of two Tang servers is available.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">state: present\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe values of \u003Ccode class=\"literal\">state\u003C/code> indicate the configuration after you run the playbook. Use the \u003Ccode class=\"literal\">present\u003C/code> value for either creating a new binding or updating an existing one. Contrary to a \u003Ccode class=\"literal\">clevis luks bind\u003C/code> command, you can use \u003Ccode class=\"literal\">state: present\u003C/code> also for overwriting an existing binding in its device slot. The \u003Ccode class=\"literal\">absent\u003C/code> value removes a specified binding.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nbde_client_early_boot: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">nbde_client\u003C/code> role ensures that networking for a Tang pin is available during early boot by default. If you scenario requires to disable this feature, add the \u003Ccode class=\"literal\">nbde_client_early_boot: false\u003C/code> variable to your playbook.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your NBDE client, check that the encrypted volume that should be automatically unlocked by your Tang servers contain the corresponding information in its LUKS pins:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'clevis luks list -d /dev/rhel/root'\u003C/strong>\u003C/span>\n1: tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;http://server1.example.com/&gt;\u003C/em>\u003C/span>\"}'\n2: tang '{\"url\":\"\u003Cspan class=\"emphasis\">\u003Cem>&lt;http://server2.example.com/&gt;\u003C/em>\u003C/span>\"}'\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you do not use the \u003Ccode class=\"literal\">nbde_client_early_boot: false\u003C/code> variable, verify that the bindings are available for the early boot, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'lsinitrd | grep clevis-luks'\u003C/strong>\u003C/span>\nlrwxrwxrwx   1 root     root           48 Jan  4 02:56 etc/systemd/system/cryptsetup.target.wants/clevis-luks-askpass.path -&gt; /usr/lib/systemd/system/clevis-luks-askpass.path\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/nbde_client/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.3. Setting up static-IP Clevis clients by using the \u003Ccode class=\"literal\">nbde_client\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">nbde_client\u003C/code> RHEL system role supports only scenarios with Dynamic Host Configuration Protocol (DHCP). On an NBDE client with static IP configuration, you must pass your network configuration as a kernel boot parameter.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTypically, administrators want to reuse a playbook and not maintain individual playbooks for each host to which Ansible assigns static IP addresses during early boot. In this case, you can use variables in the playbook and provide the settings in an external file. As a result, you need only one playbook and one file with the settings.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA volume that is already encrypted by using LUKS.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a file with the network settings of your hosts, for example, \u003Ccode class=\"literal\">static-ip-settings-clients.yml\u003C/code>, and add the values you want to dynamically assign to the hosts:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">clients:\n  managed-node-01.example.com:\n    ip_v4: 192.0.2.1\n    gateway_v4: 192.0.2.254\n    netmask_v4: 255.255.255.0\n    interface: enp1s0\n  managed-node-02.example.com:\n    ip_v4: 192.0.2.2\n    gateway_v4: 192.0.2.254\n    netmask_v4: 255.255.255.0\n    interface: enp1s0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example, \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Configure clients for unlocking of encrypted volumes by Tang servers\n  hosts: managed-node-01.example.com,managed-node-02.example.com\n  vars_files:\n    - ~/static-ip-settings-clients.yml\n  tasks:\n    - name: Create NBDE client bindings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        nbde_client_bindings:\n          - device: /dev/rhel/root\n            encryption_key_src: /etc/luks/keyfile\n            servers:\n              - http://server1.example.com\n              - http://server2.example.com\n          - device: /dev/rhel/swap\n            encryption_key_src: /etc/luks/keyfile\n            servers:\n              - http://server1.example.com\n              - http://server2.example.com\n\n    - name: Configure a Clevis client with static IP address during early boot\n      ansible.builtin.include_role:\n        name: rhel-system-roles.bootloader\n      vars:\n        bootloader_settings:\n          - kernel: ALL\n            options:\n              - name: ip\n                value: \"{{ clients[inventory_hostname]['ip_v4'] }}::{{ clients[inventory_hostname]['gateway_v4'] }}:{{ clients[inventory_hostname]['netmask_v4'] }}::{{ clients[inventory_hostname]['interface'] }}:none\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis playbook reads certain values dynamically for each host listed in the \u003Ccode class=\"literal\">~/static-ip-settings-clients.yml\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.nbde_client/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/nbde_client/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/sysadmin/network-confi-initrd\">Looking forward to Linux network configuration in the initial ramdisk (initrd)\u003C/a> (Red Hat Enable Sysadmin)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 20. Configuring network settings by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tBy using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate network-related configuration and management tasks.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.1. Configuring an Ethernet connection with a static IP address by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role with an interface name\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo connect a Red Hat Enterprise Linux host to an Ethernet network, create a NetworkManager connection profile for the network device. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure an Ethernet connection with static IP addresses, gateways, and DNS settings, and assign them to a specified interface name.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTypically, administrators want to reuse a playbook and not maintain individual playbooks for each host to which Ansible should assign static IP addresses. In this case, you can use variables in the playbook and maintain the settings in the inventory. As a result, you need only one playbook to dynamically assign individual settings to multiple hosts.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA physical or virtual Ethernet device exists in the server configuration.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed nodes use NetworkManager to configure the network.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the \u003Ccode class=\"literal\">~/inventory\u003C/code> file, and append the host-specific settings to the host entries:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">managed-node-01.example.com \u003Cspan class=\"strong strong\">\u003Cstrong>interface=enp1s0 ip_v4=192.0.2.1/24 ip_v6=2001:db8:1::1/64 gateway_v4=192.0.2.254 gateway_v6=2001:db8:1::fffe\u003C/strong>\u003C/span>\n\nmanaged-node-02.example.com \u003Cspan class=\"strong strong\">\u003Cstrong>interface=enp1s0 ip_v4=192.0.2.2/24 ip_v6=2001:db8:1::2/64 gateway_v4=192.0.2.254 gateway_v6=2001:db8:1::fffe\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com,managed-node-02.example.com\n  tasks:\n    - name: Ethernet connection profile with static IP address settings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: \"{{ interface }}\"\n            interface_name: \"{{ interface }}\"\n            type: ethernet\n            autoconnect: yes\n            ip:\n              address:\n                - \"{{ ip_v4 }}\"\n                - \"{{ ip_v6 }}\"\n              gateway4: \"{{ gateway_v4 }}\"\n              gateway6: \"{{ gateway_v6 }}\"\n              dns:\n                - 192.0.2.200\n                - 2001:db8:1::ffbb\n              dns_search:\n                - example.com\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis playbook reads certain values dynamically for each host from the inventory file and uses static values in the playbook for settings which are the same for all hosts.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tQuery the Ansible facts of the managed node and verify the active network settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.setup\u003C/strong>\u003C/span>\n...\n        \"ansible_default_ipv4\": {\n            \"address\": \"192.0.2.1\",\n            \"alias\": \"enp1s0\",\n            \"broadcast\": \"192.0.2.255\",\n            \"gateway\": \"192.0.2.254\",\n            \"interface\": \"enp1s0\",\n            \"macaddress\": \"52:54:00:17:b8:b6\",\n            \"mtu\": 1500,\n            \"netmask\": \"255.255.255.0\",\n            \"network\": \"192.0.2.0\",\n            \"prefix\": \"24\",\n            \"type\": \"ether\"\n        },\n        \"ansible_default_ipv6\": {\n            \"address\": \"2001:db8:1::1\",\n            \"gateway\": \"2001:db8:1::fffe\",\n            \"interface\": \"enp1s0\",\n            \"macaddress\": \"52:54:00:17:b8:b6\",\n            \"mtu\": 1500,\n            \"prefix\": \"64\",\n            \"scope\": \"global\",\n            \"type\": \"ether\"\n        },\n        ...\n        \"ansible_dns\": {\n            \"nameservers\": [\n                \"192.0.2.1\",\n                \"2001:db8:1::ffbb\"\n            ],\n            \"search\": [\n                \"example.com\"\n            ]\n        },\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.2. Configuring an Ethernet connection with a static IP address by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role with a device path\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo connect a Red Hat Enterprise Linux host to an Ethernet network, create a NetworkManager connection profile for the network device. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure an Ethernet connection with static IP addresses, gateways, and DNS settings, and assign them to a device based on its path instead of its name.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA physical or virtual Ethernet device exists in the servers configuration.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed nodes use NetworkManager to configure the network.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the path of the device. You can display the device path by using the \u003Ccode class=\"literal\">udevadm info /sys/class/net/\u003Cspan class=\"emphasis\">\u003Cem>&lt;device_name&gt;\u003C/em>\u003C/span> | grep ID_PATH=\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ethernet connection profile with static IP address settings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: example\n            match:\n              path:\n                - pci-0000:00:0[1-3].0\n                - &amp;!pci-0000:00:02.0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              address:\n                - 192.0.2.1/24\n                - 2001:db8:1::1/64\n              gateway4: 192.0.2.254\n              gateway6: 2001:db8:1::fffe\n              dns:\n                - 192.0.2.200\n                - 2001:db8:1::ffbb\n              dns_search:\n                - example.com\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">match\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines that a condition must be met in order to apply the settings. You can only use this variable with the \u003Ccode class=\"literal\">path\u003C/code> option.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">path\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines the persistent path of a device. You can set it as a fixed path or an expression. Its value can contain modifiers and wildcards. The example applies the settings to devices that match PCI ID \u003Ccode class=\"literal\">0000:00:0[1-3].0\u003C/code>, but not \u003Ccode class=\"literal\">0000:00:02.0\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tQuery the Ansible facts of the managed node and verify the active network settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.setup\u003C/strong>\u003C/span>\n...\n        \"ansible_default_ipv4\": {\n            \"address\": \"192.0.2.1\",\n            \"alias\": \"enp1s0\",\n            \"broadcast\": \"192.0.2.255\",\n            \"gateway\": \"192.0.2.254\",\n            \"interface\": \"enp1s0\",\n            \"macaddress\": \"52:54:00:17:b8:b6\",\n            \"mtu\": 1500,\n            \"netmask\": \"255.255.255.0\",\n            \"network\": \"192.0.2.0\",\n            \"prefix\": \"24\",\n            \"type\": \"ether\"\n        },\n        \"ansible_default_ipv6\": {\n            \"address\": \"2001:db8:1::1\",\n            \"gateway\": \"2001:db8:1::fffe\",\n            \"interface\": \"enp1s0\",\n            \"macaddress\": \"52:54:00:17:b8:b6\",\n            \"mtu\": 1500,\n            \"prefix\": \"64\",\n            \"scope\": \"global\",\n            \"type\": \"ether\"\n        },\n        ...\n        \"ansible_dns\": {\n            \"nameservers\": [\n                \"192.0.2.1\",\n                \"2001:db8:1::ffbb\"\n            ],\n            \"search\": [\n                \"example.com\"\n            ]\n        },\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.3. Configuring an Ethernet connection with a dynamic IP address by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role with an interface name\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo connect a Red Hat Enterprise Linux host to an Ethernet network, create a NetworkManager connection profile for the network device. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure an Ethernet connection that retrieves its IP addresses, gateways, and DNS settings from a DHCP server and IPv6 stateless address autoconfiguration (SLAAC). With this role you can assign the connection profile to the specified interface name.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA physical or virtual Ethernet device exists in the servers configuration.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA DHCP server and SLAAC are available in the network.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed nodes use the NetworkManager service to configure the network.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ethernet connection profile with dynamic IP address settings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: enp1s0\n            interface_name: enp1s0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              dhcp4: yes\n              auto6: yes\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dhcp4: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables automatic IPv4 address assignment from DHCP, PPP, or similar services.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">auto6: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables IPv6 auto-configuration. By default, NetworkManager uses Router Advertisements. If the router announces the \u003Ccode class=\"literal\">managed\u003C/code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tQuery the Ansible facts of the managed node and verify that the interface received IP addresses and DNS settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.setup\u003C/strong>\u003C/span>\n...\n        \"ansible_default_ipv4\": {\n            \"address\": \"192.0.2.1\",\n            \"alias\": \"enp1s0\",\n            \"broadcast\": \"192.0.2.255\",\n            \"gateway\": \"192.0.2.254\",\n            \"interface\": \"enp1s0\",\n            \"macaddress\": \"52:54:00:17:b8:b6\",\n            \"mtu\": 1500,\n            \"netmask\": \"255.255.255.0\",\n            \"network\": \"192.0.2.0\",\n            \"prefix\": \"24\",\n            \"type\": \"ether\"\n        },\n        \"ansible_default_ipv6\": {\n            \"address\": \"2001:db8:1::1\",\n            \"gateway\": \"2001:db8:1::fffe\",\n            \"interface\": \"enp1s0\",\n            \"macaddress\": \"52:54:00:17:b8:b6\",\n            \"mtu\": 1500,\n            \"prefix\": \"64\",\n            \"scope\": \"global\",\n            \"type\": \"ether\"\n        },\n        ...\n        \"ansible_dns\": {\n            \"nameservers\": [\n                \"192.0.2.1\",\n                \"2001:db8:1::ffbb\"\n            ],\n            \"search\": [\n                \"example.com\"\n            ]\n        },\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.4. Configuring an Ethernet connection with a dynamic IP address by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role with a device path\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo connect a Red Hat Enterprise Linux host to an Ethernet network, create a NetworkManager connection profile for the network device. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure an Ethernet connection that retrieves its IP addresses, gateways, and DNS settings from a DHCP server and IPv6 stateless address autoconfiguration (SLAAC). The role can assign the connection profile to a device based on its path instead of an interface name.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA physical or virtual Ethernet device exists in the servers configuration.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA DHCP server and SLAAC are available in the network.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed hosts use NetworkManager to configure the network.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the path of the device. You can display the device path by using the \u003Ccode class=\"literal\">udevadm info /sys/class/net/\u003Cspan class=\"emphasis\">\u003Cem>&lt;device_name&gt;\u003C/em>\u003C/span> | grep ID_PATH=\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ethernet connection profile with dynamic IP address settings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: example\n            match:\n              path:\n                - pci-0000:00:0[1-3].0\n                - &amp;!pci-0000:00:02.0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              dhcp4: yes\n              auto6: yes\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">match: path\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines that a condition must be met in order to apply the settings. You can only use this variable with the \u003Ccode class=\"literal\">path\u003C/code> option.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">path: \u003Cspan class=\"emphasis\">\u003Cem>&lt;path_and_expressions&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines the persistent path of a device. You can set it as a fixed path or an expression. Its value can contain modifiers and wildcards. The example applies the settings to devices that match PCI ID \u003Ccode class=\"literal\">0000:00:0[1-3].0\u003C/code>, but not \u003Ccode class=\"literal\">0000:00:02.0\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dhcp4: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables automatic IPv4 address assignment from DHCP, PPP, or similar services.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">auto6: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables IPv6 auto-configuration. By default, NetworkManager uses Router Advertisements. If the router announces the \u003Ccode class=\"literal\">managed\u003C/code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tQuery the Ansible facts of the managed node and verify that the interface received IP addresses and DNS settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.setup\u003C/strong>\u003C/span>\n...\n        \"ansible_default_ipv4\": {\n            \"address\": \"192.0.2.1\",\n            \"alias\": \"enp1s0\",\n            \"broadcast\": \"192.0.2.255\",\n            \"gateway\": \"192.0.2.254\",\n            \"interface\": \"enp1s0\",\n            \"macaddress\": \"52:54:00:17:b8:b6\",\n            \"mtu\": 1500,\n            \"netmask\": \"255.255.255.0\",\n            \"network\": \"192.0.2.0\",\n            \"prefix\": \"24\",\n            \"type\": \"ether\"\n        },\n        \"ansible_default_ipv6\": {\n            \"address\": \"2001:db8:1::1\",\n            \"gateway\": \"2001:db8:1::fffe\",\n            \"interface\": \"enp1s0\",\n            \"macaddress\": \"52:54:00:17:b8:b6\",\n            \"mtu\": 1500,\n            \"prefix\": \"64\",\n            \"scope\": \"global\",\n            \"type\": \"ether\"\n        },\n        ...\n        \"ansible_dns\": {\n            \"nameservers\": [\n                \"192.0.2.1\",\n                \"2001:db8:1::ffbb\"\n            ],\n            \"search\": [\n                \"example.com\"\n            ]\n        },\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-vlan-tagging-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.5. Configuring VLAN tagging by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf your network uses Virtual Local Area Networks (VLANs) to separate network traffic into logical networks, create a NetworkManager connection profile to configure VLAN tagging. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure VLAN tagging and, if a connection profile for the VLAN’s parent device does not exists, the role can create it as well.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf the VLAN device requires an IP address, default gateway, and DNS settings, configure them on the VLAN device and not on the parent device.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: VLAN connection profile with Ethernet port\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          # Ethernet profile\n          - name: enp1s0\n            type: ethernet\n            interface_name: enp1s0\n            autoconnect: yes\n            state: up\n            ip:\n              dhcp4: no\n              auto6: no\n\n          # VLAN profile\n          - name: enp1s0.10\n            type: vlan\n            vlan:\n              id: 10\n            ip:\n              dhcp4: yes\n              auto6: yes\n            parent: enp1s0\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\te settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">type: \u003Cspan class=\"emphasis\">\u003Cem>&lt;profile_type&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the type of the profile to create. The example playbook creates two connection profiles: One for the parent Ethernet device and one for the VLAN device.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dhcp4: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tIf set to \u003Ccode class=\"literal\">yes\u003C/code>, automatic IPv4 address assignment from DHCP, PPP, or similar services is enabled. Disable the IP address configuration on the parent device.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">auto6: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tIf set to \u003Ccode class=\"literal\">yes\u003C/code>, IPv6 auto-configuration is enabled. In this case, by default, NetworkManager uses Router Advertisements and, if the router announces the \u003Ccode class=\"literal\">managed\u003C/code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server. Disable the IP address configuration on the parent device.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">parent: \u003Cspan class=\"emphasis\">\u003Cem>&lt;parent_device&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the parent device of the VLAN connection profile. In the example, the parent is the Ethernet interface.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the VLAN settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ip -d addr show enp1s0.10'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n4: vlan10@enp1s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000\n    link/ether 52:54:00:72:2f:6e brd ff:ff:ff:ff:ff:ff promiscuity 0\n    vlan protocol 802.1Q id 10 &lt;REORDER_HDR&gt; numtxqueues 1 numrxqueues 1 gso_max_size 65536 gso_max_segs 65535\n    ...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-network-bridge-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.6. Configuring a network bridge by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can connect multiple networks on layer 2 of the Open Systems Interconnection (OSI) model by creating a network bridge. To configure a bridge, create a connection profile in NetworkManager. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure a bridge and, if a connection profile for the bridge’s parent device does not exists, the role can create it as well.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you want to assign IP addresses, gateways, and DNS settings to a bridge, configure them on the bridge and not on its ports.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTwo or more physical or virtual network devices are installed on the server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Bridge connection profile with two Ethernet ports\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          # Bridge profile\n          - name: bridge0\n            type: bridge\n            interface_name: bridge0\n            ip:\n              dhcp4: yes\n              auto6: yes\n            state: up\n\n          # Port profile for the 1st Ethernet device\n          - name: bridge0-port1\n            interface_name: enp7s0\n            type: ethernet\n            controller: bridge0\n            port_type: bridge\n            state: up\n\n          # Port profile for the 2nd Ethernet device\n          - name: bridge0-port2\n            interface_name: enp8s0\n            type: ethernet\n            controller: bridge0\n            port_type: bridge\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">type: \u003Cspan class=\"emphasis\">\u003Cem>&lt;profile_type&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the type of the profile to create. The example playbook creates three connection profiles: One for the bridge and two for the Ethernet devices.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dhcp4: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables automatic IPv4 address assignment from DHCP, PPP, or similar services.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">auto6: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables IPv6 auto-configuration. By default, NetworkManager uses Router Advertisements. If the router announces the \u003Ccode class=\"literal\">managed\u003C/code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the link status of Ethernet devices that are ports of a specific bridge:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ip link show master bridge0'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n3: enp7s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bridge0 state UP mode DEFAULT group default qlen 1000\n    link/ether 52:54:00:62:61:0e brd ff:ff:ff:ff:ff:ff\n4: enp8s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bridge0 state UP mode DEFAULT group default qlen 1000\n    link/ether 52:54:00:9e:f1:ce brd ff:ff:ff:ff:ff:ff\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the status of Ethernet devices that are ports of any bridge device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'bridge link show'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n3: enp7s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master bridge0 state forwarding priority 32 cost 100\n4: enp8s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 master bridge0 state listening priority 32 cost 100\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-a-network-bond-by-using-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.7. Configuring a network bond by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can combine network interfaces in a bond to provide a logical interface with higher throughput or redundancy. To configure a bond, create a NetworkManager connection profile. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure a network bond and, if a connection profile for the bond’s parent device does not exist, the role can create it as well.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTwo or more physical or virtual network devices are installed on the server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Bond connection profile with two Ethernet ports\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          # Bond profile\n          - name: bond0\n            type: bond\n            interface_name: bond0\n            ip:\n              dhcp4: yes\n              auto6: yes\n            bond:\n              mode: active-backup\n            state: up\n\n          # Port profile for the 1st Ethernet device\n          - name: bond0-port1\n            interface_name: enp7s0\n            type: ethernet\n            controller: bond0\n            state: up\n\n          # Port profile for the 2nd Ethernet device\n          - name: bond0-port2\n            interface_name: enp8s0\n            type: ethernet\n            controller: bond0\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">type: \u003Cspan class=\"emphasis\">\u003Cem>&lt;profile_type&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the type of the profile to create. The example playbook creates three connection profiles: One for the bond and two for the Ethernet devices.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">dhcp4: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables automatic IPv4 address assignment from DHCP, PPP, or similar services.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">auto6: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables IPv6 auto-configuration. By default, NetworkManager uses Router Advertisements. If the router announces the \u003Ccode class=\"literal\">managed\u003C/code> flag, NetworkManager requests an IPv6 address and prefix from a DHCPv6 server.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">mode: \u003Cspan class=\"emphasis\">\u003Cem>&lt;bond_mode&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tSets the bonding mode. Possible values are:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">balance-rr\u003C/code> (default)\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">active-backup\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">balance-xor\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">broadcast\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">802.3ad\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">balance-tlb\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">balance-alb\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tDepending on the mode you set, you need to set additional variables in the playbook.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTemporarily remove the network cable from one of the network devices and check if the other device in the bond handling the traffic.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that there is no method to properly test link failure events using software utilities. Tools that deactivate connections, such as \u003Ccode class=\"literal\">nmcli\u003C/code>, show only the bonding driver’s ability to handle port configuration changes and not actual link failure events.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-an-ipoib-connection-by-using-the-network-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.8. Configuring an IPoIB connection by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use IP over InfiniBand (IPoIB) to send IP packets over an InfiniBand interface. To configure IPoIB, create a NetworkManager connection profile. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure IPoIB and, if a connection profile for the InfiniBand’s parent device does not exists, the role can create it as well.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn InfiniBand device named \u003Ccode class=\"literal\">mlx4_ib0\u003C/code> is installed in the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed nodes use NetworkManager to configure the network.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: IPoIB connection profile with static IP address settings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          # InfiniBand connection mlx4_ib0\n          - name: mlx4_ib0\n            interface_name: mlx4_ib0\n            type: infiniband\n\n          # IPoIB device mlx4_ib0.8002 on top of mlx4_ib0\n          - name: mlx4_ib0.8002\n            type: infiniband\n            autoconnect: yes\n            infiniband:\n              p_key: 0x8002\n              transport_mode: datagram\n            parent: mlx4_ib0\n            ip:\n              address:\n                - 192.0.2.1/24\n                - 2001:db8:1::1/64\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">type: \u003Cspan class=\"emphasis\">\u003Cem>&lt;profile_type&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the type of the profile to create. The example playbook creates two connection profiles: One for the InfiniBand connection and one for the IPoIB device.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">parent: \u003Cspan class=\"emphasis\">\u003Cem>&lt;parent_device&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the parent device of the IPoIB connection profile.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">p_key: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the InfiniBand partition key. If you set this variable, do not set \u003Ccode class=\"literal\">interface_name\u003C/code> on the IPoIB device.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">transport_mode: \u003Cspan class=\"emphasis\">\u003Cem>&lt;mode&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the IPoIB connection operation mode. You can set this variable to \u003Ccode class=\"literal\">datagram\u003C/code> (default) or \u003Ccode class=\"literal\">connected\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the IP settings of the \u003Ccode class=\"literal\">mlx4_ib0.8002\u003C/code> device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ip address show mlx4_ib0.8002'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n...\ninet \u003Cspan class=\"emphasis\">\u003Cem>192.0.2.1/24 brd 192.0.2.255\u003C/em>\u003C/span> scope global noprefixroute ib0.8002\n   valid_lft forever preferred_lft forever\ninet6 \u003Cspan class=\"emphasis\">\u003Cem>2001:db8:1::1/64\u003C/em>\u003C/span> scope link tentative noprefixroute\n   valid_lft forever preferred_lft forever\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the partition key (P_Key) of the \u003Ccode class=\"literal\">mlx4_ib0.8002\u003C/code> device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'cat /sys/class/net/mlx4_ib0.8002/pkey'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n0x8002\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the mode of the \u003Ccode class=\"literal\">mlx4_ib0.8002\u003C/code> device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'cat /sys/class/net/mlx4_ib0.8002/mode'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\ndatagram\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_routing-traffic-from-a-specific-subnet-to-a-different-default-gateway-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.9. Routing traffic from a specific subnet to a different default gateway by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use policy-based routing to configure a different default gateway for traffic from certain subnets. For example, you can configure RHEL as a router that, by default, routes all traffic to internet provider A using the default route. However, traffic received from the internal workstations subnet is routed to provider B. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure the connection profiles, including routing tables and rules.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis procedure assumes the following network topology:\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US/images/13d0843cf47a810942ae325682f70d0c/policy-based-routing.png\" alt=\"policy based routing\"/>\u003C/span>\n\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed nodes uses the \u003Ccode class=\"literal\">NetworkManager\u003C/code> and \u003Ccode class=\"literal\">firewalld\u003C/code> services.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe managed nodes you want to configure has four network interfaces:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">enp7s0\u003C/code> interface is connected to the network of provider A. The gateway IP in the provider’s network is \u003Ccode class=\"literal\">198.51.100.2\u003C/code>, and the network uses a \u003Ccode class=\"literal\">/30\u003C/code> network mask.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">enp1s0\u003C/code> interface is connected to the network of provider B. The gateway IP in the provider’s network is \u003Ccode class=\"literal\">192.0.2.2\u003C/code>, and the network uses a \u003Ccode class=\"literal\">/30\u003C/code> network mask.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">enp8s0\u003C/code> interface is connected to the \u003Ccode class=\"literal\">10.0.0.0/24\u003C/code> subnet with internal workstations.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">enp9s0\u003C/code> interface is connected to the \u003Ccode class=\"literal\">203.0.113.0/24\u003C/code> subnet with the company’s servers.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHosts in the internal workstations subnet use \u003Ccode class=\"literal\">10.0.0.1\u003C/code> as the default gateway. In the procedure, you assign this IP address to the \u003Ccode class=\"literal\">enp8s0\u003C/code> network interface of the router.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHosts in the server subnet use \u003Ccode class=\"literal\">203.0.113.1\u003C/code> as the default gateway. In the procedure, you assign this IP address to the \u003Ccode class=\"literal\">enp9s0\u003C/code> network interface of the router.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuring policy-based routing\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Routing traffic from a specific subnet to a different default gateway\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: Provider-A\n            interface_name: enp7s0\n            type: ethernet\n            autoconnect: True\n            ip:\n              address:\n                - 198.51.100.1/30\n              gateway4: 198.51.100.2\n              dns:\n                - 198.51.100.200\n            state: up\n            zone: external\n\n          - name: Provider-B\n            interface_name: enp1s0\n            type: ethernet\n            autoconnect: True\n            ip:\n              address:\n                - 192.0.2.1/30\n              route:\n                - network: 0.0.0.0\n                  prefix: 0\n                  gateway: 192.0.2.2\n                  table: 5000\n            state: up\n            zone: external\n\n          - name: Internal-Workstations\n            interface_name: enp8s0\n            type: ethernet\n            autoconnect: True\n            ip:\n              address:\n                - 10.0.0.1/24\n              route:\n                - network: 10.0.0.0\n                  prefix: 24\n                  table: 5000\n              routing_rule:\n                - priority: 5\n                  from: 10.0.0.0/24\n                  table: 5000\n            state: up\n            zone: trusted\n\n          - name: Servers\n            interface_name: enp9s0\n            type: ethernet\n            autoconnect: True\n            ip:\n              address:\n                - 203.0.113.1/24\n            state: up\n            zone: trusted\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">table: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tAssigns the route from the same list entry as the \u003Ccode class=\"literal\">table\u003C/code> variable to the specified routing table.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">routing_rule: \u003Cspan class=\"emphasis\">\u003Cem>&lt;list&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines the priority of the specified routing rule and from a connection profile to which routing table the rule is assigned.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">zone: \u003Cspan class=\"emphasis\">\u003Cem>&lt;zone_name&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tAssigns the network interface from a connection profile to the specified \u003Ccode class=\"literal\">firewalld\u003C/code> zone.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn a RHEL host in the internal workstation subnet:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">traceroute\u003C/code> package:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install traceroute\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">traceroute\u003C/code> utility to display the route to a host on the internet:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>traceroute redhat.com\u003C/strong>\u003C/span>\ntraceroute to redhat.com (209.132.183.105), 30 hops max, 60 byte packets\n 1  10.0.0.1 (10.0.0.1)     0.337 ms  0.260 ms  0.223 ms\n 2  192.0.2.1 (192.0.2.1)   0.884 ms  1.066 ms  1.248 ms\n ...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe output of the command displays that the router sends packets over \u003Ccode class=\"literal\">192.0.2.1\u003C/code>, which is the network of provider B.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn a RHEL host in the server subnet:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInstall the \u003Ccode class=\"literal\">traceroute\u003C/code> package:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install traceroute\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">traceroute\u003C/code> utility to display the route to a host on the internet:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>traceroute redhat.com\u003C/strong>\u003C/span>\ntraceroute to redhat.com (209.132.183.105), 30 hops max, 60 byte packets\n 1  203.0.113.1 (203.0.113.1)    2.179 ms  2.073 ms  1.944 ms\n 2  198.51.100.2 (198.51.100.2)  1.868 ms  1.798 ms  1.549 ms\n ...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe output of the command displays that the router sends packets over \u003Ccode class=\"literal\">198.51.100.2\u003C/code>, which is the network of provider A.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the RHEL router that you configured using the RHEL system role:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay the rule list:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip rule list\u003C/strong>\u003C/span>\n0:      from all lookup local\n\u003Cspan class=\"strong strong\">\u003Cstrong>5\u003C/strong>\u003C/span>:    \u003Cspan class=\"strong strong\">\u003Cstrong>from 10.0.0.0/24 lookup 5000\u003C/strong>\u003C/span>\n32766:  from all lookup main\n32767:  from all lookup default\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tBy default, RHEL contains rules for the tables \u003Ccode class=\"literal\">local\u003C/code>, \u003Ccode class=\"literal\">main\u003C/code>, and \u003Ccode class=\"literal\">default\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay the routes in table \u003Ccode class=\"literal\">5000\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip route list table 5000\u003C/strong>\u003C/span>\n0.0.0.0/0 via 192.0.2.2 dev enp1s0 proto static metric 100\n10.0.0.0/24 dev enp8s0 proto static scope link src 192.0.2.1 metric 102\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay the interfaces and firewall zones:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --get-active-zones\u003C/strong>\u003C/span>\nexternal\n  interfaces: enp1s0 enp7s0\ntrusted\n  interfaces: enp8s0 enp9s0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tVerify that the \u003Ccode class=\"literal\">external\u003C/code> zone has masquerading enabled:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --info-zone=external\u003C/strong>\u003C/span>\nexternal (active)\n  target: default\n  icmp-block-inversion: no\n  interfaces: enp1s0 enp7s0\n  sources:\n  services: ssh\n  ports:\n  protocols:\n  \u003Cspan class=\"strong strong\">\u003Cstrong>masquerade: yes\u003C/strong>\u003C/span>\n  ...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-static-ethernet-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.10. Configuring a static Ethernet connection with 802.1X network authentication by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tNetwork Access Control (NAC) protects a network from unauthorized clients. You can specify the details that are required for the authentication in NetworkManager connection profiles to enable clients to access the network. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use an Ansible playbook to copy a private key, a certificate, and the CA certificate to the client, and then use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure a connection profile with 802.1X network authentication.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe network supports 802.1X network authentication.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed nodes use NetworkManager.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe following files required for the TLS authentication exist on the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe client key is stored in the \u003Ccode class=\"literal\">/srv/data/client.key\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe client certificate is stored in the \u003Ccode class=\"literal\">/srv/data/client.crt\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe Certificate Authority (CA) certificate is stored in the \u003Ccode class=\"literal\">/srv/data/ca.crt\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure an Ethernet connection with 802.1X authentication\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Copy client key for 802.1X authentication\n      ansible.builtin.copy:\n        src: \"/srv/data/client.key\"\n        dest: \"/etc/pki/tls/private/client.key\"\n        mode: 0600\n\n    - name: Copy client certificate for 802.1X authentication\n      ansible.builtin.copy:\n        src: \"/srv/data/client.crt\"\n        dest: \"/etc/pki/tls/certs/client.crt\"\n\n    - name: Copy CA certificate for 802.1X authentication\n      ansible.builtin.copy:\n        src: \"/srv/data/ca.crt\"\n        dest: \"/etc/pki/ca-trust/source/anchors/ca.crt\"\n\n    - name: Ethernet connection profile with static IP address settings and 802.1X\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: enp1s0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              address:\n                - 192.0.2.1/24\n                - 2001:db8:1::1/64\n              gateway4: 192.0.2.254\n              gateway6: 2001:db8:1::fffe\n              dns:\n                - 192.0.2.200\n                - 2001:db8:1::ffbb\n              dns_search:\n                - example.com\n            ieee802_1x:\n              identity: \u003Cspan class=\"emphasis\">\u003Cem>&lt;user_name&gt;\u003C/em>\u003C/span>\n              eap: tls\n              private_key: \"/etc/pki/tls/private/client.key\"\n              private_key_password: \"{{ pwd }}\"\n              client_cert: \"/etc/pki/tls/certs/client.crt\"\n              ca_cert: \"/etc/pki/ca-trust/source/anchors/ca.crt\"\n              domain_suffix_match: example.com\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ieee802_1x\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThis variable contains the 802.1X-related settings.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">eap: tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tConfigures the profile to use the certificate-based \u003Ccode class=\"literal\">TLS\u003C/code> authentication method for the Extensible Authentication Protocol (EAP).\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAccess resources on the network that require network authentication.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-a-wifi-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.11. Configuring a wifi connection with 802.1X network authentication by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tNetwork Access Control (NAC) protects a network from unauthorized clients. You can specify the details that are required for the authentication in NetworkManager connection profiles to enable clients to access the network. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use an Ansible playbook to copy a private key, a certificate, and the CA certificate to the client, and then use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to configure a connection profile with 802.1X network authentication.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe network supports 802.1X network authentication.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou installed the \u003Ccode class=\"literal\">wpa_supplicant\u003C/code> package on the managed node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDHCP is available in the network of the managed node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe following files required for TLS authentication exist on the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe client key is stored in the \u003Ccode class=\"literal\">/srv/data/client.key\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe client certificate is stored in the \u003Ccode class=\"literal\">/srv/data/client.crt\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe CA certificate is stored in the \u003Ccode class=\"literal\">/srv/data/ca.crt\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">pwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure a wifi connection with 802.1X authentication\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Copy client key for 802.1X authentication\n      ansible.builtin.copy:\n        src: \"/srv/data/client.key\"\n        dest: \"/etc/pki/tls/private/client.key\"\n        mode: 0400\n\n    - name: Copy client certificate for 802.1X authentication\n      ansible.builtin.copy:\n        src: \"/srv/data/client.crt\"\n        dest: \"/etc/pki/tls/certs/client.crt\"\n\n    - name: Copy CA certificate for 802.1X authentication\n      ansible.builtin.copy:\n        src: \"/srv/data/ca.crt\"\n        dest: \"/etc/pki/ca-trust/source/anchors/ca.crt\"\n\n    - name: Wifi connection profile with dynamic IP address settings and 802.1X\n      ansible.builtin.import_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: Wifi connection profile with dynamic IP address settings and 802.1X\n            interface_name: wlp1s0\n            state: up\n            type: wireless\n            autoconnect: yes\n            ip:\n              dhcp4: true\n              auto6: true\n            wireless:\n              ssid: \"Example-wifi\"\n              key_mgmt: \"wpa-eap\"\n            ieee802_1x:\n              identity: \u003Cspan class=\"emphasis\">\u003Cem>&lt;user_name&gt;\u003C/em>\u003C/span>\n              eap: tls\n              private_key: \"/etc/pki/tls/client.key\"\n              private_key_password: \"{{ pwd }}\"\n              private_key_password_flags: none\n              client_cert: \"/etc/pki/tls/client.pem\"\n              ca_cert: \"/etc/pki/tls/cacert.pem\"\n              domain_suffix_match: \"example.com\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ieee802_1x\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThis variable contains the 802.1X-related settings.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">eap: tls\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tConfigures the profile to use the certificate-based \u003Ccode class=\"literal\">TLS\u003C/code> authentication method for the Extensible Authentication Protocol (EAP).\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_setting-the-default-gateway-on-an-existing-connection-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.12. Setting the default gateway on an existing connection by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA host forwards a network packet to its default gateway if the packet’s destination can neither be reached through the directly-connected networks nor through any of the routes configured on the host. To configure the default gateway of a host, set it in the NetworkManager connection profile of the interface that is connected to the same network as the default gateway. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn most situations, administrators set the default gateway when they create a connection. However, you can also set or update the default gateway setting on a previously-created connection.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou cannot use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ethernet connection profile with static IP address settings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: enp1s0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              address:\n                - 198.51.100.20/24\n                - 2001:db8:1::1/64\n              \u003Cspan class=\"strong strong\">\u003Cstrong>gateway4: 198.51.100.254\u003C/strong>\u003C/span>\n              \u003Cspan class=\"strong strong\">\u003Cstrong>gateway6: 2001:db8:1::fffe\u003C/strong>\u003C/span>\n              dns:\n                - 198.51.100.200\n                - 2001:db8:1::ffbb\n              dns_search:\n                - example.com\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tQuery the Ansible facts of the managed node and verify the active network settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.setup\u003C/strong>\u003C/span>\n...\n        \"ansible_default_ipv4\": {\n\t    ...\n            \"gateway\": \"198.51.100.254\",\n            \"interface\": \"enp1s0\",\n\t    ...\n        },\n        \"ansible_default_ipv6\": {\n\t    ...\n            \"gateway\": \"2001:db8:1::fffe\",\n            \"interface\": \"enp1s0\",\n\t    ...\n\t}\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-a-static-route-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.13. Configuring a static route by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA static route ensures that you can send traffic to a destination that cannot be reached through the default gateway. You configure static routes in the NetworkManager connection profile of the interface that is connected to the same network as the next hop. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou cannot use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ethernet connection profile with static IP address settings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: enp7s0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              address:\n                - 192.0.2.1/24\n                - 2001:db8:1::1/64\n              gateway4: 192.0.2.254\n              gateway6: 2001:db8:1::fffe\n              dns:\n                - 192.0.2.200\n                - 2001:db8:1::ffbb\n              dns_search:\n                - example.com\n              \u003Cspan class=\"strong strong\">\u003Cstrong>route:\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>- network: 198.51.100.0\u003C/strong>\u003C/span>\n                  \u003Cspan class=\"strong strong\">\u003Cstrong>prefix: 24\u003C/strong>\u003C/span>\n                  \u003Cspan class=\"strong strong\">\u003Cstrong>gateway: 192.0.2.10\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>- network: 2001:db8:2::\u003C/strong>\u003C/span>\n                  \u003Cspan class=\"strong strong\">\u003Cstrong>prefix: 64\u003C/strong>\u003C/span>\n                  \u003Cspan class=\"strong strong\">\u003Cstrong>gateway: 2001:db8:1::10\u003C/strong>\u003C/span>\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the IPv4 routes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ip -4 route'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n...\n198.51.100.0/24 via 192.0.2.10 dev enp7s0\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the IPv6 routes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ip -6 route'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n...\n2001:db8:2::/64 via 2001:db8:1::10 dev enp7s0 metric 1024 pref medium\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-an-ethtool-offload-feature-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.14. Configuring an \u003Ccode class=\"literal\">ethtool\u003C/code> offload feature by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tNetwork interface controllers can use the TCP offload engine (TOE) to offload processing certain operations to the network controller. This improves the network throughput. You configure offload features in the connection profile of the network interface. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou cannot use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ethernet connection profile with dynamic IP address settings and offload features\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: enp1s0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              dhcp4: yes\n              auto6: yes\n            \u003Cspan class=\"strong strong\">\u003Cstrong>ethtool:\u003C/strong>\u003C/span>\n              \u003Cspan class=\"strong strong\">\u003Cstrong>features:\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>gro: no\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>gso: yes\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>tx_sctp_segmentation: no\u003C/strong>\u003C/span>\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">gro: no\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDisables Generic receive offload (GRO).\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">gso: yes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables Generic segmentation offload (GSO).\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tx_sctp_segmentation: no\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDisables TX stream control transmission protocol (SCTP) segmentation.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tQuery the Ansible facts of the managed node and verify the offload settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m ansible.builtin.setup\u003C/strong>\u003C/span>\n...\n        \"ansible_enp1s0\": {\n            \"active\": true,\n            \"device\": \"enp1s0\",\n\t    \"features\": {\n\t        ...\n\t\t\"rx_gro_hw\": \"off,\n\t        ...\n\t\t\"tx_gso_list\": \"on,\n\t        ...\n\t\t\"tx_sctp_segmentation\": \"off\",\n\t\t...\n            }\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-an-ethtool-coalesce-settings-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.15. Configuring an \u003Ccode class=\"literal\">ethtool\u003C/code> coalesce settings by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBy using interrupt coalescing, the system collects network packets and generates a single interrupt for multiple packets. This increases the amount of data sent to the kernel with one hardware interrupt, which reduces the interrupt load, and maximizes the throughput. You configure coalesce settings in the connection profile of the network interface. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou cannot use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ethernet connection profile with dynamic IP address settings and coalesce settings\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: enp1s0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              dhcp4: yes\n              auto6: yes\n            \u003Cspan class=\"strong strong\">\u003Cstrong>ethtool:\u003C/strong>\u003C/span>\n              \u003Cspan class=\"strong strong\">\u003Cstrong>coalesce:\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>rx_frames: 128\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>tx_frames: 128\u003C/strong>\u003C/span>\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">rx_frames: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the number of RX frames.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">gso: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the number of TX frames.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the current offload features of the network device:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ethtool -c enp1s0'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n...\nrx-frames:\t128\n...\ntx-frames:\t128\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_increasing-the-ring-buffer-size-to-reduce-a-high-packet-drop-rate-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.16. Increasing the ring buffer size to reduce a high packet drop rate by using the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIncrease the size of an Ethernet device’s ring buffers if the packet drop rate causes applications to report a loss of data, timeouts, or other issues.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tRing buffers are circular buffers where an overflow overwrites existing data. The network card assigns a transmit (TX) and receive (RX) ring buffer. Receive ring buffers are shared between the device driver and the network interface controller (NIC). Data can move from NIC to the kernel through either hardware interrupts or software interrupts, also called SoftIRQs.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe kernel uses the RX ring buffer to store incoming packets until the device driver can process them. The device driver drains the RX ring, typically by using SoftIRQs, which puts the incoming packets into a kernel data structure called an \u003Ccode class=\"literal\">sk_buff\u003C/code> or \u003Ccode class=\"literal\">skb\u003C/code> to begin its journey through the kernel and up to the application that owns the relevant socket.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe kernel uses the TX ring buffer to hold outgoing packets which should be sent to the network. These ring buffers reside at the bottom of the stack and are a crucial point at which packet drop can occur, which in turn will adversely affect network performance.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou configure ring buffer settings in the NetworkManager connection profiles. By using Ansible and the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role, you can automate this process and remotely configure connection profiles on the hosts defined in a playbook.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou cannot use the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role to update only specific values in an existing connection profile. The role ensures that a connection profile exactly matches the settings in a playbook. If a connection profile with the same name already exists, the role applies the settings from the playbook and resets all other settings in the profile to their defaults. To prevent resetting values, always specify the whole configuration of the network connection profile in the playbook, including the settings that you do not want to change.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the maximum ring buffer sizes that the device supports.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configure the network\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Ethernet connection profile with dynamic IP address setting and increased ring buffer sizes\n      ansible.builtin.include_role:\n        name: rhel-system-roles.network\n      vars:\n        network_connections:\n          - name: enp1s0\n            type: ethernet\n            autoconnect: yes\n            ip:\n              dhcp4: yes\n              auto6: yes\n            \u003Cspan class=\"strong strong\">\u003Cstrong>ethtool:\u003C/strong>\u003C/span>\n              \u003Cspan class=\"strong strong\">\u003Cstrong>ring:\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>rx: 4096\u003C/strong>\u003C/span>\n                \u003Cspan class=\"strong strong\">\u003Cstrong>tx: 4096\u003C/strong>\u003C/span>\n            state: up\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">rx: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the maximum number of received ring buffer entries.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tx: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSets the maximum number of transmitted ring buffer entries.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the maximum ring buffer sizes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ethtool -g enp1s0'\u003C/strong>\u003C/span>\nmanaged-node-01.example.com | CHANGED | rc=0 &gt;&gt;\n...\nCurrent hardware settings:\nRX:             4096\nRX Mini:        0\nRX Jumbo:       0\nTX:             4096\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_network-states-for-the-network-rhel-system-roles_assembly_configuring-network-settings-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.17. Network states for the \u003Ccode class=\"literal\">network\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">network\u003C/code> RHEL system role supports state configurations in playbooks to configure the devices. For this, use the \u003Ccode class=\"literal\">network_state\u003C/code> variable followed by the state configurations.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tBenefits of using the \u003Ccode class=\"literal\">network_state\u003C/code> variable in a playbook:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUsing the declarative method with the state configurations, you can configure interfaces, and the NetworkManager creates a profile for these interfaces in the background.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tWith the \u003Ccode class=\"literal\">network_state\u003C/code> variable, you can specify the options that you require to change, and all the other options will remain the same as they are. However, with the \u003Ccode class=\"literal\">network_connections\u003C/code> variable, you must specify all settings to change the network connection profile.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can set only Nmstate YAML instructions in \u003Ccode class=\"literal\">network_state\u003C/code>. These instructions differ from the variables you can set in \u003Ccode class=\"literal\">network_connections\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tFor example, to create an Ethernet connection with dynamic IP address settings, use the following \u003Ccode class=\"literal\">vars\u003C/code> block in your playbook:\n\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tPlaybook with state configurations\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tRegular playbook\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\">\n\u003Cpre class=\"programlisting language-yaml\">vars:\n  network_state:\n    interfaces:\n    - name: enp7s0\n      type: ethernet\n      state: up\n      ipv4:\n        enabled: true\n        auto-dns: true\n        auto-gateway: true\n        auto-routes: true\n        dhcp: true\n      ipv6:\n        enabled: true\n        auto-dns: true\n        auto-gateway: true\n        auto-routes: true\n        autoconf: true\n        dhcp: true\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\">\n\u003Cpre class=\"programlisting language-yaml\">vars:\n  network_connections:\n    - name: enp7s0\n      interface_name: enp7s0\n      type: ethernet\n      autoconnect: yes\n      ip:\n        dhcp4: yes\n        auto6: yes\n      state: up\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tFor example, to only change the connection status of dynamic IP address settings that you created as above, use the following \u003Ccode class=\"literal\">vars\u003C/code> block in your playbook:\n\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tPlaybook with state configurations\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\"> \u003Cp>\n\t\t\t\t\t\t\t\tRegular playbook\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\">\n\u003Cpre class=\"programlisting language-yaml\">vars:\n  network_state:\n    interfaces:\n    - name: enp7s0\n      type: ethernet\n      state: down\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\">\n\u003Cpre class=\"programlisting language-yaml\">vars:\n  network_connections:\n    - name: enp7s0\n      interface_name: enp7s0\n      type: ethernet\n      autoconnect: yes\n      ip:\n        dhcp4: yes\n        auto6: yes\n      state: down\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.network/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/network/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 21. Managing containers by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tWith the \u003Ccode class=\"literal\">podman\u003C/code> RHEL system role, you can manage Podman configuration, containers, and \u003Ccode class=\"literal\">systemd\u003C/code> services that run Podman containers.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"creating-a-rootless-container-with-bind-mount_managing-containers-by-using-the-podman-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.1. Creating a rootless container with bind mount by using the \u003Ccode class=\"literal\">podman\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">podman\u003C/code> RHEL system role to create rootless containers with bind mount by running an Ansible playbook and with that, manage your application configuration.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe example Ansible playbook starts two Kubernetes pods: one for a database and another for a web application. The database pod configuration is specified in the playbook, while the web application pod is defined in an external YAML file.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user and group \u003Ccode class=\"literal\">webapp\u003C/code> exist, and must be listed in the \u003Ccode class=\"literal\">/etc/subuid\u003C/code> and \u003Ccode class=\"literal\">/etc/subgid\u003C/code> files on the host.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Configure Podman\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Create a web application and a database\n      ansible.builtin.include_role:\n        name: rhel-system-roles.podman\n      vars:\n        podman_create_host_directories: true\n        podman_firewall:\n          - port: 8080-8081/tcp\n            state: enabled\n          - port: 12340/tcp\n            state: enabled\n        podman_selinux_ports:\n          - ports: 8080-8081\n            setype: http_port_t\n        podman_kube_specs:\n          - state: started\n            run_as_user: dbuser\n            run_as_group: dbgroup\n            kube_file_content:\n              apiVersion: v1\n              kind: Pod\n              metadata:\n                name: db\n              spec:\n                containers:\n                  - name: db\n                    image:  quay.io/linux-system-roles/mysql:5.6\n                    ports:\n                      - containerPort: 1234\n                        hostPort: 12340\n                    volumeMounts:\n                      - mountPath: /var/lib/db:Z\n                        name: db\n                volumes:\n                  - name: db\n                    hostPath:\n                      path: /var/lib/db\n          - state: started\n            run_as_user: webapp\n            run_as_group: webapp\n            kube_file_src: /path/to/webapp.yml\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">run_as_user\u003C/code> and \u003Ccode class=\"literal\">run_as_group\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSpecify that containers are rootless.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kube_file_content\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tContains a Kubernetes YAML file defining the first container named \u003Ccode class=\"literal\">db\u003C/code>. You can generate the Kubernetes YAML file by using the \u003Ccode class=\"literal\">podman kube generate\u003C/code> command.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">db\u003C/code> container is based on the \u003Ccode class=\"literal\">quay.io/db/db:stable\u003C/code> container image.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">db\u003C/code> bind mount maps the \u003Ccode class=\"literal\">/var/lib/db\u003C/code> directory on the host to the \u003Ccode class=\"literal\">/var/lib/db\u003C/code> directory in the container. The \u003Ccode class=\"literal\">Z\u003C/code> flag labels the content with a private unshared label, therefore, only the \u003Ccode class=\"literal\">db\u003C/code> container can access the content.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kube_file_src: \u003Cspan class=\"emphasis\">\u003Cem>&lt;path&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines the second container. The content of the \u003Ccode class=\"literal\">/path/to/webapp.yml\u003C/code> file on the controller node will be copied to the \u003Ccode class=\"literal\">kube_file\u003C/code> field on the managed node.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">volumes: \u003Cspan class=\"emphasis\">\u003Cem>&lt;list&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA YAML list to define the source of the data to provide in one or more containers. For example, a local disk on the host (\u003Ccode class=\"literal\">hostPath\u003C/code>) or other disk device.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">volumeMounts: \u003Cspan class=\"emphasis\">\u003Cem>&lt;list&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA YAML list to define the destination where the individual container will mount a given volume.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">podman_create_host_directories: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tCreates the directory on the host. This instructs the role to check the kube specification for \u003Ccode class=\"literal\">hostPath\u003C/code> volumes and create those directories on the host. If you need more control over the ownership and permissions, use \u003Ccode class=\"literal\">podman_host_directories\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.podman/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.podman/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/podman/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-rootful-container-with-podman-volume_managing-containers-by-using-the-podman-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.2. Creating a rootful container with Podman volume by using the \u003Ccode class=\"literal\">podman\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">podman\u003C/code> RHEL system role to create a rootful container with a Podman volume by running an Ansible playbook and with that, manage your application configuration.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe example Ansible playbook deploys a Kubernetes pod named \u003Ccode class=\"literal\">ubi8-httpd\u003C/code> running an HTTP server container from the \u003Ccode class=\"literal\">registry.access.redhat.com/ubi8/httpd-24\u003C/code> image. The container’s web content is mounted from a persistent volume named \u003Ccode class=\"literal\">ubi8-html-volume\u003C/code>. By default, the \u003Ccode class=\"literal\">podman\u003C/code> role creates rootful containers.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Configure Podman\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Start Apache server on port 8080\n      ansible.builtin.include_role:\n        name: rhel-system-roles.podman\n  vars:\n    podman_firewall:\n      - port: 8080/tcp\n        state: enabled\n    podman_kube_specs:\n      - state: started\n        kube_file_content:\n          apiVersion: v1\n          kind: Pod\n          metadata:\n            name: ubi8-httpd\n          spec:\n            containers:\n              - name: ubi8-httpd\n                image: registry.access.redhat.com/ubi8/httpd-24\n                ports:\n                  - containerPort: 8080\n                    hostPort: 8080\n                volumeMounts:\n                  - mountPath: /var/www/html:Z\n                    name: ubi8-html\n            volumes:\n              - name: ubi8-html\n                persistentVolumeClaim:\n                  claimName: ubi8-html-volume\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">kube_file_content\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tContains a Kubernetes YAML file defining the first container named \u003Ccode class=\"literal\">db\u003C/code>. You can generate the Kubernetes YAML file by using the \u003Ccode class=\"literal\">podman kube generate\u003C/code> command.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ubi8-httpd\u003C/code> container is based on the \u003Ccode class=\"literal\">registry.access.redhat.com/ubi8/httpd-24\u003C/code> container image.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ubi8-html-volume\u003C/code> maps the \u003Ccode class=\"literal\">/var/www/html\u003C/code> directory on the host to the container. The \u003Ccode class=\"literal\">Z\u003C/code> flag labels the content with a private unshared label, therefore, only the \u003Ccode class=\"literal\">ubi8-httpd\u003C/code> container can access the content.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tThe pod mounts the existing persistent volume named \u003Ccode class=\"literal\">ubi8-html-volume\u003C/code> with the mount path \u003Ccode class=\"literal\">/var/www/html\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.podman/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.podman/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/podman/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-quadlet-application-with-secrets_managing-containers-by-using-the-podman-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.3. Creating a Quadlet application with secrets by using the \u003Ccode class=\"literal\">podman\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">podman\u003C/code> RHEL system role to create a Quadlet application with secrets by running an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe certificate and the corresponding private key that the web server in the container should use are stored in the \u003Ccode class=\"literal\">~/certificate.pem\u003C/code> and \u003Ccode class=\"literal\">~/key.pem\u003C/code> files.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the contents of the certificate and private key files:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat ~/certificate.pem\u003C/strong>\u003C/span>\n-----BEGIN CERTIFICATE-----\n...\n-----END CERTIFICATE-----\n\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat ~/key.pem\u003C/strong>\u003C/span>\n-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou require this information in a later step.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">root_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;root_password&gt;\u003C/em>\u003C/span>\ncertificate: |-\n  -----BEGIN CERTIFICATE-----\n  ...\n  -----END CERTIFICATE-----\nkey: |-\n  -----BEGIN PRIVATE KEY-----\n  ...\n  -----END PRIVATE KEY-----\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnsure that all lines in the \u003Ccode class=\"literal\">certificate\u003C/code> and \u003Ccode class=\"literal\">key\u003C/code> variables start with two spaces.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Deploy a wordpress CMS with MySQL database\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n  - name: Create and run the container\n    ansible.builtin.include_role:\n      name: rhel-system-roles.podman\n    vars:\n      podman_create_host_directories: true\n      podman_activate_systemd_unit: false\n      podman_quadlet_specs:\n        - name: quadlet-demo\n          type: network\n          file_content: |\n            [Network]\n            Subnet=192.168.30.0/24\n            Gateway=192.168.30.1\n            Label=app=wordpress\n        - file_src: quadlet-demo-mysql.volume\n        - template_src: quadlet-demo-mysql.container.j2\n        - file_src: envoy-proxy-configmap.yml\n        - file_src: quadlet-demo.yml\n        - file_src: quadlet-demo.kube\n          activate_systemd_unit: true\n      podman_firewall:\n        - port: 8000/tcp\n          state: enabled\n        - port: 9000/tcp\n          state: enabled\n      podman_secrets:\n        - name: mysql-root-password-container\n          state: present\n          skip_existing: true\n          data: \"{{ root_password }}\"\n        - name: mysql-root-password-kube\n          state: present\n          skip_existing: true\n          data: |\n            apiVersion: v1\n            data:\n              password: \"{{ root_password | b64encode }}\"\n            kind: Secret\n            metadata:\n              name: mysql-root-password-kube\n        - name: envoy-certificates\n          state: present\n          skip_existing: true\n          data: |\n            apiVersion: v1\n            data:\n              certificate.key: {{ key | b64encode }}\n              certificate.pem: {{ certificate | b64encode }}\n            kind: Secret\n            metadata:\n              name: envoy-certificates\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe procedure creates a WordPress content management system paired with a MySQL database. The \u003Ccode class=\"literal\">podman_quadlet_specs role\u003C/code> variable defines a set of configurations for the Quadlet, which refers to a group of containers or services that work together in a certain way. It includes the following specifications:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe Wordpress network is defined by the \u003Ccode class=\"literal\">quadlet-demo\u003C/code> network unit.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe volume configuration for MySQL container is defined by the \u003Ccode class=\"literal\">file_src: quadlet-demo-mysql.volume\u003C/code> field.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">template_src: quadlet-demo-mysql.container.j2\u003C/code> field is used to generate a configuration for the MySQL container.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tTwo YAML files follow: \u003Ccode class=\"literal\">file_src: envoy-proxy-configmap.yml\u003C/code> and \u003Ccode class=\"literal\">file_src: quadlet-demo.yml\u003C/code>. Note that .yml is not a valid Quadlet unit type, therefore these files will just be copied and not processed as a Quadlet specification.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe Wordpress and envoy proxy containers and configuration are defined by the \u003Ccode class=\"literal\">file_src: quadlet-demo.kube\u003C/code> field. The kube unit refers to the previous YAML files in the \u003Ccode class=\"literal\">[Kube]\u003C/code> section as \u003Ccode class=\"literal\">Yaml=quadlet-demo.yml\u003C/code> and \u003Ccode class=\"literal\">ConfigMap=envoy-proxy-configmap.yml\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.podman/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/podman/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 22. Configuring Postfix MTA by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWith the \u003Ccode class=\"literal\">postfix\u003C/code> RHEL system role, you can consistently streamline automated configurations of the Postfix service, a Sendmail-compatible mail transfer agent (MTA) with modular design and a variety of configuration options. The \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package contains this RHEL system role, and also the reference documentation.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"using-the-postfix-system-role-to-automate-basic-postfix-mta-administration_configuring-postfix-mta-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.1. Using the \u003Ccode class=\"literal\">postfix\u003C/code> RHEL system role to automate basic Postfix MTA administration\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can install, configure and start the Postfix Mail Transfer Agent on the managed nodes by using the \u003Ccode class=\"literal\">postfix\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage postfix\n  hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.postfix\n  vars:\n    postfix_conf:\n      relay_domains: $mydestination\n        relayhost: example.com\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf you want Postfix to use a different hostname than the fully-qualified domain name (FQDN) that is returned by the \u003Ccode class=\"literal\">gethostname()\u003C/code> function, add the \u003Ccode class=\"literal\">myhostname\u003C/code> parameter under the \u003Ccode class=\"literal\">postfix_conf:\u003C/code> line in the file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">myhostname = smtp.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the domain name differs from the domain name in the \u003Ccode class=\"literal\">myhostname\u003C/code> parameter, add the \u003Ccode class=\"literal\">mydomain\u003C/code> parameter. Otherwise, the \u003Ccode class=\"literal\">$myhostname\u003C/code> minus the first component is used.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">mydomain = \u003Cspan class=\"emphasis\">\u003Cem>&lt;example.com&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse \u003Ccode class=\"literal\">postfix_manage_firewall: true\u003C/code> variable to ensure that the SMTP port is open in the firewall on the servers.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tManage the SMTP related ports, \u003Ccode class=\"literal\">25/tcp\u003C/code>, \u003Ccode class=\"literal\">465/tcp\u003C/code>, and \u003Ccode class=\"literal\">587/tcp\u003C/code>. If the variable is set to \u003Ccode class=\"literal\">false\u003C/code>, the \u003Ccode class=\"literal\">postfix\u003C/code> role does not manage the firewall. The default is \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">postfix_manage_firewall\u003C/code> variable is limited to adding ports. It cannot be used for removing ports. If you want to remove ports, use the \u003Ccode class=\"literal\">firewall\u003C/code> RHEL system role directly.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf your scenario involves using non-standard ports, set the \u003Ccode class=\"literal\">postfix_manage_selinux: true\u003C/code> variable to ensure that the port is properly labeled for SELinux on the servers.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">postfix_manage_selinux\u003C/code> variable is limited to adding rules to the SELinux policy. It cannot remove rules from the policy. If you want to remove rules, use the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role directly.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.postfix/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/postfix/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 23. Installing and configuring PostgreSQL by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAs a system administrator, you can use the \u003Ccode class=\"literal\">postgresql\u003C/code> RHEL system role to install, configure, manage, start, and improve performance of the PostgreSQL server.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"introduction-to-the-postgresql-rhel-system-role_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.1. Introduction to the \u003Ccode class=\"literal\">postgresql\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo install, configure, manage, and start the PostgreSQL server using Ansible, you can use the \u003Ccode class=\"literal\">postgresql\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can also use the \u003Ccode class=\"literal\">postgresql\u003C/code> role to optimize the database server settings and improve performance.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe role supports the currently released and supported versions of PostgreSQL on RHEL 8 and RHEL 9 managed nodes.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"configuring-the-postgresql-server-by-using-rhel-system-roles_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.2. Configuring the PostgreSQL server by using the \u003Ccode class=\"literal\">postgresql\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">postgresql\u003C/code> RHEL system role to install, configure, manage, and start the PostgreSQL server.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">postgresql\u003C/code> role replaces PostgreSQL configuration files in the \u003Ccode class=\"literal\">/var/lib/pgsql/data/\u003C/code> directory on the managed hosts. Previous settings are changed to those specified in the role variables, and lost if they are not specified in the role variables.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage PostgreSQL\n  hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.postgresql\n  vars:\n    postgresql_version: \"13\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.postgresql/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/postgresql/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_using_database_servers/using-postgresql_configuring-and-using-database-servers\">Using PostgreSQL\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 24. Registering the system by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tThe \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role enables administrators to automate the registration of multiple systems with Red Hat Subscription Management (RHSM) and Satellite servers. The role also supports Insights-related configuration and management tasks by using Ansible.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"introduction-to-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.1. Introduction to the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tRHEL system role is a set of roles that provides a consistent configuration interface to remotely manage multiple systems. The remote host configuration (\u003Ccode class=\"literal\">rhc\u003C/code>) RHEL system role enables administrators to easily register RHEL systems to Red Hat Subscription Management (RHSM) and Satellite servers. By default, when you register a system by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role, the system is connected to Insights. Additionally, with the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role, you can:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tConfigure connections to Red Hat Insights\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnable and disable repositories\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tConfigure the proxy to use for the connection\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tConfigure insights remediations and, auto updates\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSet the release of the system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tConfigure insights tags\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"registering-system-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.2. Registering a system by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can register your system to Red Hat by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role. By default, the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role connects the system to Red Hat Insights when you register it.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">activationKey: \u003Cspan class=\"emphasis\">\u003Cem>&lt;activation_key&gt;\u003C/em>\u003C/span>\nusername: \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\npassword: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo register by using an activation key and organization ID (recommended), use the following playbook:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Registering system using activation key and organization ID\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_auth:\n      activation_keys:\n        keys:\n          -  \"{{ activationKey }}\"\n    rhc_organization: organizationID\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo register by using a username and password, use the following playbook:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Registering system with username and password\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  vars:\n    rhc_auth:\n      login:\n        username: \"{{ username }}\"\n        password: \"{{ password }}\"\n  roles:\n    - role: rhel-system-roles.rhc\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"registering-system-with-satellite-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.3. Registering a system with Satellite by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen organizations use Satellite to manage systems, it is necessary to register the system through Satellite. You can remotely register your system with Satellite by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">activationKey: \u003Cspan class=\"emphasis\">\u003Cem>&lt;activation_key&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Register to the custom registration server and CDN\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_auth:\n      login:\n        activation_keys:\n          keys:\n            - \"{{ activationKey }}\"\n        rhc_organization: organizationID\n    rhc_server:\n      hostname: example.com\n        port: 443\n        prefix: /rhsm\n    rhc_baseurl: http://example.com/pulp/content\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-insights-connection-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.4. Disabling the connection to Insights after the registration by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen you register a system by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role, the role by default, enables the connection to Red Hat Insights. You can disable it by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role, if not required.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have registered the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Disable Insights connection\n  hosts: managed-node-01.example.com\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_insights:\n      state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-repositories-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.5. Enabling repositories by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can remotely enable or disable repositories on managed nodes by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have details of the repositories which you want to enable or disable on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have registered the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo enable a repository:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Enable repository\n  hosts: managed-node-01.example.com\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_repositories:\n      - {name: \"RepositoryName\", state: enabled}\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo disable a repository:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Disable repository\n  hosts: managed-node-01.example.com\n  vars:\n    rhc_repositories:\n      - {name: \"RepositoryName\", state: disabled}\n  roles:\n    - role: rhel-system-roles.rhc\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-release-versions-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.6. Setting release versions by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can limit the system to use only repositories for a particular minor RHEL version instead of the latest one. This way, you can lock your system to a specific minor RHEL version.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the minor RHEL version to which you want to lock the system. Note that you can only lock the system to the RHEL minor version that the host currently runs or a later minor version.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have registered the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Set Release\n  hosts: managed-node-01.example.com\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_release: \"8.6\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-proxy-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.7. Using a proxy server when registering the host by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf your security restrictions allow access to the Internet only through a proxy server, you can specify the proxy’s settings in the playbook when you register the system using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">username: \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\npassword: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\nproxy_username: \u003Cspan class=\"emphasis\">\u003Cem>&lt;proxyusernme&gt;\u003C/em>\u003C/span>\nproxy_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;proxypassword&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo register to the Red Hat Customer Portal by using a proxy:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Register using proxy\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_auth:\n      login:\n        username: \"{{ username }}\"\n        password: \"{{ password }}\"\n    rhc_proxy:\n      hostname: proxy.example.com\n      port: 3128\n      username: \"{{ proxy_username }}\"\n      password: \"{{ proxy_password }}\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo remove the proxy server from the configuration of the Red Hat Subscription Manager service:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: To stop using proxy server for registration\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  vars:\n    rhc_auth:\n      login:\n        username: \"{{ username }}\"\n        password: \"{{ password }}\"\n    rhc_proxy: {\"state\":\"absent\"}\n  roles:\n    - role: rhel-system-roles.rhc\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-auto-updates-insights-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.8. Disabling auto updates of Insights rules by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can disable the automatic collection rule updates for Red Hat Insights by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role. By default, when you connect your system to Red Hat Insights, this option is enabled. You can disable it by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you disable this feature, you risk using outdated rule definition files and not getting the most recent validation updates.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have registered the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">username: \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\npassword: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Disable Red Hat Insights autoupdates\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_auth:\n      login:\n        username: \"{{ username }}\"\n        password: \"{{ password }}\"\n    rhc_insights:\n      autoupdate: false\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-insights-remediations-using-rhel-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.9. Disabling Insights remediations by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure systems to automatically update the dynamic configuration by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role. When you connect your system to Red hat Insights, it is enabled by default. You can disable it, if not required.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tEnabling remediation with the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role ensures your system is ready to be remediated when connected directly to Red Hat. For systems connected to a Satellite, or Capsule, enabling remediation must be achieved differently. For more information about Red Hat Insights remediations, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/red_hat_insights_remediations_guide/index\">Red Hat Insights Remediations Guide\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have Insights remediations enabled.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have registered the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Disable remediation\n  hosts: managed-node-01.example.com\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_insights:\n      remediation: absent\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-insights-tags-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.10. Configuring Insights tags by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use tags for system filtering and grouping. You can also customize tags based on the requirements.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">username: \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>\npassword: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Creating tags\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_auth:\n      login:\n        username: \"{{ username }}\"\n        password: \"{{ password }}\"\n    rhc_insights:\n      tags:\n        group: group-name-value\n        location: location-name-value\n        description:\n          - RHEL8\n          - SAP\n        sample_key:value\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"unregistering-a-system-using-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.11. Unregistering a system by using the \u003Ccode class=\"literal\">rhc\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can unregister the system from Red Hat if you no longer need the subscription service.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system is already registered.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Unregister the system\n  hosts: managed-node-01.example.com\n  roles:\n    - role: rhel-system-roles.rhc\n  vars:\n    rhc_state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.rhc/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/rhc/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 25. Configuring SELinux by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tYou can configure and manage SELinux permissions on other systems by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"introduction-to-the-selinux-system-role_configuring-selinux-using-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.1. Introduction to the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tRHEL system roles is a collection of Ansible roles and modules that provide a consistent configuration interface to remotely manage multiple RHEL systems. You can perform the following actions by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCleaning local policy modifications related to SELinux booleans, file contexts, ports, and logins.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSetting SELinux policy booleans, file contexts, ports, and logins.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRestoring file contexts on specified files or directories.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tManaging SELinux modules.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml\u003C/code> example playbook installed by the \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package demonstrates how to set the targeted policy in enforcing mode. The playbook also applies several local policy modifications and restores file contexts in the \u003Ccode class=\"literal\">/tmp/test_dir/\u003C/code> directory.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/selinux/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_configuring-selinux-using-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.2. Using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role to apply SELinux settings on multiple systems\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role, you can prepare and apply an Ansible playbook with your verified SELinux settings.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tPrepare your playbook. You can either start from scratch or modify the example playbook installed as a part of the \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/rhel-system-roles/selinux/example-selinux-playbook.yml \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-selinux-playbook.yml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>vi \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-selinux-playbook.yml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the content of the playbook to fit your scenario. For example, the following part ensures that the system installs and enables the \u003Ccode class=\"literal\">selinux-local-1.pp\u003C/code> SELinux module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">selinux_modules:\n- { path: \"selinux-local-1.pp\", priority: \"400\" }\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the changes, and exit the text editor.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-selinux-playbook.yml&gt;\u003C/em>\u003C/span> --syntax-check\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun your playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-selinux-playbook.yml&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/selinux/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/articles/7047896\">SELinux hardening with Ansible\u003C/a> Knowledgebase article\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"managing-ports-by-using-the-selinux-rhel-system-role_configuring-selinux-using-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.3. Managing ports by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can automate managing port access in SELinux consistently across multiple systems by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role. This might be useful, for example, when configuring an Apache HTTP server to listen on a different port. You can do this by creating a playbook with the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role that assigns the \u003Ccode class=\"literal\">http_port_t\u003C/code> SELinux type to a specific port number. After you run the playbook on the managed nodes, specific services defined in the SELinux policy can access this port.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can automate managing port access in SELinux either by using the \u003Ccode class=\"literal\">seport\u003C/code> module, which is quicker than using the entire role, or by using the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role, which is more useful when you also make other changes in SELinux configuration. The methods are equivalent, in fact the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role uses the \u003Ccode class=\"literal\">seport\u003C/code> module when configuring ports. Each of the methods has the same effect as entering the command \u003Ccode class=\"literal\">semanage port -a -t http_port_t -p tcp \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\u003C/code> on the managed node.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: To verify port status by using the \u003Ccode class=\"literal\">semanage\u003C/code> command, the \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package must be installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo configure just the port number without making other changes, use the \u003Ccode class=\"literal\">seport\u003C/code> module:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Allow Apache to listen on tcp port \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\n  community.general.seport:\n    ports: \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\n    proto: tcp\n    setype: http_port_t\n    state: present\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\u003C/code> with the port number to which you want to assign the \u003Ccode class=\"literal\">http_port_t\u003C/code> type.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor more complex configuration of the managed nodes that involves other customizations of SELinux, use the \u003Ccode class=\"literal\">selinux\u003C/code> RHEL system role. Create a playbook file, for example, \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, and add the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Modify SELinux port mapping example\n  hosts: all\n  vars:\n    # Map tcp port \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span> to the 'http_port_t' SELinux port type\n    selinux_ports:\n      - ports: \u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\n        proto: tcp\n        setype: http_port_t\n        state: present\n\n  tasks:\n    - name: Include selinux role\n      ansible.builtin.include_role:\n        name: rhel-system-roles.selinux\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>\u003C/code> with the port number to which you want to assign the \u003Ccode class=\"literal\">http_port_t\u003C/code> type.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the port is assigned to the \u003Ccode class=\"literal\">http_port_t\u003C/code> type:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port --list | grep http_port_t\u003C/strong>\u003C/span>\nhttp_port_t                \ttcp  \t\u003Cspan class=\"emphasis\">\u003Cem>&lt;port_number&gt;\u003C/em>\u003C/span>, 80, 81, 443, 488, 8008, 8009, 8443, 9000\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.selinux/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/selinux/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 26. Restricting the execution of applications by using the \u003Ccode class=\"literal\">fapolicyd\u003C/code> RHEL system role\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tBy using the \u003Ccode class=\"literal\">fapolicyd\u003C/code> software framework, you can restrict the execution of applications based on a user-defined policy and the framework verifies the integrity of applications before execution. This an efficient method to prevent running untrustworthy and possibly malicious applications. You can automate the installation and configuration of \u003Ccode class=\"literal\">fapolicyd\u003C/code> by using the \u003Ccode class=\"literal\">fapolicyd\u003C/code> RHEL system role.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">fapolicyd\u003C/code> service prevents only the execution of unauthorized applications that run as regular users, and not as \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.1. Preventing users from executing untrustworthy code by using the \u003Ccode class=\"literal\">fapolicyd\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can automate the installation and configuration of the \u003Ccode class=\"literal\">fapolicyd\u003C/code> service by using the \u003Ccode class=\"literal\">fapolicyd\u003C/code> RHEL system role. With this role, you can remotely configure the service to allow users to execute only trusted applications, for example, the ones which are listed in the RPM database and in an allow list. Additionally, the service can perform integrity checks before it executes an allowed application.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Configuring fapolicyd\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Allow only executables installed from RPM database and specific files\n      ansible.builtin.include_role:\n        name: rhel-system-roles.fapolicyd\n      vars:\n        fapolicyd_setup_permissive: false\n        fapolicyd_setup_integrity: sha256\n        fapolicyd_setup_trust: rpmdb,file\n        fapolicyd_add_trusted_file:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;path_to_allowed_command&gt;\u003C/em>\u003C/span>\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;path_to_allowed_service&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">fapolicyd_setup_permissive: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code> \u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables or disables sending policy decisions to the kernel for enforcement. Set this variable for debugging and testing purposes to \u003Ccode class=\"literal\">false\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">fapolicyd_setup_integrity: \u003Cspan class=\"emphasis\">\u003Cem>&lt;type_type&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tDefines the integrity checking method. You can set one of the following values:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">none\u003C/code> (default): Disables integrity checking.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">size\u003C/code>: The service compares only the file sizes of allowed applications.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ima\u003C/code>: The service checks the SHA-256 hash that the kernel’s Integrity Measurement Architecture (IMA) stored in a file’s extended attribute. Additionally, the service performs a size check. Note that the role does not configure the IMA kernel subsystem. To use this option, you must manually configure the IMA subsystem.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">sha256\u003C/code>: The service compares the SHA-256 hash of allowed applications.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">fapolicyd_setup_trust: \u003Cspan class=\"emphasis\">\u003Cem>&lt;trust_backends&gt;\u003C/em>\u003C/span>\u003C/code> \u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tDefines the list of trust backends. If you include the \u003Ccode class=\"literal\">file\u003C/code> backend, specify the allowed executable files in the \u003Ccode class=\"literal\">fapolicyd_add_trusted_file\u003C/code> list.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.fapolicyd.README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml --syntax-check\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExecute a binary application that is not on the allow list as a user:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'su -c \"/bin/not_authorized_application \" \u003Cspan class=\"emphasis\">\u003Cem>&lt;user_name&gt;\u003C/em>\u003C/span>'\u003C/strong>\u003C/span>\nbash: line 1: /bin/not_authorized_application: Operation not permitted non-zero return code\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.fapolicyd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/fapolicyd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 27. Configuring the OpenSSH server and client by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tYou can use the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role to configure OpenSSH servers and the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role to configure OpenSSH clients consistently, in an automated fashion, and on any number of RHEL systems at the same time. Such configurations are necessary for any system where secure remote interaction is needed, for example:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tRemote system administration: securely connecting to your machine from another computer using an SSH client.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tSecure file transfers: the Secure File Transfer Protocol (SFTP) provided by OpenSSH enable you to securely transfer files between your local machine and a remote system.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tAutomated DevOps pipelines: automating software deployments that require secure connection to remote servers (CI/CD pipelines).\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tTunneling and port forwarding: forwarding a local port to access a web service on a remote server behind a firewall. For example a remote database or a development server.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tKey-based authentication: more secure alternative to password-based logins.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tCertificate-based authentication: centralized trust management and better scalability.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnhanced security: disabling root logins, restricting user access, enforcing strong encryption and other such forms of hardening ensures stronger system security.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"sshd-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.1. How the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role maps settings from a playbook to the configuration file\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role playbook, you can define the parameters for the server SSH configuration file.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you do not specify these settings, the role produces the \u003Ccode class=\"literal\">sshd_config\u003C/code> file that matches the RHEL defaults.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn all cases, booleans correctly render as \u003Ccode class=\"literal\">yes\u003C/code> and \u003Ccode class=\"literal\">no\u003C/code> in the final configuration on your managed nodes. You can use lists to define multi-line configuration items. For example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">sshd_ListenAddress:\n  - 0.0.0.0\n  - '::'\u003C/pre>\u003Cp>\n\t\t\t\trenders as:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">ListenAddress 0.0.0.0\nListenAddress ::\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/sshd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.2. Configuring OpenSSH servers by using the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role to configure multiple OpenSSH servers. These ensure secure communication environment for remote users by providing namely:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tManagement of incoming SSH connections from remote clients\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCredentials verification\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSecure data transfer and command execution\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role alongside with other RHEL system roles that change SSHD configuration, for example the Identity Management RHEL system roles. To prevent the configuration from being overwritten, ensure the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role uses namespaces (RHEL 8 and earlier versions) or a drop-in directory (RHEL 9).\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: SSH server configuration\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure sshd to prevent root and password login except from particular subnet\n      ansible.builtin.include_role:\n        name: rhel-system-roles.sshd\n      vars:\n        sshd:\n          PermitRootLogin: no\n          PasswordAuthentication: no\n          Match:\n            - Condition: \"Address 192.0.2.0/24\"\n              PermitRootLogin: yes\n              PasswordAuthentication: yes\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">PasswordAuthentication: yes|no\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tControls whether the OpenSSH server (\u003Ccode class=\"literal\">sshd\u003C/code>) accepts authentication from clients that use the username and password combination.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">Match:\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe match block allows the \u003Ccode class=\"literal\">root\u003C/code> user login using password only from the subnet \u003Ccode class=\"literal\">192.0.2.0/24\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about the role variables and the OpenSSH configuration options used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file and the \u003Ccode class=\"literal\">sshd_config(5)\u003C/code> manual page on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the SSH server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh_server&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the contents of the \u003Ccode class=\"literal\">sshd_config\u003C/code> file on the SSH server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ssh/sshd_config.d/00-ansible_system_role.conf\u003C/strong>\u003C/span>\n#\n# Ansible managed\n#\nPasswordAuthentication no\nPermitRootLogin no\nMatch Address 192.0.2.0/24\n  PasswordAuthentication yes\n  PermitRootLogin yes\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that you can connect to the server as root from the \u003Ccode class=\"literal\">192.0.2.0/24\u003C/code> subnet:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDetermine your IP address:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>hostname -I\u003C/strong>\u003C/span>\n192.0.2.1\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the IP address is within the \u003Ccode class=\"literal\">192.0.2.1\u003C/code> - \u003Ccode class=\"literal\">192.0.2.254\u003C/code> range, you can connect to the server.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConnect to the server as \u003Ccode class=\"literal\">root\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh root@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh_server&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/sshd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.3. Using the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role for non-exclusive configuration\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, applying the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role overwrites the entire configuration. This may be problematic if you have previously adjusted the configuration, for example, with a different RHEL system role or a playbook. To apply the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role for only selected configuration options while keeping other options in place, you can use the non-exclusive configuration.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can apply a non-exclusive configuration:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn RHEL 8 and earlier by using a configuration snippet.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn RHEL 9 and later by using files in a drop-in directory. The default configuration file is already placed in the drop-in directory as \u003Ccode class=\"literal\">/etc/ssh/sshd_config.d/00-ansible_system_role.conf\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor managed nodes that run RHEL 8 or earlier:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Non-exclusive sshd configuration\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure SSHD to accept environment variables\n      ansible.builtin.include_role:\n        name: rhel-system-roles.sshd\n      vars:\n        sshd_config_namespace: \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-application&gt;\u003C/em>\u003C/span>\n        sshd:\n          # Environment variables to accept\n          AcceptEnv:\n            LANG\n            LS_COLORS\n            EDITOR\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor managed nodes that run RHEL 9 or later:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Non-exclusive sshd configuration\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure sshd to accept environment variables\n      ansible.builtin.include_role:\n        name: rhel-system-roles.sshd\n      vars:\n        sshd_config_file: /etc/ssh/sshd_config.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;42-my-application&gt;\u003C/em>\u003C/span>.conf\n        sshd:\n          # Environment variables to accept\n          AcceptEnv:\n            LANG\n            LS_COLORS\n            EDITOR\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe settings specified in the example playbooks include the following:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sshd_config_namespace: \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-application&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\t\tThe role places the configuration that you specify in the playbook to configuration snippets in the existing configuration file under the given namespace. You need to select a different namespace when running the role from different context.\n\t\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sshd_config_file: /etc/ssh/sshd_config.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;42-my-application&gt;\u003C/em>\u003C/span>.conf\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">sshd_config_file\u003C/code> variable, define the \u003Ccode class=\"literal\">.conf\u003C/code> file into which the \u003Ccode class=\"literal\">sshd\u003C/code> system role writes the configuration options. Use a two-digit prefix, for example \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>42-\u003C/em>\u003C/span>\u003C/code> to specify the order in which the configuration files will be applied.\n\t\t\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">AcceptEnv:\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tControls which environment variables the OpenSSH server (\u003Ccode class=\"literal\">sshd\u003C/code>) will accept from a client:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">LANG\u003C/code>: defines the language and locale settings.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">LS_COLORS\u003C/code>: defines the displaying color scheme for the \u003Ccode class=\"literal\">ls\u003C/code> command in the terminal.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">EDITOR\u003C/code>: specifies the default text editor for the command-line programs that need to open an editor.\n\t\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor details about the role variables and the OpenSSH configuration options used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file and the \u003Ccode class=\"literal\">sshd_config(5)\u003C/code> manual page on the control node.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the configuration on the SSH server:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor managed nodes that run RHEL 8 or earlier:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ssh/sshd_config\u003C/strong>\u003C/span>\n...\n# BEGIN sshd system role managed block: namespace \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-application&gt;\u003C/em>\u003C/span>\nMatch all\n  AcceptEnv LANG LS_COLORS EDITOR\n# END sshd system role managed block: namespace \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-application&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor managed nodes that run RHEL 9 or later:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ssh/sshd_config.d/42-my-application.conf\u003C/strong>\u003C/span>\n# Ansible managed\n#\nAcceptEnv LANG LS_COLORS EDITOR\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/sshd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sshd_config(5)\u003C/code> manual page\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_overriding-system-wide-crypto-policy-ssh-server-system-roles_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.4. Overriding the system-wide cryptographic policy on an SSH server by using the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWhen the default cryptographic settings do not meet certain security or compatibility needs, you may want to override the system-wide cryptographic policy on the OpenSSH server using the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role. Especially, in the following notable situations:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCompatibility with older clients: necessity to use weaker-than-default encryption algorithms, key exchange protocols, or ciphers.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnforcing stronger security policies: simultaneously, you can disable weaker algorithms. Such a measure could exceed the default system cryptographic policies, especially in the highly secure and regulated environments.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPerformance considerations: the system defaults could enforce stronger algorithms that can be computationally intensive for some systems.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCustomizing for specific security needs: adapting for unique requirements that are not covered by the default cryptographic policies.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIt is not possible to override all aspects of the cryptographic policies from the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role. For example, SHA1 signatures might be forbidden on a different layer so for a more generic solution, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index#setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">Setting a custom cryptographic policy by using RHEL system roles\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Deploy SSH configuration for OpenSSH server\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Overriding the system-wide cryptographic policy\n      ansible.builtin.include_role:\n        name: rhel-system-roles.sshd\n      vars:\n        sshd_sysconfig: true\n        sshd_sysconfig_override_crypto_policy: true\n        sshd_KexAlgorithms: ecdh-sha2-nistp521\n        sshd_Ciphers: aes256-ctr\n        sshd_MACs: hmac-sha2-512-etm@openssh.com\n        sshd_HostKeyAlgorithms: rsa-sha2-512,rsa-sha2-256\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sshd_KexAlgorithms\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tYou can choose key exchange algorithms, for example, \u003Ccode class=\"literal\">ecdh-sha2-nistp256\u003C/code>, \u003Ccode class=\"literal\">ecdh-sha2-nistp384\u003C/code>, \u003Ccode class=\"literal\">ecdh-sha2-nistp521\u003C/code>,\u003Ccode class=\"literal\">diffie-hellman-group14-sha1\u003C/code>, or \u003Ccode class=\"literal\">diffie-hellman-group-exchange-sha256\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sshd_Ciphers\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tYou can choose ciphers, for example, \u003Ccode class=\"literal\">aes128-ctr\u003C/code>, \u003Ccode class=\"literal\">aes192-ctr\u003C/code>, or \u003Ccode class=\"literal\">aes256-ctr\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sshd_MACs\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tYou can choose MACs, for example, \u003Ccode class=\"literal\">hmac-sha2-256\u003C/code>, \u003Ccode class=\"literal\">hmac-sha2-512\u003C/code>, or \u003Ccode class=\"literal\">hmac-sha1\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sshd_HostKeyAlgorithms\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tYou can choose a public key algorithm, for example, \u003Ccode class=\"literal\">ecdsa-sha2-nistp256\u003C/code>, \u003Ccode class=\"literal\">ecdsa-sha2-nistp384\u003C/code>, \u003Ccode class=\"literal\">ecdsa-sha2-nistp521\u003C/code>, or \u003Ccode class=\"literal\">ssh-rsa\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalexample\">\u003Cp>\n\t\t\t\t\t\tOn RHEL 9 managed nodes, the system role writes the configuration into the \u003Ccode class=\"literal\">/etc/ssh/sshd_config.d/00-ansible_system_role.conf\u003C/code> file, where cryptographic options are applied automatically. You can change the file by using the \u003Ccode class=\"literal\">sshd_config_file\u003C/code> variable. However, to ensure the configuration is effective, use a file name that lexicographically precedes the \u003Ccode class=\"literal\">/etc/ssh/sshd_config.d/50-redhat.conf\u003C/code> file, which includes the configured crypto policies.\n\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\tOn RHEL 8 managed nodes, you must enable override by setting the \u003Ccode class=\"literal\">sshd_sysconfig_override_crypto_policy\u003C/code> and \u003Ccode class=\"literal\">sshd_sysconfig\u003C/code> variables to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can verify the success of the procedure by using the verbose SSH connection and check the defined variables in the following output:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -vvv \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh_server&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n...\ndebug2: peer server KEXINIT proposal\ndebug2: KEX algorithms: ecdh-sha2-nistp521\ndebug2: host key algorithms: rsa-sha2-512,rsa-sha2-256\ndebug2: ciphers ctos: aes256-ctr\ndebug2: ciphers stoc: aes256-ctr\ndebug2: MACs ctos: hmac-sha2-512-etm@openssh.com\ndebug2: MACs stoc: hmac-sha2-512-etm@openssh.com\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/sshd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_ssh-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.5. How the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role maps settings from a playbook to the configuration file\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role playbook, you can define the parameters for the client SSH configuration file.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you do not specify these settings, the role produces a global \u003Ccode class=\"literal\">ssh_config\u003C/code> file that matches the RHEL defaults.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn all the cases, booleans correctly render as \u003Ccode class=\"literal\">yes\u003C/code> or \u003Ccode class=\"literal\">no\u003C/code> in the final configuration on your managed nodes. You can use lists to define multi-line configuration items. For example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">LocalForward:\n  - 22 localhost:2222\n  - 403 localhost:4003\u003C/pre>\u003Cp>\n\t\t\t\trenders as:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">LocalForward 22 localhost:2222\nLocalForward 403 localhost:4003\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe configuration options are case sensitive.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ssh/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.6. Configuring OpenSSH clients by using the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role to configure multiple OpenSSH clients. These enable the local user to establish a secure connection with the remote OpenSSH server by ensuring namely:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSecure connection initiation\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCredentials provision\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNegotiation with the OpenSSH server on the encryption method used for the secure communication channel\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAbility to send files securely to and from the OpenSSH server\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role alongside with other system roles that change SSH configuration, for example the Identity Management RHEL system roles. To prevent the configuration from being overwritten, make sure that the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role uses a drop-in directory (default in RHEL 8 and later).\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: SSH client configuration\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure ssh clients\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ssh\n      vars:\n        ssh_user: root\n        ssh:\n          Compression: true\n          GSSAPIAuthentication: no\n          ControlMaster: auto\n          ControlPath: ~/.ssh/.cm%C\n          Host:\n            - Condition: example\n              Hostname: server.example.com\n              User: user1\n        ssh_ForwardX11: no\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ssh_user: root\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tConfigures the \u003Ccode class=\"literal\">root\u003C/code> user’s SSH client preferences on the managed nodes with certain configuration specifics.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">Compression: true\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tCompression is enabled.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ControlMaster: auto\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tControlMaster multiplexing is set to \u003Ccode class=\"literal\">auto\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">Host\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tCreates alias \u003Ccode class=\"literal\">example\u003C/code> for connecting to the \u003Ccode class=\"literal\">server.example.com\u003C/code> host as a user called \u003Ccode class=\"literal\">user1\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ssh_ForwardX11: no\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tX11 forwarding is disabled.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about the role variables and the OpenSSH configuration options used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md\u003C/code> file and the \u003Ccode class=\"literal\">ssh_config(5)\u003C/code> manual page on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the managed node has the correct configuration by displaying the SSH configuration file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat ~/root/.ssh/config\u003C/strong>\u003C/span>\n# Ansible managed\nCompression yes\nControlMaster auto\nControlPath ~/.ssh/.cm%C\nForwardX11 no\nGSSAPIAuthentication no\nHost example\n  Hostname example.com\n  User user1\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ssh/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh_config(5)\u003C/code> manual page\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 28. Managing local storage by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tTo manage LVM and local file systems (FS) by using Ansible, you can use the \u003Ccode class=\"literal\">storage\u003C/code> role, which is one of the RHEL system roles available in RHEL 9.\n\t\t\u003C/p>\u003Cp>\n\t\t\tUsing the \u003Ccode class=\"literal\">storage\u003C/code> role enables you to automate administration of file systems on disks and logical volumes on multiple machines and across all versions of RHEL starting with RHEL 7.7.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"an-example-ansible-playbook-to-create-an-xfs-file-system_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.1. Creating an XFS file system on a block device by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe example Ansible playbook applies the \u003Ccode class=\"literal\">storage\u003C/code> role to create an XFS file system on a block device using the default parameters.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">storage\u003C/code> role can create a file system only on an unpartitioned, whole disk or a logical volume (LV). It cannot create the file system on a partition.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.storage\n  vars:\n    storage_volumes:\n      - name: barefs\n        type: disk\n        disks:\n          - sdb\n        fs_type: xfs\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe volume name (\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>barefs\u003C/em>\u003C/span>\u003C/code> in the example) is currently arbitrary. The \u003Ccode class=\"literal\">storage\u003C/code> role identifies the volume by the disk device listed under the \u003Ccode class=\"literal\">disks:\u003C/code> attribute.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou can omit the \u003Ccode class=\"literal\">fs_type: xfs\u003C/code> line because XFS is the default file system in RHEL 9.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo create the file system on an LV, provide the LVM setup under the \u003Ccode class=\"literal\">disks:\u003C/code> attribute, including the enclosing volume group. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_logical_volumes/managing-lvm-logical-volumes_configuring-and-managing-logical-volumes#an-example-playbook-to-manage-logical-volumes_managing-lvm-logical-volumes-using-rhel-system-roles\">Managing logical volumes by using the storage RHEL system role\u003C/a>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDo not provide the path to the LV device.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.2. Persistently mounting a file system by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe example Ansible applies the \u003Ccode class=\"literal\">storage\u003C/code> role to immediately and persistently mount an XFS file system.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.storage\n  vars:\n    storage_volumes:\n      - name: barefs\n        type: disk\n        disks:\n          - sdb\n        fs_type: xfs\n        mount_point: /mnt/data\n        mount_user: somebody\n        mount_group: somegroup\n        mount_mode: 0755\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThis playbook adds the file system to the \u003Ccode class=\"literal\">/etc/fstab\u003C/code> file, and mounts the file system immediately.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf the file system on the \u003Ccode class=\"literal\">/dev/sdb\u003C/code> device or the mount point directory do not exist, the playbook creates them.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-or-resizing-logical-volume-using-storage-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.3. Creating or resizing a logical volume by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan id=\"an-example-playbook-to-manage-logical-volumes_managing-local-storage-using-rhel-system-roles\">\u003C!--Empty-->\u003C/span>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUse the \u003Ccode class=\"literal\">storage\u003C/code> role to perform the following tasks:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo create an LVM logical volume in a volume group consisting of many disks\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo resize an existing file system on LVM\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo express an LVM volume size in percentage of the pool’s total size\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIf the volume group does not exist, the role creates it. If a logical volume exists in the volume group, it is resized if the size does not match what is specified in the playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you are reducing a logical volume, to prevent data loss you must ensure that the file system on that logical volume is not using the space in the logical volume that is being reduced.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Create logical volume\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_pools:\n          - name: myvg\n            disks:\n              - sda\n              - sdb\n              - sdc\n            volumes:\n              - name: mylv\n                size: 2G\n                fs_type: ext4\n                mount_point: /mnt/data\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">size: \u003Cspan class=\"emphasis\">\u003Cem>&lt;size&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tYou must specify the size by using units (for example, GiB) or percentage (for example, 60%).\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that specified volume has been created or resized to the requested size:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'lvs myvg'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"an-example-ansible-playbook-to-enable-online-block-discard_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.4. Enabling online block discard by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can mount an XFS file system with the online block discard option to automatically discard unused blocks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Enable online block discard\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_volumes:\n          - name: barefs\n            type: disk\n            disks:\n              - sdb\n            fs_type: xfs\n            mount_point: /mnt/data\n            mount_options: discard\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that online block discard option is enabled:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'findmnt /mnt/data'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"an-example-playbook-to-create-mount-an-ext4-file-system_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.5. Creating and mounting an Ext4 file system by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe example Ansible playbook applies the \u003Ccode class=\"literal\">storage\u003C/code> role to create and mount an Ext4 file system.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.storage\n  vars:\n    storage_volumes:\n      - name: barefs\n        type: disk\n        disks:\n          - sdb\n        fs_type: ext4\n        fs_label: label-name\n        mount_point: /mnt/data\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe playbook creates the file system on the \u003Ccode class=\"literal\">/dev/sdb\u003C/code> disk.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe playbook persistently mounts the file system at the \u003Ccode class=\"literal\">/mnt/data\u003C/code> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe label of the file system is \u003Ccode class=\"literal\">label-name\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"an-example-ansible-playbook-to-create-mount-ext3-file-system_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.6. Creating and mounting an Ext3 file system by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe example Ansible playbook applies the \u003Ccode class=\"literal\">storage\u003C/code> role to create and mount an Ext3 file system.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- hosts: all\n  roles:\n    - rhel-system-roles.storage\n  vars:\n    storage_volumes:\n      - name: barefs\n        type: disk\n        disks:\n          - sdb\n        fs_type: ext3\n        fs_label: label-name\n        mount_point: /mnt/data\n        mount_user: somebody\n        mount_group: somegroup\n        mount_mode: 0755\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe playbook creates the file system on the \u003Ccode class=\"literal\">/dev/sdb\u003C/code> disk.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe playbook persistently mounts the file system at the \u003Ccode class=\"literal\">/mnt/data\u003C/code> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe label of the file system is \u003Ccode class=\"literal\">label-name\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"example-ansible-playbook-to-create-a-swap-partition-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.7. Creating a swap volume by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThis section provides an example Ansible playbook. This playbook applies the \u003Ccode class=\"literal\">storage\u003C/code> role to create a swap volume, if it does not exist, or to modify the swap volume, if it already exist, on a block device by using the default parameters.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Create a disk device with swap\n  hosts: managed-node-01.example.com\n  roles:\n    - rhel-system-roles.storage\n  vars:\n    storage_volumes:\n      - name: swap_fs\n        type: disk\n        disks:\n          - /dev/sdb\n        size: 15 GiB\n        fs_type: swap\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe volume name (\u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>swap_fs\u003C/em>\u003C/span>\u003C/code> in the example) is currently arbitrary. The \u003Ccode class=\"literal\">storage\u003C/code> role identifies the volume by the disk device listed under the \u003Ccode class=\"literal\">disks:\u003C/code> attribute.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-raid-volume-using-the-storage-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.8. Configuring a RAID volume by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">storage\u003C/code> system role, you can configure a RAID volume on RHEL by using Red Hat Ansible Automation Platform and Ansible-Core. Create an Ansible playbook with the parameters to configure a RAID volume to suit your requirements.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDevice names might change in certain circumstances, for example, when you add a new disk to a system. Therefore, to prevent data loss, use persistent naming attributes in the playbook. For more information about persistent naming attributes, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_storage_devices/persistent-naming-attributes_managing-storage-devices#persistent-naming-attributes_managing-storage-devices\">Persistent naming attributes\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Create a RAID on sdd, sde, sdf, and sdg\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_safe_mode: false\n        storage_volumes:\n          - name: data\n            type: raid\n            disks: [sdd, sde, sdf, sdg]\n            raid_level: raid0\n            raid_chunk_size: 32 KiB\n            mount_point: /mnt/data\n            state: present\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the array was correctly created:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'mdadm --detail /dev/md/data'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-lvm-pool-with-raid-using-storage-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.9. Configuring an LVM pool with RAID by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">storage\u003C/code> system role, you can configure an LVM pool with RAID on RHEL by using Red Hat Ansible Automation Platform. You can set up an Ansible playbook with the available parameters to configure an LVM pool with RAID.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure LVM pool with RAID\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_safe_mode: false\n        storage_pools:\n          - name: my_pool\n            type: lvm\n            disks: [sdh, sdi]\n            raid_level: raid1\n            volumes:\n              - name: my_volume\n                size: \"1 GiB\"\n                mount_point: \"/mnt/app/shared\"\n                fs_type: xfs\n                state: present\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that your pool is on RAID:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'lsblk'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/managing_storage_devices/index#managing-raid_managing-storage-devices\">Managing RAID\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-stripe-size-for-raid-lvm-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.10. Configuring a stripe size for RAID LVM volumes by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">storage\u003C/code> system role, you can configure a stripe size for RAID LVM volumes on RHEL by using Red Hat Ansible Automation Platform. You can set up an Ansible playbook with the available parameters to configure an LVM pool with RAID.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure stripe size for RAID LVM volumes\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_safe_mode: false\n        storage_pools:\n          - name: my_pool\n            type: lvm\n            disks: [sdh, sdi]\n            volumes:\n              - name: my_volume\n                size: \"1 GiB\"\n                mount_point: \"/mnt/app/shared\"\n                fs_type: xfs\n                raid_level: raid0\n                raid_stripe_size: \"256 KiB\"\n                state: present\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that stripe size is set to the required size:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'lvs -o+stripesize /dev/my_pool/my_volume'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux//9/html-single/managing_storage_devices/index#managing-raid_managing-storage-devices\">Managing RAID\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-an-lvm-vdo-volume-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.11. Configuring an LVM-VDO volume by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan id=\"example-ansible-playbook-to-compress-and-deduplicate-a-vdo-volume-on-lvm-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles\">\u003C!--Empty-->\u003C/span>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role to create a VDO volume on LVM (LVM-VDO) with enabled compression and deduplication.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tBecause of the \u003Ccode class=\"literal\">storage\u003C/code> system role use of LVM-VDO, only one volume can be created per pool.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Create LVM-VDO volume under volume group 'myvg'\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_pools:\n          - name: myvg\n            disks:\n              - /dev/sdb\n            volumes:\n              - name: mylv1\n                compression: true\n                deduplication: true\n                vdo_pool_size: 10 GiB\n                size: 30 GiB\n                mount_point: /mnt/app/shared\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">vdo_pool_size: \u003Cspan class=\"emphasis\">\u003Cem>&lt;size&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe actual size that the volume takes on the device. You can specify the size in human-readable format, such as 10 GiB. If you do not specify a unit, it defaults to bytes.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">size: \u003Cspan class=\"emphasis\">\u003Cem>&lt;size&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe virtual size of VDO volume.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the current status of compression and deduplication:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'lvs -o+vdo_compression,vdo_compression_state,vdo_deduplication,vdo_index_state'\u003C/strong>\u003C/span>\n  LV       VG      Attr       LSize   Pool   Origin Data%  Meta%  Move Log Cpy%Sync Convert VDOCompression VDOCompressionState VDODeduplication VDOIndexState\n  mylv1   myvg   vwi-a-v---   3.00t vpool0                                                         enabled              online          enabled        online\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-luks2-encrypted-volume-using-the-storage-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.12. Creating a LUKS2 encrypted volume by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">storage\u003C/code> role to create and configure a volume encrypted with LUKS by running an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">luks_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create and configure a volume encrypted with LUKS\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_volumes:\n          - name: barefs\n            type: disk\n            disks:\n              - sdb\n            fs_type: xfs\n            fs_label: \u003Cspan class=\"emphasis\">\u003Cem>&lt;label&gt;\u003C/em>\u003C/span>\n            mount_point: /mnt/data\n            encryption: true\n            encryption_password: \"{{ luks_password }}\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFind the \u003Ccode class=\"literal\">luksUUID\u003C/code> value of the LUKS encrypted volume:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'cryptsetup luksUUID /dev/sdb'\u003C/strong>\u003C/span>\n\n4e4e7970-1822-470e-b55a-e91efe5d0f5c\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the encryption status of the volume:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'cryptsetup status luks-4e4e7970-1822-470e-b55a-e91efe5d0f5c'\u003C/strong>\u003C/span>\n\n/dev/mapper/luks-4e4e7970-1822-470e-b55a-e91efe5d0f5c is active and is in use.\n  type:    LUKS2\n  cipher:  aes-xts-plain64\n  keysize: 512 bits\n  key location: keyring\n  device:  /dev/sdb\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the created LUKS encrypted volume:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'cryptsetup luksDump /dev/sdb'\u003C/strong>\u003C/span>\n\nLUKS header information\nVersion:        2\nEpoch:          3\nMetadata area:  16384 [bytes]\nKeyslots area:  16744448 [bytes]\nUUID:           4e4e7970-1822-470e-b55a-e91efe5d0f5c\nLabel:          (no label)\nSubsystem:      (no subsystem)\nFlags:          (no flags)\n\nData segments:\n  0: crypt\n        offset: 16777216 [bytes]\n        length: (whole device)\n        cipher: aes-xts-plain64\n        sector: 512 [bytes]\n...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_storage_devices/encrypting-block-devices-using-luks_managing-storage-devices\">Encrypting block devices by using LUKS\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-shared-lvm-devices-using-storage-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.13. Creating shared LVM devices using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role to create shared LVM devices if you want your multiple systems to access the same storage at the same time.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis can bring the following notable benefits:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tResource sharing\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFlexibility in managing storage resources\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSimplification of storage management tasks\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">lvmlockd\u003C/code> is configured on the managed node. For more information, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/configuring_and_managing_logical_volumes/configuring-lvm-on-shared-storage_configuring-and-managing-logical-volumes#configuring-lvm-on-san-multiple_configuring-lvm-on-shared-storage\">Configuring LVM to share SAN disks among multiple machines\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  become: true\n  tasks:\n    - name: Create shared LVM device\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_pools:\n          - name: \u003Cspan class=\"emphasis\">\u003Cem>vg1\u003C/em>\u003C/span>\n            disks: \u003Cspan class=\"emphasis\">\u003Cem>/dev/vdb\u003C/em>\u003C/span>\n            type: lvm\n            \u003Cspan class=\"strong strong\">\u003Cstrong>shared: true\u003C/strong>\u003C/span>\n            state: present\n            volumes:\n              - name: \u003Cspan class=\"emphasis\">\u003Cem>lv1\u003C/em>\u003C/span>\n                size: 4g\n                mount_point: \u003Cspan class=\"emphasis\">\u003Cem>/opt/test1\u003C/em>\u003C/span>\n        storage_safe_mode: false\n        storage_use_partitions: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"resizing-physical-volumes-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.14. Resizing physical volumes by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tWith the \u003Ccode class=\"literal\">storage\u003C/code> system role, you can resize LVM physical volumes after resizing the underlying storage or disks from outside of the host. For example, you increased the size of a virtual disk and want to use the extra space in an existing LVM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe size of the underlying block storage has been changed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Resize LVM PV size\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_pools:\n           - name: \u003Cspan class=\"emphasis\">\u003Cem>myvg\u003C/em>\u003C/span>\n             disks: \u003Cspan class=\"emphasis\">\u003Cem>[\"sdf\"]\u003C/em>\u003C/span>\n             type: lvm\n             \u003Cspan class=\"strong strong\">\u003Cstrong>grow_to_fill: true\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the new physical volume size:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'pvs'\u003C/strong>\u003C/span>\nPV         VG   Fmt Attr PSize PFree\n\u003Cspan class=\"emphasis\">\u003Cem>/dev/sdf1\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>myvg\u003C/em>\u003C/span> lvm2 a-- 1,99g 1,99g\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-an-encrypted-stratis-pool-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.15. Creating an encrypted Stratis pool by using the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo secure your data, you can create an encrypted Stratis pool with the \u003Ccode class=\"literal\">storage\u003C/code> RHEL system role. In addition to a passphrase, you can use Clevis and Tang or TPM protection as an encryption method.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can configure Stratis encryption only on the entire pool.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">luks_password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Manage local storage\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Create a new encrypted Stratis pool with Clevis and Tang\n      ansible.builtin.include_role:\n        name: rhel-system-roles.storage\n      vars:\n        storage_pools:\n           - name: mypool\n             disks:\n               - sdd\n               - sde\n             \u003Cspan class=\"strong strong\">\u003Cstrong>type: stratis\u003C/strong>\u003C/span>\n             \u003Cspan class=\"strong strong\">\u003Cstrong>encryption: true\u003C/strong>\u003C/span>\n             encryption_password: \"{{ luks_password }}\"\n             encryption_clevis_pin: tang\n             encryption_tang_url: tang-server.example.com:7500\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">encryption_password\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tPassword or passphrase used to unlock the LUKS volumes.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">encryption_clevis_pin\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tClevis method that you can use to encrypt the created pool. You can use \u003Ccode class=\"literal\">tang\u003C/code> and \u003Ccode class=\"literal\">tpm2\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">encryption_tang_url\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tURL of the Tang server.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the pool was created with Clevis and Tang configured:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'sudo stratis report'\u003C/strong>\u003C/span>\n...\n                        \"clevis_config\": {\n                            \"thp\": \"j-G4ddvdbVfxpnUbgxlpbe3KutSKmcHttILAtAkMTNA\",\n                            \"url\": \"tang-server.example.com:7500\"\n                        },\n                        \"clevis_pin\": \"tang\",\n                        \"in_use\": true,\n                        \"key_description\": \"blivet-mypool\",\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.storage/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/storage/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#ansible-vault_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 3. Ansible vault\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 29. Managing \u003Ccode class=\"literal\">systemd\u003C/code> units by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tBy using the \u003Ccode class=\"literal\">systemd\u003C/code> RHEL system role, you can automate certain systemd-related tasks and perform them remotely. You can use the role for the following actions:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tManage services\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tDeploy units\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tDeploy drop-in files\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"managing-services-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.1. Managing services by using the systemd RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can automate and remotely manage systemd units, such as starting or enabling services, by using the \u003Ccode class=\"literal\">systemd\u003C/code> RHEL system role.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content. Use only the variables depending on what actions you want to perform.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Managing systemd services\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Perform action on systemd units\n      ansible.builtin.include_role:\n        name: rhel-system-roles.systemd\n      vars:\n        systemd_started_units:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;systemd_unit_1&gt;\u003C/em>\u003C/span>.service\n        systemd_stopped_units:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;systemd_unit_2&gt;\u003C/em>\u003C/span>.service\n        systemd_restarted_units:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;systemd_unit_3&gt;\u003C/em>\u003C/span>.service\n        systemd_reloaded_units:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;systemd_unit_4&gt;\u003C/em>\u003C/span>.service\n        systemd_enabled_units:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;systemd_unit_5&gt;\u003C/em>\u003C/span>.service\n        systemd_disabled_units:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;systemd_unit_6&gt;\u003C/em>\u003C/span>.service\n        systemd_masked_units:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;systemd_unit_7&gt;\u003C/em>\u003C/span>.service\n        systemd_unmasked_units:\n          - \u003Cspan class=\"emphasis\">\u003Cem>&lt;systemd_unit_8&gt;\u003C/em>\u003C/span>.service\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/systemd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-systemd-drop-in-files-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.2. Deploying systemd drop-in files by using the systemd RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tSystemd applies drop-in files on top of setting it reads for a unit from other locations. Therefore, you can modify unit settings with drop-in files without changing the original unit file. By using the \u003Ccode class=\"literal\">systemd\u003C/code> RHEL system role, you can automate the process of deploying drop-in files.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe role uses the hard-coded file name \u003Ccode class=\"literal\">99-override.conf\u003C/code> to store drop-in files in \u003Ccode class=\"literal\">/etc/systemd/system/\u003Cspan class=\"emphasis\">\u003Cem>&lt;name&gt;\u003C/em>\u003C/span>._&lt;unit_type&gt;/\u003C/code>. Note that it overrides existing files with this name in the destination directory.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a Jinja2 template with the systemd drop-in file contents. For example, create the \u003Ccode class=\"literal\">~/sshd.service.conf.j2\u003C/code> file with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-bash\">{{ ansible_managed | comment }}\n[Unit]\nAfter=\nAfter=network.target sshd-keygen.target network-online.target\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis drop-in file specifies the same units in the \u003Ccode class=\"literal\">After\u003C/code> setting as the original \u003Ccode class=\"literal\">/usr/lib/systemd/system/sshd.service\u003C/code> file and, additionally, \u003Ccode class=\"literal\">network-online.target\u003C/code>. With this extra target, \u003Ccode class=\"literal\">sshd\u003C/code> starts after the network interfaces are actived and have IP addresses assigned. This ensures that \u003Ccode class=\"literal\">sshd\u003C/code> can bind to all IP addresses.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;name&gt;\u003C/em>\u003C/span>.\u003Cspan class=\"emphasis\">\u003Cem>&lt;unit_type&gt;\u003C/em>\u003C/span>.conf.j2\u003C/code> convention for the file name. For example, to add a drop-in for the \u003Ccode class=\"literal\">sshd.service\u003C/code> unit, you must name the file \u003Ccode class=\"literal\">sshd.service.conf.j2\u003C/code>. Place the file in the same directory as the playbook.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Managing systemd services\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploy an sshd.service systemd drop-in file\n      ansible.builtin.include_role:\n        name: rhel-system-roles.systemd\n      vars:\n         systemd_dropins:\n           - sshd.service.conf.j2\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">systemd_dropins: \u003Cspan class=\"emphasis\">\u003Cem>&lt;list_of_files&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSpecifies the names of the drop-in files to deploy in YAML list format.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the role placed the drop-in file in the correct location:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ls /etc/systemd/system/sshd.service.d/'\u003C/strong>\u003C/span>\n99-override.conf\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/systemd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-systemd-units-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.3. Deploying systemd units by using the systemd RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can create unit files for custom applications, and systemd reads them from the \u003Ccode class=\"literal\">/etc/systemd/system/\u003C/code> directory. By using the \u003Ccode class=\"literal\">systemd\u003C/code> RHEL system role, you can automate the deployment of custom unit files.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a Jinja2 template with the custom systemd unit file contents. For example, create the \u003Ccode class=\"literal\">~/example.service.j2\u003C/code> file with the contents for your service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-bash\">{{ ansible_managed | comment }}\n[Unit]\nDescription=Example systemd service unit file\n\n[Service]\nExecStart=/bin/true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;name&gt;\u003C/em>\u003C/span>.\u003Cspan class=\"emphasis\">\u003Cem>&lt;unit_type&gt;\u003C/em>\u003C/span>.j2\u003C/code> convention for the file name. For example, to create the \u003Ccode class=\"literal\">example.service\u003C/code> unit, you must name the file \u003Ccode class=\"literal\">example.service.j2\u003C/code>. Place the file in the same directory as the playbook.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Managing systemd services\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Deploy, enable, and start a custom systemd service\n      ansible.builtin.include_role:\n        name: rhel-system-roles.systemd\n      vars:\n         systemd_unit_file_templates:\n           - example.service.j2\n         systemd_enabled_units:\n           - example.service\n         systemd_started_units:\n           - example.service\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the service is enabled and started:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'systemctl status example.service'\u003C/strong>\u003C/span>\n...\n● example.service - A service for demonstrating purposes\n   Loaded: loaded (/etc/systemd/system/example.service; \u003Cspan class=\"strong strong\">\u003Cstrong>enabled\u003C/strong>\u003C/span>; vendor preset: disabled)\n   Active: \u003Cspan class=\"strong strong\">\u003Cstrong>active\u003C/strong>\u003C/span> (running) since Thu 2024-07-04 15:59:18 CEST; 10min ago\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.systemd/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/systemd/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 30. Configuring time synchronization by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tThe Network Time Protocol (NTP) and Precision Time Protocol (PTP) are standards to synchronize the clock of computers over a network. An accurate time synchronization in networks is important because certain services rely on it. For example, Kerberos tolerates only a small time difference between the server and client to prevent replay attacks.\n\t\t\u003C/p>\u003Cp>\n\t\t\tYou can set the time service to configure in the \u003Ccode class=\"literal\">timesync_ntp_provider\u003C/code> variable of a playbook. If you do not set this variable, the role determines the time service based on the following factors:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tOn RHEL 8 and later: \u003Ccode class=\"literal\">chronyd\u003C/code>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tOn RHEL 6 and 7: \u003Ccode class=\"literal\">chronyd\u003C/code> (default) or, if already installed \u003Ccode class=\"literal\">ntpd\u003C/code>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"configuring-time-synchronization-over-ntp-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.1. Configuring time synchronization over NTP by using the timesync RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Network Time Protocol (NTP) synchronizes the time of a host with an NTP server over a network. In IT networks, services rely on a correct system time, for example, for security and logging purposes. By using the \u003Ccode class=\"literal\">timesync\u003C/code> RHEL system role, you can automate the configuration of Red Hat Enterprise Linux NTP clients in your network and keep the time synchronized.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">timesync\u003C/code> RHEL system role replaces the configuration of the specified given or detected provider service on the managed host. Consequently, all settings are lost if they are not specified in the playbook.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Managing time synchronization\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configuring NTP with an internal server (preferred) and a public server pool as fallback\n      ansible.builtin.include_role:\n        name: rhel-system-roles.timesync\n      vars:\n        timesync_ntp_servers:\n        - hostname: time.example.com\n          trusted: yes\n          prefer: yes\n          iburst: yes\n        - hostname: 0.rhel.pool.ntp.org\n          pool: yes\n          iburst: yes\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">pool: \u003Cspan class=\"emphasis\">\u003Cem>&lt;yes|no&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tFlags a source as an NTP pool rather than an individual host. In this case, the service expects that the name resolves to multiple IP addresses which can change over time.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">iburst: \u003Cspan class=\"emphasis\">\u003Cem>yes\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables fast initial synchronization.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.timesync/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the details about the time sources:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the managed node runs the \u003Ccode class=\"literal\">chronyd\u003C/code> service, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'chronyc sources'\u003C/strong>\u003C/span>\nMS Name/IP address         Stratum Poll Reach LastRx Last sample\n===============================================================================\n^* time.example.com              1  10   377   210   +159us[  +55us] +/-   12ms\n^? ntp.example.org               2   9   377   409  +1120us[+1021us] +/-   42ms\n^? time.us.example.net           2   9   377   992   -329us[ -386us] +/-   15ms\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the managed node runs the \u003Ccode class=\"literal\">ntpd\u003C/code> service, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ntpq -p'\u003C/strong>\u003C/span>\n     remote           refid      st t when poll reach   delay   offset  jitter\n==============================================================================\n*time.example.com .PTB.           1 u    2   64   77   23.585  967.902   0.684\n- ntp.example.or 192.0.2.17       2 u    -   64   77   27.090  966.755   0.468\n+time.us.example 198.51.100.19    2 u   65   64   37   18.497  968.463   1.588\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.time_sync/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/time_sync/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/63376\">Are the rhel.pool.ntp.org NTP servers supported by Red Hat?\u003C/a> (Red Hat Knowledgebase)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-time-synchronization-over-ntp-with-nts-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.2. Configuring time synchronization over NTP with NTS by using the timesync RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe Network Time Protocol (NTP) synchronizes the time of a host with an NTP server over a network. By using the Network Time Security (NTS) mechanism, clients establish a TLS-encrypted connection to the server and authenticate NTP packets. In IT networks, services rely on a correct system time, for example, for security and logging purposes. By using the \u003Ccode class=\"literal\">timesync\u003C/code> RHEL system role, you can automate the configuration of Red Hat Enterprise Linux NTP clients in your network and keep the time synchronized over NTS.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNote that you cannot mix NTS servers with non-NTS servers. In mixed configurations, NTS servers are trusted and clients do not fall back to unauthenticated NTP sources because they can be exploited in man-in-the-middle (MITM) attacks. For further details, see the \u003Ccode class=\"literal\">authselectmode\u003C/code> parameter description in the \u003Ccode class=\"literal\">chrony.conf(5)\u003C/code> man page on your system.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">timesync\u003C/code> RHEL system role replaces the configuration of the specified given or detected provider service on the managed host. Consequently, all settings are lost if they are not specified in the playbook.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed nodes use \u003Ccode class=\"literal\">chronyd\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Managing time synchronization\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configuring NTP with NTS-enabled servers\n      ansible.builtin.include_role:\n        name: rhel-system-roles.timesync\n      vars:\n        timesync_ntp_servers:\n        - hostname: ptbtime1.ptb.de\n          nts: yes\n          iburst: yes\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">iburst: \u003Cspan class=\"emphasis\">\u003Cem>yes\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tEnables fast initial synchronization.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.timesync/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the managed node runs the \u003Ccode class=\"literal\">chronyd\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay the details about the time sources:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'chronyc sources'\u003C/strong>\u003C/span>\nMS Name/IP address         Stratum Poll Reach LastRx Last sample\n===============================================================================\n^* ptbtime1.ptb.de               1   6    17    55    -13us[  -54us] +/-   12ms\n^- ptbtime2.ptb.de               1   6    17    56   -257us[ -297us] +/-   12ms\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor sources with NTS enabled, display information that is specific to authentication of NTP sources:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'chronyc -N authdata'\u003C/strong>\u003C/span>\nName/IP address             Mode KeyID Type KLen Last Atmp  NAK Cook CLen\n=========================================================================\nptbtime1.ptb.de              NTS     1   15  256  229    0    0    8  100\nptbtime2.ptb.de              NTS     1   15  256  230    0    0    8  100\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tVerify that the reported cookies in the \u003Ccode class=\"literal\">Cook\u003C/code> column is larger than 0.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the managed node runs the \u003Ccode class=\"literal\">ntpd\u003C/code> service, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'ntpq -p'\u003C/strong>\u003C/span>\n     remote           refid      st t when poll reach   delay   offset  jitter\n==============================================================================\n*ptbtime1.ptb.de .PTB.            1 8    2   64   77   23.585  967.902   0.684\n-ptbtime2.ptb.de .PTB.            1 8   30   64   78   24.653  993.937   0.765\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.time_sync/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/time_sync/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/63376\">Are the rhel.pool.ntp.org NTP servers supported by Red Hat?\u003C/a> (Red Hat Knowledgebase)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 31. Configuring a system for session recording by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tUse the \u003Ccode class=\"literal\">tlog\u003C/code> RHEL system role to record and monitor terminal session activities on your managed nodes in an automatic fashion. You can configure the recording to take place per user or user group by means of the \u003Ccode class=\"literal\">SSSD\u003C/code> service.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe session recording solution in the tlog RHEL system role consists of the following components:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe \u003Ccode class=\"literal\">tlog\u003C/code> utility\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tSystem Security Services Daemon (SSSD)\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tOptional: The web console interface\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.1. Configuring session recording for individual users by using the \u003Ccode class=\"literal\">tlog\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPrepare and apply an Ansible playbook to configure a RHEL system to log session recording data to the \u003Ccode class=\"literal\">systemd\u003C/code> journal.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWith that, you can enable recording the terminal output and input of a specific user during their sessions, when the user logs in on the console, or by SSH.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe playbook installs \u003Ccode class=\"literal\">tlog-rec-session\u003C/code>, a terminal session I/O logging program, that acts as the login shell for a user. The role creates an SSSD configuration drop file, and this file defines for which users and groups the login shell should be used. Additionally, if the \u003Ccode class=\"literal\">cockpit\u003C/code> package is installed on the system, the playbook also installs the \u003Ccode class=\"literal\">cockpit-session-recording\u003C/code> package, which is a \u003Ccode class=\"literal\">Cockpit\u003C/code> module that allows you to view and play recordings in the web console interface.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Deploy session recording\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Enable session recording for specific users\n      ansible.builtin.include_role:\n        name: rhel-system-roles.tlog\n  vars:\n    tlog_scope_sssd: some\n    tlog_users_sssd:\n      - &lt;recorded_user&gt;\u003C/pre>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tlog_scope_sssd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">some\u003C/code> value specifies you want to record only certain users and groups, not \u003Ccode class=\"literal\">all\u003C/code> or \u003Ccode class=\"literal\">none\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tlog_users_sssd:: \u003Cspan class=\"emphasis\">\u003Cem>&lt;list_of_users&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA YAML list of users you want to record a session from. Note that the role does not add users if they do not exist.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the SSSD drop-in file’s content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cd /etc/sssd/conf.d/sssd-session-recording.conf\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can see that the file contains the parameters you set in the playbook.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in as a user whose session will be recorded, perform some actions, and log out.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAs the \u003Ccode class=\"literal\">root\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay the list of recorded sessions:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl _COMM=tlog-rec-sessio\u003C/strong>\u003C/span>\nNov 12 09:17:30 managed-node-01.example.com -tlog-rec-session[1546]: {\"ver\":\"2.3\",\"host\":\"managed-node-01.example.com\",\"rec\":\"07418f2b0f334c1696c10cbe6f6f31a6-60a-e4a2\",\"user\":\"demo-user\",...\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tYou require the value of the \u003Ccode class=\"literal\">rec\u003C/code> (recording ID) field in the next step.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tNote that the value of the \u003Ccode class=\"literal\">_COMM\u003C/code> field is shortened due to t a 15 character limit.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tPlay back a session:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tlog-play -r journal -M TLOG_REC=\u003Cspan class=\"emphasis\">\u003Cem>&lt;recording_id&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.tlog/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/tlog/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-the-tlog-rhel-system-role-for-excluding-lists-of-groups-or-users_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.2. Excluding certain users and groups from session recording by using the the \u003Ccode class=\"literal\">tlog\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">tlog_exclude_users_sssd\u003C/code> and \u003Ccode class=\"literal\">tlog_exclude_groups_sssd\u003C/code> role variables from the \u003Ccode class=\"literal\">tlog\u003C/code> RHEL system role to exclude users or groups from having their sessions recorded and logged in the \u003Ccode class=\"literal\">systemd\u003C/code> journal.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe playbook installs \u003Ccode class=\"literal\">tlog-rec-session\u003C/code>, a terminal session I/O logging program, that acts as the login shell for a user. The role creates an SSSD configuration drop file, and this file defines for which users and groups the login shell should be used. Additionally, if the \u003Ccode class=\"literal\">cockpit\u003C/code> package is installed on the system, the playbook also installs the \u003Ccode class=\"literal\">cockpit-session-recording\u003C/code> package, which is a \u003Ccode class=\"literal\">Cockpit\u003C/code> module that allows you to view and play recordings in the web console interface.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Deploy session recording excluding users and groups\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Exclude users and groups\n      ansible.builtin.include_role:\n        name: rhel-system-roles.tlog\n      vars:\n        tlog_scope_sssd: all\n        tlog_exclude_users_sssd:\n          - jeff\n          - james\n        tlog_exclude_groups_sssd:\n          - admins\u003C/pre>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tlog_scope_sssd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tThe value \u003Ccode class=\"literal\">all\u003C/code> specifies that you want to record all users and groups.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tlog_exclude_users_sssd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;user_list&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA YAML list of users user names you want to exclude from the session recording.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">tlog_exclude_groups_sssd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;group_list&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tA YAML list of groups you want to exclude from the session recording.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck the SSSD drop-in file’s content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/sssd/conf.d/sssd-session-recording.conf\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can see that the file contains the parameters you set in the playbook.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in as a user whose session will be recorded, perform some actions, and log out.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAs the \u003Ccode class=\"literal\">root\u003C/code> user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay the list of recorded sessions:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl _COMM=tlog-rec-sessio\u003C/strong>\u003C/span>\nNov 12 09:17:30 managed-node-01.example.com -tlog-rec-session[1546]: {\"ver\":\"2.3\",\"host\":\"managed-node-01.example.com\",\"rec\":\"07418f2b0f334c1696c10cbe6f6f31a6-60a-e4a2\",\"user\":\"demo-user\",...\n...\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tYou require the value of the \u003Ccode class=\"literal\">rec\u003C/code> (recording ID) field in the next step.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tNote that the value of the \u003Ccode class=\"literal\">_COMM\u003C/code> field is shortened due to t a 15 character limit.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tPlay back a session:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tlog-play -r journal -M TLOG_REC=\u003Cspan class=\"emphasis\">\u003Cem>&lt;recording_id&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.tlog/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/tlog/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 32. Configuring VPN connections with IPsec by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWith the \u003Ccode class=\"literal\">vpn\u003C/code> system role, you can configure VPN connections on RHEL systems by using Red Hat Ansible Automation Platform. You can use it to set up host-to-host, network-to-network, VPN Remote Access Server, and mesh configurations.\n\t\t\u003C/p>\u003Cp>\n\t\t\tFor host-to-host connections, the role sets up a VPN tunnel between each pair of hosts in the list of \u003Ccode class=\"literal\">vpn_connections\u003C/code> using the default parameters, including generating keys as needed. Alternatively, you can configure it to create an opportunistic mesh configuration between all hosts listed. The role assumes that the names of the hosts under \u003Ccode class=\"literal\">hosts\u003C/code> are the same as the names of the hosts used in the Ansible inventory, and that you can use those names to configure the tunnels.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">vpn\u003C/code> RHEL system role currently supports only Libreswan, which is an IPsec implementation, as the VPN provider.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">32.1. Creating a host-to-host VPN with IPsec by using the \u003Ccode class=\"literal\">vpn\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">vpn\u003C/code> system role to configure host-to-host connections by running an Ansible playbook on the control node, which configures all managed nodes listed in an inventory file.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Host to host VPN\n  hosts: managed-node-01.example.com, managed-node-02.example.com\n  roles:\n    - rhel-system-roles.vpn\n  vars:\n    vpn_connections:\n      - hosts:\n          managed-node-01.example.com:\n          managed-node-02.example.com:\n    vpn_manage_firewall: true\n    vpn_manage_selinux: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis playbook configures the connection \u003Ccode class=\"literal\">managed-node-01.example.com-to-managed-node-02.example.com\u003C/code> by using pre-shared key authentication with keys auto-generated by the system role. Because \u003Ccode class=\"literal\">vpn_manage_firewall\u003C/code> and \u003Ccode class=\"literal\">vpn_manage_selinux\u003C/code> are both set to \u003Ccode class=\"literal\">true\u003C/code>, the \u003Ccode class=\"literal\">vpn\u003C/code> role uses the \u003Ccode class=\"literal\">firewall\u003C/code> and \u003Ccode class=\"literal\">selinux\u003C/code> roles to manage the ports used by the \u003Ccode class=\"literal\">vpn\u003C/code> role.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo configure connections from managed hosts to external hosts that are not listed in the inventory file, add the following section to the \u003Ccode class=\"literal\">vpn_connections\u003C/code> list of hosts:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">    vpn_connections:\n      - hosts:\n          managed-node-01.example.com:\n          \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;external_node&gt;\u003C/em>\u003C/span>:\u003C/strong>\u003C/span>\n            \u003Cspan class=\"strong strong\">\u003Cstrong>hostname: \u003Cspan class=\"emphasis\">\u003Cem>&lt;IP_address_or_hostname&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis configures one additional connection: \u003Ccode class=\"literal\">managed-node-01.example.com-to-\u003Cspan class=\"emphasis\">\u003Cem>&lt;external_node&gt;\u003C/em>\u003C/span>\u003C/code>\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe connections are configured only on the managed nodes and not on the external node.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: You can specify multiple VPN connections for the managed nodes by using additional sections within \u003Ccode class=\"literal\">vpn_connections\u003C/code>, for example, a control plane and a data plane:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Multiple VPN\n  hosts: managed-node-01.example.com, managed-node-02.example.com\n  roles:\n    - rhel-system-roles.vpn\n  vars:\n    vpn_connections:\n      - name: control_plane_vpn\n        hosts:\n          managed-node-01.example.com:\n            hostname: 192.0.2.0 # IP for the control plane\n          managed-node-02.example.com:\n            hostname: 192.0.2.1\n      - name: data_plane_vpn\n        hosts:\n          managed-node-01.example.com:\n            hostname: 10.0.0.1 # IP for the data plane\n          managed-node-02.example.com:\n            hostname: 10.0.0.2\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed nodes, confirm that the connection is successfully loaded:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec status | grep \u003Cspan class=\"emphasis\">\u003Cem>&lt;connection_name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;connection_name&gt;\u003C/em>\u003C/span>\u003C/code> with the name of the connection from this node, for example \u003Ccode class=\"literal\">managed_node1-to-managed_node2\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tBy default, the role generates a descriptive name for each connection it creates from the perspective of each system. For example, when creating a connection between \u003Ccode class=\"literal\">managed_node1\u003C/code> and \u003Ccode class=\"literal\">managed_node2\u003C/code>, the descriptive name of this connection on \u003Ccode class=\"literal\">managed_node1\u003C/code> is \u003Ccode class=\"literal\">managed_node1-to-managed_node2\u003C/code> but on \u003Ccode class=\"literal\">managed_node2\u003C/code> the connection is named \u003Ccode class=\"literal\">managed_node2-to-managed_node1\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed nodes, confirm that the connection is successfully started:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec trafficstatus | grep \u003Cspan class=\"emphasis\">\u003Cem>&lt;connection_name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If a connection does not successfully load, manually add the connection by entering the following command. This provides more specific information indicating why the connection failed to establish:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --add \u003Cspan class=\"emphasis\">\u003Cem>&lt;connection_name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tAny errors that may occur during the process of loading and starting the connection are reported in the \u003Ccode class=\"literal\">/var/log/pluto.log\u003C/code> file. Because these logs are hard to parse, manually add the connection to obtain log messages from the standard output instead.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.vpn/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/vpn/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">32.2. Creating an opportunistic mesh VPN connection with IPsec by using the \u003Ccode class=\"literal\">vpn\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">vpn\u003C/code> system role to configure an opportunistic mesh VPN connection that uses certificates for authentication by running an Ansible playbook on the control node, which will configure all the managed nodes listed in an inventory file.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\" title=\"Chapter 2. Preparing a control node and managed nodes to use RHEL system roles\">You have prepared the control node and the managed nodes\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IPsec Network Security Services (NSS) crypto library in the \u003Ccode class=\"literal\">/etc/ipsec.d/\u003C/code> directory contains the necessary certificates.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: \u003Cspan class=\"emphasis\">\u003Cem>Mesh VPN\u003C/em>\u003C/span>\n  hosts: managed-node-01.example.com, managed-node-02.example.com, managed-node-03.example.com\n  roles:\n    - rhel-system-roles.vpn\n  vars:\n    vpn_connections:\n      - opportunistic: true\n        auth_method: cert\n        policies:\n          - policy: private\n            cidr: default\n          - policy: private-or-clear\n            cidr: 198.51.100.0/24\n          - policy: private\n            cidr: 192.0.2.0/24\n          - policy: clear\n            cidr: 192.0.2.7/32\n    vpn_manage_firewall: true\n    vpn_manage_selinux: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAuthentication with certificates is configured by defining the \u003Ccode class=\"literal\">auth_method: cert\u003C/code> parameter in the playbook. By default, the node name is used as the certificate nickname. In this example, this is \u003Ccode class=\"literal\">managed-node-01.example.com\u003C/code>. You can define different certificate names by using the \u003Ccode class=\"literal\">cert_name\u003C/code> attribute in your inventory.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this example procedure, the control node, which is the system from which you will run the Ansible playbook, shares the same classless inter-domain routing (CIDR) number as both of the managed nodes (192.0.2.0/24) and has the IP address 192.0.2.7. Therefore, the control node falls under the private policy which is automatically created for CIDR 192.0.2.0/24.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo prevent SSH connection loss during the play, a clear policy for the control node is included in the list of policies. Note that there is also an item in the policies list where the CIDR is equal to default. This is because this playbook overrides the rule from the default policy to make it private instead of private-or-clear.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause \u003Ccode class=\"literal\">vpn_manage_firewall\u003C/code> and \u003Ccode class=\"literal\">vpn_manage_selinux\u003C/code> are both set to \u003Ccode class=\"literal\">true\u003C/code>, the \u003Ccode class=\"literal\">vpn\u003C/code> role uses the \u003Ccode class=\"literal\">firewall\u003C/code> and \u003Ccode class=\"literal\">selinux\u003C/code> roles to manage the ports used by the \u003Ccode class=\"literal\">vpn\u003C/code> role.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.vpn/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/vpn/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"legalnotice\" id=\"idm140064638241184\">\u003Ch2 class=\"legalnotice\">Legal Notice\u003C/h2>\u003Cdiv class=\"para\">\n\t\tCopyright \u003Cspan class=\"trademark\">\u003C!--Empty-->\u003C/span>© 2024 Red Hat, Inc.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license (\"CC-BY-SA\"). An explanation of CC-BY-SA is available at \u003Ca class=\"uri\" href=\"http://creativecommons.org/licenses/by-sa/3.0/\">http://creativecommons.org/licenses/by-sa/3.0/\u003C/a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Linux\u003C/span>® is the registered trademark of Linus Torvalds in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Java\u003C/span>® is a registered trademark of Oracle and/or its affiliates.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">XFS\u003C/span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">MySQL\u003C/span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Node.js\u003C/span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe \u003Cspan class=\"trademark\">OpenStack\u003C/span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tAll other trademarks are the property of their respective owners.\n\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003C/body>",[14,21,26,31,45,50,68,94,104,118,128,138,156,243,253,262,271,292,332,354,376,394,468,486,496,510,560,578,588,618,684,702,716,730,744],{"title":11,"visible":15,"weight":16,"urlFragment":17,"anchor":18,"singlePageAnchor":18,"docTitle":19,"url":20},true,1,"index",null,"automating_system_administration_by_using_rhel_system_roles","#",{"title":22,"visible":15,"weight":23,"urlFragment":24,"anchor":18,"singlePageAnchor":24,"docTitle":19,"url":25},"Providing feedback on Red Hat documentation",2,"proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles","#proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles",{"title":27,"visible":15,"weight":28,"urlFragment":29,"anchor":18,"singlePageAnchor":29,"docTitle":19,"url":30},"1. Introduction to RHEL system roles",3,"intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles","#intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":32,"visible":15,"weight":33,"urlFragment":34,"anchor":18,"singlePageAnchor":34,"sections":35,"docTitle":19,"url":44},"2. Preparing a control node and managed nodes to use RHEL system roles",4,"assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[36,40],{"title":37,"visible":15,"weight":16,"urlFragment":34,"anchor":38,"singlePageAnchor":38,"docTitle":19,"url":39},"2.1. Preparing a control node on RHEL 9","proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles","#proc_preparing-a-control-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles",{"title":41,"visible":15,"weight":23,"urlFragment":34,"anchor":42,"singlePageAnchor":42,"docTitle":19,"url":43},"2.2. Preparing a managed node","proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles","#proc_preparing-a-managed-node_assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles","#assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":46,"visible":15,"weight":47,"urlFragment":48,"anchor":18,"singlePageAnchor":48,"docTitle":19,"url":49},"3. Ansible vault",5,"ansible-vault_automating-system-administration-by-using-rhel-system-roles","#ansible-vault_automating-system-administration-by-using-rhel-system-roles",{"title":51,"visible":15,"weight":52,"urlFragment":53,"anchor":18,"singlePageAnchor":53,"sections":54,"docTitle":19,"url":67},"4. Ansible IPMI modules in RHEL",6,"assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles",[55,59,63],{"title":56,"visible":15,"weight":16,"urlFragment":53,"anchor":57,"singlePageAnchor":57,"docTitle":19,"url":58},"4.1. The rhel_mgmt collection","ref_the-rhel_mgmt-collection_assembly_ansible-ipmi-modules-in-rhel","#ref_the-rhel_mgmt-collection_assembly_ansible-ipmi-modules-in-rhel",{"title":60,"visible":15,"weight":23,"urlFragment":53,"anchor":61,"singlePageAnchor":61,"docTitle":19,"url":62},"4.2. Using the ipmi_boot module","proc_example-using-the-ipmi_boot-module_assembly_ansible-ipmi-modules-in-rhel","#proc_example-using-the-ipmi_boot-module_assembly_ansible-ipmi-modules-in-rhel",{"title":64,"visible":15,"weight":28,"urlFragment":53,"anchor":65,"singlePageAnchor":65,"docTitle":19,"url":66},"4.3. Using the ipmi_power module","proc_example-using-the-ipmi_power-module_assembly_ansible-ipmi-modules-in-rhel","#proc_example-using-the-ipmi_power-module_assembly_ansible-ipmi-modules-in-rhel","#assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles",{"title":69,"visible":15,"weight":70,"urlFragment":71,"anchor":18,"singlePageAnchor":71,"sections":72,"docTitle":19,"url":93},"5. The Redfish modules in RHEL",7,"assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles",[73,77,81,85,89],{"title":74,"visible":15,"weight":16,"urlFragment":71,"anchor":75,"singlePageAnchor":75,"docTitle":19,"url":76},"5.1. The Redfish modules","con_the-redfish-modules_assembly_the-redfish-modules-in-rhel","#con_the-redfish-modules_assembly_the-redfish-modules-in-rhel",{"title":78,"visible":15,"weight":23,"urlFragment":71,"anchor":79,"singlePageAnchor":79,"docTitle":19,"url":80},"5.2. Redfish modules parameters","ref_redfish-modules-parameters_assembly_the-redfish-modules-in-rhel","#ref_redfish-modules-parameters_assembly_the-redfish-modules-in-rhel",{"title":82,"visible":15,"weight":28,"urlFragment":71,"anchor":83,"singlePageAnchor":83,"docTitle":19,"url":84},"5.3. Using the redfish_info module","proc_using-the-redfish-info-module_assembly_the-redfish-modules-in-rhel","#proc_using-the-redfish-info-module_assembly_the-redfish-modules-in-rhel",{"title":86,"visible":15,"weight":33,"urlFragment":71,"anchor":87,"singlePageAnchor":87,"docTitle":19,"url":88},"5.4. Using the redfish_command module","proc_using-the-redfish-command-module_assembly_the-redfish-modules-in-rhel","#proc_using-the-redfish-command-module_assembly_the-redfish-modules-in-rhel",{"title":90,"visible":15,"weight":47,"urlFragment":71,"anchor":91,"singlePageAnchor":91,"docTitle":19,"url":92},"5.5. Using the redfish_config module","proc_using-the-redfish-config-module_assembly_the-redfish-modules-in-rhel","#proc_using-the-redfish-config-module_assembly_the-redfish-modules-in-rhel","#assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles",{"title":95,"visible":15,"weight":96,"urlFragment":97,"anchor":18,"singlePageAnchor":97,"sections":98,"docTitle":19,"url":103},"6. Joining RHEL systems to an Active Directory by using RHEL system roles",8,"integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[99],{"title":100,"visible":15,"weight":16,"urlFragment":97,"anchor":101,"singlePageAnchor":101,"docTitle":19,"url":102},"6.1. Joining RHEL to an Active Directory domain by using the ad_integration RHEL system role","connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles","#connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles","#integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":105,"visible":15,"weight":106,"urlFragment":107,"anchor":18,"singlePageAnchor":107,"sections":108,"docTitle":19,"url":117},"7. Requesting certificates from a CA and creating self-signed certificates by using RHEL system roles",9,"requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[109,113],{"title":110,"visible":15,"weight":16,"urlFragment":107,"anchor":111,"singlePageAnchor":111,"docTitle":19,"url":112},"7.1. Requesting a new certificate from an IdM CA by using the certificate RHEL system role","requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles","#requesting-a-new-certificate-from-idm-ca-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles",{"title":114,"visible":15,"weight":23,"urlFragment":107,"anchor":115,"singlePageAnchor":115,"docTitle":19,"url":116},"7.2. Requesting a new self-signed certificate by using the certificate RHEL system role","requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles","#requesting-a-new-self-signed-certificate-using-the-certificate-system-role_requesting-certificates-using-rhel-system-roles","#requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":119,"visible":15,"weight":120,"urlFragment":121,"anchor":18,"singlePageAnchor":121,"sections":122,"docTitle":19,"url":127},"8. Installing and configuring web console by using RHEL system roles",10,"assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[123],{"title":124,"visible":15,"weight":16,"urlFragment":121,"anchor":125,"singlePageAnchor":125,"docTitle":19,"url":126},"8.1. Installing the web console by using the cockpit RHEL system role","proc_installing-the-web-console-by-using-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role","#proc_installing-the-web-console-by-using-the-cockpit-rhel-system-role_assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role","#assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":129,"visible":15,"weight":130,"urlFragment":131,"anchor":18,"singlePageAnchor":131,"sections":132,"docTitle":19,"url":137},"9. Setting a custom cryptographic policy by using RHEL system roles",11,"setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[133],{"title":134,"visible":15,"weight":16,"urlFragment":131,"anchor":135,"singlePageAnchor":135,"docTitle":19,"url":136},"9.1. Enhancing security with the FUTURE cryptographic policy using the crypto_policies RHEL system role","proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role","#proc_setting-a-custom-cryptographic-policy-using-the-crypto-policies-system-role_setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role","#setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":139,"visible":15,"weight":140,"urlFragment":141,"anchor":18,"singlePageAnchor":141,"sections":142,"docTitle":19,"url":155},"10. Configuring firewalld by using RHEL system roles",12,"assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles",[143,147,151],{"title":144,"visible":15,"weight":16,"urlFragment":141,"anchor":145,"singlePageAnchor":145,"docTitle":19,"url":146},"10.1. Resetting the firewalld settings by using the firewall RHEL system role","proc_resetting-the-firewalld-settings-using-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles","#proc_resetting-the-firewalld-settings-using-the-firewall-rhel-system-role_assembly_configuring-firewalld-using-system-roles",{"title":148,"visible":15,"weight":23,"urlFragment":141,"anchor":149,"singlePageAnchor":149,"docTitle":19,"url":150},"10.2. Forwarding incoming traffic in firewalld from one local port to a different local port by using the firewall RHEL system role","proc_forwarding-incoming-traffic-from-one-local-port-to-a-different-local-port_assembly_configuring-firewalld-using-system-roles","#proc_forwarding-incoming-traffic-from-one-local-port-to-a-different-local-port_assembly_configuring-firewalld-using-system-roles",{"title":152,"visible":15,"weight":28,"urlFragment":141,"anchor":153,"singlePageAnchor":153,"docTitle":19,"url":154},"10.3. Configuring a firewalld DMZ zone by using the firewall RHEL system role","configuring-a-dmz-firewalld-zone-by-using-the-firewalld-rhel-system-role_assembly_configuring-firewalld-using-system-roles","#configuring-a-dmz-firewalld-zone-by-using-the-firewalld-rhel-system-role_assembly_configuring-firewalld-using-system-roles","#assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":157,"visible":15,"weight":158,"urlFragment":159,"anchor":18,"singlePageAnchor":159,"sections":160,"docTitle":19,"url":242},"11. Configuring a high-availability cluster by using RHEL system roles",13,"configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[161,165,169,173,177,181,185,189,193,197,201,205,209,213,218,232,237],{"title":162,"visible":15,"weight":16,"urlFragment":159,"anchor":163,"singlePageAnchor":163,"docTitle":19,"url":164},"11.1. Variables of the ha_cluster RHEL system role","ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#ha-system-role-variables_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":166,"visible":15,"weight":23,"urlFragment":159,"anchor":167,"singlePageAnchor":167,"docTitle":19,"url":168},"11.2. Specifying an inventory for the ha_cluster RHEL system role","ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#ha-system-role-inventory_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":170,"visible":15,"weight":28,"urlFragment":159,"anchor":171,"singlePageAnchor":171,"docTitle":19,"url":172},"11.3. Creating pcsd TLS certificates and key files for a high availability cluster","configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-TLScert-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":174,"visible":15,"weight":33,"urlFragment":159,"anchor":175,"singlePageAnchor":175,"docTitle":19,"url":176},"11.4. Configuring a high availability cluster running no resources","configuring-no-resource-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-no-resource-ha-cluster-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":178,"visible":15,"weight":47,"urlFragment":159,"anchor":179,"singlePageAnchor":179,"docTitle":19,"url":180},"11.5. Configuring a high availability cluster with fencing and resources","configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-ha-cluster-with-fencing-and-resources_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":182,"visible":15,"weight":52,"urlFragment":159,"anchor":183,"singlePageAnchor":183,"docTitle":19,"url":184},"11.6. Configuring a high availability cluster with resource and resource operation defaults","configuring-ha-cluster-with-resource-defaults_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-ha-cluster-with-resource-defaults_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":186,"visible":15,"weight":70,"urlFragment":159,"anchor":187,"singlePageAnchor":187,"docTitle":19,"url":188},"11.7. Configuring a high availability cluster with fencing levels","configuring-with-stonith-levels-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-with-stonith-levels-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":190,"visible":15,"weight":96,"urlFragment":159,"anchor":191,"singlePageAnchor":191,"docTitle":19,"url":192},"11.8. Configuring a high availability cluster with resource constraints","configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-ha-cluster-with-constraints_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":194,"visible":15,"weight":106,"urlFragment":159,"anchor":195,"singlePageAnchor":195,"docTitle":19,"url":196},"11.9. Configuring Corosync values in a high availability cluster","configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-ha-cluster-with-corosync_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":198,"visible":15,"weight":120,"urlFragment":159,"anchor":199,"singlePageAnchor":199,"docTitle":19,"url":200},"11.10. Configuring a high availability cluster that implements access control lists (ACLs) by using the ha_cluster RHEL system role","configuring-hacluster-with-ACLS-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-hacluster-with-ACLS-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":202,"visible":15,"weight":130,"urlFragment":159,"anchor":203,"singlePageAnchor":203,"docTitle":19,"url":204},"11.11. Configuring a high availability cluster with SBD node fencing by using the ha_cluster_node_options variable","configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-sbd-with-ha_cluster_nodes_options-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":206,"visible":15,"weight":140,"urlFragment":159,"anchor":207,"singlePageAnchor":207,"docTitle":19,"url":208},"11.12. Configuring a high availability cluster with SBD node fencing by using the ha_cluster variable","configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-sbd-with-ha_cluster-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":210,"visible":15,"weight":158,"urlFragment":159,"anchor":211,"singlePageAnchor":211,"docTitle":19,"url":212},"11.13. Configuring a placement strategy for a high availability cluster by using the RHEL ha_cluster RHEL system role","configuring-hacluster-with-placement-strategy-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-hacluster-with-placement-strategy-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":214,"visible":15,"weight":215,"urlFragment":159,"anchor":216,"singlePageAnchor":216,"docTitle":19,"url":217},"11.14. Configuring alerts for a high availability cluster by using the ha_cluster RHEL system role",14,"configuring-alerts-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-alerts-hacluster-using-system-roles-configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":219,"visible":15,"weight":220,"urlFragment":159,"anchor":221,"singlePageAnchor":221,"sections":222,"docTitle":19,"url":231},"11.15. Configuring a high availability cluster using a quorum device",15,"configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",[223,227],{"title":224,"visible":15,"weight":16,"urlFragment":159,"anchor":225,"singlePageAnchor":225,"docTitle":19,"url":226},"11.15.1. Configuring a quorum device","configuring-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":228,"visible":15,"weight":23,"urlFragment":159,"anchor":229,"singlePageAnchor":229,"docTitle":19,"url":230},"11.15.2. Configuring a cluster to use a quorum device","configuring-a-cluster-to-use-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-a-cluster-to-use-a-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-ha-cluster-with-quorum-device_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":233,"visible":15,"weight":234,"urlFragment":159,"anchor":235,"singlePageAnchor":235,"docTitle":19,"url":236},"11.16. Configuring a high availability cluster with node attributes",16,"configuring-ha-cluster-with-node-attributes_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-ha-cluster-with-node-attributes_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role",{"title":238,"visible":15,"weight":239,"urlFragment":159,"anchor":240,"singlePageAnchor":240,"docTitle":19,"url":241},"11.17. Configuring an Apache HTTP server in a high availability cluster with the ha_cluster RHEL system role",17,"configuring-http-ha-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-http-ha-using-system-roles_configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role","#configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":244,"visible":15,"weight":215,"urlFragment":245,"anchor":18,"singlePageAnchor":246,"sections":247,"docTitle":19,"url":252},"12. Configuring the systemd journal by using RHEL system roles","configuring-the-systemd-journal-by-using-the-journald-rhel-system-role_automating-system-administration-by-using-rhel-system-roles","configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles",[248],{"title":249,"visible":15,"weight":16,"urlFragment":245,"anchor":250,"singlePageAnchor":250,"docTitle":19,"url":251},"12.1. Configuring persistent logging by using the journald RHEL system role","configuring-persistent-logging-by-using-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role","#configuring-persistent-logging-by-using-the-journald-system-role_configuring-the-systemd-journal-by-using-the-journald-rhel-system-role","#configuring-the-systemd-journal-by-using-the-journald-RHEL-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":254,"visible":15,"weight":220,"urlFragment":255,"anchor":18,"singlePageAnchor":255,"sections":256,"docTitle":19,"url":261},"13. Configuring automatic crash dumps by using RHEL system roles","configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[257],{"title":258,"visible":15,"weight":16,"urlFragment":255,"anchor":259,"singlePageAnchor":259,"docTitle":19,"url":260},"13.1. Configuring the kernel crash dumping mechanism by using the kdump RHEL system role","configuring-kdump-using-rhel-system-roles_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role","#configuring-kdump-using-rhel-system-roles_configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role","#configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":263,"visible":15,"weight":234,"urlFragment":264,"anchor":18,"singlePageAnchor":264,"sections":265,"docTitle":19,"url":270},"14. Configuring kernel parameters permanently by using RHEL system roles","configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[266],{"title":267,"visible":15,"weight":16,"urlFragment":264,"anchor":268,"singlePageAnchor":268,"docTitle":19,"url":269},"14.1. Applying selected kernel parameters by using the kernel_settings RHEL system role","applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role","#applying-selected-kernel-parameters-using-the-kernel-settings-role_configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role","#configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":272,"visible":15,"weight":239,"urlFragment":273,"anchor":18,"singlePageAnchor":273,"sections":274,"docTitle":19,"url":291},"15. Configuring the GRUB 2 boot loader by using RHEL system roles","configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[275,279,283,287],{"title":276,"visible":15,"weight":16,"urlFragment":273,"anchor":277,"singlePageAnchor":277,"docTitle":19,"url":278},"15.1. Updating the existing boot loader entries by using the bootloader RHEL system role","updating-the-existing-boot-loader-entries-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles","#updating-the-existing-boot-loader-entries-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles",{"title":280,"visible":15,"weight":23,"urlFragment":273,"anchor":281,"singlePageAnchor":281,"docTitle":19,"url":282},"15.2. Securing the boot menu with password by using the bootloader RHEL system role","securing-the-boot-menu-with-password-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles","#securing-the-boot-menu-with-password-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles",{"title":284,"visible":15,"weight":28,"urlFragment":273,"anchor":285,"singlePageAnchor":285,"docTitle":19,"url":286},"15.3. Setting a timeout for the boot loader menu by using the bootloader RHEL system role","setting-a-timeout-for-the-boot-loader-menu-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles","#setting-a-timeout-for-the-boot-loader-menu-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles",{"title":288,"visible":15,"weight":33,"urlFragment":273,"anchor":289,"singlePageAnchor":289,"docTitle":19,"url":290},"15.4. Collecting the boot loader configuration information by using the bootloader RHEL system role","collecting-the-boot-loader-configuration-information-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles","#collecting-the-boot-loader-configuration-information-by-using-the-bootloader-rhel-system-role_configuring-the-grub-2-boot-loader-by-using-rhel-system-roles","#configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":293,"visible":15,"weight":294,"urlFragment":295,"anchor":18,"singlePageAnchor":295,"sections":296,"docTitle":19,"url":331},"16. Configuring logging by using RHEL system roles",18,"configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[297,301,305,318],{"title":298,"visible":15,"weight":16,"urlFragment":295,"anchor":299,"singlePageAnchor":299,"docTitle":19,"url":300},"16.1. Filtering local log messages by using the logging RHEL system role","proc_filtering-logs-in-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles","#proc_filtering-logs-in-a-local-logging-system-role_configuring-logging-by-using-rhel-system-roles",{"title":302,"visible":15,"weight":23,"urlFragment":295,"anchor":303,"singlePageAnchor":303,"docTitle":19,"url":304},"16.2. Applying a remote logging solution by using the logging RHEL system role","applying-a-remote-logging-solution-using-the-logging-system-role_configuring-logging-by-using-rhel-system-roles","#applying-a-remote-logging-solution-using-the-logging-system-role_configuring-logging-by-using-rhel-system-roles",{"title":306,"visible":15,"weight":28,"urlFragment":295,"anchor":307,"singlePageAnchor":307,"sections":308,"docTitle":19,"url":317},"16.3. Using the logging RHEL system role with TLS","assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles",[309,313],{"title":310,"visible":15,"weight":16,"urlFragment":295,"anchor":311,"singlePageAnchor":311,"docTitle":19,"url":312},"16.3.1. Configuring client logging with TLS","configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls","#configuring-client-logging-with-tls_assembly_using-the-logging-system-role-with-tls",{"title":314,"visible":15,"weight":23,"urlFragment":295,"anchor":315,"singlePageAnchor":315,"docTitle":19,"url":316},"16.3.2. Configuring server logging with TLS","configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls","#configuring-server-logging-with-tls_assembly_using-the-logging-system-role-with-tls","#assembly_using-the-logging-system-role-with-tls_configuring-logging-by-using-rhel-system-roles",{"title":319,"visible":15,"weight":33,"urlFragment":295,"anchor":320,"singlePageAnchor":320,"sections":321,"docTitle":19,"url":330},"16.4. Using the logging RHEL system roles with RELP","assembly_using-the-logging-system-roles-with-relp",[322,326],{"title":323,"visible":15,"weight":16,"urlFragment":295,"anchor":324,"singlePageAnchor":324,"docTitle":19,"url":325},"16.4.1. Configuring client logging with RELP","configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp","#configuring-client-logging-with-relp_assembly_using-the-logging-system-roles-with-relp",{"title":327,"visible":15,"weight":23,"urlFragment":295,"anchor":328,"singlePageAnchor":328,"docTitle":19,"url":329},"16.4.2. Configuring server logging with RELP","configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp","#configuring-server-logging-with-relp_assembly_using-the-logging-system-roles-with-relp","#assembly_using-the-logging-system-roles-with-relp","#configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":333,"visible":15,"weight":334,"urlFragment":335,"anchor":18,"singlePageAnchor":335,"sections":336,"docTitle":19,"url":353},"17. Configuring performance monitoring with PCP by using RHEL system roles",19,"monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[337,341,345,349],{"title":338,"visible":15,"weight":16,"urlFragment":335,"anchor":339,"singlePageAnchor":339,"docTitle":19,"url":340},"17.1. Configuring Performance Co-Pilot by using the metrics RHEL system role","configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role","#configuring-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role",{"title":342,"visible":15,"weight":23,"urlFragment":335,"anchor":343,"singlePageAnchor":343,"docTitle":19,"url":344},"17.2. Configuring Performance Co-Pilot with authentication by using the metrics RHEL system role","configuring-performance-co-pilot-with-authentication-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role","#configuring-performance-co-pilot-with-authentication-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role",{"title":346,"visible":15,"weight":28,"urlFragment":335,"anchor":347,"singlePageAnchor":347,"docTitle":19,"url":348},"17.3. Setting up Grafana by using the metrics RHEL system role to monitor multiple hosts with Performance Co-Pilot","setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role","#setting-up-grafana-by-using-the-metrics-rhel-system-role-to-monitor-multiple-hosts-with-performance-co-pilot_monitoring-performance-by-using-the-metrics-rhel-system-role",{"title":350,"visible":15,"weight":33,"urlFragment":335,"anchor":351,"singlePageAnchor":351,"docTitle":19,"url":352},"17.4. Configuring web hooks in Performance Co-Pilot by using the metrics RHEL system role","configuring-web-hooks-in-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role","#configuring-web-hooks-in-performance-co-pilot-by-using-the-metrics-rhel-system-role_monitoring-performance-by-using-the-metrics-rhel-system-role","#monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":355,"visible":15,"weight":356,"urlFragment":357,"anchor":18,"singlePageAnchor":357,"sections":358,"docTitle":19,"url":375},"18. Configuring Microsoft SQL Server by using RHEL system roles",20,"assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles",[359,363,367,371],{"title":360,"visible":15,"weight":16,"urlFragment":357,"anchor":361,"singlePageAnchor":361,"docTitle":19,"url":362},"18.1. Installing and configuring SQL Server with an existing TLS certificate by using the microsoft.sql.server Ansible system role","installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-existing-certificate-files_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role","#installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-existing-certificate-files_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role",{"title":364,"visible":15,"weight":23,"urlFragment":357,"anchor":365,"singlePageAnchor":365,"docTitle":19,"url":366},"18.2. Installing and configuring SQL Server with a TLS certificate issued from IdM by using the microsoft.sql.server Ansible system role","installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-the-certificate-role_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role","#installing-and-configuring-sql-server-using-the-microsoft-sql-server-ansible-role-with-the-certificate-role_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role",{"title":368,"visible":15,"weight":28,"urlFragment":357,"anchor":369,"singlePageAnchor":369,"docTitle":19,"url":370},"18.3. Installing and configuring SQL Server with custom storage paths by using the microsoft.sql.server Ansible system role","setting-up-custom-storage-paths-for-data-and-logs_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role","#setting-up-custom-storage-paths-for-data-and-logs_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role",{"title":372,"visible":15,"weight":33,"urlFragment":357,"anchor":373,"singlePageAnchor":373,"docTitle":19,"url":374},"18.4. Installing and configuring SQL Server with AD integration by using the microsoft.sql.server Ansible system role","preparing-and-running-a-playbook-to-enable-sql-server-authentication-with-active-directory_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role","#preparing-and-running-a-playbook-to-enable-sql-server-authentication-with-active-directory_assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role","#assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles",{"title":377,"visible":15,"weight":378,"urlFragment":379,"anchor":18,"singlePageAnchor":379,"sections":380,"docTitle":19,"url":393},"19. Configuring NBDE by using RHEL system roles",21,"configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[381,385,389],{"title":382,"visible":15,"weight":16,"urlFragment":379,"anchor":383,"singlePageAnchor":383,"docTitle":19,"url":384},"19.1. Using the nbde_server RHEL system role for setting up multiple Tang servers","using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles","#using-the-nbde_server-system-role-for-setting-up-multiple-tang-servers_configuring-nbde-by-using-rhel-system-roles",{"title":386,"visible":15,"weight":23,"urlFragment":379,"anchor":387,"singlePageAnchor":387,"docTitle":19,"url":388},"19.2. Setting up Clevis clients with DHCP by using the nbde_client RHEL system role","using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles","#using-the-nbde_client-system-role-for-setting-up-multiple-clevis-clients_configuring-nbde-by-using-rhel-system-roles",{"title":390,"visible":15,"weight":28,"urlFragment":379,"anchor":391,"singlePageAnchor":391,"docTitle":19,"url":392},"19.3. Setting up static-IP Clevis clients by using the nbde_client RHEL system role","setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles","#setting-up-static-ip-clevis-clients-by-using-the-nbde-client-rhel-system-role_configuring-nbde-by-using-rhel-system-roles","#configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":395,"visible":15,"weight":396,"urlFragment":397,"anchor":18,"singlePageAnchor":397,"sections":398,"docTitle":19,"url":467},"20. Configuring network settings by using RHEL system roles",22,"assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[399,403,407,411,415,419,423,427,431,435,439,443,447,451,455,459,463],{"title":400,"visible":15,"weight":16,"urlFragment":397,"anchor":401,"singlePageAnchor":401,"docTitle":19,"url":402},"20.1. Configuring an Ethernet connection with a static IP address by using the network RHEL system role with an interface name","configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles","#configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":404,"visible":15,"weight":23,"urlFragment":397,"anchor":405,"singlePageAnchor":405,"docTitle":19,"url":406},"20.2. Configuring an Ethernet connection with a static IP address by using the network RHEL system role with a device path","configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles","#configuring-an-ethernet-connection-with-a-static-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":408,"visible":15,"weight":28,"urlFragment":397,"anchor":409,"singlePageAnchor":409,"docTitle":19,"url":410},"20.3. Configuring an Ethernet connection with a dynamic IP address by using the network RHEL system role with an interface name","configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles","#configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-an-interface-name_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":412,"visible":15,"weight":33,"urlFragment":397,"anchor":413,"singlePageAnchor":413,"docTitle":19,"url":414},"20.4. Configuring an Ethernet connection with a dynamic IP address by using the network RHEL system role with a device path","configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles","#configuring-an-ethernet-connection-with-a-dynamic-ip-address-by-using-the-network-rhel-system-role-with-a-device-path_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":416,"visible":15,"weight":47,"urlFragment":397,"anchor":417,"singlePageAnchor":417,"docTitle":19,"url":418},"20.5. Configuring VLAN tagging by using the network RHEL system role","configuring-vlan-tagging-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#configuring-vlan-tagging-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":420,"visible":15,"weight":52,"urlFragment":397,"anchor":421,"singlePageAnchor":421,"docTitle":19,"url":422},"20.6. Configuring a network bridge by using the network RHEL system role","configuring-a-network-bridge-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#configuring-a-network-bridge-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":424,"visible":15,"weight":70,"urlFragment":397,"anchor":425,"singlePageAnchor":425,"docTitle":19,"url":426},"20.7. Configuring a network bond by using the network RHEL system role","proc_configuring-a-network-bond-by-using-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#proc_configuring-a-network-bond-by-using-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":428,"visible":15,"weight":96,"urlFragment":397,"anchor":429,"singlePageAnchor":429,"docTitle":19,"url":430},"20.8. Configuring an IPoIB connection by using the network RHEL system role","configuring-an-ipoib-connection-by-using-the-network-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#configuring-an-ipoib-connection-by-using-the-network-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":432,"visible":15,"weight":106,"urlFragment":397,"anchor":433,"singlePageAnchor":433,"docTitle":19,"url":434},"20.9. Routing traffic from a specific subnet to a different default gateway by using the network RHEL system role","proc_routing-traffic-from-a-specific-subnet-to-a-different-default-gateway-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#proc_routing-traffic-from-a-specific-subnet-to-a-different-default-gateway-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":436,"visible":15,"weight":120,"urlFragment":397,"anchor":437,"singlePageAnchor":437,"docTitle":19,"url":438},"20.10. Configuring a static Ethernet connection with 802.1X network authentication by using the network RHEL system role","configuring-a-static-ethernet-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#configuring-a-static-ethernet-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":440,"visible":15,"weight":130,"urlFragment":397,"anchor":441,"singlePageAnchor":441,"docTitle":19,"url":442},"20.11. Configuring a wifi connection with 802.1X network authentication by using the network RHEL system role","proc_configuring-a-wifi-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#proc_configuring-a-wifi-connection-with-802-1x-network-authentication-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":444,"visible":15,"weight":140,"urlFragment":397,"anchor":445,"singlePageAnchor":445,"docTitle":19,"url":446},"20.12. Setting the default gateway on an existing connection by using the network RHEL system role","proc_setting-the-default-gateway-on-an-existing-connection-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#proc_setting-the-default-gateway-on-an-existing-connection-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":448,"visible":15,"weight":158,"urlFragment":397,"anchor":449,"singlePageAnchor":449,"docTitle":19,"url":450},"20.13. Configuring a static route by using the network RHEL system role","proc_configuring-a-static-route-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#proc_configuring-a-static-route-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":452,"visible":15,"weight":215,"urlFragment":397,"anchor":453,"singlePageAnchor":453,"docTitle":19,"url":454},"20.14. Configuring an ethtool offload feature by using the network RHEL system role","proc_configuring-an-ethtool-offload-feature-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#proc_configuring-an-ethtool-offload-feature-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":456,"visible":15,"weight":220,"urlFragment":397,"anchor":457,"singlePageAnchor":457,"docTitle":19,"url":458},"20.15. Configuring an ethtool coalesce settings by using the network RHEL system role","proc_configuring-an-ethtool-coalesce-settings-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#proc_configuring-an-ethtool-coalesce-settings-by-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":460,"visible":15,"weight":234,"urlFragment":397,"anchor":461,"singlePageAnchor":461,"docTitle":19,"url":462},"20.16. Increasing the ring buffer size to reduce a high packet drop rate by using the network RHEL system role","proc_increasing-the-ring-buffer-size-to-reduce-a-high-packet-drop-rate-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles","#proc_increasing-the-ring-buffer-size-to-reduce-a-high-packet-drop-rate-using-the-network-rhel-system-role_assembly_configuring-network-settings-by-using-rhel-system-roles",{"title":464,"visible":15,"weight":239,"urlFragment":397,"anchor":465,"singlePageAnchor":465,"docTitle":19,"url":466},"20.17. Network states for the network RHEL system role","ref_network-states-for-the-network-rhel-system-roles_assembly_configuring-network-settings-by-using-rhel-system-roles","#ref_network-states-for-the-network-rhel-system-roles_assembly_configuring-network-settings-by-using-rhel-system-roles","#assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":469,"visible":15,"weight":470,"urlFragment":471,"anchor":18,"singlePageAnchor":471,"sections":472,"docTitle":19,"url":485},"21. Managing containers by using RHEL system roles",23,"managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[473,477,481],{"title":474,"visible":15,"weight":16,"urlFragment":471,"anchor":475,"singlePageAnchor":475,"docTitle":19,"url":476},"21.1. Creating a rootless container with bind mount by using the podman RHEL system role","creating-a-rootless-container-with-bind-mount_managing-containers-by-using-the-podman-rhel-system-role","#creating-a-rootless-container-with-bind-mount_managing-containers-by-using-the-podman-rhel-system-role",{"title":478,"visible":15,"weight":23,"urlFragment":471,"anchor":479,"singlePageAnchor":479,"docTitle":19,"url":480},"21.2. Creating a rootful container with Podman volume by using the podman RHEL system role","creating-a-rootful-container-with-podman-volume_managing-containers-by-using-the-podman-rhel-system-role","#creating-a-rootful-container-with-podman-volume_managing-containers-by-using-the-podman-rhel-system-role",{"title":482,"visible":15,"weight":28,"urlFragment":471,"anchor":483,"singlePageAnchor":483,"docTitle":19,"url":484},"21.3. Creating a Quadlet application with secrets by using the podman RHEL system role","creating-a-quadlet-application-with-secrets_managing-containers-by-using-the-podman-rhel-system-role","#creating-a-quadlet-application-with-secrets_managing-containers-by-using-the-podman-rhel-system-role","#managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":487,"visible":15,"weight":488,"urlFragment":489,"anchor":18,"singlePageAnchor":489,"sections":490,"docTitle":19,"url":495},"22. Configuring Postfix MTA by using RHEL system roles",24,"configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[491],{"title":492,"visible":15,"weight":16,"urlFragment":489,"anchor":493,"singlePageAnchor":493,"docTitle":19,"url":494},"22.1. Using the postfix RHEL system role to automate basic Postfix MTA administration","using-the-postfix-system-role-to-automate-basic-postfix-mta-administration_configuring-postfix-mta-by-using-rhel-system-roles","#using-the-postfix-system-role-to-automate-basic-postfix-mta-administration_configuring-postfix-mta-by-using-rhel-system-roles","#configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":497,"visible":15,"weight":498,"urlFragment":499,"anchor":18,"singlePageAnchor":499,"sections":500,"docTitle":19,"url":509},"23. Installing and configuring PostgreSQL by using RHEL system roles",25,"installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[501,505],{"title":502,"visible":15,"weight":16,"urlFragment":499,"anchor":503,"singlePageAnchor":503,"docTitle":19,"url":504},"23.1. Introduction to the postgresql RHEL system role","introduction-to-the-postgresql-rhel-system-role_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role","#introduction-to-the-postgresql-rhel-system-role_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role",{"title":506,"visible":15,"weight":23,"urlFragment":499,"anchor":507,"singlePageAnchor":507,"docTitle":19,"url":508},"23.2. Configuring the PostgreSQL server by using the postgresql RHEL system role","configuring-the-postgresql-server-by-using-rhel-system-roles_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role","#configuring-the-postgresql-server-by-using-rhel-system-roles_installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role","#installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":511,"visible":15,"weight":512,"urlFragment":513,"anchor":18,"singlePageAnchor":513,"sections":514,"docTitle":19,"url":559},"24. Registering the system by using RHEL system roles",26,"using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles",[515,519,523,527,531,535,539,543,547,551,555],{"title":516,"visible":15,"weight":16,"urlFragment":513,"anchor":517,"singlePageAnchor":517,"docTitle":19,"url":518},"24.1. Introduction to the rhc RHEL system role","introduction-to-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#introduction-to-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":520,"visible":15,"weight":23,"urlFragment":513,"anchor":521,"singlePageAnchor":521,"docTitle":19,"url":522},"24.2. Registering a system by using the rhc RHEL system role","registering-system-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#registering-system-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":524,"visible":15,"weight":28,"urlFragment":513,"anchor":525,"singlePageAnchor":525,"docTitle":19,"url":526},"24.3. Registering a system with Satellite by using the rhc RHEL system role","registering-system-with-satellite-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#registering-system-with-satellite-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":528,"visible":15,"weight":33,"urlFragment":513,"anchor":529,"singlePageAnchor":529,"docTitle":19,"url":530},"24.4. Disabling the connection to Insights after the registration by using the rhc RHEL system role","configuring-insights-connection-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#configuring-insights-connection-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":532,"visible":15,"weight":47,"urlFragment":513,"anchor":533,"singlePageAnchor":533,"docTitle":19,"url":534},"24.5. Enabling repositories by using the rhc RHEL system role","configuring-repositories-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#configuring-repositories-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":536,"visible":15,"weight":52,"urlFragment":513,"anchor":537,"singlePageAnchor":537,"docTitle":19,"url":538},"24.6. Setting release versions by using the rhc RHEL system role","setting-release-versions-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#setting-release-versions-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":540,"visible":15,"weight":70,"urlFragment":513,"anchor":541,"singlePageAnchor":541,"docTitle":19,"url":542},"24.7. Using a proxy server when registering the host by using the rhc RHEL system role","configuring-proxy-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#configuring-proxy-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":544,"visible":15,"weight":96,"urlFragment":513,"anchor":545,"singlePageAnchor":545,"docTitle":19,"url":546},"24.8. Disabling auto updates of Insights rules by using the rhc RHEL system role","configuring-auto-updates-insights-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#configuring-auto-updates-insights-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":548,"visible":15,"weight":106,"urlFragment":513,"anchor":549,"singlePageAnchor":549,"docTitle":19,"url":550},"24.9. Disabling Insights remediations by using the rhc RHEL system role","configuring-insights-remediations-using-rhel-system-role_using-the-rhc-system-role-to-register-the-system","#configuring-insights-remediations-using-rhel-system-role_using-the-rhc-system-role-to-register-the-system",{"title":552,"visible":15,"weight":120,"urlFragment":513,"anchor":553,"singlePageAnchor":553,"docTitle":19,"url":554},"24.10. Configuring Insights tags by using the rhc RHEL system role","configuring-insights-tags-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#configuring-insights-tags-using-rhc-system-role_using-the-rhc-system-role-to-register-the-system",{"title":556,"visible":15,"weight":130,"urlFragment":513,"anchor":557,"singlePageAnchor":557,"docTitle":19,"url":558},"24.11. Unregistering a system by using the rhc RHEL system role","unregistering-a-system-using-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#unregistering-a-system-using-the-rhc-system-role_using-the-rhc-system-role-to-register-the-system","#using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles",{"title":561,"visible":15,"weight":562,"urlFragment":563,"anchor":18,"singlePageAnchor":563,"sections":564,"docTitle":19,"url":577},"25. Configuring SELinux by using RHEL system roles",27,"configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles",[565,569,573],{"title":566,"visible":15,"weight":16,"urlFragment":563,"anchor":567,"singlePageAnchor":567,"docTitle":19,"url":568},"25.1. Introduction to the selinux RHEL system role","introduction-to-the-selinux-system-role_configuring-selinux-using-system-roles","#introduction-to-the-selinux-system-role_configuring-selinux-using-system-roles",{"title":570,"visible":15,"weight":23,"urlFragment":563,"anchor":571,"singlePageAnchor":571,"docTitle":19,"url":572},"25.2. Using the selinux RHEL system role to apply SELinux settings on multiple systems","using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_configuring-selinux-using-system-roles","#using-the-selinux-system-role-to-apply-selinux-settings-on-multiple-systems_configuring-selinux-using-system-roles",{"title":574,"visible":15,"weight":28,"urlFragment":563,"anchor":575,"singlePageAnchor":575,"docTitle":19,"url":576},"25.3. Managing ports by using the selinux RHEL system role","managing-ports-by-using-the-selinux-rhel-system-role_configuring-selinux-using-system-roles","#managing-ports-by-using-the-selinux-rhel-system-role_configuring-selinux-using-system-roles","#configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":579,"visible":15,"weight":580,"urlFragment":581,"anchor":18,"singlePageAnchor":581,"sections":582,"docTitle":19,"url":587},"26. Restricting the execution of applications by using the fapolicyd RHEL system role",28,"restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[583],{"title":584,"visible":15,"weight":16,"urlFragment":581,"anchor":585,"singlePageAnchor":585,"docTitle":19,"url":586},"26.1. Preventing users from executing untrustworthy code by using the fapolicyd RHEL system role","preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role","#preventing-execution-of-unknown-code-using-fapolicy-rhel-system-role_restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role","#restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":589,"visible":15,"weight":590,"urlFragment":591,"anchor":18,"singlePageAnchor":591,"sections":592,"docTitle":19,"url":617},"27. Configuring the OpenSSH server and client by using RHEL system roles",29,"configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[593,597,601,605,609,613],{"title":594,"visible":15,"weight":16,"urlFragment":591,"anchor":595,"singlePageAnchor":595,"docTitle":19,"url":596},"27.1. How the sshd RHEL system role maps settings from a playbook to the configuration file","sshd-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles","#sshd-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles",{"title":598,"visible":15,"weight":23,"urlFragment":591,"anchor":599,"singlePageAnchor":599,"docTitle":19,"url":600},"27.2. Configuring OpenSSH servers by using the sshd RHEL system role","configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles","#configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles",{"title":602,"visible":15,"weight":28,"urlFragment":591,"anchor":603,"singlePageAnchor":603,"docTitle":19,"url":604},"27.3. Using the sshd RHEL system role for non-exclusive configuration","proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles","#proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles",{"title":606,"visible":15,"weight":33,"urlFragment":591,"anchor":607,"singlePageAnchor":607,"docTitle":19,"url":608},"27.4. Overriding the system-wide cryptographic policy on an SSH server by using the sshd RHEL system role","proc_overriding-system-wide-crypto-policy-ssh-server-system-roles_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles","#proc_overriding-system-wide-crypto-policy-ssh-server-system-roles_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles",{"title":610,"visible":15,"weight":47,"urlFragment":591,"anchor":611,"singlePageAnchor":611,"docTitle":19,"url":612},"27.5. How the ssh RHEL system role maps settings from a playbook to the configuration file","ref_ssh-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles","#ref_ssh-system-role-variables_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles",{"title":614,"visible":15,"weight":52,"urlFragment":591,"anchor":615,"singlePageAnchor":615,"docTitle":19,"url":616},"27.6. Configuring OpenSSH clients by using the ssh RHEL system role","proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles","#proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles","#configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":619,"visible":15,"weight":620,"urlFragment":621,"anchor":18,"singlePageAnchor":621,"sections":622,"docTitle":19,"url":683},"28. Managing local storage by using RHEL system roles",30,"managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[623,627,631,635,639,643,647,651,655,659,663,667,671,675,679],{"title":624,"visible":15,"weight":16,"urlFragment":621,"anchor":625,"singlePageAnchor":625,"docTitle":19,"url":626},"28.1. Creating an XFS file system on a block device by using the storage RHEL system role","an-example-ansible-playbook-to-create-an-xfs-file-system_managing-local-storage-using-rhel-system-roles","#an-example-ansible-playbook-to-create-an-xfs-file-system_managing-local-storage-using-rhel-system-roles",{"title":628,"visible":15,"weight":23,"urlFragment":621,"anchor":629,"singlePageAnchor":629,"docTitle":19,"url":630},"28.2. Persistently mounting a file system by using the storage RHEL system role","an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles","#an-example-ansible-playbook-to-persistently-mount-a-file-system_managing-local-storage-using-rhel-system-roles",{"title":632,"visible":15,"weight":28,"urlFragment":621,"anchor":633,"singlePageAnchor":633,"docTitle":19,"url":634},"28.3. Creating or resizing a logical volume by using the storage RHEL system role","creating-or-resizing-logical-volume-using-storage-system-role_managing-local-storage-using-rhel-system-roles","#creating-or-resizing-logical-volume-using-storage-system-role_managing-local-storage-using-rhel-system-roles",{"title":636,"visible":15,"weight":33,"urlFragment":621,"anchor":637,"singlePageAnchor":637,"docTitle":19,"url":638},"28.4. Enabling online block discard by using the storage RHEL system role","an-example-ansible-playbook-to-enable-online-block-discard_managing-local-storage-using-rhel-system-roles","#an-example-ansible-playbook-to-enable-online-block-discard_managing-local-storage-using-rhel-system-roles",{"title":640,"visible":15,"weight":47,"urlFragment":621,"anchor":641,"singlePageAnchor":641,"docTitle":19,"url":642},"28.5. Creating and mounting an Ext4 file system by using the storage RHEL system role","an-example-playbook-to-create-mount-an-ext4-file-system_managing-local-storage-using-rhel-system-roles","#an-example-playbook-to-create-mount-an-ext4-file-system_managing-local-storage-using-rhel-system-roles",{"title":644,"visible":15,"weight":52,"urlFragment":621,"anchor":645,"singlePageAnchor":645,"docTitle":19,"url":646},"28.6. Creating and mounting an Ext3 file system by using the storage RHEL system role","an-example-ansible-playbook-to-create-mount-ext3-file-system_managing-local-storage-using-rhel-system-roles","#an-example-ansible-playbook-to-create-mount-ext3-file-system_managing-local-storage-using-rhel-system-roles",{"title":648,"visible":15,"weight":70,"urlFragment":621,"anchor":649,"singlePageAnchor":649,"docTitle":19,"url":650},"28.7. Creating a swap volume by using the storage RHEL system role","example-ansible-playbook-to-create-a-swap-partition-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles","#example-ansible-playbook-to-create-a-swap-partition-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles",{"title":652,"visible":15,"weight":96,"urlFragment":621,"anchor":653,"singlePageAnchor":653,"docTitle":19,"url":654},"28.8. Configuring a RAID volume by using the storage RHEL system role","configuring-a-raid-volume-using-the-storage-system-role_managing-local-storage-using-rhel-system-roles","#configuring-a-raid-volume-using-the-storage-system-role_managing-local-storage-using-rhel-system-roles",{"title":656,"visible":15,"weight":106,"urlFragment":621,"anchor":657,"singlePageAnchor":657,"docTitle":19,"url":658},"28.9. Configuring an LVM pool with RAID by using the storage RHEL system role","configuring-lvm-pool-with-raid-using-storage-system-role_managing-local-storage-using-rhel-system-roles","#configuring-lvm-pool-with-raid-using-storage-system-role_managing-local-storage-using-rhel-system-roles",{"title":660,"visible":15,"weight":120,"urlFragment":621,"anchor":661,"singlePageAnchor":661,"docTitle":19,"url":662},"28.10. Configuring a stripe size for RAID LVM volumes by using the storage RHEL system role","configuring-a-stripe-size-for-raid-lvm-system-role_managing-local-storage-using-rhel-system-roles","#configuring-a-stripe-size-for-raid-lvm-system-role_managing-local-storage-using-rhel-system-roles",{"title":664,"visible":15,"weight":130,"urlFragment":621,"anchor":665,"singlePageAnchor":665,"docTitle":19,"url":666},"28.11. Configuring an LVM-VDO volume by using the storage RHEL system role","configuring-an-lvm-vdo-volume-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles","#configuring-an-lvm-vdo-volume-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles",{"title":668,"visible":15,"weight":140,"urlFragment":621,"anchor":669,"singlePageAnchor":669,"docTitle":19,"url":670},"28.12. Creating a LUKS2 encrypted volume by using the storage RHEL system role","creating-a-luks2-encrypted-volume-using-the-storage-role_managing-local-storage-using-rhel-system-roles","#creating-a-luks2-encrypted-volume-using-the-storage-role_managing-local-storage-using-rhel-system-roles",{"title":672,"visible":15,"weight":158,"urlFragment":621,"anchor":673,"singlePageAnchor":673,"docTitle":19,"url":674},"28.13. Creating shared LVM devices using the storage RHEL system role","creating-shared-lvm-devices-using-storage-system-role_managing-local-storage-using-rhel-system-roles","#creating-shared-lvm-devices-using-storage-system-role_managing-local-storage-using-rhel-system-roles",{"title":676,"visible":15,"weight":215,"urlFragment":621,"anchor":677,"singlePageAnchor":677,"docTitle":19,"url":678},"28.14. Resizing physical volumes by using the storage RHEL system role","resizing-physical-volumes-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles","#resizing-physical-volumes-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles",{"title":680,"visible":15,"weight":220,"urlFragment":621,"anchor":681,"singlePageAnchor":681,"docTitle":19,"url":682},"28.15. Creating an encrypted Stratis pool by using the storage RHEL system role","creating-an-encrypted-stratis-pool-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles","#creating-an-encrypted-stratis-pool-using-the-storage-rhel-system-role_managing-local-storage-using-rhel-system-roles","#managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":685,"visible":15,"weight":686,"urlFragment":687,"anchor":18,"singlePageAnchor":687,"sections":688,"docTitle":19,"url":701},"29. Managing systemd units by using RHEL system roles",31,"managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[689,693,697],{"title":690,"visible":15,"weight":16,"urlFragment":687,"anchor":691,"singlePageAnchor":691,"docTitle":19,"url":692},"29.1. Managing services by using the systemd RHEL system role","managing-services-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role","#managing-services-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role",{"title":694,"visible":15,"weight":23,"urlFragment":687,"anchor":695,"singlePageAnchor":695,"docTitle":19,"url":696},"29.2. Deploying systemd drop-in files by using the systemd RHEL system role","deploying-systemd-drop-in-files-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role","#deploying-systemd-drop-in-files-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role",{"title":698,"visible":15,"weight":28,"urlFragment":687,"anchor":699,"singlePageAnchor":699,"docTitle":19,"url":700},"29.3. Deploying systemd units by using the systemd RHEL system role","deploying-systemd-units-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role","#deploying-systemd-units-by-using-the-systemd-rhel-system-role_managing-systemd-units-by-using-the-systemd-rhel-system-role","#managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":703,"visible":15,"weight":704,"urlFragment":705,"anchor":18,"singlePageAnchor":705,"sections":706,"docTitle":19,"url":715},"30. Configuring time synchronization by using RHEL system roles",32,"configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",[707,711],{"title":708,"visible":15,"weight":16,"urlFragment":705,"anchor":709,"singlePageAnchor":709,"docTitle":19,"url":710},"30.1. Configuring time synchronization over NTP by using the timesync RHEL system role","configuring-time-synchronization-over-ntp-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles","#configuring-time-synchronization-over-ntp-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles",{"title":712,"visible":15,"weight":23,"urlFragment":705,"anchor":713,"singlePageAnchor":713,"docTitle":19,"url":714},"30.2. Configuring time synchronization over NTP with NTS by using the timesync RHEL system role","configuring-time-synchronization-over-ntp-with-nts-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles","#configuring-time-synchronization-over-ntp-with-nts-by-using-the-timesync-rhel-system-role_configuring-time-synchronization-using-system-roles","#configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":717,"visible":15,"weight":718,"urlFragment":719,"anchor":18,"singlePageAnchor":719,"sections":720,"docTitle":19,"url":729},"31. Configuring a system for session recording by using RHEL system roles",33,"configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",[721,725],{"title":722,"visible":15,"weight":16,"urlFragment":719,"anchor":723,"singlePageAnchor":723,"docTitle":19,"url":724},"31.1. Configuring session recording for individual users by using the tlog RHEL system role","deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles","#deploying-the-tlog-system-role_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles",{"title":726,"visible":15,"weight":23,"urlFragment":719,"anchor":727,"singlePageAnchor":727,"docTitle":19,"url":728},"31.2. Excluding certain users and groups from session recording by using the the tlog RHEL system role","deploying-the-tlog-rhel-system-role-for-excluding-lists-of-groups-or-users_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles","#deploying-the-tlog-rhel-system-role-for-excluding-lists-of-groups-or-users_configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles","#configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles",{"title":731,"visible":15,"weight":732,"urlFragment":733,"anchor":18,"singlePageAnchor":733,"sections":734,"docTitle":19,"url":743},"32. Configuring VPN connections with IPsec by using RHEL system roles",34,"assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles",[735,739],{"title":736,"visible":15,"weight":16,"urlFragment":733,"anchor":737,"singlePageAnchor":737,"docTitle":19,"url":738},"32.1. Creating a host-to-host VPN with IPsec by using the vpn RHEL system role","proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role","#proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role",{"title":740,"visible":15,"weight":23,"urlFragment":733,"anchor":741,"singlePageAnchor":741,"docTitle":19,"url":742},"32.2. Creating an opportunistic mesh VPN connection with IPsec by using the vpn RHEL system role","proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role","#proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role","#assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles",{"title":745,"visible":15,"weight":746,"urlFragment":747,"anchor":18,"singlePageAnchor":748,"docTitle":19,"url":749},"Legal Notice",35,"legal-notice","idm140064638241184","#idm140064638241184",[751,754,757],{"text":752,"link":753},"Red Hat Enterprise Linux","/documentation/red_hat_enterprise_linux/",{"text":755,"link":756},"9","/documentation/red_hat_enterprise_linux/9/",{"text":11},{"name":11,"translations":759,"productVersion":760,"singlePage":761,"pdf":764,"publishingStatus":766},[5,6,7,8,9],{"name":755},{"contentUrl":762,"name":11,"new":763,"url":19},"https://d2bhdhkti9t3uj.cloudfront.net/html/3aa9e5f3-aed2-44a8-a43e-3e0c17114a85/d84aefd2b3e6439ed22ca87709fa74a2.html","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index",{"url":765},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/pdf/automating_system_administration_by_using_rhel_system_roles/Red_Hat_Enterprise_Linux-9-Automating_system_administration_by_using_RHEL_system_roles-en-US.pdf","PUBLISHED",[768,773,776,780,784,788,792],{"name":769,"new":770,"url":771,"urlAliases":772},"10.0-Beta","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10-beta","10-beta",[],{"name":755,"new":774,"url":755,"urlAliases":775},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9",[],{"name":777,"new":778,"url":777,"urlAliases":779},"8","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8",[],{"name":781,"new":782,"url":781,"urlAliases":783},"7","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7",[],{"name":785,"new":786,"url":785,"urlAliases":787},"6","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/6",[],{"name":789,"new":790,"url":789,"urlAliases":791},"5","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/5",[],{"name":793,"new":794,"url":793,"urlAliases":795},"4","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/4",[],{"automating_system_administration_by_using_rhel_system_roles/index":797,"automating_system_administration_by_using_rhel_system_roles/proc_providing-feedback-on-red-hat-documentation_automating-system-administration-by-using-rhel-system-roles":798,"automating_system_administration_by_using_rhel_system_roles/intro-to-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":799,"automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":800,"automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles":801,"automating_system_administration_by_using_rhel_system_roles/assembly_ansible-ipmi-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles":802,"automating_system_administration_by_using_rhel_system_roles/assembly_the-redfish-modules-in-rhel_automating-system-administration-by-using-rhel-system-roles":803,"automating_system_administration_by_using_rhel_system_roles/integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":804,"automating_system_administration_by_using_rhel_system_roles/requesting-certificates-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":805,"automating_system_administration_by_using_rhel_system_roles/assembly_installing-and-configuring-web-console-with-the-cockpit-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":806,"automating_system_administration_by_using_rhel_system_roles/setting-a-custom-cryptographic-policy-by-using-the-crypto-policies-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":807,"automating_system_administration_by_using_rhel_system_roles/assembly_configuring-firewalld-using-system-roles_automating-system-administration-by-using-rhel-system-roles":808,"automating_system_administration_by_using_rhel_system_roles/configuring-a-high-availability-cluster-by-using-the-ha-cluster-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":809,"automating_system_administration_by_using_rhel_system_roles/configuring-the-systemd-journal-by-using-the-journald-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":810,"automating_system_administration_by_using_rhel_system_roles/configuring-automatic-crash-dumps-by-using-the-kdump-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":811,"automating_system_administration_by_using_rhel_system_roles/configuring-kernel-parameters-permanently-by-using-the-kernel-settings-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":812,"automating_system_administration_by_using_rhel_system_roles/configuring-the-grub-2-boot-loader-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":813,"automating_system_administration_by_using_rhel_system_roles/configuring-logging-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":814,"automating_system_administration_by_using_rhel_system_roles/monitoring-performance-by-using-the-metrics-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":815,"automating_system_administration_by_using_rhel_system_roles/assembly_configuring-microsoft-sql-server-using-microsoft-sql-server-ansible-role_automating-system-administration-by-using-rhel-system-roles":816,"automating_system_administration_by_using_rhel_system_roles/configuring-nbde-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":817,"automating_system_administration_by_using_rhel_system_roles/assembly_configuring-network-settings-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":818,"automating_system_administration_by_using_rhel_system_roles/managing-containers-by-using-the-podman-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":819,"automating_system_administration_by_using_rhel_system_roles/configuring-postfix-mta-by-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":820,"automating_system_administration_by_using_rhel_system_roles/installing-and-configuring-postgresql-by-using-the-postgresql-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":821,"automating_system_administration_by_using_rhel_system_roles/using-the-rhc-system-role-to-register-the-system_automating-system-administration-by-using-rhel-system-roles":822,"automating_system_administration_by_using_rhel_system_roles/configuring-selinux-using-system-roles_automating-system-administration-by-using-rhel-system-roles":823,"automating_system_administration_by_using_rhel_system_roles/restricting-the-execution-of-applications-by-using-the-fapolicyd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":824,"automating_system_administration_by_using_rhel_system_roles/configuring-secure-communication-by-using-the-ssh-and-sshd-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":825,"automating_system_administration_by_using_rhel_system_roles/managing-local-storage-using-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":826,"automating_system_administration_by_using_rhel_system_roles/managing-systemd-units-by-using-the-systemd-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":827,"automating_system_administration_by_using_rhel_system_roles/configuring-time-synchronization-by-using-the-timesync-rhel-system-role_automating-system-administration-by-using-rhel-system-roles":828,"automating_system_administration_by_using_rhel_system_roles/configuring-a-system-for-session-recording-using-the-tlog-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles":829,"automating_system_administration_by_using_rhel_system_roles/assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_automating-system-administration-by-using-rhel-system-roles":830,"automating_system_administration_by_using_rhel_system_roles/legal-notice":831},{"prevt":18,"next":24},{"prevt":17,"next":29},{"prevt":24,"next":34},{"prevt":18,"next":34},{"prevt":34,"next":53},{"prevt":18,"next":53},{"prevt":18,"next":71},{"prevt":18,"next":18},{"prevt":18,"next":107},{"prevt":18,"next":18},{"prevt":18,"next":18},{"prevt":18,"next":141},{"prevt":18,"next":159},{"prevt":18,"next":18},{"prevt":18,"next":18},{"prevt":18,"next":18},{"prevt":18,"next":273},{"prevt":18,"next":295},{"prevt":18,"next":335},{"prevt":18,"next":357},{"prevt":18,"next":379},{"prevt":18,"next":397},{"prevt":18,"next":471},{"prevt":18,"next":18},{"prevt":18,"next":499},{"prevt":18,"next":513},{"prevt":18,"next":563},{"prevt":18,"next":18},{"prevt":18,"next":591},{"prevt":18,"next":621},{"prevt":18,"next":687},{"prevt":18,"next":705},{"prevt":18,"next":719},{"prevt":18,"next":733},{"prevt":733,"next":18},{"product":18,"version":18},{"automating_system_administration_by_using_rhel_system_roles":834},[763],{"products":836},[837,838,839,840,841,842,843,844,845,846,847,848,849],"builds_for_red_hat_openshift","migration_toolkit_for_virtualization","openshift_container_platform","openshift_sandboxed_containers","red_hat_advanced_cluster_security_for_kubernetes","red_hat_advanced_cluster_management_for_kubernetes","red_hat_openshift_data_foundation","red_hat_openshift_dev_spaces","red_hat_openshift_gitops","red_hat_openshift_local","red_hat_openshift_pipelines","red_hat_openshift_serverless","workload_availability_for_red_hat_openshift",[],{"default":852},[853,862,868,877,885,893,900,908,915],{"nid":854,"type":855,"langcode":856,"Published":16,"title":857,"Created":858,"Updated":859,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":860,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":861},580,"rebrand banner","en","OpenShift Container Storage is now OpenShift Data Foundation starting with version 4.9.","2023-01-11 15:38:32","2023-01-11 15:40:04","/documentation/red_hat_openshift_container_storage\r\n/documentation/red_hat_openshift_container_storage/\r\n/documentation/red_hat_openshift_container_storage/*","internal:/documentation/red_hat_openshift_data_foundation/",{"nid":863,"type":855,"langcode":856,"Published":16,"title":857,"Created":864,"Updated":865,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":866,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":867},581,"2023-01-11 15:41:31","2023-01-11 15:42:04","/documentation/red_hat_openshift_data_foundation/4.9\r\n/documentation/red_hat_openshift_data_foundation/4.9/\r\n/documentation/red_hat_openshift_data_foundation/4.9/*\r\n/documentation/red_hat_openshift_data_foundation/4.10\r\n/documentation/red_hat_openshift_data_foundation/4.10/\r\n/documentation/red_hat_openshift_data_foundation/4.10/*\r\n/documentation/red_hat_openshift_data_foundation/4.11\r\n/documentation/red_hat_openshift_data_foundation/4.11/\r\n/documentation/red_hat_openshift_data_foundation/4.11/*","internal:/documentation/red_hat_openshift_container_storage/",{"nid":869,"type":870,"langcode":856,"Published":16,"title":871,"Created":872,"Updated":873,"body_value":18,"field_documentation banner_text_value":874,"field_documentation banner_text_format":875,"field_paths_value":876,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},582,"developer preview banner","MicroShift is Developer Preview software only","2023-01-11 15:50:24","2023-01-30 19:00:52","\u003Cp slot=header>MicroShift is Developer Preview software only.\u003C/p>For more information about the support scope of Red Hat Developer Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/devpreview/\">Developer Preview Support Scope\u003C/a>.","documentation banner","/documentation/microshift/4.12\r\n/documentation/microshift/4.12/*\r\n/documentation/red_hat_build_of_microshift/4.12\r\n/documentation/red_hat_build_of_microshift/4.12/*",{"nid":878,"type":879,"langcode":856,"Published":16,"title":880,"Created":881,"Updated":882,"body_value":18,"field_documentation banner_text_value":883,"field_documentation banner_text_format":875,"field_paths_value":884,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},583,"obsolete documentation banner","RHACS EOL - DAT-3433","2023-01-23 16:36:43","2023-01-23 16:39:14","\u003Cp slot=header>You are viewing documentation for a release that is no longer maintained. To view the documentation for the most recent version, see the \u003Ca href=\"/documentation/red_hat_advanced_cluster_security_for_kubernetes/\">latest RHACS docs\u003C/a>.\u003C/p>","/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71/*",{"nid":886,"type":887,"langcode":856,"Published":16,"title":888,"Created":889,"Updated":890,"body_value":18,"field_documentation banner_text_value":891,"field_documentation banner_text_format":875,"field_paths_value":892,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},584,"end of life banner","EOL banner for RHV","2023-05-23 14:58:05","2023-05-24 15:19:42","\u003Cp slot=header>The Red Hat Virtualization\u003C/p>Maintenance Phase runs until August 31, 2024, followed by the Extended Life Phase with no more software fixes through August 31, 2026. See \u003Ca href=\"https://access.redhat.com/articles/6975303\">Migration Paths for OpenShift Container Platform deployed on Red Hat Virtualization\u003C/a> for details.","/documentation/red_hat_virtualization/4.4",{"nid":894,"type":887,"langcode":856,"Published":16,"title":895,"Created":896,"Updated":897,"body_value":18,"field_documentation banner_text_value":898,"field_documentation banner_text_format":875,"field_paths_value":899,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},585,"RHHI-V EOL","2023-06-01 16:52:57","2023-06-01 17:03:44","\u003Cp slot=header>Red Hat Hyperconverged Infrastructure for Virtualization\u003C/p> is in the \u003Ca href=\"https://access.redhat.com/support/policy/updates/rhhiv\">Maintenance Support Phase\u003C/a> of its lifecycle until October 31, 2024. After that date, the product will be End of Life. See the \u003Ca href=\"https://access.redhat.com/announcements/6972521\">RHHI-V announcement\u003C/a> for next steps.","/documentation/red_hat_hyperconverged_infrastructure_for_virtualization/1.8",{"nid":901,"type":902,"langcode":856,"Published":16,"title":903,"Created":904,"Updated":905,"body_value":18,"field_documentation banner_text_value":906,"field_documentation banner_text_format":875,"field_paths_value":907,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},586,"preview banner","MicroShift is Technology Preview software only","2024-03-18 16:53:05","2024-03-18 16:54:56","\u003Cp slot=header>MicroShift is Technology Preview software only.\u003C/p>For more information about the support scope of Red Hat Technology Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/techpreview/\">Technology Preview Support Scope\u003C/a>.","/documentation/red_hat_build_of_microshift/4.13\r\n/documentation/red_hat_build_of_microshift/4.13/*",{"nid":909,"type":902,"langcode":856,"Published":16,"title":910,"Created":911,"Updated":912,"body_value":18,"field_documentation banner_text_value":913,"field_documentation banner_text_format":875,"field_paths_value":914,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},588,"Ansible 2.5 upgrade limitation","2024-09-30 16:53:05","2024-10-28 16:54:56","\u003Cp slot=\"header\">Support added for upgrades from 2.4\u003C/p>Ansible Automation Platform 2.5-3, released on October 28, 2024, adds support for upgrades from 2.4. See the upgrade documentation for more information.","",{"nid":916,"alertType":917,"type":918,"langcode":856,"Published":16,"title":919,"Created":914,"Updated":914,"body_value":18,"field_documentation banner_text_value":920,"field_documentation banner_text_format":875,"field_paths_value":921,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},587,"warning","Warning banner","Red Hat build of Apache Camel K","\u003Cp slot=header>Red Hat Camel K is deprecated\u003C/p>Red Hat Camel K is deprecated and the End of Life date for this product is June 30, 2025. For help migrating to the current go-to solution, \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel\">Red Hat build of Apache Camel\u003C/a>, see the \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel_k/1.10.7/html/migration_guide_camel_k_to_camel_extensions_for_quarkus/index\">Migration Guide\u003C/a>.","/documentation/red_hat_build_of_apache_camel_k/*",{"product":752},["Reactive",924],{"$snuxt-i18n-meta":925,"$sisLoading":926,"$sisSinglePage":15,"$sisInFocusMode":926,"$smobileTocOpen":926,"$sisLargeTOC":926,"$scurrentChapter":17,"$scurrentSection":17,"$scurrentSubSection":914},{},false,["Set"],["ShallowReactive",929],{"s8LoCEfG4A":18,"rFVLKcOK8e":18,"uUstF4AIyn":18,"MdHNSZP4nR":18,"Pn02PlJOas":18},"/en/documentation/red_hat_enterprise_linux/9/html-single/automating_system_administration_by_using_rhel_system_roles/index"]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{contentEnv:"",collectFeedback:true,i18n:{baseUrl:"",defaultLocale:"en",defaultDirection:"ltr",strategy:"prefix",lazy:false,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:false,differentDomains:false,trailingSlash:false,configLocales:[{code:"en",name:"English",iso:"en-US"},{code:"fr",name:"Français",iso:"fr-FR"},{code:"ko",name:"한국어",iso:"ko-KR"},{code:"ja",name:"日本語",iso:"ja-JP"},{code:"zh-cn",name:"中文 (中国)",iso:"zh-CN"},{code:"de",name:"Deutsch",iso:"de_DE"},{code:"it",name:"Italiano",iso:"it_IT"},{code:"pt-br",name:"Português",iso:"pt_BR"},{code:"es",name:"Español",iso:"es-ES"}],locales:{en:{domain:""},fr:{domain:""},ko:{domain:""},ja:{domain:""},"zh-cn":{domain:""},de:{domain:""},it:{domain:""},"pt-br":{domain:""},es:{domain:""}},detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",switchLocalePathLinkSSR:false,autoImportTranslationFunctions:false}}},app:{baseURL:"/",buildId:"5ff82c51-785e-4a7d-aca6-77d6692e8c7a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>
