<!DOCTYPE html><html  data-capo=""><head><script type="importmap">
  {
    "imports": {
      "@patternfly/elements/": "/scripts/v1/@patternfly/elements/",
      "@patternfly/pfe-clipboard/": "/scripts/v1/@patternfly/pfe-clipboard/",
      "@rhds/elements/": "/scripts/v1/@rhds/elements/elements/",
      "@cpelements/elements/": "/scripts/v1/@cpelements/elements/elements/"
    },
    "scopes": {
      "/": {
        "@floating-ui/core": "/scripts/v1/@floating-ui/core/dist/floating-ui.core.mjs",
        "@floating-ui/dom": "/scripts/v1/@floating-ui/dom/dist/floating-ui.dom.mjs",
        "@floating-ui/utils": "/scripts/v1/@floating-ui/utils/dist/floating-ui.utils.mjs",
        "@floating-ui/utils/dom": "/scripts/v1/@floating-ui/utils/dom/dist/floating-ui.utils.dom.mjs",
        "@lit/reactive-element": "/scripts/v1/@lit/reactive-element/reactive-element.js",
        "@lit/reactive-element/decorators/": "/scripts/v1/@lit/reactive-element/decorators/",
        "@patternfly/pfe-core": "/scripts/v1/@patternfly/pfe-core/core.js",
        "@patternfly/pfe-core/": "/scripts/v1/@patternfly/pfe-core/",
        "@rhds/tokens/media.js": "/scripts/v1/@rhds/tokens/js/media.js",
        "lit": "/scripts/v1/lit/index.js",
        "lit-element/lit-element.js": "/scripts/v1/lit-element/lit-element.js",
        "lit-html": "/scripts/v1/lit-html/lit-html.js",
        "lit-html/": "/scripts/v1/lit-html/",
        "lit/": "/scripts/v1/lit/",
        "tslib": "/scripts/v1/tslib/tslib.es6.mjs",
        "@cpelements/rh-table/dist/rh-table.js": "/scripts/v1/@cpelements/rh-table/dist/rh-table.js"
      }
    }
  }
</script><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Securing networks | Red Hat Product Documentation</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<script type="text/javascript" id="trustarc" src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
<script src="//www.redhat.com/dtm.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@400;500;700&family=Red+Hat+Text:wght@400;500;700&display=swap">
<link rel="stylesheet" href="/styles/rh-table--lightdom.min.css">
<style>.section .titlepage{gap:.75rem}.section .titlepage,div.edit{align-items:center;display:flex}div.edit{font-size:.9rem;margin-bottom:8px}div.edit>a{align-items:center;display:flex}.edit pf-icon{margin-right:4px}</style>
<style>#error[data-v-df31ff14]{align-items:center;display:flex;flex-direction:column;justify-content:center;min-height:80vh}h1[data-v-df31ff14]{font-size:calc(var(--rh-font-size-body-text-md, 1rem)*4);font-weight:700;margin-bottom:0}h1[data-v-df31ff14],h1 span[data-v-df31ff14]{line-height:var(--rh-line-height-heading,1.3)}h1 span[data-v-df31ff14]{color:var(--rh-color-text-brand-on-light,#e00);display:block;text-transform:uppercase}h1 span[data-v-df31ff14],p[data-v-df31ff14]{font-size:var(--rh-font-size-body-text-lg,1.125rem)}aside[data-v-df31ff14]{align-items:center;background:var(--rh-color-surface-lightest,#fff);border:var(--rh-border-width-sm,1px) solid var(--rh-color-border-subtle-on-light,#c7c7c7);border-radius:var(--rh-border-radius-default,3px);border-top:calc(var(--rh-border-width-md, 2px)*2) solid var(--rh-color-text-brand-on-light,#e00);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2));display:flex;flex-direction:column;justify-content:space-between;margin-top:var(--rh-space-2xl,32px);padding:var(--rh-space-xl,24px)}aside[data-v-df31ff14],aside>div[data-v-df31ff14]{width:100%}.text-container[data-v-df31ff14]{margin:auto;max-width:442px;text-align:center}.desktop[data-v-df31ff14]{display:none}.sr-only[data-v-df31ff14]{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;clip-path:inset(50%);white-space:nowrap}form[data-v-df31ff14]{display:flex}button[data-v-df31ff14],input[data-v-df31ff14]{border:1px solid var(--rh-color-black-500,#8a8d90);box-sizing:border-box;height:40px}input[data-v-df31ff14]{border-right:none;flex:1;font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);padding-left:var(--rh-space-md,8px);width:100%}button[data-v-df31ff14]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border-left:none;display:flex;width:var(--rh-size-icon-04,40px)}button[data-v-df31ff14]:before{background:var(--rh-context-light-color-text-link,#06c);content:"";cursor:pointer;display:block;height:28px;margin:auto;width:28px}.search-icon[data-v-df31ff14]{margin:auto}ul[data-v-df31ff14]{max-width:275px;padding:0}ul li[data-v-df31ff14]{display:inline-block;list-style:none;margin-right:var(--rh-space-xl,24px);padding:var(--rh-space-xs,4px) 0}ul li a[data-v-df31ff14]{color:var(--rh-context-light-color-text-link,#06c);text-decoration:none}@media (min-width:992px){aside[data-v-df31ff14]{flex-direction:row}.mobile[data-v-df31ff14]{display:none}.desktop[data-v-df31ff14]{display:block}input[data-v-df31ff14]{width:auto}}</style>
<style>@keyframes fade-in{0%{opacity:0;visibility:hidden}1%{visibility:visible}to{opacity:1;visibility:visible}}@media (min-height:48em){.rhdocs{--rh-table--maxHeight:calc(100vh - 12.5rem)}}*,.rhdocs *,.rhdocs :after,.rhdocs :before,:after,:before{box-sizing:border-box}.rhdocs img,.rhdocs object,.rhdocs svg,img,object,svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs hr{border:0;border-top:.0625rem solid #d2d2d2;clear:both;margin:1rem 0}.rhdocs a{color:#06c;text-decoration:underline}.rhdocs a:focus,.rhdocs a:hover{color:#036}.rhdocs a.anchor-heading{color:#151515;cursor:pointer;text-decoration:none;word-break:break-all}.rhdocs p{margin:1.49963rem 0}.rhdocs li>p{margin:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:500;margin:0 0 .625rem}.rhdocs h1{font-size:2.25rem;margin:2rem 0}.rhdocs h2{font-size:1.625rem;margin:2rem 0}.rhdocs h3{font-size:1.5rem;font-weight:400}.rhdocs h4,.rhdocs h5{font-size:1.25rem}.rhdocs h5{font-weight:400}.rhdocs h6{font-size:1.125rem;font-weight:500;line-height:1.6667}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ol ::marker,.rhdocs ul ::marker{font:inherit}.rhdocs li{margin:0 0 .5em;padding:0}.rhdocs li>p{margin:.5rem 0}.rhdocs li>ol,.rhdocs li>ul{margin:0}.rhdocs dl dd{margin:.5rem 0 .5rem 1rem}.rhdocs dl dd>p{margin:.5rem 0}.rhdocs .informaltable,.rhdocs .table-contents,.rhdocs .table-wrapper{max-height:var(--rh-table--maxHeight);overflow:auto}.rhdocs table{border:0;font-size:1rem;line-height:1.6667;table-layout:fixed}.rhdocs table caption{color:#585858;margin-bottom:.5rem;margin-top:.5rem;text-align:left}.rhdocs table td,.rhdocs table th{border:0;border-bottom:.0625rem solid #d2d2d2;border-bottom:.0625rem solid var(--pfe-table--Border,#d2d2d2);padding:.5em 1rem}.rhdocs table td.halign-left,.rhdocs table th.halign-left{text-align:left}.rhdocs table td.halign-center,.rhdocs table th.halign-center,table td.halign-center,table th.halign-center{text-align:center}.rhdocs table td.halign-right,.rhdocs table th.halign-right{text-align:right}.rhdocs table td.valign-top,.rhdocs table th.valign-top{vertical-align:top}.rhdocs table td.valign-middle,.rhdocs table th.valign-middle{vertical-align:middle}.rhdocs table td.valign-bottom,.rhdocs table th.valign-bottom{vertical-align:bottom}.rhdocs table thead td,.rhdocs table thead th{background:#f5f5f5;font-weight:600}.rhdocs rh-table table,.rhdocs rh-table.rh-table--expanded-vertically{max-height:-moz-max-content;max-height:max-content}.rhdocs pre.nowrap{overflow:auto;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs .codeblock__wrapper pre{background:transparent}.rh-table--full-screen code,.rhdocs .content--md code,.rhdocs .content--sm code,.rhdocs .rh-table--full-screen code{overflow-wrap:normal;word-break:normal}.rhdocs[class] pre code,[class] pre code{background:inherit;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.rhdocs .keycap,.rhdocs kbd{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.keycap strong,.rhdocs .keycap strong{font-weight:inherit}.rhdocs kbd.keyseq,kbd.keyseq{background:transparent;border:0;box-shadow:none;padding:0}.rhdocs kbd.keyseq kbd,kbd.keyseq kbd{display:inline-block;margin:0 .375rem}.rhdocs kbd.keyseq kbd:first-child,kbd.keyseq kbd:first-child{margin-left:0}.rhdocs b.button{font-size:90%;font-weight:700;padding:.1875rem}.rhdocs b.button:before{content:"["}.rhdocs b.button:after{content:"]"}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}.rhdocs audio,.rhdocs canvas,.rhdocs progress,.rhdocs video{display:inline-block;vertical-align:baseline}.rhdocs audio:not([controls]){display:none;height:0}[hidden],template{display:none}.rhdocs a{background:transparent}.rhdocs a:active,.rhdocs a:hover{outline:0}.rhdocs a.anchor-heading:hover:before{color:#151515;content:"#";margin-left:-1.6rem;position:absolute}.rhdocs a.anchor-heading:focus-visible{color:#151515}@media screen and (max-width:990px){.rhdocs a.anchor-heading:hover:before{font-size:16px;margin-left:-1rem;padding-top:8px}.rhdocs h1 a.anchor-heading:hover:before{padding-top:12px}.rhdocs h4 a.anchor-heading:hover:before,.rhdocs h5 a.anchor-heading:hover:before{padding-top:4px}.rhdocs h6 a.anchor-heading:hover:before{padding-top:2px}}.rhdocs abbr[title]{border-bottom:.0625rem dotted}.rhdocs dfn{font-style:italic}.rhdocs h1{font-size:2em;margin:.67em 0}.rhdocs mark{background:#ff0;color:#000}.rhdocs small{font-size:80%}.rhdocs sub,.rhdocs sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.rhdocs sup{top:-.5em}.rhdocs sub{bottom:-.25em}.rhdocs img{border:0}.rhdocs svg:not(:root){overflow:hidden}.rhdocs figure{margin:1em 2.5rem}.rhdocs hr{box-sizing:content-box;height:0}.rhdocs code,.rhdocs kbd,.rhdocs pre,.rhdocs samp{font-family:monospace,monospace;font-size:1em}.rhdocs button,.rhdocs optgroup,.rhdocs select,.rhdocs textarea,.rhdocsinput{color:inherit;font:inherit;margin:0}.rhdocs button.copy-link-btn{background:none;border:2px solid #fff;font:1px Red Hat Text}.rhdocs button.copy-link-btn:hover{border-bottom:2px solid #06c}.rhdocs button.copy-link-btn .link-icon{padding-bottom:4px}.rhdocs button{overflow:visible}.rhdocs button,.rhdocs select{text-transform:none}.rhdocs button,.rhdocs html input[type=button],.rhdocs input[type=reset],.rhdocs input[type=submit]{-moz-appearance:button;appearance:button;-webkit-appearance:button;cursor:pointer}.rhdocs button[disabled],.rhdocs html input[disabled]{cursor:default}.rhdocs button::-moz-focus-inner,.rhdocs input::-moz-focus-inner{border:0;padding:0}.rhdocs input{line-height:normal}.rhdocs input[type=checkbox],.rhdocs input[type=radio]{box-sizing:border-box;padding:0}.rhdocs input[type=number]::-webkit-inner-spin-button,.rhdocs input[type=number]::-webkit-outer-spin-button{height:auto}.rhdocs input[type=search]{-moz-appearance:textfield;appearance:textfield;-webkit-appearance:textfield;box-sizing:content-box}.rhdocs input[type=search]::-webkit-search-cancel-button,.rhdocs input[type=search]::-webkit-search-decoration{-webkit-appearance:none}.rhdocs fieldset{border:.0625rem solid silver;margin:0 .125rem;padding:.35em .625em .75em}.rhdocs legend{border:0;padding:0}.rhdocs textarea{overflow:auto}.rhdocs optgroup{font-weight:700}.rhdocs table{border-collapse:collapse;border-spacing:0}.rhdocs td,.rhdocs th{padding:0}.rhdocs ._additional-resources[class][class][id]:last-child{margin-top:-2rem}.rhdocs ._additional-resources[class][class]:only-child{grid-column:1/-1}._additional-resources[class][class] .additional-resources__heading,._additional-resources[class][class] .heading,._additional-resources[class][class] h1,._additional-resources[class][class] h2,._additional-resources[class][class] h3,._additional-resources[class][class] h4,._additional-resources[class][class] h5,._additional-resources[class][class] h6,._additional-resources[class][class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper ._additional-resources[class][class] ul{display:block}._additional-resources[class][class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}._additional-resources[class][class] li:only-child{grid-column:1/-1}._additional-resources[class][class] li:last-child{border:0}@media (min-width:1100px){._additional-resources[class][class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}._additional-resources[class][class] li p:only-child{margin:0;padding:0}._additional-resources[class][class] li a{text-decoration:none}._additional-resources[class][class] li a:focus,._additional-resources[class][class] li a:hover{text-decoration:underline}.rhdocs table .admonitionblock>div:nth-child(2),.rhdocs table .caution>div:nth-child(2),.rhdocs table .important>div:nth-child(2),.rhdocs table .note>div:nth-child(2),.rhdocs table .tip>div:nth-child(2),.rhdocs table .warning>div:nth-child(2){margin:.5rem 0}.rhdocs table .admonitionblock>div:nth-child(2)>:first-child,.rhdocs table .caution>div:nth-child(2)>:first-child,.rhdocs table .important>div:nth-child(2)>:first-child,.rhdocs table .note>div:nth-child(2)>:first-child,.rhdocs table .tip>div:nth-child(2)>:first-child,.rhdocs table .warning>div:nth-child(2)>:first-child{margin-top:0}.rhdocs table .admonitionblock>div:nth-child(2)>:last-child,.rhdocs table .caution>div:nth-child(2)>:last-child,.rhdocs table .important>div:nth-child(2)>:last-child,.rhdocs table .note>div:nth-child(2)>:last-child,.rhdocs table .tip>div:nth-child(2)>:last-child,.rhdocs table .warning>div:nth-child(2)>:last-child{margin-bottom:0}.rhdocs .codeblock__wrapper+.codeblock__wrapper,.rhdocs pre+pre,.rhdocs pre[class]+pre[class]{margin-top:2rem}.rhdocs .codeblock__wrapper{background:#f8f8f8;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__wrapper:before{background-repeat:no-repeat;background-size:6.25rem 100%;bottom:var(--scrollbar__height,1px);content:"";display:block;height:7.125rem;max-height:100%;max-height:calc(100% - var(--scrollbar__height, 2px));position:absolute;right:var(--scrollbar__width,6px);top:.0625rem;width:4.0625rem;z-index:1}.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 6.25rem)}@media (min-height:48em){.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 12.5rem)}}.rhdocs .codeblock__inner-wrapper{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs .codeblock__wrapper--expanded .codeblock__inner-wrapper{max-height:-moz-max-content;max-height:max-content}.codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.codeblock__copy:focus{outline:.0625rem dashed currentcolor}.codeblock__copy svg#icon--copy{height:1rem;width:1rem}.codeblock__expand{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;border:0;cursor:pointer;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));position:absolute;text-indent:-9999em;top:3.25rem;width:1.75rem;z-index:2}.codeblock__expand:before{background:#6a6e73;content:"";height:100%;left:0;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:auto 1rem;mask-size:auto 1rem;position:absolute;top:0;width:100%}.codeblock__wrapper--expanded .codeblock__expand{background:#2b9af3}.codeblock__wrapper--expanded .codeblock__expand:before{background:#fff}.codeblock__expand:focus:before,.codeblock__expand:hover:before{background:#06c}.codeblock__wrapper--expanded .codeblock__expand:focus:before,.codeblock__wrapper--expanded .codeblock__expand:hover:before{background:#fff}.codeblock__expand:focus{outline:.0625rem dashed currentcolor}.rhdocs .calloutlist>ol,.rhdocs .colist>ol{counter-reset:colist;list-style:none;margin:1rem 0 2rem;padding:0}.rhdocs .calloutlist>ol>li,.rhdocs .colist>ol>li{counter-increment:colist;font-size:1rem;margin:.5rem 0;padding-left:1.75rem;position:relative}.rhdocs .calloutlist>ol>li .colist-num,.rhdocs .colist>ol>li .colist-num{display:none}.calloutlist>ol>li:before,.colist>ol>li:before{content:counter(colist);left:0;position:absolute;top:.1875rem}.calloutlist dt{clear:left;float:left;margin:0;padding:0 .5rem 0 0}.included-in-guides[class],.included-in-guides[class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.included-in-guides[class][id]:last-child{margin-top:-2rem}.included-in-guides[class]:only-child{grid-column:1/-1}.included-in-guides[class] .additional-resources__heading,.included-in-guides[class] .heading,.included-in-guides[class] h1,.included-in-guides[class] h2,.included-in-guides[class] h3,.included-in-guides[class] h4,.included-in-guides[class] h5,.included-in-guides[class] h6,.included-in-guides[class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.included-in-guides[class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper .included-in-guides[class] ul{display:block}.included-in-guides[class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}.included-in-guides[class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.included-in-guides[class] li:only-child{grid-column:1/-1}.included-in-guides[class] li:last-child{border:0}@media (min-width:1100px){.included-in-guides[class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}.included-in-guides[class] li p:only-child{margin:0;padding:0}.included-in-guides[class] li a{text-decoration:none}.included-in-guides[class] li a:focus,.included-in-guides[class] li a:hover{text-decoration:underline}.menuseq{display:inline-flex;overflow:hidden;text-indent:-9999em}.menuseq .menu,.menuseq .menuitem,.menuseq .submenu{display:block;position:relative;text-indent:0}.menuseq .menu+.menu:before,.menuseq .menu+.menuitem:before,.menuseq .menu+.submenu:before,.menuseq .menuitem+.menu:before,.menuseq .menuitem+.menuitem:before,.menuseq .menuitem+.submenu:before,.menuseq .submenu+.menu:before,.menuseq .submenu+.menuitem:before,.menuseq .submenu+.submenu:before{content:">";display:inline-block;font-weight:700;padding:0 .25em}.related-topic-content__wrapper{margin:2em 0}.related-topic-content__wrapper--for-guide{margin-bottom:-2.5rem;padding-bottom:.0625rem;position:relative;z-index:1}.related-topic-content__wrapper--for-guide:before{background:#f0f0f0;content:"";display:block;height:100%;left:-3rem;position:absolute;right:-4.5rem;top:0;width:auto;z-index:-1}@media (min-width:1100px){.related-topic-content__wrapper--for-guide:before{left:-2.5rem;right:-3.625rem}}.related-topic-content__wrapper--for-guide summary{padding:1em 2em 1em 2.1875rem}@media (min-width:950px){.related-topic-content__inner-wrapper{display:grid;gap:2em;grid-template-columns:repeat(2,minmax(0,1fr))}}.local-render .rhdocs-content{margin:0 auto}.rhdocs cp-documentation{display:block;padding-bottom:2.5rem}.rhdocs cp-documentation.PFElement,.rhdocs cp-documentation[pfelement]{padding:0}rh-table{display:block}::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar{height:.625rem;width:.625rem}::-webkit-scrollbar,::-webkit-scrollbar-track,:host .rhdocs ::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar-track{background-color:#d6d6d6}::-webkit-scrollbar-thumb,:host .rhdocs ::-webkit-scrollbar-thumb{background-color:#8e8e8e}*,:host .rhdocs *{scrollbar-color:#8e8e8e #d6d6d6}.rhdocs p:empty,p:empty{display:none}.rhdocs[class] h1 code,.rhdocs[class] h2 code,.rhdocs[class] h3 code,.rhdocs[class] h4 code,.rhdocs[class] h5 code,.rhdocs[class] h6 code,[class] h1 code,[class] h2 code,[class] h3 code,[class] h4 code,[class] h5 code,[class] h6 code{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.pane-page-title h1,.rhdocs__header__primary-wrapper h1{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:2.25rem;line-height:1.333}.rhdocs details[class]{list-style:none;margin:1rem 0 3rem;padding:0}.rhdocs-toc[class]{background:#f2f2f2;margin:1rem 0 2rem;padding:1rem}.rhdocs-toc[class]>:last-child{margin-bottom:0}.rhdocs-toc[class] .rhdocs-toctitle{font-size:1.25rem;font-weight:400;line-height:1.6667;margin-top:0;text-transform:none}.rhdocs-toc[class] li{margin-bottom:.25em;padding-left:.5em}.preamble{margin:0 0 2rem}.sect1{margin:2rem 0 1rem}:host .sect1,cp-documentation .sect1{margin:0 0 2rem;padding:.0625rem 0 0}:host(.cp-documentation--has-external-header) .sect1:first-child>h2:first-child,:host(.cp-documentation--has-external-header) .sect1:first-child>h3:first-child{margin-top:0}.listingblock,.literalblock{margin:1rem 0}.quoteblock,.verseblock{border-left:.25rem solid #d2d2d2;margin:1rem 0;padding:1rem 1rem 1rem 2rem}.quoteblock.pullleft,.verseblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.quoteblock.pullleft,.verseblock.pullleft{margin-left:-1rem}}.quoteblock.pullright,.verseblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.quoteblock.pullright,.verseblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.quoteblock.pullright,.verseblock.pullright{margin-right:-10rem}}.quoteblock>:first-child,.verseblock>:first-child{margin-top:0}.quoteblock .content,.verseblock .content{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.25rem;line-height:1.6667}.quoteblock .attribution,.verseblock .attribution{font-size:.875rem;font-style:italic;font-weight:600;line-height:1.6667;text-transform:uppercase}.quoteblock .attribution .citetitle,.verseblock .attribution .citetitle{color:#585858}.quoteblock .attribution cite,.verseblock .attribution cite{font-size:1em}.quoteblock blockquote{font-style:italic;margin:0;padding:0}.quoteblock blockquote .content>:first-child{margin-top:0}.quoteblock blockquote .content>:first-child:before{color:#e00;content:"â€œ";display:block;float:left;font-size:2.75rem;font-style:normal;line-height:1.125em;margin-right:.5rem}.quoteblock blockquote .content>:first-child .content>:first-child:before{content:none}.imageblock{margin:1rem 0}.imageblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.imageblock.pullleft{margin-left:-1rem}}.imageblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.imageblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.imageblock.pullright{margin-right:-10rem}}.imageblock.interrupter{margin:2rem 0}@media (min-width:768px){.imageblock.interrupter{margin-left:-1rem;margin-right:-2rem}.imageblock.interrupter .caption{margin-left:1rem;margin-right:2rem}}@media (min-width:1100px){.imageblock.interrupter{margin-right:-10rem}.imageblock.interrupter .caption{margin-right:10rem}}.imageblock.interrupter img{max-width:100%}.imageblock .caption{color:#585858;display:block;font-size:.875rem;line-height:1.6667;margin:.5rem 0 0}.rhdocs-footnotes{border-top:.0625rem solid #d2d2d2;margin:3rem 0 1rem;padding:1rem 0 0}.rhdocs-footnotes>ol{margin:0;padding:0 0 0 1.5rem}@supports (counter-reset:footnotenum){.rhdocs-footnotes>ol{counter-reset:footnotenum;list-style:none;padding:0}.rhdocs-footnotes>ol>li{counter-increment:footnotenum}.rhdocs-footnotes>ol>li:before{color:#585858;content:"[" counter(footnotenum) "]";display:inline-block;margin-right:.25rem}}.rhdocs-footer{background:#ededed;color:#151515;font-size:.875rem;line-height:1.6667;margin:3rem 0 0;padding:1rem}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.visually-hidden{overflow:hidden;position:absolute;clip:rect(0,0,0,0);border:0;height:.0625rem;margin:-.0625rem;padding:0;width:.0625rem}.rh-docs-legal-notice{margin-top:4em}pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}code.language-none,code.language-text,code.language-txt,pre.language-none,pre.language-text,pre.language-txt{color:#151515}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#cceae7;color:#263238}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#cceae7;color:#263238}:not(pre)>code[class*=language-]{border-radius:.2em;padding:.1em;white-space:normal}.token.atrule{color:#40199a}.token.attr-name{color:#06c}.token.attr-value,.token.attribute{color:#b300b3}.token.boolean{color:#40199a}.token.builtin,.token.cdata,.token.char,.token.class,.token.class-name{color:#06c}.token.comment{color:#6a6e73}.token.constant{color:#40199a}.token.deleted{color:#c9190b}.token.doctype{color:#6a6e73}.token.entity{color:#c9190b}.token.function{color:#40199a}.token.hexcode{color:#b300b3}.token.id,.token.important{color:#40199a;font-weight:700}.token.inserted{color:#06c}.token.keyword{color:#40199a}.token.number{color:#b300b3}.token.operator{color:#06c}.token.prolog{color:#6a6e73}.token.property{color:#06c}.token.pseudo-class,.token.pseudo-element{color:#b300b3}.token.punctuation,.token.regex{color:#06c}.token.selector{color:#c9190b}.token.string{color:#b300b3}.token.symbol{color:#40199a}.token.unit{color:#b300b3}.token.url,.token.variable{color:#c9190b}.rhdocs.local-render{margin:0 auto;max-width:45.8125rem;padding:0 1.5rem}@media print{.field code,.field pre,code[class*=language-],pre,pre[class*=language-]{white-space:pre-wrap!important;word-wrap:break-word!important;overflow-wrap:break-word!important;word-break:break-word!important}}.book-nav__list[class]{display:flex;justify-content:space-between;line-height:var(--jupiter__lineHeight--xs,1.3333);list-style:none;margin:5rem 0 0;padding:0}@media (min-width:1200px){.book-nav__list[class]{display:grid;gap:2rem;grid-template-columns:repeat(2,minmax(0,1fr))}}.book-nav__item a{display:inline-block;font-size:.875rem;font-weight:500;padding-left:1.25rem;position:relative;text-transform:uppercase}.book-nav__item a:before{background:url(/sites/dxp-docs/penumbra-dist/jupiter/images/arrow-down-solid.svg) no-repeat;background-size:contain;content:"";display:block;height:.875rem;left:0;position:absolute;top:.125rem;transform:rotate(90deg);width:.875rem}.book>.titlepage:not(:last-child),.rhdocs .chapter,section[id]{padding-bottom:3.75rem}.book>.titlepage .chapter:last-child,.book>.titlepage section[id]:last-child,.chapter .chapter:last-child,.chapter section[id]:last-child,section[id] .chapter:last-child,section[id] section[id]:last-child{margin-bottom:-3.75rem}.rhdocs .codeblock__wrapper+section[id],pre+section[id]{padding-top:3.75rem}.rhdocs .cta-link{font-size:inherit}.rhdocs a{word-wrap:break-word;overflow-wrap:break-word}.rhdocs .caution,.rhdocs .important,.rhdocs .note,.rhdocs .tip,.rhdocs .warning{padding:.8888888889em;position:relative}.rhdocs .QSIPopOver{bottom:18.75rem!important;top:auto!important}.rhdocs .alert{position:relative}.rhdocs button.dismiss-button{background:none;border:0;cursor:pointer;height:2.5rem;margin-top:-1.25rem;padding:0;position:absolute;right:.3125rem;text-align:center;top:50%;width:2.5rem;z-index:50}.rhdocs button.dismiss-button:after{content:"\f109";display:inline-block;filter:alpha(opacity=30);font-family:rh-web-iconfont;font-size:1.3125rem;font-style:normal;font-variant:normal;font-weight:400;line-height:1;line-height:2.5rem;opacity:.3;text-decoration:inherit;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs .book>.titlepage,.rhdocs .chapter,.rhdocs section[id]{padding-bottom:var(--rh-space-4xl,64px)}.rhdocs .alert{border:0;border-radius:0}.rhdocs .alert>h2:first-child,.rhdocs .alert>h3:first-child,.rhdocs .alert>h4:first-child,.rhdocs .alert>h5:first-child,.rhdocs .alert>h6:first-child,.rhdocs .alert>p:first-child{margin-top:0!important}.rhdocs .alert>p:last-child{margin-bottom:0!important}.rhdocs .alert-w-icon[class]{padding-left:2.8125rem}.rhdocs .alert-w-icon .alert-icon{float:left;font-size:1.125rem;margin-left:-1.875rem;margin-right:.625rem}.rhdocs .alert-w-icon .alert-icon[class*=" rh-icon-"],.rhdocs .alert-w-icon .alert-icon[class^=rh-icon-]{font-size:2.25rem;line-height:1em;margin-left:-2.5rem;margin-top:-.375rem}.rhdocs .alert-w-icon .alert-icon[class*=" icon-innov-prev"],.rhdocs .alert-w-icon .alert-icon[class^=icon-innov-prev]{font-size:1.3125rem;margin-top:.25rem}.rhdocs .alert-w-icon.alert-plain{background:none;color:#151515;padding-left:5rem}.rhdocs .alert-w-icon.alert-plain .alert-icon{font-size:3rem;margin-left:-4.375rem;margin-right:0}.rhdocs .alert-w-icon.alert-plain.alert-success .alert-icon{color:#3f9c35}.rhdocs .alert-w-icon.alert-plain.alert-info .alert-icon{color:#0088ce}.rhdocs .alert-w-icon.alert-plain.alert-warning .alert-icon{color:#f0ab00}.rhdocs .alert-w-icon.alert-plain.alert-danger .alert-icon{color:#e00}#target_banner .copy-url{float:right;margin-top:0}#target_banner .dropdown-menu{font-size:inherit}.titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.para{margin:1.49963rem 0}.para[class]{margin-bottom:1.49963rem}dd{margin-bottom:2.5rem}.rhdocs .card-light,.rhdocs .card-light-gray,.rhdocs .card-light-grey{background:#f0f0f0;border:.0625rem solid #f0f0f0;color:#151515}.rhdocs .card-light-gray.push-bottom:first-child,.rhdocs .card-light-grey.push-bottom:first-child,.rhdocs .card-light.push-bottom:first-child{margin-bottom:3.125rem!important}.rhdocs .card-light a.card-link,.rhdocs .card-light h1,.rhdocs .card-light h2,.rhdocs .card-light h3,.rhdocs .card-light h4,.rhdocs .card-light h5,.rhdocs .card-light h6,.rhdocs .card-light-gray a.card-link,.rhdocs .card-light-gray h1,.rhdocs .card-light-gray h2,.rhdocs .card-light-gray h3,.rhdocs .card-light-gray h4,.rhdocs .card-light-gray h5,.rhdocs .card-light-gray h6,.rhdocs .card-light-grey a.card-link,.rhdocs .card-light-grey h1,.rhdocs .card-light-grey h2,.rhdocs .card-light-grey h3,.rhdocs .card-light-grey h4,.rhdocs .card-light-grey h5,.rhdocs .card-light-grey h6{color:#151515}.rhdocs .card-light-gray.card-active:after,.rhdocs .card-light-grey.card-active:after,.rhdocs .card-light.card-active:after{border-top-color:#f0f0f0}.rhdocs .card-md,.rhdocs .card-narrow{display:block;padding:1.1875rem;white-space:normal;word-wrap:break-word}.rhdocs .card .card-heading.card-heading-sm,.rhdocs .card-sm .card .card-heading{font-size:1.0625em;font-weight:500;line-height:1.5}.rhdocs .card .card-heading.card-heading-flush{margin-bottom:.25rem}.rhdocs .card .card-heading.card-heading-red{color:#d10000}.rhdocs .card>p{margin-top:0}.rhdocs .card>p:last-child{margin-bottom:0}.rhdocs .new-experience{background-color:#e7f1fa;border:.0625rem solid #bee1f4;font-size:1rem;margin:1.5rem;padding:1.5rem;position:relative;z-index:1}@media (min-width:48rem){.new-experience{display:flex}.new-experience--contained{left:50%;position:relative;transform:translateX(-50%);width:calc(100vw - 2.5rem)}}.new-experience__primary-content{flex-grow:1}@media (min-width:48rem){.new-experience__primary-content{margin-right:1.25rem}}.new-experience__title{font-size:inherit;font-weight:inherit;line-height:1.6;margin:0;padding:0}.new-experience__title+a,.new-experience__title+pfe-cta{display:inline-block;margin-top:1.5em}.new-experience__secondary-content{min-width:12.5rem}@media (min-width:48rem){.new-experience__secondary-content{text-align:right}}.example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:min-content 1fr}dl.calloutlist[class] dt{float:none;margin:0;padding:0}dl.calloutlist[class] dd{margin:0;padding:0}dl.calloutlist[class] dd>:first-child{margin-top:0}dl.calloutlist[class] dd>:last-child{margin-bottom:0}.toast{background-color:#000;background-color:rgba(0,0,0,.9);bottom:.9375rem;box-shadow:0 .125rem .3125rem 0 rgba(0,0,0,.26);color:#fff;left:.9375rem;max-width:32.8125rem;min-width:6.25rem;padding:.9375rem;position:fixed;right:.9375rem;transform:translate3d(0,150%,0);transition:transform .2s cubic-bezier(.465,.183,.153,.946);will-change:transform;z-index:999}.toast.show{transform:translateZ(0)}.toast a{color:#fff;text-decoration:underline}.toast a:focus,.toast a:hover{color:#2b9af3}.toast a.btn{text-decoration:none}.toast .btn.btn-link{color:#fff}.toast .close{color:#fff;opacity:.3;text-decoration:none}.toast .close:focus,.toast .close:hover{color:#fff;opacity:.5}.no-csstransforms3d.csstransitions .toast{transition:all .2s cubic-bezier(.465,.183,.153,.946)}.no-csstransforms3d .toast{opacity:0;visibility:hidden}.no-csstransforms3d .toast.show{opacity:1;visibility:visible}.annotator-outer[class][class]{display:none;flex-direction:column;flex-grow:1;height:auto;margin:0;position:static;width:auto}@media (min-width:1400px){.annotator-outer[class][class]{display:flex}}.annotator-frame[class] *{height:auto}@media (min-width:1400px){.annotator-frame .h-sidebar-iframe[class]{position:static;width:calc(100% + 1.5rem)}}.annotator-toolbar[class][class]{position:static;width:auto}.annotator-toolbar>ul,.annotator-toolbar>ul>li{display:block;height:auto;list-style:none;margin:0;padding:0;width:auto}.annotator-toolbar>ul>li{display:flex;justify-content:flex-end}.annotator-frame[class] .annotator-frame-button--sidebar_toggle,.annotator-outer .annotator-frame-button[class][class],.app-content-wrapper *{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif!important}.annotator-outer .annotator-frame-button[class][class]{font-size:.9375rem;font-weight:500;height:auto;line-height:1.333;margin-right:1.875rem;padding:.75em 1em;position:static}@media (min-width:1400px){.annotator-outer .annotator-frame-button[class][class]{margin-right:0}}.annotator-outer iframe{flex-grow:1;margin-bottom:1.25rem}@media (min-width:1400px){.annotator-outer iframe{min-height:37.5rem}}.producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.producttitle .productnumber{color:var(--jupiter__palette__red--50,#e00)}.cp-modal-open,.zoom-open{overflow:hidden}.cp-modal,.cp-video-modal,.zoom-modal{bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;outline:0;overflow:hidden;position:fixed;right:0;top:0;transition:all .2s cubic-bezier(.465,.183,.153,.946);z-index:1040;z-index:1050;-webkit-overflow-scrolling:touch}.rhdocs .in.cp-modal,.rhdocs .in.cp-video-modal,.rhdocs .in.zoom-modal{display:block;filter:alpha(opacity=100);opacity:1;overflow-x:hidden;overflow-y:auto}.rhdocs .cp-modal .close,.rhdocs .cp-video-modal .close,.rhdocs .zoom-modal .close{background-color:#fff;border-radius:50%;color:#1a1a1a;font-size:1.75rem;height:28px;height:1.75rem;line-height:1.75rem;margin-bottom:.375rem;margin-top:0;opacity:.9;position:absolute;right:-.5rem;text-shadow:none;top:0;width:28px;width:1.75rem}.cp-modal .close:after,.cp-video-modal .close:after,.zoom-modal .close:after{line-height:1.75rem}.cp-modal-wrap,.zoom-wrap{margin:.625rem;padding-top:.5rem;position:relative}@media (min-width:48rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{margin:2.8125rem auto;width:38.4375rem}}@media (min-width:62rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:49.8958rem}}@media (min-width:75rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:60.3125rem}}.rhdocs .cp-modal-body :last-child{margin-bottom:0}.rhdocs .cp-modal-backdrop,.rhdocs .zoom-backdrop{background-color:#000;bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;position:fixed;right:0;top:0;transition:opacity .2s cubic-bezier(.465,.183,.153,.946);z-index:1040}.rhdocs .in.cp-modal-backdrop,.rhdocs .in.zoom-backdrop{display:block;filter:alpha(opacity=80);opacity:.8}.rhdocs .cp-modal-body{background:#fff;padding:1.875rem}.rhdocs .cp-modal[data-cp-modal-video=true] .cp-modal-body,.rhdocs .cp-video-modal .cp-modal-body{padding:0}.rhdocs [data-action=zoom]{position:relative}.rhdocs [data-action=zoom]:after{background:rgba(0,0,0,.4);bottom:0;color:#fff;display:inline-block;font-family:rh-web-iconfont;font-style:normal;font-variant:normal;font-weight:400;line-height:1;padding:.375rem;position:absolute;right:0;text-decoration:inherit;text-decoration:none!important;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs [data-action=zoom]:focus:after,.rhdocs [data-action=zoom]:hover:after{background:rgba(0,0,0,.9)}.rhdocs .zoom-wrap .zoom-larger{text-align:center}.rhdocs .zoom-wrap .zoom-larger a{color:#fff}.rhdocs .zoom-wrap .zoom-larger a:focus,.rhdocs .zoom-wrap .zoom-larger a:hover{color:#fff;text-decoration:underline}.rhdocs .zoom-wrap .zoom-larger a:after{content:"â¿»";display:inline-block;margin-left:.25rem}.rhdocs .zoom-body{background:#fff;border-radius:.5rem;margin:0 0 1rem;padding:1rem;text-align:center}.rhdocs .zoom-body .video-wrapper{height:0;overflow:hidden;padding-bottom:56.25%;position:relative}.rhdocs .zoom-body .video-wrapper[data-aspect-ratio="4:3"]{padding-bottom:75%}.rhdocs .zoom-body iframe{height:100%;left:0;position:absolute;top:0;width:100%}.rhdocs .para>.title[class],.rhdocs p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0;text-transform:none}.rhdocs .para>.title[class]+.content>:first-child,.rhdocs .para>.title[class]+p,.rhdocs p.title[class]+.content>:first-child,.rhdocs p.title[class]+p{margin-top:0}.rhdocs [class] pre .caution,.rhdocs [class] pre .important,.rhdocs [class] pre .note,.rhdocs [class] pre .tip,.rhdocs [class] pre .warning{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.rhdocs [class] pre .caution:after,.rhdocs [class] pre .important:after,.rhdocs [class] pre .note:after,.rhdocs [class] pre .tip:after,.rhdocs [class] pre .warning:after{content:none}.rhdocs [class] code.email{background-color:transparent;font:inherit;padding:0}.rhdocs [class] .author{margin-bottom:1.5rem}.rhdocs [class] .author .author{margin-bottom:0}.rhdocs table{margin:2rem 0}.rhdocs [class] table{width:auto}.rhdocs table .table-contents table{max-width:100%;overflow:auto}.rhdocs rh-table table{margin:0;max-width:9999em;overflow:visible}.rhdocs td,.rhdocs th{border-left:0;padding:.5em 1rem;transition:background .25s ease-out}.rhdocs td.content--md[class][class],.rhdocs th.content--md[class][class]{min-width:13em}.rhdocs td.content--lg[class][class],.rhdocs th.content--lg[class][class]{min-width:20em}.rhdocs thead th{padding-top:1.5em}.rhdocs caption{color:currentColor;color:var(--pfe-table__caption--Color,currentColor);font-weight:700;margin-bottom:.5rem;margin-top:.5rem;text-align:center}.rhdocs .revhistory table td,.rhdocs .revhistory table th{border-color:transparent}.rhdocs .revhistory table td{padding:.625rem .875rem}.rhdocs .revhistory table.simplelist{margin:0}@media print{#masthead{display:none!important}}.rh-table--is-full-screen #to-top{display:none}.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:var(--rh-font-family-body-text,RedHatText,"Red Hat Text","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-body-copy-lage,1.125rem);line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs rh-codeblock::slotted(#content){border-radius:.25rem;padding:var (--rh-space-lg,16px)}.rhdocs rh-codeblock .screen{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs rh-codeblock[class][class][class][class][class]{max-width:99999em}.rhdocs .codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.rhdocs .codeblock__copy:focus{outline:.0625rem dashed currentcolor}.rhdocs .codeblock__copy svg#icon--copy{height:1rem;width:1rem}.rhdocs pre{border:0;max-height:-moz-max-content;max-height:max-content}.rhdocs pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre,.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre[class]{margin:0;padding:0;position:relative}.rhdocs code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs code.literal{background:#eee;border-radius:.25rem;color:#000;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs code.literal,.rhdocs kbd,.rhdocs span.keycap{font-family:RedHatMono,Red Hat Mono,Consolas,monospace}.rhdocs kbd,.rhdocs span.keycap{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ._additional-resources[class][class],.rhdocs ._additional-resources[class][class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.rhdocs ._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.rhdocs ._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.rhdocs ._additional-resources[class][class] li:last-child{border:0}.rhdocs section.section#additional_resource .additional-resources__heading,.rhdocs section.section#additional_resource .heading,.rhdocs section.section#additional_resource h1,.rhdocs section.section#additional_resource h2,.rhdocs section.section#additional_resource h3,.rhdocs section.section#additional_resource h4,.rhdocs section.section#additional_resource h5,.rhdocs section.section#additional_resource h6,.rhdocs section.section#additional_resource p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.rhdocs section.section:first-of-type{margin-top:var(--rh-space-4xl,64px)}.rhdocs section.section p{margin-bottom:var(--rh-space-lg,16px);margin-top:0;word-wrap:break-word}.rhdocs .section.section h1,.rhdocs .section.section h2,.rhdocs .section.section h3,.rhdocs .section.section h4,.rhdocs .section.section h5,.rhdocs .section.section h6,.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h1:first-of-type,.rhdocs h2:first-of-type,.rhdocs h3:first-of-type,.rhdocs h4:first-of-type,.rhdocs h5:first-of-type,.rhdocs h6:first-of-type{margin-top:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h2,.rhdocs section.section h2{font-size:var(--rh-font-size-heading-md,1.75rem)}.rhdocs h3,.rhdocs section.section h3{font-size:1.5rem;font-weight:400}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs dl{display:block;margin-block-end:1em;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.rhdocs .para{margin:1.49963rem 0}.rhdocs dl.calloutlist[class] dt{float:none;margin:0;padding:0}.rhdocs dl.calloutlist[class] dd>:last-child{margin-bottom:0}.rhdocs dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:fit-content(40%) 1fr}.rhdocs .calloutlist dt{clear:left;display:flex;flex-wrap:wrap;float:left;margin:0;padding:0 .5rem 0 0}.rhdocs .calloutlist dt a:not(:first-child){padding-left:4px}.rhdocs dl.calloutlist[class] dd{margin:0;padding:0}.rhdocs .callout,.rhdocs .colist>ol>li:before,.rhdocs .conum{background:#06c;border-radius:50%;color:#fff;display:inline-block;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:.75rem;font-style:normal;font-weight:600;height:1.25rem;line-height:1.35rem;padding:0;position:relative;text-align:center;top:-.125em;vertical-align:middle;width:1.25rem}.rhdocs img,.rhdocs object,.rhdocs svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs .titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.rhdocs[class] .author{margin-bottom:1.5rem}.rhdocs[class] .author .author{margin-bottom:0}.rhdocs .para>.title[class],p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0}.rhdocs .example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}.rhdocs code{background:#eee;color:#000;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs .para[class]{margin-bottom:1.49963rem}.rhdocs[class] code.email{background-color:transparent;font:inherit;padding:0}rh-alert.admonition #description,rh-alert.admonition p{font-size:var(--rh-font-size-body-text-md,1rem)}rh-alert{width:-moz-fit-content;width:fit-content}.rhdocs .producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.rhdocs dl{margin:1rem 0}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs ol ol{list-style:lower-roman}.rhdocs .codeblock--processed pf-clipboard-copy::part(input),.rhdocs .codeblock--processed pf-clipboard-copy::part(span){display:none}.token.tag{color:#c9190b}.calloutlist div.para{margin:0}rh-alert.admonition{margin-bottom:var(--rh-space-lg,1rem)}.guibutton,.guimenu,.guimenuitem{font-weight:700}.guibutton{font-size:90%;padding:.1875rem}.guibutton:before{content:"["}.guibutton:after{content:"]"}.docs-content-container,.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}pre[hidden]{display:none}.codeblock[class][class][class][class][class]{max-width:99999em}.codeblock__wrapper{background:var(--rh-color-surface-lighter,#f2f2f2);margin:1rem 0;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__inner-wrapper:after{content:"";display:block;min-height:.625rem;width:4.375rem}.codeblock__copy{--pfe-clipboard--icon--Color--hover:#06c;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));padding:.3125rem .375rem;position:absolute;top:1rem;width:1.75rem;z-index:2}.codeblock__inner-wrapper pre{border:0;max-height:-moz-max-content;max-height:max-content}.pfe-clipboard:not([copied]) .pfe-clipboard__text--success,:host(:not([copied])) .pfe-clipboard__text--success{display:none!important}.codeblock[class]{margin:0;overflow:visible;padding-right:0}pre{display:block;font-size:.8125rem;line-height:1.42857;margin:0 0 .625rem;word-break:break-all;word-wrap:break-word;background-color:var(--rh-color-surface-lighter,#f2f2f2);border:.0625rem solid #ccc;border-radius:.25rem;color:#333}.docs-content-container pre,.rhdocs pre{background:var(--rh-color-surface-lighter,#f2f2f2);color:#151515;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs pre[class]{line-height:1.6667;overflow-x:auto}rh-codeblock pre[class][class]{overflow-x:auto}.pfe-clipboard__text--success{background-color:#ddd;border:1px solid #000;border-radius:2px}*,:after,:before{box-sizing:border-box}:root{--rh-space-xs:4px;--rh-space-sm:6px;--rh-space-md:8px;--rh-space-lg:16px;--rh-space-xl:24px;--rh-space-2xl:32px;--rh-space-3xl:48px;--rh-space-4xl:64px;--rh-space-5xl:80px;--rh-space-6xl:96px;--rh-space-7xl:128px;--rh-font-size-body-text-xs:.75rem;--rh-font-size-body-text-sm:.875rem;--rh-font-size-body-text-md:1rem;--rh-font-size-body-text-lg:1.125rem;--rh-font-size-body-text-xl:1.25rem;--rh-font-size-body-text-2xl:1.5rem;--rh-font-size-heading-xs:1.25rem;--rh-font-size-heading-sm:1.5rem;--rh-font-size-heading-md:1.75rem;--rh-font-size-heading-lg:2.25rem;--rh-font-size-heading-xl:2.5rem;--rh-font-size-heading-2xl:3rem;--pfe-navigation--logo--maxWidth:200px;--pfe-navigation__logo--height:40px;--pfe-navigation--fade-transition-delay:500ms;--pfe-navigation__nav-bar--highlight-color:var(--rh-color-brand-red-on-dark,#e00);--pf-global--icon--FontSize--sm:.75rem}body,html{font-family:Red Hat Text,sans-serif;font-size:var(--rh-font-size-body-text-md,1rem);line-height:var(--rh-line-height-body-text,1.5);margin:0}h1,h2,h3,h4,h5,h6{font-family:Red Hat Display,sans-serif;font-weight:400;line-height:var(--rh-line-height-heading,1.3)}h1{font-size:var(--rh-font-size-heading-2xl,3rem);line-height:62px}h2{font-size:var(--rh-font-size-heading-xl,2.5rem);line-height:48px}h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}h4{font-size:var(--rh-font-size-heading-md,2.25rem)}h5{font-size:var(--rh-font-size-heading-sm,2.25rem)}h6{font-size:var(--rh-font-size-heading-xs,2.25rem)}main{line-height:30px}section{padding-bottom:3rem;padding-top:3rem}img{height:auto;max-width:100%}a{color:var(--rh-color-interactive-blue-darker,#06c);text-decoration:none}a:hover{color:var(--rh-color-interactive-blue-darkest,#004080)}rh-alert.html-container a{text-decoration:underline}.container{padding-left:12px;padding-right:12px}.container,.container-fluid{margin-left:auto;margin-right:auto;width:100%}.container-fluid{padding:12px}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{min-width:1140px}}@media (min-width:1400px){.container{min-width:1320px}}.grid{display:grid;gap:var(--rh-space-xl,24px)}.grid-center{margin:auto}.grid.grid-col-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-12{grid-template-columns:repeat(12,1fr)}@media (min-width:768px){.grid.grid-col-md-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-md-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-md-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-md-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-md-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-md-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-md-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-md-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-md-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-md-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-md-12{grid-template-columns:repeat(12,1fr)}}@media (min-width:992px){.grid.grid-col-lg-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-lg-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-lg-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-lg-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-lg-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-lg-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-lg-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-lg-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-lg-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-lg-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-lg-12{grid-template-columns:repeat(12,1fr)}}.span-1{grid-column:span 1}.span-2{grid-column:span 2}.span-3{grid-column:span 3}.span-4{grid-column:span 4}.span-5{grid-column:span 5}.span-6{grid-column:span 6}.span-7{grid-column:span 7}.span-8{grid-column:span 8}.span-9{grid-column:span 9}.span-10{grid-column:span 10}.span-11{grid-column:span 11}.span-12{grid-column:span 12}@media (min-width:399px){.span-xs-1{grid-column:span 1}.span-xs-2{grid-column:span 2}.span-xs-3{grid-column:span 3}.span-xs-4{grid-column:span 4}.span-xs-5{grid-column:span 5}.span-xs-6{grid-column:span 6}.span-xs-7{grid-column:span 7}.span-xs-8{grid-column:span 8}.span-xs-9{grid-column:span 9}.span-xs-10{grid-column:span 10}.span-xs-11{grid-column:span 11}.span-xs-12{grid-column:span 12}}@media (min-width:768px){.span-md-1{grid-column:span 1}.span-md-2{grid-column:span 2}.span-md-3{grid-column:span 3}.span-md-4{grid-column:span 4}.span-md-5{grid-column:span 5}.span-md-6{grid-column:span 6}.span-md-7{grid-column:span 7}.span-md-8{grid-column:span 8}.span-md-9{grid-column:span 9}.span-md-10{grid-column:span 10}.span-md-11{grid-column:span 11}.span-md-12{grid-column:span 12}}@media (min-width:992px){.span-lg-1{grid-column:span 1}.span-lg-2{grid-column:span 2}.span-lg-3{grid-column:span 3}.span-lg-4{grid-column:span 4}.span-lg-5{grid-column:span 5}.span-lg-6{grid-column:span 6}.span-lg-7{grid-column:span 7}.span-lg-8{grid-column:span 8}.span-lg-9{grid-column:span 9}.span-lg-10{grid-column:span 10}.span-lg-11{grid-column:span 11}.span-lg-12{grid-column:span 12}}@media (min-width:1025px){.span-xl-1{grid-column:span 1}.span-xl-2{grid-column:span 2}.span-xl-3{grid-column:span 3}.span-xl-4{grid-column:span 4}.span-xl-5{grid-column:span 5}.span-xl-6{grid-column:span 6}.span-xl-7{grid-column:span 7}.span-xl-8{grid-column:span 8}.span-xl-9{grid-column:span 9}.span-xl-10{grid-column:span 10}.span-xl-11{grid-column:span 11}.span-xl-12{grid-column:span 12}}@media (min-width:1200px){.span-2xl-1{grid-column:span 1}.span-2xl-2{grid-column:span 2}.span-2xl-3{grid-column:span 3}.span-2xl-4{grid-column:span 4}.span-2xl-5{grid-column:span 5}.span-2xl-6{grid-column:span 6}.span-2xl-7{grid-column:span 7}.span-2xl-8{grid-column:span 8}.span-2xl-9{grid-column:span 9}.span-2xl-10{grid-column:span 10}.span-2xl-11{grid-column:span 11}.span-2xl-12{grid-column:span 12}}.flex{display:flex;flex-direction:column;gap:var(--rh-space-lg,16px)}.flex-row{flex-direction:row}.flex-column{flex-direction:column}@media (min-width:768px){.flex-md-row{flex-direction:row}.flex-md-column{flex-direction:column}}.typography-h1{font-size:var(--rh-font-size-heading-2xl,3rem)}.typography-h2{font-size:var(--rh-font-size-heading-xl,2.5rem)}.typography-h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}.typography-h4{font-size:var(--rh-font-size-heading-md,1.75rem)}.typography-h5{font-size:var(--rh-font-size-heading-sm,1.5rem)}.typography-h6{font-size:var(--rh-font-size-heading-xs,1.25rem)}.content section{padding:0}.content h1,.content h2,.content h3,.content h4,.content h5,.content h6{margin:var(--rh-space-lg,16px) 0}.sr-only{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0}.list-unstyled{list-style:none;padding-left:0}.tooltip-content{align-items:center;display:flex;font-family:Red Hat Text;justify-content:center;text-transform:none}.tooltip-content .check-icon{margin-left:var(--rh-space-md,8px)}.doc-image-link{display:inline-block;text-decoration:none}.modal-img{display:block;width:100%}.modal-helper-text{margin-top:.5rem;text-align:center}.modal-helper-text a{color:#000;cursor:pointer}.modal-helper-text a:hover{text-decoration:underline}.modal-helper-text a:after{content:"⿻";margin-left:.25rem}pf-modal.pf-img-modal{--pf-c-modal-box--MaxHeight:90vh;overflow-y:scroll}pf-modal.pf-img-modal::part(close-button){background-color:#fff;border-radius:50%;color:#000;margin-right:-2rem;margin-top:-2rem}pf-modal.pf-img-modal::part(close-button):hover{opacity:.7}h2.truste-title{line-height:normal;margin-top:0}rh-alert p[slot=header]{color:#002952}@media (width < 992px){html:has(nav.mobile-nav .mobile-nav-wrapper){scroll-behavior:smooth;scroll-padding-top:4rem}html:has(nav.mobile-nav .mobile-jump-links){scroll-padding-top:7rem}html:has(nav.mobile-nav.hide-mobile-nav){scroll-padding-top:2rem}}.highlight{background:#fff4cc;color:#000}</style>
<style>rh-alert[data-v-84359384]{width:100%}</style>
<style>.search-btn[data-v-edc0d12c]{align-items:center;background-color:var(--rh-color-canvas-black,#151515);border:3px solid var(--rh-color-canvas-black,#151515);cursor:pointer;display:flex;flex-direction:column;height:100%;justify-content:center;outline:none;padding:14px var(--rh-space-md,8px)}.search-btn[data-v-edc0d12c]:focus{border-top:3px solid var(--rh-color-accent-brand-on-light,#e00);outline:2px dotted var(--rh-color-white,#fff)}.search-btn .search-icon[data-v-edc0d12c]{height:26px;padding:2px 0 var(--rh-space-xs,4px);width:20px}.search-btn .search-icon[data-v-edc0d12c],.search-icon-helper-text[data-v-edc0d12c]{color:var(--rh-color-white,#fff)}.search-mobile[data-v-edc0d12c]{margin-bottom:var(--rh-space-2xl,32px)}.search-mobile form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto}.search-box[data-v-edc0d12c]{width:35rem}nav[data-v-edc0d12c]{background-color:#151515;justify-content:space-between;width:100%}a[data-v-edc0d12c],a[data-v-edc0d12c]:visited{color:#fff;display:inline-block;font-size:var(--rh-font-size-body-text-md,1rem)}.skip-link[class][class][data-v-edc0d12c]{font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class][data-v-edc0d12c]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}.visually-hidden[data-v-edc0d12c]{border:1px solid #06c;height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);white-space:nowrap}h3[data-v-edc0d12c]{color:#464646;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-lg,1.125rem)}.language-picker[data-v-edc0d12c]{align-items:center;background-color:#fff;display:flex;flex-direction:column;padding:var(--rh-space-xl,24px);width:100%}.language-picker h3[data-v-edc0d12c]{margin:0;padding:0 1rem 1rem}.language-picker ul[data-v-edc0d12c]{margin:0;padding:0}.language-picker a[data-v-edc0d12c]{color:#06c}.language-picker li[data-v-edc0d12c]{list-style:none}.language-dropdown[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:block!important;position:absolute;right:0;width:100%;z-index:104}.pfe-navigation.pfe-navigation--processed>[slot=secondary-links][data-v-edc0d12c]{height:auto;overflow:visible;visibility:visible;width:auto}.upper-navigation[data-v-edc0d12c]{padding:0 var(--rh-space-2xl,32px)}.upper-nav-container[data-v-edc0d12c]{border-bottom:1px solid #404040;margin:0}.upper-nav-hidden[data-v-edc0d12c]:not(:focus):not(:active){clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.upper-nav-menu[data-v-edc0d12c]{align-items:center;display:flex;justify-content:flex-end;line-height:1.444;list-style:none;margin-bottom:0;margin-top:0;padding-left:0}.upper-nav-menu[data-v-edc0d12c],.upper-nav-menu>li[data-v-edc0d12c]{position:relative}.upper-nav-menu>li:not(:first-child)>a[data-v-edc0d12c]:before,.upper-nav-menu>li:not(:first-child)>button[data-v-edc0d12c]:before{background-color:#404040;content:"";height:40%;left:0;position:absolute;top:30%;width:1px}li[data-v-edc0d12c]{display:list-item;margin:0;padding:0;text-align:-webkit-match-parent}.upper-nav-menu button.upper-nav-links[data-v-edc0d12c]{border:0;border-top:3px solid transparent;cursor:pointer;line-height:1.444}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]{outline-color:#151515}.upper-nav-menu button.upper-nav-links[aria-expanded=true] .upper-nav-arrow[data-v-edc0d12c]{filter:invert(0) sepia(2%) saturate(21%) hue-rotate(257deg) brightness(108%) contrast(100%);transform:rotate(270deg)}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]:before{display:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]{background-color:var(--pfe-navigation--BackgroundColor,var(--pfe-theme--color--surface--darkest,#151515));border-top:3px solid transparent;color:#fff;display:block;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);outline:none;padding:12px 12px 14px;text-decoration:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:hover{border-top-color:#b8bbbe}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within{outline:1px dashed var(--rh-color-white,#fff);outline-offset:-1px}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within:before{display:none}.upper-nav-dropdown-container[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:none;padding:5px 30px 24px;position:absolute;right:0;top:100%;width:500px;z-index:105}.upper-nav-dropdown-container>ul[data-v-edc0d12c]{-moz-column-count:2;column-count:2;list-style-type:none;padding:0;width:auto}.upper-nav-dropdown-container>ul li[data-v-edc0d12c]{color:#151515;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);list-style-type:none;margin-bottom:0}.upper-nav-dropdown-container>ul li span[data-v-edc0d12c]{font-weight:var(--rh-font-weight-body-text-medium,500)}.upper-nav-dropdown-container>ul ul[data-v-edc0d12c]{padding-left:0;padding-top:9px}.upper-nav-dropdown-container>ul>li[data-v-edc0d12c]{padding-top:19px;-moz-column-break-inside:avoid;break-inside:avoid}.upper-nav-dropdown-container>ul>li>ul>li[data-v-edc0d12c]{line-height:1.45;padding:4px 0}.upper-nav-menu .upper-nav-arrow[data-v-edc0d12c]{display:inline-block;filter:invert(100%) sepia(8%) saturate(7%) hue-rotate(1turn) brightness(100%) contrast(93%);height:18px;margin-left:5px;transform:rotate(90deg);vertical-align:middle;width:8px}#pfe-navigation__secondary-links .show[data-v-edc0d12c],.upper-navigation .show[data-v-edc0d12c]{display:block}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:active,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:focus,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:hover{background-color:#fff;color:#151515}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]{background-color:#fff;border-top-color:#b8bbbe;color:#000;position:relative;z-index:1}.upper-nav-dropdown-container>ul a[data-v-edc0d12c]{color:var(--rh-color-accent-base-on-light,#06c);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;text-decoration:none}.pfe-navigation__search[data-v-edc0d12c]{background-color:var(--rh-color-white,#fff)}.pfe-navigation__search form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto;max-width:992px}pfe-navigation [slot=secondary-links] .buttons[data-v-edc0d12c]{display:flex;flex-wrap:wrap;gap:var(--rh-space-md,8px);margin-top:4px}pfe-navigation [slot=secondary-links] .buttons a[data-v-edc0d12c]{border:1px solid #d2d2d2;border-radius:3px;color:#06c;cursor:pointer;flex-basis:calc(50% - 5px);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-weight:var(--rh-font-weight-code-regular,400);padding:1em;text-align:center;text-decoration:none}pfe-navigation [slot=secondary-links] .mobile-lang-select[data-v-edc0d12c]{border:1px solid #d2d2d2;border-bottom-color:#3c3f42;cursor:pointer;display:flex;margin:3rem 0;position:relative}pfe-navigation [slot=secondary-links] .mobile-lang-select label[data-v-edc0d12c]{bottom:100%;color:#000;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;font-weight:500;margin-bottom:5px;position:absolute}pfe-navigation [slot=secondary-links] .mobile-lang-select select[data-v-edc0d12c]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-style:none;color:#000;flex-basis:100%;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:16px;line-height:24px;padding:6px 24px 6px 8px}select[data-v-edc0d12c]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position:98% 50%;background-repeat:no-repeat}#inputLabel[data-v-edc0d12c]{align-items:center;display:flex;position:relative}#inputLabel form[data-v-edc0d12c]{width:100%}.input-box[data-v-edc0d12c]{font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 8px;width:100%}.input-box[data-v-edc0d12c]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-box[data-v-edc0d12c]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}@media(max-width:960px){.search-box[data-v-edc0d12c]{width:28rem}}@media (max-width:768px){.right-navigation[data-v-edc0d12c],.upper-navigation[data-v-edc0d12c]{display:none}}@media (min-width:767px){.pfe-navigation__search form[data-v-edc0d12c]{padding:var(--rh-space-2xl,32px) 0}}</style>
<style>.element-invisible,.sr-only,.visually-hidden{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;white-space:nowrap}@keyframes reveal-nav{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@keyframes reveal-nav-parts{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}1%{visibility:visible}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@media print{.pfe-navigation__menu,pfe-navigation [slot]{display:none!important}}pfe-navigation{--pfe-broadcasted--text:var(--pfe-theme--color--text,#151515);--pfe-broadcasted--text--muted:var(--pfe-theme--color--text--muted,#6a6e73);--pfe-broadcasted--link:var(--pfe-theme--color--link,#06c);--pfe-broadcasted--link--hover:var(--pfe-theme--color--link--hover,#004080);--pfe-broadcasted--link--focus:var(--pfe-theme--color--link--focus,#004080);--pfe-broadcasted--link--visited:var(--pfe-theme--color--link--visited,#6753ac);--pfe-broadcasted--link-decoration:var(--pfe-theme--link-decoration,none);--pfe-broadcasted--link-decoration--hover:var(--pfe-theme--link-decoration--hover,underline);--pfe-broadcasted--link-decoration--focus:var(--pfe-theme--link-decoration--focus,underline);--pfe-broadcasted--link-decoration--visited:var(--pfe-theme--link-decoration--visited,none)}@supports (display:grid){pfe-navigation{animation:reveal-nav .1618s 4s 1 forwards;max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}pfe-navigation>*{animation:reveal-nav-parts .1618s 4s 1 forwards;opacity:0;transition:opacity .1618s ease-in-out;transition:opacity var(--pfe-reveal-duration,.1618s) ease-in-out;visibility:hidden}}pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed>*{animation:none;opacity:1;visibility:visible}pfe-navigation pfe-primary-detail{display:none}pfe-navigation[pfelement]{display:block}pfe-navigation-dropdown{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515)}#pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],#pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],#pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class],pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class]{display:none}#pfe-navigation,#pfe-navigation *,pfe-navigation,pfe-navigation *{box-sizing:border-box}#pfe-navigation [pfelement] .pfe-navigation__log-in-link,pfe-navigation [pfelement] .pfe-navigation__log-in-link{display:none}#pfe-navigation,pfe-navigation{align-items:stretch;background:#151515;background:var(--pfe-navigation__nav-bar--Background,#151515);color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;font-family:Red Hat Text,RedHatText,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamily,Red Hat Text,RedHatText,Arial,Helvetica,sans-serif);font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);height:auto;line-height:1.5;margin:0;max-width:9999em;min-height:72px;min-height:var(--pfe-navigation__nav-bar--Height,72px);padding:0 16px;position:relative;z-index:95;z-index:var(--pfe-navigation--ZIndex,var(--pfe-theme--zindex--navigation,95))}@media (min-width:768px){#pfe-navigation,pfe-navigation{flex-wrap:wrap;margin:0;max-width:9999em;padding:0 16px}}@media (min-width:1200px){#pfe-navigation,pfe-navigation{margin:0 auto;padding:0 32px}}#pfe-navigation .pfe-navigation__dropdown,#pfe-navigation pfe-navigation-dropdown,pfe-navigation .pfe-navigation__dropdown,pfe-navigation pfe-navigation-dropdown{display:none}#pfe-navigation>[slot=account],#pfe-navigation>[slot=search],#pfe-navigation>[slot=secondary-links],pfe-navigation>[slot=account],pfe-navigation>[slot=search],pfe-navigation>[slot=secondary-links]{height:0;overflow:hidden;visibility:hidden;width:0}@media (min-width:768px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{align-items:stretch;display:flex;flex-wrap:wrap}}@media (min-width:992px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{flex-wrap:nowrap}}#pfe-navigation .pfe-navigation__logo-wrapper,pfe-navigation .pfe-navigation__logo-wrapper{align-items:center;display:flex;justify-content:flex-start;margin:0;min-width:150px;padding:10px 16px 10px 0}@media (min-width:768px){.pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:auto}}.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:0}#pfe-navigation .pfe-navigation__logo-link,pfe-navigation .pfe-navigation__logo-link{border-radius:3px;display:block;margin-left:-8px;outline:0;padding:6px 8px;position:relative}#pfe-navigation .pfe-navigation__logo-link:focus,pfe-navigation .pfe-navigation__logo-link:focus{outline:0}#pfe-navigation .pfe-navigation__logo-link:focus:after,pfe-navigation .pfe-navigation__logo-link:focus:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:block;height:auto;width:100%}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{height:40px;height:var(--pfe-navigation__logo--height,40px);width:auto}}@media print{#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:none}}#pfe-navigation .pfe-navigation__logo-image:only-child,pfe-navigation .pfe-navigation__logo-image:only-child{display:block}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small{height:32px;height:var(--pfe-navigation__logo--height,32px)}}@media print{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen{display:none!important}}@media screen{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print{display:none!important}}#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print{display:inline-block!important}#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;justify-content:center;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{display:none!important}}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__fallback-links a[class]:focus,#pfe-navigation .pfe-navigation__fallback-links a[class]:hover,#pfe-navigation .pfe-navigation__log-in-link[class]:focus,#pfe-navigation .pfe-navigation__log-in-link[class]:hover,#pfe-navigation .pfe-navigation__menu-link[class]:focus,#pfe-navigation .pfe-navigation__menu-link[class]:hover,#pfe-navigation .pfe-navigation__secondary-link[class]:focus,#pfe-navigation .pfe-navigation__secondary-link[class]:hover,pfe-navigation .pfe-navigation__fallback-links a[class]:focus,pfe-navigation .pfe-navigation__fallback-links a[class]:hover,pfe-navigation .pfe-navigation__log-in-link[class]:focus,pfe-navigation .pfe-navigation__log-in-link[class]:hover,pfe-navigation .pfe-navigation__menu-link[class]:focus,pfe-navigation .pfe-navigation__menu-link[class]:hover,pfe-navigation .pfe-navigation__secondary-link[class]:focus,pfe-navigation .pfe-navigation__secondary-link[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__secondary-link:focus{outline:0}#pfe-navigation .pfe-navigation__fallback-links a:focus:after,#pfe-navigation .pfe-navigation__log-in-link:focus:after,#pfe-navigation .pfe-navigation__menu-link:focus:after,#pfe-navigation .pfe-navigation__secondary-link:focus:after,pfe-navigation .pfe-navigation__fallback-links a:focus:after,pfe-navigation .pfe-navigation__log-in-link:focus:after,pfe-navigation .pfe-navigation__menu-link:focus:after,pfe-navigation .pfe-navigation__secondary-link:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{pointer-events:none}#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding:0 16px 0 0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{display:block;height:18px}#pfe-navigation .pfe-navigation__fallback-links a[class],#pfe-navigation .pfe-navigation__fallback-links a[href],#pfe-navigation .pfe-navigation__log-in-link[class],#pfe-navigation .pfe-navigation__log-in-link[href],#pfe-navigation .pfe-navigation__menu-link[class],#pfe-navigation .pfe-navigation__menu-link[href],#pfe-navigation .pfe-navigation__secondary-link[class],#pfe-navigation .pfe-navigation__secondary-link[href],pfe-navigation .pfe-navigation__fallback-links a[class],pfe-navigation .pfe-navigation__fallback-links a[href],pfe-navigation .pfe-navigation__log-in-link[class],pfe-navigation .pfe-navigation__log-in-link[href],pfe-navigation .pfe-navigation__menu-link[class],pfe-navigation .pfe-navigation__menu-link[href],pfe-navigation .pfe-navigation__secondary-link[class],pfe-navigation .pfe-navigation__secondary-link[href]{align-items:center;justify-content:center}#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%;--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none!important}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation [slot=account]>a[href]:focus,#pfe-navigation [slot=account]>a[href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation [slot=account]>a[href]:focus,pfe-navigation [slot=account]>a[href]:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation [slot=account]>a[href]:focus,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation [slot=account]>a[href]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle:focus:after,#pfe-navigation [slot=account]>a[href]:focus:after,pfe-navigation .pfe-navigation__account-toggle:focus:after,pfe-navigation [slot=account]>a[href]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{pointer-events:none}@supports (display:grid){#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__account-toggle[class]:focus,#pfe-navigation .pfe-navigation__account-toggle[class]:hover,#pfe-navigation [slot=account]>a[href][class]:focus,#pfe-navigation [slot=account]>a[href][class]:hover,pfe-navigation .pfe-navigation__account-toggle[class]:focus,pfe-navigation .pfe-navigation__account-toggle[class]:hover,pfe-navigation [slot=account]>a[href][class]:focus,pfe-navigation [slot=account]>a[href][class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none}}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{--pfe-icon--size:18px;padding:2px 0 4px}@media (min-width:768px){#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{padding-right:0}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],#pfe-navigation [slot=account]>a[href][href]:focus,#pfe-navigation [slot=account]>a[href][href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation [slot=account]>a[href][href]:focus,pfe-navigation [slot=account]>a[href][href]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after{border:1px dashed #151515;border:1px dashed var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{font-size:inherit;list-style:none;margin:0;padding:0}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{align-items:stretch;display:flex}}#pfe-navigation .pfe-navigation__fallback-links li,#pfe-navigation .pfe-navigation__menu li,pfe-navigation .pfe-navigation__fallback-links li,pfe-navigation .pfe-navigation__menu li{font-size:inherit;margin:0;padding:0}#pfe-navigation .pfe-navigation__fallback-links li:before,#pfe-navigation .pfe-navigation__menu li:before,pfe-navigation .pfe-navigation__fallback-links li:before,pfe-navigation .pfe-navigation__menu li:before{content:none}#pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__fallback-links{margin-left:auto}#pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__menu-link{display:flex;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);white-space:nowrap}#pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed{display:block;padding:0}#pfe-navigation.pfe-navigation--processed:before,pfe-navigation.pfe-navigation--processed:before{content:none}#pfe-navigation.pfe-navigation--processed>[slot=account],#pfe-navigation.pfe-navigation--processed>[slot=search],#pfe-navigation.pfe-navigation--processed>[slot=secondary-links],pfe-navigation.pfe-navigation--processed>[slot=account],pfe-navigation.pfe-navigation--processed>[slot=search],pfe-navigation.pfe-navigation--processed>[slot=secondary-links]{height:auto;overflow:visible;visibility:visible;width:auto}#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,#pfe-navigation.pfe-navigation--processed>[slot],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed>[slot]{animation:none;opacity:1}#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{display:block;height:auto;list-style:none;margin:0 0 8px;padding:0;width:auto}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0 0 8px}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{display:none!important}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{pointer-events:none}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding:0 16px 0 0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{display:block;height:18px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed #fff;border:1px dashed var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{box-shadow:none}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{background:0 0;box-shadow:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column{position:relative}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper{display:block}#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{height:0;transition:height .25s ease-in-out;transition:var(--pfe-navigation--accordion-transition,height .25s ease-in-out)}@media (prefers-reduced-motion){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{transition:none}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:absolute;right:0;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:auto}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:0}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper{left:100vw;left:calc(100vw - 32px);left:calc(100vw - var(--pfe-navigation__mobile-dropdown--PaddingHorizontal,32px));position:absolute;top:0;width:100vw}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false],pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false]{height:100vh;height:calc(100vh - 72px);height:calc(100vh - var(--pfe-navigation__nav-bar--Height,72px));overflow-y:scroll}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 64px24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px) var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a{border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));display:inline-block}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6{margin:32px 0 .75em;margin:var(--pfe-navigation--gutter,32px) 0 .75em;padding:0;-moz-column-break-inside:avoid;break-inside:avoid;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);font-family:Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamilyHeadline,Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif);font-size:1.125rem;font-size:var(--pf-global--FontSize--lg,1.125rem);font-weight:500}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a{border:1px solid transparent;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li{margin:0 0 16px;-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--BackgroundColor,#e00);--pfe-cta--BackgroundColor--hover:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00);--pfe-theme--ui--border-width:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00)}pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul{list-style:none;margin:0;padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515);-moz-column-count:auto;column-count:auto;display:block;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);gap:0;margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:flex;flex-wrap:wrap;padding-bottom:32px;padding-top:32px}@supports (display:grid){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{display:grid;gap:32px;gap:var(--pfe-navigation--gutter,32px);grid-auto-flow:row;grid-template-columns:repeat(4,minmax(0,1fr))}}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:block;gap:0;margin-left:-16px;margin-right:-16px;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{transition-delay:0s;visibility:visible}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px;-moz-column-break-inside:avoid;break-inside:avoid}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid{max-width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown{background:#fff}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:32px 64px;padding:32px var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px)}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container{margin:0;padding:0;width:auto}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class]{padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown{visibility:hidden}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{padding:0}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:0 1px 2px rgba(0,0,0,.12);box-shadow:var(--pfe-navigation__dropdown--BoxShadow,0 1px 2px rgba(0,0,0,.12));max-width:100%;min-width:13em;padding:0 32px;position:absolute;top:100%}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:none;max-width:100%;position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{right:0}}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{width:100%}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{left:0;position:absolute;right:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{position:static}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown{width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles{padding-left:16px;padding-right:16px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form{align-items:center;display:flex}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{padding:10px;transition:box-shadow .2s}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{border:1px solid #f0f0f0;border-bottom-color:#8b8e91;color:#717579;flex-basis:0%;flex-grow:1;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);margin-right:8px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button{background-color:#e00;border:1px solid #e00;border-radius:2px;color:#fff;flex-basis:auto;flex-grow:0;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after{border:1px dashed #000;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{border-bottom:1px solid #d2d2d2;border-bottom:var(--pfe-navigation__dropdown--separator--Border,1px solid var(--pfe-theme--color--ui--border--lighter,#d2d2d2));display:block}@media (min-width:768px){#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:none}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__site-switcher__back-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:block}#pfe-navigation .pfe-navigation__site-switcher__back-button,pfe-navigation .pfe-navigation__site-switcher__back-button{background-color:transparent;border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);padding:21px 21px 21px 45px;position:relative;text-align:left;width:100%}#pfe-navigation .pfe-navigation__site-switcher__back-button:before,pfe-navigation .pfe-navigation__site-switcher__back-button:before{border:2px solid #06c;border:2px solid var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));border-right:0;border-top:0;content:"";display:block;height:8px;left:35px;position:absolute;right:auto;top:27px;transform:rotate(45deg);transform-origin:left top;width:8px}#pfe-navigation .pfe-navigation__site-switcher__back-button:focus,#pfe-navigation .pfe-navigation__site-switcher__back-button:hover,pfe-navigation .pfe-navigation__site-switcher__back-button:focus,pfe-navigation .pfe-navigation__site-switcher__back-button:hover{border:1px dashed #151515;border-top:1px dashed #151515;border:1px dashed var(--pfe-navigation__dropdown--Color,#151515);color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);outline:0}#pfe-navigation.pfe-navigation--processed site-switcher,pfe-navigation.pfe-navigation--processed site-switcher{-moz-columns:auto;columns:auto;display:block}#pfe-navigation.pfe-navigation--stuck,pfe-navigation.pfe-navigation--stuck{left:0;position:fixed;top:0;width:100%;z-index:95;z-index:var(--pfe-theme--zindex--navigation,95)}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner{opacity:1!important}#pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown{display:none!important}#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown{display:block!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item{display:block}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus{outline:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown{display:flex;flex-wrap:wrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope{flex-basis:25%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope{flex-basis:100%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope{margin-right:16px}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{display:flex;flex-direction:column;flex-wrap:nowrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{flex-basis:auto}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a{color:#fff!important;justify-content:center!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true]{color:#151515!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon{display:none!important}[id=pfe-navigation__account-dropdown][class][class]{display:block;height:auto;left:0;padding:0;position:absolute;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px);width:100%}[id=pfe-navigation__account-dropdown].pfe-navigation__dropdown-wrapper--invisible[class]{display:none}.pfe-navigation__dropdown-wrapper{overflow:hidden}@media (min-width:768px){.pfe-navigation__custom-dropdown--single-column{min-width:25em}}.pfe-navigation--collapse-secondary-links .pfe-navigation__custom-dropdown--single-column{min-width:0}.secondary-link__icon-wrapper{align-items:center;display:flex;justify-content:center}.secondary-link__alert-count{background:#06c;background:var(--pfe-navigation__nav-bar--alert-color,var(--pfe-theme--color--link,#06c));border-radius:20px;color:#fff;color:var(--pfe-navigation__nav-bar--Color--on-highlight,var(--pfe-theme--color--text--on-saturated,#fff));display:block;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);line-height:20px;margin:0 4px 0 2px;min-width:23px;overflow:hidden;padding:0 8px}.secondary-link__alert-count:empty{display:none}#pfe-navigation__1x-skip-links{left:0;position:absolute;top:0}#pfe-navigation__1x-skip-links,#pfe-navigation__1x-skip-links li{height:0;list-style:none;margin:0;padding:0;width:0}.skip-link[class][class]{font-size:.875rem;font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}pfe-navigation pfe-navigation-account[slot=account]{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));width:100%}</style>
<style>:host([size=sm]) #container[data-v-8589d091]{--_size:var(--pf-global--icon--FontSize--sm,12px)}.content-wrapper[data-v-8589d091]{height:auto;margin:0 auto;min-height:46vh}.content[data-v-8589d091]{max-width:1000px}#left-content[data-v-8589d091]{max-width:330px;z-index:1}.line-below-chp[data-v-8589d091]{margin:var(--rh-space-xl,24px) 0 var(--rh-space-3xl,48px)}.toc-container[data-v-8589d091]{border-right:1px solid var(--rh-color-gray-30,#c7c7c7);min-height:100vh;position:sticky;top:0;transition:transform .3s ease-in-out}nav#toc[data-v-8589d091]{height:auto;overflow-y:auto;padding-bottom:var(--rh-space-2xl,32px)}.max-height-85[data-v-8589d091]{max-height:85vh}.max-height-75[data-v-8589d091]{max-height:75vh}.toc-filter[data-v-8589d091]{background-color:#fff;padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px);position:sticky;top:-1px;width:100%;z-index:1}#text[data-v-8589d091],.toc-filter[data-v-8589d091]{align-items:center;display:flex}#text[data-v-8589d091]{flex:1;flex-direction:row}#search-icon[data-v-8589d091]{color:#151515;left:2.5rem;position:absolute;top:55%;transform:translateY(-50%)}pf-icon[data-v-8589d091]{--pf-icon--size:16px}#text:focus-within #icon[data-v-8589d091],#text:hover #icon[data-v-8589d091]{color:#151515}#text[data-v-8589d091]:after,#text[data-v-8589d091]:before{content:"";inset:0;pointer-events:none;position:absolute}#text-input[data-v-8589d091]:focus,#text-input:focus+#utilities[data-v-8589d091]{border-bottom:2px solid #06c;outline:none}#text-input[data-v-8589d091]{background-color:transparent;border:1px solid #f0f0f0;border-bottom-color:#8a8d90;color:#151515;font-family:inherit;font-size:100%;grid-area:text-input;line-height:1.5;overflow:hidden;padding:.375rem .25rem .375rem 2rem;position:relative;text-overflow:ellipsis;white-space:nowrap;width:100%}#utilities[data-v-8589d091]{align-items:center;border:1px solid #f0f0f0;border-bottom:1px solid #8a8d90;border-left:0;display:flex}#utilities rh-badge[data-v-8589d091]{border-radius:80px;font-weight:var(--rh-font-weight-heading-medium,500);--_background-color:#e0e0e0;margin-right:8px}#clear-button[data-v-8589d091]{--pf-c-button--PaddingTop:0.625rem;--pf-c-button--PaddingRight:.25rem;--pf-c-button--PaddingBottom:0.625rem;--pf-c-button--PaddingLeft:.25rem;margin-right:8px}#text-input.no-right-border[data-v-8589d091]{border-right:0}.btn-container[data-v-8589d091]{bottom:0;display:flex;justify-content:flex-end;padding:1rem;pointer-events:none;position:fixed;right:0;z-index:2}.top-scroll-btn[data-v-8589d091]{--pf-c-button--BorderRadius:64px;pointer-events:all}.focusable[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-interactive-blue,#06c)}.mobile-nav-wrapper[data-v-8589d091]{align-items:center;border-bottom:1px solid #c7c7c7;display:flex;height:auto;justify-content:space-between;padding:var(--rh-space-sm,.5rem)}.mobile-nav[data-v-8589d091]{align-items:center;background-color:var(--rh-color-bg-page,#fff);min-height:51px;position:sticky;top:0;z-index:5}.active-mobile-menu[data-v-8589d091]{color:#151515;padding-left:.5rem}.hidden[data-v-8589d091]{display:none}.mobile-nav-btn[data-v-8589d091]{background-color:transparent;border:none;font-family:inherit;font-size:.875rem;font-weight:500;margin:0;min-height:40px;min-width:40px}.border-right[data-v-8589d091]{border-right:1px solid #c7c7c7}.toc-focus-container[data-v-8589d091]{position:sticky;top:0;z-index:2}.toc-focus-btn[data-v-8589d091]{align-items:center;background-color:var(--rh-color-white,#fff);border:1px solid var(--rh-color-blue-50,#06c);border-radius:50%;cursor:pointer;display:flex;height:40px;justify-content:center;position:absolute;right:-20px;top:15px;width:40px}.toc-focus-btn[data-v-8589d091]:focus-visible,.toc-focus-btn[data-v-8589d091]:hover{background-color:var(--rh-color-blue-10,#e0f0ff);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2))}.toc-focus-btn[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-blue-50,#06c)}.toc-focus-btn-icon[data-v-8589d091]{color:var(--rh-color-blue-50,#06c)}.toc-wrapper[data-v-8589d091]{padding:0}.product-container[data-v-8589d091]{border-bottom:1px solid var(--rh-color-gray-30,#c7c7c7);padding:var(--rh-space-xl,24px) var(--rh-space-2xl,32px)}.product-container h1.product-title[data-v-8589d091]{font-size:var(--rh-font-size-code-xl,1.25rem);line-height:30px;margin-bottom:0;margin-top:0}.product-container .product-version[data-v-8589d091]{align-items:center;display:flex;flex-wrap:wrap;margin-top:var(--rh-space-lg,16px)}.product-version .version-label[data-v-8589d091]{color:var(--rh-color-canvas-black,#151515);font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:500}.product-version .version-select-dropdown[data-v-8589d091]{margin:var(--rh-space-md,8px) var(--rh-space-sm,6px);max-width:9.75rem;min-height:2rem;min-width:3rem;overflow:hidden;width:-moz-min-content;width:min-content;word-wrap:nowrap;-webkit-appearance:none;-moz-appearance:none;background:var(--rh-color-white,#fff);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position-x:85%;background-position-y:50%;background-repeat:no-repeat;border:1px solid var(--rh-color-gray-30,#c7c7c7);border-bottom:0;box-shadow:0 -1px 0 0 var(--rh-color-gray-60,#4d4d4d) inset;cursor:pointer;font-size:var(--rh-font-size-body-text-md,1rem);padding:var(--rh-space-md,8px);padding-right:24px;text-overflow:ellipsis}pf-popover[data-v-8589d091]{margin-top:var(--rh-space-md,8px);--pf-c-popover__arrow--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover__content--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover--BoxShadow:0px 4px 8px 0px #15151540;--pf-c-popover__title-text--Color:var(--rh-color-white,#fff);--pf-c-popover--MaxWidth:300px;--pf-c-popover--MinWidth:300px;--pf-c-popover--c-button--Top:20px;--pf-c-popover--c-button--Right:4px;--pf-c-button--m-plain--hover--Color:var(--rh-color-white,#fff)}pf-popover[data-v-8589d091]::part(content){padding:var(--rh-space-2xl,32px)}pf-popover[data-v-8589d091]::part(body){margin-top:var(--rh-space-lg,16px)}pf-popover[data-v-8589d091]::part(close-button){--pf-c-button--m-plain--focus--Color:var(--rh-color-gray-30,#c7c7c7);--pf-c-button--m-plain--Color:var(--rh-color-gray-30,#c7c7c7)}.popover-header-text[data-v-8589d091]{color:var(--rh-color-white,#fff);font-size:var(--rh-font-size-code-md,1rem);margin:0;max-width:80%;padding:0}.popover-body-link[data-v-8589d091]{color:var(--rh-color-blue-30,#92c5f9);text-decoration:none}.popover-trigger-btn[data-v-8589d091]{align-items:center;background:none;border:none;cursor:pointer;display:flex;justify-content:center}#first-button[data-v-8589d091]{width:80%}#second-button[data-v-8589d091]{text-align:right;width:20%}#toc-btn[data-v-8589d091]{text-align:left;width:100%}.toc-error[data-v-8589d091]{margin:0;max-width:100%}#layout label[data-v-8589d091]{font-weight:500}.page-layout-options[data-v-8589d091]{background-color:#fff;display:flex;flex-direction:column;padding-bottom:var(--rh-space-lg,16px)}.sticky-top[data-v-8589d091]{position:sticky;top:0}summary[data-v-8589d091]{cursor:pointer;list-style:none;position:relative}summary[data-v-8589d091]::-webkit-details-marker{display:none}details#jump-links-details .jump-links-heading[data-v-8589d091]{background-color:var(--rh-color-white,#fff);display:block;margin-top:var(--rh-space-lg,16px);padding:var(--rh-space-lg,16px) 0 0 var(--rh-space-xl,24px);position:sticky;top:0}details#jump-links-details .jump-links-heading[data-v-8589d091]:before{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;height:9px;left:2px;position:absolute;top:26px;transform:rotate(-135deg);width:9px}details#jump-links-details[open] .jump-links-heading[data-v-8589d091]:before{transform:rotate(135deg)}.table-of-contents>ol[data-v-8589d091]{list-style:none;margin:0;padding:0}nav.table-of-contents[data-v-8589d091]{z-index:1}nav.table-of-contents ol[data-v-8589d091]{list-style:none;margin:0;padding:0}#mobile-browse-docs[data-v-8589d091]{font-weight:var(--rh-font-weight-body-text-medium,500);padding-left:var(--rh-space-2xl,32px)}.docs-content-container[data-v-8589d091]{font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:1.6667;padding-left:6rem;padding-right:6rem;padding-top:var(--rh-space-3xl,4rem)}.chapter-title[data-v-8589d091]{font-family:Red Hat Display}h1.chapter-title[data-v-8589d091]{font-size:var(--rh-fontsize-heading-xl,2.25rem);line-height:46.8px;margin:0;padding:0}.chapter .section h4[data-v-8589d091]{font-size:24px;font-weight:400}.banner-wrapper[data-v-8589d091]{padding:3rem 6rem 0}.page-format-dropdown[data-v-8589d091]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#fff;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABtSURBVHgBhc4xCoAwDAXQxE6li0K76w0cPZqjHsEb6AlcHb2BR9ADdG7GmIKTWv0QSOAFPjrndgAo4TtHxszTD4JoVAhh1VoXiNgkUO+971Q8iGgxxlSy1jc3CGof39baWTrzNSOkkksEbG/oBGEJIn6gD3jAAAAAAElFTkSuQmCC");background-position:8.5rem;background-repeat:no-repeat;background-size:auto;border:1px solid #c7c7c7;box-shadow:inset 0 -1px 0 0 #4d4d4d;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-md,1rem);margin-top:var(--rh-space-xs,4px);max-width:168px;min-height:36px;min-width:168px;overflow:hidden;padding:0 var(--rh-space-xl,24px) 0 var(--rh-space-md,8px);text-overflow:ellipsis;white-space:nowrap}.content-format-selectors[data-v-8589d091]{color:#151515;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:var(--rh-font-weight-body-text-medium,500);margin-right:var(--rh-space-2xl,32px);max-width:250px;min-width:250px;padding-top:var(--rh-space-2xl,32px)}.chapter .section .simpara[data-v-8589d091],.chapter .section p[data-v-8589d091]{font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:30px}#toggle-focus-mode[data-v-8589d091]{padding-right:var(--rh-space-lg,1rem)}@keyframes slideaway-left-8589d091{0%{display:block}to{opacity:0;transform:translateX(-40px)}}@keyframes slideaway-right-8589d091{0%{display:block}to{opacity:0;transform:translateX(40px)}}@keyframes enter-left-8589d091{0%{display:none;transform:translateX(-40px)}to{opacity:1}}@keyframes enter-right-8589d091{0%{display:none;transform:translateX(40px)}to{opacity:1}}.hide-left[data-v-8589d091]{animation:slideaway-left-8589d091 .2s;display:none}.enter-left[data-v-8589d091]{animation:enter-left-8589d091 .3s;border-right:none;display:block}.enter-right[data-v-8589d091]{animation:enter-right-8589d091 .3s;display:block}.hide-right[data-v-8589d091]{animation:slideaway-right-8589d091 .2s;display:none}.toc-container.enter-toc-container-left[data-v-8589d091]{transform:translateX(-85%)}.alert-section[data-v-8589d091]{padding-bottom:3rem}rh-alert[data-v-8589d091]{width:auto}@media (min-width:992px){#mobile-nav[data-v-8589d091],#toc-list-mobile[data-v-8589d091]{display:none}}@media (min-width:992px) and (max-width:1400px){.docs-ocp-content-container[data-v-8589d091]{padding:var(--rh-space-4xl,64px) var(--rh-space-lg,16px) 0}}@media (width < 992px){#breadcrumbs[data-v-8589d091],.content-format-selectors[data-v-8589d091],.toc-container[data-v-8589d091]{display:none}#mobile-nav-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7}#toc-wrapper-mobile[data-v-8589d091]{padding:var(--rh-space-md,1.5rem)}.product-container[data-v-8589d091]{padding:var(--rh-space-2xl,32px) var(--rh-space-lg,16px)}.product-container.shrink-product-padding[data-v-8589d091]{padding:var(--rh-space-lg,16px)}.product-version .version-select-dropdown[data-v-8589d091]{margin:0 var(--rh-space-lg,16px)}#page-content-options-mobile[data-v-8589d091]{padding:var(--rh-space-lg,2rem)}label[for=page-format][data-v-8589d091],label[for=toggle-focus-mode][data-v-8589d091]{display:block}.page-format-dropdown[data-v-8589d091]{background-position:97%;max-width:100%}nav#mobile-toc-menu[data-v-8589d091]{max-height:50vh;overflow-y:scroll}.mobile-jump-links #first-button[data-v-8589d091]{width:100%}#jump-links-btn[data-v-8589d091]{text-align:left;width:100%}#mobile-jump-links-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7;padding:0 var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}.table-of-contents #browse-docs[data-v-8589d091]{margin-top:1rem;padding-top:var(--rh-space-md,1.5rem)}.mobile-nav[data-v-8589d091]{display:block}.hide-mobile-nav[data-v-8589d091],.mobile-nav[data-v-8589d091]{transition:transform .3s ease-in-out}.hide-mobile-nav[data-v-8589d091]{transform:translateY(-100%)}.docs-content-container[data-v-8589d091]{padding-left:1.25rem;padding-right:1.25rem;padding-top:var(--rh-space-xl,24px)}.banner-wrapper[data-v-8589d091]{padding:0 1rem}.toc-filter-mobile[data-v-8589d091]{align-items:center;display:flex;padding:var(--rh-space-lg,16px);width:100%}#text-input[data-v-8589d091]{padding-left:.5rem}.toc-filter[data-v-8589d091]{display:none}}@media (width <=576px){.content-format-selectors[data-v-8589d091]{display:none}}.informaltable[data-v-8589d091],.rhdocs .informaltable[data-v-8589d091],.rhdocs .table-contents[data-v-8589d091],.rhdocs .table-wrapper[data-v-8589d091],.table-contents[data-v-8589d091],.table-wrapper[data-v-8589d091]{max-height:var(--rh-table--maxHeight);overflow:auto}rh-table[data-v-8589d091]{display:block;margin:2rem 0;max-width:100%}.pvof-doc__wrapper[data-v-8589d091],.rhdocs[data-v-8589d091]{--rh-table--maxHeight:calc(100vh - 12.5rem)}</style>
<style>:is(rh-footer-block) a[data-v-97dd2752]{text-decoration:underline}</style>
<style>:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a{color:var(--rh-color-link-inline-on-dark,var(--rh-color-interactive-blue-lighter,#92c5f9));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:hover{color:var(--rh-color-link-inline-hover-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:is(:focus,:focus-within){color:var(--rh-color-link-inline-focus-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:visited{color:var(--rh-color-link-inline-visited-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a[slot^=logo]{display:block}:is(rh-footer) a[slot^=logo]>img{display:block;height:100%;height:var(--rh-size-icon-04,40px);width:auto}:is(rh-footer,rh-footer-universal,rh-global-footer) :is(h1,h2,h3,h4,h5,h6){font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);line-height:var(--rh-line-height-heading,1.3)}rh-footer [slot=links]:is(h1,h2,h3,h4,h5):nth-of-type(n+5){--_link-header-margin:calc(var(--rh-space-2xl, 32px) - var(--rh-space-lg, 16px))}rh-footer [slot^=links] a{gap:var(--rh-footer-links-gap,var(--rh-space-md,8px))}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] li{display:contents;margin:0;padding:0}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] a{color:var(--rh-color-text-primary-on-dark,#fff)!important;display:block;font-size:var(--rh-footer-link-font-size,var(--rh-font-size-body-text-sm,.875rem));width:-moz-fit-content;width:fit-content}:is(rh-footer-universal,rh-global-footer) [slot^=links] a{font-size:inherit}:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-lg,16px)}@media screen and (min-width:768px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-2xl,32px)}}@media screen and (min-width:1440px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-4xl,64px)}}rh-footer:not(:defined){background-color:var(--rh-color-surface-darker,#1f1f1f);display:grid;grid-template-areas:"footer" "global";grid-template-rows:1fr auto;min-height:var(--rh-footer-nojs-min-height,750px);width:100%}:is(rh-footer-universal,rh-global-footer):not(:defined):before{grid-area:global}rh-footer:not(:defined)>[slot=logo]{padding:var(--rh-space-2xl,32px) var(--_section-side-gap)}:is(rh-footer-universal,rh-global-footer):not(:defined)>*,rh-footer:not(:defined)>:not([slot=logo],:is(rh-footer-universal,rh-global-footer)){border:0;clip:rect(1px,1px,1px,1px);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}:is(rh-footer-universal,rh-global-footer):not(:defined){background-color:var(--rh-color-surface-darkest,#151515);display:block;min-height:176px;width:100%}rh-footer-universal rh-footer-copyright{grid-column:-1/1}</style>
<style>.status-legal .status-page-widget[data-v-5f538988]{display:block;margin:.5rem 0;width:11.3125rem;width:-moz-max-content;width:max-content}.status-page-widget[data-v-5f538988]{align-items:center;display:flex;flex-direction:row}.status-legal .status-page-widget .status-description[data-v-5f538988]{color:#ccc;font-weight:600;letter-spacing:.0125rem;line-height:1.5;margin-right:.5rem}.status-good[data-v-5f538988]{background-color:#3e8536}.status-critical[data-v-5f538988]{background-color:#a30100}.status-partial[data-v-5f538988]{background-color:#f5c12d}.status-maintentance[data-v-5f538988]{background-color:#316dc1}.status-minor[data-v-5f538988]{background-color:#b85c00}.status-description[data-v-5f538988]{color:#ccc;font-weight:500;letter-spacing:.2px;line-height:1.5}.current-status-indicator[data-v-5f538988]{border-radius:6px;display:inline-block;height:12px;margin:0 0 0 5px;width:12px}.current-status-indicator.small[data-v-5f538988]{border-radius:4px;display:inline-block;height:8px;margin:0 0 0 5px;width:8px}</style>
<style>.breadcrumbs[data-v-798f280c]{align-items:center;background-color:#f6f6f6;display:flex;gap:var(--rh-space-xl,24px);padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}nav[data-v-798f280c]{flex:1}ol[data-v-798f280c]{background-color:#f6f6f6;font-size:.875rem;list-style:none;margin:0;padding:0}li[data-v-798f280c]{color:#151515;display:inline}a[data-v-798f280c]:after{border-bottom-color:transparent;border-left-color:transparent;box-shadow:inset .25rem .25rem 0 .0625rem #8a8d8d;content:"";display:inline-block;height:1.07143em;margin:0 .5em;position:relative;right:0;top:.75em;transform:translateY(-.5em) rotate(135deg) scale(.5);width:1.07143em}</style>
<style>ol[data-v-fa0dae77]{margin:0;padding:0}li[data-v-fa0dae77],ol[data-v-fa0dae77],ul[data-v-fa0dae77]{list-style:none;margin:0}.chapter-title[data-v-fa0dae77]{font-size:1em}.sub-chapter-title[data-v-fa0dae77],.sub-chapter-title a[data-v-fa0dae77]{font-size:.875rem}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77],.heading[data-v-fa0dae77],.sub-nav .link[data-v-fa0dae77],.sub-nav .link .link[data-v-fa0dae77]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-fa0dae77]:hover,.link[data-v-fa0dae77]:hover,.sub-nav .link[data-v-fa0dae77]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}details[open]:first-of-type>.heading[data-v-fa0dae77]:after{transform:rotate(135deg)}.item[data-v-fa0dae77]{line-height:22px}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77]{color:var(--rh-color-text-primary-on-light,#151515)}.sub-nav[data-v-fa0dae77],.toc-wrapper[data-v-fa0dae77]{list-style:none;margin:0}.toc-wrapper[data-v-fa0dae77]{min-width:100%;padding:0}.sub-nav[data-v-fa0dae77]{font-size:1em;line-height:24px;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-fa0dae77]:hover{color:#151515}.active[data-v-fa0dae77]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.chapter-landing-page[data-v-fa0dae77]{font-weight:500}summary[data-v-fa0dae77]{cursor:pointer;list-style:none;position:relative}summary[data-v-fa0dae77]::-webkit-details-marker{display:none}@keyframes slideDown-fa0dae77{0%{height:0;opacity:0}to{height:var(--details-height-open,"100%");opacity:1}}html[data-v-fa0dae77]{--details-transition-time:400ms}details[data-v-fa0dae77]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-fa0dae77]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-fa0dae77]:after,details .heading[data-v-fa0dae77]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-fa0dae77]:after{height:8px;width:8px}</style>
<style>.item[data-v-b883c74f]{line-height:22px}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f]{color:var(--rh-color-text-primary-on-light,#151515)}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f],.heading[data-v-b883c74f],.sub-nav .link[data-v-b883c74f],.sub-nav .link .link[data-v-b883c74f]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-b883c74f]:hover,.link[data-v-b883c74f]:hover,.sub-nav .link[data-v-b883c74f]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}ol[data-v-b883c74f]{margin:0;padding:0}li[data-v-b883c74f],ol[data-v-b883c74f],ul[data-v-b883c74f]{list-style:none;margin:0}.chapter-title[data-v-b883c74f]{font-size:1em}.sub-nav[data-v-b883c74f]{font-size:1em;line-height:24px;list-style:none;margin:0;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-b883c74f]:hover{color:#151515}.active[data-v-b883c74f]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.sub-chapter-title[data-v-b883c74f],.sub-chapter-title a[data-v-b883c74f]{font-size:.875rem}summary[data-v-b883c74f]{cursor:pointer;list-style:none;position:relative}summary[data-v-b883c74f]::-webkit-details-marker{display:none}html[data-v-b883c74f]{--details-transition-time:400ms}.chapter-landing-page[data-v-b883c74f]{font-weight:500}details[open]:first-of-type>.heading[data-v-b883c74f]:after{transform:rotate(135deg)}details[data-v-b883c74f]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-b883c74f]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-b883c74f]:after,details .heading[data-v-b883c74f]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-b883c74f]:after{height:8px;width:8px}</style>
<style>.html-container[data-v-9c2a9ddb]{padding:2rem 1.5rem 0}rh-alert[data-v-9c2a9ddb]{color:#151515}@media (max-width:772px){.html-container[data-v-9c2a9ddb]{padding:3rem 1rem 0}}</style>
<style>.search-container[data-v-69710f44]{height:100%}.form-box[data-v-69710f44],.search-container[data-v-69710f44]{justify-content:center}.form-box[data-v-69710f44],.search-box[data-v-69710f44],.search-container[data-v-69710f44]{align-items:center;display:flex;width:100%}.search-box[data-v-69710f44]{justify-content:space-between;position:relative}ul[data-v-69710f44]{list-style-type:none}#search-list[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;box-shadow:0 4px 4px 0 #00000040;color:#151515;display:block;left:0;margin:0;padding:0;position:absolute;top:37px;width:100%;z-index:200}#search-list li[data-v-69710f44]{align-items:center;display:flex;justify-content:space-between;padding:.75rem}#search-list .active[data-v-69710f44],#search-list li[data-v-69710f44]:hover{background:#f0f0f0}.group-title[data-v-69710f44]{border-top:1px solid #4d4d4d;color:#4d4d4d;cursor:default;font-size:12px;font-weight:400;pointer-events:none}.group-title[data-v-69710f44],.group-title[data-v-69710f44]:hover{background:#fff}.search-item-text-elipsis[data-v-69710f44]{display:inline-block;max-width:48%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.search-item-text[data-v-69710f44]{padding-left:1.75rem}.search-item-chip[data-v-69710f44]{float:right}.search-product-version[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;border-radius:3px;font-size:1rem;font-weight:400;line-height:24px}.search-icon-form[data-v-69710f44]{color:var(--rh-color-gray-50,#707070);left:12px;position:absolute}.input-search-box[data-v-69710f44]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 40px;width:100%}.input-clear-btn[data-v-69710f44]{align-items:center;background-color:transparent;border:none;display:flex;height:36px;justify-content:center;margin-right:-30px;outline:none;transform:translateX(-30px)}.input-clear-btn[data-v-69710f44]:focus{border:1px solid var(--rh-color-accent-base-on-light,#06c)}.input-clear-btn:focus .input-clear-icon[data-v-69710f44]{color:var(--rh-color-canvas-black,#151515)}.input-clear-icon[data-v-69710f44]{color:#6b6e72;cursor:pointer}.input-clear-icon[data-v-69710f44]:hover{color:var(--rh-color-canvas-black,#151515)}.form-submit-btn[data-v-69710f44]::part(button){align-items:center;background-color:var(--rh-color-gray-20,#e0e0e0);border-radius:0;display:flex;height:36px;justify-content:center;--_default-border-color:var(--rh-color-gray-20,#e0e0e0)}.input-close-btn[data-v-69710f44]{background:none;border:none;cursor:pointer;margin:0 var(--rh-space-lg,16px)}.input-close-icon[data-v-69710f44]{color:var(--rh-color-white,#fff)}@media (max-width:992px){.form-box[data-v-69710f44]{gap:var(--rh-space-md,8px);margin:auto;width:100%}.input-search-box[data-v-69710f44]{border:1px solid var(--rh-color-gray-30,#c7c7c7)}.input-search-box[data-v-69710f44]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-search-box[data-v-69710f44]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.search-item-text-elipsis[data-v-69710f44]{max-width:60%}}@media (max-width:767px){.input-close-btn[data-v-69710f44]{display:none}.search-container[data-v-69710f44]{border:1px solid #f0f0f0}}</style>
<link rel="stylesheet" href="/_nuxt/entry.DNAluCmw.css" integrity="sha384-FnrZajt9k3u4tri3ClqikI96k+jP7kyrvgKKgdzBr5Y8CQEi3gusKE0+eMSLvGxm">
<link rel="stylesheet" href="/_nuxt/SearchAutocomplete.DkrJaF8R.css" integrity="sha384-Zw8gf6w7SrpWDmknvrab5QanIN+DSJRS/bPB9/lgDkhR7JhDmG/VF++MTMKU8mKB">
<link rel="stylesheet" href="/_nuxt/Breadcrumbs.BLkLxUMB.css" integrity="sha384-f6iEfCywVoZB0/hIKTRaxywtS21KzhBx2JOI/uVjjU9aqFcP7X9cqLH29w2HQvLe">
<link rel="stylesheet" href="/_nuxt/Alert.fTkXFs3h.css" integrity="sha384-yFMpT5E64LAQi3qJ10AJJ1oOH3DrI68OvLSjSivjNCQXZ25pmFxlPavPQ0TEyEpq">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C3PvZR0C.js" integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ds9UYxCD.js" integrity="sha384-PFyBx6Pvk48yXM+prD4CDErW/3HFtPEqORVyAch5qDvJSyubA93+vR4jsWGRQKZs">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BUXK7nH-.js" integrity="sha384-Kqf3r1QrD7+NOn9EuK/ba9sTBZjn7vLAjnCoRtq7IKz+QV0JUUBFf1Snf1yVkkgr">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BxBriHwM.js" integrity="sha384-bejD6BN5N1iVRo5Ymn+LdVN0jvrnJTzgqgFD9xQ5+Yi46U6ff+s5W2AISzRWvJaM">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DB5Lt3x5.js" integrity="sha384-Ae/gV/4Dt4jnJApC0CWbckKJ7omq+W9Hb4jjdMyhxGJpwk6FlO7pGYMD3bPO/h1y">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D8BFaW0S.js" integrity="sha384-/m09v/yYk14L9Hra6/9jYtMTn2IdkKQvzpFPRQ5P/baRKwdZQN98873hqvwuYXFS">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/_58Q44fW.js" integrity="sha384-EdSd8jpnetO/BWDAc8C4SpQExZ7pYjMygNPvbLmiA1TaYsNUdVOqIIyOIzaErEeU">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DOCUiUcq.js" integrity="sha384-9H868K5q7MLzC8TSRXT3pVqDzsOVxZLYvUQ8cLGpHPZCFEyEJjnwSHE+/7FWrJPV">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CiTVMRA7.js" integrity="sha384-xBIJ2xO0t62/oREKqSxPtW1tRxKY+5YYXbGcJ0QR9IRM28JhL+53NOiAvVFn3rmF">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CR3F0y4K.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Bn-QuJwp.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/T_zvNmZe.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Ciddaed-.js">
<link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/Footer_Cloud.DpSdW8MR.svg">
<script type="module">
      import "@rhds/elements/rh-cta/rh-cta.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@cpelements/pfe-navigation/dist/pfe-navigation.min.js";
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">import "@rhds/elements/rh-footer/rh-footer.js"</script>
<link rel="canonical" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/securing_networks/index">
<script type="module">
      import "@rhds/elements/rh-alert/rh-alert.js";
      import "@rhds/elements/rh-code-block/rh-code-block.js";
      import '@rhds/elements/rh-cta/rh-cta.js';
      import '@patternfly/elements/pf-switch/pf-switch.js';
      import '@cpelements/rh-table/dist/rh-table.js';
      import '@patternfly/pfe-clipboard/dist/pfe-clipboard.min.js';
      import '@patternfly/elements/pf-button/pf-button.js';
      import '@patternfly/elements/pf-modal/pf-modal.js';
      import '@patternfly/elements/pf-icon/pf-icon.js';
      import '@patternfly/elements/pf-popover/pf-popover.js';
      import '@patternfly/elements/pf-tooltip/pf-tooltip.js';
      import '@rhds/elements/rh-badge/rh-badge.js';
      </script>
<meta name="description" content="Securing networks | Red Hat Documentation">
<meta name="app-version" content="v0.0.1">
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
        import "@patternfly/elements/pf-badge/pf-badge.js";
      </script>
<script type="module" src="/_nuxt/C3PvZR0C.js" crossorigin integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c"></script></head><body><div id="__nuxt"><!--[--><!--[--><!----><header data-v-edc0d12c><a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden" data-v-edc0d12c>Skip to navigation</a><a href="#main-content" class="skip-link visually-hidden" data-v-edc0d12c>Skip to content</a><nav id="upper-navigation" class="upper-navigation" aria-labelledby="upper-navigation-label" data-analytics-region="upper-navigation" data-v-edc0d12c><p id="upper-navigation-label" class="upper-nav-hidden" data-v-edc0d12c>Featured links</p><div class="upper-nav-container" data-v-edc0d12c><ul class="upper-nav-menu" data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/" class="upper-nav-links" data-analytics-text="Support" data-analytics-category="Featured Links" data-v-edc0d12c>Support</a></li><li data-v-edc0d12c><a href="https://console.redhat.com/" class="upper-nav-links" data-analytics-text="Console" data-analytics-category="Featured Links" data-v-edc0d12c>Console</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" class="upper-nav-links" data-analytics-text="Developers" data-analytics-category="Featured Links" data-v-edc0d12c>Developers</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" class="upper-nav-links" data-analytics-text="Start a trial" data-analytics-category="Featured Links" data-v-edc0d12c>Start a trial</a></li><li data-v-edc0d12c><button id="all-red-hat" class="upper-nav-links" data-analytics-text="All Red Hat" data-analytics-category="Featured Links" aria-expanded="false" data-analytics-linktype="tab" data-v-edc0d12c>All Red Hat<svg class="upper-nav-arrow" xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024" aria-hidden="true" data-v-edc0d12c=""><path d="M810.642 511.557c0 8.905-3.447 16.776-10.284 23.613L322.31 1013.216c-6.835 6.837-14.706 10.284-23.61 10.284s-16.776-3.447-23.613-10.284l-51.303-51.303c-6.837-6.837-10.284-14.707-10.284-23.612s3.447-16.775 10.284-23.61L626.972 511.5 223.784 108.31c-6.837-6.835-10.284-14.706-10.284-23.61s3.447-16.776 10.284-23.613l51.303-51.303C281.924 2.947 289.794-.5 298.7-.5s16.775 3.447 23.61 10.284L800.36 487.83c6.837 6.837 10.284 14.708 10.284 23.613v.114" data-v-edc0d12c=""/></svg></button><div class="upper-nav-dropdown-container" data-v-edc0d12c><ul data-v-edc0d12c><li data-v-edc0d12c><span data-v-edc0d12c>For customers</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/support" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Customer support" data-v-edc0d12c>Customer support</a></li><li data-v-edc0d12c><a href="/products" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Documentation" data-v-edc0d12c>Documentation</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/support/cases" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Support cases" data-v-edc0d12c>Support Cases</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/management" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Subscription management" data-v-edc0d12c>Subscription management</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/" data-analytics-category="All Red Hat|For customers" data-analytics-text="Red Hat Ecosystem Catalog" data-v-edc0d12c>Red Hat Ecosystem Catalog</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/partners" data-analytics-category="All Red Hat|For customers" data-analytics-text="Find a partner" data-v-edc0d12c>Find a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>For partners</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://connect.redhat.com/login" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner login" data-v-edc0d12c>Partner login</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/en/support" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner support" data-v-edc0d12c>Partner support</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Become a partner " data-v-edc0d12c>Become a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Try, buy, &amp; sell</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://marketplace.redhat.com/en-us" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Marketplace" data-v-edc0d12c>Red Hat Marketplace</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/store" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Store" data-v-edc0d12c>Red Hat Store</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/contact" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Contact sales" data-v-edc0d12c>Contact Sales</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Learning resources</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.redhat.com/en/services/training-and-certification" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Training and certification " data-v-edc0d12c>Training and certification</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" data-pzn-audience="developers|community" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="For developers" data-v-edc0d12c>For developers</a></li><li data-v-edc0d12c><a href="https://cloud.redhat.com/learn" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Hybrid cloud learning hub" data-v-edc0d12c>Hybrid cloud learning hub</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Interactive labs" data-v-edc0d12c>Interactive labs</a></li><li data-v-edc0d12c><a href="https://learn.redhat.com/" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Learning community" data-v-edc0d12c>Learning community</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/tv" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Red Hat TV" data-v-edc0d12c>Red Hat TV</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Open source communities</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.ansible.com/community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="Ansible" data-v-edc0d12c>Ansible</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/sysadmin/" id="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For system administrators" data-v-edc0d12c>For system administrators</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/architect/" data-pzn-audience="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For architects" data-v-edc0d12c>For architects</a></li></ul></li></ul></div></li></ul></div></nav><pfe-navigation full-width id="pfe-navigation" pf-sticky="true" lang="en" data-v-edc0d12c><nav class="pfe-navigation" aria-label="Main Navigation" data-v-edc0d12c><div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper" data-v-edc0d12c><a href="/en" class="pfe-navigation__logo-link" data-v-edc0d12c><img class="pfe-navigation__logo-image pfe-navigation__logo-image--screen pfe-navigation__logo-image--small" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" width="240" height="40" alt="Red Hat Documentation" data-v-edc0d12c></a></div></nav><span data-v-edc0d12c></span><div slot="secondary-links" data-v-edc0d12c><div class="hidden-at-desktop hidden-at-tablet search-mobile" data-v-edc0d12c><div id="search-form" class="search-container" opensearchbox="true" data-v-edc0d12c data-v-69710f44><form role="search" class="form-box" autocomplete="off" data-v-69710f44><div class="search-box" data-v-69710f44><pf-icon icon="search" size="md" class="search-icon-form" data-v-69710f44></pf-icon><input type="text" id="input-search" class="input-search-box" placeholder="Search documentation" value aria-autocomplete="list" data-v-69710f44><!----><!----><!----><rh-button disabled variant="tertiary" class="form-submit-btn" data-v-69710f44><img src="data:image/svg+xml,%3csvg%20width=&#39;14&#39;%20height=&#39;14&#39;%20viewBox=&#39;0%200%2014%2014&#39;%20fill=&#39;none&#39;%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3cpath%20d=&#39;M7%200L5.6%201.4L10.3%206H0V8H10.3L5.6%2012.6L7%2014L14%207L7%200Z&#39;%20fill=&#39;%23707070&#39;/%3e%3c/svg%3e" alt="Submit button" data-v-69710f44></rh-button></div></form><!----></div></div><div class="hidden-at-desktop hidden-at-tablet buttons" data-v-edc0d12c><a href="https://access.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Support" data-v-edc0d12c>Support</a><a href="https://console.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Console" data-v-edc0d12c>Console</a><a href="https://developers.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Developers" data-v-edc0d12c>Developers</a><a href="https://www.redhat.com/en/products/trials" data-analytics-category="More Red Hat" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a><a href="https://www.redhat.com/en/contact" data-analytics-category="More Red Hat" data-analytics-text="Contact" data-v-edc0d12c>Contact</a></div><div class="hidden-at-desktop hidden-at-tablet mobile-lang-select" data-v-edc0d12c><label for="lang_selection" data-v-edc0d12c>Select your language</label><select id="lang_selection" data-v-edc0d12c><!--[--><option value="en" xml:lang="en" hreflang="en" data-v-edc0d12c>English</option><option value="fr" xml:lang="fr" hreflang="fr" data-v-edc0d12c>Français</option><option value="ko" xml:lang="ko" hreflang="ko" data-v-edc0d12c>한국어</option><option value="ja" xml:lang="ja" hreflang="ja" data-v-edc0d12c>日本語</option><option value="zh-cn" xml:lang="zh-cn" hreflang="zh-cn" data-v-edc0d12c>中文 (中国)</option><option value="de" xml:lang="de" hreflang="de" data-v-edc0d12c>Deutsch</option><option value="it" xml:lang="it" hreflang="it" data-v-edc0d12c>Italiano</option><option value="pt-br" xml:lang="pt-br" hreflang="pt-br" data-v-edc0d12c>Português</option><option value="es" xml:lang="es" hreflang="es" data-v-edc0d12c>Español</option><!--]--></select></div></div></pfe-navigation></header><main id="main-content"><!--[--><!--[--><!--[--><!----><!----><!--]--><div class="breadcrumbs" id="breadcrumbs" data-v-8589d091 data-v-798f280c><nav aria-label="Breadcrumb" class="breadcrumb" data-v-798f280c><ol data-v-798f280c><li data-v-798f280c><a href="/" data-v-798f280c>Home</a></li><li data-v-798f280c><a href="/en/products" data-v-798f280c>Products</a></li><!--[--><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/" data-v-798f280c>Red Hat Enterprise Linux</a></li><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/9/" data-v-798f280c>9</a></li><li data-v-798f280c><!--[-->Securing networks<!--]--></li><!--]--></ol></nav><span data-v-798f280c></span></div><!----><nav id="mobile-nav" class="mobile-nav" aria-label="mobile menu" data-v-8589d091><div class="mobile-nav-wrapper" data-v-8589d091><div id="first-button" data-v-8589d091><button id="toc-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><span class="sr-only" data-v-8589d091>Open </span>Table of contents</button></div><div id="second-button" data-v-8589d091><button id="settings-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><pf-icon icon="cog" size="md" data-v-8589d091></pf-icon><span class="sr-only" data-v-8589d091>Open page settings</span></button></div></div><div id="mobile-nav-content-wrapper" class="hidden" role="navigation" tabindex="0" data-v-8589d091><div id="toc-mobile" class="hidden" aria-labelledby="toc-btn" data-v-8589d091><div class="shrink-product-padding product-container" id="product-container-mobile" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter-mobile" data-v-8589d091><span id="text" part="text" data-v-8589d091><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper-mobile" class="span-xs-12 span-sm-4 span-md-3" lang="en" data-v-8589d091><nav id="mobile-toc-menu" class="table-of-contents" aria-label="table of content - mobile" data-v-8589d091><!----></nav></div><!----></div><div id="page-content-options-mobile" class="hidden" aria-labelledby="settings-btn" data-v-8589d091><div class="page-layout-options" data-v-8589d091><label for="page-format-mobile" data-v-8589d091>Format</label><select id="page-format-mobile" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div></div></div><!----><!----></nav><div class="grid grid-col-12 content-wrapper" data-v-8589d091><aside id="left-content" class="span-xs-12 span-sm-4 span-md-3" lang="en-us" aria-label="left navigation" xml:lang="en-us" data-v-8589d091><div class="toc-container" id="toc-container" visible="true" data-v-8589d091><div class="toc-focus-container" id="toc-focus-container" data-v-8589d091><button class="toc-focus-btn" aria-label="toggle left menu" aria-controls="toc-container" aria-expanded="true" data-v-8589d091><pf-icon size="md" icon="angle-left" class="toc-focus-btn-icon" data-v-8589d091></pf-icon></button></div><div class="product-container" id="product-container-desktop" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter" id="toc-filter" data-v-8589d091><span id="text" part="text" data-v-8589d091><span id="search-icon" part="search-icon" data-v-8589d091><pf-icon icon="filter" size="md" data-v-8589d091></pf-icon></span><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper" class="toc-wrapper" data-v-8589d091><nav id="toc" class="max-height-85 table-of-contents" aria-label="Table of contents" data-v-8589d091><ol id="toc-list" data-v-8589d091><!--[--><li class="item chapter" data-v-fa0dae77><a class="link active" href id="chapter-index" data-v-fa0dae77>Securing networks</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_providing-feedback-on-red-hat-documentation_securing-networks" id="chapter-landing--securing_networks-proc_providing-feedback-on-red-hat-documentation_securing-networks" data-v-fa0dae77>Providing feedback on Red Hat documentation</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks--summary" data-v-fa0dae77>1. Using secure communications between two systems with OpenSSH</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks" id="chapter-landing--securing_networks-assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks" data-v-fa0dae77>Using secure communications between two systems with OpenSSH</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ssh-and-openssh_assembly_using-secure-communications-between-two-systems-with-openssh" id="sub-link-to-securing_networks-ssh-and-openssh_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f>1.1. SSH and OpenSSH</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh" id="sub-link-to-securing_networks-generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f>1.2. Generating SSH key pairs</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-an-openssh-server-for-key-based-authentication_assembly_using-secure-communications-between-two-systems-with-openssh" id="sub-link-to-securing_networks-setting-an-openssh-server-for-key-based-authentication_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f>1.3. Setting key-based authentication as the only method on an OpenSSH server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh" id="sub-link-to-securing_networks-connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f>1.4. Caching your SSH credentials by using ssh-agent</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ssh-keys-stored-on-a-smart-card_assembly_using-secure-communications-between-two-systems-with-openssh" id="sub-link-to-securing_networks-using-ssh-keys-stored-on-a-smart-card_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f>1.5. Authenticating by SSH keys stored on a smart card</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#making-openssh-more-secure_assembly_using-secure-communications-between-two-systems-with-openssh" id="sub-link-to-securing_networks-making-openssh-more-secure_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f>1.6. Making OpenSSH more secure</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#connecting-to-a-remote-server-using-an-ssh-jump-host_assembly_using-secure-communications-between-two-systems-with-openssh" id="sub-link-to-securing_networks-connecting-to-a-remote-server-using-an-ssh-jump-host_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f>1.7. Connecting to a remote server through an SSH jump host</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f><summary class="heading sub-chapter-title" id="configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh--summary" data-v-b883c74f>1.8. Configuring secure communication with the ssh system roles</summary><ol id="sub-nav--configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh" id="chapter-landing--securing_networks-configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh" data-v-b883c74f>Configuring secure communication with the ssh system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#sshd-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles" id="sub-link-to-securing_networks-sshd-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles" data-v-b883c74f>1.8.1. Variables of the sshd RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-with-the-ssh-system-roles" id="sub-link-to-securing_networks-configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-with-the-ssh-system-roles" data-v-b883c74f>1.8.2. Configuring OpenSSH servers by using the sshd RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_ssh-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles" id="sub-link-to-securing_networks-ref_ssh-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles" data-v-b883c74f>1.8.3. Variables of the ssh RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-with-the-ssh-system-roles" id="sub-link-to-securing_networks-proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-with-the-ssh-system-roles" data-v-b883c74f>1.8.4. Configuring OpenSSH clients by using the ssh RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-with-the-ssh-system-roles" id="sub-link-to-securing_networks-proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-with-the-ssh-system-roles" data-v-b883c74f>1.8.5. Using the sshd RHEL system role for non-exclusive configuration</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources" id="sub-link-to-securing_networks-additional_resources" data-v-b883c74f>1.9. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--creating-and-managing-tls-keys-and-certificates_securing-networks" data-v-fa0dae77><summary class="heading chapter-title" id="creating-and-managing-tls-keys-and-certificates_securing-networks--summary" data-v-fa0dae77>2. Creating and managing TLS keys and certificates</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#creating-and-managing-tls-keys-and-certificates_securing-networks" id="chapter-landing--securing_networks-creating-and-managing-tls-keys-and-certificates_securing-networks" data-v-fa0dae77>Creating and managing TLS keys and certificates</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_tls-certificates_creating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-con_tls-certificates_creating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.1. TLS certificates</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-private-ca-using-openssl_creating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-creating-a-private-ca-using-openssl_creating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.2. Creating a private CA using OpenSSL</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.3. Creating a private key and a CSR for a TLS server certificate using OpenSSL</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.4. Creating a private key and a CSR for a TLS client certificate using OpenSSL</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.5. Using a private CA to issue certificates for CSRs with OpenSSL</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-private-ca-using-gnutls_creating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-creating-a-private-ca-using-gnutls_creating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.6. Creating a private CA using GnuTLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-gnutls_creating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-gnutls_creating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.7. Creating a private key and a CSR for a TLS server certificate using GnuTLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-gnutlscreating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-gnutlscreating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.8. Creating a private key and a CSR for a TLS client certificate using GnuTLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates" id="sub-link-to-securing_networks-using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates" data-v-b883c74f>2.9. Using a private CA to issue certificates for CSRs with GnuTLS</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-shared-system-certificates_securing-networks" data-v-fa0dae77><summary class="heading chapter-title" id="using-shared-system-certificates_securing-networks--summary" data-v-fa0dae77>3. Using shared system certificates</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-shared-system-certificates_securing-networks" id="chapter-landing--securing_networks-using-shared-system-certificates_securing-networks" data-v-fa0dae77>Using shared system certificates</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#the-system-wide-trust-store_using-shared-system-certificates" id="sub-link-to-securing_networks-the-system-wide-trust-store_using-shared-system-certificates" data-v-b883c74f>3.1. The system-wide truststore</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-new-certificates_using-shared-system-certificates" id="sub-link-to-securing_networks-adding-new-certificates_using-shared-system-certificates" data-v-b883c74f>3.2. Adding new certificates</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#managing-trusted-system-certificates_using-shared-system-certificates" id="sub-link-to-securing_networks-managing-trusted-system-certificates_using-shared-system-certificates" data-v-b883c74f>3.3. Managing trusted system certificates</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--planning-and-implementing-tls_securing-networks" data-v-fa0dae77><summary class="heading chapter-title" id="planning-and-implementing-tls_securing-networks--summary" data-v-fa0dae77>4. Planning and implementing TLS</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#planning-and-implementing-tls_securing-networks" id="chapter-landing--securing_networks-planning-and-implementing-tls_securing-networks" data-v-fa0dae77>Planning and implementing TLS</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ssl-and-tls-protocols_planning-and-implementing-tls" id="sub-link-to-securing_networks-ssl-and-tls-protocols_planning-and-implementing-tls" data-v-b883c74f>4.1. SSL and TLS protocols</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--security-considerations-for-tls-in-rhel_planning-and-implementing-tls" data-v-b883c74f><summary class="heading sub-chapter-title" id="security-considerations-for-tls-in-rhel_planning-and-implementing-tls--summary" data-v-b883c74f>4.2. Security considerations for TLS in RHEL 9</summary><ol id="sub-nav--security-considerations-for-tls-in-rhel_planning-and-implementing-tls" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#security-considerations-for-tls-in-rhel_planning-and-implementing-tls" id="chapter-landing--securing_networks-security-considerations-for-tls-in-rhel_planning-and-implementing-tls" data-v-b883c74f>Security considerations for TLS in RHEL 9</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#protocols" id="sub-link-to-securing_networks-protocols" data-v-b883c74f>4.2.1. Protocols</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#cipher_suites" id="sub-link-to-securing_networks-cipher_suites" data-v-b883c74f>4.2.2. Cipher suites</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#public_key_length" id="sub-link-to-securing_networks-public_key_length" data-v-b883c74f>4.2.3. Public key length</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--hardening-tls-configuration-in-applications_planning-and-implementing-tls" data-v-b883c74f><summary class="heading sub-chapter-title" id="hardening-tls-configuration-in-applications_planning-and-implementing-tls--summary" data-v-b883c74f>4.3. Hardening TLS configuration in applications</summary><ol id="sub-nav--hardening-tls-configuration-in-applications_planning-and-implementing-tls" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#hardening-tls-configuration-in-applications_planning-and-implementing-tls" id="chapter-landing--securing_networks-hardening-tls-configuration-in-applications_planning-and-implementing-tls" data-v-b883c74f>Hardening TLS configuration in applications</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-apache-http-server_planning-and-implementing-tls" id="sub-link-to-securing_networks-configuring-the-apache-http-server_planning-and-implementing-tls" data-v-b883c74f>4.3.1. Configuring the Apache HTTP server to use TLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-nginx-http-and-proxy-server_planning-and-implementing-tls" id="sub-link-to-securing_networks-configuring-the-nginx-http-and-proxy-server_planning-and-implementing-tls" data-v-b883c74f>4.3.2. Configuring the Nginx HTTP and proxy server to use TLS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-Dovecot-mail-server_planning-and-implementing-tls" id="sub-link-to-securing_networks-configuring-the-Dovecot-mail-server_planning-and-implementing-tls" data-v-b883c74f>4.3.3. Configuring the Dovecot mail server to use TLS</a></li><!--]--><!--]--></ol></details></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-a-vpn-connection_securing-networks" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-a-vpn-connection_securing-networks--summary" data-v-fa0dae77>5. Setting up an IPsec VPN</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-a-vpn-connection_securing-networks" id="chapter-landing--securing_networks-configuring-a-vpn-connection_securing-networks" data-v-fa0dae77>Setting up an IPsec VPN</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#libreswan-as-an-ipsec-vpn-implementation_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-libreswan-as-an-ipsec-vpn-implementation_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.1. Libreswan as an IPsec VPN implementation</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_authentication-methods-in-libreswan_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-con_authentication-methods-in-libreswan_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.2. Authentication methods in Libreswan</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-libreswan_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-installing-libreswan_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.3. Installing Libreswan</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-a-host-to-host-vpn_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-creating-a-host-to-host-vpn_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.4. Creating a host-to-host VPN</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-site-to-site-vpn_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-configuring-a-site-to-site-vpn_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.5. Configuring a site-to-site VPN</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-remote-access-vpn_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-configuring-a-remote-access-vpn_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.6. Configuring a remote access VPN</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-mesh-vpn_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-configuring-a-mesh-vpn_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.7. Configuring a mesh VPN</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-a-fips-compliant-ipsec-vpn_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-deploying-a-fips-compliant-ipsec-vpn_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.8. Deploying a FIPS-compliant IPsec VPN</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#protecting-the-ipsec-nss-database-by-a-password_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-protecting-the-ipsec-nss-database-by-a-password_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.9. Protecting the IPsec NSS database by a password</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-an-ipsec-vpn-to-use-tcp_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-proc_configuring-an-ipsec-vpn-to-use-tcp_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.10. Configuring an IPsec VPN to use TCP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-automatic-detection-and-usage-of-esp-hardware-offload-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-proc_configuring-automatic-detection-and-usage-of-esp-hardware-offload-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.11. Configuring automatic detection and usage of ESP hardware offload to accelerate an IPsec connection</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-esp-hardware-offload-on-a-bond-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-proc_configuring-esp-hardware-offload-on-a-bond-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.12. Configuring ESP hardware offload on a bond to accelerate an IPsec connection</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec" data-v-b883c74f><summary class="heading sub-chapter-title" id="assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec--summary" data-v-b883c74f>5.13. Configuring VPN connections with IPsec by using the RHEL system role</summary><ol id="sub-nav--assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec" id="chapter-landing--securing_networks-assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec" data-v-b883c74f>Configuring VPN connections with IPsec by using the RHEL system role</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" id="sub-link-to-securing_networks-proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" data-v-b883c74f>5.13.1. Creating a host-to-host VPN with IPsec by using the vpn RHEL system role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" id="sub-link-to-securing_networks-proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role" data-v-b883c74f>5.13.2. Creating an opportunistic mesh VPN connection with IPsec by using the vpn RHEL system role</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-ipsec-connections-that-opt-out-of-the-system-wide-crypto-policies_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-configuring-ipsec-connections-that-opt-out-of-the-system-wide-crypto-policies_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.14. Configuring IPsec connections that opt out of the system-wide crypto policies</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_troubleshooting-ipsec-vpn-configurations_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-ref_troubleshooting-ipsec-vpn-configurations_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.15. Troubleshooting IPsec VPN configurations</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-VPN-connection-with-control-center_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-configuring-a-VPN-connection-with-control-center_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.16. Configuring a VPN connection with control-center</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-vpn-connection-using-nm-connection-editor_configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-configuring-a-vpn-connection-using-nm-connection-editor_configuring-a-vpn-with-ipsec" data-v-b883c74f>5.17. Configuring a VPN connection using nm-connection-editor</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec" data-v-b883c74f><summary class="heading sub-chapter-title" id="configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec--summary" data-v-b883c74f>5.18. Configuring an IPsec based VPN connection by using nmstatectl</summary><ol id="sub-nav--configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec" id="chapter-landing--securing_networks-configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec" data-v-b883c74f>Configuring an IPsec based VPN connection by using nmstatectl</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-host-to-subnet-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" id="sub-link-to-securing_networks-configuring-a-host-to-subnet-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" data-v-b883c74f>5.18.1. Configuring a host-to-subnet IPSec VPN with PKI authentication and tunnel mode by using nmstatectl</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-host-to-subnet-ipsec-vpn-with-rsa-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" id="sub-link-to-securing_networks-configuring-a-host-to-subnet-ipsec-vpn-with-rsa-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" data-v-b883c74f>5.18.2. Configuring a host-to-subnet IPSec VPN with RSA authentication and tunnel mode by using nmstatectl</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-host-to-subnet-ipsec-vpn-with-psk-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" id="sub-link-to-securing_networks-configuring-a-host-to-subnet-ipsec-vpn-with-psk-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" data-v-b883c74f>5.18.3. Configuring a host-to-subnet IPSec VPN with PSK authentication and tunnel mode by using nmstatectl</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-host-to-host-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" id="sub-link-to-securing_networks-configuring-a-host-to-host-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" data-v-b883c74f>5.18.4. Configuring a host-to-host IPsec VPN with PKI authentication and tunnel mode by using nmstatectl</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-host-to-host-ipsec-vpn-with-psk-authentication-and-transport-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" id="sub-link-to-securing_networks-configuring-a-host-to-host-ipsec-vpn-with-psk-authentication-and-transport-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl" data-v-b883c74f>5.18.5. Configuring a host-to-host IPsec VPN with PSK authentication and transport mode by using nmstatectl</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#related-information-configuring-a-vpn-with-ipsec" id="sub-link-to-securing_networks-related-information-configuring-a-vpn-with-ipsec" data-v-b883c74f>5.19. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--securing-network-services_securing-networks" data-v-fa0dae77><summary class="heading chapter-title" id="securing-network-services_securing-networks--summary" data-v-fa0dae77>6. Securing network services</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#securing-network-services_securing-networks" id="chapter-landing--securing_networks-securing-network-services_securing-networks" data-v-fa0dae77>Securing network services</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#securing-the-rpcbind-service_securing-network-services" id="sub-link-to-securing_networks-securing-the-rpcbind-service_securing-network-services" data-v-b883c74f>6.1. Securing the rpcbind service</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#securing-the-rpc-mountd-service_securing-network-services" id="sub-link-to-securing_networks-securing-the-rpc-mountd-service_securing-network-services" data-v-b883c74f>6.2. Securing the rpc.mountd service</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--securing-the-nfs-service_securing-network-services" data-v-b883c74f><summary class="heading sub-chapter-title" id="securing-the-nfs-service_securing-network-services--summary" data-v-b883c74f>6.3. Securing the NFS service</summary><ol id="sub-nav--securing-the-nfs-service_securing-network-services" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#securing-the-nfs-service_securing-network-services" id="chapter-landing--securing_networks-securing-the-nfs-service_securing-network-services" data-v-b883c74f>Securing the NFS service</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#export-options-for-securing-an-nfs-server_securing-the-nfs-service" id="sub-link-to-securing_networks-export-options-for-securing-an-nfs-server_securing-the-nfs-service" data-v-b883c74f>6.3.1. Export options for securing an NFS server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#mount-options-for-securing-an-nfs-client_securing-the-nfs-service" id="sub-link-to-securing_networks-mount-options-for-securing-an-nfs-client_securing-the-nfs-service" data-v-b883c74f>6.3.2. Mount options for securing an NFS client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#securing-nfs-with-firewall_securing-the-nfs-service" id="sub-link-to-securing_networks-securing-nfs-with-firewall_securing-the-nfs-service" data-v-b883c74f>6.3.3. Securing NFS with firewall</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--securing-the-ftp-service_securing-network-services" data-v-b883c74f><summary class="heading sub-chapter-title" id="securing-the-ftp-service_securing-network-services--summary" data-v-b883c74f>6.4. Securing the FTP service</summary><ol id="sub-nav--securing-the-ftp-service_securing-network-services" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#securing-the-ftp-service_securing-network-services" id="chapter-landing--securing_networks-securing-the-ftp-service_securing-network-services" data-v-b883c74f>Securing the FTP service</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#securing-the-ftp-greeting-banner_securing-the-ftp-service" id="sub-link-to-securing_networks-securing-the-ftp-greeting-banner_securing-the-ftp-service" data-v-b883c74f>6.4.1. Securing the FTP greeting banner</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#preventing-anonymous-access-and-uploads-in-ftp_securing-the-ftp-service" id="sub-link-to-securing_networks-preventing-anonymous-access-and-uploads-in-ftp_securing-the-ftp-service" data-v-b883c74f>6.4.2. Preventing anonymous access and uploads in FTP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#securing-user-accounts-for-ftp_securing-the-ftp-service" id="sub-link-to-securing_networks-securing-user-accounts-for-ftp_securing-the-ftp-service" data-v-b883c74f>6.4.3. Securing user accounts for FTP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_2" id="sub-link-to-securing_networks-additional_resources_2" data-v-b883c74f>6.4.4. Additional resources</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--securing-http-servers_securing-network-services" data-v-b883c74f><summary class="heading sub-chapter-title" id="securing-http-servers_securing-network-services--summary" data-v-b883c74f>6.5. Securing HTTP servers</summary><ol id="sub-nav--securing-http-servers_securing-network-services" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#securing-http-servers_securing-network-services" id="chapter-landing--securing_networks-securing-http-servers_securing-network-services" data-v-b883c74f>Securing HTTP servers</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#security-enhancements-in-http-conf_securing-http-servers" id="sub-link-to-securing_networks-security-enhancements-in-http-conf_securing-http-servers" data-v-b883c74f>6.5.1. Security enhancements in httpd.conf</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#securing-the-nginx-server_securing-http-servers" id="sub-link-to-securing_networks-securing-the-nginx-server_securing-http-servers" data-v-b883c74f>6.5.2. Securing the Nginx server configuration</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#securing-postgresql-by-limiting-access-to-authenticated-local-users_securing-network-services" id="sub-link-to-securing_networks-securing-postgresql-by-limiting-access-to-authenticated-local-users_securing-network-services" data-v-b883c74f>6.6. Securing PostgreSQL by limiting access to authenticated local users</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--securing-the-memcached-service_securing-network-services" data-v-b883c74f><summary class="heading sub-chapter-title" id="securing-the-memcached-service_securing-network-services--summary" data-v-b883c74f>6.7. Securing the Memcached service</summary><ol id="sub-nav--securing-the-memcached-service_securing-network-services" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#securing-the-memcached-service_securing-network-services" id="chapter-landing--securing_networks-securing-the-memcached-service_securing-network-services" data-v-b883c74f>Securing the Memcached service</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#hardening-memcached-against-ddos_securing-the-memcached-service" id="sub-link-to-securing_networks-hardening-memcached-against-ddos_securing-the-memcached-service" data-v-b883c74f>6.7.1. Hardening Memcached against DDoS</a></li><!--]--><!--]--></ol></details></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks--summary" data-v-fa0dae77>7. Using MACsec to encrypt layer-2 traffic in the same physical network</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks" id="chapter-landing--securing_networks-assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks" data-v-fa0dae77>Using MACsec to encrypt layer-2 traffic in the same physical network</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#how-macsec-increases-security_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network" id="sub-link-to-securing_networks-how-macsec-increases-security_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network" data-v-b883c74f>7.1. How MACsec increases security</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-a-macsec-connection-using-nmcli_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network" id="sub-link-to-securing_networks-proc_configuring-a-macsec-connection-using-nmcli_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network" data-v-b883c74f>7.2. Configuring a MACsec connection by using nmcli</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-macsec-connection-using-nmstatectl_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network" id="sub-link-to-securing_networks-configuring-a-macsec-connection-using-nmstatectl_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network" data-v-b883c74f>7.3. Configuring a MACsec connection by using nmstatectl</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_securing-the-postfix-service_securing-networks" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_securing-the-postfix-service_securing-networks--summary" data-v-fa0dae77>8. Securing the Postfix service</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_securing-the-postfix-service_securing-networks" id="chapter-landing--securing_networks-assembly_securing-the-postfix-service_securing-networks" data-v-fa0dae77>Securing the Postfix service</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_reducing-postfix-network-related-security-risks_assembly_securing-the-postfix-service" id="sub-link-to-securing_networks-ref_reducing-postfix-network-related-security-risks_assembly_securing-the-postfix-service" data-v-b883c74f>8.1. Reducing Postfix network-related security risks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_postfix-configuration-options-for-limiting-dos-attacks_assembly_securing-the-postfix-service" id="sub-link-to-securing_networks-ref_postfix-configuration-options-for-limiting-dos-attacks_assembly_securing-the-postfix-service" data-v-b883c74f>8.2. Postfix configuration options for limiting DoS attacks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_configuring-postfix-to-use-sasl_assembly_securing-the-postfix-service" id="sub-link-to-securing_networks-proc_configuring-postfix-to-use-sasl_assembly_securing-the-postfix-service" data-v-b883c74f>8.3. Configuring Postfix to use SASL</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#idm140078480740000" id="chapter-landing--securing_networks-idm140078480740000" data-v-fa0dae77>Legal Notice</a></li><!--]--></ol></nav><!----></div></div></aside><article class="content span-xs-12 span-sm-6 span-md-12 span-lg-7" aria-live="polite" data-v-8589d091><!----><div lang="en-us" xml:lang="en-us" class="docs-content-container" data-v-8589d091><!----><!----><h1 data-id="content_chapter" class="chapter-title" data-v-8589d091>Securing networks</h1><hr class="line-below-chp" data-v-8589d091><section class="rhdocs" data-v-8589d091><body><div xml:lang="en-US" class="book" id="idm140078481333328"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">9</span></div><div><h3 class="subtitle">Configuring secured networks and network communication</h3></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="#idm140078480740000">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				Learn the tools and techniques to improve the security of your networks and lower the risks of data breaches and intrusions.
			</div></div></div></div><hr></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_securing-networks"><div class="titlepage"><div><div><h2 class="title">Providing feedback on Red Hat documentation</h2></div></div></div><p class="_abstract _abstract">
			We appreciate your feedback on our documentation. Let us know how we can improve it.
		</p><div class="orderedlist"><p class="title"><strong>Submitting feedback through Jira (account required)</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in to the <a class="link" href="https://issues.redhat.com/projects/RHELDOCS/issues">Jira</a> website.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> in the top navigation bar
				</li><li class="listitem">
					Enter a descriptive title in the <span class="strong strong"><strong>Summary</strong></span> field.
				</li><li class="listitem">
					Enter your suggestion for improvement in the <span class="strong strong"><strong>Description</strong></span> field. Include links to the relevant parts of the documentation.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> at the bottom of the dialogue.
				</li></ol></div></section><section class="chapter" id="assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Using secure communications between two systems with OpenSSH</h2></div></div></div><p class="_abstract _abstract">
			SSH (Secure Shell) is a protocol which provides secure communications between two systems using a client-server architecture and allows users to log in to server host systems remotely. Unlike other remote communication protocols, such as FTP or Telnet, SSH encrypts the login session, which prevents intruders from collecting unencrypted passwords from the connection.
		</p><section class="section" id="ssh-and-openssh_assembly_using-secure-communications-between-two-systems-with-openssh"><div class="titlepage"><div><div><h3 class="title">1.1. SSH and OpenSSH</h3></div></div></div><p>
				SSH (Secure Shell) is a program for logging into a remote machine and executing commands on that machine. The SSH protocol provides secure encrypted communications between two untrusted hosts over an insecure network. You can also forward X11 connections and arbitrary TCP/IP ports over the secure channel.
			</p><p>
				The SSH protocol mitigates security threats, such as interception of communication between two systems and impersonation of a particular host, when you use it for remote shell login or file copying. This is because the SSH client and server use digital signatures to verify their identities. Additionally, all communication between the client and server systems is encrypted.
			</p><p>
				A host key authenticates hosts in the SSH protocol. Host keys are cryptographic keys that are generated automatically when OpenSSH is started for the first time or when the host boots for the first time.
			</p><p>
				OpenSSH is an implementation of the SSH protocol supported by Linux, UNIX, and similar operating systems. It includes the core files necessary for both the OpenSSH client and server. The OpenSSH suite consists of the following user-space tools:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ssh</code> is a remote login program (SSH client).
					</li><li class="listitem">
						<code class="literal">sshd</code> is an OpenSSH SSH daemon.
					</li><li class="listitem">
						<code class="literal">scp</code> is a secure remote file copy program.
					</li><li class="listitem">
						<code class="literal">sftp</code> is a secure file transfer program.
					</li><li class="listitem">
						<code class="literal">ssh-agent</code> is an authentication agent for caching private keys.
					</li><li class="listitem">
						<code class="literal">ssh-add</code> adds private key identities to <code class="literal">ssh-agent</code>.
					</li><li class="listitem">
						<code class="literal">ssh-keygen</code> generates, manages, and converts authentication keys for <code class="literal">ssh</code>.
					</li><li class="listitem">
						<code class="literal">ssh-copy-id</code> is a script that adds local public keys to the <code class="literal">authorized_keys</code> file on a remote SSH server.
					</li><li class="listitem">
						<code class="literal">ssh-keyscan</code> gathers SSH public host keys.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In RHEL 9, the Secure copy protocol (SCP) is replaced with the SSH File Transfer Protocol (SFTP) by default. This is because SCP has already caused security issues, for example <a class="link" href="https://access.redhat.com/security/cve/CVE-2020-15778">CVE-2020-15778</a>.
				</p><p>
					If SFTP is unavailable or incompatible in your scenario, you can use the <code class="literal">scp</code> command with the <code class="literal">-O</code> option to force the use of the original SCP/RCP protocol.
				</p><p>
					For additional information, see the <a class="link" href="https://access.redhat.com/articles/6955319">OpenSSH SCP protocol deprecation in Red Hat Enterprise Linux 9</a> article.
				</p></div></rh-alert><p>
				The OpenSSH suite in RHEL supports only SSH version 2. It has an enhanced key-exchange algorithm that is not vulnerable to exploits known in the older version 1.
			</p><p>
				Red Hat Enterprise Linux includes the following <code class="literal">OpenSSH</code> packages: the general <code class="literal">openssh</code> package, the <code class="literal">openssh-server</code> package, and the <code class="literal">openssh-clients</code> package. The <code class="literal">OpenSSH</code> packages require the <code class="literal">OpenSSL</code> package <code class="literal">openssl-libs</code>, which installs several important cryptographic libraries that enable <code class="literal">OpenSSH</code> to provide encrypted communications.
			</p><p>
				OpenSSH, as one of core cryptographic subsystems of RHEL, uses system-wide crypto policies. This ensures that weak cipher suites and cryptographic algorithms are disabled in the default configuration. To modify the policy, the administrator must either use the <code class="literal">update-crypto-policies</code> command to adjust the settings or manually opt out of the system-wide crypto policies. See the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening#excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies">Excluding an application from following system-wide crypto policies</a> section for more information.
			</p><p>
				The OpenSSH suite uses two sets of configuration files: one for client programs (that is, <code class="literal">ssh</code>, <code class="literal">scp</code>, and <code class="literal">sftp</code>), and another for the server (the <code class="literal">sshd</code> daemon).
			</p><p>
				System-wide SSH configuration information is stored in the <code class="literal">/etc/ssh/</code> directory. The <code class="literal">/etc/ssh/ssh_config</code> file contains the client configuration, and the <code class="literal">/etc/ssh/sshd_config</code> file is the default OpenSSH server configuration file.
			</p><p>
				User-specific SSH configuration information is stored in <code class="literal">~/.ssh/</code> in the user’s home directory. For a detailed list of OpenSSH configuration files, see the <code class="literal">FILES</code> section in the <code class="literal">sshd(8)</code> man page on your system.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Man pages listed by using the <code class="literal">man -k ssh</code> command on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>
					</li></ul></div></section><section class="section" id="generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh"><div class="titlepage"><div><div><h3 class="title">1.2. Generating SSH key pairs</h3></div></div></div><p>
				You can log in to an OpenSSH server without entering a password by generating an SSH key pair on a local system and copying the generated public key to the OpenSSH server. Each user who wants to create a key must run this procedure.
			</p><p>
				To preserve previously generated key pairs after you reinstall the system, back up the <code class="literal">~/.ssh/</code> directory before you create new keys. After reinstalling, copy it back to your home directory. You can do this for all users on your system, including <code class="literal">root</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as a user who wants to connect to the OpenSSH server by using keys.
					</li><li class="listitem">
						The OpenSSH server is configured to allow key-based authentication.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate an ECDSA key pair:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh-keygen -t ecdsa</strong></span>
Generating public/private ecdsa key pair.
Enter file in which to save the key (/home/<span class="emphasis"><em>&lt;username&gt;</em></span>/.ssh/id_ecdsa):
Enter passphrase (empty for no passphrase): <span class="emphasis"><em>&lt;password&gt;</em></span>
Enter same passphrase again: <span class="emphasis"><em>&lt;password&gt;</em></span>
Your identification has been saved in /home/<span class="emphasis"><em>&lt;username&gt;</em></span>/.ssh/id_ecdsa.
Your public key has been saved in /home/<span class="emphasis"><em>&lt;username&gt;</em></span>/.ssh/id_ecdsa.pub.
The key fingerprint is:
SHA256:Q/x+qms4j7PCQ0qFd09iZEFHA+SqwBKRNaU72oZfaCI <span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;localhost.example.com&gt;</em></span>
The key's randomart image is:
+---[ECDSA 256]---+
|.oo..o=++        |
|.. o .oo .       |
|. .. o. o        |
|....o.+...       |
|o.oo.o +S .      |
|.=.+.   .o       |
|E.*+.  .  . .    |
|.=..+ +..  o     |
|  .  oo*+o.      |
+----[SHA256]-----+</pre><p class="simpara">
						You can also generate an RSA key pair by using the <code class="literal">ssh-keygen</code> command without any parameter or an Ed25519 key pair by entering the <code class="literal">ssh-keygen -t ed25519</code> command. Note that the Ed25519 algorithm is not FIPS-140-compliant, and OpenSSH does not work with Ed25519 keys in FIPS mode.
					</p></li><li class="listitem"><p class="simpara">
						Copy the public key to a remote machine:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh-copy-id <span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
<span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span>'s password:
…
Number of key(s) added: 1

Now try logging into the machine, with: "ssh '<span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span>'" and check to make sure that only the key(s) you wanted were added.</pre><p class="simpara">
						Replace <code class="literal"><span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></code> with your credentials.
					</p><p class="simpara">
						If you do not use the <code class="literal">ssh-agent</code> program in your session, the previous command copies the most recently modified <code class="literal">~/.ssh/id*.pub</code> public key if it is not yet installed. To specify another public-key file or to prioritize keys in files over keys cached in memory by <code class="literal">ssh-agent</code>, use the <code class="literal">ssh-copy-id</code> command with the <code class="literal">-i</code> option.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Log in to the OpenSSH server by using the key file:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -o PreferredAuthentications=publickey <span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">ssh-keygen(1)</code> and <code class="literal">ssh-copy-id(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="setting-an-openssh-server-for-key-based-authentication_assembly_using-secure-communications-between-two-systems-with-openssh"><div class="titlepage"><div><div><h3 class="title">1.3. Setting key-based authentication as the only method on an OpenSSH server</h3></div></div></div><p>
				To improve system security, enforce key-based authentication by disabling password authentication on your OpenSSH server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">openssh-server</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">sshd</code> daemon is running on the server.
					</li><li class="listitem"><p class="simpara">
						You can already connect to the OpenSSH server by using a key.
					</p><p class="simpara">
						See the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh">Generating SSH key pairs</a> section for details.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the <code class="literal">/etc/ssh/sshd_config</code> configuration in a text editor, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>vi /etc/ssh/sshd_config</strong></span></pre></li><li class="listitem"><p class="simpara">
						Change the <code class="literal">PasswordAuthentication</code> option to <code class="literal">no</code>:
					</p><pre class="screen">PasswordAuthentication no</pre></li><li class="listitem">
						On a system other than a new default installation, check that the <code class="literal">PubkeyAuthentication</code> parameter is either not set or set to <code class="literal">yes</code>.
					</li><li class="listitem"><p class="simpara">
						Set the <code class="literal">KbdInteractiveAuthentication</code> directive to <code class="literal">no</code>.
					</p><p class="simpara">
						Note that the corresponding entry is commented out in the configuration file and the default value is <code class="literal">yes</code>.
					</p></li><li class="listitem"><p class="simpara">
						To use key-based authentication with NFS-mounted home directories, enable the <code class="literal">use_nfs_home_dirs</code> SELinux boolean:
					</p><pre class="screen"># <span class="strong strong"><strong>setsebool -P use_nfs_home_dirs 1</strong></span></pre></li><li class="listitem">
						If you are connected remotely, not using console or out-of-band access, test the key-based login process before disabling password authentication.
					</li><li class="listitem"><p class="simpara">
						Reload the <code class="literal">sshd</code> daemon to apply the changes:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl reload sshd</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">sshd_config(5)</code> and <code class="literal">setsebool(8)</code> man pages on your system
					</li></ul></div></section><section class="section" id="connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh"><div class="titlepage"><div><div><h3 class="title">1.4. Caching your SSH credentials by using ssh-agent</h3></div></div></div><p>
				To avoid entering a passphrase each time you initiate an SSH connection, you can use the <code class="literal">ssh-agent</code> utility to cache the private SSH key for a login session. If the agent is running and your keys are unlocked, you can log in to SSH servers by using these keys but without having to enter the key’s password again. The private key and the passphrase remain secure.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have a remote host with the SSH daemon running and reachable through the network.
					</li><li class="listitem">
						You know the IP address or hostname and credentials to log in to the remote host.
					</li><li class="listitem"><p class="simpara">
						You have generated an SSH key pair with a passphrase and transferred the public key to the remote machine.
					</p><p class="simpara">
						See the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh">Generating SSH key pairs</a> section for details.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the command for automatically starting <code class="literal">ssh-agent</code> in your session to the <code class="literal">~/.bashrc</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Open <code class="literal">~/.bashrc</code> in a text editor of your choice, for example:
							</p><pre class="screen">$ <span class="strong strong"><strong>vi ~/.bashrc</strong></span></pre></li><li class="listitem"><p class="simpara">
								Add the following line to the file:
							</p><pre class="screen">eval $(ssh-agent)</pre></li><li class="listitem">
								Save the changes, and quit the editor.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Add the following line to the <code class="literal">~/.ssh/config</code> file:
					</p><pre class="screen">AddKeysToAgent yes</pre><p class="simpara">
						With this option and <code class="literal">ssh-agent</code> started in your session, the agent prompts for a password only for the first time when you connect to a host.
					</p></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Log in to a host which uses the corresponding public key of the cached private key in the agent, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>&lt;example.user&gt;</em></span>@<span class="emphasis"><em>&lt;ssh-server@example.com&gt;</em></span></strong></span></pre><p class="simpara">
						Note that you did not have to enter the passphrase.
					</p></li></ul></div></section><section class="section" id="using-ssh-keys-stored-on-a-smart-card_assembly_using-secure-communications-between-two-systems-with-openssh"><div class="titlepage"><div><div><h3 class="title">1.5. Authenticating by SSH keys stored on a smart card</h3></div></div></div><p>
				You can create and store ECDSA and RSA keys on a smart card and authenticate by the smart card on an OpenSSH client. Smart-card authentication replaces the default password authentication.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						On the client side, the <code class="literal">opensc</code> package is installed and the <code class="literal">pcscd</code> service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						List all keys provided by the OpenSC PKCS #11 module including their PKCS #11 URIs and save the output to the <code class="literal">keys.pub</code> file:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh-keygen -D pkcs11: &gt; keys.pub</strong></span></pre></li><li class="listitem"><p class="simpara">
						Transfer the public key to the remote server. Use the <code class="literal">ssh-copy-id</code> command with the <code class="literal">keys.pub</code> file created in the previous step:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh-copy-id -f -i keys.pub <span class="emphasis"><em>&lt;username@ssh-server-example.com&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Connect to <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span> by using the ECDSA key. You can use just a subset of the URI, which uniquely references your key, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i "pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so" <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
Enter PIN for 'SSH key':
[ssh-server-example.com] $</pre><p class="simpara">
						Because OpenSSH uses the <code class="literal">p11-kit-proxy</code> wrapper and the OpenSC PKCS #11 module is registered to the <code class="literal">p11-kit</code> tool, you can simplify the previous command:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i "pkcs11:id=%01" <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
Enter PIN for 'SSH key':
[ssh-server-example.com] $</pre><p class="simpara">
						If you skip the <code class="literal">id=</code> part of a PKCS #11 URI, OpenSSH loads all keys that are available in the proxy module. This can reduce the amount of typing required:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -i pkcs11: <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
Enter PIN for 'SSH key':
[ssh-server-example.com] $</pre></li><li class="listitem"><p class="simpara">
						Optional: You can use the same URI string in the <code class="literal">~/.ssh/config</code> file to make the configuration permanent:
					</p><pre class="screen">$ <span class="strong strong"><strong>cat ~/.ssh/config</strong></span>
IdentityFile "pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so"
$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>&lt;ssh-server-example.com&gt;</em></span></strong></span>
Enter PIN for 'SSH key':
[ssh-server-example.com] $</pre><p class="simpara">
						The <code class="literal">ssh</code> client utility now automatically uses this URI and the key from the smart card.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">p11-kit(8)</code>, <code class="literal">opensc.conf(5)</code>, <code class="literal">pcscd(8)</code>, <code class="literal">ssh(1)</code>, and <code class="literal">ssh-keygen(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="making-openssh-more-secure_assembly_using-secure-communications-between-two-systems-with-openssh"><div class="titlepage"><div><div><h3 class="title">1.6. Making OpenSSH more secure</h3></div></div></div><p>
				You can tweak the system to increase security when using OpenSSH.
			</p><p>
				Note that changes in the <code class="literal">/etc/ssh/sshd_config</code> OpenSSH server configuration file require reloading the <code class="literal">sshd</code> daemon to take effect:
			</p><pre class="screen"># <span class="strong strong"><strong>systemctl reload sshd</strong></span></pre><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The majority of security hardening configuration changes reduce compatibility with clients that do not support up-to-date algorithms or cipher suites.
				</p></div></rh-alert><div class="variablelist"><dl class="variablelist"><dt><span class="term">Disabling insecure connection protocols</span></dt><dd>
							To make SSH truly effective, prevent the use of insecure connection protocols that are replaced by the OpenSSH suite. Otherwise, a user’s password might be protected using SSH for one session only to be captured later when logging in using Telnet.
						</dd><dt><span class="term">Disabling password-based authentication</span></dt><dd>
							Disabling passwords for authentication and allowing only key pairs reduces the attack surface. See the <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#setting-an-openssh-server-for-key-based-authentication_assembly_using-secure-communications-between-two-systems-with-openssh">Setting key-based authentication as the only method on an OpenSSH server</a> section for more information.
						</dd><dt><span class="term">Stronger key types</span></dt><dd><p class="simpara">
							Although the <code class="literal">ssh-keygen</code> command generates a pair of RSA keys by default, you can instruct it to generate Elliptic Curve Digital Signature Algorithm (ECDSA) or Edwards-Curve 25519 (Ed25519) keys by using the <code class="literal">-t</code> option. The ECDSA offers better performance than RSA at the equivalent symmetric key strength. It also generates shorter keys. The Ed25519 public-key algorithm is an implementation of twisted Edwards curves that is more secure and also faster than RSA, DSA, and ECDSA.
						</p><p class="simpara">
							OpenSSH creates RSA, ECDSA, and Ed25519 server host keys automatically if they are missing. To configure the host key creation in RHEL, use the <code class="literal">sshd-keygen@.service</code> instantiated service. For example, to disable the automatic creation of the RSA key type:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl mask sshd-keygen@rsa.service</strong></span>
# <span class="strong strong"><strong>rm -f /etc/ssh/ssh_host_rsa_key</strong></span>*
# <span class="strong strong"><strong>systemctl restart sshd</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								In images with the <code class="literal">cloud-init</code> method enabled, the <code class="literal">ssh-keygen</code> units are automatically disabled. This is because the <code class="literal">ssh-keygen template</code> service can interfere with the <code class="literal">cloud-init</code> tool and cause problems with host key generation. To prevent these problems the <code class="literal">etc/systemd/system/sshd-keygen@.service.d/disable-sshd-keygen-if-cloud-init-active.conf</code> drop-in configuration file disables the <code class="literal">ssh-keygen</code> units if <code class="literal">cloud-init</code> is running.
							</p></div></rh-alert><p class="simpara">
							To allow only a particular key type for SSH connections, remove a comment out at the beginning of the relevant line in <code class="literal">/etc/ssh/sshd_config</code>, and reload the <code class="literal">sshd</code> service. For example, to allow only Ed25519 host keys, the corresponding lines must be as follows:
						</p><pre class="screen"># HostKey /etc/ssh/ssh_host_rsa_key
# HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key</pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
								The Ed25519 algorithm is not FIPS-140-compliant, and OpenSSH does not work with Ed25519 keys in FIPS mode.
							</p></div></rh-alert></dd><dt><span class="term">Non-default port</span></dt><dd><p class="simpara">
							By default, the <code class="literal">sshd</code> daemon listens on TCP port 22. Changing the port reduces the exposure of the system to attacks based on automated network scanning on the default port and therefore increases security through obscurity. You can specify the port using the <code class="literal">Port</code> directive in the <code class="literal">/etc/ssh/sshd_config</code> configuration file.
						</p><p class="simpara">
							You also have to update the default SELinux policy to allow the use of a non-default port. To do so, use the <code class="literal">semanage</code> tool from the <code class="literal">policycoreutils-python-utils</code> package:
						</p><pre class="screen"># <span class="strong strong"><strong>semanage port -a -t ssh_port_t -p tcp <span class="emphasis"><em>&lt;port-number&gt;</em></span></strong></span></pre><p class="simpara">
							Furthermore, update <code class="literal">firewalld</code> configuration:
						</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-port <span class="emphasis"><em>&lt;port-number&gt;</em></span>/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --remove-port=22/tcp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre><p class="simpara">
							In the previous commands, replace <span class="emphasis"><em>&lt;port-number&gt;</em></span> with the new port number specified using the <code class="literal">Port</code> directive.
						</p></dd><dt><span class="term">Root login</span></dt><dd><p class="simpara">
							<code class="literal">PermitRootLogin</code> is set to <code class="literal">prohibit-password</code> by default. This enforces the use of key-based authentication instead of the use of passwords for logging in as root and reduces risks by preventing brute-force attacks.
						</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
								Enabling logging in as the root user is not a secure practice because the administrator cannot audit which users run which privileged commands. For using administrative commands, log in and use <code class="literal">sudo</code> instead.
							</p></div></rh-alert></dd><dt><span class="term">Using the X Security extension</span></dt><dd><p class="simpara">
							The X server in Red Hat Enterprise Linux clients does not provide the X Security extension. Therefore, clients cannot request another security layer when connecting to untrusted SSH servers with X11 forwarding. Most applications are not able to run with this extension enabled anyway.
						</p><p class="simpara">
							By default, the <code class="literal">ForwardX11Trusted</code> option in the <code class="literal">/etc/ssh/ssh_config.d/50-redhat.conf</code> file is set to <code class="literal">yes</code>, and there is no difference between the <code class="literal">ssh -X remote_machine</code> (untrusted host) and <code class="literal">ssh -Y remote_machine</code> (trusted host) command.
						</p><p class="simpara">
							If your scenario does not require the X11 forwarding feature at all, set the <code class="literal">X11Forwarding</code> directive in the <code class="literal">/etc/ssh/sshd_config</code> configuration file to <code class="literal">no</code>.
						</p></dd><dt><span class="term">Restricting SSH access to specific users, groups, or IP ranges</span></dt><dd><p class="simpara">
							The <code class="literal">AllowUsers</code> and <code class="literal">AllowGroups</code> directives in the <code class="literal">/etc/ssh/sshd_config</code> configuration file server enable you to permit only certain users, domains, or groups to connect to your OpenSSH server. You can combine <code class="literal">AllowUsers</code> and <code class="literal">AllowGroups</code> to restrict access more precisely, for example:
						</p><pre class="screen">AllowUsers *@192.168.1.* *@10.0.0.* !*@192.168.1.2
AllowGroups example-group</pre><p class="simpara">
							This configuration allows only connections if all of the following conditions meet:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									The connection’s source IP is within the 192.168.1.0/24 or 10.0.0.0/24 subnet.
								</li><li class="listitem">
									The source IP is not 192.168.1.2.
								</li><li class="listitem">
									The user is a member of the example-group group.
								</li></ul></div><p class="simpara">
							The OpenSSH server permits only connections that pass all Allow and Deny directives in <code class="literal">/etc/ssh/sshd_config</code>. For example, if the <code class="literal">AllowUsers</code> directive lists a user that is not part of a group listed in the <code class="literal">AllowGroups</code> directive, then the user cannot log in.
						</p><p class="simpara">
							Note that using allowlists (directives starting with Allow) is more secure than using blocklists (options starting with Deny) because allowlists block also new unauthorized users or groups.
						</p></dd><dt><span class="term">Changing system-wide cryptographic policies</span></dt><dd><p class="simpara">
							OpenSSH uses RHEL system-wide cryptographic policies, and the default system-wide cryptographic policy level offers secure settings for current threat models. To make your cryptographic settings more strict, change the current policy level:
						</p><pre class="screen"># <span class="strong strong"><strong>update-crypto-policies --set FUTURE</strong></span>
Setting system policy to FUTURE</pre><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
								If your system communicates with legacy systems, you might face interoperability problems due to the strict setting of the <code class="literal">FUTURE</code> policy.
							</p></div></rh-alert></dd></dl></div><p>
				You can also disable only specific ciphers for the SSH protocol through the system-wide cryptographic policies. See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening#customizing-system-wide-cryptographic-policies-with-subpolicies_using-the-system-wide-cryptographic-policies">Customizing system-wide cryptographic policies with subpolicies</a> section in the Security hardening document for more information.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Opting out of system-wide cryptographic policies</span></dt><dd><p class="simpara">
							To opt out of the system-wide cryptographic policies for your OpenSSH server, specify the cryptographic policy in a drop-in configuration file located in the <code class="literal">/etc/ssh/sshd_config.d/</code> directory, with a two-digit number prefix smaller than 50, so that it lexicographically precedes the <code class="literal">50-redhat.conf</code> file, and with a <code class="literal">.conf</code> suffix, for example, <code class="literal">49-crypto-policy-override.conf</code>.
						</p><p class="simpara">
							See the <code class="literal">sshd_config(5)</code> man page for more information.
						</p><p class="simpara">
							To opt out of system-wide cryptographic policies for your OpenSSH client, perform one of the following tasks:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									For a given user, override the global <code class="literal">ssh_config</code> with a user-specific configuration in the <code class="literal">~/.ssh/config</code> file.
								</li><li class="listitem">
									For the entire system, specify the cryptographic policy in a drop-in configuration file located in the <code class="literal">/etc/ssh/ssh_config.d/</code> directory, with a two-digit number prefix smaller than 50, so that it lexicographically precedes the <code class="literal">50-redhat.conf</code> file, and with a <code class="literal">.conf</code> suffix, for example, <code class="literal">49-crypto-policy-override.conf</code>.
								</li></ul></div></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">sshd_config(5)</code>, <code class="literal">ssh-keygen(1)</code>, <code class="literal">crypto-policies(7)</code>, and <code class="literal">update-crypto-policies(8)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a> in the Security hardening document
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/solutions/4410591">How to disable specific algorithms and ciphers for ssh service only</a> (Red Hat Knowledgebase)
					</li></ul></div></section><section class="section" id="connecting-to-a-remote-server-using-an-ssh-jump-host_assembly_using-secure-communications-between-two-systems-with-openssh"><div class="titlepage"><div><div><h3 class="title">1.7. Connecting to a remote server through an SSH jump host</h3></div></div></div><p>
				You can connect from your local system to a remote server through an intermediary server, also called jump host. A jump server bridges hosts from different security zones and can manage multiple client-server connections.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A jump host accepts SSH connections from your local system.
					</li><li class="listitem">
						A remote server accepts SSH connections from the jump host.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						If you connect through a jump server or more intermediary servers once, use the <code class="literal">ssh -J</code> command and specify the jump servers directly, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -J <span class="emphasis"><em>&lt;jump-1.example.com&gt;</em></span>,<span class="emphasis"><em>&lt;jump-2.example.com&gt;</em></span>,<span class="emphasis"><em>&lt;jump-3.example.com&gt;</em></span> <span class="emphasis"><em>&lt;target-server-1.example.com&gt;</em></span></strong></span></pre><p class="simpara">
						Change the host name-only notation in the previous command if the user names or SSH ports on the jump servers differ from the names and ports on the remote server, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>ssh -J <span class="emphasis"><em>&lt;example.user.1&gt;</em></span>@<span class="emphasis"><em>&lt;jump-1.example.com&gt;</em></span>:<span class="emphasis"><em>&lt;75&gt;</em></span>,<span class="emphasis"><em>&lt;example.user.2&gt;</em></span>@<span class="emphasis"><em>&lt;jump-2.example.com&gt;</em></span>:<span class="emphasis"><em>&lt;75&gt;</em></span>,<span class="emphasis"><em>&lt;example.user.3&gt;</em></span>@<span class="emphasis"><em>&lt;jump-3.example.com&gt;</em></span>:<span class="emphasis"><em>&lt;75&gt;</em></span> <span class="emphasis"><em>&lt;example.user.f&gt;</em></span>@<span class="emphasis"><em>&lt;target-server-1.example.com&gt;</em></span>:<span class="emphasis"><em>&lt;220&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						If you connect to a remote server through jump servers regularly, store the jump-server configuration in your SSH configuration file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Define the jump host by editing the <code class="literal">~/.ssh/config</code> file on your local system, for example:
							</p><pre class="screen">Host <span class="emphasis"><em>&lt;jump-server-1&gt;</em></span>
  HostName <span class="emphasis"><em>&lt;jump-1.example.com&gt;</em></span></pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										The <code class="literal">Host</code> parameter defines a name or alias for the host you can use in <code class="literal">ssh</code> commands. The value can match the real host name, but can also be any string.
									</li><li class="listitem">
										The <code class="literal">HostName</code> parameter sets the actual host name or IP address of the jump host.
									</li></ul></div></li><li class="listitem"><p class="simpara">
								Add the remote server jump configuration with the <code class="literal">ProxyJump</code> directive to <code class="literal">~/.ssh/config</code> file on your local system, for example:
							</p><pre class="screen">Host <span class="emphasis"><em>&lt;remote-server-1&gt;</em></span>
  HostName <span class="emphasis"><em>&lt;target-server-1.example.com&gt;</em></span>
  ProxyJump <span class="emphasis"><em>&lt;jump-server-1&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								Use your local system to connect to the remote server through the jump server:
							</p><pre class="screen">$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>&lt;remote-server-1&gt;</em></span></strong></span></pre><p class="simpara">
								This command is equivalent to the <code class="literal">ssh -J jump-server1 remote-server</code> command if you omit the previous configuration steps.
							</p></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">ssh_config(5)</code> and <code class="literal">ssh(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh"><div class="titlepage"><div><div><h3 class="title">1.8. Configuring secure communication with the <code class="literal">ssh</code> system roles</h3></div></div></div><p class="_abstract _abstract">
				As an administrator, you can use the <code class="literal">sshd</code> system role to configure SSH servers and the <code class="literal">ssh</code> system role to configure SSH clients consistently on any number of RHEL systems at the same time using the Ansible Core package.
			</p><section class="section" id="sshd-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles"><div class="titlepage"><div><div><h4 class="title">1.8.1. Variables of the <code class="literal">sshd</code> RHEL system role</h4></div></div></div><p class="_abstract _abstract">
					In an <code class="literal">sshd</code> system role playbook, you can define the parameters for the SSH configuration file according to your preferences and limitations.
				</p><p>
					If you do not configure these variables, the system role produces an <code class="literal">sshd_config</code> file that matches the RHEL defaults.
				</p><p>
					In all cases, Booleans correctly render as <code class="literal">yes</code> and <code class="literal">no</code> in <code class="literal">sshd</code> configuration. You can define multi-line configuration items using lists. For example:
				</p><pre class="screen">sshd_ListenAddress:
  - 0.0.0.0
  - '::'</pre><p>
					renders as:
				</p><pre class="screen">ListenAddress 0.0.0.0
ListenAddress ::</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/sshd/</code> directory
						</li></ul></div></section><section class="section" id="configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-with-the-ssh-system-roles"><div class="titlepage"><div><div><h4 class="title">1.8.2. Configuring OpenSSH servers by using the <code class="literal">sshd</code> RHEL system role</h4></div></div></div><p>
					You can use the <code class="literal">sshd</code> RHEL system role to configure multiple SSH servers by running an Ansible playbook.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						You can use the <code class="literal">sshd</code> RHEL system role with other RHEL system roles that change SSH and SSHD configuration, for example the Identity Management RHEL system roles. To prevent the configuration from being overwritten, make sure that the <code class="literal">sshd</code> role uses namespaces (RHEL 8 and earlier versions) or a drop-in directory (RHEL 9).
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: SSH server configuration
  hosts: managed-node-01.example.com
  tasks:
    - name: Configure sshd to prevent root and password login except from particular subnet
      ansible.builtin.include_role:
        name: rhel-system-roles.sshd
      vars:
        sshd:
          PermitRootLogin: no
          PasswordAuthentication: no
          Match:
            - Condition: "Address 192.0.2.0/24"
              PermitRootLogin: yes
              PasswordAuthentication: yes</pre><p class="simpara">
							The playbook configures the managed node as an SSH server configured so that:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									password and <code class="literal">root</code> user login is disabled
								</li><li class="listitem">
									password and <code class="literal">root</code> user login is enabled only from the subnet <code class="literal">192.0.2.0/24</code>
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Log in to the SSH server:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh <span class="emphasis"><em>&lt;username&gt;</em></span>@<span class="emphasis"><em>&lt;ssh_server&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
							Verify the contents of the <code class="literal">sshd_config</code> file on the SSH server:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>cat /etc/ssh/sshd_config.d/00-ansible_system_role.conf</strong></span>
#
# Ansible managed
#
PasswordAuthentication no
PermitRootLogin no
Match Address 192.0.2.0/24
  PasswordAuthentication yes
  PermitRootLogin yes</pre></li><li class="listitem"><p class="simpara">
							Check that you can connect to the server as root from the <code class="literal">192.0.2.0/24</code> subnet:
						</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
									Determine your IP address:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>hostname -I</strong></span>
192.0.2.1</pre><p class="simpara">
									If the IP address is within the <code class="literal">192.0.2.1</code> - <code class="literal">192.0.2.254</code> range, you can connect to the server.
								</p></li><li class="listitem"><p class="simpara">
									Connect to the server as <code class="literal">root</code>:
								</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh root@<span class="emphasis"><em>&lt;ssh_server&gt;</em></span></strong></span></pre></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/sshd/</code> directory
						</li></ul></div></section><section class="section" id="ref_ssh-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles"><div class="titlepage"><div><div><h4 class="title">1.8.3. Variables of the <code class="literal">ssh</code> RHEL system role</h4></div></div></div><p class="_abstract _abstract">
					In an <code class="literal">ssh</code> system role playbook, you can define the parameters for the client SSH configuration file according to your preferences and limitations.
				</p><p>
					If you do not configure these variables, the system role produces a global <code class="literal">ssh_config</code> file that matches the RHEL defaults.
				</p><p>
					In all cases, booleans correctly render as <code class="literal">yes</code> or <code class="literal">no</code> in <code class="literal">ssh</code> configuration. You can define multi-line configuration items using lists. For example:
				</p><pre class="screen">LocalForward:
  - 22 localhost:2222
  - 403 localhost:4003</pre><p>
					renders as:
				</p><pre class="screen">LocalForward 22 localhost:2222
LocalForward 403 localhost:4003</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						The configuration options are case sensitive.
					</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/ssh/</code> directory
						</li></ul></div></section><section class="section" id="proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-with-the-ssh-system-roles"><div class="titlepage"><div><div><h4 class="title">1.8.4. Configuring OpenSSH clients by using the <code class="literal">ssh</code> RHEL system role</h4></div></div></div><p>
					You can use the <code class="literal">ssh</code> RHEL system role to configure multiple SSH clients by running an Ansible playbook.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						You can use the <code class="literal">ssh</code> RHEL system role with other system roles that change SSH and SSHD configuration, for example the Identity Management RHEL system roles. To prevent the configuration from being overwritten, make sure that the <code class="literal">ssh</code> role uses a drop-in directory (default in RHEL 8 and later).
					</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
- name: SSH client configuration
  hosts: managed-node-01.example.com
  tasks:
    - name: "Configure ssh clients"
      ansible.builtin.include_role:
        name: rhel-system-roles.ssh
      vars:
        ssh_user: root
        ssh:
          Compression: true
          GSSAPIAuthentication: no
          ControlMaster: auto
          ControlPath: ~/.ssh/.cm%C
          Host:
            - Condition: example
              Hostname: server.example.com
              User: user1
        ssh_ForwardX11: no</pre><p class="simpara">
							This playbook configures the <code class="literal">root</code> user’s SSH client preferences on the managed nodes with the following configurations:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Compression is enabled.
								</li><li class="listitem">
									ControlMaster multiplexing is set to <code class="literal">auto</code>.
								</li><li class="listitem">
									The <code class="literal">example</code> alias for connecting to the <code class="literal">server.example.com</code> host is <code class="literal">user1</code>.
								</li><li class="listitem">
									The <code class="literal">example</code> host alias is created, which represents a connection to the <code class="literal">server.example.com</code> host the with the <code class="literal">user1</code> user name.
								</li><li class="listitem">
									X11 forwarding is disabled.
								</li></ul></div></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify that the managed node has the correct configuration by displaying the SSH configuration file:
						</p><pre class="literallayout"># <span class="strong strong"><strong>cat ~/root/.ssh/config</strong></span>
# Ansible managed
Compression yes
ControlMaster auto
ControlPath ~/.ssh/.cm%C
ForwardX11 no
GSSAPIAuthentication no
Host example
  Hostname example.com
  User user1</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/ssh/</code> directory
						</li></ul></div></section><section class="section" id="proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-with-the-ssh-system-roles"><div class="titlepage"><div><div><h4 class="title">1.8.5. Using the <code class="literal">sshd</code> RHEL system role for non-exclusive configuration</h4></div></div></div><p>
					Normally, applying the <code class="literal">sshd</code> system role overwrites the entire configuration. This may be problematic if you have previously adjusted the configuration, for example, with a different system role or playbook. To apply the <code class="literal">sshd</code> system role for only selected configuration options while keeping other options in place, you can use the non-exclusive configuration.
				</p><p>
					You can apply a non-exclusive configuration:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							In RHEL 8 and earlier by using a configuration snippet.
						</li><li class="listitem">
							In RHEL 9 and later by using files in a drop-in directory. The default configuration file is already placed in the drop-in directory as <code class="literal">/etc/ssh/sshd_config.d/00-ansible_system_role.conf</code>.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
									For managed nodes that run RHEL 8 or earlier:
								</p><pre class="programlisting language-yaml">---
- name: Non-exclusive sshd configuration
  hosts: managed-node-01.example.com
  tasks:
    - name: <span class="emphasis"><em>&lt;Configure SSHD to accept some useful environment variables&gt;</em></span>
      ansible.builtin.include_role:
        name: rhel-system-roles.sshd
      vars:
        sshd_config_namespace: <span class="emphasis"><em>&lt;my-application&gt;</em></span>
        sshd:
          # Environment variables to accept
          AcceptEnv:
            LANG
            LS_COLORS
            EDITOR</pre></li><li class="listitem"><p class="simpara">
									For managed nodes that run RHEL 9 or later:
								</p><pre class="programlisting language-yaml">- name: Non-exclusive sshd configuration
  hosts: managed-node-01.example.com
  tasks:
    - name: <span class="emphasis"><em>&lt;Configure sshd to accept some useful environment variables&gt;</em></span>
      ansible.builtin.include_role:
        name: rhel-system-roles.sshd
      vars:
        sshd_config_file: /etc/ssh/sshd_config.d/<span class="emphasis"><em>&lt;42-my-application&gt;</em></span>.conf
        sshd:
          # Environment variables to accept
          AcceptEnv:
            LANG
            LS_COLORS
            EDITOR</pre><p class="simpara">
									In the <code class="literal">sshd_config_file</code> variable, define the <code class="literal">.conf</code> file into which the <code class="literal">sshd</code> system role writes the configuration options. Use a two-digit prefix, for example <code class="literal"><span class="emphasis"><em>42-</em></span></code> to specify the order in which the configuration files will be applied.
								</p></li></ul></div></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Verify the configuration on the SSH server:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									For managed nodes that run RHEL 8 or earlier:
								</p><pre class="literallayout"># <span class="strong strong"><strong>cat /etc/ssh/sshd_config.d/42-my-application.conf</strong></span>
# Ansible managed
#
AcceptEnv LANG LS_COLORS EDITOR</pre></li><li class="listitem"><p class="simpara">
									For managed nodes that run RHEL 9 or later:
								</p><pre class="literallayout"># <span class="strong strong"><strong>cat /etc/ssh/sshd_config</strong></span>
...
# BEGIN sshd system role managed block: namespace <span class="emphasis"><em>&lt;my-application&gt;</em></span>
Match all
  AcceptEnv LANG LS_COLORS EDITOR
# END sshd system role managed block: namespace <span class="emphasis"><em>&lt;my-application&gt;</em></span></pre></li></ul></div></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/sshd/</code> directory
						</li></ul></div></section></section><section class="section _additional-resources" id="additional_resources"><div class="titlepage"><div><div><h3 class="title">1.9. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">sshd(8)</code>, <code class="literal">ssh(1)</code>, <code class="literal">scp(1)</code>, <code class="literal">sftp(1)</code>, <code class="literal">ssh-keygen(1)</code>, <code class="literal">ssh-copy-id(1)</code>, <code class="literal">ssh_config(5)</code>, <code class="literal">sshd_config(5)</code>, <code class="literal">update-crypto-policies(8)</code>, and <code class="literal">crypto-policies(7)</code> man pages on your system
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux">Configuring SELinux for applications and services with non-standard configurations</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters#controlling-network-traffic-using-firewalld_using-and-configuring-firewalld">Controlling network traffic using firewalld</a>
					</li></ul></div></section></section><section class="chapter" id="creating-and-managing-tls-keys-and-certificates_securing-networks"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Creating and managing TLS keys and certificates</h2></div></div></div><p>
			You can encrypt communication transmitted between two systems by using the TLS (Transport Layer Security) protocol. This standard uses asymmetric cryptography with private and public keys, digital signatures, and certificates.
		</p><section class="section" id="con_tls-certificates_creating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.1. TLS certificates</h3></div></div></div><p>
				TLS (Transport Layer Security) is a protocol that enables client-server applications to pass information securely. TLS uses a system of public and private key pairs to encrypt communication transmitted between clients and servers. TLS is the successor protocol to SSL (Secure Sockets Layer).
			</p><p>
				TLS uses X.509 certificates to bind identities, such as hostnames or organizations, to public keys using digital signatures. X.509 is a standard that defines the format of public key certificates.
			</p><p>
				Authentication of a secure application depends on the integrity of the public key value in the application’s certificate. If an attacker replaces the public key with its own public key, it can impersonate the true application and gain access to secure data. To prevent this type of attack, all certificates must be signed by a certification authority (CA). A CA is a trusted node that confirms the integrity of the public key value in a certificate.
			</p><p>
				A CA signs a public key by adding its digital signature and issues a certificate. A digital signature is a message encoded with the CA’s private key. The CA’s public key is made available to applications by distributing the certificate of the CA. Applications verify that certificates are validly signed by decoding the CA’s digital signature with the CA’s public key.
			</p><p>
				To have a certificate signed by a CA, you must generate a public key, and send it to a CA for signing. This is referred to as a certificate signing request (CSR). A CSR contains also a distinguished name (DN) for the certificate. The DN information that you can provide for either type of certificate can include a two-letter country code for your country, a full name of your state or province, your city or town, a name of your organization, your email address, and it can also be empty. Many current commercial CAs prefer the Subject Alternative Name extension and ignore DNs in CSRs.
			</p><p>
				RHEL provides two main toolkits for working with TLS certificates: GnuTLS and OpenSSL. You can create, read, sign, and verify certificates using the <code class="literal">openssl</code> utility from the <code class="literal">openssl</code> package. The <code class="literal">certtool</code> utility provided by the <code class="literal">gnutls-utils</code> package can do the same operations using a different syntax and above all a different set of libraries in the back end.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://datatracker.ietf.org/doc/html/rfc5280">RFC 5280: Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>
					</li><li class="listitem">
						<code class="literal">openssl(1)</code>, <code class="literal">x509(1)</code>, <code class="literal">ca(1)</code>, <code class="literal">req(1)</code>, and <code class="literal">certtool(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="creating-a-private-ca-using-openssl_creating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.2. Creating a private CA using OpenSSL</h3></div></div></div><p>
				Private certificate authorities (CA) are useful when your scenario requires verifying entities within your internal network. For example, use a private CA when you create a VPN gateway with authentication based on certificates signed by a CA under your control or when you do not want to pay a commercial CA. To sign certificates in such use cases, the private CA uses a self-signed certificate.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> privileges or permissions to enter administrative commands with <code class="literal">sudo</code>. Commands that require such privileges are marked with <code class="literal">#</code>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a private key for your CA. For example, the following command creates a 256-bit Elliptic Curve Digital Signature Algorithm (ECDSA) key:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl genpkey -algorithm ec -pkeyopt ec_paramgen_curve:P-256 -out <span class="emphasis"><em>&lt;ca.key&gt;</em></span></strong></span></pre><p class="simpara">
						The time for the key-generation process depends on the hardware and entropy of the host, the selected algorithm, and the length of the key.
					</p></li><li class="listitem"><p class="simpara">
						Create a certificate signed using the private key generated in the previous command:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl req -key <span class="emphasis"><em>&lt;ca.key&gt;</em></span> -new -x509 -days 3650 -addext keyUsage=critical,keyCertSign,cRLSign -subj "/CN=<span class="emphasis"><em>&lt;Example CA&gt;</em></span>" -out <span class="emphasis"><em>&lt;ca.crt&gt;</em></span></strong></span></pre><p class="simpara">
						The generated <code class="literal">ca.crt</code> file is a self-signed CA certificate that you can use to sign other certificates for ten years. In the case of a private CA, you can replace <span class="emphasis"><em>&lt;Example CA&gt;</em></span> with any string as the common name (CN).
					</p></li><li class="listitem"><p class="simpara">
						Set secure permissions on the private key of your CA, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>chown <span class="emphasis"><em>&lt;root&gt;</em></span>:<span class="emphasis"><em>&lt;root&gt;</em></span> <span class="emphasis"><em>&lt;ca.key&gt;</em></span></strong></span>
# <span class="strong strong"><strong>chmod 600 <span class="emphasis"><em>&lt;ca.key&gt;</em></span></strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To use a self-signed CA certificate as a trust anchor on client systems, copy the CA certificate to the client and add it to the clients' system-wide truststore as <code class="literal">root</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>trust anchor <span class="emphasis"><em>&lt;ca.crt&gt;</em></span></strong></span></pre><p class="simpara">
						See <a class="xref" href="#using-shared-system-certificates_securing-networks" title="Chapter 3. Using shared system certificates">Chapter 3, <em>Using shared system certificates</em></a> for more information.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a certificate signing request (CSR), and use your CA to sign the request. The CA must successfully create a certificate based on the CSR, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl x509 -req -in <span class="emphasis"><em>&lt;client-cert.csr&gt;</em></span> -CA <span class="emphasis"><em>&lt;ca.crt&gt;</em></span> -CAkey <span class="emphasis"><em>&lt;ca.key&gt;</em></span> -CAcreateserial -days 365 -extfile <span class="emphasis"><em>&lt;openssl.cnf&gt;</em></span> -extensions <span class="emphasis"><em>&lt;client-cert&gt;</em></span> -out <span class="emphasis"><em>&lt;client-cert.crt&gt;</em></span></strong></span>
Signature ok
subject=C = US, O = Example Organization, CN = server.example.com
Getting CA Private Key</pre><p class="simpara">
						See <a class="xref" href="#using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates" title="2.5. Using a private CA to issue certificates for CSRs with OpenSSL">Section 2.5, “Using a private CA to issue certificates for CSRs with OpenSSL”</a> for more information.
					</p></li><li class="listitem"><p class="simpara">
						Display the basic information about your self-signed CA:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl x509 -in <span class="emphasis"><em>&lt;ca.crt&gt;</em></span> -text -noout</strong></span>
Certificate:
…
        X509v3 extensions:
            …
            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
…</pre></li><li class="listitem"><p class="simpara">
						Verify the consistency of the private key:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl pkey -check -in <span class="emphasis"><em>&lt;ca.key&gt;</em></span></strong></span>
Key is valid
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgcagSaTEBn74xZAwO
18wRpXoCVC9vcPki7WlT+gnmCI+hRANCAARb9NxIvkaVjFhOoZbGp/HtIQxbM78E
lwbDP0BI624xBJ8gK68ogSaq2x4SdezFdV1gNeKScDcU+Pj2pELldmdF
-----END PRIVATE KEY-----</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">openssl(1)</code>, <code class="literal">ca(1)</code>, <code class="literal">genpkey(1)</code>, <code class="literal">x509(1)</code>, and <code class="literal">req(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.3. Creating a private key and a CSR for a TLS server certificate using OpenSSL</h3></div></div></div><p>
				You can use TLS-encrypted communication channels only if you have a valid TLS certificate from a certificate authority (CA). To obtain the certificate, you must create a private key and a certificate signing request (CSR) for your server first.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a private key on your server system, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl genpkey -algorithm ec -pkeyopt ec_paramgen_curve:P-256 -out <span class="emphasis"><em>&lt;server-private.key&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Use a text editor of your choice to prepare a configuration file that simplifies creating your CSR, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>vim <span class="emphasis"><em>&lt;example_server.cnf&gt;</em></span></strong></span>
[server-cert]
keyUsage = critical, digitalSignature, keyEncipherment, keyAgreement
extendedKeyUsage = serverAuth
subjectAltName = @alt_name

[req]
distinguished_name = dn
prompt = no

[dn]
C = <span class="emphasis"><em>&lt;US&gt;</em></span>
O = <span class="emphasis"><em>&lt;Example Organization&gt;</em></span>
CN = <span class="emphasis"><em>&lt;server.example.com&gt;</em></span>

[alt_name]
DNS.1 = <span class="emphasis"><em>&lt;example.com&gt;</em></span>
DNS.2 = <span class="emphasis"><em>&lt;server.example.com&gt;</em></span>
IP.1 = <span class="emphasis"><em>&lt;192.168.0.1&gt;</em></span>
IP.2 = <span class="emphasis"><em>&lt;::1&gt;</em></span>
IP.3 = <span class="emphasis"><em>&lt;127.0.0.1&gt;</em></span></pre><p class="simpara">
						The <code class="literal">extendedKeyUsage = serverAuth</code> option limits the use of a certificate.
					</p></li><li class="listitem"><p class="simpara">
						Create a CSR using the private key you created previously:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl req -key <span class="emphasis"><em>&lt;server-private.key&gt;</em></span> -config <span class="emphasis"><em>&lt;example_server.cnf&gt;</em></span> -new -out <span class="emphasis"><em>&lt;server-cert.csr&gt;</em></span></strong></span></pre><p class="simpara">
						If you omit the <code class="literal">-config</code> option, the <code class="literal">req</code> utility prompts you for additional information, for example:
					</p><pre class="screen">You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [XX]: <span class="emphasis"><em>&lt;US&gt;</em></span>
State or Province Name (full name) []: <span class="emphasis"><em>&lt;Washington&gt;</em></span>
Locality Name (eg, city) [Default City]: <span class="emphasis"><em>&lt;Seattle&gt;</em></span>
Organization Name (eg, company) [Default Company Ltd]: <span class="emphasis"><em>&lt;Example Organization&gt;</em></span>
Organizational Unit Name (eg, section) []:
Common Name (eg, your name or your server's hostname) []: <span class="emphasis"><em>&lt;server.example.com&gt;</em></span>
Email Address []: <span class="emphasis"><em>&lt;server@example.com&gt;</em></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Submit the CSR to a CA of your choice for signing. Alternatively, for an internal use scenario within a trusted network, use your private CA for signing. See <a class="xref" href="#using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates" title="2.5. Using a private CA to issue certificates for CSRs with OpenSSL">Section 2.5, “Using a private CA to issue certificates for CSRs with OpenSSL”</a> for more information.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						After you obtain the requested certificate from the CA, check that the human-readable parts of the certificate match your requirements, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl x509 -text -noout -in <span class="emphasis"><em>&lt;server-cert.crt&gt;</em></span></strong></span>
Certificate:
…
        Issuer: CN = Example CA
        Validity
            Not Before: Feb  2 20:27:29 2023 GMT
            Not After : Feb  2 20:27:29 2024 GMT
        Subject: C = US, O = Example Organization, CN = server.example.com
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
…
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment, Key Agreement
            X509v3 Extended Key Usage:
                TLS Web Server Authentication
            X509v3 Subject Alternative Name:
                DNS:example.com, DNS:server.example.com, IP Address:192.168.0.1, IP
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">openssl(1)</code>, <code class="literal">x509(1)</code>, <code class="literal">genpkey(1)</code>, <code class="literal">req(1)</code>, and <code class="literal">config(5)</code> man pages on your system
					</li></ul></div></section><section class="section" id="creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.4. Creating a private key and a CSR for a TLS client certificate using OpenSSL</h3></div></div></div><p>
				You can use TLS-encrypted communication channels only if you have a valid TLS certificate from a certificate authority (CA). To obtain the certificate, you must create a private key and a certificate signing request (CSR) for your client first.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a private key on your client system, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl genpkey -algorithm ec -pkeyopt ec_paramgen_curve:P-256 -out <span class="emphasis"><em>&lt;client-private.key&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Use a text editor of your choice to prepare a configuration file that simplifies creating your CSR, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>vim <span class="emphasis"><em>&lt;example_client.cnf&gt;</em></span></strong></span>
[client-cert]
keyUsage = critical, digitalSignature, keyEncipherment
extendedKeyUsage = clientAuth
subjectAltName = @alt_name

[req]
distinguished_name = dn
prompt = no

[dn]
CN = <span class="emphasis"><em>&lt;client.example.com&gt;</em></span>

[clnt_alt_name]
email= <span class="emphasis"><em>&lt;client@example.com&gt;</em></span></pre><p class="simpara">
						The <code class="literal">extendedKeyUsage = clientAuth</code> option limits the use of a certificate.
					</p></li><li class="listitem"><p class="simpara">
						Create a CSR using the private key you created previously:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl req -key <span class="emphasis"><em>&lt;client-private.key&gt;</em></span> -config <span class="emphasis"><em>&lt;example_client.cnf&gt;</em></span> -new -out <span class="emphasis"><em>&lt;client-cert.csr&gt;</em></span></strong></span></pre><p class="simpara">
						If you omit the <code class="literal">-config</code> option, the <code class="literal">req</code> utility prompts you for additional information, for example:
					</p><pre class="screen">You are about to be asked to enter information that will be incorporated
into your certificate request.
…
Common Name (eg, your name or your server's hostname) []: <span class="emphasis"><em>&lt;client.example.com&gt;</em></span>
Email Address []: <span class="emphasis"><em>&lt;client@example.com&gt;</em></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Submit the CSR to a CA of your choice for signing. Alternatively, for an internal use scenario within a trusted network, use your private CA for signing. See <a class="xref" href="#using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates" title="2.5. Using a private CA to issue certificates for CSRs with OpenSSL">Section 2.5, “Using a private CA to issue certificates for CSRs with OpenSSL”</a> for more information.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the human-readable parts of the certificate match your requirements, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl x509 -text -noout -in <span class="emphasis"><em>&lt;client-cert.crt&gt;</em></span></strong></span>
Certificate:
…
            X509v3 Extended Key Usage:
                TLS Web Client Authentication
            X509v3 Subject Alternative Name:
                email:client@example.com
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">openssl(1)</code>, <code class="literal">x509(1)</code>, <code class="literal">genpkey(1)</code>, <code class="literal">req(1)</code>, and <code class="literal">config(5)</code> man pages on your system
					</li></ul></div></section><section class="section" id="using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.5. Using a private CA to issue certificates for CSRs with OpenSSL</h3></div></div></div><p>
				To enable systems to establish a TLS-encrypted communication channel, a certificate authority (CA) must provide valid certificates to them. If you have a private CA, you can create the requested certificates by signing certificate signing requests (CSRs) from the systems.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have already configured a private CA. See <a class="xref" href="#creating-a-private-ca-using-openssl_creating-and-managing-tls-keys-and-certificates" title="2.2. Creating a private CA using OpenSSL">Section 2.2, “Creating a private CA using OpenSSL”</a> for more information.
					</li><li class="listitem">
						You have a file containing a CSR. You can find an example of creating the CSR in <a class="xref" href="#creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates" title="2.3. Creating a private key and a CSR for a TLS server certificate using OpenSSL">Section 2.3, “Creating a private key and a CSR for a TLS server certificate using OpenSSL”</a> .
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Use a text editor of your choice to prepare an OpenSSL configuration file for adding extensions to certificates, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>vim <span class="emphasis"><em>&lt;openssl.cnf&gt;</em></span></strong></span>
[server-cert]
extendedKeyUsage = serverAuth

[client-cert]
extendedKeyUsage = clientAuth</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">x509</code> utility to create a certificate based on a CSR, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>openssl x509 -req -in <span class="emphasis"><em>&lt;server-cert.csr&gt;</em></span> -CA <span class="emphasis"><em>&lt;ca.crt&gt;</em></span> -CAkey <span class="emphasis"><em>&lt;ca.key&gt;</em></span> -days 365 -extfile <span class="emphasis"><em>&lt;openssl.cnf&gt;</em></span> -extensions <span class="emphasis"><em>&lt;server-cert&gt;</em></span> -out <span class="emphasis"><em>&lt;server-cert.crt&gt;</em></span></strong></span>
Signature ok
subject=C = US, O = Example Organization, CN = server.example.com
Getting CA Private Key</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">openssl(1)</code>, <code class="literal">ca(1)</code>, and <code class="literal">x509(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="creating-a-private-ca-using-gnutls_creating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.6. Creating a private CA using GnuTLS</h3></div></div></div><p>
				Private certificate authorities (CA) are useful when your scenario requires verifying entities within your internal network. For example, use a private CA when you create a VPN gateway with authentication based on certificates signed by a CA under your control or when you do not want to pay a commercial CA. To sign certificates in such use cases, the private CA uses a self-signed certificate.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> privileges or permissions to enter administrative commands with <code class="literal">sudo</code>. Commands that require such privileges are marked with <code class="literal">#</code>.
					</li><li class="listitem"><p class="simpara">
						You have already installed GnuTLS on your system. If you did not, you can use this command:
					</p><pre class="screen">$ <span class="strong strong"><strong>dnf install gnutls-utils</strong></span></pre></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a private key for your CA. For example, the following command creates a 256-bit ECDSA (Elliptic Curve Digital Signature Algorithm) key:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-privkey --sec-param High --key-type=ecdsa --outfile <span class="emphasis"><em>&lt;ca.key&gt;</em></span></strong></span></pre><p class="simpara">
						The time for the key-generation process depends on the hardware and entropy of the host, the selected algorithm, and the length of the key.
					</p></li><li class="listitem"><p class="simpara">
						Create a template file for a certificate.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a file with a text editor of your choice, for example:
							</p><pre class="screen">$ <span class="strong strong"><strong>vi <span class="emphasis"><em>&lt;ca.cfg&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								Edit the file to include the necessary certification details:
							</p><pre class="screen">organization = "Example Inc."
state = "Example"
country = EX
cn = "Example CA"
serial = 007
expiration_days = 365
ca
cert_signing_key
crl_signing_key</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Create a certificate signed using the private key generated in step 1:
					</p><p class="simpara">
						The generated <span class="emphasis"><em>&lt;ca.crt&gt;</em></span> file is a self-signed CA certificate that you can use to sign other certificates for one year. <span class="emphasis"><em>&lt;ca.crt&gt;</em></span> file is the public key (certificate). The loaded file <span class="emphasis"><em>&lt;ca.key&gt;</em></span> is the private key. You should keep this file in safe location.
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-self-signed --load-privkey <span class="emphasis"><em>&lt;ca.key&gt;</em></span> --template <span class="emphasis"><em>&lt;ca.cfg&gt;</em></span> --outfile <span class="emphasis"><em>&lt;ca.crt</em></span>&gt;</strong></span></pre></li><li class="listitem"><p class="simpara">
						Set secure permissions on the private key of your CA, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>chown <span class="emphasis"><em>&lt;root&gt;</em></span>:<span class="emphasis"><em>&lt;root&gt;</em></span> <span class="emphasis"><em>&lt;ca.key&gt;</em></span></strong></span>
# <span class="strong strong"><strong>chmod 600 <span class="emphasis"><em>&lt;ca.key&gt;</em></span></strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To use a self-signed CA certificate as a trust anchor on client systems, copy the CA certificate to the client and add it to the clients' system-wide truststore as <code class="literal">root</code>:
					</p><pre class="screen"># <span class="strong strong"><strong>trust anchor <span class="emphasis"><em>&lt;ca.crt&gt;</em></span></strong></span></pre><p class="simpara">
						See <a class="xref" href="#using-shared-system-certificates_securing-networks" title="Chapter 3. Using shared system certificates">Chapter 3, <em>Using shared system certificates</em></a> for more information.
					</p></li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the basic information about your self-signed CA:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --certificate-info --infile <span class="emphasis"><em>&lt;ca.crt&gt;</em></span></strong></span>
Certificate:
…
    	X509v3 extensions:
        	…
        	X509v3 Basic Constraints: critical
            	CA:TRUE
        	X509v3 Key Usage: critical
            	Certificate Sign, CRL Sign</pre></li><li class="listitem"><p class="simpara">
						Create a certificate signing request (CSR), and use your CA to sign the request. The CA must successfully create a certificate based on the CSR, for example:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Generate a private key for your CA:
							</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-privkey --outfile <span class="emphasis"><em>&lt;example-server.key&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								Open a new configuration file in a text editor of your choice, for example:
							</p><pre class="screen">$ <span class="strong strong"><strong>vi <span class="emphasis"><em>&lt;example-server.cfg&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								Edit the file to include the necessary certification details:
							</p><pre class="screen">signing_key
encryption_key
key_agreement

tls_www_server

country = "US"
organization = "Example Organization"
cn = "server.example.com"

dns_name = "example.com"
dns_name = "server.example.com"
ip_address = "192.168.0.1"
ip_address = "::1"
ip_address = "127.0.0.1"</pre></li><li class="listitem"><p class="simpara">
								Generate a request with the previously created private key:
							</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-request --load-privkey <span class="emphasis"><em>&lt;example-server.key&gt;</em></span> --template <span class="emphasis"><em>&lt;example-server.cfg&gt;</em></span> --outfile <span class="emphasis"><em>&lt;example-server.crq&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
								Generate the certificate and sign it with the private key of the CA:
							</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-certificate --load-request <span class="emphasis"><em>&lt;example-server.crq&gt;</em></span> --load-ca-certificate <span class="emphasis"><em>&lt;ca.crt&gt;</em></span> --load-ca-privkey <span class="emphasis"><em>&lt;ca.key&gt;</em></span> --outfile <span class="emphasis"><em>&lt;example-server.crt&gt;</em></span></strong></span></pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
										<code class="literal">certtool(1)</code> and <code class="literal">trust(1)</code> man pages on your system
									</li></ul></div></li></ol></div></li></ol></div></section><section class="section" id="creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-gnutls_creating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.7. Creating a private key and a CSR for a TLS server certificate using GnuTLS</h3></div></div></div><p>
				To obtain the certificate, you must create a private key and a certificate signing request (CSR) for your server first.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a private key on your server system, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-privkey --sec-param High --outfile <span class="emphasis"><em>&lt;example-server.key&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Use a text editor of your choice to prepare a configuration file that simplifies creating your CSR, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>vim <span class="emphasis"><em>&lt;example_server.cnf&gt;</em></span></strong></span>
signing_key
encryption_key
key_agreement

tls_www_server

country = "US"
organization = "Example Organization"
cn = "server.example.com"

dns_name = "example.com"
dns_name = "server.example.com"
ip_address = "192.168.0.1"
ip_address = "::1"
ip_address = "127.0.0.1"</pre></li><li class="listitem"><p class="simpara">
						Create a CSR using the private key you created previously:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-request --template <span class="emphasis"><em>&lt;example-server.cfg&gt;</em></span> --load-privkey <span class="emphasis"><em>&lt;example-server.key&gt;</em></span> --outfile <span class="emphasis"><em>&lt;example-server.crq&gt;</em></span></strong></span></pre><p class="simpara">
						If you omit the <code class="literal">--template</code> option, the <code class="literal">certool</code> utility prompts you for additional information, for example:
					</p><pre class="screen">You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Generating a PKCS #10 certificate request...
Country name (2 chars): <span class="emphasis"><em>&lt;US&gt;</em></span>
State or province name: <span class="emphasis"><em>&lt;Washington&gt;</em></span>
Locality name: <span class="emphasis"><em>&lt;Seattle&gt;</em></span>
Organization name: <span class="emphasis"><em>&lt;Example Organization&gt;</em></span>
Organizational unit name:
Common name: <span class="emphasis"><em>&lt;server.example.com&gt;</em></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Submit the CSR to a CA of your choice for signing. Alternatively, for an internal use scenario within a trusted network, use your private CA for signing. See <a class="xref" href="#using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates" title="2.9. Using a private CA to issue certificates for CSRs with GnuTLS">Section 2.9, “Using a private CA to issue certificates for CSRs with GnuTLS”</a> for more information.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						After you obtain the requested certificate from the CA, check that the human-readable parts of the certificate match your requirements, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --certificate-info --infile <span class="emphasis"><em>&lt;example-server.crt&gt;</em></span></strong></span>
Certificate:
…
        Issuer: CN = Example CA
        Validity
            Not Before: Feb  2 20:27:29 2023 GMT
            Not After : Feb  2 20:27:29 2024 GMT
        Subject: C = US, O = Example Organization, CN = server.example.com
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
…
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment, Key Agreement
            X509v3 Extended Key Usage:
                TLS Web Server Authentication
            X509v3 Subject Alternative Name:
                DNS:example.com, DNS:server.example.com, IP Address:192.168.0.1, IP
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">certtool(1)</code> man page on your system
					</li></ul></div></section><section class="section" id="creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-gnutlscreating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.8. Creating a private key and a CSR for a TLS client certificate using GnuTLS</h3></div></div></div><p>
				To obtain the certificate, you must create a private key and a certificate signing request (CSR) for your client first.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a private key on your client system, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-privkey --sec-param High --outfile <span class="emphasis"><em>&lt;example-client.key&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Use a text editor of your choice to prepare a configuration file that simplifies creating your CSR, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>vim <span class="emphasis"><em>&lt;example_client.cnf&gt;</em></span></strong></span>
signing_key
encryption_key

tls_www_client

cn = "client.example.com"
email = "client@example.com"</pre></li><li class="listitem"><p class="simpara">
						Create a CSR using the private key you created previously:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-request --template <span class="emphasis"><em>&lt;example-client.cfg&gt;</em></span> --load-privkey <span class="emphasis"><em>&lt;example-client.key&gt;</em></span> --outfile <span class="emphasis"><em>&lt;example-client.crq&gt;</em></span></strong></span></pre><p class="simpara">
						If you omit the <code class="literal">--template</code> option, the <code class="literal">certtool</code> utility prompts you for additional information, for example:
					</p><pre class="screen">Generating a PKCS #10 certificate request...
Country name (2 chars): <span class="emphasis"><em>&lt;US&gt;</em></span>
State or province name: <span class="emphasis"><em>&lt;Washington&gt;</em></span>
Locality name: <span class="emphasis"><em>&lt;Seattle&gt;</em></span>
Organization name: <span class="emphasis"><em>&lt;Example Organization&gt;</em></span>
Organizational unit name:
Common name: <span class="emphasis"><em>&lt;server.example.com&gt;</em></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Submit the CSR to a CA of your choice for signing. Alternatively, for an internal use scenario within a trusted network, use your private CA for signing. See <a class="xref" href="#using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates" title="2.9. Using a private CA to issue certificates for CSRs with GnuTLS">Section 2.9, “Using a private CA to issue certificates for CSRs with GnuTLS”</a> for more information.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the human-readable parts of the certificate match your requirements, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --certificate-info --infile <span class="emphasis"><em>&lt;example-client.crt&gt;</em></span></strong></span>
Certificate:
…
            X509v3 Extended Key Usage:
                TLS Web Client Authentication
            X509v3 Subject Alternative Name:
                email:client@example.com
…</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">certtool(1)</code> man page on your system
					</li></ul></div></section><section class="section" id="using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates"><div class="titlepage"><div><div><h3 class="title">2.9. Using a private CA to issue certificates for CSRs with GnuTLS</h3></div></div></div><p>
				To enable systems to establish a TLS-encrypted communication channel, a certificate authority (CA) must provide valid certificates to them. If you have a private CA, you can create the requested certificates by signing certificate signing requests (CSRs) from the systems.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have already configured a private CA. See <a class="xref" href="#creating-a-private-ca-using-gnutls_creating-and-managing-tls-keys-and-certificates" title="2.6. Creating a private CA using GnuTLS">Section 2.6, “Creating a private CA using GnuTLS”</a> for more information.
					</li><li class="listitem">
						You have a file containing a CSR. You can find an example of creating the CSR in <a class="xref" href="#creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-gnutls_creating-and-managing-tls-keys-and-certificates" title="2.7. Creating a private key and a CSR for a TLS server certificate using GnuTLS">Section 2.7, “Creating a private key and a CSR for a TLS server certificate using GnuTLS”</a> .
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Use a text editor of your choice to prepare an GnuTLS configuration file for adding extensions to certificates, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>vi <span class="emphasis"><em>&lt;server-extensions.cfg&gt;</em></span></strong></span>
honor_crq_extensions
ocsp_uri = "http://ocsp.example.com"</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">certtool</code> utility to create a certificate based on a CSR, for example:
					</p><pre class="screen">$ <span class="strong strong"><strong>certtool --generate-certificate --load-request <span class="emphasis"><em>&lt;example-server.crq&gt;</em></span> --load-ca-privkey <span class="emphasis"><em>&lt;ca.key&gt;</em></span> --load-ca-certificate <span class="emphasis"><em>&lt;ca.crt&gt;</em></span> --template <span class="emphasis"><em>&lt;server-extensions.cfg&gt;</em></span> --outfile <span class="emphasis"><em>&lt;example-server.crt&gt;</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">certtool(1)</code> man page on your system
					</li></ul></div></section></section><section class="chapter" id="using-shared-system-certificates_securing-networks"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Using shared system certificates</h2></div></div></div><p class="_abstract _abstract">
			The shared system certificates storage enables NSS, GnuTLS, OpenSSL, and Java to share a default source for retrieving system certificate anchors and block-list information. By default, the truststore contains the Mozilla CA list, including positive and negative trust. The system allows updating the core Mozilla CA list or choosing another certificate list.
		</p><section class="section" id="the-system-wide-trust-store_using-shared-system-certificates"><div class="titlepage"><div><div><h3 class="title">3.1. The system-wide truststore</h3></div></div></div><p class="_abstract _abstract">
				In RHEL, the consolidated system-wide truststore is located in the <code class="literal">/etc/pki/ca-trust/</code> and <code class="literal">/usr/share/pki/ca-trust-source/</code> directories. The trust settings in <code class="literal">/usr/share/pki/ca-trust-source/</code> are processed with lower priority than settings in <code class="literal">/etc/pki/ca-trust/</code>.
			</p><p>
				Certificate files are treated depending on the subdirectory they are installed to:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Trust anchors belong to
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">/usr/share/pki/ca-trust-source/anchors/</code> or
							</li><li class="listitem">
								<code class="literal">/etc/pki/ca-trust/source/anchors/</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Distrusted certificates are stored in
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">/usr/share/pki/ca-trust-source/blocklist/</code> or
							</li><li class="listitem">
								<code class="literal">/etc/pki/ca-trust/source/blocklist/</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Certificates in the extended BEGIN TRUSTED file format are located in
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<code class="literal">/usr/share/pki/ca-trust-source/</code> or
							</li><li class="listitem">
								<code class="literal">/etc/pki/ca-trust/source/</code>.
							</li></ul></div></li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In a hierarchical cryptographic system, a trust anchor is an authoritative entity that other parties consider trustworthy. In the X.509 architecture, a root certificate is a trust anchor from which a chain of trust is derived. To enable chain validation, the trusting party must have access to the trust anchor first.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">update-ca-trust(8)</code> and <code class="literal">trust(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="adding-new-certificates_using-shared-system-certificates"><div class="titlepage"><div><div><h3 class="title">3.2. Adding new certificates</h3></div></div></div><p class="_abstract _abstract">
				To acknowledge applications on your system with a new source of trust, add the corresponding certificate to the system-wide store, and use the <code class="literal">update-ca-trust</code> command.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">ca-certificates</code> package is present on the system.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						To add a certificate in the simple PEM or DER file formats to the list of CAs trusted on the system, copy the certificate file to the <code class="literal">/usr/share/pki/ca-trust-source/anchors/</code> or <code class="literal">/etc/pki/ca-trust/source/anchors/</code> directory, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cp <span class="emphasis"><em>~/certificate-trust-examples/Cert-trust-test-ca.pem</em></span> <span class="emphasis"><em>/usr/share/pki/ca-trust-source/anchors/</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To update the system-wide truststore configuration, use the <code class="literal command">update-ca-trust</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>update-ca-trust</strong></span></pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Even though the Firefox browser can use an added certificate without a prior execution of <code class="literal">update-ca-trust</code>, enter the <code class="literal">update-ca-trust</code> command after every CA change. Also note that browsers, such as Firefox, Chromium, and GNOME Web cache files, and you might have to clear your browser’s cache or restart your browser to load the current system certificate configuration.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">update-ca-trust(8)</code> and <code class="literal">trust(1)</code> man pages on your system
					</li></ul></div></section><section class="section" id="managing-trusted-system-certificates_using-shared-system-certificates"><div class="titlepage"><div><div><h3 class="title">3.3. Managing trusted system certificates</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">trust</code> command provides a convenient way for managing certificates in the shared system-wide truststore.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To list, extract, add, remove, or change trust anchors, use the <code class="literal command">trust</code> command. To see the built-in help for this command, enter it without any arguments or with the <code class="literal option">--help</code> directive:
					</p><pre class="screen white-space-pre white-space-pre">$ <span class="strong strong"><strong>trust</strong></span>
usage: trust command &lt;args&gt;...

Common trust commands are:
  list             List trust or certificates
  extract          Extract certificates and trust
  extract-compat   Extract trust compatibility bundles
  anchor           Add, remove, change trust anchors
  dump             Dump trust objects in internal format

See 'trust &lt;command&gt; --help' for more information</pre></li><li class="listitem"><p class="simpara">
						To list all system trust anchors and certificates, use the <code class="literal command">trust list</code> command:
					</p><pre class="screen white-space-pre white-space-pre">$ <span class="strong strong"><strong>trust list</strong></span>
pkcs11:id=%d2%87%b4%e3%df%37%27%93%55%f6%56%ea%81%e5%36%cc%8c%1e%3f%bd;type=cert
    type: certificate
    label: ACCVRAIZ1
    trust: anchor
    category: authority

pkcs11:id=%a6%b3%e1%2b%2b%49%b6%d7%73%a1%aa%94%f5%01%e7%73%65%4c%ac%50;type=cert
    type: certificate
    label: ACEDICOM Root
    trust: anchor
    category: authority
...</pre></li><li class="listitem"><p class="simpara">
						To store a trust anchor into the system-wide truststore, use the <code class="literal command">trust anchor</code> sub-command and specify a path to a certificate. Replace <span class="emphasis"><em>&lt;path.to/certificate.crt&gt;</em></span> by a path to your certificate and its file name:
					</p><pre class="screen"># <span class="strong strong"><strong>trust anchor <span class="emphasis"><em>&lt;path.to/certificate.crt&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						To remove a certificate, use either a path to a certificate or an ID of a certificate:
					</p><pre class="screen white-space-pre white-space-pre"># <span class="strong strong"><strong>trust anchor --remove <span class="emphasis"><em>&lt;path.to/certificate.crt&gt;</em></span></strong></span>
# <span class="strong strong"><strong>trust anchor --remove "pkcs11:id=<span class="emphasis"><em>&lt;%AA%BB%CC%DD%EE&gt;</em></span>;type=cert"</strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem"><p class="simpara">
						All sub-commands of the <code class="literal command">trust</code> commands offer a detailed built-in help, for example:
					</p><pre class="screen white-space-pre white-space-pre">$ <span class="strong strong"><strong>trust list --help</strong></span>
usage: trust list --filter=&lt;what&gt;

  --filter=&lt;what&gt;     filter of what to export
                        ca-anchors        certificate anchors
...
  --purpose=&lt;usage&gt;   limit to certificates usable for the purpose
                        server-auth       for authenticating servers
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">update-ca-trust(8)</code> and <code class="literal">trust(1)</code> man pages on your system
					</li></ul></div></section></section><section class="chapter" id="planning-and-implementing-tls_securing-networks"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Planning and implementing TLS</h2></div></div></div><p class="_abstract _abstract">
			TLS (Transport Layer Security) is a cryptographic protocol used to secure network communications. When hardening system security settings by configuring preferred key-exchange protocols, authentication methods, and encryption algorithms, it is necessary to bear in mind that the broader the range of supported clients, the lower the resulting security. Conversely, strict security settings lead to limited compatibility with clients, which can result in some users being locked out of the system. Be sure to target the strictest available configuration and only relax it when it is required for compatibility reasons.
		</p><section class="section" id="ssl-and-tls-protocols_planning-and-implementing-tls"><div class="titlepage"><div><div><h3 class="title">4.1. SSL and TLS protocols</h3></div></div></div><p class="_abstract _abstract">
				The Secure Sockets Layer (SSL) protocol was originally developed by Netscape Corporation to provide a mechanism for secure communication over the Internet. Subsequently, the protocol was adopted by the Internet Engineering Task Force (IETF) and renamed to Transport Layer Security (TLS).
			</p><p>
				The TLS protocol sits between an application protocol layer and a reliable transport layer, such as TCP/IP. It is independent of the application protocol and can thus be layered underneath many different protocols, for example: HTTP, FTP, SMTP, and so on.
			</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 80%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140078483092256" scope="col">Protocol version</th><th align="left" valign="top" id="idm140078483091168" scope="col">Usage recommendation</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140078483092256"> <p>
								SSL v2
							</p>
							 </td><td align="left" valign="top" headers="idm140078483091168"> <p>
								Do not use. Has serious security vulnerabilities. Removed from the core crypto libraries since RHEL 7.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140078483092256"> <p>
								SSL v3
							</p>
							 </td><td align="left" valign="top" headers="idm140078483091168"> <p>
								Do not use. Has serious security vulnerabilities. Removed from the core crypto libraries since RHEL 8.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140078483092256"> <p>
								TLS 1.0
							</p>
							 </td><td align="left" valign="top" headers="idm140078483091168"> <p>
								Not recommended to use. Has known issues that cannot be mitigated in a way that guarantees interoperability, and does not support modern cipher suites. In RHEL 9, disabled in all cryptographic policies.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140078483092256"> <p>
								TLS 1.1
							</p>
							 </td><td align="left" valign="top" headers="idm140078483091168"> <p>
								Use for interoperability purposes where needed. Does not support modern cipher suites. In RHEL 9, disabled in all cryptographic policies.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140078483092256"> <p>
								TLS 1.2
							</p>
							 </td><td align="left" valign="top" headers="idm140078483091168"> <p>
								Supports the modern AEAD cipher suites. This version is enabled in all system-wide crypto policies, but optional parts of this protocol contain vulnerabilities and TLS 1.2 also allows outdated algorithms.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140078483092256"> <p>
								TLS 1.3
							</p>
							 </td><td align="left" valign="top" headers="idm140078483091168"> <p>
								Recommended version. TLS 1.3 removes known problematic options, provides additional privacy by encrypting more of the negotiation handshake and can be faster thanks usage of more efficient modern cryptographic algorithms. TLS 1.3 is also enabled in all system-wide cryptographic policies.
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://tools.ietf.org/html/rfc8446">IETF: The Transport Layer Security (TLS) Protocol Version 1.3</a>
					</li></ul></div></section><section class="section" id="security-considerations-for-tls-in-rhel_planning-and-implementing-tls"><div class="titlepage"><div><div><h3 class="title">4.2. Security considerations for TLS in RHEL 9</h3></div></div></div><p class="_abstract _abstract">
				In RHEL 9, TLS configuration is performed using the system-wide cryptographic policies mechanism. TLS versions below 1.2 are not supported anymore. <code class="literal">DEFAULT</code>, <code class="literal">FUTURE</code>, and <code class="literal">LEGACY</code> cryptographic policies allow only TLS 1.2 and 1.3. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a> for more information.
			</p><p>
				The default settings provided by libraries included in RHEL 9 are secure enough for most deployments. The TLS implementations use secure algorithms where possible while not preventing connections from or to legacy clients or servers. Apply hardened settings in environments with strict security requirements where legacy clients or servers that do not support secure algorithms or protocols are not expected or allowed to connect.
			</p><p>
				The most straightforward way to harden your TLS configuration is switching the system-wide cryptographic policy level to <code class="literal">FUTURE</code> using the <code class="literal">update-crypto-policies --set FUTURE</code> command.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Algorithms disabled for the <code class="literal">LEGACY</code> cryptographic policy do not conform to Red Hat’s vision of RHEL 9 security, and their security properties are not reliable. Consider moving away from using these algorithms instead of re-enabling them. If you do decide to re-enable them, for example for interoperability with old hardware, treat them as insecure and apply extra protection measures, such as isolating their network interactions to separate network segments. Do not use them across public networks.
				</p></div></rh-alert><p>
				If you decide to not follow RHEL system-wide crypto policies or create custom cryptographic policies tailored to your setup, use the following recommendations for preferred protocols, cipher suites, and key lengths on your custom configuration:
			</p><section class="section" id="protocols"><div class="titlepage"><div><div><h4 class="title">4.2.1. Protocols</h4></div></div></div><p>
					The latest version of TLS provides the best security mechanism. TLS 1.2 is now the minimum version even when using the <code class="literal">LEGACY</code> cryptographic policy. Re-enabling older protocol versions is possible through either opting out of cryptographic policies or providing a custom policy, but the resulting configuration will not be supported.
				</p><p>
					Note that even though that RHEL 9 supports TLS version 1.3, not all features of this protocol are fully supported by RHEL 9 components. For example, the 0-RTT (Zero Round Trip Time) feature, which reduces connection latency, is not yet fully supported by the Apache web server.
				</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
						A RHEL 9.2 and later system running in FIPS mode enforces that any TLS 1.2 connection must use the Extended Master Secret (EMS) extension (RFC 7627) as requires the FIPS 140-3 standard. Thus, legacy clients not supporting EMS or TLS 1.3 cannot connect to RHEL 9 servers running in FIPS mode, RHEL 9 clients in FIPS mode cannot connect to servers that support only TLS 1.2 without EMS. See <a class="link" href="https://access.redhat.com/solutions/7018256">TLS Extension "Extended Master Secret" enforced with Red Hat Enterprise Linux 9.2</a>
					</p></div></rh-alert></section><section class="section" id="cipher_suites"><div class="titlepage"><div><div><h4 class="title">4.2.2. Cipher suites</h4></div></div></div><p>
					Modern, more secure cipher suites should be preferred to old, insecure ones. Always disable the use of eNULL and aNULL cipher suites, which do not offer any encryption or authentication at all. If at all possible, ciphers suites based on RC4 or HMAC-MD5, which have serious shortcomings, should also be disabled. The same applies to the so-called export cipher suites, which have been intentionally made weaker, and thus are easy to break.
				</p><p>
					While not immediately insecure, cipher suites that offer less than 128 bits of security should not be considered for their short useful life. Algorithms that use 128 bits of security or more can be expected to be unbreakable for at least several years, and are thus strongly recommended. Note that while 3DES ciphers advertise the use of 168 bits, they actually offer 112 bits of security.
				</p><p>
					Always prefer cipher suites that support (perfect) forward secrecy (PFS), which ensures the confidentiality of encrypted data even in case the server key is compromised. This rules out the fast RSA key exchange, but allows for the use of ECDHE and DHE. Of the two, ECDHE is the faster and therefore the preferred choice.
				</p><p>
					You should also prefer AEAD ciphers, such as AES-GCM, over CBC-mode ciphers as they are not vulnerable to padding oracle attacks. Additionally, in many cases, AES-GCM is faster than AES in CBC mode, especially when the hardware has cryptographic accelerators for AES.
				</p><p>
					Note also that when using the ECDHE key exchange with ECDSA certificates, the transaction is even faster than a pure RSA key exchange. To provide support for legacy clients, you can install two pairs of certificates and keys on a server: one with ECDSA keys (for new clients) and one with RSA keys (for legacy ones).
				</p></section><section class="section" id="public_key_length"><div class="titlepage"><div><div><h4 class="title">4.2.3. Public key length</h4></div></div></div><p>
					When using RSA keys, always prefer key lengths of at least 3072 bits signed by at least SHA-256, which is sufficiently large for true 128 bits of security.
				</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
						The security of your system is only as strong as the weakest link in the chain. For example, a strong cipher alone does not guarantee good security. The keys and the certificates are just as important, as well as the hash functions and keys used by the Certification Authority (CA) to sign your keys.
					</p></div></rh-alert></section></section><section class="section" id="hardening-tls-configuration-in-applications_planning-and-implementing-tls"><div class="titlepage"><div><div><h3 class="title">4.3. Hardening TLS configuration in applications</h3></div></div></div><p class="_abstract _abstract">
				In RHEL, <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">system-wide crypto policies</a> provide a convenient way to ensure that your applications that use cryptographic libraries do not allow known insecure protocols, ciphers, or algorithms.
			</p><p>
				If you want to harden your TLS-related configuration with your customized cryptographic settings, you can use the cryptographic configuration options described in this section, and override the system-wide crypto policies just in the minimum required amount.
			</p><p>
				Regardless of the configuration you choose to use, always ensure that your server application enforces <span class="emphasis"><em>server-side cipher order</em></span>, so that the cipher suite to be used is determined by the order you configure.
			</p><section class="section" id="configuring-the-apache-http-server_planning-and-implementing-tls"><div class="titlepage"><div><div><h4 class="title">4.3.1. Configuring the Apache HTTP server to use TLS</h4></div></div></div><p>
					The <code class="literal application">Apache HTTP Server</code> can use both <code class="literal application">OpenSSL</code> and <code class="literal application">NSS</code> libraries for its TLS needs. RHEL 9 provides the <code class="literal application">mod_ssl</code> functionality through eponymous packages:
				</p><pre class="screen"># <span class="strong strong"><strong>dnf install mod_ssl</strong></span></pre><p>
					The <code class="literal package">mod_ssl</code> package installs the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> configuration file, which can be used to modify the TLS-related settings of the <code class="literal application">Apache HTTP Server</code>.
				</p><p>
					Install the <code class="literal package">httpd-manual</code> package to obtain complete documentation for the <code class="literal application">Apache HTTP Server</code>, including TLS configuration. The directives available in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> configuration file are described in detail in the <code class="literal">/usr/share/httpd/manual/mod/mod_ssl.html</code> file. Examples of various settings are described in the <code class="literal">/usr/share/httpd/manual/ssl/ssl_howto.html</code> file.
				</p><p>
					When modifying the settings in the <code class="literal">/etc/httpd/conf.d/ssl.conf</code> configuration file, be sure to consider the following three directives at the minimum:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal option">SSLProtocol</code></span></dt><dd>
								Use this directive to specify the version of TLS or SSL you want to allow.
							</dd><dt><span class="term"><code class="literal option">SSLCipherSuite</code></span></dt><dd>
								Use this directive to specify your preferred cipher suite or disable the ones you want to disallow.
							</dd><dt><span class="term"><code class="literal option">SSLHonorCipherOrder</code></span></dt><dd>
								Uncomment and set this directive to <code class="literal">on</code> to ensure that the connecting clients adhere to the order of ciphers you specified.
							</dd></dl></div><p>
					For example, to use only the TLS 1.2 and 1.3 protocol:
				</p><pre class="screen">SSLProtocol             all -SSLv3 -TLSv1 -TLSv1.1</pre><p>
					See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/setting-apache-http-server_deploying-web-servers-and-reverse-proxies#configuring-tls-encryption-on-an-apache-http-server_setting-apache-http-server">Configuring TLS encryption on an Apache HTTP Server</a> chapter in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/index">Deploying web servers and reverse proxies</a> document for more information.
				</p></section><section class="section" id="configuring-the-nginx-http-and-proxy-server_planning-and-implementing-tls"><div class="titlepage"><div><div><h4 class="title">4.3.2. Configuring the Nginx HTTP and proxy server to use TLS</h4></div></div></div><p>
					To enable TLS 1.3 support in <code class="literal">Nginx</code>, add the <code class="literal">TLSv1.3</code> value to the <code class="literal">ssl_protocols</code> option in the <code class="literal">server</code> section of the <code class="literal">/etc/nginx/nginx.conf</code> configuration file:
				</p><pre class="screen">server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    ....
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers
    ....
}</pre><p>
					See the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/setting-up-and-configuring-nginx_deploying-web-servers-and-reverse-proxies#adding-tls-encryption-to-an-nginx-web-server_setting-up-and-configuring-nginx">Adding TLS encryption to an Nginx web server</a> chapter in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/index">Deploying web servers and reverse proxies</a> document for more information.
				</p></section><section class="section" id="configuring-the-Dovecot-mail-server_planning-and-implementing-tls"><div class="titlepage"><div><div><h4 class="title">4.3.3. Configuring the Dovecot mail server to use TLS</h4></div></div></div><p>
					To configure your installation of the <code class="literal application">Dovecot</code> mail server to use TLS, modify the <code class="literal">/etc/dovecot/conf.d/10-ssl.conf</code> configuration file. You can find an explanation of some of the basic configuration directives available in that file in the <code class="literal">/usr/share/doc/dovecot/wiki/SSL.DovecotConfiguration.txt</code> file, which is installed along with the standard installation of <code class="literal application">Dovecot</code>.
				</p><p>
					When modifying the settings in the <code class="literal">/etc/dovecot/conf.d/10-ssl.conf</code> configuration file, be sure to consider the following three directives at the minimum:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal option">ssl_protocols</code></span></dt><dd>
								Use this directive to specify the version of TLS or SSL you want to allow or disable.
							</dd><dt><span class="term"><code class="literal option">ssl_cipher_list</code></span></dt><dd>
								Use this directive to specify your preferred cipher suites or disable the ones you want to disallow.
							</dd><dt><span class="term"><code class="literal option">ssl_prefer_server_ciphers</code></span></dt><dd>
								Uncomment and set this directive to <code class="literal">yes</code> to ensure that the connecting clients adhere to the order of ciphers you specified.
							</dd></dl></div><p>
					For example, the following line in <code class="literal">/etc/dovecot/conf.d/10-ssl.conf</code> allows only TLS 1.1 and later:
				</p><pre class="screen">ssl_protocols = !SSLv2 !SSLv3 !TLSv1</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/index">Deploying web servers and reverse proxies</a>
						</li><li class="listitem">
							<code class="literal">config(5)</code> and <code class="literal">ciphers(1)</code> man pages.
						</li><li class="listitem">
							<a class="link" href="https://tools.ietf.org/html/rfc7525">Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)</a>.
						</li><li class="listitem">
							<a class="link" href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">Mozilla SSL Configuration Generator</a>.
						</li><li class="listitem">
							<a class="link" href="https://www.ssllabs.com/ssltest/">SSL Server Test</a>.
						</li></ul></div></section></section></section><section class="chapter" id="configuring-a-vpn-connection_securing-networks"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Setting up an IPsec VPN</h2></div></div></div><p>
			<span id="configuring-a-vpn-with-ipsec_securing-networks"><!--Empty--></span>
		</p><p class="_abstract _abstract">
			A virtual private network (VPN) is a way of connecting to a local network over the internet. <code class="literal">IPsec</code> provided by <code class="literal">Libreswan</code> is the preferred method for creating a VPN. <code class="literal">Libreswan</code> is a user-space <code class="literal">IPsec</code> implementation for VPN. A VPN enables the communication between your LAN, and another, remote LAN by setting up a tunnel across an intermediate network such as the internet. For security reasons, a VPN tunnel always uses authentication and encryption. For cryptographic operations, <code class="literal">Libreswan</code> uses the <code class="literal">NSS</code> library.
		</p><section class="section" id="libreswan-as-an-ipsec-vpn-implementation_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.1. Libreswan as an IPsec VPN implementation</h3></div></div></div><p class="_abstract _abstract">
				In RHEL, you can configure a Virtual Private Network (VPN) by using the IPsec protocol, which is supported by the Libreswan application. Libreswan is a continuation of the Openswan application, and many examples from the Openswan documentation are interchangeable with Libreswan.
			</p><p>
				The IPsec protocol for a VPN is configured using the Internet Key Exchange (IKE) protocol. The terms IPsec and IKE are used interchangeably. An IPsec VPN is also called an IKE VPN, IKEv2 VPN, XAUTH VPN, Cisco VPN or IKE/IPsec VPN. A variant of an IPsec VPN that also uses the Layer 2 Tunneling Protocol (L2TP) is usually called an L2TP/IPsec VPN, which requires the <code class="literal">xl2tpd</code> package provided by the <code class="literal">optional</code> repository.
			</p><p>
				Libreswan is an open-source, user-space IKE implementation. IKE v1 and v2 are implemented as a user-level daemon. The IKE protocol is also encrypted. The IPsec protocol is implemented by the Linux kernel, and Libreswan configures the kernel to add and remove VPN tunnel configurations.
			</p><p>
				The IKE protocol uses UDP port 500 and 4500. The IPsec protocol consists of two protocols:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Encapsulated Security Payload (ESP), which has protocol number 50.
					</li><li class="listitem">
						Authenticated Header (AH), which has protocol number 51.
					</li></ul></div><p>
				The AH protocol is not recommended for use. Users of AH are recommended to migrate to ESP with null encryption.
			</p><p>
				The IPsec protocol provides two modes of operation:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Tunnel Mode (the default)
					</li><li class="listitem">
						Transport Mode.
					</li></ul></div><p>
				You can configure the kernel with IPsec without IKE. This is called <span class="emphasis"><em>manual keying</em></span>. You can also configure manual keying using the <code class="literal command">ip xfrm</code> commands, however, this is strongly discouraged for security reasons. Libreswan communicates with the Linux kernel using the Netlink interface. The kernel performs packet encryption and decryption.
			</p><p>
				Libreswan uses the Network Security Services (NSS) cryptographic library. NSS is certified for use with the <span class="emphasis"><em>Federal Information Processing Standard</em></span> (<span class="emphasis"><em>FIPS</em></span>) Publication 140-2.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					IKE/IPsec VPNs, implemented by Libreswan and the Linux kernel, is the only VPN technology recommended for use in RHEL. Do not use any other VPN technology without understanding the risks of doing so.
				</p></div></rh-alert><p>
				In RHEL, Libreswan follows <span class="strong strong"><strong>system-wide cryptographic policies</strong></span> by default. This ensures that Libreswan uses secure settings for current threat models including IKEv2 as a default protocol. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide crypto policies</a> for more information.
			</p><p>
				Libreswan does not use the terms "source" and "destination" or "server" and "client" because IKE/IPsec are peer to peer protocols. Instead, it uses the terms "left" and "right" to refer to end points (the hosts). This also allows you to use the same configuration on both end points in most cases. However, administrators usually choose to always use "left" for the local host and "right" for the remote host.
			</p><p>
				The <code class="literal option">leftid</code> and <code class="literal option">rightid</code> options serve as identification of the respective hosts in the authentication process. See the <code class="literal">ipsec.conf(5)</code> man page for more information.
			</p></section><section class="section" id="con_authentication-methods-in-libreswan_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.2. Authentication methods in Libreswan</h3></div></div></div><p>
				Libreswan supports several authentication methods, each of which fits a different scenario.
			</p><div class="formalpara"><p class="title"><strong>Pre-Shared key (PSK)</strong></p><p>
					<span class="emphasis"><em>Pre-Shared Key</em></span> (PSK) is the simplest authentication method. For security reasons, do not use PSKs shorter than 64 random characters. In FIPS mode, PSKs must comply with a minimum-strength requirement depending on the integrity algorithm used. You can set PSK by using the <code class="literal">authby=secret</code> connection.
				</p></div><div class="formalpara"><p class="title"><strong>Raw RSA keys</strong></p><p>
					<span class="emphasis"><em>Raw RSA keys</em></span> are commonly used for static host-to-host or subnet-to-subnet IPsec configurations. Each host is manually configured with the public RSA keys of all other hosts, and Libreswan sets up an IPsec tunnel between each pair of hosts. This method does not scale well for large numbers of hosts.
				</p></div><p>
				You can generate a raw RSA key on a host using the <code class="literal">ipsec newhostkey</code> command. You can list generated keys by using the <code class="literal">ipsec showhostkey</code> command. The <code class="literal">leftrsasigkey=</code> line is required for connection configurations that use CKA ID keys. Use the <code class="literal">authby=rsasig</code> connection option for raw RSA keys.
			</p><div class="formalpara"><p class="title"><strong>X.509 certificates</strong></p><p>
					<span class="emphasis"><em>X.509 certificates</em></span> are commonly used for large-scale deployments with hosts that connect to a common IPsec gateway. A central <span class="emphasis"><em>certificate authority</em></span> (CA) signs RSA certificates for hosts or users. This central CA is responsible for relaying trust, including the revocations of individual hosts or users.
				</p></div><p>
				For example, you can generate X.509 certificates using the <code class="literal">openssl</code> command and the NSS <code class="literal">certutil</code> command. Because Libreswan reads user certificates from the NSS database using the certificates' nickname in the <code class="literal">leftcert=</code> configuration option, provide a nickname when you create a certificate.
			</p><p>
				If you use a custom CA certificate, you must import it to the Network Security Services (NSS) database. You can import any certificate in the PKCS #12 format to the Libreswan NSS database by using the <code class="literal">ipsec import</code> command.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Libreswan requires an Internet Key Exchange (IKE) peer ID as a subject alternative name (SAN) for every peer certificate as described in <a class="link" href="https://datatracker.ietf.org/doc/html/rfc4945#section-3.1">section 3.1 of RFC 4945</a>. Disabling this check by changing the <code class="literal">require-id-on-certificated=</code> option can make the system vulnerable to man-in-the-middle attacks.
				</p></div></rh-alert><p>
				Use the <code class="literal">authby=rsasig</code> connection option for authentication based on X.509 certificates using RSA with SHA-2. You can further limit it for ECDSA digital signatures using SHA-2 by setting <code class="literal">authby=</code> to <code class="literal">ecdsa</code> and RSA Probabilistic Signature Scheme (RSASSA-PSS) digital signatures based authentication with SHA-2 through <code class="literal">authby=rsa-sha2</code>. The default value is <code class="literal">authby=rsasig,ecdsa</code>.
			</p><p>
				The certificates and the <code class="literal">authby=</code> signature methods should match. This increases interoperability and preserves authentication in one digital signature system.
			</p><div class="formalpara"><p class="title"><strong>NULL authentication</strong></p><p>
					<span class="emphasis"><em>NULL authentication</em></span> is used to gain mesh encryption without authentication. It protects against passive attacks but not against active attacks. However, because IKEv2 allows asymmetric authentication methods, NULL authentication can also be used for internet-scale opportunistic IPsec. In this model, clients authenticate the server, but servers do not authenticate the client. This model is similar to secure websites using TLS. Use <code class="literal">authby=null</code> for NULL authentication.
				</p></div><div class="formalpara"><p class="title"><strong>Protection against quantum computers</strong></p><p>
					In addition to the previously mentioned authentication methods, you can use the <span class="emphasis"><em>Post-quantum Pre-shared Key</em></span> (PPK) method to protect against possible attacks by quantum computers. Individual clients or groups of clients can use their own PPK by specifying a PPK ID that corresponds to an out-of-band configured pre-shared key.
				</p></div><p>
				Using IKEv1 with pre-shared keys protects against quantum attackers. The redesign of IKEv2 does not offer this protection natively. Libreswan offers the use of a <span class="emphasis"><em>Post-quantum Pre-shared Key</em></span> (PPK) to protect IKEv2 connections against quantum attacks.
			</p><p>
				To enable optional PPK support, add <code class="literal option">ppk=yes</code> to the connection definition. To require PPK, add <code class="literal option">ppk=insist</code>. Then, each client can be given a PPK ID with a secret value that is communicated out-of-band (and preferably quantum-safe). The PPK’s should be very strong in randomness and not based on dictionary words. The PPK ID and PPK data are stored in the <code class="literal">ipsec.secrets</code> file, for example:
			</p><pre class="screen">@west @east : PPKS "user1" "thestringismeanttobearandomstr"</pre><p>
				The <code class="literal option">PPKS</code> option refers to static PPKs. This experimental function uses one-time-pad-based Dynamic PPKs. Upon each connection, a new part of the one-time pad is used as the PPK. When used, that part of the dynamic PPK inside the file is overwritten with zeros to prevent re-use. If there is no more one-time-pad material left, the connection fails. See the <code class="literal">ipsec.secrets(5)</code> man page for more information.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					The implementation of dynamic PPKs is provided as an unsupported Technology Preview. Use with caution.
				</p></div></rh-alert></section><section class="section" id="installing-libreswan_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.3. Installing Libreswan</h3></div></div></div><p>
				Before you can set a VPN through the Libreswan IPsec/IKE implementation, you must install the corresponding packages, start the <code class="literal">ipsec</code> service, and allow the service in your firewall.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">AppStream</code> repository is enabled.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">libreswan</code> packages:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install libreswan</strong></span></pre></li><li class="listitem"><p class="simpara">
						If you are re-installing Libreswan, remove its old database files and create a new database:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop ipsec</strong></span>
# <span class="strong strong"><strong>rm /var/lib/ipsec/nss/*db</strong></span>
# <span class="strong strong"><strong>ipsec initnss</strong></span></pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">ipsec</code> service, and enable the service to be started automatically on boot:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable ipsec --now</strong></span></pre></li><li class="listitem"><p class="simpara">
						Configure the firewall to allow 500 and 4500/UDP ports for the IKE, ESP, and AH protocols by adding the <code class="literal">ipsec</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-service="ipsec"</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre></li></ol></div></section><section class="section" id="creating-a-host-to-host-vpn_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.4. Creating a host-to-host VPN</h3></div></div></div><p>
				You can configure Libreswan to create a host-to-host IPsec VPN between two hosts referred to as <span class="emphasis"><em>left</em></span> and <span class="emphasis"><em>right</em></span> using authentication by raw RSA keys.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Libreswan is installed and the <code class="literal">ipsec</code> service is started on each node.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a raw RSA key pair on each host:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec newhostkey</strong></span></pre></li><li class="listitem"><p class="simpara">
						The previous step returned the generated key’s <code class="literal">ckaid</code>. Use that <code class="literal">ckaid</code> with the following command on <span class="emphasis"><em>left</em></span>, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec showhostkey --left --ckaid 2d3ea57b61c9419dfd6cf43a1eb6cb306c0e857d</strong></span></pre><p class="simpara">
						The output of the previous command generated the <code class="literal">leftrsasigkey=</code> line required for the configuration. Do the same on the second host (<span class="emphasis"><em>right</em></span>):
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec showhostkey --right --ckaid a9e1f6ce9ecd3608c24e8f701318383f41798f03</strong></span></pre></li><li class="listitem"><p class="simpara">
						In the <code class="literal filename">/etc/ipsec.d/</code> directory, create a new <code class="literal filename">my_host-to-host.conf</code> file. Write the RSA host keys from the output of the <code class="literal command">ipsec showhostkey</code> commands in the previous step to the new file. For example:
					</p><pre class="screen">conn mytunnel
    leftid=@west
    left=192.1.2.23
    leftrsasigkey=0sAQOrlo+hOafUZDlCQmXFrje/oZm [...] W2n417C/4urYHQkCvuIQ==
    rightid=@east
    right=192.1.2.45
    rightrsasigkey=0sAQO3fwC6nSSGgt64DWiYZzuHbc4 [...] D/v8t5YTQ==
    authby=rsasig</pre></li><li class="listitem"><p class="simpara">
						After importing keys, restart the <code class="literal">ipsec</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart ipsec</strong></span></pre></li><li class="listitem"><p class="simpara">
						Load the connection:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --add mytunnel</strong></span></pre></li><li class="listitem"><p class="simpara">
						Establish the tunnel:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up mytunnel</strong></span></pre></li><li class="listitem"><p class="simpara">
						To automatically start the tunnel when the <code class="literal">ipsec</code> service is started, add the following line to the connection definition:
					</p><pre class="screen">auto=start</pre></li></ol></div></section><section class="section" id="configuring-a-site-to-site-vpn_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.5. Configuring a site-to-site VPN</h3></div></div></div><p class="_abstract _abstract">
				To create a site-to-site IPsec VPN, by joining two networks, an IPsec tunnel between the two hosts, is created. The hosts thus act as the end points, which are configured to permit traffic from one or more subnets to pass through. Therefore you can think of the host as gateways to the remote portion of the network.
			</p><p>
				The configuration of the site-to-site VPN only differs from the host-to-host VPN in that one or more networks or subnets must be specified in the configuration file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A <a class="link" href="#creating-a-host-to-host-vpn_configuring-a-vpn-with-ipsec" title="5.4. Creating a host-to-host VPN">host-to-host VPN</a> is already configured.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Copy the file with the configuration of your host-to-host VPN to a new file, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cp /etc/ipsec.d/<span class="emphasis"><em>my_host-to-host.conf</em></span> /etc/ipsec.d/<span class="emphasis"><em>my_site-to-site</em></span>.conf</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add the subnet configuration to the file created in the previous step, for example:
					</p><pre class="screen">conn mysubnet
     also=mytunnel
     leftsubnet=192.0.1.0/24
     rightsubnet=192.0.2.0/24
     auto=start

conn mysubnet6
     also=mytunnel
     leftsubnet=2001:db8:0:1::/64
     rightsubnet=2001:db8:0:2::/64
     auto=start

# the following part of the configuration file is the same for both host-to-host and site-to-site connections:

conn mytunnel
    leftid=@west
    left=192.1.2.23
    leftrsasigkey=0sAQOrlo+hOafUZDlCQmXFrje/oZm [...] W2n417C/4urYHQkCvuIQ==
    rightid=@east
    right=192.1.2.45
    rightrsasigkey=0sAQO3fwC6nSSGgt64DWiYZzuHbc4 [...] D/v8t5YTQ==
    authby=rsasig</pre></li></ol></div></section><section class="section" id="configuring-a-remote-access-vpn_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.6. Configuring a remote access VPN</h3></div></div></div><p class="_abstract _abstract">
				Road warriors are traveling users with mobile clients and a dynamically assigned IP address. The mobile clients authenticate using X.509 certificates.
			</p><p>
				The following example shows configuration for <code class="literal">IKEv2</code>, and it avoids using the <code class="literal">IKEv1</code> XAUTH protocol.
			</p><p>
				On the server:
			</p><pre class="screen">conn roadwarriors
    ikev2=insist
    # support (roaming) MOBIKE clients (RFC 4555)
    mobike=yes
    fragmentation=yes
    left=1.2.3.4
    # if access to the LAN is given, enable this, otherwise use 0.0.0.0/0
    # leftsubnet=10.10.0.0/16
    leftsubnet=0.0.0.0/0
    leftcert=gw.example.com
    leftid=%fromcert
    leftxauthserver=yes
    leftmodecfgserver=yes
    right=%any
    # trust our own Certificate Agency
    rightca=%same
    # pick an IP address pool to assign to remote users
    # 100.64.0.0/16 prevents RFC1918 clashes when remote users are behind NAT
    rightaddresspool=100.64.13.100-100.64.13.254
    # if you want remote clients to use some local DNS zones and servers
    modecfgdns="1.2.3.4, 5.6.7.8"
    modecfgdomains="internal.company.com, corp"
    rightxauthclient=yes
    rightmodecfgclient=yes
    authby=rsasig
    # optionally, run the client X.509 ID through pam to allow or deny client
    # pam-authorize=yes
    # load connection, do not initiate
    auto=add
    # kill vanished roadwarriors
    dpddelay=1m
    dpdtimeout=5m
    dpdaction=clear</pre><p>
				On the mobile client, the road warrior’s device, use a slight variation of the previous configuration:
			</p><pre class="screen">conn to-vpn-server
    ikev2=insist
    # pick up our dynamic IP
    left=%defaultroute
    leftsubnet=0.0.0.0/0
    leftcert=myname.example.com
    leftid=%fromcert
    leftmodecfgclient=yes
    # right can also be a DNS hostname
    right=1.2.3.4
    # if access to the remote LAN is required, enable this, otherwise use 0.0.0.0/0
    # rightsubnet=10.10.0.0/16
    rightsubnet=0.0.0.0/0
    fragmentation=yes
    # trust our own Certificate Agency
    rightca=%same
    authby=rsasig
    # allow narrowing to the server’s suggested assigned IP and remote subnet
    narrowing=yes
    # support (roaming) MOBIKE clients (RFC 4555)
    mobike=yes
    # initiate connection
    auto=start</pre></section><section class="section" id="configuring-a-mesh-vpn_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.7. Configuring a mesh VPN</h3></div></div></div><p>
				A mesh VPN network, which is also known as an <span class="emphasis"><em>any-to-any</em></span> VPN, is a network where all nodes communicate using IPsec. The configuration allows for exceptions for nodes that cannot use IPsec. The mesh VPN network can be configured in two ways:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						To require IPsec.
					</li><li class="listitem">
						To prefer IPsec but allow a fallback to clear-text communication.
					</li></ul></div><p>
				Authentication between the nodes can be based on X.509 certificates or on DNS Security Extensions (DNSSEC).
			</p><p>
				You can use any regular IKEv2 authentication method for <span class="emphasis"><em>opportunistic IPsec</em></span>, because these connections are regular Libreswan configurations, except for the opportunistic IPsec that is defined by <code class="literal">right=%opportunisticgroup</code> entry. A common authentication method is for hosts to authenticate each other based on X.509 certificates using a commonly shared certification authority (CA). Cloud deployments typically issue certificates for each node in the cloud as part of the standard procedure.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Do not use PreSharedKey (PSK) authentication because one compromised host would result in group PSK secret being compromised as well.
				</p></div></rh-alert><p>
				You can use NULL authentication to deploy encryption between nodes without authentication, which protects only against passive attackers.
			</p><p>
				The following procedure uses X.509 certificates. You can generate these certificates by using any kind of CA management system, such as the Dogtag Certificate System. Dogtag assumes that the certificates for each node are available in the PKCS #12 format (<code class="literal">.p12</code> files), which contain the private key, the node certificate, and the Root CA certificate used to validate other nodes' X.509 certificates.
			</p><p>
				Each node has an identical configuration with the exception of its X.509 certificate. This allows for adding new nodes without reconfiguring any of the existing nodes in the network. The PKCS #12 files require a "friendly name", for which we use the name "node" so that the configuration files referencing the friendly name can be identical for all nodes.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Libreswan is installed, and the <code class="literal">ipsec</code> service is started on each node.
					</li><li class="listitem"><p class="simpara">
						A new NSS database is initialized.
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								If you already have an old NSS database, remove the old database files:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop ipsec</strong></span>
# <span class="strong strong"><strong>rm /var/lib/ipsec/nss/*db</strong></span></pre></li><li class="listitem"><p class="simpara">
								You can initialize a new database with the following command:
							</p><pre class="screen"># <span class="strong strong"><strong>ipsec initnss</strong></span></pre></li></ol></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On each node, import PKCS #12 files. This step requires the password used to generate the PKCS #12 files:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec import nodeXXX.p12</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create the following three connection definitions for the <code class="literal">IPsec required</code> (private), <code class="literal">IPsec optional</code> (private-or-clear), and <code class="literal">No IPsec</code> (clear) profiles:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /etc/ipsec.d/mesh.conf</strong></span>
conn clear
	auto=ondemand <span id="CO1-1"><!--Empty--></span><span class="callout">1</span>
	type=passthrough
	authby=never
	left=%defaultroute
	right=%group

conn private
	auto=ondemand
	type=transport
	authby=rsasig
	failureshunt=drop
	negotiationshunt=drop
	ikev2=insist
	left=%defaultroute
	leftcert=<span class="emphasis"><em>nodeXXXX</em></span>
	leftid=%fromcert <span id="CO1-2"><!--Empty--></span><span class="callout">2</span>
	rightid=%fromcert
	right=%opportunisticgroup

conn private-or-clear
	auto=ondemand
	type=transport
	authby=rsasig
	failureshunt=passthrough
	negotiationshunt=passthrough
	# left
	left=%defaultroute
	leftcert=<span class="emphasis"><em>nodeXXXX</em></span> <span id="CO1-3"><!--Empty--></span><span class="callout">3</span>
	leftid=%fromcert
	leftrsasigkey=%cert
	# right
	rightrsasigkey=%cert
	rightid=%fromcert
	right=%opportunisticgroup</pre></li></ol></div><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO1-1"><span class="callout">1</span></a> </dt><dd><div class="para">
						The <code class="literal">auto</code> variable has several options:
					</div><p>
						You can use the <code class="literal">ondemand</code> connection option with opportunistic IPsec to initiate the IPsec connection, or for explicitly configured connections that do not need to be active all the time. This option sets up a trap XFRM policy in the kernel, enabling the IPsec connection to begin when it receives the first packet that matches that policy.
					</p><p>
						You can effectively configure and manage your IPsec connections, whether you use Opportunistic IPsec or explicitly configured connections, by using the following options:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">The <code class="literal">add</code> option</span></dt><dd>
									Loads the connection configuration and prepares it for responding to remote initiations. However, the connection is not automatically initiated from the local side. You can manually start the IPsec connection by using the command <code class="literal">ipsec auto --up</code>.
								</dd><dt><span class="term">The <code class="literal">start</code> option</span></dt><dd>
									Loads the connection configuration and prepares it for responding to remote initiations. Additionally, it immediately initiates a connection to the remote peer. You can use this option for permanent and always active connections.
								</dd></dl></div></dd><dt><a href="#CO1-2"><span class="callout">2</span></a> </dt><dd><div class="para">
						The <code class="literal">leftid</code> and <code class="literal">rightid</code> variables identify the right and the left channel of the IPsec tunnel connection. You can use these variables to obtain the value of the local IP address or the subject DN of the local certificate, if you have configured one.
					</div></dd><dt><a href="#CO1-3"><span class="callout">3</span></a> </dt><dd><div class="para">
						The <code class="literal">leftcert</code> variable defines the nickname of the NSS database that you want to use.
					</div><div class="orderedlist"><ol class="orderedlist" start="3" type="1"><li class="listitem"><p class="simpara">
								Add the IP address of the network to the corresponding category. For example, if all nodes reside in the <code class="literal">10.15.0.0/16</code> network, and all nodes must use IPsec encryption:
							</p><pre class="screen"># <span class="strong strong"><strong>echo "10.15.0.0/16" &gt;&gt; /etc/ipsec.d/policies/private</strong></span></pre></li><li class="listitem"><p class="simpara">
								To allow certain nodes, for example, <code class="literal">10.15.34.0/24</code>, to work with and without IPsec, add those nodes to the private-or-clear group:
							</p><pre class="screen"># <span class="strong strong"><strong>echo "10.15.34.0/24" &gt;&gt; /etc/ipsec.d/policies/private-or-clear</strong></span></pre></li><li class="listitem"><p class="simpara">
								To define a host, for example, <code class="literal">10.15.1.2</code>, which is not capable of IPsec into the clear group, use:
							</p><pre class="screen"># <span class="strong strong"><strong>echo "10.15.1.2/32" &gt;&gt; /etc/ipsec.d/policies/clear</strong></span></pre><p class="simpara">
								You can create the files in the <code class="literal">/etc/ipsec.d/policies</code> directory from a template for each new node, or you can provision them by using Puppet or Ansible.
							</p><p class="simpara">
								Note that every node has the same list of exceptions or different traffic flow expectations. Two nodes, therefore, might not be able to communicate because one requires IPsec and the other cannot use IPsec.
							</p></li><li class="listitem"><p class="simpara">
								Restart the node to add it to the configured mesh:
							</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart ipsec</strong></span></pre></li></ol></div></dd></dl></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open an IPsec tunnel by using the <code class="literal">ping</code> command:
					</p><pre class="screen"># <span class="strong strong"><strong>ping <span class="emphasis"><em>&lt;nodeYYY&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Display the NSS database with the imported certification:
					</p><pre class="screen"># <span class="strong strong"><strong>certutil -L -d sql:/etc/ipsec.d</strong></span>

Certificate Nickname    Trust Attributes
                        SSL,S/MIME,JAR/XPI

west                    u,u,u
ca                      CT,,</pre></li><li class="listitem"><p class="simpara">
						See which tunnels are open on the node:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec trafficstatus</strong></span>
006 #2: "private#10.15.0.0/16"[1] ...<span class="emphasis"><em>&lt;nodeYYY&gt;</em></span>, type=ESP, add_time=1691399301, inBytes=512, outBytes=512, maxBytes=2^63B, id='C=US, ST=NC, O=Example Organization, CN=east'</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">ipsec.conf(5)</code> man page on your system
					</li><li class="listitem">
						For more information about the <code class="literal">authby</code> variable, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/configuring-a-vpn-with-ipsec_securing-networks#con_authentication-methods-in-libreswan_configuring-a-vpn-with-ipsec">6.2. Authentication methods in Libreswan</a>.
					</li></ul></div></section><section class="section" id="deploying-a-fips-compliant-ipsec-vpn_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.8. Deploying a FIPS-compliant IPsec VPN</h3></div></div></div><p>
				You can deploy a FIPS-compliant IPsec VPN solution with Libreswan. To do so, you can identify which cryptographic algorithms are available and which are disabled for Libreswan in FIPS mode.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">AppStream</code> repository is enabled.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install the <code class="literal package">libreswan</code> packages:
					</p><pre class="screen"># <span class="strong strong"><strong>dnf install libreswan</strong></span></pre></li><li class="listitem"><p class="simpara">
						If you are re-installing Libreswan, remove its old NSS database:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop ipsec</strong></span>

# <span class="strong strong"><strong>rm /var/lib/ipsec/nss/*db</strong></span></pre></li><li class="listitem"><p class="simpara">
						Start the <code class="literal">ipsec</code> service, and enable the service to be started automatically on boot:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable ipsec --now</strong></span></pre></li><li class="listitem"><p class="simpara">
						Configure the firewall to allow <code class="literal">500</code> and <code class="literal">4500</code> UDP ports for the IKE, ESP, and AH protocols by adding the <code class="literal">ipsec</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-service="ipsec"</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre></li><li class="listitem"><p class="simpara">
						Switch the system to FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>fips-mode-setup --enable</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart your system to allow the kernel to switch to FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>reboot</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Confirm Libreswan is running in FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec whack --fipsstatus</strong></span>
000 FIPS mode enabled</pre></li><li class="listitem"><p class="simpara">
						Alternatively, check entries for the <code class="literal">ipsec</code> unit in the <code class="literal">systemd</code> journal:
					</p><pre class="screen">$ <span class="strong strong"><strong>journalctl -u ipsec</strong></span>
...
Jan 22 11:26:50 localhost.localdomain pluto[3076]: FIPS Mode: YES</pre></li><li class="listitem"><p class="simpara">
						To see the available algorithms in FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec pluto --selftest 2&gt;&amp;1 | head -6</strong></span>
Initializing NSS using read-write database "sql:/var/lib/ipsec/nss"
FIPS Mode: YES
NSS crypto library initialized
FIPS mode enabled for pluto daemon
NSS library is running in FIPS mode
FIPS HMAC integrity support [disabled]</pre></li><li class="listitem"><p class="simpara">
						To query disabled algorithms in FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec pluto --selftest 2&gt;&amp;1 | grep disabled</strong></span>
Encryption algorithm CAMELLIA_CTR disabled; not FIPS compliant
Encryption algorithm CAMELLIA_CBC disabled; not FIPS compliant
Encryption algorithm NULL disabled; not FIPS compliant
Encryption algorithm CHACHA20_POLY1305 disabled; not FIPS compliant
Hash algorithm MD5 disabled; not FIPS compliant
PRF algorithm HMAC_MD5 disabled; not FIPS compliant
PRF algorithm AES_XCBC disabled; not FIPS compliant
Integrity algorithm HMAC_MD5_96 disabled; not FIPS compliant
Integrity algorithm HMAC_SHA2_256_TRUNCBUG disabled; not FIPS compliant
Integrity algorithm AES_XCBC_96 disabled; not FIPS compliant
DH algorithm MODP1536 disabled; not FIPS compliant
DH algorithm DH31 disabled; not FIPS compliant</pre></li><li class="listitem"><p class="simpara">
						To list all allowed algorithms and ciphers in FIPS mode:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec pluto --selftest 2&gt;&amp;1 | grep ESP | grep FIPS | sed "s/^.*FIPS//"</strong></span>
aes_ccm, aes_ccm_c
aes_ccm_b
aes_ccm_a
NSS(CBC)  3des
NSS(GCM)  aes_gcm, aes_gcm_c
NSS(GCM)  aes_gcm_b
NSS(GCM)  aes_gcm_a
NSS(CTR)  aesctr
NSS(CBC)  aes
aes_gmac
NSS       sha, sha1, sha1_96, hmac_sha1
NSS       sha512, sha2_512, sha2_512_256, hmac_sha2_512
NSS       sha384, sha2_384, sha2_384_192, hmac_sha2_384
NSS       sha2, sha256, sha2_256, sha2_256_128, hmac_sha2_256
aes_cmac
null
NSS(MODP) null, dh0
NSS(MODP) dh14
NSS(MODP) dh15
NSS(MODP) dh16
NSS(MODP) dh17
NSS(MODP) dh18
NSS(ECP)  ecp_256, ecp256
NSS(ECP)  ecp_384, ecp384
NSS(ECP)  ecp_521, ecp521</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>
					</li></ul></div></section><section class="section" id="protecting-the-ipsec-nss-database-by-a-password_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.9. Protecting the IPsec NSS database by a password</h3></div></div></div><p>
				By default, the IPsec service creates its Network Security Services (NSS) database with an empty password during the first start. To enhance security, you can add password protection.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">/var/lib/ipsec/nss/</code> directory contains NSS database files.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable password protection for the <code class="literal">NSS</code> database for Libreswan:
					</p><pre class="screen"># <span class="strong strong"><strong>certutil -N -d sql:/var/lib/ipsec/nss</strong></span>
Enter Password or Pin for "NSS Certificate DB":
Enter a password which will be used to encrypt your keys.
The password should be at least 8 characters long,
and should contain at least one non-alphabetic character.

Enter new password:</pre></li><li class="listitem"><p class="simpara">
						Create the <code class="literal">/etc/ipsec.d/nsspassword</code> file that containins the password you have set in the previous step, for example:
					</p><pre class="screen"># <span class="strong strong"><strong>cat /etc/ipsec.d/nsspassword</strong></span>
NSS Certificate DB:_&lt;password&gt;_</pre><p class="simpara">
						The <code class="literal">nsspassword</code> file use the following syntax:
					</p><pre class="screen"><span class="emphasis"><em>&lt;token_1&gt;</em></span>:<span class="emphasis"><em>&lt;password1&gt;</em></span>
<span class="emphasis"><em>&lt;token_2&gt;</em></span>:<span class="emphasis"><em>&lt;password2&gt;</em></span></pre><p class="simpara">
						The default NSS software token is <code class="literal">NSS Certificate DB</code>. If your system is running in FIPS mode, the name of the token is <code class="literal">NSS FIPS 140-2 Certificate DB</code>.
					</p></li><li class="listitem"><p class="simpara">
						Depending on your scenario, either start or restart the <code class="literal">ipsec</code> service after you finish the <code class="literal">nsspassword</code> file:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart ipsec</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">ipsec</code> service is running after you have added a non-empty password to its NSS database:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl status ipsec</strong></span>
● ipsec.service - Internet Key Exchange (IKE) Protocol Daemon for IPsec
   Loaded: loaded (/usr/lib/systemd/system/ipsec.service; enabled; vendor preset: disable&gt;
   Active: active (running)...</pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check that the <code class="literal">Journal</code> log contains entries that confirm a successful initialization:
					</p><pre class="screen"># <span class="strong strong"><strong>journalctl -u ipsec</strong></span>
...
pluto[6214]: Initializing NSS using read-write database "sql:/var/lib/ipsec/nss"
pluto[6214]: NSS Password from file "/etc/ipsec.d/nsspassword" for token "NSS Certificate DB" with length 20 passed to NSS
pluto[6214]: NSS crypto library initialized
...</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">certutil(1)</code> man page on your system
					</li><li class="listitem">
						FIPS 140-2 and FIPS 140-3 in the <a class="link" href="https://access.redhat.com/articles/2918071#fips-140-2-and-fips-140-3-2">Compliance Activities and Government Standards</a> Knowledgebase article.
					</li></ul></div></section><section class="section" id="proc_configuring-an-ipsec-vpn-to-use-tcp_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.10. Configuring an IPsec VPN to use TCP</h3></div></div></div><p class="_abstract _abstract">
				Libreswan supports TCP encapsulation of IKE and IPsec packets as described in RFC 8229. With this feature, you can establish IPsec VPNs on networks that prevent traffic transmitted via UDP and Encapsulating Security Payload (ESP). You can configure VPN servers and clients to use TCP either as a fallback or as the main VPN transport protocol. Because TCP encapsulation has bigger performance costs, use TCP as the main VPN protocol only if UDP is permanently blocked in your scenario.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A <a class="link" href="#configuring-a-remote-access-vpn_configuring-a-vpn-with-ipsec" title="5.6. Configuring a remote access VPN">remote-access VPN</a> is already configured.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the following option to the <code class="literal">/etc/ipsec.conf</code> file in the <code class="literal">config setup</code> section:
					</p><pre class="screen">listen-tcp=yes</pre></li><li class="listitem"><p class="simpara">
						To use TCP encapsulation as a fallback option when the first attempt over UDP fails, add the following two options to the client’s connection definition:
					</p><pre class="screen">enable-tcp=fallback
tcp-remoteport=4500</pre><p class="simpara">
						Alternatively, if you know that UDP is permanently blocked, use the following options in the client’s connection configuration:
					</p><pre class="screen">enable-tcp=yes
tcp-remoteport=4500</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://tools.ietf.org/html/rfc8229">IETF RFC 8229: TCP Encapsulation of IKE and IPsec Packets</a>
					</li></ul></div></section><section class="section" id="proc_configuring-automatic-detection-and-usage-of-esp-hardware-offload-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.11. Configuring automatic detection and usage of ESP hardware offload to accelerate an IPsec connection</h3></div></div></div><p>
				Offloading Encapsulating Security Payload (ESP) to the hardware accelerates IPsec connections over Ethernet. By default, Libreswan detects if hardware supports this feature and, as a result, enables ESP hardware offload. In case that the feature was disabled or explicitly enabled, you can switch back to automatic detection.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The network card supports ESP hardware offload.
					</li><li class="listitem">
						The network driver supports ESP hardware offload.
					</li><li class="listitem">
						The IPsec connection is configured and works.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Edit the Libreswan configuration file in the <code class="literal">/etc/ipsec.d/</code> directory of the connection that should use automatic detection of ESP hardware offload support.
					</li><li class="listitem">
						Ensure the <code class="literal">nic-offload</code> parameter is not set in the connection’s settings.
					</li><li class="listitem"><p class="simpara">
						If you removed <code class="literal">nic-offload</code>, restart the <code class="literal">ipsec</code> service:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl restart ipsec</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the <code class="literal">tx_ipsec</code> and <code class="literal">rx_ipsec</code> counters of the Ethernet device the IPsec connection uses:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ethtool -S <span class="emphasis"><em>enp1s0</em></span> | egrep "_ipsec"</strong></span>
     tx_ipsec: 10
     rx_ipsec: 10</pre></li><li class="listitem"><p class="simpara">
						Send traffic through the IPsec tunnel. For example, ping a remote IP address:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ping -c 5 <span class="emphasis"><em>remote_ip_address</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Display the <code class="literal">tx_ipsec</code> and <code class="literal">rx_ipsec</code> counters of the Ethernet device again:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ethtool -S <span class="emphasis"><em>enp1s0</em></span> | egrep "_ipsec"</strong></span>
     tx_ipsec: 15
     rx_ipsec: 15</pre><p class="simpara">
						If the counter values have increased, ESP hardware offload works.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#configuring-a-vpn-with-ipsec_securing-networks">Configuring a VPN with IPsec</a>
					</li></ul></div></section><section class="section" id="proc_configuring-esp-hardware-offload-on-a-bond-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.12. Configuring ESP hardware offload on a bond to accelerate an IPsec connection</h3></div></div></div><p class="_abstract _abstract">
				Offloading Encapsulating Security Payload (ESP) to the hardware accelerates IPsec connections. If you use a network bond for fail-over reasons, the requirements and the procedure to configure ESP hardware offload are different from those using a regular Ethernet device. For example, in this scenario, you enable the offload support on the bond, and the kernel applies the settings to the ports of the bond.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						All network cards in the bond support ESP hardware offload.
					</li><li class="listitem">
						The network driver supports ESP hardware offload on a bond device. In RHEL, only the <code class="literal">ixgbe</code> driver supports this feature.
					</li><li class="listitem">
						The bond is configured and works.
					</li><li class="listitem">
						The bond uses the <code class="literal">active-backup</code> mode. The bonding driver does not support any other modes for this feature.
					</li><li class="listitem">
						The IPsec connection is configured and works.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable ESP hardware offload support on the network bond:
					</p><pre class="screen"># <span class="strong strong"><strong>nmcli connection modify <span class="emphasis"><em>bond0</em></span> ethtool.feature-esp-hw-offload on</strong></span></pre><p class="simpara">
						This command enables ESP hardware offload support on the <code class="literal systemitem">bond0</code> connection.
					</p></li><li class="listitem"><p class="simpara">
						Reactivate the <code class="literal systemitem">bond0</code> connection:
					</p><pre class="screen"># <span class="strong strong"><strong>nmcli connection up <span class="emphasis"><em>bond0</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Edit the Libreswan configuration file in the <code class="literal">/etc/ipsec.d/</code> directory of the connection that should use ESP hardware offload, and append the <code class="literal">nic-offload=yes</code> statement to the connection entry:
					</p><pre class="screen">conn <span class="emphasis"><em>example</em></span>
    ...
    <span class="strong strong"><strong>nic-offload=yes</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">ipsec</code> service:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart ipsec</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the active port of the bond:
					</p><pre class="screen"># <span class="strong strong"><strong>grep "Currently Active Slave" /proc/net/bonding/<span class="emphasis"><em>bond0</em></span></strong></span>
Currently Active Slave: <span class="emphasis"><em>enp1s0</em></span></pre></li><li class="listitem"><p class="simpara">
						Display the <code class="literal">tx_ipsec</code> and <code class="literal">rx_ipsec</code> counters of the active port:
					</p><pre class="screen"># <span class="strong strong"><strong>ethtool -S <span class="emphasis"><em>enp1s0</em></span> | egrep "_ipsec"</strong></span>
     tx_ipsec: 10
     rx_ipsec: 10</pre></li><li class="listitem"><p class="simpara">
						Send traffic through the IPsec tunnel. For example, ping a remote IP address:
					</p><pre class="screen"># <span class="strong strong"><strong>ping -c 5 <span class="emphasis"><em>remote_ip_address</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Display the <code class="literal">tx_ipsec</code> and <code class="literal">rx_ipsec</code> counters of the active port again:
					</p><pre class="screen"># <span class="strong strong"><strong>ethtool -S enp1s0 | egrep "_ipsec"</strong></span>
     tx_ipsec: 15
     rx_ipsec: 15</pre><p class="simpara">
						If the counter values have increased, ESP hardware offload works.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_networking/configuring-network-bonding_configuring-and-managing-networking">Configuring a network bond</a>
					</li><li class="listitem">
						<a class="link" href="#configuring-a-vpn-with-ipsec_securing-networks">Configuring a VPN with IPsec</a>
					</li></ul></div></section><section class="section" id="assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.13. Configuring VPN connections with IPsec by using the RHEL system role</h3></div></div></div><p class="_abstract _abstract">
				With the <code class="literal">vpn</code> system role, you can configure VPN connections on RHEL systems by using Red Hat Ansible Automation Platform. You can use it to set up host-to-host, network-to-network, VPN Remote Access Server, and mesh configurations.
			</p><p>
				For host-to-host connections, the role sets up a VPN tunnel between each pair of hosts in the list of <code class="literal">vpn_connections</code> using the default parameters, including generating keys as needed. Alternatively, you can configure it to create an opportunistic mesh configuration between all hosts listed. The role assumes that the names of the hosts under <code class="literal">hosts</code> are the same as the names of the hosts used in the Ansible inventory, and that you can use those names to configure the tunnels.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal">vpn</code> RHEL system role currently supports only Libreswan, which is an IPsec implementation, as the VPN provider.
				</p></div></rh-alert><section class="section" id="proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role"><div class="titlepage"><div><div><h4 class="title">5.13.1. Creating a host-to-host VPN with IPsec by using the <code class="literal">vpn</code> RHEL system role</h4></div></div></div><p>
					You can use the <code class="literal">vpn</code> system role to configure host-to-host connections by running an Ansible playbook on the control node, which configures all managed nodes listed in an inventory file.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">- name: Host to host VPN
  hosts: managed-node-01.example.com, managed-node-02.example.com
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - hosts:
          managed-node-01.example.com:
          managed-node-02.example.com:
    vpn_manage_firewall: true
    vpn_manage_selinux: true</pre><p class="simpara">
							This playbook configures the connection <code class="literal">managed-node-01.example.com-to-managed-node-02.example.com</code> by using pre-shared key authentication with keys auto-generated by the system role. Because <code class="literal">vpn_manage_firewall</code> and <code class="literal">vpn_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">vpn</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">vpn</code> role.
						</p><p class="simpara">
							To configure connections from managed hosts to external hosts that are not listed in the inventory file, add the following section to the <code class="literal">vpn_connections</code> list of hosts:
						</p><pre class="programlisting language-yaml">    vpn_connections:
      - hosts:
          managed-node-01.example.com:
          <span class="strong strong"><strong><span class="emphasis"><em>&lt;external_node&gt;</em></span>:</strong></span>
            <span class="strong strong"><strong>hostname: <span class="emphasis"><em>&lt;IP_address_or_hostname&gt;</em></span></strong></span></pre><p class="simpara">
							This configures one additional connection: <code class="literal">managed-node-01.example.com-to-<span class="emphasis"><em>&lt;external_node&gt;</em></span></code>
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								The connections are configured only on the managed nodes and not on the external node.
							</p></div></rh-alert></li><li class="listitem"><p class="simpara">
							Optional: You can specify multiple VPN connections for the managed nodes by using additional sections within <code class="literal">vpn_connections</code>, for example, a control plane and a data plane:
						</p><pre class="programlisting language-yaml">- name: Multiple VPN
  hosts: managed-node-01.example.com, managed-node-02.example.com
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - name: control_plane_vpn
        hosts:
          managed-node-01.example.com:
            hostname: 192.0.2.0 # IP for the control plane
          managed-node-02.example.com:
            hostname: 192.0.2.1
      - name: data_plane_vpn
        hosts:
          managed-node-01.example.com:
            hostname: 10.0.0.1 # IP for the data plane
          managed-node-02.example.com:
            hostname: 10.0.0.2</pre></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							On the managed nodes, confirm that the connection is successfully loaded:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipsec status | grep <span class="emphasis"><em>&lt;connection_name&gt;</em></span></strong></span></pre><p class="simpara">
							Replace <code class="literal"><span class="emphasis"><em>&lt;connection_name&gt;</em></span></code> with the name of the connection from this node, for example <code class="literal">managed_node1-to-managed_node2</code>.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								By default, the role generates a descriptive name for each connection it creates from the perspective of each system. For example, when creating a connection between <code class="literal">managed_node1</code> and <code class="literal">managed_node2</code>, the descriptive name of this connection on <code class="literal">managed_node1</code> is <code class="literal">managed_node1-to-managed_node2</code> but on <code class="literal">managed_node2</code> the connection is named <code class="literal">managed_node2-to-managed_node1</code>.
							</p></div></rh-alert></li><li class="listitem"><p class="simpara">
							On the managed nodes, confirm that the connection is successfully started:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipsec trafficstatus | grep <span class="emphasis"><em>&lt;connection_name&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
							Optional: If a connection does not successfully load, manually add the connection by entering the following command. This provides more specific information indicating why the connection failed to establish:
						</p><pre class="literallayout"># <span class="strong strong"><strong>ipsec auto --add <span class="emphasis"><em>&lt;connection_name&gt;</em></span></strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								Any errors that may occur during the process of loading and starting the connection are reported in the <code class="literal">/var/log/pluto.log</code> file. Because these logs are hard to parse, manually add the connection to obtain log messages from the standard output instead.
							</p></div></rh-alert></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.vpn/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/vpn/</code> directory
						</li></ul></div></section><section class="section" id="proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role"><div class="titlepage"><div><div><h4 class="title">5.13.2. Creating an opportunistic mesh VPN connection with IPsec by using the <code class="literal">vpn</code> RHEL system role</h4></div></div></div><p>
					You can use the <code class="literal">vpn</code> system role to configure an opportunistic mesh VPN connection that uses certificates for authentication by running an Ansible playbook on the control node, which will configure all the managed nodes listed in an inventory file.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
						</li><li class="listitem">
							You are logged in to the control node as a user who can run playbooks on the managed nodes.
						</li><li class="listitem">
							The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
						</li><li class="listitem">
							The IPsec Network Security Services (NSS) crypto library in the <code class="literal">/etc/ipsec.d/</code> directory contains the necessary certificates.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">- name: <span class="emphasis"><em>Mesh VPN</em></span>
  hosts: managed-node-01.example.com, managed-node-02.example.com, managed-node-03.example.com
  roles:
    - rhel-system-roles.vpn
  vars:
    vpn_connections:
      - opportunistic: true
        auth_method: cert
        policies:
          - policy: private
            cidr: default
          - policy: private-or-clear
            cidr: 198.51.100.0/24
          - policy: private
            cidr: 192.0.2.0/24
          - policy: clear
            cidr: 192.0.2.7/32
    vpn_manage_firewall: true
    vpn_manage_selinux: true</pre><p class="simpara">
							Authentication with certificates is configured by defining the <code class="literal">auth_method: cert</code> parameter in the playbook. By default, the node name is used as the certificate nickname. In this example, this is <code class="literal">managed-node-01.example.com</code>. You can define different certificate names by using the <code class="literal">cert_name</code> attribute in your inventory.
						</p><p class="simpara">
							In this example procedure, the control node, which is the system from which you will run the Ansible playbook, shares the same classless inter-domain routing (CIDR) number as both of the managed nodes (192.0.2.0/24) and has the IP address 192.0.2.7. Therefore, the control node falls under the private policy which is automatically created for CIDR 192.0.2.0/24.
						</p><p class="simpara">
							To prevent SSH connection loss during the play, a clear policy for the control node is included in the list of policies. Note that there is also an item in the policies list where the CIDR is equal to default. This is because this playbook overrides the rule from the default policy to make it private instead of private-or-clear.
						</p><p class="simpara">
							Because <code class="literal">vpn_manage_firewall</code> and <code class="literal">vpn_manage_selinux</code> are both set to <code class="literal">true</code>, the <code class="literal">vpn</code> role uses the <code class="literal">firewall</code> and <code class="literal">selinux</code> roles to manage the ports used by the <code class="literal">vpn</code> role.
						</p></li><li class="listitem"><p class="simpara">
							Validate the playbook syntax:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
							Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
						</p></li><li class="listitem"><p class="simpara">
							Run the playbook:
						</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">/usr/share/ansible/roles/rhel-system-roles.vpn/README.md</code> file
						</li><li class="listitem">
							<code class="literal">/usr/share/doc/rhel-system-roles/vpn/</code> directory
						</li></ul></div></section></section><section class="section" id="configuring-ipsec-connections-that-opt-out-of-the-system-wide-crypto-policies_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.14. Configuring IPsec connections that opt out of the system-wide crypto policies</h3></div></div></div><div class="_abstract _abstract"><p class="title"><strong>Overriding system-wide crypto-policies for a connection</strong></p><p>
					The RHEL system-wide cryptographic policies create a special connection called <code class="literal">%default</code>. This connection contains the default values for the <code class="literal">ikev2</code>, <code class="literal">esp</code>, and <code class="literal">ike</code> options. However, you can override the default values by specifying the mentioned option in the connection configuration file.
				</p></div><p>
				For example, the following configuration allows connections that use IKEv1 with AES and SHA-1 or SHA-2, and IPsec (ESP) with either AES-GCM or AES-CBC:
			</p><pre class="screen">conn MyExample
  ...
  ikev2=never
  ike=aes-sha2,aes-sha1;modp2048
  esp=aes_gcm,aes-sha2,aes-sha1
  ...</pre><p>
				Note that AES-GCM is available for IPsec (ESP) and for IKEv2, but not for IKEv1.
			</p><div class="formalpara"><p class="title"><strong>Disabling system-wide crypto policies for all connections</strong></p><p>
					To disable system-wide crypto policies for all IPsec connections, comment out the following line in the <code class="literal">/etc/ipsec.conf</code> file:
				</p></div><pre class="screen">include /etc/crypto-policies/back-ends/libreswan.config</pre><p>
				Then add the <code class="literal">ikev2=never</code> option to your connection configuration file.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening">Using system-wide cryptographic policies</a>
					</li></ul></div></section><section class="section" id="ref_troubleshooting-ipsec-vpn-configurations_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.15. Troubleshooting IPsec VPN configurations</h3></div></div></div><p class="_abstract _abstract">
				Problems related to IPsec VPN configurations most commonly occur due to several main reasons. If you are encountering such problems, you can check if the cause of the problem corresponds to any of the following scenarios, and apply the corresponding solution.
			</p><div class="formalpara"><p class="title"><strong>Basic connection troubleshooting</strong></p><p>
					Most problems with VPN connections occur in new deployments, where administrators configured endpoints with mismatched configuration options. Also, a working configuration can suddenly stop working, often due to newly introduced incompatible values. This could be the result of an administrator changing the configuration. Alternatively, an administrator may have installed a firmware update or a package update with different default values for certain options, such as encryption algorithms.
				</p></div><p>
				To confirm that an IPsec VPN connection is established:
			</p><pre class="screen"># <span class="strong strong"><strong>ipsec trafficstatus</strong></span>
006 #8: "vpn.example.com"[1] 192.0.2.1, type=ESP, add_time=1595296930, inBytes=5999, outBytes=3231, id='@vpn.example.com', lease=100.64.13.5/32</pre><p>
				If the output is empty or does not show an entry with the connection name, the tunnel is broken.
			</p><p>
				To check that the problem is in the connection:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Reload the <span class="emphasis"><em>vpn.example.com</em></span> connection:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --add <span class="emphasis"><em>vpn.example.com</em></span></strong></span>
002 added connection description "vpn.example.com"</pre></li><li class="listitem"><p class="simpara">
						Next, initiate the VPN connection:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up <span class="emphasis"><em>vpn.example.com</em></span></strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Firewall-related problems</strong></p><p>
					The most common problem is that a firewall on one of the IPsec endpoints or on a router between the endpoints is dropping all Internet Key Exchange (IKE) packets.
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						For IKEv2, an output similar to the following example indicates a problem with a firewall:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up <span class="emphasis"><em>vpn.example.com</em></span></strong></span>
181 "vpn.example.com"[1] 192.0.2.2 #15: initiating IKEv2 IKE SA
181 "vpn.example.com"[1] 192.0.2.2 #15: STATE_PARENT_I1: sent v2I1, expected v2R1
010 "vpn.example.com"[1] 192.0.2.2 #15: STATE_PARENT_I1: retransmission; will wait 0.5 seconds for response
010 "vpn.example.com"[1] 192.0.2.2 #15: STATE_PARENT_I1: retransmission; will wait 1 seconds for response
010 "vpn.example.com"[1] 192.0.2.2 #15: STATE_PARENT_I1: retransmission; will wait 2 seconds for
...</pre></li><li class="listitem"><p class="simpara">
						For IKEv1, the output of the initiating command looks like:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up <span class="emphasis"><em>vpn.example.com</em></span></strong></span>
002 "vpn.example.com" #9: initiating Main Mode
102 "vpn.example.com" #9: STATE_MAIN_I1: sent MI1, expecting MR1
010 "vpn.example.com" #9: STATE_MAIN_I1: retransmission; will wait 0.5 seconds for response
010 "vpn.example.com" #9: STATE_MAIN_I1: retransmission; will wait 1 seconds for response
010 "vpn.example.com" #9: STATE_MAIN_I1: retransmission; will wait 2 seconds for response
...</pre></li></ul></div><p>
				Because the IKE protocol, which is used to set up IPsec, is encrypted, you can troubleshoot only a limited subset of problems using the <code class="literal">tcpdump</code> tool. If a firewall is dropping IKE or IPsec packets, you can try to find the cause using the <code class="literal">tcpdump</code> utility. However, <code class="literal">tcpdump</code> cannot diagnose other problems with IPsec VPN connections.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						To capture the negotiation of the VPN and all encrypted data on the <code class="literal">eth0</code> interface:
					</p><pre class="screen"># <span class="strong strong"><strong>tcpdump -i eth0 -n -n esp or udp port 500 or udp port 4500 or tcp port 4500</strong></span></pre></li></ul></div><div class="formalpara"><p class="title"><strong>Mismatched algorithms, protocols, and policies</strong></p><p>
					VPN connections require that the endpoints have matching IKE algorithms, IPsec algorithms, and IP address ranges. If a mismatch occurs, the connection fails. If you identify a mismatch by using one of the following methods, fix it by aligning algorithms, protocols, or policies.
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If the remote endpoint is not running IKE/IPsec, you can see an ICMP packet indicating it. For example:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up <span class="emphasis"><em>vpn.example.com</em></span></strong></span>
...
000 "vpn.example.com"[1] 192.0.2.2 #16: ERROR: asynchronous network error report on wlp2s0 (192.0.2.2:500), complainant 198.51.100.1: Connection refused [errno 111, origin ICMP type 3 code 3 (not authenticated)]
...</pre></li><li class="listitem"><p class="simpara">
						Example of mismatched IKE algorithms:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up vpn.example.com</strong></span>
...
003 "vpn.example.com"[1] 193.110.157.148 #3: dropping unexpected IKE_SA_INIT message containing NO_PROPOSAL_CHOSEN notification; message payloads: N; missing payloads: SA,KE,Ni</pre></li><li class="listitem"><p class="simpara">
						Example of mismatched IPsec algorithms:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up vpn.example.com</strong></span>
...
182 "vpn.example.com"[1] 193.110.157.148 #5: STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 cipher=AES_GCM_16_256 integ=n/a prf=HMAC_SHA2_256 group=MODP2048}
002 "vpn.example.com"[1] 193.110.157.148 #6: IKE_AUTH response contained the error notification NO_PROPOSAL_CHOSEN</pre><p class="simpara">
						A mismatched IKE version could also result in the remote endpoint dropping the request without a response. This looks identical to a firewall dropping all IKE packets.
					</p></li><li class="listitem"><p class="simpara">
						Example of mismatched IP address ranges for IKEv2 (called Traffic Selectors - TS):
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up vpn.example.com</strong></span>
...
1v2 "vpn.example.com" #1: STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 cipher=AES_GCM_16_256 integ=n/a prf=HMAC_SHA2_512 group=MODP2048}
002 "vpn.example.com" #2: IKE_AUTH response contained the error notification TS_UNACCEPTABLE</pre></li><li class="listitem"><p class="simpara">
						Example of mismatched IP address ranges for IKEv1:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up vpn.example.com</strong></span>
...
031 "vpn.example.com" #2: STATE_QUICK_I1: 60 second timeout exceeded after 0 retransmits.  No acceptable response to our first Quick Mode message: perhaps peer likes no proposal</pre></li><li class="listitem"><p class="simpara">
						When using PreSharedKeys (PSK) in IKEv1, if both sides do not put in the same PSK, the entire IKE message becomes unreadable:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up vpn.example.com</strong></span>
...
003 "vpn.example.com" #1: received Hash Payload does not match computed value
223 "vpn.example.com" #1: sending notification INVALID_HASH_INFORMATION to 192.0.2.23:500</pre></li><li class="listitem"><p class="simpara">
						In IKEv2, the mismatched-PSK error results in an AUTHENTICATION_FAILED message:
					</p><pre class="screen"># <span class="strong strong"><strong>ipsec auto --up vpn.example.com</strong></span>
...
002 "vpn.example.com" #1: IKE SA authentication request rejected by peer: AUTHENTICATION_FAILED</pre></li></ul></div><div class="formalpara"><p class="title"><strong>Maximum transmission unit</strong></p><p>
					Other than firewalls blocking IKE or IPsec packets, the most common cause of networking problems relates to an increased packet size of encrypted packets. Network hardware fragments packets larger than the maximum transmission unit (MTU), for example, 1500 bytes. Often, the fragments are lost and the packets fail to re-assemble. This leads to intermittent failures, when a ping test, which uses small-sized packets, works but other traffic fails. In this case, you can establish an SSH session but the terminal freezes as soon as you use it, for example, by entering the 'ls -al /usr' command on the remote host.
				</p></div><p>
				To work around the problem, reduce MTU size by adding the <code class="literal">mtu=1400</code> option to the tunnel configuration file.
			</p><p>
				Alternatively, for TCP connections, enable an iptables rule that changes the MSS value:
			</p><pre class="screen"># <span class="strong strong"><strong>iptables -I FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu</strong></span></pre><p>
				If the previous command does not solve the problem in your scenario, directly specify a lower size in the <code class="literal">set-mss</code> parameter:
			</p><pre class="screen"># <span class="strong strong"><strong>iptables -I FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --set-mss 1380</strong></span></pre><div class="formalpara"><p class="title"><strong>Network address translation (NAT)</strong></p><p>
					When an IPsec host also serves as a NAT router, it could accidentally remap packets. The following example configuration demonstrates the problem:
				</p></div><pre class="screen">conn myvpn
    left=172.16.0.1
    leftsubnet=10.0.2.0/24
    right=172.16.0.2
    rightsubnet=192.168.0.0/16
…</pre><p>
				The system with address 172.16.0.1 have a NAT rule:
			</p><pre class="screen">iptables -t nat -I POSTROUTING -o eth0 -j MASQUERADE</pre><p>
				If the system on address 10.0.2.33 sends a packet to 192.168.0.1, then the router translates the source 10.0.2.33 to 172.16.0.1 before it applies the IPsec encryption.
			</p><p>
				Then, the packet with the source address 10.0.2.33 no longer matches the <code class="literal">conn myvpn</code> configuration, and IPsec does not encrypt this packet.
			</p><p>
				To solve this problem, insert rules that exclude NAT for target IPsec subnet ranges on the router, in this example:
			</p><pre class="screen">iptables -t nat -I POSTROUTING -s 10.0.2.0/24 -d 192.168.0.0/16 -j RETURN</pre><div class="formalpara"><p class="title"><strong>Kernel IPsec subsystem bugs</strong></p><p>
					The kernel IPsec subsystem might fail, for example, when a bug causes a desynchronizing of the IKE user space and the IPsec kernel. To check for such problems:
				</p></div><pre class="screen">$ <span class="strong strong"><strong>cat /proc/net/xfrm_stat</strong></span>
XfrmInError                 0
XfrmInBufferError           0
...</pre><p>
				Any non-zero value in the output of the previous command indicates a problem. If you encounter this problem, open a new <a class="link" href="https://access.redhat.com/support">support case</a>, and attach the output of the previous command along with the corresponding IKE logs.
			</p><div class="formalpara"><p class="title"><strong>Libreswan logs</strong></p><p>
					Libreswan logs using the <code class="literal">syslog</code> protocol by default. You can use the <code class="literal">journalctl</code> command to find log entries related to IPsec. Because the corresponding entries to the log are sent by the <code class="literal">pluto</code> IKE daemon, search for the “pluto” keyword, for example:
				</p></div><pre class="screen">$ <span class="strong strong"><strong>journalctl -b | grep pluto</strong></span></pre><p>
				To show a live log for the <code class="literal">ipsec</code> service:
			</p><pre class="screen">$ <span class="strong strong"><strong>journalctl -f -u ipsec</strong></span></pre><p>
				If the default level of logging does not reveal your configuration problem, enable debug logs by adding the <code class="literal">plutodebug=all</code> option to the <code class="literal">config setup</code> section in the <code class="literal">/etc/ipsec.conf</code> file.
			</p><p>
				Note that debug logging produces a lot of entries, and it is possible that either the <code class="literal">journald</code> or <code class="literal">syslogd</code> service rate-limits the <code class="literal">syslog</code> messages. To ensure you have complete logs, redirect the logging to a file. Edit the <code class="literal">/etc/ipsec.conf</code>, and add the <code class="literal">logfile=/var/log/pluto.log</code> in the <code class="literal">config setup</code> section.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_basic_system_settings/assembly_troubleshooting-problems-using-log-files_configuring-basic-system-settings">Troubleshooting problems by using log files</a>
					</li><li class="listitem">
						<code class="literal">tcpdump(8)</code> and <code class="literal">ipsec.conf(5)</code> man pages.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters">Using and configuring firewalld</a>
					</li></ul></div></section><section class="section" id="configuring-a-VPN-connection-with-control-center_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.16. Configuring a VPN connection with control-center</h3></div></div></div><p class="_abstract _abstract">
				If you use Red Hat Enterprise Linux with a graphical interface, you can configure a VPN connection in the GNOME <code class="literal">control-center</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">NetworkManager-libreswan-gnome</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Press the <kbd class="keycap">Super</kbd> key, type <code class="literal">Settings</code>, and press <kbd class="keycap">Enter</kbd> to open the <code class="literal">control-center</code> application.
					</li><li class="listitem">
						Select the <code class="literal">Network</code> entry on the left.
					</li><li class="listitem">
						Click the <kbd class="keycap">+</kbd> icon.
					</li><li class="listitem">
						Select <code class="literal">VPN</code>.
					</li><li class="listitem"><p class="simpara">
						Select the <code class="literal">Identity</code> menu entry to see the basic configuration options:
					</p><p class="simpara">
						<span class="strong strong"><strong>General</strong></span>
					</p><p class="simpara">
						<code class="literal">Gateway</code> — The name or <code class="literal">IP</code> address of the remote VPN gateway.
					</p><p class="simpara">
						<span class="strong strong"><strong>Authentication</strong></span>
					</p><p class="simpara">
						<code class="literal">Type</code>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">IKEv2 (Certificate)</code>- client is authenticated by certificate. It is more secure (default).
							</li><li class="listitem"><p class="simpara">
								<code class="literal">IKEv1 (XAUTH)</code> - client is authenticated by user name and password, or a pre-shared key (PSK).
							</p><p class="simpara">
								The following configuration settings are available under the <code class="literal">Advanced</code> section:
							</p><div class="figure" id="figu-Advanced-options-of-a-VPN-connection"><p class="title"><strong>Figure 5.1. Advanced options of a VPN connection</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Securing_networks-en-US/images/8bbdb7fbdba750f4225e1c151d3db025/networking_vpn_advanced_options.png" alt="networking vpn advanced options"></div></div></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
									When configuring an IPsec-based VPN connection using the <code class="literal">gnome-control-center</code> application, the <code class="literal">Advanced</code> dialog displays the configuration, but it does not allow any changes. As a consequence, users cannot change any advanced IPsec options. Use the <code class="literal">nm-connection-editor</code> or <code class="literal">nmcli</code> tools instead to perform configuration of the advanced properties.
								</p></div></rh-alert><p class="simpara">
								<span class="strong strong"><strong>Identification</strong></span>
							</p></li><li class="listitem"><p class="simpara">
								<code class="literal">Domain</code> — If required, enter the Domain Name.
							</p><p class="simpara">
								<span class="strong strong"><strong>Security</strong></span>
							</p></li><li class="listitem">
								<code class="literal">Phase1 Algorithms</code> — corresponds to the <code class="literal">ike</code> Libreswan parameter — enter the algorithms to be used to authenticate and set up an encrypted channel.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">Phase2 Algorithms</code> — corresponds to the <code class="literal">esp</code> Libreswan parameter — enter the algorithms to be used for the <code class="literal">IPsec</code> negotiations.
							</p><p class="simpara">
								Check the <code class="literal">Disable PFS</code> field to turn off Perfect Forward Secrecy (PFS) to ensure compatibility with old servers that do not support PFS.
							</p></li><li class="listitem">
								<code class="literal">Phase1 Lifetime</code> — corresponds to the <code class="literal">ikelifetime</code> Libreswan parameter — how long the key used to encrypt the traffic will be valid.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">Phase2 Lifetime</code> — corresponds to the <code class="literal">salifetime</code> Libreswan parameter — how long a particular instance of a connection should last before expiring.
							</p><p class="simpara">
								Note that the encryption key should be changed from time to time for security reasons.
							</p></li><li class="listitem"><p class="simpara">
								<code class="literal">Remote network</code> — corresponds to the <code class="literal">rightsubnet</code> Libreswan parameter — the destination private remote network that should be reached through the VPN.
							</p><p class="simpara">
								Check the <code class="literal">narrowing</code> field to enable narrowing. Note that it is only effective in IKEv2 negotiation.
							</p></li><li class="listitem">
								<code class="literal">Enable fragmentation</code> — corresponds to the <code class="literal">fragmentation</code> Libreswan parameter — whether or not to allow IKE fragmentation. Valid values are <code class="literal">yes</code> (default) or <code class="literal">no</code>.
							</li><li class="listitem">
								<code class="literal">Enable Mobike</code> — corresponds to the <code class="literal">mobike</code> Libreswan parameter — whether to allow Mobility and Multihoming Protocol (MOBIKE, RFC 4555) to enable a connection to migrate its endpoint without needing to restart the connection from scratch. This is used on mobile devices that switch between wired, wireless, or mobile data connections. The values are <code class="literal">no</code> (default) or <code class="literal">yes</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Select the <span class="guibutton">IPv4</span> menu entry:
					</p><p class="simpara">
						<span class="strong strong"><strong>IPv4 Method</strong></span>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">Automatic (DHCP)</code> — Choose this option if the network you are connecting to uses a <code class="literal">DHCP</code> server to assign dynamic <code class="literal">IP</code> addresses.
							</li><li class="listitem">
								<code class="literal">Link-Local Only</code> — Choose this option if the network you are connecting to does not have a <code class="literal">DHCP</code> server and you do not want to assign <code class="literal">IP</code> addresses manually. Random addresses will be assigned as per <span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="http://www.rfc-editor.org/info/rfc3927">RFC 3927</a></span></em></span> with prefix <code class="literal">169.254/16</code>.
							</li><li class="listitem">
								<code class="literal">Manual</code> — Choose this option if you want to assign <code class="literal">IP</code> addresses manually.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">Disable</code> — <code class="literal">IPv4</code> is disabled for this connection.
							</p><p class="simpara">
								<span class="strong strong"><strong>DNS</strong></span>
							</p><p class="simpara">
								In the <code class="literal">DNS</code> section, when <code class="literal">Automatic</code> is <code class="literal">ON</code>, switch it to <code class="literal">OFF</code> to enter the IP address of a DNS server you want to use separating the IPs by comma.
							</p><p class="simpara">
								<span class="strong strong"><strong>Routes</strong></span>
							</p><p class="simpara">
								Note that in the <code class="literal">Routes</code> section, when <code class="literal">Automatic</code> is <code class="literal">ON</code>, routes from DHCP are used, but you can also add additional static routes. When <code class="literal">OFF</code>, only static routes are used.
							</p></li><li class="listitem">
								<code class="literal">Address</code> — Enter the <code class="literal">IP</code> address of a remote network or host.
							</li><li class="listitem">
								<code class="literal">Netmask</code> — The netmask or prefix length of the <code class="literal">IP</code> address entered above.
							</li><li class="listitem">
								<code class="literal">Gateway</code> — The <code class="literal">IP</code> address of the gateway leading to the remote network or host entered above.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">Metric</code> — A network cost, a preference value to give to this route. Lower values will be preferred over higher values.
							</p><p class="simpara">
								<span class="strong strong"><strong>Use this connection only for resources on its network</strong></span>
							</p><p class="simpara">
								Select this check box to prevent the connection from becoming the default route. Selecting this option means that only traffic specifically destined for routes learned automatically over the connection or entered here manually is routed over the connection.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						To configure <code class="literal">IPv6</code> settings in a <code class="literal">VPN</code> connection, select the <span class="guibutton">IPv6</span> menu entry:
					</p><p class="simpara">
						<span class="strong strong"><strong>IPv6 Method</strong></span>
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">Automatic</code> — Choose this option to use <code class="literal">IPv6</code> Stateless Address AutoConfiguration (SLAAC) to create an automatic, stateless configuration based on the hardware address and Router Advertisements (RA).
							</li><li class="listitem">
								<code class="literal">Automatic, DHCP only</code> — Choose this option to not use RA, but request information from <code class="literal">DHCPv6</code> directly to create a stateful configuration.
							</li><li class="listitem">
								<code class="literal">Link-Local Only</code> — Choose this option if the network you are connecting to does not have a <code class="literal">DHCP</code> server and you do not want to assign <code class="literal">IP</code> addresses manually. Random addresses will be assigned as per <span class="emphasis"><em><span class="citetitle citetitle"><a class="link" href="http://www.rfc-editor.org/info/rfc4862">RFC 4862</a></span></em></span> with prefix <code class="literal">FE80::0</code>.
							</li><li class="listitem">
								<code class="literal">Manual</code> — Choose this option if you want to assign <code class="literal">IP</code> addresses manually.
							</li><li class="listitem"><p class="simpara">
								<code class="literal">Disable</code> — <code class="literal">IPv6</code> is disabled for this connection.
							</p><p class="simpara">
								Note that <code class="literal">DNS</code>, <code class="literal">Routes</code>, <code class="literal">Use this connection only for resources on its network</code> are common to <code class="literal">IPv4</code> settings.
							</p></li></ul></div></li><li class="listitem">
						Once you have finished editing the <code class="literal">VPN</code> connection, click the <span class="guibutton">Add</span> button to customize the configuration or the <span class="guibutton">Apply</span> button to save it for the existing one.
					</li><li class="listitem">
						Switch the profile to <code class="literal">ON</code> to active the <code class="literal">VPN</code> connection.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">nm-settings-libreswan(5)</code>
					</li></ul></div></section><section class="section _abstract" id="configuring-a-vpn-connection-using-nm-connection-editor_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.17. Configuring a VPN connection using nm-connection-editor</h3></div></div></div><p>
				If you use Red Hat Enterprise Linux with a graphical interface, you can configure a VPN connection in the <code class="literal">nm-connection-editor</code> application.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">NetworkManager-libreswan-gnome</code> package is installed.
					</li><li class="listitem"><p class="simpara">
						If you configure an Internet Key Exchange version 2 (IKEv2) connection:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The certificate is imported into the IPsec network security services (NSS) database.
							</li><li class="listitem">
								The nickname of the certificate in the NSS database is known.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open a terminal, and enter:
					</p><pre class="screen">$ <span class="strong strong"><strong>nm-connection-editor</strong></span></pre></li><li class="listitem">
						Click the <span class="guibutton">+</span> button to add a new connection.
					</li><li class="listitem">
						Select the <code class="literal">IPsec based VPN</code> connection type, and click <span class="guibutton">Create</span>.
					</li><li class="listitem"><p class="simpara">
						On the <code class="literal">VPN</code> tab:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Enter the host name or IP address of the VPN gateway into the <code class="literal">Gateway</code> field, and select an authentication type. Based on the authentication type, you must enter different additional information:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										<code class="literal">IKEv2 (Certifiate)</code> authenticates the client by using a certificate, which is more secure. This setting requires the nickname of the certificate in the IPsec NSS database
									</li><li class="listitem"><p class="simpara">
										<code class="literal">IKEv1 (XAUTH)</code> authenticates the user by using a user name and password (pre-shared key). This setting requires that you enter the following values:
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												User name
											</li><li class="listitem">
												Password
											</li><li class="listitem">
												Group name
											</li><li class="listitem">
												Secret
											</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
								If the remote server specifies a local identifier for the IKE exchange, enter the exact string in the <code class="literal">Remote ID</code> field. In the remote server runs Libreswan, this value is set in the server’s <code class="literal">leftid</code> parameter.
							</p><p class="simpara">
								<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Securing_networks-en-US/images/dbd1201152429f3672224d2020f5ffab/nm-connection-editor-vpn-tab.png" alt="nm connection editor vpn tab"></span>

							</p></li><li class="listitem"><p class="simpara">
								Optional: Configure additional settings by clicking the <span class="guibutton">Advanced</span> button. You can configure the following settings:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
										Identification
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												<code class="literal">Domain</code> — If required, enter the domain name.
											</li></ul></div></li><li class="listitem"><p class="simpara">
										Security
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
												<code class="literal">Phase1 Algorithms</code> corresponds to the <code class="literal">ike</code> Libreswan parameter. Enter the algorithms to be used to authenticate and set up an encrypted channel.
											</li><li class="listitem"><p class="simpara">
												<code class="literal">Phase2 Algorithms</code> corresponds to the <code class="literal">esp</code> Libreswan parameter. Enter the algorithms to be used for the <code class="literal">IPsec</code> negotiations.
											</p><p class="simpara">
												Check the <code class="literal">Disable PFS</code> field to turn off Perfect Forward Secrecy (PFS) to ensure compatibility with old servers that do not support PFS.
											</p></li><li class="listitem">
												<code class="literal">Phase1 Lifetime</code> corresponds to the <code class="literal">ikelifetime</code> Libreswan parameter. This parameter defines how long the key used to encrypt the traffic is valid.
											</li><li class="listitem">
												<code class="literal">Phase2 Lifetime</code> corresponds to the <code class="literal">salifetime</code> Libreswan parameter. This parameter defines how long a security association is valid.
											</li></ul></div></li><li class="listitem"><p class="simpara">
										Connectivity
									</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
												<code class="literal">Remote network</code> corresponds to the <code class="literal">rightsubnet</code> Libreswan parameter and defines the destination private remote network that should be reached through the VPN.
											</p><p class="simpara">
												Check the <code class="literal">narrowing</code> field to enable narrowing. Note that it is only effective in the IKEv2 negotiation.
											</p></li><li class="listitem">
												<code class="literal">Enable fragmentation</code> corresponds to the <code class="literal">fragmentation</code> Libreswan parameter and defines whether or not to allow IKE fragmentation. Valid values are <code class="literal">yes</code> (default) or <code class="literal">no</code>.
											</li><li class="listitem">
												<code class="literal">Enable Mobike</code> corresponds to the <code class="literal">mobike</code> Libreswan parameter. The parameter defines whether to allow Mobility and Multihoming Protocol (MOBIKE) (RFC 4555) to enable a connection to migrate its endpoint without needing to restart the connection from scratch. This is used on mobile devices that switch between wired, wireless or mobile data connections. The values are <code class="literal">no</code> (default) or <code class="literal">yes</code>.
											</li></ul></div></li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">
						On the <code class="literal">IPv4 Settings</code> tab, select the IP assignment method and, optionally, set additional static addresses, DNS servers, search domains, and routes.
					</p><p class="simpara">
						<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Securing_networks-en-US/images/df41fd675600971c8b41909d6b8a522e/IPsec-IPv4-tab.png" alt="IPsec IPv4 tab"></span>

					</p></li><li class="listitem">
						Save the connection.
					</li><li class="listitem">
						Close <code class="literal">nm-connection-editor</code>.
					</li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					When you add a new connection by clicking the <span class="guibutton">+</span> button, <span class="strong strong"><strong>NetworkManager</strong></span> creates a new configuration file for that connection and then opens the same dialog that is used for editing an existing connection. The difference between these dialogs is that an existing connection profile has a <span class="strong strong"><strong>Details</strong></span> menu entry.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">nm-settings-libreswan(5)</code> man page on your system
					</li></ul></div></section><section class="section" id="configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.18. Configuring an IPsec based VPN connection by using nmstatectl</h3></div></div></div><p class="_abstract _abstract">
				IPsec (Internet Protocol Security) is a security protocol suite, provided by <code class="literal">Libreswan</code>, for implementation of VPN. IPsec includes protocols to initiate authentication at the time of connection establishment and manage keys during the data transfer. When an application deploys in a network and communicates by using the IP protocol, IPsec can protect data communication.
			</p><p>
				To manage an IPsec-based configuration for authenticating VPN connections, you can use the <code class="literal">nmstatectl</code> utility. This utility provides command line access to a declarative API for host network management. The following are the authentication types for the <code class="literal">host-to-subnet</code> and <code class="literal">host-to-host</code> communication modes:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Host-to-subnet PKI authentication
					</li><li class="listitem">
						Host-to-subnet RSA authentication
					</li><li class="listitem">
						Host-to-subnet PSK authentication
					</li><li class="listitem">
						Host-to-host tunnel mode authentication
					</li><li class="listitem">
						Host-to-host transport mode authentication
					</li></ul></div><section class="section" id="configuring-a-host-to-subnet-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl"><div class="titlepage"><div><div><h4 class="title">5.18.1. Configuring a host-to-subnet IPSec VPN with PKI authentication and tunnel mode by using nmstatectl</h4></div></div></div><p class="_abstract _abstract">
					If you want to use encryption based on the trusted entity authentication in IPsec, Public Key Infrastructure (PKI) provides secure communication by using cryptographic keys between two hosts. Both communicating hosts generate private and public keys where each host maintains a private key by sharing public key with the trusted entity Certificate Authority (CA). The CA generates a digital certificate after verifying the authenticity. In case of encryption and decryption, the host uses a private key for encryption and public key for decryption.
				</p><p>
					By using Nmstate, a declarative API for network management, you can configure a PKI authentication-based IPsec connection. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, <code class="literal">nmstate</code> automatically rolls back the changes to avoid an incorrect state of the system.
				</p><p>
					To establish encrypted communication in <code class="literal">host-to-subnet</code> configuration, remote IPsec end provides another IP to host by using parameter <code class="literal">dhcp: true</code>. In the case of defining systems for <code class="literal">IPsec</code> in nmstate, the <code class="literal">left</code>-named system is the local host while the <code class="literal">right</code>-named system is the remote host. The following procedure needs to run on both hosts.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							By using a password, you have generated a PKCS #12 file that stores certificates and cryptographic keys.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the required packages:
						</p><pre class="screen"># <span class="strong strong"><strong>dnf install nmstate libreswan NetworkManager-libreswan</strong></span></pre></li><li class="listitem"><p class="simpara">
							Restart the NetworkManager service:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart NetworkManager</strong></span></pre></li><li class="listitem"><p class="simpara">
							As <code class="literal">Libreswan</code> was already installed, remove its old database files and re-create them:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop ipsec</strong></span>
# <span class="strong strong"><strong>rm /etc/ipsec.d/*db</strong></span>
# <span class="strong strong"><strong>ipsec initnss</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enable and start the <code class="literal">ipsec</code> service:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now ipsec</strong></span></pre></li><li class="listitem"><p class="simpara">
							Import the PKCS#12 file:
						</p><pre class="screen"># <span class="strong strong"><strong>ipsec import node-example.p12</strong></span></pre><p class="simpara">
							When importing the PKCS#12 file, enter the password that was used to create the file.
						</p></li><li class="listitem"><p class="simpara">
							Create a YAML file, for example <code class="literal">~/create-pki-authentication.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
interfaces:
- name: 'example_ipsec_conn1'            <span id="CO2-1"><!--Empty--></span><span class="callout">1</span>
  type: ipsec
  ipv4:
    enabled: true
    dhcp: true
  libreswan:
    ipsec-interface: 'yes'               <span id="CO2-2"><!--Empty--></span><span class="callout">2</span>
    left: '192.0.2.250'                  <span id="CO2-3"><!--Empty--></span><span class="callout">3</span>
    leftid: '%fromcert'                  <span id="CO2-4"><!--Empty--></span><span class="callout">4</span>
    leftcert: 'local-host.example.com'   <span id="CO2-5"><!--Empty--></span><span class="callout">5</span>
    right: '192.0.2.150'                 <span id="CO2-6"><!--Empty--></span><span class="callout">6</span>
    rightid: '%fromcert'                 <span id="CO2-7"><!--Empty--></span><span class="callout">7</span>
    ikev2: 'insist'                      <span id="CO2-8"><!--Empty--></span><span class="callout">8</span>
    ikelifetime: '24h'                   <span id="CO2-9"><!--Empty--></span><span class="callout">9</span>
    salifetime: '24h'                    <span id="CO2-10"><!--Empty--></span><span class="callout">10</span></pre><p class="simpara">
							The YAML file defines the following settings:
						</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO2-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									An IPsec connection name
								</div></dd><dt><a href="#CO2-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									The value <code class="literal">yes</code> means <code class="literal">libreswan</code> creates an IPsec <code class="literal">xfrm</code> virtual interface <code class="literal">ipsec&lt;number&gt;</code> and automatically finds the next available number
								</div></dd><dt><a href="#CO2-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface for a local host
								</div></dd><dt><a href="#CO2-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									On a local host, the value of <code class="literal">%fromcert</code> sets the ID to a Distinguished Name (DN) that is fetched from a loaded certificate
								</div></dd><dt><a href="#CO2-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									A Distinguished Name (DN) of a local host’s public key
								</div></dd><dt><a href="#CO2-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface for a remote host
								</div></dd><dt><a href="#CO2-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									On a remote host, the value of <code class="literal">%fromcert</code> sets the ID to a Distinguished Name (DN) that is fetched from a loaded certificate.
								</div></dd><dt><a href="#CO2-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									<code class="literal">insist</code> value accepts and receives only the Internet Key Exchange (IKEv2) protocol
								</div></dd><dt><a href="#CO2-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									The duration of IKE protocol
								</div></dd><dt><a href="#CO2-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									The duration of IPsec security association (SA)
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply settings to the system:
						</p><pre class="screen"># <span class="strong strong"><strong>nmstatectl apply ~/create-pki-authentication.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify IPsec status:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm status</strong></span></pre></li><li class="listitem"><p class="simpara">
							Verify IPsec policies:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm policy</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">ipsec.conf(5)</code> man page on your system
						</li></ul></div></section><section class="section" id="configuring-a-host-to-subnet-ipsec-vpn-with-rsa-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl"><div class="titlepage"><div><div><h4 class="title">5.18.2. Configuring a host-to-subnet IPSec VPN with RSA authentication and tunnel mode by using nmstatectl</h4></div></div></div><p>
					If you want to use asymmetric cryptography-based key authentication in IPsec, the RSA algorithm provides secure communication by using either of private and public keys for encryption and decryption between two hosts. This method uses a private key for encryption, and a public key for decryption.
				</p><p>
					By using Nmstate, a declarative API for network management, you can configure RSA-based IPsec authentication. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, <code class="literal">nmstate</code> automatically rolls back the changes to avoid an incorrect state of the system.
				</p><p>
					To establish encrypted communication in <code class="literal">host-to-subnet</code> configuration, remote IPsec end provides another IP to host by using parameter <code class="literal">dhcp: true</code>. In the case of defining systems for <code class="literal">IPsec</code> in nmstate, the <code class="literal">left</code>-named system is the local host while the <code class="literal">right</code>-named system is the remote host. The following procedure needs to run on both hosts.
				</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the required packages:
						</p><pre class="screen"># <span class="strong strong"><strong>dnf install nmstate libreswan NetworkManager-libreswan</strong></span></pre></li><li class="listitem"><p class="simpara">
							Restart the NetworkManager service:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart NetworkManager</strong></span></pre></li><li class="listitem"><p class="simpara">
							If <code class="literal">Libreswan</code> was already installed, remove its old database files and re-create them:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop ipsec</strong></span>
# <span class="strong strong"><strong>rm /etc/ipsec.d/*db</strong></span>
# <span class="strong strong"><strong>ipsec initnss</strong></span></pre></li><li class="listitem"><p class="simpara">
							Generate a RSA key pair on each host:
						</p><pre class="screen"># <span class="strong strong"><strong>ipsec newhostkey --output</strong></span></pre></li><li class="listitem"><p class="simpara">
							Display the public keys:
						</p><pre class="screen"># <span class="strong strong"><strong>ipsec showhostkey --list</strong></span></pre></li><li class="listitem"><p class="simpara">
							The previous step returned the generated key <code class="literal">ckaid</code>. Use that <code class="literal">ckaid</code> with the following command on left, for example:
						</p><pre class="screen"># <span class="strong strong"><strong>ipsec showhostkey --left --ckaid <span class="emphasis"><em>&lt;0sAwEAAesFfVZqFzRA9F&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
							The output of the previous command generated the <code class="literal">leftrsasigkey=</code> line required for the configuration. Do the same on the second host (right):
						</p><pre class="screen"># <span class="strong strong"><strong>ipsec showhostkey --right --ckaid <span class="emphasis"><em>&lt;0sAwEAAesFfVZqFzRA9E&gt;</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
							Enable the <code class="literal">ipsec</code> service to automatically start it on boot:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now ipsec</strong></span></pre></li><li class="listitem"><p class="simpara">
							Create a YAML file, for example <code class="literal">~/create-rsa-authentication.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
interfaces:
- name: 'example_ipsec_conn1'               <span id="CO3-1"><!--Empty--></span><span class="callout">1</span>
  type: ipsec                               <span id="CO3-2"><!--Empty--></span><span class="callout">2</span>
  ipv4:
    enabled: true
    dhcp: true
  libreswan:
    ipsec-interface: '99'                   <span id="CO3-3"><!--Empty--></span><span class="callout">3</span>
    leftrsasigkey: '0sAwEAAesFfVZqFzRA9F'   <span id="CO3-4"><!--Empty--></span><span class="callout">4</span>
    left: '192.0.2.250'                     <span id="CO3-5"><!--Empty--></span><span class="callout">5</span>
    leftid: 'local-host-rsa.example.com'    <span id="CO3-6"><!--Empty--></span><span class="callout">6</span>
    right: '192.0.2.150'                    <span id="CO3-7"><!--Empty--></span><span class="callout">7</span>
    rightrsasigkey: '0sAwEAAesFfVZqFzRA9E'  <span id="CO3-8"><!--Empty--></span><span class="callout">8</span>
    rightid: 'remote-host-rsa.example.com'  <span id="CO3-9"><!--Empty--></span><span class="callout">9</span>
    ikev2: 'insist'                         <span id="CO3-10"><!--Empty--></span><span class="callout">10</span></pre><p class="simpara">
							The YAML file defines the following settings:
						</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO3-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									An IPsec connection name
								</div></dd><dt><a href="#CO3-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									An interface name
								</div></dd><dt><a href="#CO3-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									The value <code class="literal">99</code> means that <code class="literal">libreswan</code> creates an IPsec <code class="literal">xfrm</code> virtual interface <code class="literal">ipsec&lt;number&gt;</code> and automatically finds the next available number
								</div></dd><dt><a href="#CO3-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									The RSA public key of a local host
								</div></dd><dt><a href="#CO3-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface of a local host
								</div></dd><dt><a href="#CO3-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									A Distinguished Name (DN) for a local host
								</div></dd><dt><a href="#CO3-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									The RSA public key of a remote host
								</div></dd><dt><a href="#CO3-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface of a remote host
								</div></dd><dt><a href="#CO3-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									A Distinguished Name(DN) for a remote host
								</div></dd><dt><a href="#CO3-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									<code class="literal">insist</code> value accepts and receives only the Internet Key Exchange (IKEv2) protocol
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply the settings to the system:
						</p><pre class="screen"># <span class="strong strong"><strong>nmstatectl apply ~/create-rsa-authentication.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Display the IP settings of the network interface:
						</p><pre class="screen"># <span class="strong strong"><strong>ip addr show example_ipsec_conn1</strong></span></pre></li><li class="listitem"><p class="simpara">
							Verify IPsec status:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm status</strong></span></pre></li><li class="listitem"><p class="simpara">
							Verify IPsec policies:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm policy</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">ipsec.conf(5)</code> man page on your system
						</li></ul></div></section><section class="section" id="configuring-a-host-to-subnet-ipsec-vpn-with-psk-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl"><div class="titlepage"><div><div><h4 class="title">5.18.3. Configuring a host-to-subnet IPSec VPN with PSK authentication and tunnel mode by using nmstatectl</h4></div></div></div><p>
					If you want to use encryption based on mutual authentication in IPsec, the Pre-Shared Key (PSK) method provides secure communication by using a secret key between two hosts. A file stores the secret key and the same key encrypts the data flowing through the tunnel.
				</p><p>
					By using Nmstate, a declarative API for network management, you can configure PSK-based IPsec authentication. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, <code class="literal">nmstate</code> automatically rolls back the changes to avoid incorrect state of the system.
				</p><p>
					To establish encrypted communication in <code class="literal">host-to-subnet</code> configuration, remote IPsec end provides another IP to host by using parameter <code class="literal">dhcp: true</code>. In the case of defining systems for <code class="literal">IPsec</code> in nmstate, the <code class="literal">left</code>-named system is the local host while the <code class="literal">right</code>-named system is the remote host. The following procedure needs to run on both hosts.
				</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
						As this method uses static strings for authentication and encryption, use it only for testing/development purposes.
					</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the required packages:
						</p><pre class="screen"># <span class="strong strong"><strong>dnf install nmstate libreswan NetworkManager-libreswan</strong></span></pre></li><li class="listitem"><p class="simpara">
							Restart the NetworkManager service:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart NetworkManager</strong></span></pre></li><li class="listitem"><p class="simpara">
							If <code class="literal">Libreswan</code> was already installed, remove its old database files and re-create them:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop ipsec</strong></span>
# <span class="strong strong"><strong>rm /etc/ipsec.d/*db</strong></span>
# <span class="strong strong"><strong>ipsec initnss</strong></span></pre></li><li class="listitem"><p class="simpara">
							Enable the <code class="literal">ipsec</code> service to automatically start it on boot:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now ipsec</strong></span></pre></li><li class="listitem"><p class="simpara">
							Create a YAML file, for example <code class="literal">~/create-pks-authentication.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
interfaces:
- name: 'example_ipsec_conn1'           <span id="CO4-1"><!--Empty--></span><span class="callout">1</span>
  type: ipsec
  ipv4:
    enabled: true
    dhcp: true
  libreswan:
    ipsec-interface: 'no'               <span id="CO4-2"><!--Empty--></span><span class="callout">2</span>
    right: '192.0.2.250'                <span id="CO4-3"><!--Empty--></span><span class="callout">3</span>
    rightid: 'remote-host.example.org'  <span id="CO4-4"><!--Empty--></span><span class="callout">4</span>
    left: '192.0.2.150'                 <span id="CO4-5"><!--Empty--></span><span class="callout">5</span>
    leftid: 'local-host.example.org'    <span id="CO4-6"><!--Empty--></span><span class="callout">6</span>
    psk: "example_password"
    ikev2: 'insist'                     <span id="CO4-7"><!--Empty--></span><span class="callout">7</span></pre><p class="simpara">
							The YAML file defines the following settings:
						</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO4-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									An IPsec connection name
								</div></dd><dt><a href="#CO4-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									Setting <code class="literal">no</code> value indicates that <code class="literal">libreswan</code> creates only <code class="literal">xfrm</code> policies, and not a virtual <code class="literal">xfrm</code> interface
								</div></dd><dt><a href="#CO4-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface of a remote host
								</div></dd><dt><a href="#CO4-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									A Distinguished Name (DN) for a remote host
								</div></dd><dt><a href="#CO4-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface of a local host
								</div></dd><dt><a href="#CO4-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									A Distinguished Name (DN) for a local host
								</div></dd><dt><a href="#CO4-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									<code class="literal">insist</code> value accepts and receives only the Internet Key Exchange (IKEv2) protocol
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply the settings to the system:
						</p><pre class="screen"># <span class="strong strong"><strong>nmstatectl apply ~/create-pks-authentication.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Display the IP settings of network interface:
						</p><pre class="screen"># <span class="strong strong"><strong>ip addr show example_ipsec_conn1</strong></span></pre></li><li class="listitem"><p class="simpara">
							Verify IPsec status:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm status</strong></span></pre></li><li class="listitem"><p class="simpara">
							Verify IPsec policies:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm policy</strong></span></pre></li></ol></div></section><section class="section" id="configuring-a-host-to-host-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl"><div class="titlepage"><div><div><h4 class="title">5.18.4. Configuring a host-to-host IPsec VPN with PKI authentication and tunnel mode by using nmstatectl</h4></div></div></div><p class="_abstract _abstract">
					IPsec (Internet Protocol Security) is a security protocol suite to authenticate and encrypt IP communications within networks and devices. The <code class="literal">Libreswan</code> software provides an IPsec implementation for VPNs.
				</p><p>
					In tunnel mode, the source and destination IP address of communication is encrypted in the IPsec tunnel. External network sniffers can only get left IP and right IP. In general, for tunnel mode, it supports <code class="literal">host-to-host</code>, <code class="literal">host-to-subnet</code>, and <code class="literal">subnet-to-subnet</code>. In this mode, a new IP packet encapsulates an existing packet along with its payload and header. Encapsulation in this mode protects IP data, source, and destination headers over an unsecure network. This mode is useful to transfer data in <code class="literal">subnet-to-subnet</code>, remote access connections, and untrusted networks, such as open public Wi-Fi networks. By default, IPsec establishes a secure channel between two sites in tunnel mode. With the following configuration, you can establish a VPN connection as a <code class="literal">host-to-host</code> architecture.
				</p><p>
					By using Nmstate, a declarative API for network management, you can configure an IPsec VPN connection. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, <code class="literal">nmstate</code> automatically rolls back the changes to avoid incorrect state of the system.
				</p><p>
					In <code class="literal">host-to-host</code> configuration, you need to set <code class="literal">leftmodecfgclient: no</code> so that it can’t receive network configuration from the server, hence the value <code class="literal">no</code>. In the case of defining systems for <code class="literal">IPsec</code> in nmstate, the <code class="literal">left</code>-named system is the local host while the <code class="literal">right</code>-named system is the remote host. The following procedure needs to run on both hosts.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							By using a password, you have generated a PKCS #12 file that stores certificates and cryptographic keys.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the required packages:
						</p><pre class="screen"># <span class="strong strong"><strong>dnf install nmstate libreswan NetworkManager-libreswan</strong></span></pre></li><li class="listitem"><p class="simpara">
							Restart the NetworkManager service:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart NetworkManager</strong></span></pre></li><li class="listitem"><p class="simpara">
							As <code class="literal">Libreswan</code> was already installed, remove its old database files and re-create them:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop ipsec</strong></span>
# <span class="strong strong"><strong>rm /etc/ipsec.d/*db</strong></span>
# <span class="strong strong"><strong>ipsec initnss</strong></span></pre></li><li class="listitem"><p class="simpara">
							Import the PKCS#12 file:
						</p><pre class="screen"># <span class="strong strong"><strong>ipsec import node-example.p12</strong></span></pre><p class="simpara">
							When importing the PKCS#12 file, enter the password that was used to generate the file.
						</p></li><li class="listitem"><p class="simpara">
							Enable and start the <code class="literal">ipsec</code> service:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now ipsec</strong></span></pre></li><li class="listitem"><p class="simpara">
							Create a YAML file, for example <code class="literal">~/create-p2p-vpn-authentication.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
interfaces:
- name: 'example_ipsec_conn1'             <span id="CO5-1"><!--Empty--></span><span class="callout">1</span>
  type: ipsec
  libreswan:
    left: '192.0.2.250'                   <span id="CO5-2"><!--Empty--></span><span class="callout">2</span>
    leftid:  'local-host.example.com'     <span id="CO5-3"><!--Empty--></span><span class="callout">3</span>
    leftcert: 'local-host.example.com'    <span id="CO5-4"><!--Empty--></span><span class="callout">4</span>
    leftmodecfgclient: 'no'               <span id="CO5-5"><!--Empty--></span><span class="callout">5</span>
    right: '192.0.2.150'                  <span id="CO5-6"><!--Empty--></span><span class="callout">6</span>
    rightid: 'remote-host.example.com'    <span id="CO5-7"><!--Empty--></span><span class="callout">7</span>
    rightsubnet: '192.0.2.150/32'         <span id="CO5-8"><!--Empty--></span><span class="callout">8</span>
    ikev2: 'insist'                       <span id="CO5-9"><!--Empty--></span><span class="callout">9</span></pre><p class="simpara">
							The YAML file defines the following settings:
						</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO5-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									An IPsec connection name
								</div></dd><dt><a href="#CO5-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface for a local host
								</div></dd><dt><a href="#CO5-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									A distinguished Name (DN) of a local host
								</div></dd><dt><a href="#CO5-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									A certificate name installed on a local host
								</div></dd><dt><a href="#CO5-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									The value for not to retrieve client configuration from a remote host
								</div></dd><dt><a href="#CO5-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface for a remote host
								</div></dd><dt><a href="#CO5-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									A distinguished Name (DN) of a remote host
								</div></dd><dt><a href="#CO5-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									The subnet range of a remote host - <code class="literal">192.0.2.150</code> with <code class="literal">32</code> IPv4 addresses
								</div></dd><dt><a href="#CO5-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									The value to accept and receive only the Internet Key Exchange (IKEv2) protocol
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply the settings to the system:
						</p><pre class="screen"># <span class="strong strong"><strong>nmstatectl apply ~/create-p2p-vpn-authentication.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Display the created P2P policy:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm policy</strong></span></pre></li><li class="listitem"><p class="simpara">
							Verify IPsec status:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm status</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">ipsec.conf(5)</code> man page on your system
						</li></ul></div></section><section class="section" id="configuring-a-host-to-host-ipsec-vpn-with-psk-authentication-and-transport-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl"><div class="titlepage"><div><div><h4 class="title">5.18.5. Configuring a host-to-host IPsec VPN with PSK authentication and transport mode by using nmstatectl</h4></div></div></div><p class="_abstract _abstract">
					IPsec (Internet Protocol Security) is a security protocol suite to authenticate and encrypt IP communications within networks and devices. The <code class="literal">Libreswan</code> utility provides IPsec based implementation for VPN.
				</p><p>
					In transport mode, encryption works only for the payload of an IP packet. Also, a new IPsec header gets appended to the IP packet by keeping the original IP header as it is. Transport mode does not encrypt the source and destination IP of communication but copies them to an external IP header. Hence, encryption protects only IP data across the network. This mode is useful to transfer data in a <code class="literal">host-to-host</code> connection of a network. This mode is often used along with the GRE tunnel to save 20 bytes (IP header) of overheads. By default, the <code class="literal">IPsec</code> utility uses tunnel mode. To use transfer mode, set <code class="literal">type: transport</code> for <code class="literal">host-to-host</code> connection data transfer.
				</p><p>
					By using Nmstate, a declarative API for network management, you can configure an IPsec VPN connection. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, <code class="literal">nmstate</code> automatically rolls back the changes to avoid incorrect state of the system. To override the default <code class="literal">tunnel</code> mode, specify <code class="literal">transport</code> mode.
				</p><p>
					In the case of defining systems for <code class="literal">IPsec</code> in nmstate, the <code class="literal">left</code>-named system is the local host while the <code class="literal">right</code>-named system is the remote host. The following procedure needs to run on both hosts.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							By using a password, you have generated a PKCS #12 file that stores certificates and cryptographic keys.
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Install the required packages:
						</p><pre class="screen"># <span class="strong strong"><strong>dnf install nmstate libreswan NetworkManager-libreswan</strong></span></pre></li><li class="listitem"><p class="simpara">
							Restart the NetworkManager service:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart NetworkManager</strong></span></pre></li><li class="listitem"><p class="simpara">
							As <code class="literal">Libreswan</code> was already installed, remove its old database files and re-create them:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl stop ipsec</strong></span>
# <span class="strong strong"><strong>rm /etc/ipsec.d/*db</strong></span>
# <span class="strong strong"><strong>ipsec initnss</strong></span></pre></li><li class="listitem"><p class="simpara">
							Import the PKCS#12 file:
						</p><pre class="screen"># <span class="strong strong"><strong>ipsec import node-example.p12</strong></span></pre><p class="simpara">
							When importing the PKCS#12 file, enter the password that was used to create the file.
						</p></li><li class="listitem"><p class="simpara">
							Enable and start the <code class="literal">ipsec</code> service:
						</p><pre class="screen"># <span class="strong strong"><strong>systemctl enable --now ipsec</strong></span></pre></li><li class="listitem"><p class="simpara">
							Create a YAML file, for example <code class="literal">~/create-p2p-transport-authentication.yml</code>, with the following content:
						</p><pre class="programlisting language-yaml">---
interfaces:
- name: 'example_ipsec_conn1'           <span id="CO6-1"><!--Empty--></span><span class="callout">1</span>
  type: ipsec
  libreswan:
    type: 'transport'                   <span id="CO6-2"><!--Empty--></span><span class="callout">2</span>
    ipsec-interface: '99'               <span id="CO6-3"><!--Empty--></span><span class="callout">3</span>
    left: '192.0.2.250'                 <span id="CO6-4"><!--Empty--></span><span class="callout">4</span>
    leftid: '%fromcert'                 <span id="CO6-5"><!--Empty--></span><span class="callout">5</span>
    leftcert: 'local-host.example.org'  <span id="CO6-6"><!--Empty--></span><span class="callout">6</span>
    right: '192.0.2.150'                <span id="CO6-7"><!--Empty--></span><span class="callout">7</span>
    prefix-length: '32'                 <span id="CO6-8"><!--Empty--></span><span class="callout">8</span>
    rightid: '%fromcert'                <span id="CO6-9"><!--Empty--></span><span class="callout">9</span>
    ikev2: 'insist'                     <span id="CO6-10"><!--Empty--></span><span class="callout">10</span>
    ikelifetime: '24h'                  <span id="CO6-11"><!--Empty--></span><span class="callout">11</span>
    salifetime: '24h'                   <span id="CO6-12"><!--Empty--></span><span class="callout">12</span></pre><p class="simpara">
							The YAML file defines the following settings:
						</p><div class="calloutlist"><dl class="calloutlist"><dt><a href="#CO6-1"><span class="callout">1</span></a> </dt><dd><div class="para">
									An IPsec connection name
								</div></dd><dt><a href="#CO6-2"><span class="callout">2</span></a> </dt><dd><div class="para">
									An IPsec mode
								</div></dd><dt><a href="#CO6-3"><span class="callout">3</span></a> </dt><dd><div class="para">
									The value <code class="literal">99</code> means that <code class="literal">libreswan</code> creates an IPsec <code class="literal">xfrm</code> virtual interface <code class="literal">ipsec&lt;number&gt;</code> and automatically finds the next available number
								</div></dd><dt><a href="#CO6-4"><span class="callout">4</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface for a local host
								</div></dd><dt><a href="#CO6-5"><span class="callout">5</span></a> </dt><dd><div class="para">
									On a local host, the value of <code class="literal">%fromcert</code> sets the ID to a Distinguished Name (DN) which is fetched from a loaded certificate
								</div></dd><dt><a href="#CO6-6"><span class="callout">6</span></a> </dt><dd><div class="para">
									A Distinguished Name (DN) of a local host’s public key
								</div></dd><dt><a href="#CO6-7"><span class="callout">7</span></a> </dt><dd><div class="para">
									A static IPv4 address of public network interface for a remote host
								</div></dd><dt><a href="#CO6-8"><span class="callout">8</span></a> </dt><dd><div class="para">
									The subnet mask of a static IPv4 address of a local host
								</div></dd><dt><a href="#CO6-9"><span class="callout">9</span></a> </dt><dd><div class="para">
									On a remote host, the value of <code class="literal">%fromcert</code> sets the ID to a Distinguished Name (DN) which is fetched from a loaded certificate
								</div></dd><dt><a href="#CO6-10"><span class="callout">10</span></a> </dt><dd><div class="para">
									The value to accept and receive only the Internet Key Exchange (IKEv2) protocol
								</div></dd><dt><a href="#CO6-11"><span class="callout">11</span></a> </dt><dd><div class="para">
									The duration of IKE protocol
								</div></dd><dt><a href="#CO6-12"><span class="callout">12</span></a> </dt><dd><div class="para">
									The duration of IPsec security association (SA)
								</div></dd></dl></div></li><li class="listitem"><p class="simpara">
							Apply the settings to the system:
						</p><pre class="screen"># <span class="strong strong"><strong>nmstatectl apply ~/create-p2p-transport-authentication.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Verify IPsec status:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm status</strong></span></pre></li><li class="listitem"><p class="simpara">
							Verify IPsec policies:
						</p><pre class="screen"># <span class="strong strong"><strong>ip xfrm policy</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<code class="literal">ipsec.conf(5)</code> man page on your system
						</li></ul></div></section></section><section class="section _additional-resources" id="related-information-configuring-a-vpn-with-ipsec"><div class="titlepage"><div><div><h3 class="title">5.19. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">ipsec(8)</code>, <code class="literal">ipsec.conf(5)</code>, <code class="literal">ipsec.secrets(5)</code>, <code class="literal">ipsec_auto(8)</code>, and <code class="literal">ipsec_rsasigkey(8)</code> man pages.
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/libreswan-<span class="emphasis"><em>version</em></span>/</code> directory.
					</li><li class="listitem">
						<a class="link" href="https://libreswan.org/wiki">The Libreswan Project Wiki</a>.
					</li><li class="listitem">
						<a class="link" href="https://libreswan.org/man/">All Libreswan man pages</a>.
					</li><li class="listitem">
						<a class="link" href="https://doi.org/10.6028/NIST.SP.800-77r1">NIST Special Publication 800-77: Guide to IPsec VPNs</a>.
					</li></ul></div></section></section><section class="chapter" id="securing-network-services_securing-networks"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Securing network services</h2></div></div></div><p>
			Red Hat Enterprise Linux 9 supports many different types of network servers. Their network services can expose the system security to risks of various types of attacks, such as denial of service attacks (DoS), distributed denial of service attacks (DDoS), script vulnerability attacks, and buffer overflow attacks.
		</p><p>
			To increase the system security against attacks, it is important to monitor active network services that you use. For example, when a network service is running on a machine, its daemon listens for connections on network ports, and this can reduce the security. To limit exposure to attacks over the network, all services that are unused should be turned off.
		</p><section class="section" id="securing-the-rpcbind-service_securing-network-services"><div class="titlepage"><div><div><h3 class="title">6.1. Securing the rpcbind service</h3></div></div></div><p>
				The <code class="literal">rpcbind</code> service is a dynamic port-assignment daemon for remote procedure calls (RPC) services such as Network Information Service (NIS) and Network File System (NFS). Because it has weak authentication mechanisms and can assign a wide range of ports for the services it controls, it is important to secure <code class="literal">rpcbind</code>.
			</p><p>
				You can secure <code class="literal">rpcbind</code> by restricting access to all networks and defining specific exceptions using firewall rules on the server.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">rpcbind</code> service is required on <code class="literal">NFSv3</code> servers.
						</li><li class="listitem">
							The <code class="literal">rpcbind</code> service is not required on <code class="literal">NFSv4</code>.
						</li></ul></div></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">rpcbind</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">firewalld</code> package is installed and the service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add firewall rules, for example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Limit TCP connection and accept packages only from the <code class="literal">192.168.0.0/24</code> host via the <code class="literal">111</code> port:
							</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-rich-rule='rule family="ipv4" port port="111" protocol="tcp" source address="192.168.0.0/24" invert="True" drop'</strong></span></pre></li><li class="listitem"><p class="simpara">
								Limit TCP connection and accept packages only from local host via the <code class="literal">111</code> port:
							</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-rich-rule='rule family="ipv4" port port="111" protocol="tcp" source address="127.0.0.1" accept'</strong></span></pre></li><li class="listitem"><p class="simpara">
								Limit UDP connection and accept packages only from the <code class="literal">192.168.0.0/24</code> host via the <code class="literal">111</code> port:
							</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --permanent --add-rich-rule='rule family="ipv4" port port="111" protocol="udp" source address="192.168.0.0/24" invert="True" drop'</strong></span></pre><p class="simpara">
								To make the firewall settings permanent, use the <code class="literal">--permanent</code> option when adding firewall rules.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Reload the firewall to apply the new rules:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --reload</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List the firewall rules:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --list-rich-rule</strong></span>
rule family="ipv4" port port="111" protocol="tcp" source address="192.168.0.0/24" invert="True" drop
rule family="ipv4" port port="111" protocol="tcp" source address="127.0.0.1" accept
rule family="ipv4" port port="111" protocol="udp" source address="192.168.0.0/24" invert="True" drop</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						For more information about <code class="literal">NFSv4-only</code> servers, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_using_network_file_services/deploying-an-nfs-server_configuring-and-using-network-file-services#configuring-an-nfsv4-only-server_deploying-an-nfs-server">Configuring an NFSv4-only server</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters">Using and configuring firewalld</a>
					</li></ul></div></section><section class="section" id="securing-the-rpc-mountd-service_securing-network-services"><div class="titlepage"><div><div><h3 class="title">6.2. Securing the rpc.mountd service</h3></div></div></div><p>
				The <code class="literal">rpc.mountd</code> daemon implements the server side of the NFS mount protocol. The NFS mount protocol is used by NFS version 3 (RFC 1813).
			</p><p>
				You can secure the <code class="literal">rpc.mountd</code> service by adding firewall rules to the server. You can restrict access to all networks and define specific exceptions using firewall rules.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">rpc.mountd</code> package is installed.
					</li><li class="listitem">
						The <code class="literal">firewalld</code> package is installed and the service is running.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add firewall rules to the server, for example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Accept <code class="literal">mountd</code> connections from the <code class="literal">192.168.0.0/24</code> host:
							</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --add-rich-rule 'rule family="ipv4" service name="mountd" source address="192.168.0.0/24" invert="True" drop'</strong></span></pre></li><li class="listitem"><p class="simpara">
								Accept <code class="literal">mountd</code> connections from the local host:
							</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --permanent --add-rich-rule 'rule family="ipv4" source address="127.0.0.1" service name="mountd" accept'</strong></span></pre><p class="simpara">
								To make the firewall settings permanent, use the <code class="literal">--permanent</code> option when adding firewall rules.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Reload the firewall to apply the new rules:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --reload</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						List the firewall rules:
					</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --list-rich-rule</strong></span>
rule family="ipv4" service name="mountd" source address="192.168.0.0/24" invert="True" drop
rule family="ipv4" source address="127.0.0.1" service name="mountd" accept</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters">Using and configuring firewalld</a>
					</li></ul></div></section><section class="section" id="securing-the-nfs-service_securing-network-services"><div class="titlepage"><div><div><h3 class="title">6.3. Securing the NFS service</h3></div></div></div><p>
				You can secure Network File System version 4 (NFSv4) by authenticating and encrypting all file system operations using Kerberos. When using NFSv4 with Network Address Translation (NAT) or a firewall, you can turn off the delegations by modifying the <code class="literal">/etc/default/nfs</code> file. Delegation is a technique by which the server delegates the management of a file to a client.
			</p><p>
				In contrast, NFSv3 do not use Kerberos for locking and mounting files.
			</p><p>
				The NFS service sends the traffic using TCP in all versions of NFS. The service supports Kerberos user and group authentication, as part of the <code class="literal">RPCSEC_GSS</code> kernel module.
			</p><p>
				NFS allows remote hosts to mount file systems over a network and interact with those file systems as if they are mounted locally. You can merge the resources on centralized servers and additionally customize NFS mount options in the <code class="literal">/etc/nfsmount.conf</code> file when sharing the file systems.
			</p><section class="section" id="export-options-for-securing-an-nfs-server_securing-the-nfs-service"><div class="titlepage"><div><div><h4 class="title">6.3.1. Export options for securing an NFS server</h4></div></div></div><p>
					The NFS server determines a list structure of directories and hosts about which file systems to export to which hosts in the <code class="literal">/etc/exports</code> file.
				</p><p>
					You can use the following export options on the <code class="literal">/etc/exports</code> file:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ro</code></span></dt><dd>
								Exports the NFS volume as read-only.
							</dd><dt><span class="term"><code class="literal">rw</code></span></dt><dd>
								Allows read and write requests on the NFS volume. Use this option cautiously because allowing write access increases the risk of attacks. If your scenario requires mounting the directories with the <code class="literal">rw</code> option, make sure they are not writable for all users to reduce possible risks.
							</dd><dt><span class="term"><code class="literal">root_squash</code></span></dt><dd>
								Maps requests from <code class="literal">uid</code>/<code class="literal">gid</code> 0 to the anonymous <code class="literal">uid</code>/<code class="literal">gid</code>. This does not apply to any other <code class="literal">uids</code> or <code class="literal">gids</code> that might be equally sensitive, such as the <code class="literal">bin</code> user or the <code class="literal">staff</code> group.
							</dd><dt><span class="term"><code class="literal">no_root_squash</code></span></dt><dd>
								Turns off root squashing. By default, NFS shares change the <code class="literal">root</code> user to the <code class="literal">nobody</code> user, which is an unprivileged user account. This changes the owner of all the <code class="literal">root</code> created files to <code class="literal">nobody</code>, which prevents the uploading of programs with the <code class="literal">setuid</code> bit set. When using the <code class="literal">no_root_squash</code> option, remote root users can change any file on the shared file system and leave applications infected by trojans for other users.
							</dd><dt><span class="term"><code class="literal">secure</code></span></dt><dd>
								Restricts exports to reserved ports. By default, the server allows client communication only through reserved ports. However, it is easy for anyone to become a <code class="literal">root</code> user on a client on many networks, so it is rarely safe for the server to assume that communication through a reserved port is privileged. Therefore the restriction to reserved ports is of limited value; it is better to rely on Kerberos, firewalls, and restriction of exports to particular clients.
							</dd></dl></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
						Extra spaces in the syntax of the <code class="literal">/etc/exports</code> file can lead to major changes in the configuration.
					</p><p>
						In the following example, the <code class="literal">/tmp/nfs/</code> directory is shared with the <code class="literal">bob.example.com</code> host and has read and write permissions.
					</p><pre class="screen">/tmp/nfs/     bob.example.com(rw)</pre><p>
						The following example is the same as the previous one but shares the same directory to the <code class="literal">bob.example.com</code> host with read-only permissions and shares it to the <span class="emphasis"><em>world</em></span> with read and write permissions due to a single space character after the hostname.
					</p><pre class="screen">/tmp/nfs/     bob.example.com (rw)</pre><p>
						You can check the shared directories on your system by entering the <code class="literal">showmount -e <span class="emphasis"><em>&lt;hostname&gt;</em></span></code> command.
					</p></div></rh-alert><p>
					Additionally, consider the following best practices when exporting an NFS server:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Exporting home directories is a risk because some applications store passwords in plain text or in a weakly encrypted format. You can reduce the risk by reviewing and improving the application code.
						</li><li class="listitem">
							Some users do not set passwords on SSH keys which again leads to risks with home directories. You can reduce these risks by enforcing the use of passwords or using Kerberos.
						</li><li class="listitem">
							Restrict the NFS exports only to required clients. Use the <code class="literal">showmount -e</code> command on the NFS server to review what the server is exporting. Do not export anything that is not specifically required.
						</li><li class="listitem">
							Do not allow unnecessary users to log in to a server to reduce the risk of attacks. You can periodically check who and what can access the server.
						</li></ul></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
						Export an entire file system because exporting a subdirectory of a file system is not secure. An attacker might access the unexported part of a partially-exported file system.
					</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/using_external_red_hat_utilities_with_identity_management/using-automount-in-idm_using-external-red-hat-utilities-with-idm">Using automount in IdM</a> when using RHEL Identity Management
						</li><li class="listitem">
							<code class="literal">exports(5)</code> and <code class="literal">nfs(5)</code> man pages on your system
						</li></ul></div></section><section class="section" id="mount-options-for-securing-an-nfs-client_securing-the-nfs-service"><div class="titlepage"><div><div><h4 class="title">6.3.2. Mount options for securing an NFS client</h4></div></div></div><p>
					You can pass the following options to the <code class="literal">mount</code> command to increase the security of NFS-based clients:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">nosuid</code></span></dt><dd>
								Use the <code class="literal">nosuid</code> option to disable the <code class="literal">set-user-identifier</code> or <code class="literal">set-group-identifier</code> bits. This prevents remote users from gaining higher privileges by running a <code class="literal">setuid</code> program and you can use this option opposite to <code class="literal">setuid</code> option.
							</dd><dt><span class="term"><code class="literal">noexec</code></span></dt><dd>
								Use the <code class="literal">noexec</code> option to disable all executable files on the client. Use this to prevent users from accidentally executing files placed in the shared file system.
							</dd><dt><span class="term"><code class="literal">nodev</code></span></dt><dd>
								Use the <code class="literal">nodev</code> option to prevent the client’s processing of device files as a hardware device.
							</dd><dt><span class="term"><code class="literal">resvport</code></span></dt><dd>
								Use the <code class="literal">resvport</code> option to restrict communication to a reserved port and you can use a privileged source port to communicate with the server. The reserved ports are reserved for privileged users and processes such as the <code class="literal">root</code> user.
							</dd><dt><span class="term"><code class="literal">sec</code></span></dt><dd>
								Use the <code class="literal">sec</code> option on the NFS server to choose the RPCGSS security flavor for accessing files on the mount point. Valid security flavors are <code class="literal">none</code>, <code class="literal">sys</code>, <code class="literal">krb5</code>, <code class="literal">krb5i</code>, and <code class="literal">krb5p</code>.
							</dd></dl></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
						The MIT Kerberos libraries provided by the <code class="literal">krb5-libs</code> package do not support the Data Encryption Standard (DES) algorithm in new deployments. DES is deprecated and disabled by default in Kerberos libraries because of security and compatibility reasons. Use newer and more secure algorithms instead of DES, unless your environment requires DES for compatibility reasons.
					</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_file_systems/mounting-nfs-shares_managing-file-systems#frequently-used-nfs-mount-options_mounting-nfs-shares">Frequently-used NFS mount options</a>
						</li></ul></div></section><section class="section" id="securing-nfs-with-firewall_securing-the-nfs-service"><div class="titlepage"><div><div><h4 class="title">6.3.3. Securing NFS with firewall</h4></div></div></div><p>
					To secure the firewall on an NFS server, keep only the required ports open. Do not use the NFS connection port numbers for any other service.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							The <code class="literal">nfs-utils</code> package is installed.
						</li><li class="listitem">
							The <code class="literal">firewalld</code> package is installed and running.
						</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							On NFSv4, the firewall must open TCP port <code class="literal">2049</code>.
						</li><li class="listitem"><p class="simpara">
							On NFSv3, open four additional ports with <code class="literal">2049</code>:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									<code class="literal">rpcbind</code> service assigns the NFS ports dynamically, which might cause problems when creating firewall rules. To simplify this process, use the <code class="literal">/etc/nfs.conf</code> file to specify which ports to use:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Set TCP and UDP port for <code class="literal">mountd</code> (<code class="literal">rpc.mountd</code>) in the <code class="literal">[mountd]</code> section in <code class="literal">port=<span class="emphasis"><em>&lt;value&gt;</em></span></code> format.
										</li><li class="listitem">
											Set TCP and UDP port for <code class="literal">statd</code> (<code class="literal">rpc.statd</code>) in the <code class="literal">[statd]</code> section in <code class="literal">port=<span class="emphasis"><em>&lt;value&gt;</em></span></code> format.
										</li></ol></div></li><li class="listitem"><p class="simpara">
									Set the TCP and UDP port for the NFS lock manager (<code class="literal">nlockmgr</code>) in the <code class="literal">/etc/nfs.conf</code> file:
								</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
											Set TCP port for <code class="literal">nlockmgr</code> (<code class="literal">rpc.statd</code>) in the <code class="literal">[lockd]</code> section in <code class="literal">port=value</code> format. Alternatively, you can use the <code class="literal">nlm_tcpport</code> option in the <code class="literal">/etc/modprobe.d/lockd.conf</code> file.
										</li><li class="listitem">
											Set UDP port for <code class="literal">nlockmgr</code> (<code class="literal">rpc.statd</code>) in the <code class="literal">[lockd]</code> section in <code class="literal">udp-port=value</code> format. Alternatively, you can use the <code class="literal">nlm_udpport</code> option in the <code class="literal">/etc/modprobe.d/lockd.conf</code> file.
										</li></ol></div></li></ol></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							List the active ports and RPC programs on the NFS server:
						</p><pre class="screen">$ <span class="strong strong"><strong>rpcinfo -p</strong></span></pre></li></ul></div></section></section><section class="section" id="securing-the-ftp-service_securing-network-services"><div class="titlepage"><div><div><h3 class="title">6.4. Securing the FTP service</h3></div></div></div><p>
				You can use the File Transfer Protocol (FTP) to transfer files over a network. Because all FTP transactions with the server, including user authentication, are unencrypted, make sure it is configured securely.
			</p><p>
				RHEL 9 provides two FTP servers:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Red Hat Content Accelerator (<code class="literal">tux</code>)</span></dt><dd>
							A kernel-space web server with FTP capabilities.
						</dd><dt><span class="term">Very Secure FTP Daemon (<code class="literal">vsftpd</code>)</span></dt><dd>
							A standalone, security-oriented implementation of the FTP service.
						</dd></dl></div><p>
				The following security guidelines are for setting up the <code class="literal">vsftpd</code> FTP service.
			</p><section class="section" id="securing-the-ftp-greeting-banner_securing-the-ftp-service"><div class="titlepage"><div><div><h4 class="title">6.4.1. Securing the FTP greeting banner</h4></div></div></div><p>
					When a user connects to the FTP service, FTP shows a greeting banner, which by default includes version information. Attackers might use this information to identify weaknesses in the system. You can hide this information by changing the default banner.
				</p><p>
					You can define a custom banner by editing the <code class="literal">/etc/banners/ftp.msg</code> file to either directly include a single-line message, or to refer to a separate file, which can contain a multi-line message.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To define a single line message, add the following option to the <code class="literal">/etc/vsftpd/vsftpd.conf</code> file:
						</p><pre class="screen">ftpd_banner=Hello, all activity on ftp.example.com is logged.</pre></li><li class="listitem"><p class="simpara">
							To define a message in a separate file:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									Create a <code class="literal">.msg</code> file which contains the banner message, for example <code class="literal">/etc/banners/<span class="emphasis"><em>ftp</em></span>.msg</code>:
								</p><pre class="screen">######### Hello, all activity on ftp.example.com is logged. #########</pre><p class="simpara">
									To simplify the management of multiple banners, place all banners into the <code class="literal">/etc/banners/</code> directory.
								</p></li><li class="listitem"><p class="simpara">
									Add the path to the banner file to the <code class="literal">banner_file</code> option in the <code class="literal">/etc/vsftpd/vsftpd.conf</code> file:
								</p><pre class="screen">banner_file=/etc/banners/<span class="emphasis"><em>ftp</em></span>.msg</pre></li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Display the modified banner:
						</p><pre class="screen">$ <span class="strong strong"><strong>ftp localhost</strong></span>
Trying ::1…
Connected to localhost (::1).
Hello, all activity on ftp.example.com is logged.</pre></li></ul></div></section><section class="section" id="preventing-anonymous-access-and-uploads-in-ftp_securing-the-ftp-service"><div class="titlepage"><div><div><h4 class="title">6.4.2. Preventing anonymous access and uploads in FTP</h4></div></div></div><p>
					By default, installing the <code class="literal">vsftpd</code> package creates the <code class="literal">/var/ftp/</code> directory and a directory tree for anonymous users with read-only permissions on the directories. Because anonymous users can access the data, do not store sensitive data in these directories.
				</p><p>
					To increase the security of the system, you can configure the FTP server to allow anonymous users to upload files to a specific directory and prevent anonymous users from reading data. In the following procedure, the anonymous user must be able to upload files in the directory owned by the <code class="literal">root</code> user but not change it.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Create a write-only directory in the <code class="literal">/var/ftp/pub/</code> directory:
						</p><pre class="screen"># <span class="strong strong"><strong>mkdir /var/ftp/pub/<span class="emphasis"><em>upload</em></span></strong></span>
# <span class="strong strong"><strong>chmod 730 /var/ftp/pub/<span class="emphasis"><em>upload</em></span></strong></span>
# <span class="strong strong"><strong>ls -ld /var/ftp/pub/<span class="emphasis"><em>upload</em></span></strong></span>
drwx-wx---. 2 root ftp 4096 Nov 14 22:57 /var/ftp/pub/upload</pre></li><li class="listitem"><p class="simpara">
							Add the following lines to the <code class="literal">/etc/vsftpd/vsftpd.conf</code> file:
						</p><pre class="screen">anon_upload_enable=YES
anonymous_enable=YES</pre></li><li class="listitem">
							Optional: If your system has SELinux enabled and enforcing, enable SELinux boolean attributes <code class="literal">allow_ftpd_anon_write</code> and <code class="literal">allow_ftpd_full_access</code>.
						</li></ul></div><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
						Allowing anonymous users to read and write in directories might lead to the server becoming a repository for stolen software.
					</p></div></rh-alert></section><section class="section" id="securing-user-accounts-for-ftp_securing-the-ftp-service"><div class="titlepage"><div><div><h4 class="title">6.4.3. Securing user accounts for FTP</h4></div></div></div><p>
					FTP transmits usernames and passwords unencrypted over insecure networks for authentication. You can improve the security of FTP by denying system users access to the server from their user accounts.
				</p><p>
					Perform as many of the following steps as applicable for your configuration.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Disable all user accounts in the <code class="literal">vsftpd</code> server, by adding the following line to the <code class="literal">/etc/vsftpd/vsftpd.conf</code> file:
						</p><pre class="screen">local_enable=NO</pre></li><li class="listitem">
							Disable FTP access for specific accounts or specific groups of accounts, such as the <code class="literal">root</code> user and users with <code class="literal">sudo</code> privileges, by adding the usernames to the <code class="literal">/etc/pam.d/vsftpd</code> PAM configuration file.
						</li><li class="listitem">
							Disable user accounts, by adding the usernames to the <code class="literal">/etc/vsftpd/ftpusers</code> file.
						</li></ul></div></section><section class="section _additional-resources" id="additional_resources_2"><div class="titlepage"><div><div><h4 class="title">6.4.4. Additional resources</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal">ftpd_selinux(8)</code> man page on your system
						</li></ul></div></section></section><section class="section" id="securing-http-servers_securing-network-services"><div class="titlepage"><div><div><h3 class="title">6.5. Securing HTTP servers</h3></div></div></div><section class="section" id="security-enhancements-in-http-conf_securing-http-servers"><div class="titlepage"><div><div><h4 class="title">6.5.1. Security enhancements in httpd.conf</h4></div></div></div><p>
					You can enhance the security of the Apache HTTP server by configuring security options in the <code class="literal">/etc/httpd/conf/httpd.conf</code> file.
				</p><p>
					Always verify that all scripts running on the system work correctly before putting them into production.
				</p><p>
					Ensure that only the <code class="literal">root</code> user has write permissions to any directory containing scripts or Common Gateway Interfaces (CGI). To change the directory ownership to <code class="literal">root</code> with write permissions, enter the following commands:
				</p><pre class="screen"># <span class="strong strong"><strong>chown root <span class="emphasis"><em>&lt;directory_name&gt;</em></span></strong></span>
# <span class="strong strong"><strong>chmod 755 <span class="emphasis"><em>&lt;directory_name&gt;</em></span></strong></span></pre><p>
					In the <code class="literal">/etc/httpd/conf/httpd.conf</code> file, you can configure the following options:
				</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">FollowSymLinks</code></span></dt><dd>
								This directive is enabled by default and follows symbolic links in the directory.
							</dd><dt><span class="term"><code class="literal">Indexes</code></span></dt><dd>
								This directive is enabled by default. Disable this directive to prevent visitors from browsing files on the server.
							</dd><dt><span class="term"><code class="literal">UserDir</code></span></dt><dd>
								This directive is disabled by default because it can confirm the presence of a user account on the system. To activate user directory browsing for all user directories other than <code class="literal">/root/</code>, use the <code class="literal">UserDir enabled</code> and <code class="literal">UserDir disabled</code> root directives. To add users to the list of disabled accounts, add a space-delimited list of users on the <code class="literal">UserDir disabled</code> line.
							</dd><dt><span class="term"><code class="literal">ServerTokens</code></span></dt><dd><p class="simpara">
								This directive controls the server response header field which is sent back to clients. You can use the following parameters to customize the information:
							</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ServerTokens Full</code></span></dt><dd><p class="simpara">
											Provides all available information such as web server version number, server operating system details, installed Apache modules, for example:
										</p><pre class="screen">Apache/2.4.37 (Red Hat Enterprise Linux) MyMod/1.2</pre></dd><dt><span class="term"><code class="literal">ServerTokens Full-Release</code></span></dt><dd><p class="simpara">
											Provides all available information with release versions, for example:
										</p><pre class="screen">Apache/2.4.37 (Red Hat Enterprise Linux) (Release 41.module+el8.5.0+11772+c8e0c271)</pre></dd><dt><span class="term"><code class="literal">ServerTokens Prod / ServerTokens ProductOnly</code></span></dt><dd><p class="simpara">
											Provides the web server name, for example:
										</p><pre class="screen">Apache</pre></dd><dt><span class="term"><code class="literal">ServerTokens Major</code></span></dt><dd><p class="simpara">
											Provides the web server major release version, for example:
										</p><pre class="screen">Apache/2</pre></dd><dt><span class="term"><code class="literal">ServerTokens Minor</code></span></dt><dd><p class="simpara">
											Provides the web server minor release version, for example:
										</p><pre class="screen">Apache/2.4</pre></dd><dt><span class="term"><code class="literal">ServerTokens Min</code> / <code class="literal">ServerTokens Minimal</code></span></dt><dd><p class="simpara">
											Provides the web server minimal release version, for example:
										</p><pre class="screen">Apache/2.4.37</pre></dd><dt><span class="term"><code class="literal">ServerTokens OS</code></span></dt><dd><p class="simpara">
											Provides the web server release version and operating system, for example:
										</p><pre class="screen">Apache/2.4.37 (Red Hat Enterprise Linux)</pre><p class="simpara">
											Use the <code class="literal">ServerTokens Prod</code> option to reduce the risk of attackers gaining any valuable information about your system.
										</p></dd></dl></div></dd></dl></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
						Do not remove the <code class="literal">IncludesNoExec</code> directive. By default, the Server Side Includes (SSI) module cannot execute commands. Changing this can allow an attacker to enter commands on the system.
					</p></div></rh-alert><div class="formalpara"><p class="title"><strong>Removing httpd modules</strong></p><p>
						You can remove the <code class="literal">httpd</code> modules to limit the functionality of the HTTP server. To do so, edit configuration files in the <code class="literal">/etc/httpd/conf.modules.d/</code> or <code class="literal">/etc/httpd/conf.d/</code> directory. For example, to remove the proxy module:
					</p></div><pre class="screen"><span class="strong strong"><strong>echo '# All proxy modules disabled' &gt; /etc/httpd/conf.modules.d/00-proxy.conf</strong></span></pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/setting-apache-http-server_deploying-different-types-of-servers">The Apache HTTP server</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/using_selinux/index#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations">Customizing the SELinux policy for the Apache HTTP server</a>
						</li></ul></div></section><section class="section" id="securing-the-nginx-server_securing-http-servers"><div class="titlepage"><div><div><h4 class="title">6.5.2. Securing the Nginx server configuration</h4></div></div></div><p>
					Nginx is a high-performance HTTP and proxy server. You can harden your Nginx configuration with the following configuration options.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							To disable version strings, modify the <code class="literal">server_tokens</code> configuration option:
						</p><pre class="screen">server_tokens off;</pre><p class="simpara">
							This option stops displaying additional details such as server version number. This configuration displays only the server name in all requests served by Nginx, for example:
						</p><pre class="screen">$ <span class="strong strong"><strong>curl -sI http://localhost | grep Server</strong></span>
Server: nginx</pre></li><li class="listitem"><p class="simpara">
							Add extra security headers that mitigate certain known web application vulnerabilities in specific <code class="literal">/etc/nginx/</code> conf files:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
									For example, the <code class="literal">X-Frame-Options</code> header option denies any page outside of your domain to frame any content served by Nginx, mitigating clickjacking attacks:
								</p><pre class="screen">add_header X-Frame-Options "SAMEORIGIN";</pre></li><li class="listitem"><p class="simpara">
									For example, the <code class="literal">x-content-type</code> header prevents MIME-type sniffing in certain older browsers:
								</p><pre class="screen">add_header X-Content-Type-Options nosniff;</pre></li><li class="listitem"><p class="simpara">
									For example, the <code class="literal">X-XSS-Protection</code> header enables Cross-Site Scripting (XSS) filtering, which prevents browsers from rendering potentially malicious content included in a response by Nginx:
								</p><pre class="screen">add_header X-XSS-Protection "1; mode=block";</pre></li></ul></div></li><li class="listitem"><p class="simpara">
							You can limit the services exposed to the public and limit what they do and accept from the visitors, for example:
						</p><pre class="screen">limit_except GET {
    allow 192.168.1.0/32;
    deny  all;
}</pre><p class="simpara">
							The snippet will limit access to all methods except <code class="literal">GET</code> and <code class="literal">HEAD</code>.
						</p></li><li class="listitem"><p class="simpara">
							You can disable HTTP methods, for example:
						</p><pre class="screen"># Allow GET, PUT, POST; return "405 Method Not Allowed" for all others.
if ( $request_method !~ ^(GET|PUT|POST)$ ) {
    return 405;
}</pre></li><li class="listitem">
							You can configure SSL to protect the data served by your Nginx web server, consider serving it over HTTPS only. Furthermore, you can generate a secure configuration profile for enabling SSL in your Nginx server using the Mozilla SSL Configuration Generator. The generated configuration ensures that known vulnerable protocols (for example, SSLv2 and SSLv3), ciphers, and hashing algorithms (for example, 3DES and MD5) are disabled. You can also use the SSL Server Test to verify that your configuration meets modern security requirements.
						</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							<a class="link" href="https://ssl-config.mozilla.org/">Mozilla SSL Configuration Generator</a>
						</li><li class="listitem">
							<a class="link" href="https://www.ssllabs.com/ssltest/">SSL Server Test</a>
						</li></ul></div></section></section><section class="section" id="securing-postgresql-by-limiting-access-to-authenticated-local-users_securing-network-services"><div class="titlepage"><div><div><h3 class="title">6.6. Securing PostgreSQL by limiting access to authenticated local users</h3></div></div></div><p>
				PostgreSQL is an object-relational database management system (DBMS). In Red Hat Enterprise Linux, PostgreSQL is provided by the <code class="literal">postgresql-server</code> package.
			</p><p>
				You can reduce the risks of attacks by configuring client authentication. The <code class="literal">pg_hba.conf</code> configuration file stored in the database cluster’s data directory controls the client authentication. Follow the procedure to configure PostgreSQL for host-based authentication.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Install PostgreSQL:
					</p><pre class="screen"># <span class="strong strong"><strong>yum install postgresql-server</strong></span></pre></li><li class="listitem"><p class="simpara">
						Initialize a database storage area using one of the following options:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Using the <code class="literal">initdb</code> utility:
							</p><pre class="screen">$ <span class="strong strong"><strong>initdb -D <span class="emphasis"><em>/home/postgresql/db1/</em></span></strong></span></pre><p class="simpara">
								The <code class="literal">initdb</code> command with the <code class="literal">-D</code> option creates the directory you specify if it does not already exist, for example <code class="literal"><span class="emphasis"><em>/home/postgresql/db1/</em></span></code>. This directory then contains all the data stored in the database and also the client authentication configuration file.
							</p></li><li class="listitem"><p class="simpara">
								Using the <code class="literal">postgresql-setup</code> script:
							</p><pre class="screen">$ <span class="strong strong"><strong>postgresql-setup --initdb</strong></span></pre><p class="simpara">
								By default, the script uses the <code class="literal">/var/lib/pgsql/data/</code> directory. This script helps system administrators with basic database cluster administration.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						To allow any authenticated local users to access any database with their usernames, modify the following line in the <code class="literal">pg_hba.conf</code> file:
					</p><pre class="screen">local   all             all                                     trust</pre><p class="simpara">
						This can be problematic when you use layered applications that create database users and no local users. If you do not want to explicitly control all user names on the system, remove the <code class="literal">local</code> line entry from the <code class="literal">pg_hba.conf</code> file.
					</p></li><li class="listitem"><p class="simpara">
						Restart the database to apply the changes:
					</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart postgresql</strong></span></pre><p class="simpara">
						The previous command updates the database and also verifies the syntax of the configuration file.
					</p></li></ol></div></section><section class="section" id="securing-the-memcached-service_securing-network-services"><div class="titlepage"><div><div><h3 class="title">6.7. Securing the Memcached service</h3></div></div></div><p>
				Memcached is an open source, high-performance, distributed memory object caching system. It can improve the performance of dynamic web applications by lowering database load.
			</p><p>
				Memcached is an in-memory key-value store for small chunks of arbitrary data, such as strings and objects, from results of database calls, API calls, or page rendering. Memcached allows assigning memory from underutilized areas to applications that require more memory.
			</p><p>
				In 2018, vulnerabilities of DDoS amplification attacks by exploiting Memcached servers exposed to the public internet were discovered. These attacks took advantage of Memcached communication using the UDP protocol for transport. The attack was effective because of the high amplification ratio where a request with the size of a few hundred bytes could generate a response of a few megabytes or even hundreds of megabytes in size.
			</p><p>
				In most situations, the <code class="literal">memcached</code> service does not need to be exposed to the public Internet. Such exposure may have its own security problems, allowing remote attackers to leak or modify information stored in Memcached.
			</p><section class="section" id="hardening-memcached-against-ddos_securing-the-memcached-service"><div class="titlepage"><div><div><h4 class="title">6.7.1. Hardening Memcached against DDoS</h4></div></div></div><p>
					To mitigate security risks, perform as many of the following steps as applicable for your configuration.
				</p><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
							Configure a firewall in your LAN. If your Memcached server should be accessible only in your local network, do not route external traffic to ports used by the <code class="literal">memcached</code> service. For example, remove the default port <code class="literal">11211</code> from the list of allowed ports:
						</p><pre class="screen"># <span class="strong strong"><strong>firewall-cmd --remove-port=11211/udp</strong></span>
# <span class="strong strong"><strong>firewall-cmd --runtime-to-permanent</strong></span></pre></li><li class="listitem"><p class="simpara">
							If you use a single Memcached server on the same machine as your application, set up <code class="literal">memcached</code> to listen to localhost traffic only. Modify the <code class="literal">OPTIONS</code> value in the <code class="literal">/etc/sysconfig/memcached</code> file:
						</p><pre class="screen">OPTIONS="-l 127.0.0.1,::1"</pre></li><li class="listitem"><p class="simpara">
							Enable Simple Authentication and Security Layer (SASL) authentication:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Modify or add the <code class="literal">/etc/sasl2/memcached.conf</code> file:
								</p><pre class="screen">sasldb_path: /path.to/memcached.sasldb</pre></li><li class="listitem"><p class="simpara">
									Add an account in the SASL database:
								</p><pre class="screen"># <span class="strong strong"><strong>saslpasswd2 -a memcached -c cacheuser -f /path.to/memcached.sasldb</strong></span></pre></li><li class="listitem"><p class="simpara">
									Ensure that the database is accessible for the <code class="literal">memcached</code> user and group:
								</p><pre class="screen"># <span class="strong strong"><strong>chown memcached:memcached /path.to/memcached.sasldb</strong></span></pre></li><li class="listitem"><p class="simpara">
									Enable SASL support in Memcached by adding the <code class="literal">-S</code> value to the <code class="literal">OPTIONS</code> parameter in the <code class="literal">/etc/sysconfig/memcached</code> file:
								</p><pre class="screen">OPTIONS="-S"</pre></li><li class="listitem"><p class="simpara">
									Restart the Memcached server to apply the changes:
								</p><pre class="screen"># <span class="strong strong"><strong>systemctl restart memcached</strong></span></pre></li><li class="listitem">
									Add the username and password created in the SASL database to the Memcached client configuration of your application.
								</li></ol></div></li><li class="listitem"><p class="simpara">
							Encrypt communication between Memcached clients and servers with TLS:
						</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
									Enable encrypted communication between Memcached clients and servers with TLS by adding the <code class="literal">-Z</code> value to the <code class="literal">OPTIONS</code> parameter in the <code class="literal">/etc/sysconfig/memcached</code> file:
								</p><pre class="screen">OPTIONS="-Z"</pre></li><li class="listitem">
									Add the certificate chain file path in the PEM format using the <code class="literal">-o ssl_chain_cert</code> option.
								</li><li class="listitem">
									Add a private key file path using the <code class="literal">-o ssl_key</code> option.
								</li></ol></div></li></ul></div></section></section></section><section class="chapter" id="assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Using MACsec to encrypt layer-2 traffic in the same physical network</h2></div></div></div><p class="_abstract _abstract">
			You can use MACsec to secure the communication between two devices (point-to-point). For example, your branch office is connected over a Metro-Ethernet connection with the central office, you can configure MACsec on the two hosts that connect the offices to increase the security.
		</p><section class="section" id="how-macsec-increases-security_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network"><div class="titlepage"><div><div><h3 class="title">7.1. How MACsec increases security</h3></div></div></div><p>
				Media Access Control security (MACsec) is a layer-2 protocol that secures different traffic types over the Ethernet links, including:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Dynamic host configuration protocol (DHCP)
					</li><li class="listitem">
						address resolution protocol (ARP)
					</li><li class="listitem">
						IPv4 and IPv6 traffic
					</li><li class="listitem">
						Any traffic over IP such as TCP or UDP
					</li></ul></div><p>
				MACsec encrypts and authenticates all traffic in LANs, by default with the GCM-AES-128 algorithm, and uses a pre-shared key to establish the connection between the participant hosts. To change the pre-shared key, you must update the NM configuration on all network hosts that use MACsec.
			</p><p>
				A MACsec connection uses an Ethernet device, such as an Ethernet network card, VLAN, or tunnel device, as a parent. You can either set an IP configuration only on the MACsec device to communicate with other hosts only by using the encrypted connection, or you can also set an IP configuration on the parent device. In the latter case, you can use the parent device to communicate with other hosts using an unencrypted connection and the MACsec device for encrypted connections.
			</p><p>
				MACsec does not require any special hardware. For example, you can use any switch, except if you want to encrypt traffic only between a host and a switch. In this scenario, the switch must also support MACsec.
			</p><p>
				In other words, you can configure MACsec for two common scenarios:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Host-to-host
					</li><li class="listitem">
						Host-to-switch and switch-to-other-hosts
					</li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					You can use MACsec only between hosts being in the same physical or virtual LAN.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://developers.redhat.com/blog/2016/10/14/macsec-a-different-solution-to-encrypt-network-traffic">MACsec: a different solution to encrypt network traffic</a>
					</li></ul></div></section><section class="section" id="proc_configuring-a-macsec-connection-using-nmcli_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network"><div class="titlepage"><div><div><h3 class="title">7.2. Configuring a MACsec connection by using <code class="literal">nmcli</code></h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">nmcli</code> utility to configure Ethernet interfaces to use MACsec. For example, you can create a MACsec connection between two hosts that are connected over Ethernet.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the first host on which you configure MACsec:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Create the connectivity association key (CAK) and connectivity-association key name (CKN) for the pre-shared key:
							</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
										Create a 16-byte hexadecimal CAK:
									</p><pre class="literallayout"># <span class="strong strong"><strong>dd if=/dev/urandom count=16 bs=1 2&gt; /dev/null | hexdump -e '1/2 "%04x"'</strong></span>
50b71a8ef0bd5751ea76de6d6c98c03a</pre></li><li class="listitem"><p class="simpara">
										Create a 32-byte hexadecimal CKN:
									</p><pre class="literallayout"># <span class="strong strong"><strong>dd if=/dev/urandom count=32 bs=1 2&gt; /dev/null | hexdump -e '1/2 "%04x"'</strong></span>
f2b4297d39da7330910a74abc0449feb45b5c0b9fc23df1430e1898fcf1c4550</pre></li></ol></div></li></ul></div></li><li class="listitem">
						On both hosts you want to connect over a MACsec connection:
					</li><li class="listitem"><p class="simpara">
						Create the MACsec connection:
					</p><pre class="literallayout"># <span class="strong strong"><strong>nmcli connection add type macsec con-name macsec0 ifname macsec0 connection.autoconnect yes macsec.parent enp1s0 macsec.mode psk macsec.mka-cak 50b71a8ef0bd5751ea76de6d6c98c03a macsec.mka-ckn f2b4297d39da7330910a74abc0449feb45b5c0b9fc23df1430e1898fcf1c4550</strong></span></pre><p class="simpara">
						Use the CAK and CKN generated in the previous step in the <code class="literal">macsec.mka-cak</code> and <code class="literal">macsec.mka-ckn</code> parameters. The values must be the same on every host in the MACsec-protected network.
					</p></li><li class="listitem"><p class="simpara">
						Configure the IP settings on the MACsec connection.
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Configure the <code class="literal">IPv4</code> settings. For example, to set a static <code class="literal">IPv4</code> address, network mask, default gateway, and DNS server to the <code class="literal">macsec0</code> connection, enter:
							</p><pre class="literallayout"># <span class="strong strong"><strong>nmcli connection modify macsec0 ipv4.method manual ipv4.addresses '192.0.2.1/24' ipv4.gateway '192.0.2.254' ipv4.dns '192.0.2.253'</strong></span></pre></li><li class="listitem"><p class="simpara">
								Configure the <code class="literal">IPv6</code> settings. For example, to set a static <code class="literal">IPv6</code> address, network mask, default gateway, and DNS server to the <code class="literal">macsec0</code> connection, enter:
							</p><pre class="literallayout"># <span class="strong strong"><strong>nmcli connection modify macsec0 ipv6.method manual ipv6.addresses '2001:db8:1::1/32' ipv6.gateway '2001:db8:1::fffe' ipv6.dns '2001:db8:1::fffd'</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Activate the connection:
					</p><pre class="literallayout"># <span class="strong strong"><strong>nmcli connection up macsec0</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the traffic is encrypted:
					</p><pre class="literallayout"># <span class="strong strong"><strong>tcpdump -nn -i enp1s0</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Display the unencrypted traffic:
					</p><pre class="literallayout"># <span class="strong strong"><strong>tcpdump -nn -i macsec0</strong></span></pre></li><li class="listitem"><p class="simpara">
						Display MACsec statistics:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ip macsec show</strong></span></pre></li><li class="listitem"><p class="simpara">
						Display individual counters for each type of protection: integrity-only (encrypt off) and encryption (encrypt on)
					</p><pre class="literallayout"># <span class="strong strong"><strong>ip -s macsec show</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://developers.redhat.com/blog/2016/10/14/macsec-a-different-solution-to-encrypt-network-traffic">MACsec: a different solution to encrypt network traffic</a>
					</li></ul></div></section><section class="section" id="configuring-a-macsec-connection-using-nmstatectl_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network"><div class="titlepage"><div><div><h3 class="title">7.3. Configuring a MACsec connection by using <code class="literal">nmstatectl</code></h3></div></div></div><p class="_abstract _abstract">
				You can configure Ethernet interfaces to use MACsec through the <code class="literal">nmstatectl</code> utility in a declarative way. For example, in a YAML file, you describe the desired state of your network, which is supposed to have a MACsec connection between two hosts connected over Ethernet. The <code class="literal">nmstatectl</code> utility interprets the YAML file and deploys persistent and consistent network configuration across the hosts.
			</p><p>
				Using the MACsec security standard for securing communication at the link layer, also known as layer 2 of the Open Systems Interconnection (OSI) model provides the following notable benefits:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Encryption at layer 2 eliminates the need for encrypting individual services at layer 7. This reduces the overhead associated with managing a large number of certificates for each endpoint on each host.
					</li><li class="listitem">
						Point-to-point security between directly connected network devices such as routers and switches.
					</li><li class="listitem">
						No changes needed for applications and higher-layer protocols.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						A physical or virtual Ethernet Network Interface Controller (NIC) exists in the server configuration.
					</li><li class="listitem">
						The <code class="literal">nmstate</code> package is installed.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the first host on which you configure MACsec, create the connectivity association key (CAK) and connectivity-association key name (CKN) for the pre-shared key:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a 16-byte hexadecimal CAK:
							</p><pre class="literallayout"># <span class="strong strong"><strong>dd if=/dev/urandom count=16 bs=1 2&gt; /dev/null | hexdump -e '1/2 "%04x"'</strong></span>
50b71a8ef0bd5751ea76de6d6c98c03a</pre></li><li class="listitem"><p class="simpara">
								Create a 32-byte hexadecimal CKN:
							</p><pre class="literallayout"># <span class="strong strong"><strong>dd if=/dev/urandom count=32 bs=1 2&gt; /dev/null | hexdump -e '1/2 "%04x"'</strong></span>
f2b4297d39da7330910a74abc0449feb45b5c0b9fc23df1430e1898fcf1c4550</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						On both hosts that you want to connect over a MACsec connection, complete the following steps:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create a YAML file, for example <code class="literal">create-macsec-connection.yml</code>, with the following settings:
							</p><pre class="literallayout">---
routes:
  config:
  - destination: 0.0.0.0/0
    next-hop-interface: macsec0
    next-hop-address: 192.0.2.2
    table-id: 254
  - destination: 192.0.2.2/32
    next-hop-interface: macsec0
    next-hop-address: 0.0.0.0
    table-id: 254
dns-resolver:
  config:
    search:
    - example.com
    server:
    - 192.0.2.200
    - 2001:db8:1::ffbb
interfaces:
- name: macsec0
  type: macsec
  state: up
  ipv4:
    enabled: true
    address:
    - ip: 192.0.2.1
      prefix-length: 32
  ipv6:
    enabled: true
    address:
    - ip: 2001:db8:1::1
      prefix-length: 64
  macsec:
    encrypt: true
    base-iface: enp0s1
    mka-cak: 50b71a8ef0bd5751ea76de6d6c98c03a
    mka-ckn: f2b4297d39da7330910a74abc0449feb45b5c0b9fc23df1430e1898fcf1c4550
    port: 0
    validation: strict
    send-sci: true</pre></li><li class="listitem">
								Use the CAK and CKN generated in the previous step in the <code class="literal">mka-cak</code> and <code class="literal">mka-ckn</code> parameters. The values must be the same on every host in the MACsec-protected network.
							</li><li class="listitem"><p class="simpara">
								Optional: In the same YAML configuration file, you can also configure the following settings:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										A static IPv4 address - <code class="literal">192.0.2.1</code> with the <code class="literal">/32</code> subnet mask
									</li><li class="listitem">
										A static IPv6 address - <code class="literal">2001:db8:1::1</code> with the <code class="literal">/64</code> subnet mask
									</li><li class="listitem">
										An IPv4 default gateway - <code class="literal">192.0.2.2</code>
									</li><li class="listitem">
										An IPv4 DNS server - <code class="literal">192.0.2.200</code>
									</li><li class="listitem">
										An IPv6 DNS server - <code class="literal">2001:db8:1::ffbb</code>
									</li><li class="listitem">
										A DNS search domain - <code class="literal">example.com</code>
									</li></ul></div></li></ol></div></li><li class="listitem"><p class="simpara">
						Apply the settings to the system:
					</p><pre class="literallayout"># <span class="strong strong"><strong>nmstatectl apply create-macsec-connection.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Display the current state in YAML format:
					</p><pre class="literallayout"># <span class="strong strong"><strong>nmstatectl show macsec0</strong></span></pre></li><li class="listitem"><p class="simpara">
						Verify that the traffic is encrypted:
					</p><pre class="literallayout"># <span class="strong strong"><strong>tcpdump -nn -i enp0s1</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Display the unencrypted traffic:
					</p><pre class="literallayout"># <span class="strong strong"><strong>tcpdump -nn -i macsec0</strong></span></pre></li><li class="listitem"><p class="simpara">
						Display MACsec statistics:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ip macsec show</strong></span></pre></li><li class="listitem"><p class="simpara">
						Display individual counters for each type of protection: integrity-only (encrypt off) and encryption (encrypt on)
					</p><pre class="literallayout"># <span class="strong strong"><strong>ip -s macsec show</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://developers.redhat.com/blog/2016/10/14/macsec-a-different-solution-to-encrypt-network-traffic">MACsec: a different solution to encrypt network traffic</a>
					</li></ul></div></section></section><section class="chapter" id="assembly_securing-the-postfix-service_securing-networks"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Securing the Postfix service</h2></div></div></div><p>
			Postfix is a mail transfer agent (MTA) that uses the Simple Mail Transfer Protocol (SMTP) to deliver electronic messages between other MTAs and to email clients or delivery agents. Although MTAs can encrypt traffic between one another, they might not do so by default. You can also mitigate risks to various attacks by changing setting to more secure values.
		</p><section class="section" id="ref_reducing-postfix-network-related-security-risks_assembly_securing-the-postfix-service"><div class="titlepage"><div><div><h3 class="title">8.1. Reducing Postfix network-related security risks</h3></div></div></div><p>
				To reduce the risk of attackers invading your system through the network, perform as many of the following tasks as possible.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Do not share the <code class="literal">/var/spool/postfix/</code> mail spool directory on a Network File System (NFS) shared volume. NFSv2 and NFSv3 do not maintain control over user and group IDs. Therefore, if two or more users have the same UID, they can receive and read each other’s mail, which is a security risk.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							This rule does not apply to NFSv4 using Kerberos, because the <code class="literal">SECRPC_GSS</code> kernel module does not use UID-based authentication. However, to reduce the security risks, you should not put the mail spool directory on NFS shared volumes.
						</p></div></rh-alert></li><li class="listitem">
						To reduce the probability of Postfix server exploits, mail users must access the Postfix server using an email program. Do not allow shell accounts on the mail server, and set all user shells in the <code class="literal">/etc/passwd</code> file to <code class="literal">/sbin/nologin</code> (with the possible exception of the <code class="literal">root</code> user).
					</li><li class="listitem">
						To protect Postfix from a network attack, it is set up to only listen to the local loopback address by default. You can verify this by viewing the <code class="literal">inet_interfaces = localhost</code> line in the <code class="literal">/etc/postfix/main.cf</code> file. This ensures that Postfix only accepts mail messages (such as <code class="literal">cron</code> job reports) from the local system and not from the network. This is the default setting and protects Postfix from a network attack. To remove the localhost restriction and allow Postfix to listen on all interfaces, set the <code class="literal">inet_interfaces</code> parameter to <code class="literal">all</code> in <code class="literal">/etc/postfix/main.cf</code>.
					</li></ul></div></section><section class="section" id="ref_postfix-configuration-options-for-limiting-dos-attacks_assembly_securing-the-postfix-service"><div class="titlepage"><div><div><h3 class="title">8.2. Postfix configuration options for limiting DoS attacks</h3></div></div></div><p>
				An attacker can flood the server with traffic, or send information that triggers a crash, causing a denial of service (DoS) attack. You can configure your system to reduce the risk of such attacks by setting limits in the <code class="literal">/etc/postfix/main.cf</code> file. You can change the value of the existing directives or you can add new directives with custom values in the <code class="literal"><span class="emphasis"><em>&lt;directive&gt;</em></span> = <span class="emphasis"><em>&lt;value&gt;</em></span></code> format.
			</p><p>
				Use the following list of directives for limiting a DoS attack:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">smtpd_client_connection_rate_limit</code></span></dt><dd>
							Limits the maximum number of connection attempts any client can make to this service per time unit. The default value is <code class="literal">0</code>, which means a client can make as many connections per time unit as Postfix can accept. By default, the directive excludes clients in trusted networks.
						</dd><dt><span class="term"><code class="literal">anvil_rate_time_unit</code></span></dt><dd>
							Defines a time unit to calculate the rate limit. The default value is <code class="literal">60</code> seconds.
						</dd><dt><span class="term"><code class="literal">smtpd_client_event_limit_exceptions</code></span></dt><dd>
							Excludes clients from the connection and rate limit commands. By default, the directive excludes clients in trusted networks.
						</dd><dt><span class="term"><code class="literal">smtpd_client_message_rate_limit</code></span></dt><dd>
							Defines the maximum number of message deliveries from client to request per time unit (regardless of whether or not Postfix actually accepts those messages).
						</dd><dt><span class="term"><code class="literal">default_process_limit</code></span></dt><dd>
							Defines the default maximum number of Postfix child processes that provide a given service. You can ignore this rule for specific services in the <code class="literal">master.cf</code> file. By default, the value is <code class="literal">100</code>.
						</dd><dt><span class="term"><code class="literal">queue_minfree</code></span></dt><dd>
							Defines the minimum amount of free space required to receive mail in the queue file system. The directive is currently used by the Postfix SMTP server to decide if it accepts any mail at all. By default, the Postfix SMTP server rejects <code class="literal">MAIL FROM</code> commands when the amount of free space is less than 1.5 times the <code class="literal">message_size_limit</code>. To specify a higher minimum free space limit, specify a <code class="literal">queue_minfree</code> value that is at least 1.5 times the <code class="literal">message_size_limit</code>. By default, the <code class="literal">queue_minfree</code> value is <code class="literal">0</code>.
						</dd><dt><span class="term"><code class="literal">header_size_limit</code></span></dt><dd>
							Defines the maximum amount of memory in bytes for storing a message header. If a header is large, it discards the excess header. By default, the value is <code class="literal">102400</code> bytes.
						</dd><dt><span class="term"><code class="literal">message_size_limit</code></span></dt><dd>
							Defines the maximum size of a message including the envelope information in bytes. By default, the value is <code class="literal">10240000</code> bytes.
						</dd></dl></div></section><section class="section" id="proc_configuring-postfix-to-use-sasl_assembly_securing-the-postfix-service"><div class="titlepage"><div><div><h3 class="title">8.3. Configuring Postfix to use SASL</h3></div></div></div><p>
				Postfix supports Simple Authentication and Security Layer (SASL) based SMTP Authentication (AUTH). SMTP AUTH is an extension of the Simple Mail Transfer Protocol. Currently, the Postfix SMTP server supports the SASL implementations in the following ways:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Dovecot SASL</span></dt><dd>
							The Postfix SMTP server can communicate with the Dovecot SASL implementation using either a UNIX-domain socket or a TCP socket. Use this method if Postfix and Dovecot applications are running on separate machines.
						</dd><dt><span class="term">Cyrus SASL</span></dt><dd>
							When enabled, SMTP clients must authenticate with the SMTP server using an authentication method supported and accepted by both the server and the client.
						</dd></dl></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">dovecot</code> package is installed on the system
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Set up Dovecot:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Include the following lines in the <code class="literal">/etc/dovecot/conf.d/10-master.conf</code> file:
							</p><pre class="screen">service auth {
  unix_listener /var/spool/postfix/private/auth {
    mode = 0660
    user = postfix
    group = postfix
  }
}</pre><p class="simpara">
								The previous example uses UNIX-domain sockets for communication between Postfix and Dovecot. The example also assumes default Postfix SMTP server settings, which include the mail queue located in the <code class="literal">/var/spool/postfix/</code> directory, and the application running under the <code class="literal">postfix</code> user and group.
							</p></li><li class="listitem"><p class="simpara">
								Optional: Set up Dovecot to listen for Postfix authentication requests through TCP:
							</p><pre class="screen">service auth {
  inet_listener {
      port = <span class="emphasis"><em>port-number</em></span>
  }
}</pre></li><li class="listitem"><p class="simpara">
								Specify the method that the email client uses to authenticate with Dovecot by editing the <code class="literal">auth_mechanisms</code> parameter in <code class="literal">/etc/dovecot/conf.d/10-auth.conf</code> file:
							</p><pre class="screen">auth_mechanisms = plain login</pre><p class="simpara">
								The <code class="literal">auth_mechanisms</code> parameter supports different plaintext and non-plaintext authentication methods.
							</p></li></ol></div></li><li class="listitem"><p class="simpara">
						Set up Postfix by modifying the <code class="literal">/etc/postfix/main.cf</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Enable SMTP Authentication on the Postfix SMTP server:
							</p><pre class="screen">smtpd_sasl_auth_enable = yes</pre></li><li class="listitem"><p class="simpara">
								Enable the use of Dovecot SASL implementation for SMTP Authentication:
							</p><pre class="screen">smtpd_sasl_type = dovecot</pre></li><li class="listitem"><p class="simpara">
								Provide the authentication path relative to the Postfix queue directory. Note that the use of a relative path ensures that the configuration works regardless of whether the Postfix server runs in <code class="literal">chroot</code> or not:
							</p><pre class="screen">smtpd_sasl_path = private/auth</pre><p class="simpara">
								This step uses UNIX-domain sockets for communication between Postfix and Dovecot.
							</p><p class="simpara">
								To configure Postfix to look for Dovecot on a different machine in case you use TCP sockets for communication, use configuration values similar to the following:
							</p><pre class="screen">smtpd_sasl_path = inet: <span class="emphasis"><em>ip-address</em></span> : <span class="emphasis"><em>port-number</em></span></pre><p class="simpara">
								In the previous example, replace the <span class="emphasis"><em>ip-address</em></span> with the IP address of the Dovecot machine and <span class="emphasis"><em>port-number</em></span> with the port number specified in Dovecot’s <code class="literal">/etc/dovecot/conf.d/10-master.conf</code> file.
							</p></li><li class="listitem"><p class="simpara">
								Specify SASL mechanisms that the Postfix SMTP server makes available to clients. Note that you can specify different mechanisms for encrypted and unencrypted sessions.
							</p><pre class="screen">smtpd_sasl_security_options = noanonymous, noplaintext
smtpd_sasl_tls_security_options = noanonymous</pre><p class="simpara">
								The previous directives specify that during unencrypted sessions, no anonymous authentication is allowed and no mechanisms that transmit unencrypted user names or passwords are allowed. For encrypted sessions that use TLS, only non-anonymous authentication mechanisms are allowed.
							</p></li></ol></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="http://www.postfix.org/SASL_README.html#smtpd_sasl_security_options">Postfix SMTP server policy - SASL mechanism properties</a>
					</li><li class="listitem">
						<a class="link" href="https://doc.dovecot.org/configuration_manual/howto/postfix_and_dovecot_sasl/">Postfix and Dovecot SASL</a>
					</li><li class="listitem">
						<a class="link" href="http://www.postfix.org/SASL_README.html#server_sasl">Configuring SASL authentication in the Postfix SMTP server</a>
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140078480740000"><h2 class="legalnotice">Legal Notice</h2><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2024 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></body></section><!----></div></article><aside id="layout" class="span-xs-12 span-sm-2 span-md-2 content-format-selectors" aria-label="Select page format" data-v-8589d091><div class="sticky-top page-layout-options" data-v-8589d091><label for="page-format" data-v-8589d091>Format</label><select id="page-format" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div><!----></aside></div><div class="btn-container hidden" data-v-8589d091><pf-button class="top-scroll-btn" icon="angle-up" icon-set="fas" icon-position="right" data-v-8589d091>Back to top</pf-button></div><!--]--><!--]--></main><rh-footer data-analytics-region="page-footer" data-v-97dd2752><a slot="logo" href="/en" data-analytics-category="Footer" data-analytics-text="Logo" data-v-97dd2752><img alt="Red Hat logo" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" loading="lazy" width="222" height="40" data-v-97dd2752></a><rh-footer-social-link slot="social-links" icon="github" data-v-97dd2752><a href="https://github.com/redhat-documentation" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="LinkedIn" data-v-97dd2752>Github</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="reddit" data-v-97dd2752><a href="https://www.reddit.com/r/redhat/" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="YouTube" data-v-97dd2752>Reddit</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="youtube" data-v-97dd2752><a href="https://www.youtube.com/@redhat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Facebook" data-v-97dd2752>Youtube</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="twitter" data-v-97dd2752><a href="https://twitter.com/RedHat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Twitter" data-v-97dd2752>Twitter</a></rh-footer-social-link><h3 slot="links" data-analytics-text="Learn" data-v-97dd2752>Learn</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://developers.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Developer resources" data-v-97dd2752>Developer resources</a></li><li data-v-97dd2752><a href="https://cloud.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Cloud learning hub" data-v-97dd2752>Cloud learning hub</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="Footer|Learn" data-analytics-text="Interactive labs" data-v-97dd2752>Interactive labs</a></li><li data-v-97dd2752><a href="https://www.redhat.com/services/training-and-certification" data-analytics-category="Footer|Learn" data-analytics-text="Training and certification" data-v-97dd2752>Training and certification</a></li><li data-v-97dd2752><a href="https://access.redhat.com/support" data-analytics-category="Footer|Learn" data-analytics-text="Customer support" data-v-97dd2752>Customer support</a></li><li data-v-97dd2752><a href="/products" data-analytics-category="Footer|Learn" data-analytics-text="See all documentation" data-v-97dd2752>See all documentation</a></li></ul><h3 slot="links" data-analytics-text="Try buy sell" data-v-97dd2752>Try, buy, &amp; sell</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/products/trials" data-analytics-category="Footer|Try buy sell" data-analytics-text="Product trial center" data-v-97dd2752>Product trial center</a></li><li data-v-97dd2752><a href="https://marketplace.redhat.com" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Marketplace" data-v-97dd2752>Red Hat Marketplace</a></li><li data-v-97dd2752><a href="https://catalog.redhat.com/" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Ecosystem Catalog" data-v-97dd2752>Red Hat Ecosystem Catalog</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/store" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Store" data-v-97dd2752>Red Hat Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/japan-buy" data-analytics-category="Footer|Try buy sell" data-analytics-text="Buy online (Japan)" data-v-97dd2752>Buy online (Japan)</a></li></ul><h3 slot="links" data-analytics-text="Communities" data-v-97dd2752>Communities</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://access.redhat.com/community" data-analytics-category="Footer|Communities" data-analytics-text="Customer Portal Community" data-v-97dd2752>Customer Portal Community</a></li><li data-v-97dd2752><a href="https://www.redhat.com/events" data-analytics-category="Footer|Communities" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/our-community-contributions" data-analytics-category="Footer|Communities" data-analytics-text="How we contribute" data-v-97dd2752>How we contribute</a></li></ul><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat Documentation" data-v-97dd2752>About Red Hat Documentation</h3><p data-v-97dd2752>We help Red Hat users innovate and achieve their goals with our products and services with content they can trust.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="Making open source more inclusive" data-v-97dd2752>Making open source more inclusive</h3><p data-v-97dd2752>Red Hat is committed to replacing problematic language in our code, documentation, and web properties. For more details, see the <a href=" https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language" data-analytics-category="Footer|Making open source more inclusive" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a>.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</h3><p data-v-97dd2752>We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.</p></rh-footer-block><rh-footer-universal slot="universal" data-v-97dd2752><h3 slot="links-primary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-primary" data-analytics-region="page-footer-bottom-primary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/company" data-analytics-category="Footer|Corporate" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/jobs" data-analytics-category="Footer|Corporate" data-analytics-text="Jobs" data-v-97dd2752>Jobs</a></li><li data-v-97dd2752><a href="https://redhat.com/en/events" data-analytics-category="Footer|Corporate" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/office-locations" data-analytics-category="Footer|Corporate" data-analytics-text="Locations" data-v-97dd2752>Locations</a></li><li data-v-97dd2752><a href="https://redhat.com/en/contact" data-analytics-category="Footer|Corporate" data-analytics-text="Contact Red Hat" data-v-97dd2752>Contact Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/blog" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/our-culture/diversity-equity-inclusion" data-analytics-category="Footer|Corporate" data-analytics-text="Diversity equity and inclusion" data-v-97dd2752>Diversity, equity, and inclusion</a></li><li data-v-97dd2752><a href="https://coolstuff.redhat.com/" data-analytics-category="Footer|Corporate" data-analytics-text="Cool Stuff Store" data-v-97dd2752>Cool Stuff Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/summit" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Summit" data-v-97dd2752>Red Hat Summit</a></li></ul><span data-v-97dd2752 data-v-5f538988></span><rh-footer-copyright slot="links-secondary" data-v-97dd2752>© 2024 Red Hat, Inc.</rh-footer-copyright><h3 slot="links-secondary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-secondary" data-analytics-region="page-footer-bottom-secondary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/privacy-policy" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Privacy statement" data-v-97dd2752>Privacy statement</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/terms-use" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Terms of use" data-v-97dd2752>Terms of use</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/all-policies-guidelines" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="All policies and guidelines" data-v-97dd2752>All policies and guidelines</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/digital-accessibility" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Digital accessibility" class="active" data-v-97dd2752>Digital accessibility</a></li><li data-v-97dd2752><span id="teconsent" data-v-97dd2752></span></li></ul></rh-footer-universal></rh-footer><div id="consent_blackbar" style="position:fixed;bottom:0;width:100%;z-index:5;padding:10px;"></div><!--]--><!--]--></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["ShallowReactive",1],{"data":2,"state":582,"once":586,"_errors":587,"serverRendered":15,"path":589},["ShallowReactive",3],{"s8LoCEfG4A":4,"uUstF4AIyn":10,"Pn02PlJOas":510,"rFVLKcOK8e":581},[5,6,7,8,9],"fr-fr","en-us","zh-cn","ko-kr","ja-jp",{"name":11,"html":12,"type":-1,"toc":13,"breadcrumbs":433,"error":18,"title":441,"productName":435,"productVersions":450,"pagination":479,"redirect":491,"canonicalLinks":492,"openShiftProducts":494,"tocFromVolume":-1,"jumpLinks":509},"Securing networks","\u003Cbody>\u003Cdiv xml:lang=\"en-US\" class=\"book\" id=\"idm140078481333328\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv class=\"producttitle\">\u003Cspan class=\"productname\">Red Hat Enterprise Linux\u003C/span> \u003Cspan class=\"productnumber\">9\u003C/span>\u003C/div>\u003Cdiv>\u003Ch3 class=\"subtitle\">Configuring secured networks and network communication\u003C/h3>\u003C/div>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"authorgroup\">\u003Cspan class=\"orgname\">Red Hat\u003C/span> \u003Cspan class=\"orgdiv\">Customer Content Services\u003C/span>\u003C/div>\u003C/div>\u003Cdiv>\u003Ca href=\"#idm140078480740000\">Legal Notice\u003C/a>\u003C/div>\u003Cdiv>\u003Cdiv class=\"abstract\">\u003Cp class=\"title\">\u003Cstrong>Abstract\u003C/strong>\u003C/p>\u003Cdiv class=\"para\">\n\t\t\t\tLearn the tools and techniques to improve the security of your networks and lower the risks of data breaches and intrusions.\n\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003Chr/>\u003C/div>\u003Csection class=\"preface\" id=\"proc_providing-feedback-on-red-hat-documentation_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Providing feedback on Red Hat documentation\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWe appreciate your feedback on our documentation. Let us know how we can improve it.\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Submitting feedback through Jira (account required)\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLog in to the \u003Ca class=\"link\" href=\"https://issues.redhat.com/projects/RHELDOCS/issues\">Jira\u003C/a> website.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> in the top navigation bar\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter a descriptive title in the \u003Cspan class=\"strong strong\">\u003Cstrong>Summary\u003C/strong>\u003C/span> field.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter your suggestion for improvement in the \u003Cspan class=\"strong strong\">\u003Cstrong>Description\u003C/strong>\u003C/span> field. Include links to the relevant parts of the documentation.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> at the bottom of the dialogue.\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 1. Using secure communications between two systems with OpenSSH\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tSSH (Secure Shell) is a protocol which provides secure communications between two systems using a client-server architecture and allows users to log in to server host systems remotely. Unlike other remote communication protocols, such as FTP or Telnet, SSH encrypts the login session, which prevents intruders from collecting unencrypted passwords from the connection.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"ssh-and-openssh_assembly_using-secure-communications-between-two-systems-with-openssh\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.1. SSH and OpenSSH\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tSSH (Secure Shell) is a program for logging into a remote machine and executing commands on that machine. The SSH protocol provides secure encrypted communications between two untrusted hosts over an insecure network. You can also forward X11 connections and arbitrary TCP/IP ports over the secure channel.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe SSH protocol mitigates security threats, such as interception of communication between two systems and impersonation of a particular host, when you use it for remote shell login or file copying. This is because the SSH client and server use digital signatures to verify their identities. Additionally, all communication between the client and server systems is encrypted.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA host key authenticates hosts in the SSH protocol. Host keys are cryptographic keys that are generated automatically when OpenSSH is started for the first time or when the host boots for the first time.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tOpenSSH is an implementation of the SSH protocol supported by Linux, UNIX, and similar operating systems. It includes the core files necessary for both the OpenSSH client and server. The OpenSSH suite consists of the following user-space tools:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh\u003C/code> is a remote login program (SSH client).\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sshd\u003C/code> is an OpenSSH SSH daemon.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">scp\u003C/code> is a secure remote file copy program.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sftp\u003C/code> is a secure file transfer program.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh-agent\u003C/code> is an authentication agent for caching private keys.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh-add\u003C/code> adds private key identities to \u003Ccode class=\"literal\">ssh-agent\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh-keygen\u003C/code> generates, manages, and converts authentication keys for \u003Ccode class=\"literal\">ssh\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh-copy-id\u003C/code> is a script that adds local public keys to the \u003Ccode class=\"literal\">authorized_keys\u003C/code> file on a remote SSH server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh-keyscan\u003C/code> gathers SSH public host keys.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn RHEL 9, the Secure copy protocol (SCP) is replaced with the SSH File Transfer Protocol (SFTP) by default. This is because SCP has already caused security issues, for example \u003Ca class=\"link\" href=\"https://access.redhat.com/security/cve/CVE-2020-15778\">CVE-2020-15778\u003C/a>.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIf SFTP is unavailable or incompatible in your scenario, you can use the \u003Ccode class=\"literal\">scp\u003C/code> command with the \u003Ccode class=\"literal\">-O\u003C/code> option to force the use of the original SCP/RCP protocol.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tFor additional information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/6955319\">OpenSSH SCP protocol deprecation in Red Hat Enterprise Linux 9\u003C/a> article.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tThe OpenSSH suite in RHEL supports only SSH version 2. It has an enhanced key-exchange algorithm that is not vulnerable to exploits known in the older version 1.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tRed Hat Enterprise Linux includes the following \u003Ccode class=\"literal\">OpenSSH\u003C/code> packages: the general \u003Ccode class=\"literal\">openssh\u003C/code> package, the \u003Ccode class=\"literal\">openssh-server\u003C/code> package, and the \u003Ccode class=\"literal\">openssh-clients\u003C/code> package. The \u003Ccode class=\"literal\">OpenSSH\u003C/code> packages require the \u003Ccode class=\"literal\">OpenSSL\u003C/code> package \u003Ccode class=\"literal\">openssl-libs\u003C/code>, which installs several important cryptographic libraries that enable \u003Ccode class=\"literal\">OpenSSH\u003C/code> to provide encrypted communications.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tOpenSSH, as one of core cryptographic subsystems of RHEL, uses system-wide crypto policies. This ensures that weak cipher suites and cryptographic algorithms are disabled in the default configuration. To modify the policy, the administrator must either use the \u003Ccode class=\"literal\">update-crypto-policies\u003C/code> command to adjust the settings or manually opt out of the system-wide crypto policies. See the \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening#excluding-an-application-from-following-the-system-wide-crypto-policies_using-the-system-wide-cryptographic-policies\">Excluding an application from following system-wide crypto policies\u003C/a> section for more information.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe OpenSSH suite uses two sets of configuration files: one for client programs (that is, \u003Ccode class=\"literal\">ssh\u003C/code>, \u003Ccode class=\"literal\">scp\u003C/code>, and \u003Ccode class=\"literal\">sftp\u003C/code>), and another for the server (the \u003Ccode class=\"literal\">sshd\u003C/code> daemon).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSystem-wide SSH configuration information is stored in the \u003Ccode class=\"literal\">/etc/ssh/\u003C/code> directory. The \u003Ccode class=\"literal\">/etc/ssh/ssh_config\u003C/code> file contains the client configuration, and the \u003Ccode class=\"literal\">/etc/ssh/sshd_config\u003C/code> file is the default OpenSSH server configuration file.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUser-specific SSH configuration information is stored in \u003Ccode class=\"literal\">~/.ssh/\u003C/code> in the user’s home directory. For a detailed list of OpenSSH configuration files, see the \u003Ccode class=\"literal\">FILES\u003C/code> section in the \u003Ccode class=\"literal\">sshd(8)\u003C/code> man page on your system.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMan pages listed by using the \u003Ccode class=\"literal\">man -k ssh\u003C/code> command on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">Using system-wide cryptographic policies\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.2. Generating SSH key pairs\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can log in to an OpenSSH server without entering a password by generating an SSH key pair on a local system and copying the generated public key to the OpenSSH server. Each user who wants to create a key must run this procedure.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo preserve previously generated key pairs after you reinstall the system, back up the \u003Ccode class=\"literal\">~/.ssh/\u003C/code> directory before you create new keys. After reinstalling, copy it back to your home directory. You can do this for all users on your system, including \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as a user who wants to connect to the OpenSSH server by using keys.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe OpenSSH server is configured to allow key-based authentication.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate an ECDSA key pair:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-keygen -t ecdsa\u003C/strong>\u003C/span>\nGenerating public/private ecdsa key pair.\nEnter file in which to save the key (/home/\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>/.ssh/id_ecdsa):\nEnter passphrase (empty for no passphrase): \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\nEnter same passphrase again: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\nYour identification has been saved in /home/\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>/.ssh/id_ecdsa.\nYour public key has been saved in /home/\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>/.ssh/id_ecdsa.pub.\nThe key fingerprint is:\nSHA256:Q/x+qms4j7PCQ0qFd09iZEFHA+SqwBKRNaU72oZfaCI \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;localhost.example.com&gt;\u003C/em>\u003C/span>\nThe key's randomart image is:\n+---[ECDSA 256]---+\n|.oo..o=++        |\n|.. o .oo .       |\n|. .. o. o        |\n|....o.+...       |\n|o.oo.o +S .      |\n|.=.+.   .o       |\n|E.*+.  .  . .    |\n|.=..+ +..  o     |\n|  .  oo*+o.      |\n+----[SHA256]-----+\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can also generate an RSA key pair by using the \u003Ccode class=\"literal\">ssh-keygen\u003C/code> command without any parameter or an Ed25519 key pair by entering the \u003Ccode class=\"literal\">ssh-keygen -t ed25519\u003C/code> command. Note that the Ed25519 algorithm is not FIPS-140-compliant, and OpenSSH does not work with Ed25519 keys in FIPS mode.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the public key to a remote machine:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-copy-id \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>'s password:\n…\nNumber of key(s) added: 1\n\nNow try logging into the machine, with: \"ssh '\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>'\" and check to make sure that only the key(s) you wanted were added.\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/code> with your credentials.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you do not use the \u003Ccode class=\"literal\">ssh-agent\u003C/code> program in your session, the previous command copies the most recently modified \u003Ccode class=\"literal\">~/.ssh/id*.pub\u003C/code> public key if it is not yet installed. To specify another public-key file or to prioritize keys in files over keys cached in memory by \u003Ccode class=\"literal\">ssh-agent\u003C/code>, use the \u003Ccode class=\"literal\">ssh-copy-id\u003C/code> command with the \u003Ccode class=\"literal\">-i\u003C/code> option.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the OpenSSH server by using the key file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -o PreferredAuthentications=publickey \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh-keygen(1)\u003C/code> and \u003Ccode class=\"literal\">ssh-copy-id(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-an-openssh-server-for-key-based-authentication_assembly_using-secure-communications-between-two-systems-with-openssh\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.3. Setting key-based authentication as the only method on an OpenSSH server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo improve system security, enforce key-based authentication by disabling password authentication on your OpenSSH server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">openssh-server\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">sshd\u003C/code> daemon is running on the server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can already connect to the OpenSSH server by using a key.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSee the \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh\">Generating SSH key pairs\u003C/a> section for details.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/ssh/sshd_config\u003C/code> configuration in a text editor, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>vi /etc/ssh/sshd_config\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">PasswordAuthentication\u003C/code> option to \u003Ccode class=\"literal\">no\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">PasswordAuthentication no\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn a system other than a new default installation, check that the \u003Ccode class=\"literal\">PubkeyAuthentication\u003C/code> parameter is either not set or set to \u003Ccode class=\"literal\">yes\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">KbdInteractiveAuthentication\u003C/code> directive to \u003Ccode class=\"literal\">no\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that the corresponding entry is commented out in the configuration file and the default value is \u003Ccode class=\"literal\">yes\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo use key-based authentication with NFS-mounted home directories, enable the \u003Ccode class=\"literal\">use_nfs_home_dirs\u003C/code> SELinux boolean:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>setsebool -P use_nfs_home_dirs 1\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf you are connected remotely, not using console or out-of-band access, test the key-based login process before disabling password authentication.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReload the \u003Ccode class=\"literal\">sshd\u003C/code> daemon to apply the changes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl reload sshd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sshd_config(5)\u003C/code> and \u003Ccode class=\"literal\">setsebool(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.4. Caching your SSH credentials by using ssh-agent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo avoid entering a passphrase each time you initiate an SSH connection, you can use the \u003Ccode class=\"literal\">ssh-agent\u003C/code> utility to cache the private SSH key for a login session. If the agent is running and your keys are unlocked, you can log in to SSH servers by using these keys but without having to enter the key’s password again. The private key and the passphrase remain secure.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have a remote host with the SSH daemon running and reachable through the network.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IP address or hostname and credentials to log in to the remote host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have generated an SSH key pair with a passphrase and transferred the public key to the remote machine.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSee the \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh\">Generating SSH key pairs\u003C/a> section for details.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the command for automatically starting \u003Ccode class=\"literal\">ssh-agent\u003C/code> in your session to the \u003Ccode class=\"literal\">~/.bashrc\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOpen \u003Ccode class=\"literal\">~/.bashrc\u003C/code> in a text editor of your choice, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vi ~/.bashrc\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the following line to the file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">eval $(ssh-agent)\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and quit the editor.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the following line to the \u003Ccode class=\"literal\">~/.ssh/config\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">AddKeysToAgent yes\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWith this option and \u003Ccode class=\"literal\">ssh-agent\u003C/code> started in your session, the agent prompts for a password only for the first time when you connect to a host.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to a host which uses the corresponding public key of the cached private key in the agent, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh \u003Cspan class=\"emphasis\">\u003Cem>&lt;example.user&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server@example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that you did not have to enter the passphrase.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ssh-keys-stored-on-a-smart-card_assembly_using-secure-communications-between-two-systems-with-openssh\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.5. Authenticating by SSH keys stored on a smart card\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can create and store ECDSA and RSA keys on a smart card and authenticate by the smart card on an OpenSSH client. Smart-card authentication replaces the default password authentication.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn the client side, the \u003Ccode class=\"literal\">opensc\u003C/code> package is installed and the \u003Ccode class=\"literal\">pcscd\u003C/code> service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList all keys provided by the OpenSC PKCS #11 module including their PKCS #11 URIs and save the output to the \u003Ccode class=\"literal\">keys.pub\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-keygen -D pkcs11: &gt; keys.pub\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTransfer the public key to the remote server. Use the \u003Ccode class=\"literal\">ssh-copy-id\u003C/code> command with the \u003Ccode class=\"literal\">keys.pub\u003C/code> file created in the previous step:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-copy-id -f -i keys.pub \u003Cspan class=\"emphasis\">\u003Cem>&lt;username@ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConnect to \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span> by using the ECDSA key. You can use just a subset of the URI, which uniquely references your key, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -i \"pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so\" \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter PIN for 'SSH key':\n[ssh-server-example.com] $\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBecause OpenSSH uses the \u003Ccode class=\"literal\">p11-kit-proxy\u003C/code> wrapper and the OpenSC PKCS #11 module is registered to the \u003Ccode class=\"literal\">p11-kit\u003C/code> tool, you can simplify the previous command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -i \"pkcs11:id=%01\" \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter PIN for 'SSH key':\n[ssh-server-example.com] $\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you skip the \u003Ccode class=\"literal\">id=\u003C/code> part of a PKCS #11 URI, OpenSSH loads all keys that are available in the proxy module. This can reduce the amount of typing required:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -i pkcs11: \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter PIN for 'SSH key':\n[ssh-server-example.com] $\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: You can use the same URI string in the \u003Ccode class=\"literal\">~/.ssh/config\u003C/code> file to make the configuration permanent:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat ~/.ssh/config\u003C/strong>\u003C/span>\nIdentityFile \"pkcs11:id=%01?module-path=/usr/lib64/pkcs11/opensc-pkcs11.so\"\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh \u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh-server-example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nEnter PIN for 'SSH key':\n[ssh-server-example.com] $\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ssh\u003C/code> client utility now automatically uses this URI and the key from the smart card.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">p11-kit(8)\u003C/code>, \u003Ccode class=\"literal\">opensc.conf(5)\u003C/code>, \u003Ccode class=\"literal\">pcscd(8)\u003C/code>, \u003Ccode class=\"literal\">ssh(1)\u003C/code>, and \u003Ccode class=\"literal\">ssh-keygen(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"making-openssh-more-secure_assembly_using-secure-communications-between-two-systems-with-openssh\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.6. Making OpenSSH more secure\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can tweak the system to increase security when using OpenSSH.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNote that changes in the \u003Ccode class=\"literal\">/etc/ssh/sshd_config\u003C/code> OpenSSH server configuration file require reloading the \u003Ccode class=\"literal\">sshd\u003C/code> daemon to take effect:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl reload sshd\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe majority of security hardening configuration changes reduce compatibility with clients that do not support up-to-date algorithms or cipher suites.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Disabling insecure connection protocols\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tTo make SSH truly effective, prevent the use of insecure connection protocols that are replaced by the OpenSSH suite. Otherwise, a user’s password might be protected using SSH for one session only to be captured later when logging in using Telnet.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Disabling password-based authentication\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDisabling passwords for authentication and allowing only key pairs reduces the attack surface. See the \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks#setting-an-openssh-server-for-key-based-authentication_assembly_using-secure-communications-between-two-systems-with-openssh\">Setting key-based authentication as the only method on an OpenSSH server\u003C/a> section for more information.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Stronger key types\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAlthough the \u003Ccode class=\"literal\">ssh-keygen\u003C/code> command generates a pair of RSA keys by default, you can instruct it to generate Elliptic Curve Digital Signature Algorithm (ECDSA) or Edwards-Curve 25519 (Ed25519) keys by using the \u003Ccode class=\"literal\">-t\u003C/code> option. The ECDSA offers better performance than RSA at the equivalent symmetric key strength. It also generates shorter keys. The Ed25519 public-key algorithm is an implementation of twisted Edwards curves that is more secure and also faster than RSA, DSA, and ECDSA.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOpenSSH creates RSA, ECDSA, and Ed25519 server host keys automatically if they are missing. To configure the host key creation in RHEL, use the \u003Ccode class=\"literal\">sshd-keygen@.service\u003C/code> instantiated service. For example, to disable the automatic creation of the RSA key type:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl mask sshd-keygen@rsa.service\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm -f /etc/ssh/ssh_host_rsa_key\u003C/strong>\u003C/span>*\n# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sshd\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tIn images with the \u003Ccode class=\"literal\">cloud-init\u003C/code> method enabled, the \u003Ccode class=\"literal\">ssh-keygen\u003C/code> units are automatically disabled. This is because the \u003Ccode class=\"literal\">ssh-keygen template\u003C/code> service can interfere with the \u003Ccode class=\"literal\">cloud-init\u003C/code> tool and cause problems with host key generation. To prevent these problems the \u003Ccode class=\"literal\">etc/systemd/system/sshd-keygen@.service.d/disable-sshd-keygen-if-cloud-init-active.conf\u003C/code> drop-in configuration file disables the \u003Ccode class=\"literal\">ssh-keygen\u003C/code> units if \u003Ccode class=\"literal\">cloud-init\u003C/code> is running.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo allow only a particular key type for SSH connections, remove a comment out at the beginning of the relevant line in \u003Ccode class=\"literal\">/etc/ssh/sshd_config\u003C/code>, and reload the \u003Ccode class=\"literal\">sshd\u003C/code> service. For example, to allow only Ed25519 host keys, the corresponding lines must be as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># HostKey /etc/ssh/ssh_host_rsa_key\n# HostKey /etc/ssh/ssh_host_ecdsa_key\nHostKey /etc/ssh/ssh_host_ed25519_key\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tThe Ed25519 algorithm is not FIPS-140-compliant, and OpenSSH does not work with Ed25519 keys in FIPS mode.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Non-default port\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default, the \u003Ccode class=\"literal\">sshd\u003C/code> daemon listens on TCP port 22. Changing the port reduces the exposure of the system to attacks based on automated network scanning on the default port and therefore increases security through obscurity. You can specify the port using the \u003Ccode class=\"literal\">Port\u003C/code> directive in the \u003Ccode class=\"literal\">/etc/ssh/sshd_config\u003C/code> configuration file.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou also have to update the default SELinux policy to allow the use of a non-default port. To do so, use the \u003Ccode class=\"literal\">semanage\u003C/code> tool from the \u003Ccode class=\"literal\">policycoreutils-python-utils\u003C/code> package:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>semanage port -a -t ssh_port_t -p tcp \u003Cspan class=\"emphasis\">\u003Cem>&lt;port-number&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFurthermore, update \u003Ccode class=\"literal\">firewalld\u003C/code> configuration:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-port \u003Cspan class=\"emphasis\">\u003Cem>&lt;port-number&gt;\u003C/em>\u003C/span>/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --remove-port=22/tcp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn the previous commands, replace \u003Cspan class=\"emphasis\">\u003Cem>&lt;port-number&gt;\u003C/em>\u003C/span> with the new port number specified using the \u003Ccode class=\"literal\">Port\u003C/code> directive.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Root login\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">PermitRootLogin\u003C/code> is set to \u003Ccode class=\"literal\">prohibit-password\u003C/code> by default. This enforces the use of key-based authentication instead of the use of passwords for logging in as root and reduces risks by preventing brute-force attacks.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tEnabling logging in as the root user is not a secure practice because the administrator cannot audit which users run which privileged commands. For using administrative commands, log in and use \u003Ccode class=\"literal\">sudo\u003C/code> instead.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Using the X Security extension\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe X server in Red Hat Enterprise Linux clients does not provide the X Security extension. Therefore, clients cannot request another security layer when connecting to untrusted SSH servers with X11 forwarding. Most applications are not able to run with this extension enabled anyway.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBy default, the \u003Ccode class=\"literal\">ForwardX11Trusted\u003C/code> option in the \u003Ccode class=\"literal\">/etc/ssh/ssh_config.d/50-redhat.conf\u003C/code> file is set to \u003Ccode class=\"literal\">yes\u003C/code>, and there is no difference between the \u003Ccode class=\"literal\">ssh -X remote_machine\u003C/code> (untrusted host) and \u003Ccode class=\"literal\">ssh -Y remote_machine\u003C/code> (trusted host) command.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf your scenario does not require the X11 forwarding feature at all, set the \u003Ccode class=\"literal\">X11Forwarding\u003C/code> directive in the \u003Ccode class=\"literal\">/etc/ssh/sshd_config\u003C/code> configuration file to \u003Ccode class=\"literal\">no\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Restricting SSH access to specific users, groups, or IP ranges\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">AllowUsers\u003C/code> and \u003Ccode class=\"literal\">AllowGroups\u003C/code> directives in the \u003Ccode class=\"literal\">/etc/ssh/sshd_config\u003C/code> configuration file server enable you to permit only certain users, domains, or groups to connect to your OpenSSH server. You can combine \u003Ccode class=\"literal\">AllowUsers\u003C/code> and \u003Ccode class=\"literal\">AllowGroups\u003C/code> to restrict access more precisely, for example:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">AllowUsers *@192.168.1.* *@10.0.0.* !*@192.168.1.2\nAllowGroups example-group\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis configuration allows only connections if all of the following conditions meet:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe connection’s source IP is within the 192.168.1.0/24 or 10.0.0.0/24 subnet.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe source IP is not 192.168.1.2.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe user is a member of the example-group group.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe OpenSSH server permits only connections that pass all Allow and Deny directives in \u003Ccode class=\"literal\">/etc/ssh/sshd_config\u003C/code>. For example, if the \u003Ccode class=\"literal\">AllowUsers\u003C/code> directive lists a user that is not part of a group listed in the \u003Ccode class=\"literal\">AllowGroups\u003C/code> directive, then the user cannot log in.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that using allowlists (directives starting with Allow) is more secure than using blocklists (options starting with Deny) because allowlists block also new unauthorized users or groups.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Changing system-wide cryptographic policies\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOpenSSH uses RHEL system-wide cryptographic policies, and the default system-wide cryptographic policy level offers secure settings for current threat models. To make your cryptographic settings more strict, change the current policy level:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>update-crypto-policies --set FUTURE\u003C/strong>\u003C/span>\nSetting system policy to FUTURE\u003C/pre>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tIf your system communicates with legacy systems, you might face interoperability problems due to the strict setting of the \u003Ccode class=\"literal\">FUTURE\u003C/code> policy.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tYou can also disable only specific ciphers for the SSH protocol through the system-wide cryptographic policies. See the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening#customizing-system-wide-cryptographic-policies-with-subpolicies_using-the-system-wide-cryptographic-policies\">Customizing system-wide cryptographic policies with subpolicies\u003C/a> section in the Security hardening document for more information.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Opting out of system-wide cryptographic policies\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo opt out of the system-wide cryptographic policies for your OpenSSH server, specify the cryptographic policy in a drop-in configuration file located in the \u003Ccode class=\"literal\">/etc/ssh/sshd_config.d/\u003C/code> directory, with a two-digit number prefix smaller than 50, so that it lexicographically precedes the \u003Ccode class=\"literal\">50-redhat.conf\u003C/code> file, and with a \u003Ccode class=\"literal\">.conf\u003C/code> suffix, for example, \u003Ccode class=\"literal\">49-crypto-policy-override.conf\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">sshd_config(5)\u003C/code> man page for more information.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo opt out of system-wide cryptographic policies for your OpenSSH client, perform one of the following tasks:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tFor a given user, override the global \u003Ccode class=\"literal\">ssh_config\u003C/code> with a user-specific configuration in the \u003Ccode class=\"literal\">~/.ssh/config\u003C/code> file.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tFor the entire system, specify the cryptographic policy in a drop-in configuration file located in the \u003Ccode class=\"literal\">/etc/ssh/ssh_config.d/\u003C/code> directory, with a two-digit number prefix smaller than 50, so that it lexicographically precedes the \u003Ccode class=\"literal\">50-redhat.conf\u003C/code> file, and with a \u003Ccode class=\"literal\">.conf\u003C/code> suffix, for example, \u003Ccode class=\"literal\">49-crypto-policy-override.conf\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sshd_config(5)\u003C/code>, \u003Ccode class=\"literal\">ssh-keygen(1)\u003C/code>, \u003Ccode class=\"literal\">crypto-policies(7)\u003C/code>, and \u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">Using system-wide cryptographic policies\u003C/a> in the Security hardening document\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/4410591\">How to disable specific algorithms and ciphers for ssh service only\u003C/a> (Red Hat Knowledgebase)\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"connecting-to-a-remote-server-using-an-ssh-jump-host_assembly_using-secure-communications-between-two-systems-with-openssh\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.7. Connecting to a remote server through an SSH jump host\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can connect from your local system to a remote server through an intermediary server, also called jump host. A jump server bridges hosts from different security zones and can manage multiple client-server connections.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA jump host accepts SSH connections from your local system.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA remote server accepts SSH connections from the jump host.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you connect through a jump server or more intermediary servers once, use the \u003Ccode class=\"literal\">ssh -J\u003C/code> command and specify the jump servers directly, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -J \u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-1.example.com&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-2.example.com&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-3.example.com&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;target-server-1.example.com&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the host name-only notation in the previous command if the user names or SSH ports on the jump servers differ from the names and ports on the remote server, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -J \u003Cspan class=\"emphasis\">\u003Cem>&lt;example.user.1&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-1.example.com&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;75&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;example.user.2&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-2.example.com&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;75&gt;\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>&lt;example.user.3&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-3.example.com&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;75&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;example.user.f&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;target-server-1.example.com&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;220&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you connect to a remote server through jump servers regularly, store the jump-server configuration in your SSH configuration file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDefine the jump host by editing the \u003Ccode class=\"literal\">~/.ssh/config\u003C/code> file on your local system, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Host \u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-server-1&gt;\u003C/em>\u003C/span>\n  HostName \u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-1.example.com&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">Host\u003C/code> parameter defines a name or alias for the host you can use in \u003Ccode class=\"literal\">ssh\u003C/code> commands. The value can match the real host name, but can also be any string.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">HostName\u003C/code> parameter sets the actual host name or IP address of the jump host.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the remote server jump configuration with the \u003Ccode class=\"literal\">ProxyJump\u003C/code> directive to \u003Ccode class=\"literal\">~/.ssh/config\u003C/code> file on your local system, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Host \u003Cspan class=\"emphasis\">\u003Cem>&lt;remote-server-1&gt;\u003C/em>\u003C/span>\n  HostName \u003Cspan class=\"emphasis\">\u003Cem>&lt;target-server-1.example.com&gt;\u003C/em>\u003C/span>\n  ProxyJump \u003Cspan class=\"emphasis\">\u003Cem>&lt;jump-server-1&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse your local system to connect to the remote server through the jump server:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh \u003Cspan class=\"emphasis\">\u003Cem>&lt;remote-server-1&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis command is equivalent to the \u003Ccode class=\"literal\">ssh -J jump-server1 remote-server\u003C/code> command if you omit the previous configuration steps.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ssh_config(5)\u003C/code> and \u003Ccode class=\"literal\">ssh(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.8. Configuring secure communication with the \u003Ccode class=\"literal\">ssh\u003C/code> system roles\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs an administrator, you can use the \u003Ccode class=\"literal\">sshd\u003C/code> system role to configure SSH servers and the \u003Ccode class=\"literal\">ssh\u003C/code> system role to configure SSH clients consistently on any number of RHEL systems at the same time using the Ansible Core package.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"sshd-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">1.8.1. Variables of the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tIn an \u003Ccode class=\"literal\">sshd\u003C/code> system role playbook, you can define the parameters for the SSH configuration file according to your preferences and limitations.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIf you do not configure these variables, the system role produces an \u003Ccode class=\"literal\">sshd_config\u003C/code> file that matches the RHEL defaults.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIn all cases, Booleans correctly render as \u003Ccode class=\"literal\">yes\u003C/code> and \u003Ccode class=\"literal\">no\u003C/code> in \u003Ccode class=\"literal\">sshd\u003C/code> configuration. You can define multi-line configuration items using lists. For example:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">sshd_ListenAddress:\n  - 0.0.0.0\n  - '::'\u003C/pre>\u003Cp>\n\t\t\t\t\trenders as:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">ListenAddress 0.0.0.0\nListenAddress ::\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/sshd/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-with-the-ssh-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">1.8.2. Configuring OpenSSH servers by using the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role to configure multiple SSH servers by running an Ansible playbook.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role with other RHEL system roles that change SSH and SSHD configuration, for example the Identity Management RHEL system roles. To prevent the configuration from being overwritten, make sure that the \u003Ccode class=\"literal\">sshd\u003C/code> role uses namespaces (RHEL 8 and earlier versions) or a drop-in directory (RHEL 9).\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: SSH server configuration\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: Configure sshd to prevent root and password login except from particular subnet\n      ansible.builtin.include_role:\n        name: rhel-system-roles.sshd\n      vars:\n        sshd:\n          PermitRootLogin: no\n          PasswordAuthentication: no\n          Match:\n            - Condition: \"Address 192.0.2.0/24\"\n              PermitRootLogin: yes\n              PasswordAuthentication: yes\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe playbook configures the managed node as an SSH server configured so that:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tpassword and \u003Ccode class=\"literal\">root\u003C/code> user login is disabled\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tpassword and \u003Ccode class=\"literal\">root\u003C/code> user login is enabled only from the subnet \u003Ccode class=\"literal\">192.0.2.0/24\u003C/code>\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tLog in to the SSH server:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh \u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh_server&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify the contents of the \u003Ccode class=\"literal\">sshd_config\u003C/code> file on the SSH server:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ssh/sshd_config.d/00-ansible_system_role.conf\u003C/strong>\u003C/span>\n#\n# Ansible managed\n#\nPasswordAuthentication no\nPermitRootLogin no\nMatch Address 192.0.2.0/24\n  PasswordAuthentication yes\n  PermitRootLogin yes\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCheck that you can connect to the server as root from the \u003Ccode class=\"literal\">192.0.2.0/24\u003C/code> subnet:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tDetermine your IP address:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>hostname -I\u003C/strong>\u003C/span>\n192.0.2.1\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf the IP address is within the \u003Ccode class=\"literal\">192.0.2.1\u003C/code> - \u003Ccode class=\"literal\">192.0.2.254\u003C/code> range, you can connect to the server.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tConnect to the server as \u003Ccode class=\"literal\">root\u003C/code>:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh root@\u003Cspan class=\"emphasis\">\u003Cem>&lt;ssh_server&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/sshd/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_ssh-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">1.8.3. Variables of the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tIn an \u003Ccode class=\"literal\">ssh\u003C/code> system role playbook, you can define the parameters for the client SSH configuration file according to your preferences and limitations.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIf you do not configure these variables, the system role produces a global \u003Ccode class=\"literal\">ssh_config\u003C/code> file that matches the RHEL defaults.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIn all cases, booleans correctly render as \u003Ccode class=\"literal\">yes\u003C/code> or \u003Ccode class=\"literal\">no\u003C/code> in \u003Ccode class=\"literal\">ssh\u003C/code> configuration. You can define multi-line configuration items using lists. For example:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">LocalForward:\n  - 22 localhost:2222\n  - 403 localhost:4003\u003C/pre>\u003Cp>\n\t\t\t\t\trenders as:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">LocalForward 22 localhost:2222\nLocalForward 403 localhost:4003\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe configuration options are case sensitive.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ssh/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-with-the-ssh-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">1.8.4. Configuring OpenSSH clients by using the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role to configure multiple SSH clients by running an Ansible playbook.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">ssh\u003C/code> RHEL system role with other system roles that change SSH and SSHD configuration, for example the Identity Management RHEL system roles. To prevent the configuration from being overwritten, make sure that the \u003Ccode class=\"literal\">ssh\u003C/code> role uses a drop-in directory (default in RHEL 8 and later).\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: SSH client configuration\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: \"Configure ssh clients\"\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ssh\n      vars:\n        ssh_user: root\n        ssh:\n          Compression: true\n          GSSAPIAuthentication: no\n          ControlMaster: auto\n          ControlPath: ~/.ssh/.cm%C\n          Host:\n            - Condition: example\n              Hostname: server.example.com\n              User: user1\n        ssh_ForwardX11: no\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis playbook configures the \u003Ccode class=\"literal\">root\u003C/code> user’s SSH client preferences on the managed nodes with the following configurations:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tCompression is enabled.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tControlMaster multiplexing is set to \u003Ccode class=\"literal\">auto\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">example\u003C/code> alias for connecting to the \u003Ccode class=\"literal\">server.example.com\u003C/code> host is \u003Ccode class=\"literal\">user1\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">example\u003C/code> host alias is created, which represents a connection to the \u003Ccode class=\"literal\">server.example.com\u003C/code> host the with the \u003Ccode class=\"literal\">user1\u003C/code> user name.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tX11 forwarding is disabled.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify that the managed node has the correct configuration by displaying the SSH configuration file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat ~/root/.ssh/config\u003C/strong>\u003C/span>\n# Ansible managed\nCompression yes\nControlMaster auto\nControlPath ~/.ssh/.cm%C\nForwardX11 no\nGSSAPIAuthentication no\nHost example\n  Hostname example.com\n  User user1\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ssh/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ssh/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-with-the-ssh-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">1.8.5. Using the \u003Ccode class=\"literal\">sshd\u003C/code> RHEL system role for non-exclusive configuration\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tNormally, applying the \u003Ccode class=\"literal\">sshd\u003C/code> system role overwrites the entire configuration. This may be problematic if you have previously adjusted the configuration, for example, with a different system role or playbook. To apply the \u003Ccode class=\"literal\">sshd\u003C/code> system role for only selected configuration options while keeping other options in place, you can use the non-exclusive configuration.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tYou can apply a non-exclusive configuration:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn RHEL 8 and earlier by using a configuration snippet.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIn RHEL 9 and later by using files in a drop-in directory. The default configuration file is already placed in the drop-in directory as \u003Ccode class=\"literal\">/etc/ssh/sshd_config.d/00-ansible_system_role.conf\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor managed nodes that run RHEL 8 or earlier:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Non-exclusive sshd configuration\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Configure SSHD to accept some useful environment variables&gt;\u003C/em>\u003C/span>\n      ansible.builtin.include_role:\n        name: rhel-system-roles.sshd\n      vars:\n        sshd_config_namespace: \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-application&gt;\u003C/em>\u003C/span>\n        sshd:\n          # Environment variables to accept\n          AcceptEnv:\n            LANG\n            LS_COLORS\n            EDITOR\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor managed nodes that run RHEL 9 or later:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Non-exclusive sshd configuration\n  hosts: managed-node-01.example.com\n  tasks:\n    - name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Configure sshd to accept some useful environment variables&gt;\u003C/em>\u003C/span>\n      ansible.builtin.include_role:\n        name: rhel-system-roles.sshd\n      vars:\n        sshd_config_file: /etc/ssh/sshd_config.d/\u003Cspan class=\"emphasis\">\u003Cem>&lt;42-my-application&gt;\u003C/em>\u003C/span>.conf\n        sshd:\n          # Environment variables to accept\n          AcceptEnv:\n            LANG\n            LS_COLORS\n            EDITOR\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">sshd_config_file\u003C/code> variable, define the \u003Ccode class=\"literal\">.conf\u003C/code> file into which the \u003Ccode class=\"literal\">sshd\u003C/code> system role writes the configuration options. Use a two-digit prefix, for example \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>42-\u003C/em>\u003C/span>\u003C/code> to specify the order in which the configuration files will be applied.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify the configuration on the SSH server:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor managed nodes that run RHEL 8 or earlier:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ssh/sshd_config.d/42-my-application.conf\u003C/strong>\u003C/span>\n# Ansible managed\n#\nAcceptEnv LANG LS_COLORS EDITOR\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor managed nodes that run RHEL 9 or later:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ssh/sshd_config\u003C/strong>\u003C/span>\n...\n# BEGIN sshd system role managed block: namespace \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-application&gt;\u003C/em>\u003C/span>\nMatch all\n  AcceptEnv LANG LS_COLORS EDITOR\n# END sshd system role managed block: namespace \u003Cspan class=\"emphasis\">\u003Cem>&lt;my-application&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.sshd/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/sshd/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">1.9. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">sshd(8)\u003C/code>, \u003Ccode class=\"literal\">ssh(1)\u003C/code>, \u003Ccode class=\"literal\">scp(1)\u003C/code>, \u003Ccode class=\"literal\">sftp(1)\u003C/code>, \u003Ccode class=\"literal\">ssh-keygen(1)\u003C/code>, \u003Ccode class=\"literal\">ssh-copy-id(1)\u003C/code>, \u003Ccode class=\"literal\">ssh_config(5)\u003C/code>, \u003Ccode class=\"literal\">sshd_config(5)\u003C/code>, \u003Ccode class=\"literal\">update-crypto-policies(8)\u003C/code>, and \u003Ccode class=\"literal\">crypto-policies(7)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/configuring-selinux-for-applications-and-services-with-non-standard-configurations_using-selinux\">Configuring SELinux for applications and services with non-standard configurations\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters#controlling-network-traffic-using-firewalld_using-and-configuring-firewalld\">Controlling network traffic using firewalld\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"creating-and-managing-tls-keys-and-certificates_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 2. Creating and managing TLS keys and certificates\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tYou can encrypt communication transmitted between two systems by using the TLS (Transport Layer Security) protocol. This standard uses asymmetric cryptography with private and public keys, digital signatures, and certificates.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"con_tls-certificates_creating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.1. TLS certificates\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTLS (Transport Layer Security) is a protocol that enables client-server applications to pass information securely. TLS uses a system of public and private key pairs to encrypt communication transmitted between clients and servers. TLS is the successor protocol to SSL (Secure Sockets Layer).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTLS uses X.509 certificates to bind identities, such as hostnames or organizations, to public keys using digital signatures. X.509 is a standard that defines the format of public key certificates.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAuthentication of a secure application depends on the integrity of the public key value in the application’s certificate. If an attacker replaces the public key with its own public key, it can impersonate the true application and gain access to secure data. To prevent this type of attack, all certificates must be signed by a certification authority (CA). A CA is a trusted node that confirms the integrity of the public key value in a certificate.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA CA signs a public key by adding its digital signature and issues a certificate. A digital signature is a message encoded with the CA’s private key. The CA’s public key is made available to applications by distributing the certificate of the CA. Applications verify that certificates are validly signed by decoding the CA’s digital signature with the CA’s public key.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo have a certificate signed by a CA, you must generate a public key, and send it to a CA for signing. This is referred to as a certificate signing request (CSR). A CSR contains also a distinguished name (DN) for the certificate. The DN information that you can provide for either type of certificate can include a two-letter country code for your country, a full name of your state or province, your city or town, a name of your organization, your email address, and it can also be empty. Many current commercial CAs prefer the Subject Alternative Name extension and ignore DNs in CSRs.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tRHEL provides two main toolkits for working with TLS certificates: GnuTLS and OpenSSL. You can create, read, sign, and verify certificates using the \u003Ccode class=\"literal\">openssl\u003C/code> utility from the \u003Ccode class=\"literal\">openssl\u003C/code> package. The \u003Ccode class=\"literal\">certtool\u003C/code> utility provided by the \u003Ccode class=\"literal\">gnutls-utils\u003C/code> package can do the same operations using a different syntax and above all a different set of libraries in the back end.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://datatracker.ietf.org/doc/html/rfc5280\">RFC 5280: Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">openssl(1)\u003C/code>, \u003Ccode class=\"literal\">x509(1)\u003C/code>, \u003Ccode class=\"literal\">ca(1)\u003C/code>, \u003Ccode class=\"literal\">req(1)\u003C/code>, and \u003Ccode class=\"literal\">certtool(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-private-ca-using-openssl_creating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.2. Creating a private CA using OpenSSL\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPrivate certificate authorities (CA) are useful when your scenario requires verifying entities within your internal network. For example, use a private CA when you create a VPN gateway with authentication based on certificates signed by a CA under your control or when you do not want to pay a commercial CA. To sign certificates in such use cases, the private CA uses a self-signed certificate.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> privileges or permissions to enter administrative commands with \u003Ccode class=\"literal\">sudo\u003C/code>. Commands that require such privileges are marked with \u003Ccode class=\"literal\">#\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a private key for your CA. For example, the following command creates a 256-bit Elliptic Curve Digital Signature Algorithm (ECDSA) key:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl genpkey -algorithm ec -pkeyopt ec_paramgen_curve:P-256 -out \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe time for the key-generation process depends on the hardware and entropy of the host, the selected algorithm, and the length of the key.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a certificate signed using the private key generated in the previous command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -key \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span> -new -x509 -days 3650 -addext keyUsage=critical,keyCertSign,cRLSign -subj \"/CN=\u003Cspan class=\"emphasis\">\u003Cem>&lt;Example CA&gt;\u003C/em>\u003C/span>\" -out \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe generated \u003Ccode class=\"literal\">ca.crt\u003C/code> file is a self-signed CA certificate that you can use to sign other certificates for ten years. In the case of a private CA, you can replace \u003Cspan class=\"emphasis\">\u003Cem>&lt;Example CA&gt;\u003C/em>\u003C/span> with any string as the common name (CN).\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet secure permissions on the private key of your CA, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chown \u003Cspan class=\"emphasis\">\u003Cem>&lt;root&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;root&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>chmod 600 \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo use a self-signed CA certificate as a trust anchor on client systems, copy the CA certificate to the client and add it to the clients' system-wide truststore as \u003Ccode class=\"literal\">root\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>trust anchor \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSee \u003Ca class=\"xref\" href=\"#using-shared-system-certificates_securing-networks\" title=\"Chapter 3. Using shared system certificates\">Chapter 3, \u003Cem>Using shared system certificates\u003C/em>\u003C/a> for more information.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a certificate signing request (CSR), and use your CA to sign the request. The CA must successfully create a certificate based on the CSR, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -req -in \u003Cspan class=\"emphasis\">\u003Cem>&lt;client-cert.csr&gt;\u003C/em>\u003C/span> -CA \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span> -CAkey \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span> -CAcreateserial -days 365 -extfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;openssl.cnf&gt;\u003C/em>\u003C/span> -extensions \u003Cspan class=\"emphasis\">\u003Cem>&lt;client-cert&gt;\u003C/em>\u003C/span> -out \u003Cspan class=\"emphasis\">\u003Cem>&lt;client-cert.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nSignature ok\nsubject=C = US, O = Example Organization, CN = server.example.com\nGetting CA Private Key\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSee \u003Ca class=\"xref\" href=\"#using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates\" title=\"2.5. Using a private CA to issue certificates for CSRs with OpenSSL\">Section 2.5, “Using a private CA to issue certificates for CSRs with OpenSSL”\u003C/a> for more information.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the basic information about your self-signed CA:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -in \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span> -text -noout\u003C/strong>\u003C/span>\nCertificate:\n…\n        X509v3 extensions:\n            …\n            X509v3 Basic Constraints: critical\n                CA:TRUE\n            X509v3 Key Usage: critical\n                Certificate Sign, CRL Sign\n…\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the consistency of the private key:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl pkey -check -in \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nKey is valid\n-----BEGIN PRIVATE KEY-----\nMIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgcagSaTEBn74xZAwO\n18wRpXoCVC9vcPki7WlT+gnmCI+hRANCAARb9NxIvkaVjFhOoZbGp/HtIQxbM78E\nlwbDP0BI624xBJ8gK68ogSaq2x4SdezFdV1gNeKScDcU+Pj2pELldmdF\n-----END PRIVATE KEY-----\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">openssl(1)\u003C/code>, \u003Ccode class=\"literal\">ca(1)\u003C/code>, \u003Ccode class=\"literal\">genpkey(1)\u003C/code>, \u003Ccode class=\"literal\">x509(1)\u003C/code>, and \u003Ccode class=\"literal\">req(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.3. Creating a private key and a CSR for a TLS server certificate using OpenSSL\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use TLS-encrypted communication channels only if you have a valid TLS certificate from a certificate authority (CA). To obtain the certificate, you must create a private key and a certificate signing request (CSR) for your server first.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a private key on your server system, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl genpkey -algorithm ec -pkeyopt ec_paramgen_curve:P-256 -out \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-private.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Use a text editor of your choice to prepare a configuration file that simplifies creating your CSR, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vim \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_server.cnf&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n[server-cert]\nkeyUsage = critical, digitalSignature, keyEncipherment, keyAgreement\nextendedKeyUsage = serverAuth\nsubjectAltName = @alt_name\n\n[req]\ndistinguished_name = dn\nprompt = no\n\n[dn]\nC = \u003Cspan class=\"emphasis\">\u003Cem>&lt;US&gt;\u003C/em>\u003C/span>\nO = \u003Cspan class=\"emphasis\">\u003Cem>&lt;Example Organization&gt;\u003C/em>\u003C/span>\nCN = \u003Cspan class=\"emphasis\">\u003Cem>&lt;server.example.com&gt;\u003C/em>\u003C/span>\n\n[alt_name]\nDNS.1 = \u003Cspan class=\"emphasis\">\u003Cem>&lt;example.com&gt;\u003C/em>\u003C/span>\nDNS.2 = \u003Cspan class=\"emphasis\">\u003Cem>&lt;server.example.com&gt;\u003C/em>\u003C/span>\nIP.1 = \u003Cspan class=\"emphasis\">\u003Cem>&lt;192.168.0.1&gt;\u003C/em>\u003C/span>\nIP.2 = \u003Cspan class=\"emphasis\">\u003Cem>&lt;::1&gt;\u003C/em>\u003C/span>\nIP.3 = \u003Cspan class=\"emphasis\">\u003Cem>&lt;127.0.0.1&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">extendedKeyUsage = serverAuth\u003C/code> option limits the use of a certificate.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a CSR using the private key you created previously:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -key \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-private.key&gt;\u003C/em>\u003C/span> -config \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_server.cnf&gt;\u003C/em>\u003C/span> -new -out \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-cert.csr&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you omit the \u003Ccode class=\"literal\">-config\u003C/code> option, the \u003Ccode class=\"literal\">req\u003C/code> utility prompts you for additional information, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">You are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [XX]: \u003Cspan class=\"emphasis\">\u003Cem>&lt;US&gt;\u003C/em>\u003C/span>\nState or Province Name (full name) []: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Washington&gt;\u003C/em>\u003C/span>\nLocality Name (eg, city) [Default City]: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Seattle&gt;\u003C/em>\u003C/span>\nOrganization Name (eg, company) [Default Company Ltd]: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Example Organization&gt;\u003C/em>\u003C/span>\nOrganizational Unit Name (eg, section) []:\nCommon Name (eg, your name or your server's hostname) []: \u003Cspan class=\"emphasis\">\u003Cem>&lt;server.example.com&gt;\u003C/em>\u003C/span>\nEmail Address []: \u003Cspan class=\"emphasis\">\u003Cem>&lt;server@example.com&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSubmit the CSR to a CA of your choice for signing. Alternatively, for an internal use scenario within a trusted network, use your private CA for signing. See \u003Ca class=\"xref\" href=\"#using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates\" title=\"2.5. Using a private CA to issue certificates for CSRs with OpenSSL\">Section 2.5, “Using a private CA to issue certificates for CSRs with OpenSSL”\u003C/a> for more information.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter you obtain the requested certificate from the CA, check that the human-readable parts of the certificate match your requirements, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -text -noout -in \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-cert.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nCertificate:\n…\n        Issuer: CN = Example CA\n        Validity\n            Not Before: Feb  2 20:27:29 2023 GMT\n            Not After : Feb  2 20:27:29 2024 GMT\n        Subject: C = US, O = Example Organization, CN = server.example.com\n        Subject Public Key Info:\n            Public Key Algorithm: id-ecPublicKey\n                Public-Key: (256 bit)\n…\n        X509v3 extensions:\n            X509v3 Key Usage: critical\n                Digital Signature, Key Encipherment, Key Agreement\n            X509v3 Extended Key Usage:\n                TLS Web Server Authentication\n            X509v3 Subject Alternative Name:\n                DNS:example.com, DNS:server.example.com, IP Address:192.168.0.1, IP\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">openssl(1)\u003C/code>, \u003Ccode class=\"literal\">x509(1)\u003C/code>, \u003Ccode class=\"literal\">genpkey(1)\u003C/code>, \u003Ccode class=\"literal\">req(1)\u003C/code>, and \u003Ccode class=\"literal\">config(5)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.4. Creating a private key and a CSR for a TLS client certificate using OpenSSL\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use TLS-encrypted communication channels only if you have a valid TLS certificate from a certificate authority (CA). To obtain the certificate, you must create a private key and a certificate signing request (CSR) for your client first.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a private key on your client system, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl genpkey -algorithm ec -pkeyopt ec_paramgen_curve:P-256 -out \u003Cspan class=\"emphasis\">\u003Cem>&lt;client-private.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Use a text editor of your choice to prepare a configuration file that simplifies creating your CSR, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vim \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_client.cnf&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n[client-cert]\nkeyUsage = critical, digitalSignature, keyEncipherment\nextendedKeyUsage = clientAuth\nsubjectAltName = @alt_name\n\n[req]\ndistinguished_name = dn\nprompt = no\n\n[dn]\nCN = \u003Cspan class=\"emphasis\">\u003Cem>&lt;client.example.com&gt;\u003C/em>\u003C/span>\n\n[clnt_alt_name]\nemail= \u003Cspan class=\"emphasis\">\u003Cem>&lt;client@example.com&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">extendedKeyUsage = clientAuth\u003C/code> option limits the use of a certificate.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a CSR using the private key you created previously:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -key \u003Cspan class=\"emphasis\">\u003Cem>&lt;client-private.key&gt;\u003C/em>\u003C/span> -config \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_client.cnf&gt;\u003C/em>\u003C/span> -new -out \u003Cspan class=\"emphasis\">\u003Cem>&lt;client-cert.csr&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you omit the \u003Ccode class=\"literal\">-config\u003C/code> option, the \u003Ccode class=\"literal\">req\u003C/code> utility prompts you for additional information, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">You are about to be asked to enter information that will be incorporated\ninto your certificate request.\n…\nCommon Name (eg, your name or your server's hostname) []: \u003Cspan class=\"emphasis\">\u003Cem>&lt;client.example.com&gt;\u003C/em>\u003C/span>\nEmail Address []: \u003Cspan class=\"emphasis\">\u003Cem>&lt;client@example.com&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSubmit the CSR to a CA of your choice for signing. Alternatively, for an internal use scenario within a trusted network, use your private CA for signing. See \u003Ca class=\"xref\" href=\"#using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates\" title=\"2.5. Using a private CA to issue certificates for CSRs with OpenSSL\">Section 2.5, “Using a private CA to issue certificates for CSRs with OpenSSL”\u003C/a> for more information.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the human-readable parts of the certificate match your requirements, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -text -noout -in \u003Cspan class=\"emphasis\">\u003Cem>&lt;client-cert.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nCertificate:\n…\n            X509v3 Extended Key Usage:\n                TLS Web Client Authentication\n            X509v3 Subject Alternative Name:\n                email:client@example.com\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">openssl(1)\u003C/code>, \u003Ccode class=\"literal\">x509(1)\u003C/code>, \u003Ccode class=\"literal\">genpkey(1)\u003C/code>, \u003Ccode class=\"literal\">req(1)\u003C/code>, and \u003Ccode class=\"literal\">config(5)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.5. Using a private CA to issue certificates for CSRs with OpenSSL\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo enable systems to establish a TLS-encrypted communication channel, a certificate authority (CA) must provide valid certificates to them. If you have a private CA, you can create the requested certificates by signing certificate signing requests (CSRs) from the systems.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have already configured a private CA. See \u003Ca class=\"xref\" href=\"#creating-a-private-ca-using-openssl_creating-and-managing-tls-keys-and-certificates\" title=\"2.2. Creating a private CA using OpenSSL\">Section 2.2, “Creating a private CA using OpenSSL”\u003C/a> for more information.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have a file containing a CSR. You can find an example of creating the CSR in \u003Ca class=\"xref\" href=\"#creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates\" title=\"2.3. Creating a private key and a CSR for a TLS server certificate using OpenSSL\">Section 2.3, “Creating a private key and a CSR for a TLS server certificate using OpenSSL”\u003C/a> .\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Use a text editor of your choice to prepare an OpenSSL configuration file for adding extensions to certificates, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vim \u003Cspan class=\"emphasis\">\u003Cem>&lt;openssl.cnf&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n[server-cert]\nextendedKeyUsage = serverAuth\n\n[client-cert]\nextendedKeyUsage = clientAuth\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">x509\u003C/code> utility to create a certificate based on a CSR, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -req -in \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-cert.csr&gt;\u003C/em>\u003C/span> -CA \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span> -CAkey \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span> -days 365 -extfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;openssl.cnf&gt;\u003C/em>\u003C/span> -extensions \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-cert&gt;\u003C/em>\u003C/span> -out \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-cert.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nSignature ok\nsubject=C = US, O = Example Organization, CN = server.example.com\nGetting CA Private Key\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">openssl(1)\u003C/code>, \u003Ccode class=\"literal\">ca(1)\u003C/code>, and \u003Ccode class=\"literal\">x509(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-private-ca-using-gnutls_creating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.6. Creating a private CA using GnuTLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPrivate certificate authorities (CA) are useful when your scenario requires verifying entities within your internal network. For example, use a private CA when you create a VPN gateway with authentication based on certificates signed by a CA under your control or when you do not want to pay a commercial CA. To sign certificates in such use cases, the private CA uses a self-signed certificate.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> privileges or permissions to enter administrative commands with \u003Ccode class=\"literal\">sudo\u003C/code>. Commands that require such privileges are marked with \u003Ccode class=\"literal\">#\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have already installed GnuTLS on your system. If you did not, you can use this command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install gnutls-utils\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a private key for your CA. For example, the following command creates a 256-bit ECDSA (Elliptic Curve Digital Signature Algorithm) key:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-privkey --sec-param High --key-type=ecdsa --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe time for the key-generation process depends on the hardware and entropy of the host, the selected algorithm, and the length of the key.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a template file for a certificate.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a file with a text editor of your choice, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vi \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.cfg&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEdit the file to include the necessary certification details:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">organization = \"Example Inc.\"\nstate = \"Example\"\ncountry = EX\ncn = \"Example CA\"\nserial = 007\nexpiration_days = 365\nca\ncert_signing_key\ncrl_signing_key\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a certificate signed using the private key generated in step 1:\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe generated \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span> file is a self-signed CA certificate that you can use to sign other certificates for one year. \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span> file is the public key (certificate). The loaded file \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span> is the private key. You should keep this file in safe location.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-self-signed --load-privkey \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span> --template \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.cfg&gt;\u003C/em>\u003C/span> --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt\u003C/em>\u003C/span>&gt;\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet secure permissions on the private key of your CA, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chown \u003Cspan class=\"emphasis\">\u003Cem>&lt;root&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;root&gt;\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>chmod 600 \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo use a self-signed CA certificate as a trust anchor on client systems, copy the CA certificate to the client and add it to the clients' system-wide truststore as \u003Ccode class=\"literal\">root\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>trust anchor \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSee \u003Ca class=\"xref\" href=\"#using-shared-system-certificates_securing-networks\" title=\"Chapter 3. Using shared system certificates\">Chapter 3, \u003Cem>Using shared system certificates\u003C/em>\u003C/a> for more information.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the basic information about your self-signed CA:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --certificate-info --infile \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nCertificate:\n…\n    \tX509v3 extensions:\n        \t…\n        \tX509v3 Basic Constraints: critical\n            \tCA:TRUE\n        \tX509v3 Key Usage: critical\n            \tCertificate Sign, CRL Sign\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a certificate signing request (CSR), and use your CA to sign the request. The CA must successfully create a certificate based on the CSR, for example:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tGenerate a private key for your CA:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-privkey --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOpen a new configuration file in a text editor of your choice, for example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vi \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.cfg&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEdit the file to include the necessary certification details:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">signing_key\nencryption_key\nkey_agreement\n\ntls_www_server\n\ncountry = \"US\"\norganization = \"Example Organization\"\ncn = \"server.example.com\"\n\ndns_name = \"example.com\"\ndns_name = \"server.example.com\"\nip_address = \"192.168.0.1\"\nip_address = \"::1\"\nip_address = \"127.0.0.1\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tGenerate a request with the previously created private key:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-request --load-privkey \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.key&gt;\u003C/em>\u003C/span> --template \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.cfg&gt;\u003C/em>\u003C/span> --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.crq&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tGenerate the certificate and sign it with the private key of the CA:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-certificate --load-request \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.crq&gt;\u003C/em>\u003C/span> --load-ca-certificate \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span> --load-ca-privkey \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span> --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">certtool(1)\u003C/code> and \u003Ccode class=\"literal\">trust(1)\u003C/code> man pages on your system\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-gnutls_creating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.7. Creating a private key and a CSR for a TLS server certificate using GnuTLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo obtain the certificate, you must create a private key and a certificate signing request (CSR) for your server first.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a private key on your server system, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-privkey --sec-param High --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Use a text editor of your choice to prepare a configuration file that simplifies creating your CSR, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vim \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_server.cnf&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nsigning_key\nencryption_key\nkey_agreement\n\ntls_www_server\n\ncountry = \"US\"\norganization = \"Example Organization\"\ncn = \"server.example.com\"\n\ndns_name = \"example.com\"\ndns_name = \"server.example.com\"\nip_address = \"192.168.0.1\"\nip_address = \"::1\"\nip_address = \"127.0.0.1\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a CSR using the private key you created previously:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-request --template \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.cfg&gt;\u003C/em>\u003C/span> --load-privkey \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.key&gt;\u003C/em>\u003C/span> --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.crq&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you omit the \u003Ccode class=\"literal\">--template\u003C/code> option, the \u003Ccode class=\"literal\">certool\u003C/code> utility prompts you for additional information, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">You are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nGenerating a PKCS #10 certificate request...\nCountry name (2 chars): \u003Cspan class=\"emphasis\">\u003Cem>&lt;US&gt;\u003C/em>\u003C/span>\nState or province name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Washington&gt;\u003C/em>\u003C/span>\nLocality name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Seattle&gt;\u003C/em>\u003C/span>\nOrganization name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Example Organization&gt;\u003C/em>\u003C/span>\nOrganizational unit name:\nCommon name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;server.example.com&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSubmit the CSR to a CA of your choice for signing. Alternatively, for an internal use scenario within a trusted network, use your private CA for signing. See \u003Ca class=\"xref\" href=\"#using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates\" title=\"2.9. Using a private CA to issue certificates for CSRs with GnuTLS\">Section 2.9, “Using a private CA to issue certificates for CSRs with GnuTLS”\u003C/a> for more information.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter you obtain the requested certificate from the CA, check that the human-readable parts of the certificate match your requirements, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --certificate-info --infile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nCertificate:\n…\n        Issuer: CN = Example CA\n        Validity\n            Not Before: Feb  2 20:27:29 2023 GMT\n            Not After : Feb  2 20:27:29 2024 GMT\n        Subject: C = US, O = Example Organization, CN = server.example.com\n        Subject Public Key Info:\n            Public Key Algorithm: id-ecPublicKey\n                Public-Key: (256 bit)\n…\n        X509v3 extensions:\n            X509v3 Key Usage: critical\n                Digital Signature, Key Encipherment, Key Agreement\n            X509v3 Extended Key Usage:\n                TLS Web Server Authentication\n            X509v3 Subject Alternative Name:\n                DNS:example.com, DNS:server.example.com, IP Address:192.168.0.1, IP\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">certtool(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-gnutlscreating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.8. Creating a private key and a CSR for a TLS client certificate using GnuTLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo obtain the certificate, you must create a private key and a certificate signing request (CSR) for your client first.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a private key on your client system, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-privkey --sec-param High --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-client.key&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Use a text editor of your choice to prepare a configuration file that simplifies creating your CSR, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vim \u003Cspan class=\"emphasis\">\u003Cem>&lt;example_client.cnf&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nsigning_key\nencryption_key\n\ntls_www_client\n\ncn = \"client.example.com\"\nemail = \"client@example.com\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a CSR using the private key you created previously:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-request --template \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-client.cfg&gt;\u003C/em>\u003C/span> --load-privkey \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-client.key&gt;\u003C/em>\u003C/span> --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-client.crq&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you omit the \u003Ccode class=\"literal\">--template\u003C/code> option, the \u003Ccode class=\"literal\">certtool\u003C/code> utility prompts you for additional information, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Generating a PKCS #10 certificate request...\nCountry name (2 chars): \u003Cspan class=\"emphasis\">\u003Cem>&lt;US&gt;\u003C/em>\u003C/span>\nState or province name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Washington&gt;\u003C/em>\u003C/span>\nLocality name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Seattle&gt;\u003C/em>\u003C/span>\nOrganization name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;Example Organization&gt;\u003C/em>\u003C/span>\nOrganizational unit name:\nCommon name: \u003Cspan class=\"emphasis\">\u003Cem>&lt;server.example.com&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSubmit the CSR to a CA of your choice for signing. Alternatively, for an internal use scenario within a trusted network, use your private CA for signing. See \u003Ca class=\"xref\" href=\"#using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates\" title=\"2.9. Using a private CA to issue certificates for CSRs with GnuTLS\">Section 2.9, “Using a private CA to issue certificates for CSRs with GnuTLS”\u003C/a> for more information.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the human-readable parts of the certificate match your requirements, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --certificate-info --infile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-client.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nCertificate:\n…\n            X509v3 Extended Key Usage:\n                TLS Web Client Authentication\n            X509v3 Subject Alternative Name:\n                email:client@example.com\n…\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">certtool(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.9. Using a private CA to issue certificates for CSRs with GnuTLS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo enable systems to establish a TLS-encrypted communication channel, a certificate authority (CA) must provide valid certificates to them. If you have a private CA, you can create the requested certificates by signing certificate signing requests (CSRs) from the systems.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have already configured a private CA. See \u003Ca class=\"xref\" href=\"#creating-a-private-ca-using-gnutls_creating-and-managing-tls-keys-and-certificates\" title=\"2.6. Creating a private CA using GnuTLS\">Section 2.6, “Creating a private CA using GnuTLS”\u003C/a> for more information.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have a file containing a CSR. You can find an example of creating the CSR in \u003Ca class=\"xref\" href=\"#creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-gnutls_creating-and-managing-tls-keys-and-certificates\" title=\"2.7. Creating a private key and a CSR for a TLS server certificate using GnuTLS\">Section 2.7, “Creating a private key and a CSR for a TLS server certificate using GnuTLS”\u003C/a> .\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Use a text editor of your choice to prepare an GnuTLS configuration file for adding extensions to certificates, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>vi \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-extensions.cfg&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nhonor_crq_extensions\nocsp_uri = \"http://ocsp.example.com\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">certtool\u003C/code> utility to create a certificate based on a CSR, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>certtool --generate-certificate --load-request \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.crq&gt;\u003C/em>\u003C/span> --load-ca-privkey \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.key&gt;\u003C/em>\u003C/span> --load-ca-certificate \u003Cspan class=\"emphasis\">\u003Cem>&lt;ca.crt&gt;\u003C/em>\u003C/span> --template \u003Cspan class=\"emphasis\">\u003Cem>&lt;server-extensions.cfg&gt;\u003C/em>\u003C/span> --outfile \u003Cspan class=\"emphasis\">\u003Cem>&lt;example-server.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">certtool(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-shared-system-certificates_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 3. Using shared system certificates\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThe shared system certificates storage enables NSS, GnuTLS, OpenSSL, and Java to share a default source for retrieving system certificate anchors and block-list information. By default, the truststore contains the Mozilla CA list, including positive and negative trust. The system allows updating the core Mozilla CA list or choosing another certificate list.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"the-system-wide-trust-store_using-shared-system-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.1. The system-wide truststore\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn RHEL, the consolidated system-wide truststore is located in the \u003Ccode class=\"literal\">/etc/pki/ca-trust/\u003C/code> and \u003Ccode class=\"literal\">/usr/share/pki/ca-trust-source/\u003C/code> directories. The trust settings in \u003Ccode class=\"literal\">/usr/share/pki/ca-trust-source/\u003C/code> are processed with lower priority than settings in \u003Ccode class=\"literal\">/etc/pki/ca-trust/\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tCertificate files are treated depending on the subdirectory they are installed to:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTrust anchors belong to\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/pki/ca-trust-source/anchors/\u003C/code> or\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/etc/pki/ca-trust/source/anchors/\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDistrusted certificates are stored in\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/pki/ca-trust-source/blocklist/\u003C/code> or\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/etc/pki/ca-trust/source/blocklist/\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCertificates in the extended BEGIN TRUSTED file format are located in\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/pki/ca-trust-source/\u003C/code> or\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/etc/pki/ca-trust/source/\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn a hierarchical cryptographic system, a trust anchor is an authoritative entity that other parties consider trustworthy. In the X.509 architecture, a root certificate is a trust anchor from which a chain of trust is derived. To enable chain validation, the trusting party must have access to the trust anchor first.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">update-ca-trust(8)\u003C/code> and \u003Ccode class=\"literal\">trust(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-new-certificates_using-shared-system-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.2. Adding new certificates\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo acknowledge applications on your system with a new source of trust, add the corresponding certificate to the system-wide store, and use the \u003Ccode class=\"literal\">update-ca-trust\u003C/code> command.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ca-certificates\u003C/code> package is present on the system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo add a certificate in the simple PEM or DER file formats to the list of CAs trusted on the system, copy the certificate file to the \u003Ccode class=\"literal\">/usr/share/pki/ca-trust-source/anchors/\u003C/code> or \u003Ccode class=\"literal\">/etc/pki/ca-trust/source/anchors/\u003C/code> directory, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp \u003Cspan class=\"emphasis\">\u003Cem>~/certificate-trust-examples/Cert-trust-test-ca.pem\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>/usr/share/pki/ca-trust-source/anchors/\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo update the system-wide truststore configuration, use the \u003Ccode class=\"literal command\">update-ca-trust\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>update-ca-trust\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tEven though the Firefox browser can use an added certificate without a prior execution of \u003Ccode class=\"literal\">update-ca-trust\u003C/code>, enter the \u003Ccode class=\"literal\">update-ca-trust\u003C/code> command after every CA change. Also note that browsers, such as Firefox, Chromium, and GNOME Web cache files, and you might have to clear your browser’s cache or restart your browser to load the current system certificate configuration.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">update-ca-trust(8)\u003C/code> and \u003Ccode class=\"literal\">trust(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"managing-trusted-system-certificates_using-shared-system-certificates\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.3. Managing trusted system certificates\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">trust\u003C/code> command provides a convenient way for managing certificates in the shared system-wide truststore.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo list, extract, add, remove, or change trust anchors, use the \u003Ccode class=\"literal command\">trust\u003C/code> command. To see the built-in help for this command, enter it without any arguments or with the \u003Ccode class=\"literal option\">--help\u003C/code> directive:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>trust\u003C/strong>\u003C/span>\nusage: trust command &lt;args&gt;...\n\nCommon trust commands are:\n  list             List trust or certificates\n  extract          Extract certificates and trust\n  extract-compat   Extract trust compatibility bundles\n  anchor           Add, remove, change trust anchors\n  dump             Dump trust objects in internal format\n\nSee 'trust &lt;command&gt; --help' for more information\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo list all system trust anchors and certificates, use the \u003Ccode class=\"literal command\">trust list\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>trust list\u003C/strong>\u003C/span>\npkcs11:id=%d2%87%b4%e3%df%37%27%93%55%f6%56%ea%81%e5%36%cc%8c%1e%3f%bd;type=cert\n    type: certificate\n    label: ACCVRAIZ1\n    trust: anchor\n    category: authority\n\npkcs11:id=%a6%b3%e1%2b%2b%49%b6%d7%73%a1%aa%94%f5%01%e7%73%65%4c%ac%50;type=cert\n    type: certificate\n    label: ACEDICOM Root\n    trust: anchor\n    category: authority\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo store a trust anchor into the system-wide truststore, use the \u003Ccode class=\"literal command\">trust anchor\u003C/code> sub-command and specify a path to a certificate. Replace \u003Cspan class=\"emphasis\">\u003Cem>&lt;path.to/certificate.crt&gt;\u003C/em>\u003C/span> by a path to your certificate and its file name:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>trust anchor \u003Cspan class=\"emphasis\">\u003Cem>&lt;path.to/certificate.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo remove a certificate, use either a path to a certificate or an ID of a certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\"># \u003Cspan class=\"strong strong\">\u003Cstrong>trust anchor --remove \u003Cspan class=\"emphasis\">\u003Cem>&lt;path.to/certificate.crt&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>trust anchor --remove \"pkcs11:id=\u003Cspan class=\"emphasis\">\u003Cem>&lt;%AA%BB%CC%DD%EE&gt;\u003C/em>\u003C/span>;type=cert\"\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAll sub-commands of the \u003Ccode class=\"literal command\">trust\u003C/code> commands offer a detailed built-in help, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen white-space-pre white-space-pre\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>trust list --help\u003C/strong>\u003C/span>\nusage: trust list --filter=&lt;what&gt;\n\n  --filter=&lt;what&gt;     filter of what to export\n                        ca-anchors        certificate anchors\n...\n  --purpose=&lt;usage&gt;   limit to certificates usable for the purpose\n                        server-auth       for authenticating servers\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">update-ca-trust(8)\u003C/code> and \u003Ccode class=\"literal\">trust(1)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"planning-and-implementing-tls_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 4. Planning and implementing TLS\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tTLS (Transport Layer Security) is a cryptographic protocol used to secure network communications. When hardening system security settings by configuring preferred key-exchange protocols, authentication methods, and encryption algorithms, it is necessary to bear in mind that the broader the range of supported clients, the lower the resulting security. Conversely, strict security settings lead to limited compatibility with clients, which can result in some users being locked out of the system. Be sure to target the strictest available configuration and only relax it when it is required for compatibility reasons.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"ssl-and-tls-protocols_planning-and-implementing-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.1. SSL and TLS protocols\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Secure Sockets Layer (SSL) protocol was originally developed by Netscape Corporation to provide a mechanism for secure communication over the Internet. Subsequently, the protocol was adopted by the Internet Engineering Task Force (IETF) and renamed to Transport Layer Security (TLS).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe TLS protocol sits between an application protocol layer and a reliable transport layer, such as TCP/IP. It is independent of the application protocol and can thus be layered underneath many different protocols, for example: HTTP, FTP, SMTP, and so on.\n\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 80%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140078483092256\" scope=\"col\">Protocol version\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140078483091168\" scope=\"col\">Usage recommendation\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483092256\"> \u003Cp>\n\t\t\t\t\t\t\t\tSSL v2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483091168\"> \u003Cp>\n\t\t\t\t\t\t\t\tDo not use. Has serious security vulnerabilities. Removed from the core crypto libraries since RHEL 7.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483092256\"> \u003Cp>\n\t\t\t\t\t\t\t\tSSL v3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483091168\"> \u003Cp>\n\t\t\t\t\t\t\t\tDo not use. Has serious security vulnerabilities. Removed from the core crypto libraries since RHEL 8.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483092256\"> \u003Cp>\n\t\t\t\t\t\t\t\tTLS 1.0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483091168\"> \u003Cp>\n\t\t\t\t\t\t\t\tNot recommended to use. Has known issues that cannot be mitigated in a way that guarantees interoperability, and does not support modern cipher suites. In RHEL 9, disabled in all cryptographic policies.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483092256\"> \u003Cp>\n\t\t\t\t\t\t\t\tTLS 1.1\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483091168\"> \u003Cp>\n\t\t\t\t\t\t\t\tUse for interoperability purposes where needed. Does not support modern cipher suites. In RHEL 9, disabled in all cryptographic policies.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483092256\"> \u003Cp>\n\t\t\t\t\t\t\t\tTLS 1.2\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483091168\"> \u003Cp>\n\t\t\t\t\t\t\t\tSupports the modern AEAD cipher suites. This version is enabled in all system-wide crypto policies, but optional parts of this protocol contain vulnerabilities and TLS 1.2 also allows outdated algorithms.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483092256\"> \u003Cp>\n\t\t\t\t\t\t\t\tTLS 1.3\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140078483091168\"> \u003Cp>\n\t\t\t\t\t\t\t\tRecommended version. TLS 1.3 removes known problematic options, provides additional privacy by encrypting more of the negotiation handshake and can be faster thanks usage of more efficient modern cryptographic algorithms. TLS 1.3 is also enabled in all system-wide cryptographic policies.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://tools.ietf.org/html/rfc8446\">IETF: The Transport Layer Security (TLS) Protocol Version 1.3\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"security-considerations-for-tls-in-rhel_planning-and-implementing-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.2. Security considerations for TLS in RHEL 9\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn RHEL 9, TLS configuration is performed using the system-wide cryptographic policies mechanism. TLS versions below 1.2 are not supported anymore. \u003Ccode class=\"literal\">DEFAULT\u003C/code>, \u003Ccode class=\"literal\">FUTURE\u003C/code>, and \u003Ccode class=\"literal\">LEGACY\u003C/code> cryptographic policies allow only TLS 1.2 and 1.3. See \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">Using system-wide cryptographic policies\u003C/a> for more information.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe default settings provided by libraries included in RHEL 9 are secure enough for most deployments. The TLS implementations use secure algorithms where possible while not preventing connections from or to legacy clients or servers. Apply hardened settings in environments with strict security requirements where legacy clients or servers that do not support secure algorithms or protocols are not expected or allowed to connect.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe most straightforward way to harden your TLS configuration is switching the system-wide cryptographic policy level to \u003Ccode class=\"literal\">FUTURE\u003C/code> using the \u003Ccode class=\"literal\">update-crypto-policies --set FUTURE\u003C/code> command.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tAlgorithms disabled for the \u003Ccode class=\"literal\">LEGACY\u003C/code> cryptographic policy do not conform to Red Hat’s vision of RHEL 9 security, and their security properties are not reliable. Consider moving away from using these algorithms instead of re-enabling them. If you do decide to re-enable them, for example for interoperability with old hardware, treat them as insecure and apply extra protection measures, such as isolating their network interactions to separate network segments. Do not use them across public networks.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tIf you decide to not follow RHEL system-wide crypto policies or create custom cryptographic policies tailored to your setup, use the following recommendations for preferred protocols, cipher suites, and key lengths on your custom configuration:\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"protocols\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">4.2.1. Protocols\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tThe latest version of TLS provides the best security mechanism. TLS 1.2 is now the minimum version even when using the \u003Ccode class=\"literal\">LEGACY\u003C/code> cryptographic policy. Re-enabling older protocol versions is possible through either opting out of cryptographic policies or providing a custom policy, but the resulting configuration will not be supported.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tNote that even though that RHEL 9 supports TLS version 1.3, not all features of this protocol are fully supported by RHEL 9 components. For example, the 0-RTT (Zero Round Trip Time) feature, which reduces connection latency, is not yet fully supported by the Apache web server.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tA RHEL 9.2 and later system running in FIPS mode enforces that any TLS 1.2 connection must use the Extended Master Secret (EMS) extension (RFC 7627) as requires the FIPS 140-3 standard. Thus, legacy clients not supporting EMS or TLS 1.3 cannot connect to RHEL 9 servers running in FIPS mode, RHEL 9 clients in FIPS mode cannot connect to servers that support only TLS 1.2 without EMS. See \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS Extension \"Extended Master Secret\" enforced with Red Hat Enterprise Linux 9.2\u003C/a>\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"cipher_suites\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">4.2.2. Cipher suites\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tModern, more secure cipher suites should be preferred to old, insecure ones. Always disable the use of eNULL and aNULL cipher suites, which do not offer any encryption or authentication at all. If at all possible, ciphers suites based on RC4 or HMAC-MD5, which have serious shortcomings, should also be disabled. The same applies to the so-called export cipher suites, which have been intentionally made weaker, and thus are easy to break.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tWhile not immediately insecure, cipher suites that offer less than 128 bits of security should not be considered for their short useful life. Algorithms that use 128 bits of security or more can be expected to be unbreakable for at least several years, and are thus strongly recommended. Note that while 3DES ciphers advertise the use of 168 bits, they actually offer 112 bits of security.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tAlways prefer cipher suites that support (perfect) forward secrecy (PFS), which ensures the confidentiality of encrypted data even in case the server key is compromised. This rules out the fast RSA key exchange, but allows for the use of ECDHE and DHE. Of the two, ECDHE is the faster and therefore the preferred choice.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tYou should also prefer AEAD ciphers, such as AES-GCM, over CBC-mode ciphers as they are not vulnerable to padding oracle attacks. Additionally, in many cases, AES-GCM is faster than AES in CBC mode, especially when the hardware has cryptographic accelerators for AES.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tNote also that when using the ECDHE key exchange with ECDSA certificates, the transaction is even faster than a pure RSA key exchange. To provide support for legacy clients, you can install two pairs of certificates and keys on a server: one with ECDSA keys (for new clients) and one with RSA keys (for legacy ones).\n\t\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"public_key_length\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">4.2.3. Public key length\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tWhen using RSA keys, always prefer key lengths of at least 3072 bits signed by at least SHA-256, which is sufficiently large for true 128 bits of security.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe security of your system is only as strong as the weakest link in the chain. For example, a strong cipher alone does not guarantee good security. The keys and the certificates are just as important, as well as the hash functions and keys used by the Certification Authority (CA) to sign your keys.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"hardening-tls-configuration-in-applications_planning-and-implementing-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.3. Hardening TLS configuration in applications\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn RHEL, \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">system-wide crypto policies\u003C/a> provide a convenient way to ensure that your applications that use cryptographic libraries do not allow known insecure protocols, ciphers, or algorithms.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you want to harden your TLS-related configuration with your customized cryptographic settings, you can use the cryptographic configuration options described in this section, and override the system-wide crypto policies just in the minimum required amount.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tRegardless of the configuration you choose to use, always ensure that your server application enforces \u003Cspan class=\"emphasis\">\u003Cem>server-side cipher order\u003C/em>\u003C/span>, so that the cipher suite to be used is determined by the order you configure.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"configuring-the-apache-http-server_planning-and-implementing-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">4.3.1. Configuring the Apache HTTP server to use TLS\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal application\">Apache HTTP Server\u003C/code> can use both \u003Ccode class=\"literal application\">OpenSSL\u003C/code> and \u003Ccode class=\"literal application\">NSS\u003C/code> libraries for its TLS needs. RHEL 9 provides the \u003Ccode class=\"literal application\">mod_ssl\u003C/code> functionality through eponymous packages:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install mod_ssl\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal package\">mod_ssl\u003C/code> package installs the \u003Ccode class=\"literal\">/etc/httpd/conf.d/ssl.conf\u003C/code> configuration file, which can be used to modify the TLS-related settings of the \u003Ccode class=\"literal application\">Apache HTTP Server\u003C/code>.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tInstall the \u003Ccode class=\"literal package\">httpd-manual\u003C/code> package to obtain complete documentation for the \u003Ccode class=\"literal application\">Apache HTTP Server\u003C/code>, including TLS configuration. The directives available in the \u003Ccode class=\"literal\">/etc/httpd/conf.d/ssl.conf\u003C/code> configuration file are described in detail in the \u003Ccode class=\"literal\">/usr/share/httpd/manual/mod/mod_ssl.html\u003C/code> file. Examples of various settings are described in the \u003Ccode class=\"literal\">/usr/share/httpd/manual/ssl/ssl_howto.html\u003C/code> file.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tWhen modifying the settings in the \u003Ccode class=\"literal\">/etc/httpd/conf.d/ssl.conf\u003C/code> configuration file, be sure to consider the following three directives at the minimum:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal option\">SSLProtocol\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse this directive to specify the version of TLS or SSL you want to allow.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal option\">SSLCipherSuite\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse this directive to specify your preferred cipher suite or disable the ones you want to disallow.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal option\">SSLHonorCipherOrder\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUncomment and set this directive to \u003Ccode class=\"literal\">on\u003C/code> to ensure that the connecting clients adhere to the order of ciphers you specified.\n\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\t\tFor example, to use only the TLS 1.2 and 1.3 protocol:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">SSLProtocol             all -SSLv3 -TLSv1 -TLSv1.1\u003C/pre>\u003Cp>\n\t\t\t\t\tSee the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/setting-apache-http-server_deploying-web-servers-and-reverse-proxies#configuring-tls-encryption-on-an-apache-http-server_setting-apache-http-server\">Configuring TLS encryption on an Apache HTTP Server\u003C/a> chapter in the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/index\">Deploying web servers and reverse proxies\u003C/a> document for more information.\n\t\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"configuring-the-nginx-http-and-proxy-server_planning-and-implementing-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">4.3.2. Configuring the Nginx HTTP and proxy server to use TLS\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tTo enable TLS 1.3 support in \u003Ccode class=\"literal\">Nginx\u003C/code>, add the \u003Ccode class=\"literal\">TLSv1.3\u003C/code> value to the \u003Ccode class=\"literal\">ssl_protocols\u003C/code> option in the \u003Ccode class=\"literal\">server\u003C/code> section of the \u003Ccode class=\"literal\">/etc/nginx/nginx.conf\u003C/code> configuration file:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">server {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    ....\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers\n    ....\n}\u003C/pre>\u003Cp>\n\t\t\t\t\tSee the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/setting-up-and-configuring-nginx_deploying-web-servers-and-reverse-proxies#adding-tls-encryption-to-an-nginx-web-server_setting-up-and-configuring-nginx\">Adding TLS encryption to an Nginx web server\u003C/a> chapter in the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/index\">Deploying web servers and reverse proxies\u003C/a> document for more information.\n\t\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"configuring-the-Dovecot-mail-server_planning-and-implementing-tls\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">4.3.3. Configuring the Dovecot mail server to use TLS\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tTo configure your installation of the \u003Ccode class=\"literal application\">Dovecot\u003C/code> mail server to use TLS, modify the \u003Ccode class=\"literal\">/etc/dovecot/conf.d/10-ssl.conf\u003C/code> configuration file. You can find an explanation of some of the basic configuration directives available in that file in the \u003Ccode class=\"literal\">/usr/share/doc/dovecot/wiki/SSL.DovecotConfiguration.txt\u003C/code> file, which is installed along with the standard installation of \u003Ccode class=\"literal application\">Dovecot\u003C/code>.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tWhen modifying the settings in the \u003Ccode class=\"literal\">/etc/dovecot/conf.d/10-ssl.conf\u003C/code> configuration file, be sure to consider the following three directives at the minimum:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal option\">ssl_protocols\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse this directive to specify the version of TLS or SSL you want to allow or disable.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal option\">ssl_cipher_list\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse this directive to specify your preferred cipher suites or disable the ones you want to disallow.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal option\">ssl_prefer_server_ciphers\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUncomment and set this directive to \u003Ccode class=\"literal\">yes\u003C/code> to ensure that the connecting clients adhere to the order of ciphers you specified.\n\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\t\tFor example, the following line in \u003Ccode class=\"literal\">/etc/dovecot/conf.d/10-ssl.conf\u003C/code> allows only TLS 1.1 and later:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">ssl_protocols = !SSLv2 !SSLv3 !TLSv1\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/deploying_web_servers_and_reverse_proxies/index\">Deploying web servers and reverse proxies\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">config(5)\u003C/code> and \u003Ccode class=\"literal\">ciphers(1)\u003C/code> man pages.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://tools.ietf.org/html/rfc7525\">Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://mozilla.github.io/server-side-tls/ssl-config-generator/\">Mozilla SSL Configuration Generator\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.ssllabs.com/ssltest/\">SSL Server Test\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-a-vpn-connection_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 5. Setting up an IPsec VPN\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\u003Cspan id=\"configuring-a-vpn-with-ipsec_securing-networks\">\u003C!--Empty-->\u003C/span>\n\t\t\u003C/p>\u003Cp class=\"_abstract _abstract\">\n\t\t\tA virtual private network (VPN) is a way of connecting to a local network over the internet. \u003Ccode class=\"literal\">IPsec\u003C/code> provided by \u003Ccode class=\"literal\">Libreswan\u003C/code> is the preferred method for creating a VPN. \u003Ccode class=\"literal\">Libreswan\u003C/code> is a user-space \u003Ccode class=\"literal\">IPsec\u003C/code> implementation for VPN. A VPN enables the communication between your LAN, and another, remote LAN by setting up a tunnel across an intermediate network such as the internet. For security reasons, a VPN tunnel always uses authentication and encryption. For cryptographic operations, \u003Ccode class=\"literal\">Libreswan\u003C/code> uses the \u003Ccode class=\"literal\">NSS\u003C/code> library.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"libreswan-as-an-ipsec-vpn-implementation_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.1. Libreswan as an IPsec VPN implementation\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn RHEL, you can configure a Virtual Private Network (VPN) by using the IPsec protocol, which is supported by the Libreswan application. Libreswan is a continuation of the Openswan application, and many examples from the Openswan documentation are interchangeable with Libreswan.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe IPsec protocol for a VPN is configured using the Internet Key Exchange (IKE) protocol. The terms IPsec and IKE are used interchangeably. An IPsec VPN is also called an IKE VPN, IKEv2 VPN, XAUTH VPN, Cisco VPN or IKE/IPsec VPN. A variant of an IPsec VPN that also uses the Layer 2 Tunneling Protocol (L2TP) is usually called an L2TP/IPsec VPN, which requires the \u003Ccode class=\"literal\">xl2tpd\u003C/code> package provided by the \u003Ccode class=\"literal\">optional\u003C/code> repository.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tLibreswan is an open-source, user-space IKE implementation. IKE v1 and v2 are implemented as a user-level daemon. The IKE protocol is also encrypted. The IPsec protocol is implemented by the Linux kernel, and Libreswan configures the kernel to add and remove VPN tunnel configurations.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe IKE protocol uses UDP port 500 and 4500. The IPsec protocol consists of two protocols:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEncapsulated Security Payload (ESP), which has protocol number 50.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAuthenticated Header (AH), which has protocol number 51.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe AH protocol is not recommended for use. Users of AH are recommended to migrate to ESP with null encryption.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe IPsec protocol provides two modes of operation:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTunnel Mode (the default)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTransport Mode.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure the kernel with IPsec without IKE. This is called \u003Cspan class=\"emphasis\">\u003Cem>manual keying\u003C/em>\u003C/span>. You can also configure manual keying using the \u003Ccode class=\"literal command\">ip xfrm\u003C/code> commands, however, this is strongly discouraged for security reasons. Libreswan communicates with the Linux kernel using the Netlink interface. The kernel performs packet encryption and decryption.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tLibreswan uses the Network Security Services (NSS) cryptographic library. NSS is certified for use with the \u003Cspan class=\"emphasis\">\u003Cem>Federal Information Processing Standard\u003C/em>\u003C/span> (\u003Cspan class=\"emphasis\">\u003Cem>FIPS\u003C/em>\u003C/span>) Publication 140-2.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIKE/IPsec VPNs, implemented by Libreswan and the Linux kernel, is the only VPN technology recommended for use in RHEL. Do not use any other VPN technology without understanding the risks of doing so.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tIn RHEL, Libreswan follows \u003Cspan class=\"strong strong\">\u003Cstrong>system-wide cryptographic policies\u003C/strong>\u003C/span> by default. This ensures that Libreswan uses secure settings for current threat models including IKEv2 as a default protocol. See \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">Using system-wide crypto policies\u003C/a> for more information.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tLibreswan does not use the terms \"source\" and \"destination\" or \"server\" and \"client\" because IKE/IPsec are peer to peer protocols. Instead, it uses the terms \"left\" and \"right\" to refer to end points (the hosts). This also allows you to use the same configuration on both end points in most cases. However, administrators usually choose to always use \"left\" for the local host and \"right\" for the remote host.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal option\">leftid\u003C/code> and \u003Ccode class=\"literal option\">rightid\u003C/code> options serve as identification of the respective hosts in the authentication process. See the \u003Ccode class=\"literal\">ipsec.conf(5)\u003C/code> man page for more information.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"con_authentication-methods-in-libreswan_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.2. Authentication methods in Libreswan\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tLibreswan supports several authentication methods, each of which fits a different scenario.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Pre-Shared key (PSK)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>Pre-Shared Key\u003C/em>\u003C/span> (PSK) is the simplest authentication method. For security reasons, do not use PSKs shorter than 64 random characters. In FIPS mode, PSKs must comply with a minimum-strength requirement depending on the integrity algorithm used. You can set PSK by using the \u003Ccode class=\"literal\">authby=secret\u003C/code> connection.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Raw RSA keys\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>Raw RSA keys\u003C/em>\u003C/span> are commonly used for static host-to-host or subnet-to-subnet IPsec configurations. Each host is manually configured with the public RSA keys of all other hosts, and Libreswan sets up an IPsec tunnel between each pair of hosts. This method does not scale well for large numbers of hosts.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tYou can generate a raw RSA key on a host using the \u003Ccode class=\"literal\">ipsec newhostkey\u003C/code> command. You can list generated keys by using the \u003Ccode class=\"literal\">ipsec showhostkey\u003C/code> command. The \u003Ccode class=\"literal\">leftrsasigkey=\u003C/code> line is required for connection configurations that use CKA ID keys. Use the \u003Ccode class=\"literal\">authby=rsasig\u003C/code> connection option for raw RSA keys.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>X.509 certificates\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>X.509 certificates\u003C/em>\u003C/span> are commonly used for large-scale deployments with hosts that connect to a common IPsec gateway. A central \u003Cspan class=\"emphasis\">\u003Cem>certificate authority\u003C/em>\u003C/span> (CA) signs RSA certificates for hosts or users. This central CA is responsible for relaying trust, including the revocations of individual hosts or users.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tFor example, you can generate X.509 certificates using the \u003Ccode class=\"literal\">openssl\u003C/code> command and the NSS \u003Ccode class=\"literal\">certutil\u003C/code> command. Because Libreswan reads user certificates from the NSS database using the certificates' nickname in the \u003Ccode class=\"literal\">leftcert=\u003C/code> configuration option, provide a nickname when you create a certificate.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you use a custom CA certificate, you must import it to the Network Security Services (NSS) database. You can import any certificate in the PKCS #12 format to the Libreswan NSS database by using the \u003Ccode class=\"literal\">ipsec import\u003C/code> command.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tLibreswan requires an Internet Key Exchange (IKE) peer ID as a subject alternative name (SAN) for every peer certificate as described in \u003Ca class=\"link\" href=\"https://datatracker.ietf.org/doc/html/rfc4945#section-3.1\">section 3.1 of RFC 4945\u003C/a>. Disabling this check by changing the \u003Ccode class=\"literal\">require-id-on-certificated=\u003C/code> option can make the system vulnerable to man-in-the-middle attacks.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tUse the \u003Ccode class=\"literal\">authby=rsasig\u003C/code> connection option for authentication based on X.509 certificates using RSA with SHA-2. You can further limit it for ECDSA digital signatures using SHA-2 by setting \u003Ccode class=\"literal\">authby=\u003C/code> to \u003Ccode class=\"literal\">ecdsa\u003C/code> and RSA Probabilistic Signature Scheme (RSASSA-PSS) digital signatures based authentication with SHA-2 through \u003Ccode class=\"literal\">authby=rsa-sha2\u003C/code>. The default value is \u003Ccode class=\"literal\">authby=rsasig,ecdsa\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe certificates and the \u003Ccode class=\"literal\">authby=\u003C/code> signature methods should match. This increases interoperability and preserves authentication in one digital signature system.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>NULL authentication\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>NULL authentication\u003C/em>\u003C/span> is used to gain mesh encryption without authentication. It protects against passive attacks but not against active attacks. However, because IKEv2 allows asymmetric authentication methods, NULL authentication can also be used for internet-scale opportunistic IPsec. In this model, clients authenticate the server, but servers do not authenticate the client. This model is similar to secure websites using TLS. Use \u003Ccode class=\"literal\">authby=null\u003C/code> for NULL authentication.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Protection against quantum computers\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tIn addition to the previously mentioned authentication methods, you can use the \u003Cspan class=\"emphasis\">\u003Cem>Post-quantum Pre-shared Key\u003C/em>\u003C/span> (PPK) method to protect against possible attacks by quantum computers. Individual clients or groups of clients can use their own PPK by specifying a PPK ID that corresponds to an out-of-band configured pre-shared key.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tUsing IKEv1 with pre-shared keys protects against quantum attackers. The redesign of IKEv2 does not offer this protection natively. Libreswan offers the use of a \u003Cspan class=\"emphasis\">\u003Cem>Post-quantum Pre-shared Key\u003C/em>\u003C/span> (PPK) to protect IKEv2 connections against quantum attacks.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo enable optional PPK support, add \u003Ccode class=\"literal option\">ppk=yes\u003C/code> to the connection definition. To require PPK, add \u003Ccode class=\"literal option\">ppk=insist\u003C/code>. Then, each client can be given a PPK ID with a secret value that is communicated out-of-band (and preferably quantum-safe). The PPK’s should be very strong in randomness and not based on dictionary words. The PPK ID and PPK data are stored in the \u003Ccode class=\"literal\">ipsec.secrets\u003C/code> file, for example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">@west @east : PPKS \"user1\" \"thestringismeanttobearandomstr\"\u003C/pre>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal option\">PPKS\u003C/code> option refers to static PPKs. This experimental function uses one-time-pad-based Dynamic PPKs. Upon each connection, a new part of the one-time pad is used as the PPK. When used, that part of the dynamic PPK inside the file is overwritten with zeros to prevent re-use. If there is no more one-time-pad material left, the connection fails. See the \u003Ccode class=\"literal\">ipsec.secrets(5)\u003C/code> man page for more information.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe implementation of dynamic PPKs is provided as an unsupported Technology Preview. Use with caution.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"installing-libreswan_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.3. Installing Libreswan\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBefore you can set a VPN through the Libreswan IPsec/IKE implementation, you must install the corresponding packages, start the \u003Ccode class=\"literal\">ipsec\u003C/code> service, and allow the service in your firewall.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">AppStream\u003C/code> repository is enabled.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal package\">libreswan\u003C/code> packages:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install libreswan\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you are re-installing Libreswan, remove its old database files and create a new database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop ipsec\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm /var/lib/ipsec/nss/*db\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec initnss\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">ipsec\u003C/code> service, and enable the service to be started automatically on boot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable ipsec --now\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure the firewall to allow 500 and 4500/UDP ports for the IKE, ESP, and AH protocols by adding the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-service=\"ipsec\"\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"creating-a-host-to-host-vpn_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.4. Creating a host-to-host VPN\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can configure Libreswan to create a host-to-host IPsec VPN between two hosts referred to as \u003Cspan class=\"emphasis\">\u003Cem>left\u003C/em>\u003C/span> and \u003Cspan class=\"emphasis\">\u003Cem>right\u003C/em>\u003C/span> using authentication by raw RSA keys.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLibreswan is installed and the \u003Ccode class=\"literal\">ipsec\u003C/code> service is started on each node.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a raw RSA key pair on each host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec newhostkey\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe previous step returned the generated key’s \u003Ccode class=\"literal\">ckaid\u003C/code>. Use that \u003Ccode class=\"literal\">ckaid\u003C/code> with the following command on \u003Cspan class=\"emphasis\">\u003Cem>left\u003C/em>\u003C/span>, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec showhostkey --left --ckaid 2d3ea57b61c9419dfd6cf43a1eb6cb306c0e857d\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output of the previous command generated the \u003Ccode class=\"literal\">leftrsasigkey=\u003C/code> line required for the configuration. Do the same on the second host (\u003Cspan class=\"emphasis\">\u003Cem>right\u003C/em>\u003C/span>):\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec showhostkey --right --ckaid a9e1f6ce9ecd3608c24e8f701318383f41798f03\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal filename\">/etc/ipsec.d/\u003C/code> directory, create a new \u003Ccode class=\"literal filename\">my_host-to-host.conf\u003C/code> file. Write the RSA host keys from the output of the \u003Ccode class=\"literal command\">ipsec showhostkey\u003C/code> commands in the previous step to the new file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">conn mytunnel\n    leftid=@west\n    left=192.1.2.23\n    leftrsasigkey=0sAQOrlo+hOafUZDlCQmXFrje/oZm [...] W2n417C/4urYHQkCvuIQ==\n    rightid=@east\n    right=192.1.2.45\n    rightrsasigkey=0sAQO3fwC6nSSGgt64DWiYZzuHbc4 [...] D/v8t5YTQ==\n    authby=rsasig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAfter importing keys, restart the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLoad the connection:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --add mytunnel\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEstablish the tunnel:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up mytunnel\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo automatically start the tunnel when the \u003Ccode class=\"literal\">ipsec\u003C/code> service is started, add the following line to the connection definition:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">auto=start\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-site-to-site-vpn_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.5. Configuring a site-to-site VPN\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo create a site-to-site IPsec VPN, by joining two networks, an IPsec tunnel between the two hosts, is created. The hosts thus act as the end points, which are configured to permit traffic from one or more subnets to pass through. Therefore you can think of the host as gateways to the remote portion of the network.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe configuration of the site-to-site VPN only differs from the host-to-host VPN in that one or more networks or subnets must be specified in the configuration file.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA \u003Ca class=\"link\" href=\"#creating-a-host-to-host-vpn_configuring-a-vpn-with-ipsec\" title=\"5.4. Creating a host-to-host VPN\">host-to-host VPN\u003C/a> is already configured.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the file with the configuration of your host-to-host VPN to a new file, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cp /etc/ipsec.d/\u003Cspan class=\"emphasis\">\u003Cem>my_host-to-host.conf\u003C/em>\u003C/span> /etc/ipsec.d/\u003Cspan class=\"emphasis\">\u003Cem>my_site-to-site\u003C/em>\u003C/span>.conf\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the subnet configuration to the file created in the previous step, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">conn mysubnet\n     also=mytunnel\n     leftsubnet=192.0.1.0/24\n     rightsubnet=192.0.2.0/24\n     auto=start\n\nconn mysubnet6\n     also=mytunnel\n     leftsubnet=2001:db8:0:1::/64\n     rightsubnet=2001:db8:0:2::/64\n     auto=start\n\n# the following part of the configuration file is the same for both host-to-host and site-to-site connections:\n\nconn mytunnel\n    leftid=@west\n    left=192.1.2.23\n    leftrsasigkey=0sAQOrlo+hOafUZDlCQmXFrje/oZm [...] W2n417C/4urYHQkCvuIQ==\n    rightid=@east\n    right=192.1.2.45\n    rightrsasigkey=0sAQO3fwC6nSSGgt64DWiYZzuHbc4 [...] D/v8t5YTQ==\n    authby=rsasig\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-remote-access-vpn_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.6. Configuring a remote access VPN\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tRoad warriors are traveling users with mobile clients and a dynamically assigned IP address. The mobile clients authenticate using X.509 certificates.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example shows configuration for \u003Ccode class=\"literal\">IKEv2\u003C/code>, and it avoids using the \u003Ccode class=\"literal\">IKEv1\u003C/code> XAUTH protocol.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tOn the server:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">conn roadwarriors\n    ikev2=insist\n    # support (roaming) MOBIKE clients (RFC 4555)\n    mobike=yes\n    fragmentation=yes\n    left=1.2.3.4\n    # if access to the LAN is given, enable this, otherwise use 0.0.0.0/0\n    # leftsubnet=10.10.0.0/16\n    leftsubnet=0.0.0.0/0\n    leftcert=gw.example.com\n    leftid=%fromcert\n    leftxauthserver=yes\n    leftmodecfgserver=yes\n    right=%any\n    # trust our own Certificate Agency\n    rightca=%same\n    # pick an IP address pool to assign to remote users\n    # 100.64.0.0/16 prevents RFC1918 clashes when remote users are behind NAT\n    rightaddresspool=100.64.13.100-100.64.13.254\n    # if you want remote clients to use some local DNS zones and servers\n    modecfgdns=\"1.2.3.4, 5.6.7.8\"\n    modecfgdomains=\"internal.company.com, corp\"\n    rightxauthclient=yes\n    rightmodecfgclient=yes\n    authby=rsasig\n    # optionally, run the client X.509 ID through pam to allow or deny client\n    # pam-authorize=yes\n    # load connection, do not initiate\n    auto=add\n    # kill vanished roadwarriors\n    dpddelay=1m\n    dpdtimeout=5m\n    dpdaction=clear\u003C/pre>\u003Cp>\n\t\t\t\tOn the mobile client, the road warrior’s device, use a slight variation of the previous configuration:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">conn to-vpn-server\n    ikev2=insist\n    # pick up our dynamic IP\n    left=%defaultroute\n    leftsubnet=0.0.0.0/0\n    leftcert=myname.example.com\n    leftid=%fromcert\n    leftmodecfgclient=yes\n    # right can also be a DNS hostname\n    right=1.2.3.4\n    # if access to the remote LAN is required, enable this, otherwise use 0.0.0.0/0\n    # rightsubnet=10.10.0.0/16\n    rightsubnet=0.0.0.0/0\n    fragmentation=yes\n    # trust our own Certificate Agency\n    rightca=%same\n    authby=rsasig\n    # allow narrowing to the server’s suggested assigned IP and remote subnet\n    narrowing=yes\n    # support (roaming) MOBIKE clients (RFC 4555)\n    mobike=yes\n    # initiate connection\n    auto=start\u003C/pre>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-mesh-vpn_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.7. Configuring a mesh VPN\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tA mesh VPN network, which is also known as an \u003Cspan class=\"emphasis\">\u003Cem>any-to-any\u003C/em>\u003C/span> VPN, is a network where all nodes communicate using IPsec. The configuration allows for exceptions for nodes that cannot use IPsec. The mesh VPN network can be configured in two ways:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo require IPsec.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo prefer IPsec but allow a fallback to clear-text communication.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tAuthentication between the nodes can be based on X.509 certificates or on DNS Security Extensions (DNSSEC).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use any regular IKEv2 authentication method for \u003Cspan class=\"emphasis\">\u003Cem>opportunistic IPsec\u003C/em>\u003C/span>, because these connections are regular Libreswan configurations, except for the opportunistic IPsec that is defined by \u003Ccode class=\"literal\">right=%opportunisticgroup\u003C/code> entry. A common authentication method is for hosts to authenticate each other based on X.509 certificates using a commonly shared certification authority (CA). Cloud deployments typically issue certificates for each node in the cloud as part of the standard procedure.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not use PreSharedKey (PSK) authentication because one compromised host would result in group PSK secret being compromised as well.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tYou can use NULL authentication to deploy encryption between nodes without authentication, which protects only against passive attackers.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure uses X.509 certificates. You can generate these certificates by using any kind of CA management system, such as the Dogtag Certificate System. Dogtag assumes that the certificates for each node are available in the PKCS #12 format (\u003Ccode class=\"literal\">.p12\u003C/code> files), which contain the private key, the node certificate, and the Root CA certificate used to validate other nodes' X.509 certificates.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tEach node has an identical configuration with the exception of its X.509 certificate. This allows for adding new nodes without reconfiguring any of the existing nodes in the network. The PKCS #12 files require a \"friendly name\", for which we use the name \"node\" so that the configuration files referencing the friendly name can be identical for all nodes.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLibreswan is installed, and the \u003Ccode class=\"literal\">ipsec\u003C/code> service is started on each node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA new NSS database is initialized.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf you already have an old NSS database, remove the old database files:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop ipsec\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm /var/lib/ipsec/nss/*db\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tYou can initialize a new database with the following command:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec initnss\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn each node, import PKCS #12 files. This step requires the password used to generate the PKCS #12 files:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec import nodeXXX.p12\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the following three connection definitions for the \u003Ccode class=\"literal\">IPsec required\u003C/code> (private), \u003Ccode class=\"literal\">IPsec optional\u003C/code> (private-or-clear), and \u003Ccode class=\"literal\">No IPsec\u003C/code> (clear) profiles:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ipsec.d/mesh.conf\u003C/strong>\u003C/span>\nconn clear\n\tauto=ondemand \u003Cspan id=\"CO1-1\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">1\u003C/span>\n\ttype=passthrough\n\tauthby=never\n\tleft=%defaultroute\n\tright=%group\n\nconn private\n\tauto=ondemand\n\ttype=transport\n\tauthby=rsasig\n\tfailureshunt=drop\n\tnegotiationshunt=drop\n\tikev2=insist\n\tleft=%defaultroute\n\tleftcert=\u003Cspan class=\"emphasis\">\u003Cem>nodeXXXX\u003C/em>\u003C/span>\n\tleftid=%fromcert \u003Cspan id=\"CO1-2\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">2\u003C/span>\n\trightid=%fromcert\n\tright=%opportunisticgroup\n\nconn private-or-clear\n\tauto=ondemand\n\ttype=transport\n\tauthby=rsasig\n\tfailureshunt=passthrough\n\tnegotiationshunt=passthrough\n\t# left\n\tleft=%defaultroute\n\tleftcert=\u003Cspan class=\"emphasis\">\u003Cem>nodeXXXX\u003C/em>\u003C/span> \u003Cspan id=\"CO1-3\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">3\u003C/span>\n\tleftid=%fromcert\n\tleftrsasigkey=%cert\n\t# right\n\trightrsasigkey=%cert\n\trightid=%fromcert\n\tright=%opportunisticgroup\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"calloutlist\">\u003Cdl class=\"calloutlist\">\u003Cdt>\u003Ca href=\"#CO1-1\">\u003Cspan class=\"callout\">1\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">auto\u003C/code> variable has several options:\n\t\t\t\t\t\u003C/div>\u003Cp>\n\t\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">ondemand\u003C/code> connection option with opportunistic IPsec to initiate the IPsec connection, or for explicitly configured connections that do not need to be active all the time. This option sets up a trap XFRM policy in the kernel, enabling the IPsec connection to begin when it receives the first packet that matches that policy.\n\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\tYou can effectively configure and manage your IPsec connections, whether you use Opportunistic IPsec or explicitly configured connections, by using the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">The \u003Ccode class=\"literal\">add\u003C/code> option\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tLoads the connection configuration and prepares it for responding to remote initiations. However, the connection is not automatically initiated from the local side. You can manually start the IPsec connection by using the command \u003Ccode class=\"literal\">ipsec auto --up\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">The \u003Ccode class=\"literal\">start\u003C/code> option\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tLoads the connection configuration and prepares it for responding to remote initiations. Additionally, it immediately initiates a connection to the remote peer. You can use this option for permanent and always active connections.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO1-2\">\u003Cspan class=\"callout\">2\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">leftid\u003C/code> and \u003Ccode class=\"literal\">rightid\u003C/code> variables identify the right and the left channel of the IPsec tunnel connection. You can use these variables to obtain the value of the local IP address or the subject DN of the local certificate, if you have configured one.\n\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO1-3\">\u003Cspan class=\"callout\">3\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">leftcert\u003C/code> variable defines the nickname of the NSS database that you want to use.\n\t\t\t\t\t\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" start=\"3\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the IP address of the network to the corresponding category. For example, if all nodes reside in the \u003Ccode class=\"literal\">10.15.0.0/16\u003C/code> network, and all nodes must use IPsec encryption:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>echo \"10.15.0.0/16\" &gt;&gt; /etc/ipsec.d/policies/private\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo allow certain nodes, for example, \u003Ccode class=\"literal\">10.15.34.0/24\u003C/code>, to work with and without IPsec, add those nodes to the private-or-clear group:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>echo \"10.15.34.0/24\" &gt;&gt; /etc/ipsec.d/policies/private-or-clear\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo define a host, for example, \u003Ccode class=\"literal\">10.15.1.2\u003C/code>, which is not capable of IPsec into the clear group, use:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>echo \"10.15.1.2/32\" &gt;&gt; /etc/ipsec.d/policies/clear\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tYou can create the files in the \u003Ccode class=\"literal\">/etc/ipsec.d/policies\u003C/code> directory from a template for each new node, or you can provision them by using Puppet or Ansible.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tNote that every node has the same list of exceptions or different traffic flow expectations. Two nodes, therefore, might not be able to communicate because one requires IPsec and the other cannot use IPsec.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRestart the node to add it to the configured mesh:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen an IPsec tunnel by using the \u003Ccode class=\"literal\">ping\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ping \u003Cspan class=\"emphasis\">\u003Cem>&lt;nodeYYY&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the NSS database with the imported certification:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>certutil -L -d sql:/etc/ipsec.d\u003C/strong>\u003C/span>\n\nCertificate Nickname    Trust Attributes\n                        SSL,S/MIME,JAR/XPI\n\nwest                    u,u,u\nca                      CT,,\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSee which tunnels are open on the node:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec trafficstatus\u003C/strong>\u003C/span>\n006 #2: \"private#10.15.0.0/16\"[1] ...\u003Cspan class=\"emphasis\">\u003Cem>&lt;nodeYYY&gt;\u003C/em>\u003C/span>, type=ESP, add_time=1691399301, inBytes=512, outBytes=512, maxBytes=2^63B, id='C=US, ST=NC, O=Example Organization, CN=east'\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipsec.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about the \u003Ccode class=\"literal\">authby\u003C/code> variable, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/securing_networks/configuring-a-vpn-with-ipsec_securing-networks#con_authentication-methods-in-libreswan_configuring-a-vpn-with-ipsec\">6.2. Authentication methods in Libreswan\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-a-fips-compliant-ipsec-vpn_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.8. Deploying a FIPS-compliant IPsec VPN\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can deploy a FIPS-compliant IPsec VPN solution with Libreswan. To do so, you can identify which cryptographic algorithms are available and which are disabled for Libreswan in FIPS mode.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">AppStream\u003C/code> repository is enabled.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the \u003Ccode class=\"literal package\">libreswan\u003C/code> packages:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install libreswan\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you are re-installing Libreswan, remove its old NSS database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop ipsec\u003C/strong>\u003C/span>\n\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm /var/lib/ipsec/nss/*db\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStart the \u003Ccode class=\"literal\">ipsec\u003C/code> service, and enable the service to be started automatically on boot:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable ipsec --now\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure the firewall to allow \u003Ccode class=\"literal\">500\u003C/code> and \u003Ccode class=\"literal\">4500\u003C/code> UDP ports for the IKE, ESP, and AH protocols by adding the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-service=\"ipsec\"\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSwitch the system to FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>fips-mode-setup --enable\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart your system to allow the kernel to switch to FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfirm Libreswan is running in FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec whack --fipsstatus\u003C/strong>\u003C/span>\n000 FIPS mode enabled\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, check entries for the \u003Ccode class=\"literal\">ipsec\u003C/code> unit in the \u003Ccode class=\"literal\">systemd\u003C/code> journal:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -u ipsec\u003C/strong>\u003C/span>\n...\nJan 22 11:26:50 localhost.localdomain pluto[3076]: FIPS Mode: YES\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo see the available algorithms in FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec pluto --selftest 2&gt;&amp;1 | head -6\u003C/strong>\u003C/span>\nInitializing NSS using read-write database \"sql:/var/lib/ipsec/nss\"\nFIPS Mode: YES\nNSS crypto library initialized\nFIPS mode enabled for pluto daemon\nNSS library is running in FIPS mode\nFIPS HMAC integrity support [disabled]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo query disabled algorithms in FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec pluto --selftest 2&gt;&amp;1 | grep disabled\u003C/strong>\u003C/span>\nEncryption algorithm CAMELLIA_CTR disabled; not FIPS compliant\nEncryption algorithm CAMELLIA_CBC disabled; not FIPS compliant\nEncryption algorithm NULL disabled; not FIPS compliant\nEncryption algorithm CHACHA20_POLY1305 disabled; not FIPS compliant\nHash algorithm MD5 disabled; not FIPS compliant\nPRF algorithm HMAC_MD5 disabled; not FIPS compliant\nPRF algorithm AES_XCBC disabled; not FIPS compliant\nIntegrity algorithm HMAC_MD5_96 disabled; not FIPS compliant\nIntegrity algorithm HMAC_SHA2_256_TRUNCBUG disabled; not FIPS compliant\nIntegrity algorithm AES_XCBC_96 disabled; not FIPS compliant\nDH algorithm MODP1536 disabled; not FIPS compliant\nDH algorithm DH31 disabled; not FIPS compliant\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo list all allowed algorithms and ciphers in FIPS mode:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec pluto --selftest 2&gt;&amp;1 | grep ESP | grep FIPS | sed \"s/^.*FIPS//\"\u003C/strong>\u003C/span>\naes_ccm, aes_ccm_c\naes_ccm_b\naes_ccm_a\nNSS(CBC)  3des\nNSS(GCM)  aes_gcm, aes_gcm_c\nNSS(GCM)  aes_gcm_b\nNSS(GCM)  aes_gcm_a\nNSS(CTR)  aesctr\nNSS(CBC)  aes\naes_gmac\nNSS       sha, sha1, sha1_96, hmac_sha1\nNSS       sha512, sha2_512, sha2_512_256, hmac_sha2_512\nNSS       sha384, sha2_384, sha2_384_192, hmac_sha2_384\nNSS       sha2, sha256, sha2_256, sha2_256_128, hmac_sha2_256\naes_cmac\nnull\nNSS(MODP) null, dh0\nNSS(MODP) dh14\nNSS(MODP) dh15\nNSS(MODP) dh16\nNSS(MODP) dh17\nNSS(MODP) dh18\nNSS(ECP)  ecp_256, ecp256\nNSS(ECP)  ecp_384, ecp384\nNSS(ECP)  ecp_521, ecp521\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">Using system-wide cryptographic policies\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"protecting-the-ipsec-nss-database-by-a-password_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.9. Protecting the IPsec NSS database by a password\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, the IPsec service creates its Network Security Services (NSS) database with an empty password during the first start. To enhance security, you can add password protection.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/var/lib/ipsec/nss/\u003C/code> directory contains NSS database files.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable password protection for the \u003Ccode class=\"literal\">NSS\u003C/code> database for Libreswan:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>certutil -N -d sql:/var/lib/ipsec/nss\u003C/strong>\u003C/span>\nEnter Password or Pin for \"NSS Certificate DB\":\nEnter a password which will be used to encrypt your keys.\nThe password should be at least 8 characters long,\nand should contain at least one non-alphabetic character.\n\nEnter new password:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the \u003Ccode class=\"literal\">/etc/ipsec.d/nsspassword\u003C/code> file that containins the password you have set in the previous step, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>cat /etc/ipsec.d/nsspassword\u003C/strong>\u003C/span>\nNSS Certificate DB:_&lt;password&gt;_\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">nsspassword\u003C/code> file use the following syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;token_1&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;password1&gt;\u003C/em>\u003C/span>\n\u003Cspan class=\"emphasis\">\u003Cem>&lt;token_2&gt;\u003C/em>\u003C/span>:\u003Cspan class=\"emphasis\">\u003Cem>&lt;password2&gt;\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe default NSS software token is \u003Ccode class=\"literal\">NSS Certificate DB\u003C/code>. If your system is running in FIPS mode, the name of the token is \u003Ccode class=\"literal\">NSS FIPS 140-2 Certificate DB\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDepending on your scenario, either start or restart the \u003Ccode class=\"literal\">ipsec\u003C/code> service after you finish the \u003Ccode class=\"literal\">nsspassword\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">ipsec\u003C/code> service is running after you have added a non-empty password to its NSS database:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl status ipsec\u003C/strong>\u003C/span>\n● ipsec.service - Internet Key Exchange (IKE) Protocol Daemon for IPsec\n   Loaded: loaded (/usr/lib/systemd/system/ipsec.service; enabled; vendor preset: disable&gt;\n   Active: active (running)...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck that the \u003Ccode class=\"literal\">Journal\u003C/code> log contains entries that confirm a successful initialization:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -u ipsec\u003C/strong>\u003C/span>\n...\npluto[6214]: Initializing NSS using read-write database \"sql:/var/lib/ipsec/nss\"\npluto[6214]: NSS Password from file \"/etc/ipsec.d/nsspassword\" for token \"NSS Certificate DB\" with length 20 passed to NSS\npluto[6214]: NSS crypto library initialized\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">certutil(1)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFIPS 140-2 and FIPS 140-3 in the \u003Ca class=\"link\" href=\"https://access.redhat.com/articles/2918071#fips-140-2-and-fips-140-3-2\">Compliance Activities and Government Standards\u003C/a> Knowledgebase article.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-an-ipsec-vpn-to-use-tcp_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.10. Configuring an IPsec VPN to use TCP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tLibreswan supports TCP encapsulation of IKE and IPsec packets as described in RFC 8229. With this feature, you can establish IPsec VPNs on networks that prevent traffic transmitted via UDP and Encapsulating Security Payload (ESP). You can configure VPN servers and clients to use TCP either as a fallback or as the main VPN transport protocol. Because TCP encapsulation has bigger performance costs, use TCP as the main VPN protocol only if UDP is permanently blocked in your scenario.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA \u003Ca class=\"link\" href=\"#configuring-a-remote-access-vpn_configuring-a-vpn-with-ipsec\" title=\"5.6. Configuring a remote access VPN\">remote-access VPN\u003C/a> is already configured.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the following option to the \u003Ccode class=\"literal\">/etc/ipsec.conf\u003C/code> file in the \u003Ccode class=\"literal\">config setup\u003C/code> section:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">listen-tcp=yes\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo use TCP encapsulation as a fallback option when the first attempt over UDP fails, add the following two options to the client’s connection definition:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">enable-tcp=fallback\ntcp-remoteport=4500\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAlternatively, if you know that UDP is permanently blocked, use the following options in the client’s connection configuration:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">enable-tcp=yes\ntcp-remoteport=4500\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://tools.ietf.org/html/rfc8229\">IETF RFC 8229: TCP Encapsulation of IKE and IPsec Packets\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-automatic-detection-and-usage-of-esp-hardware-offload-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.11. Configuring automatic detection and usage of ESP hardware offload to accelerate an IPsec connection\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tOffloading Encapsulating Security Payload (ESP) to the hardware accelerates IPsec connections over Ethernet. By default, Libreswan detects if hardware supports this feature and, as a result, enables ESP hardware offload. In case that the feature was disabled or explicitly enabled, you can switch back to automatic detection.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe network card supports ESP hardware offload.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe network driver supports ESP hardware offload.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IPsec connection is configured and works.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEdit the Libreswan configuration file in the \u003Ccode class=\"literal\">/etc/ipsec.d/\u003C/code> directory of the connection that should use automatic detection of ESP hardware offload support.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure the \u003Ccode class=\"literal\">nic-offload\u003C/code> parameter is not set in the connection’s settings.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you removed \u003Ccode class=\"literal\">nic-offload\u003C/code>, restart the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the \u003Ccode class=\"literal\">tx_ipsec\u003C/code> and \u003Ccode class=\"literal\">rx_ipsec\u003C/code> counters of the Ethernet device the IPsec connection uses:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ethtool -S \u003Cspan class=\"emphasis\">\u003Cem>enp1s0\u003C/em>\u003C/span> | egrep \"_ipsec\"\u003C/strong>\u003C/span>\n     tx_ipsec: 10\n     rx_ipsec: 10\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSend traffic through the IPsec tunnel. For example, ping a remote IP address:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ping -c 5 \u003Cspan class=\"emphasis\">\u003Cem>remote_ip_address\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the \u003Ccode class=\"literal\">tx_ipsec\u003C/code> and \u003Ccode class=\"literal\">rx_ipsec\u003C/code> counters of the Ethernet device again:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ethtool -S \u003Cspan class=\"emphasis\">\u003Cem>enp1s0\u003C/em>\u003C/span> | egrep \"_ipsec\"\u003C/strong>\u003C/span>\n     tx_ipsec: 15\n     rx_ipsec: 15\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the counter values have increased, ESP hardware offload works.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-a-vpn-with-ipsec_securing-networks\">Configuring a VPN with IPsec\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-esp-hardware-offload-on-a-bond-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.12. Configuring ESP hardware offload on a bond to accelerate an IPsec connection\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tOffloading Encapsulating Security Payload (ESP) to the hardware accelerates IPsec connections. If you use a network bond for fail-over reasons, the requirements and the procedure to configure ESP hardware offload are different from those using a regular Ethernet device. For example, in this scenario, you enable the offload support on the bond, and the kernel applies the settings to the ports of the bond.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAll network cards in the bond support ESP hardware offload.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe network driver supports ESP hardware offload on a bond device. In RHEL, only the \u003Ccode class=\"literal\">ixgbe\u003C/code> driver supports this feature.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe bond is configured and works.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe bond uses the \u003Ccode class=\"literal\">active-backup\u003C/code> mode. The bonding driver does not support any other modes for this feature.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IPsec connection is configured and works.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable ESP hardware offload support on the network bond:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmcli connection modify \u003Cspan class=\"emphasis\">\u003Cem>bond0\u003C/em>\u003C/span> ethtool.feature-esp-hw-offload on\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis command enables ESP hardware offload support on the \u003Ccode class=\"literal systemitem\">bond0\u003C/code> connection.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReactivate the \u003Ccode class=\"literal systemitem\">bond0\u003C/code> connection:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmcli connection up \u003Cspan class=\"emphasis\">\u003Cem>bond0\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEdit the Libreswan configuration file in the \u003Ccode class=\"literal\">/etc/ipsec.d/\u003C/code> directory of the connection that should use ESP hardware offload, and append the \u003Ccode class=\"literal\">nic-offload=yes\u003C/code> statement to the connection entry:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">conn \u003Cspan class=\"emphasis\">\u003Cem>example\u003C/em>\u003C/span>\n    ...\n    \u003Cspan class=\"strong strong\">\u003Cstrong>nic-offload=yes\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the active port of the bond:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>grep \"Currently Active Slave\" /proc/net/bonding/\u003Cspan class=\"emphasis\">\u003Cem>bond0\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nCurrently Active Slave: \u003Cspan class=\"emphasis\">\u003Cem>enp1s0\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the \u003Ccode class=\"literal\">tx_ipsec\u003C/code> and \u003Ccode class=\"literal\">rx_ipsec\u003C/code> counters of the active port:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ethtool -S \u003Cspan class=\"emphasis\">\u003Cem>enp1s0\u003C/em>\u003C/span> | egrep \"_ipsec\"\u003C/strong>\u003C/span>\n     tx_ipsec: 10\n     rx_ipsec: 10\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSend traffic through the IPsec tunnel. For example, ping a remote IP address:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ping -c 5 \u003Cspan class=\"emphasis\">\u003Cem>remote_ip_address\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the \u003Ccode class=\"literal\">tx_ipsec\u003C/code> and \u003Ccode class=\"literal\">rx_ipsec\u003C/code> counters of the active port again:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ethtool -S enp1s0 | egrep \"_ipsec\"\u003C/strong>\u003C/span>\n     tx_ipsec: 15\n     rx_ipsec: 15\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the counter values have increased, ESP hardware offload works.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_managing_networking/configuring-network-bonding_configuring-and-managing-networking\">Configuring a network bond\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-a-vpn-with-ipsec_securing-networks\">Configuring a VPN with IPsec\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.13. Configuring VPN connections with IPsec by using the RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWith the \u003Ccode class=\"literal\">vpn\u003C/code> system role, you can configure VPN connections on RHEL systems by using Red Hat Ansible Automation Platform. You can use it to set up host-to-host, network-to-network, VPN Remote Access Server, and mesh configurations.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor host-to-host connections, the role sets up a VPN tunnel between each pair of hosts in the list of \u003Ccode class=\"literal\">vpn_connections\u003C/code> using the default parameters, including generating keys as needed. Alternatively, you can configure it to create an opportunistic mesh configuration between all hosts listed. The role assumes that the names of the hosts under \u003Ccode class=\"literal\">hosts\u003C/code> are the same as the names of the hosts used in the Ansible inventory, and that you can use those names to configure the tunnels.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">vpn\u003C/code> RHEL system role currently supports only Libreswan, which is an IPsec implementation, as the VPN provider.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.13.1. Creating a host-to-host VPN with IPsec by using the \u003Ccode class=\"literal\">vpn\u003C/code> RHEL system role\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">vpn\u003C/code> system role to configure host-to-host connections by running an Ansible playbook on the control node, which configures all managed nodes listed in an inventory file.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Host to host VPN\n  hosts: managed-node-01.example.com, managed-node-02.example.com\n  roles:\n    - rhel-system-roles.vpn\n  vars:\n    vpn_connections:\n      - hosts:\n          managed-node-01.example.com:\n          managed-node-02.example.com:\n    vpn_manage_firewall: true\n    vpn_manage_selinux: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis playbook configures the connection \u003Ccode class=\"literal\">managed-node-01.example.com-to-managed-node-02.example.com\u003C/code> by using pre-shared key authentication with keys auto-generated by the system role. Because \u003Ccode class=\"literal\">vpn_manage_firewall\u003C/code> and \u003Ccode class=\"literal\">vpn_manage_selinux\u003C/code> are both set to \u003Ccode class=\"literal\">true\u003C/code>, the \u003Ccode class=\"literal\">vpn\u003C/code> role uses the \u003Ccode class=\"literal\">firewall\u003C/code> and \u003Ccode class=\"literal\">selinux\u003C/code> roles to manage the ports used by the \u003Ccode class=\"literal\">vpn\u003C/code> role.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo configure connections from managed hosts to external hosts that are not listed in the inventory file, add the following section to the \u003Ccode class=\"literal\">vpn_connections\u003C/code> list of hosts:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">    vpn_connections:\n      - hosts:\n          managed-node-01.example.com:\n          \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>&lt;external_node&gt;\u003C/em>\u003C/span>:\u003C/strong>\u003C/span>\n            \u003Cspan class=\"strong strong\">\u003Cstrong>hostname: \u003Cspan class=\"emphasis\">\u003Cem>&lt;IP_address_or_hostname&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis configures one additional connection: \u003Ccode class=\"literal\">managed-node-01.example.com-to-\u003Cspan class=\"emphasis\">\u003Cem>&lt;external_node&gt;\u003C/em>\u003C/span>\u003C/code>\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tThe connections are configured only on the managed nodes and not on the external node.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOptional: You can specify multiple VPN connections for the managed nodes by using additional sections within \u003Ccode class=\"literal\">vpn_connections\u003C/code>, for example, a control plane and a data plane:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: Multiple VPN\n  hosts: managed-node-01.example.com, managed-node-02.example.com\n  roles:\n    - rhel-system-roles.vpn\n  vars:\n    vpn_connections:\n      - name: control_plane_vpn\n        hosts:\n          managed-node-01.example.com:\n            hostname: 192.0.2.0 # IP for the control plane\n          managed-node-02.example.com:\n            hostname: 192.0.2.1\n      - name: data_plane_vpn\n        hosts:\n          managed-node-01.example.com:\n            hostname: 10.0.0.1 # IP for the data plane\n          managed-node-02.example.com:\n            hostname: 10.0.0.2\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn the managed nodes, confirm that the connection is successfully loaded:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec status | grep \u003Cspan class=\"emphasis\">\u003Cem>&lt;connection_name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tReplace \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;connection_name&gt;\u003C/em>\u003C/span>\u003C/code> with the name of the connection from this node, for example \u003Ccode class=\"literal\">managed_node1-to-managed_node2\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tBy default, the role generates a descriptive name for each connection it creates from the perspective of each system. For example, when creating a connection between \u003Ccode class=\"literal\">managed_node1\u003C/code> and \u003Ccode class=\"literal\">managed_node2\u003C/code>, the descriptive name of this connection on \u003Ccode class=\"literal\">managed_node1\u003C/code> is \u003Ccode class=\"literal\">managed_node1-to-managed_node2\u003C/code> but on \u003Ccode class=\"literal\">managed_node2\u003C/code> the connection is named \u003Ccode class=\"literal\">managed_node2-to-managed_node1\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn the managed nodes, confirm that the connection is successfully started:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec trafficstatus | grep \u003Cspan class=\"emphasis\">\u003Cem>&lt;connection_name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOptional: If a connection does not successfully load, manually add the connection by entering the following command. This provides more specific information indicating why the connection failed to establish:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --add \u003Cspan class=\"emphasis\">\u003Cem>&lt;connection_name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tAny errors that may occur during the process of loading and starting the connection are reported in the \u003Ccode class=\"literal\">/var/log/pluto.log\u003C/code> file. Because these logs are hard to parse, manually add the connection to obtain log messages from the standard output instead.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.vpn/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/vpn/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.13.2. Creating an opportunistic mesh VPN connection with IPsec by using the \u003Ccode class=\"literal\">vpn\u003C/code> RHEL system role\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can use the \u003Ccode class=\"literal\">vpn\u003C/code> system role to configure an opportunistic mesh VPN connection that uses certificates for authentication by running an Ansible playbook on the control node, which will configure all the managed nodes listed in an inventory file.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe IPsec Network Security Services (NSS) crypto library in the \u003Ccode class=\"literal\">/etc/ipsec.d/\u003C/code> directory contains the necessary certificates.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">- name: \u003Cspan class=\"emphasis\">\u003Cem>Mesh VPN\u003C/em>\u003C/span>\n  hosts: managed-node-01.example.com, managed-node-02.example.com, managed-node-03.example.com\n  roles:\n    - rhel-system-roles.vpn\n  vars:\n    vpn_connections:\n      - opportunistic: true\n        auth_method: cert\n        policies:\n          - policy: private\n            cidr: default\n          - policy: private-or-clear\n            cidr: 198.51.100.0/24\n          - policy: private\n            cidr: 192.0.2.0/24\n          - policy: clear\n            cidr: 192.0.2.7/32\n    vpn_manage_firewall: true\n    vpn_manage_selinux: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAuthentication with certificates is configured by defining the \u003Ccode class=\"literal\">auth_method: cert\u003C/code> parameter in the playbook. By default, the node name is used as the certificate nickname. In this example, this is \u003Ccode class=\"literal\">managed-node-01.example.com\u003C/code>. You can define different certificate names by using the \u003Ccode class=\"literal\">cert_name\u003C/code> attribute in your inventory.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn this example procedure, the control node, which is the system from which you will run the Ansible playbook, shares the same classless inter-domain routing (CIDR) number as both of the managed nodes (192.0.2.0/24) and has the IP address 192.0.2.7. Therefore, the control node falls under the private policy which is automatically created for CIDR 192.0.2.0/24.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo prevent SSH connection loss during the play, a clear policy for the control node is included in the list of policies. Note that there is also an item in the policies list where the CIDR is equal to default. This is because this playbook overrides the rule from the default policy to make it private instead of private-or-clear.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tBecause \u003Ccode class=\"literal\">vpn_manage_firewall\u003C/code> and \u003Ccode class=\"literal\">vpn_manage_selinux\u003C/code> are both set to \u003Ccode class=\"literal\">true\u003C/code>, the \u003Ccode class=\"literal\">vpn\u003C/code> role uses the \u003Ccode class=\"literal\">firewall\u003C/code> and \u003Ccode class=\"literal\">selinux\u003C/code> roles to manage the ports used by the \u003Ccode class=\"literal\">vpn\u003C/code> role.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.vpn/README.md\u003C/code> file\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/vpn/\u003C/code> directory\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"configuring-ipsec-connections-that-opt-out-of-the-system-wide-crypto-policies_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.14. Configuring IPsec connections that opt out of the system-wide crypto policies\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"_abstract _abstract\">\u003Cp class=\"title\">\u003Cstrong>Overriding system-wide crypto-policies for a connection\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe RHEL system-wide cryptographic policies create a special connection called \u003Ccode class=\"literal\">%default\u003C/code>. This connection contains the default values for the \u003Ccode class=\"literal\">ikev2\u003C/code>, \u003Ccode class=\"literal\">esp\u003C/code>, and \u003Ccode class=\"literal\">ike\u003C/code> options. However, you can override the default values by specifying the mentioned option in the connection configuration file.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tFor example, the following configuration allows connections that use IKEv1 with AES and SHA-1 or SHA-2, and IPsec (ESP) with either AES-GCM or AES-CBC:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">conn MyExample\n  ...\n  ikev2=never\n  ike=aes-sha2,aes-sha1;modp2048\n  esp=aes_gcm,aes-sha2,aes-sha1\n  ...\u003C/pre>\u003Cp>\n\t\t\t\tNote that AES-GCM is available for IPsec (ESP) and for IKEv2, but not for IKEv1.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Disabling system-wide crypto policies for all connections\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTo disable system-wide crypto policies for all IPsec connections, comment out the following line in the \u003Ccode class=\"literal\">/etc/ipsec.conf\u003C/code> file:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\">include /etc/crypto-policies/back-ends/libreswan.config\u003C/pre>\u003Cp>\n\t\t\t\tThen add the \u003Ccode class=\"literal\">ikev2=never\u003C/code> option to your connection configuration file.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening\">Using system-wide cryptographic policies\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_troubleshooting-ipsec-vpn-configurations_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.15. Troubleshooting IPsec VPN configurations\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tProblems related to IPsec VPN configurations most commonly occur due to several main reasons. If you are encountering such problems, you can check if the cause of the problem corresponds to any of the following scenarios, and apply the corresponding solution.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Basic connection troubleshooting\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tMost problems with VPN connections occur in new deployments, where administrators configured endpoints with mismatched configuration options. Also, a working configuration can suddenly stop working, often due to newly introduced incompatible values. This could be the result of an administrator changing the configuration. Alternatively, an administrator may have installed a firmware update or a package update with different default values for certain options, such as encryption algorithms.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tTo confirm that an IPsec VPN connection is established:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec trafficstatus\u003C/strong>\u003C/span>\n006 #8: \"vpn.example.com\"[1] 192.0.2.1, type=ESP, add_time=1595296930, inBytes=5999, outBytes=3231, id='@vpn.example.com', lease=100.64.13.5/32\u003C/pre>\u003Cp>\n\t\t\t\tIf the output is empty or does not show an entry with the connection name, the tunnel is broken.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo check that the problem is in the connection:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReload the \u003Cspan class=\"emphasis\">\u003Cem>vpn.example.com\u003C/em>\u003C/span> connection:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --add \u003Cspan class=\"emphasis\">\u003Cem>vpn.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n002 added connection description \"vpn.example.com\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNext, initiate the VPN connection:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up \u003Cspan class=\"emphasis\">\u003Cem>vpn.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Firewall-related problems\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe most common problem is that a firewall on one of the IPsec endpoints or on a router between the endpoints is dropping all Internet Key Exchange (IKE) packets.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor IKEv2, an output similar to the following example indicates a problem with a firewall:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up \u003Cspan class=\"emphasis\">\u003Cem>vpn.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n181 \"vpn.example.com\"[1] 192.0.2.2 #15: initiating IKEv2 IKE SA\n181 \"vpn.example.com\"[1] 192.0.2.2 #15: STATE_PARENT_I1: sent v2I1, expected v2R1\n010 \"vpn.example.com\"[1] 192.0.2.2 #15: STATE_PARENT_I1: retransmission; will wait 0.5 seconds for response\n010 \"vpn.example.com\"[1] 192.0.2.2 #15: STATE_PARENT_I1: retransmission; will wait 1 seconds for response\n010 \"vpn.example.com\"[1] 192.0.2.2 #15: STATE_PARENT_I1: retransmission; will wait 2 seconds for\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor IKEv1, the output of the initiating command looks like:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up \u003Cspan class=\"emphasis\">\u003Cem>vpn.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n002 \"vpn.example.com\" #9: initiating Main Mode\n102 \"vpn.example.com\" #9: STATE_MAIN_I1: sent MI1, expecting MR1\n010 \"vpn.example.com\" #9: STATE_MAIN_I1: retransmission; will wait 0.5 seconds for response\n010 \"vpn.example.com\" #9: STATE_MAIN_I1: retransmission; will wait 1 seconds for response\n010 \"vpn.example.com\" #9: STATE_MAIN_I1: retransmission; will wait 2 seconds for response\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tBecause the IKE protocol, which is used to set up IPsec, is encrypted, you can troubleshoot only a limited subset of problems using the \u003Ccode class=\"literal\">tcpdump\u003C/code> tool. If a firewall is dropping IKE or IPsec packets, you can try to find the cause using the \u003Ccode class=\"literal\">tcpdump\u003C/code> utility. However, \u003Ccode class=\"literal\">tcpdump\u003C/code> cannot diagnose other problems with IPsec VPN connections.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo capture the negotiation of the VPN and all encrypted data on the \u003Ccode class=\"literal\">eth0\u003C/code> interface:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tcpdump -i eth0 -n -n esp or udp port 500 or udp port 4500 or tcp port 4500\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Mismatched algorithms, protocols, and policies\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tVPN connections require that the endpoints have matching IKE algorithms, IPsec algorithms, and IP address ranges. If a mismatch occurs, the connection fails. If you identify a mismatch by using one of the following methods, fix it by aligning algorithms, protocols, or policies.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the remote endpoint is not running IKE/IPsec, you can see an ICMP packet indicating it. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up \u003Cspan class=\"emphasis\">\u003Cem>vpn.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n...\n000 \"vpn.example.com\"[1] 192.0.2.2 #16: ERROR: asynchronous network error report on wlp2s0 (192.0.2.2:500), complainant 198.51.100.1: Connection refused [errno 111, origin ICMP type 3 code 3 (not authenticated)]\n...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExample of mismatched IKE algorithms:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up vpn.example.com\u003C/strong>\u003C/span>\n...\n003 \"vpn.example.com\"[1] 193.110.157.148 #3: dropping unexpected IKE_SA_INIT message containing NO_PROPOSAL_CHOSEN notification; message payloads: N; missing payloads: SA,KE,Ni\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExample of mismatched IPsec algorithms:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up vpn.example.com\u003C/strong>\u003C/span>\n...\n182 \"vpn.example.com\"[1] 193.110.157.148 #5: STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 cipher=AES_GCM_16_256 integ=n/a prf=HMAC_SHA2_256 group=MODP2048}\n002 \"vpn.example.com\"[1] 193.110.157.148 #6: IKE_AUTH response contained the error notification NO_PROPOSAL_CHOSEN\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA mismatched IKE version could also result in the remote endpoint dropping the request without a response. This looks identical to a firewall dropping all IKE packets.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExample of mismatched IP address ranges for IKEv2 (called Traffic Selectors - TS):\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up vpn.example.com\u003C/strong>\u003C/span>\n...\n1v2 \"vpn.example.com\" #1: STATE_PARENT_I2: sent v2I2, expected v2R2 {auth=IKEv2 cipher=AES_GCM_16_256 integ=n/a prf=HMAC_SHA2_512 group=MODP2048}\n002 \"vpn.example.com\" #2: IKE_AUTH response contained the error notification TS_UNACCEPTABLE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExample of mismatched IP address ranges for IKEv1:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up vpn.example.com\u003C/strong>\u003C/span>\n...\n031 \"vpn.example.com\" #2: STATE_QUICK_I1: 60 second timeout exceeded after 0 retransmits.  No acceptable response to our first Quick Mode message: perhaps peer likes no proposal\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen using PreSharedKeys (PSK) in IKEv1, if both sides do not put in the same PSK, the entire IKE message becomes unreadable:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up vpn.example.com\u003C/strong>\u003C/span>\n...\n003 \"vpn.example.com\" #1: received Hash Payload does not match computed value\n223 \"vpn.example.com\" #1: sending notification INVALID_HASH_INFORMATION to 192.0.2.23:500\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn IKEv2, the mismatched-PSK error results in an AUTHENTICATION_FAILED message:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec auto --up vpn.example.com\u003C/strong>\u003C/span>\n...\n002 \"vpn.example.com\" #1: IKE SA authentication request rejected by peer: AUTHENTICATION_FAILED\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Maximum transmission unit\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tOther than firewalls blocking IKE or IPsec packets, the most common cause of networking problems relates to an increased packet size of encrypted packets. Network hardware fragments packets larger than the maximum transmission unit (MTU), for example, 1500 bytes. Often, the fragments are lost and the packets fail to re-assemble. This leads to intermittent failures, when a ping test, which uses small-sized packets, works but other traffic fails. In this case, you can establish an SSH session but the terminal freezes as soon as you use it, for example, by entering the 'ls -al /usr' command on the remote host.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tTo work around the problem, reduce MTU size by adding the \u003Ccode class=\"literal\">mtu=1400\u003C/code> option to the tunnel configuration file.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAlternatively, for TCP connections, enable an iptables rule that changes the MSS value:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>iptables -I FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tIf the previous command does not solve the problem in your scenario, directly specify a lower size in the \u003Ccode class=\"literal\">set-mss\u003C/code> parameter:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>iptables -I FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --set-mss 1380\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Network address translation (NAT)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tWhen an IPsec host also serves as a NAT router, it could accidentally remap packets. The following example configuration demonstrates the problem:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\">conn myvpn\n    left=172.16.0.1\n    leftsubnet=10.0.2.0/24\n    right=172.16.0.2\n    rightsubnet=192.168.0.0/16\n…\u003C/pre>\u003Cp>\n\t\t\t\tThe system with address 172.16.0.1 have a NAT rule:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">iptables -t nat -I POSTROUTING -o eth0 -j MASQUERADE\u003C/pre>\u003Cp>\n\t\t\t\tIf the system on address 10.0.2.33 sends a packet to 192.168.0.1, then the router translates the source 10.0.2.33 to 172.16.0.1 before it applies the IPsec encryption.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThen, the packet with the source address 10.0.2.33 no longer matches the \u003Ccode class=\"literal\">conn myvpn\u003C/code> configuration, and IPsec does not encrypt this packet.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo solve this problem, insert rules that exclude NAT for target IPsec subnet ranges on the router, in this example:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">iptables -t nat -I POSTROUTING -s 10.0.2.0/24 -d 192.168.0.0/16 -j RETURN\u003C/pre>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Kernel IPsec subsystem bugs\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe kernel IPsec subsystem might fail, for example, when a bug causes a desynchronizing of the IKE user space and the IPsec kernel. To check for such problems:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat /proc/net/xfrm_stat\u003C/strong>\u003C/span>\nXfrmInError                 0\nXfrmInBufferError           0\n...\u003C/pre>\u003Cp>\n\t\t\t\tAny non-zero value in the output of the previous command indicates a problem. If you encounter this problem, open a new \u003Ca class=\"link\" href=\"https://access.redhat.com/support\">support case\u003C/a>, and attach the output of the previous command along with the corresponding IKE logs.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Libreswan logs\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tLibreswan logs using the \u003Ccode class=\"literal\">syslog\u003C/code> protocol by default. You can use the \u003Ccode class=\"literal\">journalctl\u003C/code> command to find log entries related to IPsec. Because the corresponding entries to the log are sent by the \u003Ccode class=\"literal\">pluto\u003C/code> IKE daemon, search for the “pluto” keyword, for example:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -b | grep pluto\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tTo show a live log for the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>journalctl -f -u ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tIf the default level of logging does not reveal your configuration problem, enable debug logs by adding the \u003Ccode class=\"literal\">plutodebug=all\u003C/code> option to the \u003Ccode class=\"literal\">config setup\u003C/code> section in the \u003Ccode class=\"literal\">/etc/ipsec.conf\u003C/code> file.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNote that debug logging produces a lot of entries, and it is possible that either the \u003Ccode class=\"literal\">journald\u003C/code> or \u003Ccode class=\"literal\">syslogd\u003C/code> service rate-limits the \u003Ccode class=\"literal\">syslog\u003C/code> messages. To ensure you have complete logs, redirect the logging to a file. Edit the \u003Ccode class=\"literal\">/etc/ipsec.conf\u003C/code>, and add the \u003Ccode class=\"literal\">logfile=/var/log/pluto.log\u003C/code> in the \u003Ccode class=\"literal\">config setup\u003C/code> section.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_basic_system_settings/assembly_troubleshooting-problems-using-log-files_configuring-basic-system-settings\">Troubleshooting problems by using log files\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">tcpdump(8)\u003C/code> and \u003Ccode class=\"literal\">ipsec.conf(5)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters\">Using and configuring firewalld\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-VPN-connection-with-control-center_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.16. Configuring a VPN connection with control-center\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you use Red Hat Enterprise Linux with a graphical interface, you can configure a VPN connection in the GNOME \u003Ccode class=\"literal\">control-center\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">NetworkManager-libreswan-gnome\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPress the \u003Ckbd class=\"keycap\">Super\u003C/kbd> key, type \u003Ccode class=\"literal\">Settings\u003C/code>, and press \u003Ckbd class=\"keycap\">Enter\u003C/kbd> to open the \u003Ccode class=\"literal\">control-center\u003C/code> application.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSelect the \u003Ccode class=\"literal\">Network\u003C/code> entry on the left.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the \u003Ckbd class=\"keycap\">+\u003C/kbd> icon.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSelect \u003Ccode class=\"literal\">VPN\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSelect the \u003Ccode class=\"literal\">Identity\u003C/code> menu entry to see the basic configuration options:\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>General\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Gateway\u003C/code> — The name or \u003Ccode class=\"literal\">IP\u003C/code> address of the remote VPN gateway.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Authentication\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Type\u003C/code>\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">IKEv2 (Certificate)\u003C/code>- client is authenticated by certificate. It is more secure (default).\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">IKEv1 (XAUTH)\u003C/code> - client is authenticated by user name and password, or a pre-shared key (PSK).\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe following configuration settings are available under the \u003Ccode class=\"literal\">Advanced\u003C/code> section:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"figu-Advanced-options-of-a-VPN-connection\">\u003Cp class=\"title\">\u003Cstrong>Figure 5.1. Advanced options of a VPN connection\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Securing_networks-en-US/images/8bbdb7fbdba750f4225e1c151d3db025/networking_vpn_advanced_options.png\" alt=\"networking vpn advanced options\"/>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tWhen configuring an IPsec-based VPN connection using the \u003Ccode class=\"literal\">gnome-control-center\u003C/code> application, the \u003Ccode class=\"literal\">Advanced\u003C/code> dialog displays the configuration, but it does not allow any changes. As a consequence, users cannot change any advanced IPsec options. Use the \u003Ccode class=\"literal\">nm-connection-editor\u003C/code> or \u003Ccode class=\"literal\">nmcli\u003C/code> tools instead to perform configuration of the advanced properties.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Identification\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Domain\u003C/code> — If required, enter the Domain Name.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Security\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Phase1 Algorithms\u003C/code> — corresponds to the \u003Ccode class=\"literal\">ike\u003C/code> Libreswan parameter — enter the algorithms to be used to authenticate and set up an encrypted channel.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Phase2 Algorithms\u003C/code> — corresponds to the \u003Ccode class=\"literal\">esp\u003C/code> Libreswan parameter — enter the algorithms to be used for the \u003Ccode class=\"literal\">IPsec\u003C/code> negotiations.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCheck the \u003Ccode class=\"literal\">Disable PFS\u003C/code> field to turn off Perfect Forward Secrecy (PFS) to ensure compatibility with old servers that do not support PFS.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Phase1 Lifetime\u003C/code> — corresponds to the \u003Ccode class=\"literal\">ikelifetime\u003C/code> Libreswan parameter — how long the key used to encrypt the traffic will be valid.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Phase2 Lifetime\u003C/code> — corresponds to the \u003Ccode class=\"literal\">salifetime\u003C/code> Libreswan parameter — how long a particular instance of a connection should last before expiring.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tNote that the encryption key should be changed from time to time for security reasons.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Remote network\u003C/code> — corresponds to the \u003Ccode class=\"literal\">rightsubnet\u003C/code> Libreswan parameter — the destination private remote network that should be reached through the VPN.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCheck the \u003Ccode class=\"literal\">narrowing\u003C/code> field to enable narrowing. Note that it is only effective in IKEv2 negotiation.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Enable fragmentation\u003C/code> — corresponds to the \u003Ccode class=\"literal\">fragmentation\u003C/code> Libreswan parameter — whether or not to allow IKE fragmentation. Valid values are \u003Ccode class=\"literal\">yes\u003C/code> (default) or \u003Ccode class=\"literal\">no\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Enable Mobike\u003C/code> — corresponds to the \u003Ccode class=\"literal\">mobike\u003C/code> Libreswan parameter — whether to allow Mobility and Multihoming Protocol (MOBIKE, RFC 4555) to enable a connection to migrate its endpoint without needing to restart the connection from scratch. This is used on mobile devices that switch between wired, wireless, or mobile data connections. The values are \u003Ccode class=\"literal\">no\u003C/code> (default) or \u003Ccode class=\"literal\">yes\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSelect the \u003Cspan class=\"guibutton\">IPv4\u003C/span> menu entry:\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>IPv4 Method\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Automatic (DHCP)\u003C/code> — Choose this option if the network you are connecting to uses a \u003Ccode class=\"literal\">DHCP\u003C/code> server to assign dynamic \u003Ccode class=\"literal\">IP\u003C/code> addresses.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Link-Local Only\u003C/code> — Choose this option if the network you are connecting to does not have a \u003Ccode class=\"literal\">DHCP\u003C/code> server and you do not want to assign \u003Ccode class=\"literal\">IP\u003C/code> addresses manually. Random addresses will be assigned as per \u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"citetitle citetitle\">\u003Ca class=\"link\" href=\"http://www.rfc-editor.org/info/rfc3927\">RFC 3927\u003C/a>\u003C/span>\u003C/em>\u003C/span> with prefix \u003Ccode class=\"literal\">169.254/16\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Manual\u003C/code> — Choose this option if you want to assign \u003Ccode class=\"literal\">IP\u003C/code> addresses manually.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Disable\u003C/code> — \u003Ccode class=\"literal\">IPv4\u003C/code> is disabled for this connection.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>DNS\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">DNS\u003C/code> section, when \u003Ccode class=\"literal\">Automatic\u003C/code> is \u003Ccode class=\"literal\">ON\u003C/code>, switch it to \u003Ccode class=\"literal\">OFF\u003C/code> to enter the IP address of a DNS server you want to use separating the IPs by comma.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Routes\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tNote that in the \u003Ccode class=\"literal\">Routes\u003C/code> section, when \u003Ccode class=\"literal\">Automatic\u003C/code> is \u003Ccode class=\"literal\">ON\u003C/code>, routes from DHCP are used, but you can also add additional static routes. When \u003Ccode class=\"literal\">OFF\u003C/code>, only static routes are used.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Address\u003C/code> — Enter the \u003Ccode class=\"literal\">IP\u003C/code> address of a remote network or host.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Netmask\u003C/code> — The netmask or prefix length of the \u003Ccode class=\"literal\">IP\u003C/code> address entered above.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Gateway\u003C/code> — The \u003Ccode class=\"literal\">IP\u003C/code> address of the gateway leading to the remote network or host entered above.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Metric\u003C/code> — A network cost, a preference value to give to this route. Lower values will be preferred over higher values.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Use this connection only for resources on its network\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSelect this check box to prevent the connection from becoming the default route. Selecting this option means that only traffic specifically destined for routes learned automatically over the connection or entered here manually is routed over the connection.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo configure \u003Ccode class=\"literal\">IPv6\u003C/code> settings in a \u003Ccode class=\"literal\">VPN\u003C/code> connection, select the \u003Cspan class=\"guibutton\">IPv6\u003C/span> menu entry:\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>IPv6 Method\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Automatic\u003C/code> — Choose this option to use \u003Ccode class=\"literal\">IPv6\u003C/code> Stateless Address AutoConfiguration (SLAAC) to create an automatic, stateless configuration based on the hardware address and Router Advertisements (RA).\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Automatic, DHCP only\u003C/code> — Choose this option to not use RA, but request information from \u003Ccode class=\"literal\">DHCPv6\u003C/code> directly to create a stateful configuration.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Link-Local Only\u003C/code> — Choose this option if the network you are connecting to does not have a \u003Ccode class=\"literal\">DHCP\u003C/code> server and you do not want to assign \u003Ccode class=\"literal\">IP\u003C/code> addresses manually. Random addresses will be assigned as per \u003Cspan class=\"emphasis\">\u003Cem>\u003Cspan class=\"citetitle citetitle\">\u003Ca class=\"link\" href=\"http://www.rfc-editor.org/info/rfc4862\">RFC 4862\u003C/a>\u003C/span>\u003C/em>\u003C/span> with prefix \u003Ccode class=\"literal\">FE80::0\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Manual\u003C/code> — Choose this option if you want to assign \u003Ccode class=\"literal\">IP\u003C/code> addresses manually.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Disable\u003C/code> — \u003Ccode class=\"literal\">IPv6\u003C/code> is disabled for this connection.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tNote that \u003Ccode class=\"literal\">DNS\u003C/code>, \u003Ccode class=\"literal\">Routes\u003C/code>, \u003Ccode class=\"literal\">Use this connection only for resources on its network\u003C/code> are common to \u003Ccode class=\"literal\">IPv4\u003C/code> settings.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOnce you have finished editing the \u003Ccode class=\"literal\">VPN\u003C/code> connection, click the \u003Cspan class=\"guibutton\">Add\u003C/span> button to customize the configuration or the \u003Cspan class=\"guibutton\">Apply\u003C/span> button to save it for the existing one.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSwitch the profile to \u003Ccode class=\"literal\">ON\u003C/code> to active the \u003Ccode class=\"literal\">VPN\u003C/code> connection.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">nm-settings-libreswan(5)\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _abstract\" id=\"configuring-a-vpn-connection-using-nm-connection-editor_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.17. Configuring a VPN connection using nm-connection-editor\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf you use Red Hat Enterprise Linux with a graphical interface, you can configure a VPN connection in the \u003Ccode class=\"literal\">nm-connection-editor\u003C/code> application.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">NetworkManager-libreswan-gnome\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you configure an Internet Key Exchange version 2 (IKEv2) connection:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe certificate is imported into the IPsec network security services (NSS) database.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe nickname of the certificate in the NSS database is known.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen a terminal, and enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>nm-connection-editor\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the \u003Cspan class=\"guibutton\">+\u003C/span> button to add a new connection.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSelect the \u003Ccode class=\"literal\">IPsec based VPN\u003C/code> connection type, and click \u003Cspan class=\"guibutton\">Create\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the \u003Ccode class=\"literal\">VPN\u003C/code> tab:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnter the host name or IP address of the VPN gateway into the \u003Ccode class=\"literal\">Gateway\u003C/code> field, and select an authentication type. Based on the authentication type, you must enter different additional information:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">IKEv2 (Certifiate)\u003C/code> authenticates the client by using a certificate, which is more secure. This setting requires the nickname of the certificate in the IPsec NSS database\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">IKEv1 (XAUTH)\u003C/code> authenticates the user by using a user name and password (pre-shared key). This setting requires that you enter the following values:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tUser name\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tPassword\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tGroup name\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tSecret\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the remote server specifies a local identifier for the IKE exchange, enter the exact string in the \u003Ccode class=\"literal\">Remote ID\u003C/code> field. In the remote server runs Libreswan, this value is set in the server’s \u003Ccode class=\"literal\">leftid\u003C/code> parameter.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Securing_networks-en-US/images/dbd1201152429f3672224d2020f5ffab/nm-connection-editor-vpn-tab.png\" alt=\"nm connection editor vpn tab\"/>\u003C/span>\n\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: Configure additional settings by clicking the \u003Cspan class=\"guibutton\">Advanced\u003C/span> button. You can configure the following settings:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tIdentification\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Domain\u003C/code> — If required, enter the domain name.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tSecurity\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Phase1 Algorithms\u003C/code> corresponds to the \u003Ccode class=\"literal\">ike\u003C/code> Libreswan parameter. Enter the algorithms to be used to authenticate and set up an encrypted channel.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Phase2 Algorithms\u003C/code> corresponds to the \u003Ccode class=\"literal\">esp\u003C/code> Libreswan parameter. Enter the algorithms to be used for the \u003Ccode class=\"literal\">IPsec\u003C/code> negotiations.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\tCheck the \u003Ccode class=\"literal\">Disable PFS\u003C/code> field to turn off Perfect Forward Secrecy (PFS) to ensure compatibility with old servers that do not support PFS.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Phase1 Lifetime\u003C/code> corresponds to the \u003Ccode class=\"literal\">ikelifetime\u003C/code> Libreswan parameter. This parameter defines how long the key used to encrypt the traffic is valid.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Phase2 Lifetime\u003C/code> corresponds to the \u003Ccode class=\"literal\">salifetime\u003C/code> Libreswan parameter. This parameter defines how long a security association is valid.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tConnectivity\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Remote network\u003C/code> corresponds to the \u003Ccode class=\"literal\">rightsubnet\u003C/code> Libreswan parameter and defines the destination private remote network that should be reached through the VPN.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\tCheck the \u003Ccode class=\"literal\">narrowing\u003C/code> field to enable narrowing. Note that it is only effective in the IKEv2 negotiation.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Enable fragmentation\u003C/code> corresponds to the \u003Ccode class=\"literal\">fragmentation\u003C/code> Libreswan parameter and defines whether or not to allow IKE fragmentation. Valid values are \u003Ccode class=\"literal\">yes\u003C/code> (default) or \u003Ccode class=\"literal\">no\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">Enable Mobike\u003C/code> corresponds to the \u003Ccode class=\"literal\">mobike\u003C/code> Libreswan parameter. The parameter defines whether to allow Mobility and Multihoming Protocol (MOBIKE) (RFC 4555) to enable a connection to migrate its endpoint without needing to restart the connection from scratch. This is used on mobile devices that switch between wired, wireless or mobile data connections. The values are \u003Ccode class=\"literal\">no\u003C/code> (default) or \u003Ccode class=\"literal\">yes\u003C/code>.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the \u003Ccode class=\"literal\">IPv4 Settings\u003C/code> tab, select the IP assignment method and, optionally, set additional static addresses, DNS servers, search domains, and routes.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Securing_networks-en-US/images/df41fd675600971c8b41909d6b8a522e/IPsec-IPv4-tab.png\" alt=\"IPsec IPv4 tab\"/>\u003C/span>\n\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the connection.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClose \u003Ccode class=\"literal\">nm-connection-editor\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tWhen you add a new connection by clicking the \u003Cspan class=\"guibutton\">+\u003C/span> button, \u003Cspan class=\"strong strong\">\u003Cstrong>NetworkManager\u003C/strong>\u003C/span> creates a new configuration file for that connection and then opens the same dialog that is used for editing an existing connection. The difference between these dialogs is that an existing connection profile has a \u003Cspan class=\"strong strong\">\u003Cstrong>Details\u003C/strong>\u003C/span> menu entry.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">nm-settings-libreswan(5)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.18. Configuring an IPsec based VPN connection by using nmstatectl\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIPsec (Internet Protocol Security) is a security protocol suite, provided by \u003Ccode class=\"literal\">Libreswan\u003C/code>, for implementation of VPN. IPsec includes protocols to initiate authentication at the time of connection establishment and manage keys during the data transfer. When an application deploys in a network and communicates by using the IP protocol, IPsec can protect data communication.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo manage an IPsec-based configuration for authenticating VPN connections, you can use the \u003Ccode class=\"literal\">nmstatectl\u003C/code> utility. This utility provides command line access to a declarative API for host network management. The following are the authentication types for the \u003Ccode class=\"literal\">host-to-subnet\u003C/code> and \u003Ccode class=\"literal\">host-to-host\u003C/code> communication modes:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHost-to-subnet PKI authentication\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHost-to-subnet RSA authentication\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHost-to-subnet PSK authentication\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHost-to-host tunnel mode authentication\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHost-to-host transport mode authentication\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"configuring-a-host-to-subnet-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.18.1. Configuring a host-to-subnet IPSec VPN with PKI authentication and tunnel mode by using nmstatectl\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tIf you want to use encryption based on the trusted entity authentication in IPsec, Public Key Infrastructure (PKI) provides secure communication by using cryptographic keys between two hosts. Both communicating hosts generate private and public keys where each host maintains a private key by sharing public key with the trusted entity Certificate Authority (CA). The CA generates a digital certificate after verifying the authenticity. In case of encryption and decryption, the host uses a private key for encryption and public key for decryption.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBy using Nmstate, a declarative API for network management, you can configure a PKI authentication-based IPsec connection. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, \u003Ccode class=\"literal\">nmstate\u003C/code> automatically rolls back the changes to avoid an incorrect state of the system.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tTo establish encrypted communication in \u003Ccode class=\"literal\">host-to-subnet\u003C/code> configuration, remote IPsec end provides another IP to host by using parameter \u003Ccode class=\"literal\">dhcp: true\u003C/code>. In the case of defining systems for \u003Ccode class=\"literal\">IPsec\u003C/code> in nmstate, the \u003Ccode class=\"literal\">left\u003C/code>-named system is the local host while the \u003Ccode class=\"literal\">right\u003C/code>-named system is the remote host. The following procedure needs to run on both hosts.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tBy using a password, you have generated a PKCS #12 file that stores certificates and cryptographic keys.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tInstall the required packages:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install nmstate libreswan NetworkManager-libreswan\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart the NetworkManager service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart NetworkManager\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAs \u003Ccode class=\"literal\">Libreswan\u003C/code> was already installed, remove its old database files and re-create them:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop ipsec\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm /etc/ipsec.d/*db\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec initnss\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnable and start the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tImport the PKCS#12 file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec import node-example.p12\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tWhen importing the PKCS#12 file, enter the password that was used to create the file.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a YAML file, for example \u003Ccode class=\"literal\">~/create-pki-authentication.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\ninterfaces:\n- name: 'example_ipsec_conn1'            \u003Cspan id=\"CO2-1\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">1\u003C/span>\n  type: ipsec\n  ipv4:\n    enabled: true\n    dhcp: true\n  libreswan:\n    ipsec-interface: 'yes'               \u003Cspan id=\"CO2-2\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">2\u003C/span>\n    left: '192.0.2.250'                  \u003Cspan id=\"CO2-3\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">3\u003C/span>\n    leftid: '%fromcert'                  \u003Cspan id=\"CO2-4\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">4\u003C/span>\n    leftcert: 'local-host.example.com'   \u003Cspan id=\"CO2-5\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">5\u003C/span>\n    right: '192.0.2.150'                 \u003Cspan id=\"CO2-6\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">6\u003C/span>\n    rightid: '%fromcert'                 \u003Cspan id=\"CO2-7\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">7\u003C/span>\n    ikev2: 'insist'                      \u003Cspan id=\"CO2-8\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">8\u003C/span>\n    ikelifetime: '24h'                   \u003Cspan id=\"CO2-9\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">9\u003C/span>\n    salifetime: '24h'                    \u003Cspan id=\"CO2-10\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">10\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe YAML file defines the following settings:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"calloutlist\">\u003Cdl class=\"calloutlist\">\u003Cdt>\u003Ca href=\"#CO2-1\">\u003Cspan class=\"callout\">1\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tAn IPsec connection name\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-2\">\u003Cspan class=\"callout\">2\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe value \u003Ccode class=\"literal\">yes\u003C/code> means \u003Ccode class=\"literal\">libreswan\u003C/code> creates an IPsec \u003Ccode class=\"literal\">xfrm\u003C/code> virtual interface \u003Ccode class=\"literal\">ipsec&lt;number&gt;\u003C/code> and automatically finds the next available number\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-3\">\u003Cspan class=\"callout\">3\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface for a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-4\">\u003Cspan class=\"callout\">4\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tOn a local host, the value of \u003Ccode class=\"literal\">%fromcert\u003C/code> sets the ID to a Distinguished Name (DN) that is fetched from a loaded certificate\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-5\">\u003Cspan class=\"callout\">5\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA Distinguished Name (DN) of a local host’s public key\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-6\">\u003Cspan class=\"callout\">6\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface for a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-7\">\u003Cspan class=\"callout\">7\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tOn a remote host, the value of \u003Ccode class=\"literal\">%fromcert\u003C/code> sets the ID to a Distinguished Name (DN) that is fetched from a loaded certificate.\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-8\">\u003Cspan class=\"callout\">8\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">insist\u003C/code> value accepts and receives only the Internet Key Exchange (IKEv2) protocol\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-9\">\u003Cspan class=\"callout\">9\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe duration of IKE protocol\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO2-10\">\u003Cspan class=\"callout\">10\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe duration of IPsec security association (SA)\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tApply settings to the system:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmstatectl apply ~/create-pki-authentication.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec status:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm status\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec policies:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm policy\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipsec.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-host-to-subnet-ipsec-vpn-with-rsa-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.18.2. Configuring a host-to-subnet IPSec VPN with RSA authentication and tunnel mode by using nmstatectl\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tIf you want to use asymmetric cryptography-based key authentication in IPsec, the RSA algorithm provides secure communication by using either of private and public keys for encryption and decryption between two hosts. This method uses a private key for encryption, and a public key for decryption.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBy using Nmstate, a declarative API for network management, you can configure RSA-based IPsec authentication. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, \u003Ccode class=\"literal\">nmstate\u003C/code> automatically rolls back the changes to avoid an incorrect state of the system.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tTo establish encrypted communication in \u003Ccode class=\"literal\">host-to-subnet\u003C/code> configuration, remote IPsec end provides another IP to host by using parameter \u003Ccode class=\"literal\">dhcp: true\u003C/code>. In the case of defining systems for \u003Ccode class=\"literal\">IPsec\u003C/code> in nmstate, the \u003Ccode class=\"literal\">left\u003C/code>-named system is the local host while the \u003Ccode class=\"literal\">right\u003C/code>-named system is the remote host. The following procedure needs to run on both hosts.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tInstall the required packages:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install nmstate libreswan NetworkManager-libreswan\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart the NetworkManager service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart NetworkManager\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf \u003Ccode class=\"literal\">Libreswan\u003C/code> was already installed, remove its old database files and re-create them:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop ipsec\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm /etc/ipsec.d/*db\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec initnss\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tGenerate a RSA key pair on each host:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec newhostkey --output\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisplay the public keys:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec showhostkey --list\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe previous step returned the generated key \u003Ccode class=\"literal\">ckaid\u003C/code>. Use that \u003Ccode class=\"literal\">ckaid\u003C/code> with the following command on left, for example:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec showhostkey --left --ckaid \u003Cspan class=\"emphasis\">\u003Cem>&lt;0sAwEAAesFfVZqFzRA9F&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe output of the previous command generated the \u003Ccode class=\"literal\">leftrsasigkey=\u003C/code> line required for the configuration. Do the same on the second host (right):\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec showhostkey --right --ckaid \u003Cspan class=\"emphasis\">\u003Cem>&lt;0sAwEAAesFfVZqFzRA9E&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnable the \u003Ccode class=\"literal\">ipsec\u003C/code> service to automatically start it on boot:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a YAML file, for example \u003Ccode class=\"literal\">~/create-rsa-authentication.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\ninterfaces:\n- name: 'example_ipsec_conn1'               \u003Cspan id=\"CO3-1\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">1\u003C/span>\n  type: ipsec                               \u003Cspan id=\"CO3-2\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">2\u003C/span>\n  ipv4:\n    enabled: true\n    dhcp: true\n  libreswan:\n    ipsec-interface: '99'                   \u003Cspan id=\"CO3-3\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">3\u003C/span>\n    leftrsasigkey: '0sAwEAAesFfVZqFzRA9F'   \u003Cspan id=\"CO3-4\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">4\u003C/span>\n    left: '192.0.2.250'                     \u003Cspan id=\"CO3-5\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">5\u003C/span>\n    leftid: 'local-host-rsa.example.com'    \u003Cspan id=\"CO3-6\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">6\u003C/span>\n    right: '192.0.2.150'                    \u003Cspan id=\"CO3-7\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">7\u003C/span>\n    rightrsasigkey: '0sAwEAAesFfVZqFzRA9E'  \u003Cspan id=\"CO3-8\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">8\u003C/span>\n    rightid: 'remote-host-rsa.example.com'  \u003Cspan id=\"CO3-9\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">9\u003C/span>\n    ikev2: 'insist'                         \u003Cspan id=\"CO3-10\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">10\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe YAML file defines the following settings:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"calloutlist\">\u003Cdl class=\"calloutlist\">\u003Cdt>\u003Ca href=\"#CO3-1\">\u003Cspan class=\"callout\">1\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tAn IPsec connection name\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-2\">\u003Cspan class=\"callout\">2\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tAn interface name\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-3\">\u003Cspan class=\"callout\">3\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe value \u003Ccode class=\"literal\">99\u003C/code> means that \u003Ccode class=\"literal\">libreswan\u003C/code> creates an IPsec \u003Ccode class=\"literal\">xfrm\u003C/code> virtual interface \u003Ccode class=\"literal\">ipsec&lt;number&gt;\u003C/code> and automatically finds the next available number\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-4\">\u003Cspan class=\"callout\">4\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe RSA public key of a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-5\">\u003Cspan class=\"callout\">5\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface of a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-6\">\u003Cspan class=\"callout\">6\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA Distinguished Name (DN) for a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-7\">\u003Cspan class=\"callout\">7\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe RSA public key of a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-8\">\u003Cspan class=\"callout\">8\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface of a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-9\">\u003Cspan class=\"callout\">9\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA Distinguished Name(DN) for a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO3-10\">\u003Cspan class=\"callout\">10\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">insist\u003C/code> value accepts and receives only the Internet Key Exchange (IKEv2) protocol\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tApply the settings to the system:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmstatectl apply ~/create-rsa-authentication.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisplay the IP settings of the network interface:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip addr show example_ipsec_conn1\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec status:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm status\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec policies:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm policy\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipsec.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-host-to-subnet-ipsec-vpn-with-psk-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.18.3. Configuring a host-to-subnet IPSec VPN with PSK authentication and tunnel mode by using nmstatectl\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tIf you want to use encryption based on mutual authentication in IPsec, the Pre-Shared Key (PSK) method provides secure communication by using a secret key between two hosts. A file stores the secret key and the same key encrypts the data flowing through the tunnel.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBy using Nmstate, a declarative API for network management, you can configure PSK-based IPsec authentication. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, \u003Ccode class=\"literal\">nmstate\u003C/code> automatically rolls back the changes to avoid incorrect state of the system.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tTo establish encrypted communication in \u003Ccode class=\"literal\">host-to-subnet\u003C/code> configuration, remote IPsec end provides another IP to host by using parameter \u003Ccode class=\"literal\">dhcp: true\u003C/code>. In the case of defining systems for \u003Ccode class=\"literal\">IPsec\u003C/code> in nmstate, the \u003Ccode class=\"literal\">left\u003C/code>-named system is the local host while the \u003Ccode class=\"literal\">right\u003C/code>-named system is the remote host. The following procedure needs to run on both hosts.\n\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tAs this method uses static strings for authentication and encryption, use it only for testing/development purposes.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tInstall the required packages:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install nmstate libreswan NetworkManager-libreswan\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart the NetworkManager service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart NetworkManager\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf \u003Ccode class=\"literal\">Libreswan\u003C/code> was already installed, remove its old database files and re-create them:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop ipsec\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm /etc/ipsec.d/*db\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec initnss\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnable the \u003Ccode class=\"literal\">ipsec\u003C/code> service to automatically start it on boot:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a YAML file, for example \u003Ccode class=\"literal\">~/create-pks-authentication.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\ninterfaces:\n- name: 'example_ipsec_conn1'           \u003Cspan id=\"CO4-1\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">1\u003C/span>\n  type: ipsec\n  ipv4:\n    enabled: true\n    dhcp: true\n  libreswan:\n    ipsec-interface: 'no'               \u003Cspan id=\"CO4-2\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">2\u003C/span>\n    right: '192.0.2.250'                \u003Cspan id=\"CO4-3\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">3\u003C/span>\n    rightid: 'remote-host.example.org'  \u003Cspan id=\"CO4-4\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">4\u003C/span>\n    left: '192.0.2.150'                 \u003Cspan id=\"CO4-5\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">5\u003C/span>\n    leftid: 'local-host.example.org'    \u003Cspan id=\"CO4-6\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">6\u003C/span>\n    psk: \"example_password\"\n    ikev2: 'insist'                     \u003Cspan id=\"CO4-7\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">7\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe YAML file defines the following settings:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"calloutlist\">\u003Cdl class=\"calloutlist\">\u003Cdt>\u003Ca href=\"#CO4-1\">\u003Cspan class=\"callout\">1\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tAn IPsec connection name\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO4-2\">\u003Cspan class=\"callout\">2\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tSetting \u003Ccode class=\"literal\">no\u003C/code> value indicates that \u003Ccode class=\"literal\">libreswan\u003C/code> creates only \u003Ccode class=\"literal\">xfrm\u003C/code> policies, and not a virtual \u003Ccode class=\"literal\">xfrm\u003C/code> interface\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO4-3\">\u003Cspan class=\"callout\">3\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface of a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO4-4\">\u003Cspan class=\"callout\">4\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA Distinguished Name (DN) for a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO4-5\">\u003Cspan class=\"callout\">5\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface of a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO4-6\">\u003Cspan class=\"callout\">6\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA Distinguished Name (DN) for a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO4-7\">\u003Cspan class=\"callout\">7\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">insist\u003C/code> value accepts and receives only the Internet Key Exchange (IKEv2) protocol\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tApply the settings to the system:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmstatectl apply ~/create-pks-authentication.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisplay the IP settings of network interface:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip addr show example_ipsec_conn1\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec status:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm status\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec policies:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm policy\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-host-to-host-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.18.4. Configuring a host-to-host IPsec VPN with PKI authentication and tunnel mode by using nmstatectl\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tIPsec (Internet Protocol Security) is a security protocol suite to authenticate and encrypt IP communications within networks and devices. The \u003Ccode class=\"literal\">Libreswan\u003C/code> software provides an IPsec implementation for VPNs.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIn tunnel mode, the source and destination IP address of communication is encrypted in the IPsec tunnel. External network sniffers can only get left IP and right IP. In general, for tunnel mode, it supports \u003Ccode class=\"literal\">host-to-host\u003C/code>, \u003Ccode class=\"literal\">host-to-subnet\u003C/code>, and \u003Ccode class=\"literal\">subnet-to-subnet\u003C/code>. In this mode, a new IP packet encapsulates an existing packet along with its payload and header. Encapsulation in this mode protects IP data, source, and destination headers over an unsecure network. This mode is useful to transfer data in \u003Ccode class=\"literal\">subnet-to-subnet\u003C/code>, remote access connections, and untrusted networks, such as open public Wi-Fi networks. By default, IPsec establishes a secure channel between two sites in tunnel mode. With the following configuration, you can establish a VPN connection as a \u003Ccode class=\"literal\">host-to-host\u003C/code> architecture.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBy using Nmstate, a declarative API for network management, you can configure an IPsec VPN connection. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, \u003Ccode class=\"literal\">nmstate\u003C/code> automatically rolls back the changes to avoid incorrect state of the system.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIn \u003Ccode class=\"literal\">host-to-host\u003C/code> configuration, you need to set \u003Ccode class=\"literal\">leftmodecfgclient: no\u003C/code> so that it can’t receive network configuration from the server, hence the value \u003Ccode class=\"literal\">no\u003C/code>. In the case of defining systems for \u003Ccode class=\"literal\">IPsec\u003C/code> in nmstate, the \u003Ccode class=\"literal\">left\u003C/code>-named system is the local host while the \u003Ccode class=\"literal\">right\u003C/code>-named system is the remote host. The following procedure needs to run on both hosts.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tBy using a password, you have generated a PKCS #12 file that stores certificates and cryptographic keys.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tInstall the required packages:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install nmstate libreswan NetworkManager-libreswan\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart the NetworkManager service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart NetworkManager\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAs \u003Ccode class=\"literal\">Libreswan\u003C/code> was already installed, remove its old database files and re-create them:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop ipsec\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm /etc/ipsec.d/*db\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec initnss\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tImport the PKCS#12 file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec import node-example.p12\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tWhen importing the PKCS#12 file, enter the password that was used to generate the file.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnable and start the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a YAML file, for example \u003Ccode class=\"literal\">~/create-p2p-vpn-authentication.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\ninterfaces:\n- name: 'example_ipsec_conn1'             \u003Cspan id=\"CO5-1\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">1\u003C/span>\n  type: ipsec\n  libreswan:\n    left: '192.0.2.250'                   \u003Cspan id=\"CO5-2\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">2\u003C/span>\n    leftid:  'local-host.example.com'     \u003Cspan id=\"CO5-3\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">3\u003C/span>\n    leftcert: 'local-host.example.com'    \u003Cspan id=\"CO5-4\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">4\u003C/span>\n    leftmodecfgclient: 'no'               \u003Cspan id=\"CO5-5\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">5\u003C/span>\n    right: '192.0.2.150'                  \u003Cspan id=\"CO5-6\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">6\u003C/span>\n    rightid: 'remote-host.example.com'    \u003Cspan id=\"CO5-7\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">7\u003C/span>\n    rightsubnet: '192.0.2.150/32'         \u003Cspan id=\"CO5-8\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">8\u003C/span>\n    ikev2: 'insist'                       \u003Cspan id=\"CO5-9\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">9\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe YAML file defines the following settings:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"calloutlist\">\u003Cdl class=\"calloutlist\">\u003Cdt>\u003Ca href=\"#CO5-1\">\u003Cspan class=\"callout\">1\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tAn IPsec connection name\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO5-2\">\u003Cspan class=\"callout\">2\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface for a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO5-3\">\u003Cspan class=\"callout\">3\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA distinguished Name (DN) of a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO5-4\">\u003Cspan class=\"callout\">4\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA certificate name installed on a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO5-5\">\u003Cspan class=\"callout\">5\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe value for not to retrieve client configuration from a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO5-6\">\u003Cspan class=\"callout\">6\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface for a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO5-7\">\u003Cspan class=\"callout\">7\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA distinguished Name (DN) of a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO5-8\">\u003Cspan class=\"callout\">8\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe subnet range of a remote host - \u003Ccode class=\"literal\">192.0.2.150\u003C/code> with \u003Ccode class=\"literal\">32\u003C/code> IPv4 addresses\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO5-9\">\u003Cspan class=\"callout\">9\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe value to accept and receive only the Internet Key Exchange (IKEv2) protocol\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tApply the settings to the system:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmstatectl apply ~/create-p2p-vpn-authentication.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisplay the created P2P policy:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm policy\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec status:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm status\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipsec.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-host-to-host-ipsec-vpn-with-psk-authentication-and-transport-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">5.18.5. Configuring a host-to-host IPsec VPN with PSK authentication and transport mode by using nmstatectl\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\t\tIPsec (Internet Protocol Security) is a security protocol suite to authenticate and encrypt IP communications within networks and devices. The \u003Ccode class=\"literal\">Libreswan\u003C/code> utility provides IPsec based implementation for VPN.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIn transport mode, encryption works only for the payload of an IP packet. Also, a new IPsec header gets appended to the IP packet by keeping the original IP header as it is. Transport mode does not encrypt the source and destination IP of communication but copies them to an external IP header. Hence, encryption protects only IP data across the network. This mode is useful to transfer data in a \u003Ccode class=\"literal\">host-to-host\u003C/code> connection of a network. This mode is often used along with the GRE tunnel to save 20 bytes (IP header) of overheads. By default, the \u003Ccode class=\"literal\">IPsec\u003C/code> utility uses tunnel mode. To use transfer mode, set \u003Ccode class=\"literal\">type: transport\u003C/code> for \u003Ccode class=\"literal\">host-to-host\u003C/code> connection data transfer.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBy using Nmstate, a declarative API for network management, you can configure an IPsec VPN connection. After setting the configuration, the Nmstate API ensures that the result matches with the configuration file. If anything fails, \u003Ccode class=\"literal\">nmstate\u003C/code> automatically rolls back the changes to avoid incorrect state of the system. To override the default \u003Ccode class=\"literal\">tunnel\u003C/code> mode, specify \u003Ccode class=\"literal\">transport\u003C/code> mode.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tIn the case of defining systems for \u003Ccode class=\"literal\">IPsec\u003C/code> in nmstate, the \u003Ccode class=\"literal\">left\u003C/code>-named system is the local host while the \u003Ccode class=\"literal\">right\u003C/code>-named system is the remote host. The following procedure needs to run on both hosts.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tBy using a password, you have generated a PKCS #12 file that stores certificates and cryptographic keys.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tInstall the required packages:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install nmstate libreswan NetworkManager-libreswan\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tRestart the NetworkManager service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart NetworkManager\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAs \u003Ccode class=\"literal\">Libreswan\u003C/code> was already installed, remove its old database files and re-create them:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop ipsec\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>rm /etc/ipsec.d/*db\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec initnss\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tImport the PKCS#12 file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipsec import node-example.p12\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tWhen importing the PKCS#12 file, enter the password that was used to create the file.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnable and start the \u003Ccode class=\"literal\">ipsec\u003C/code> service:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl enable --now ipsec\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a YAML file, for example \u003Ccode class=\"literal\">~/create-p2p-transport-authentication.yml\u003C/code>, with the following content:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\ninterfaces:\n- name: 'example_ipsec_conn1'           \u003Cspan id=\"CO6-1\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">1\u003C/span>\n  type: ipsec\n  libreswan:\n    type: 'transport'                   \u003Cspan id=\"CO6-2\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">2\u003C/span>\n    ipsec-interface: '99'               \u003Cspan id=\"CO6-3\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">3\u003C/span>\n    left: '192.0.2.250'                 \u003Cspan id=\"CO6-4\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">4\u003C/span>\n    leftid: '%fromcert'                 \u003Cspan id=\"CO6-5\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">5\u003C/span>\n    leftcert: 'local-host.example.org'  \u003Cspan id=\"CO6-6\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">6\u003C/span>\n    right: '192.0.2.150'                \u003Cspan id=\"CO6-7\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">7\u003C/span>\n    prefix-length: '32'                 \u003Cspan id=\"CO6-8\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">8\u003C/span>\n    rightid: '%fromcert'                \u003Cspan id=\"CO6-9\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">9\u003C/span>\n    ikev2: 'insist'                     \u003Cspan id=\"CO6-10\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">10\u003C/span>\n    ikelifetime: '24h'                  \u003Cspan id=\"CO6-11\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">11\u003C/span>\n    salifetime: '24h'                   \u003Cspan id=\"CO6-12\">\u003C!--Empty-->\u003C/span>\u003Cspan class=\"callout\">12\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe YAML file defines the following settings:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"calloutlist\">\u003Cdl class=\"calloutlist\">\u003Cdt>\u003Ca href=\"#CO6-1\">\u003Cspan class=\"callout\">1\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tAn IPsec connection name\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-2\">\u003Cspan class=\"callout\">2\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tAn IPsec mode\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-3\">\u003Cspan class=\"callout\">3\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe value \u003Ccode class=\"literal\">99\u003C/code> means that \u003Ccode class=\"literal\">libreswan\u003C/code> creates an IPsec \u003Ccode class=\"literal\">xfrm\u003C/code> virtual interface \u003Ccode class=\"literal\">ipsec&lt;number&gt;\u003C/code> and automatically finds the next available number\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-4\">\u003Cspan class=\"callout\">4\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface for a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-5\">\u003Cspan class=\"callout\">5\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tOn a local host, the value of \u003Ccode class=\"literal\">%fromcert\u003C/code> sets the ID to a Distinguished Name (DN) which is fetched from a loaded certificate\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-6\">\u003Cspan class=\"callout\">6\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA Distinguished Name (DN) of a local host’s public key\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-7\">\u003Cspan class=\"callout\">7\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tA static IPv4 address of public network interface for a remote host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-8\">\u003Cspan class=\"callout\">8\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe subnet mask of a static IPv4 address of a local host\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-9\">\u003Cspan class=\"callout\">9\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tOn a remote host, the value of \u003Ccode class=\"literal\">%fromcert\u003C/code> sets the ID to a Distinguished Name (DN) which is fetched from a loaded certificate\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-10\">\u003Cspan class=\"callout\">10\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe value to accept and receive only the Internet Key Exchange (IKEv2) protocol\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-11\">\u003Cspan class=\"callout\">11\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe duration of IKE protocol\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003Cdt>\u003Ca href=\"#CO6-12\">\u003Cspan class=\"callout\">12\u003C/span>\u003C/a> \u003C/dt>\u003Cdd>\u003Cdiv class=\"para\">\n\t\t\t\t\t\t\t\t\tThe duration of IPsec security association (SA)\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tApply the settings to the system:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmstatectl apply ~/create-p2p-transport-authentication.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec status:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm status\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVerify IPsec policies:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip xfrm policy\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipsec.conf(5)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"related-information-configuring-a-vpn-with-ipsec\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.19. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">ipsec(8)\u003C/code>, \u003Ccode class=\"literal\">ipsec.conf(5)\u003C/code>, \u003Ccode class=\"literal\">ipsec.secrets(5)\u003C/code>, \u003Ccode class=\"literal\">ipsec_auto(8)\u003C/code>, and \u003Ccode class=\"literal\">ipsec_rsasigkey(8)\u003C/code> man pages.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/libreswan-\u003Cspan class=\"emphasis\">\u003Cem>version\u003C/em>\u003C/span>/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://libreswan.org/wiki\">The Libreswan Project Wiki\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://libreswan.org/man/\">All Libreswan man pages\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://doi.org/10.6028/NIST.SP.800-77r1\">NIST Special Publication 800-77: Guide to IPsec VPNs\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"securing-network-services_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 6. Securing network services\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tRed Hat Enterprise Linux 9 supports many different types of network servers. Their network services can expose the system security to risks of various types of attacks, such as denial of service attacks (DoS), distributed denial of service attacks (DDoS), script vulnerability attacks, and buffer overflow attacks.\n\t\t\u003C/p>\u003Cp>\n\t\t\tTo increase the system security against attacks, it is important to monitor active network services that you use. For example, when a network service is running on a machine, its daemon listens for connections on network ports, and this can reduce the security. To limit exposure to attacks over the network, all services that are unused should be turned off.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"securing-the-rpcbind-service_securing-network-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.1. Securing the rpcbind service\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">rpcbind\u003C/code> service is a dynamic port-assignment daemon for remote procedure calls (RPC) services such as Network Information Service (NIS) and Network File System (NFS). Because it has weak authentication mechanisms and can assign a wide range of ports for the services it controls, it is important to secure \u003Ccode class=\"literal\">rpcbind\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can secure \u003Ccode class=\"literal\">rpcbind\u003C/code> by restricting access to all networks and defining specific exceptions using firewall rules on the server.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rpcbind\u003C/code> service is required on \u003Ccode class=\"literal\">NFSv3\u003C/code> servers.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rpcbind\u003C/code> service is not required on \u003Ccode class=\"literal\">NFSv4\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rpcbind\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">firewalld\u003C/code> package is installed and the service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd firewall rules, for example:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLimit TCP connection and accept packages only from the \u003Ccode class=\"literal\">192.168.0.0/24\u003C/code> host via the \u003Ccode class=\"literal\">111\u003C/code> port:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-rich-rule='rule family=\"ipv4\" port port=\"111\" protocol=\"tcp\" source address=\"192.168.0.0/24\" invert=\"True\" drop'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLimit TCP connection and accept packages only from local host via the \u003Ccode class=\"literal\">111\u003C/code> port:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-rich-rule='rule family=\"ipv4\" port port=\"111\" protocol=\"tcp\" source address=\"127.0.0.1\" accept'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLimit UDP connection and accept packages only from the \u003Ccode class=\"literal\">192.168.0.0/24\u003C/code> host via the \u003Ccode class=\"literal\">111\u003C/code> port:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --permanent --add-rich-rule='rule family=\"ipv4\" port port=\"111\" protocol=\"udp\" source address=\"192.168.0.0/24\" invert=\"True\" drop'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo make the firewall settings permanent, use the \u003Ccode class=\"literal\">--permanent\u003C/code> option when adding firewall rules.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReload the firewall to apply the new rules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList the firewall rules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --list-rich-rule\u003C/strong>\u003C/span>\nrule family=\"ipv4\" port port=\"111\" protocol=\"tcp\" source address=\"192.168.0.0/24\" invert=\"True\" drop\nrule family=\"ipv4\" port port=\"111\" protocol=\"tcp\" source address=\"127.0.0.1\" accept\nrule family=\"ipv4\" port port=\"111\" protocol=\"udp\" source address=\"192.168.0.0/24\" invert=\"True\" drop\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about \u003Ccode class=\"literal\">NFSv4-only\u003C/code> servers, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_and_using_network_file_services/deploying-an-nfs-server_configuring-and-using-network-file-services#configuring-an-nfsv4-only-server_deploying-an-nfs-server\">Configuring an NFSv4-only server\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters\">Using and configuring firewalld\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"securing-the-rpc-mountd-service_securing-network-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.2. Securing the rpc.mountd service\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">rpc.mountd\u003C/code> daemon implements the server side of the NFS mount protocol. The NFS mount protocol is used by NFS version 3 (RFC 1813).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can secure the \u003Ccode class=\"literal\">rpc.mountd\u003C/code> service by adding firewall rules to the server. You can restrict access to all networks and define specific exceptions using firewall rules.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">rpc.mountd\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">firewalld\u003C/code> package is installed and the service is running.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd firewall rules to the server, for example:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAccept \u003Ccode class=\"literal\">mountd\u003C/code> connections from the \u003Ccode class=\"literal\">192.168.0.0/24\u003C/code> host:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --add-rich-rule 'rule family=\"ipv4\" service name=\"mountd\" source address=\"192.168.0.0/24\" invert=\"True\" drop'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAccept \u003Ccode class=\"literal\">mountd\u003C/code> connections from the local host:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --permanent --add-rich-rule 'rule family=\"ipv4\" source address=\"127.0.0.1\" service name=\"mountd\" accept'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo make the firewall settings permanent, use the \u003Ccode class=\"literal\">--permanent\u003C/code> option when adding firewall rules.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReload the firewall to apply the new rules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --reload\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tList the firewall rules:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --list-rich-rule\u003C/strong>\u003C/span>\nrule family=\"ipv4\" service name=\"mountd\" source address=\"192.168.0.0/24\" invert=\"True\" drop\nrule family=\"ipv4\" source address=\"127.0.0.1\" service name=\"mountd\" accept\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/using-and-configuring-firewalld_firewall-packet-filters\">Using and configuring firewalld\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"securing-the-nfs-service_securing-network-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.3. Securing the NFS service\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can secure Network File System version 4 (NFSv4) by authenticating and encrypting all file system operations using Kerberos. When using NFSv4 with Network Address Translation (NAT) or a firewall, you can turn off the delegations by modifying the \u003Ccode class=\"literal\">/etc/default/nfs\u003C/code> file. Delegation is a technique by which the server delegates the management of a file to a client.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn contrast, NFSv3 do not use Kerberos for locking and mounting files.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe NFS service sends the traffic using TCP in all versions of NFS. The service supports Kerberos user and group authentication, as part of the \u003Ccode class=\"literal\">RPCSEC_GSS\u003C/code> kernel module.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNFS allows remote hosts to mount file systems over a network and interact with those file systems as if they are mounted locally. You can merge the resources on centralized servers and additionally customize NFS mount options in the \u003Ccode class=\"literal\">/etc/nfsmount.conf\u003C/code> file when sharing the file systems.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"export-options-for-securing-an-nfs-server_securing-the-nfs-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.3.1. Export options for securing an NFS server\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tThe NFS server determines a list structure of directories and hosts about which file systems to export to which hosts in the \u003Ccode class=\"literal\">/etc/exports\u003C/code> file.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tYou can use the following export options on the \u003Ccode class=\"literal\">/etc/exports\u003C/code> file:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ro\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tExports the NFS volume as read-only.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">rw\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tAllows read and write requests on the NFS volume. Use this option cautiously because allowing write access increases the risk of attacks. If your scenario requires mounting the directories with the \u003Ccode class=\"literal\">rw\u003C/code> option, make sure they are not writable for all users to reduce possible risks.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">root_squash\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tMaps requests from \u003Ccode class=\"literal\">uid\u003C/code>/\u003Ccode class=\"literal\">gid\u003C/code> 0 to the anonymous \u003Ccode class=\"literal\">uid\u003C/code>/\u003Ccode class=\"literal\">gid\u003C/code>. This does not apply to any other \u003Ccode class=\"literal\">uids\u003C/code> or \u003Ccode class=\"literal\">gids\u003C/code> that might be equally sensitive, such as the \u003Ccode class=\"literal\">bin\u003C/code> user or the \u003Ccode class=\"literal\">staff\u003C/code> group.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">no_root_squash\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tTurns off root squashing. By default, NFS shares change the \u003Ccode class=\"literal\">root\u003C/code> user to the \u003Ccode class=\"literal\">nobody\u003C/code> user, which is an unprivileged user account. This changes the owner of all the \u003Ccode class=\"literal\">root\u003C/code> created files to \u003Ccode class=\"literal\">nobody\u003C/code>, which prevents the uploading of programs with the \u003Ccode class=\"literal\">setuid\u003C/code> bit set. When using the \u003Ccode class=\"literal\">no_root_squash\u003C/code> option, remote root users can change any file on the shared file system and leave applications infected by trojans for other users.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">secure\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tRestricts exports to reserved ports. By default, the server allows client communication only through reserved ports. However, it is easy for anyone to become a \u003Ccode class=\"literal\">root\u003C/code> user on a client on many networks, so it is rarely safe for the server to assume that communication through a reserved port is privileged. Therefore the restriction to reserved ports is of limited value; it is better to rely on Kerberos, firewalls, and restriction of exports to particular clients.\n\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tExtra spaces in the syntax of the \u003Ccode class=\"literal\">/etc/exports\u003C/code> file can lead to major changes in the configuration.\n\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\tIn the following example, the \u003Ccode class=\"literal\">/tmp/nfs/\u003C/code> directory is shared with the \u003Ccode class=\"literal\">bob.example.com\u003C/code> host and has read and write permissions.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">/tmp/nfs/     bob.example.com(rw)\u003C/pre>\u003Cp>\n\t\t\t\t\t\tThe following example is the same as the previous one but shares the same directory to the \u003Ccode class=\"literal\">bob.example.com\u003C/code> host with read-only permissions and shares it to the \u003Cspan class=\"emphasis\">\u003Cem>world\u003C/em>\u003C/span> with read and write permissions due to a single space character after the hostname.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">/tmp/nfs/     bob.example.com (rw)\u003C/pre>\u003Cp>\n\t\t\t\t\t\tYou can check the shared directories on your system by entering the \u003Ccode class=\"literal\">showmount -e \u003Cspan class=\"emphasis\">\u003Cem>&lt;hostname&gt;\u003C/em>\u003C/span>\u003C/code> command.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\t\tAdditionally, consider the following best practices when exporting an NFS server:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tExporting home directories is a risk because some applications store passwords in plain text or in a weakly encrypted format. You can reduce the risk by reviewing and improving the application code.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSome users do not set passwords on SSH keys which again leads to risks with home directories. You can reduce these risks by enforcing the use of passwords or using Kerberos.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tRestrict the NFS exports only to required clients. Use the \u003Ccode class=\"literal\">showmount -e\u003C/code> command on the NFS server to review what the server is exporting. Do not export anything that is not specifically required.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tDo not allow unnecessary users to log in to a server to reduce the risk of attacks. You can periodically check who and what can access the server.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tExport an entire file system because exporting a subdirectory of a file system is not secure. An attacker might access the unexported part of a partially-exported file system.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/using_external_red_hat_utilities_with_identity_management/using-automount-in-idm_using-external-red-hat-utilities-with-idm\">Using automount in IdM\u003C/a> when using RHEL Identity Management\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">exports(5)\u003C/code> and \u003Ccode class=\"literal\">nfs(5)\u003C/code> man pages on your system\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"mount-options-for-securing-an-nfs-client_securing-the-nfs-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.3.2. Mount options for securing an NFS client\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can pass the following options to the \u003Ccode class=\"literal\">mount\u003C/code> command to increase the security of NFS-based clients:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nosuid\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">nosuid\u003C/code> option to disable the \u003Ccode class=\"literal\">set-user-identifier\u003C/code> or \u003Ccode class=\"literal\">set-group-identifier\u003C/code> bits. This prevents remote users from gaining higher privileges by running a \u003Ccode class=\"literal\">setuid\u003C/code> program and you can use this option opposite to \u003Ccode class=\"literal\">setuid\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">noexec\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">noexec\u003C/code> option to disable all executable files on the client. Use this to prevent users from accidentally executing files placed in the shared file system.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">nodev\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">nodev\u003C/code> option to prevent the client’s processing of device files as a hardware device.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">resvport\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">resvport\u003C/code> option to restrict communication to a reserved port and you can use a privileged source port to communicate with the server. The reserved ports are reserved for privileged users and processes such as the \u003Ccode class=\"literal\">root\u003C/code> user.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">sec\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">sec\u003C/code> option on the NFS server to choose the RPCGSS security flavor for accessing files on the mount point. Valid security flavors are \u003Ccode class=\"literal\">none\u003C/code>, \u003Ccode class=\"literal\">sys\u003C/code>, \u003Ccode class=\"literal\">krb5\u003C/code>, \u003Ccode class=\"literal\">krb5i\u003C/code>, and \u003Ccode class=\"literal\">krb5p\u003C/code>.\n\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tThe MIT Kerberos libraries provided by the \u003Ccode class=\"literal\">krb5-libs\u003C/code> package do not support the Data Encryption Standard (DES) algorithm in new deployments. DES is deprecated and disabled by default in Kerberos libraries because of security and compatibility reasons. Use newer and more secure algorithms instead of DES, unless your environment requires DES for compatibility reasons.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_file_systems/mounting-nfs-shares_managing-file-systems#frequently-used-nfs-mount-options_mounting-nfs-shares\">Frequently-used NFS mount options\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"securing-nfs-with-firewall_securing-the-nfs-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.3.3. Securing NFS with firewall\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tTo secure the firewall on an NFS server, keep only the required ports open. Do not use the NFS connection port numbers for any other service.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">nfs-utils\u003C/code> package is installed.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">firewalld\u003C/code> package is installed and running.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tOn NFSv4, the firewall must open TCP port \u003Ccode class=\"literal\">2049\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn NFSv3, open four additional ports with \u003Ccode class=\"literal\">2049\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">rpcbind\u003C/code> service assigns the NFS ports dynamically, which might cause problems when creating firewall rules. To simplify this process, use the \u003Ccode class=\"literal\">/etc/nfs.conf\u003C/code> file to specify which ports to use:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tSet TCP and UDP port for \u003Ccode class=\"literal\">mountd\u003C/code> (\u003Ccode class=\"literal\">rpc.mountd\u003C/code>) in the \u003Ccode class=\"literal\">[mountd]\u003C/code> section in \u003Ccode class=\"literal\">port=\u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tSet TCP and UDP port for \u003Ccode class=\"literal\">statd\u003C/code> (\u003Ccode class=\"literal\">rpc.statd\u003C/code>) in the \u003Ccode class=\"literal\">[statd]\u003C/code> section in \u003Ccode class=\"literal\">port=\u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tSet the TCP and UDP port for the NFS lock manager (\u003Ccode class=\"literal\">nlockmgr\u003C/code>) in the \u003Ccode class=\"literal\">/etc/nfs.conf\u003C/code> file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tSet TCP port for \u003Ccode class=\"literal\">nlockmgr\u003C/code> (\u003Ccode class=\"literal\">rpc.statd\u003C/code>) in the \u003Ccode class=\"literal\">[lockd]\u003C/code> section in \u003Ccode class=\"literal\">port=value\u003C/code> format. Alternatively, you can use the \u003Ccode class=\"literal\">nlm_tcpport\u003C/code> option in the \u003Ccode class=\"literal\">/etc/modprobe.d/lockd.conf\u003C/code> file.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tSet UDP port for \u003Ccode class=\"literal\">nlockmgr\u003C/code> (\u003Ccode class=\"literal\">rpc.statd\u003C/code>) in the \u003Ccode class=\"literal\">[lockd]\u003C/code> section in \u003Ccode class=\"literal\">udp-port=value\u003C/code> format. Alternatively, you can use the \u003Ccode class=\"literal\">nlm_udpport\u003C/code> option in the \u003Ccode class=\"literal\">/etc/modprobe.d/lockd.conf\u003C/code> file.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tList the active ports and RPC programs on the NFS server:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>rpcinfo -p\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"securing-the-ftp-service_securing-network-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.4. Securing the FTP service\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the File Transfer Protocol (FTP) to transfer files over a network. Because all FTP transactions with the server, including user authentication, are unencrypted, make sure it is configured securely.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tRHEL 9 provides two FTP servers:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Red Hat Content Accelerator (\u003Ccode class=\"literal\">tux\u003C/code>)\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tA kernel-space web server with FTP capabilities.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Very Secure FTP Daemon (\u003Ccode class=\"literal\">vsftpd\u003C/code>)\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tA standalone, security-oriented implementation of the FTP service.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tThe following security guidelines are for setting up the \u003Ccode class=\"literal\">vsftpd\u003C/code> FTP service.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"securing-the-ftp-greeting-banner_securing-the-ftp-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.4.1. Securing the FTP greeting banner\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tWhen a user connects to the FTP service, FTP shows a greeting banner, which by default includes version information. Attackers might use this information to identify weaknesses in the system. You can hide this information by changing the default banner.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tYou can define a custom banner by editing the \u003Ccode class=\"literal\">/etc/banners/ftp.msg\u003C/code> file to either directly include a single-line message, or to refer to a separate file, which can contain a multi-line message.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo define a single line message, add the following option to the \u003Ccode class=\"literal\">/etc/vsftpd/vsftpd.conf\u003C/code> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">ftpd_banner=Hello, all activity on ftp.example.com is logged.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo define a message in a separate file:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">.msg\u003C/code> file which contains the banner message, for example \u003Ccode class=\"literal\">/etc/banners/\u003Cspan class=\"emphasis\">\u003Cem>ftp\u003C/em>\u003C/span>.msg\u003C/code>:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">######### Hello, all activity on ftp.example.com is logged. #########\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tTo simplify the management of multiple banners, place all banners into the \u003Ccode class=\"literal\">/etc/banners/\u003C/code> directory.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tAdd the path to the banner file to the \u003Ccode class=\"literal\">banner_file\u003C/code> option in the \u003Ccode class=\"literal\">/etc/vsftpd/vsftpd.conf\u003C/code> file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">banner_file=/etc/banners/\u003Cspan class=\"emphasis\">\u003Cem>ftp\u003C/em>\u003C/span>.msg\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisplay the modified banner:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ftp localhost\u003C/strong>\u003C/span>\nTrying ::1…\nConnected to localhost (::1).\nHello, all activity on ftp.example.com is logged.\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"preventing-anonymous-access-and-uploads-in-ftp_securing-the-ftp-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.4.2. Preventing anonymous access and uploads in FTP\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tBy default, installing the \u003Ccode class=\"literal\">vsftpd\u003C/code> package creates the \u003Ccode class=\"literal\">/var/ftp/\u003C/code> directory and a directory tree for anonymous users with read-only permissions on the directories. Because anonymous users can access the data, do not store sensitive data in these directories.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tTo increase the security of the system, you can configure the FTP server to allow anonymous users to upload files to a specific directory and prevent anonymous users from reading data. In the following procedure, the anonymous user must be able to upload files in the directory owned by the \u003Ccode class=\"literal\">root\u003C/code> user but not change it.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tCreate a write-only directory in the \u003Ccode class=\"literal\">/var/ftp/pub/\u003C/code> directory:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>mkdir /var/ftp/pub/\u003Cspan class=\"emphasis\">\u003Cem>upload\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>chmod 730 /var/ftp/pub/\u003Cspan class=\"emphasis\">\u003Cem>upload\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>ls -ld /var/ftp/pub/\u003Cspan class=\"emphasis\">\u003Cem>upload\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\ndrwx-wx---. 2 root ftp 4096 Nov 14 22:57 /var/ftp/pub/upload\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAdd the following lines to the \u003Ccode class=\"literal\">/etc/vsftpd/vsftpd.conf\u003C/code> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">anon_upload_enable=YES\nanonymous_enable=YES\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tOptional: If your system has SELinux enabled and enforcing, enable SELinux boolean attributes \u003Ccode class=\"literal\">allow_ftpd_anon_write\u003C/code> and \u003Ccode class=\"literal\">allow_ftpd_full_access\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tAllowing anonymous users to read and write in directories might lead to the server becoming a repository for stolen software.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"securing-user-accounts-for-ftp_securing-the-ftp-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.4.3. Securing user accounts for FTP\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tFTP transmits usernames and passwords unencrypted over insecure networks for authentication. You can improve the security of FTP by denying system users access to the server from their user accounts.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tPerform as many of the following steps as applicable for your configuration.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tDisable all user accounts in the \u003Ccode class=\"literal\">vsftpd\u003C/code> server, by adding the following line to the \u003Ccode class=\"literal\">/etc/vsftpd/vsftpd.conf\u003C/code> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">local_enable=NO\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tDisable FTP access for specific accounts or specific groups of accounts, such as the \u003Ccode class=\"literal\">root\u003C/code> user and users with \u003Ccode class=\"literal\">sudo\u003C/code> privileges, by adding the usernames to the \u003Ccode class=\"literal\">/etc/pam.d/vsftpd\u003C/code> PAM configuration file.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tDisable user accounts, by adding the usernames to the \u003Ccode class=\"literal\">/etc/vsftpd/ftpusers\u003C/code> file.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_2\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.4.4. Additional resources\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ftpd_selinux(8)\u003C/code> man page on your system\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"securing-http-servers_securing-network-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.5. Securing HTTP servers\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Csection class=\"section\" id=\"security-enhancements-in-http-conf_securing-http-servers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.5.1. Security enhancements in httpd.conf\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tYou can enhance the security of the Apache HTTP server by configuring security options in the \u003Ccode class=\"literal\">/etc/httpd/conf/httpd.conf\u003C/code> file.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tAlways verify that all scripts running on the system work correctly before putting them into production.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tEnsure that only the \u003Ccode class=\"literal\">root\u003C/code> user has write permissions to any directory containing scripts or Common Gateway Interfaces (CGI). To change the directory ownership to \u003Ccode class=\"literal\">root\u003C/code> with write permissions, enter the following commands:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chown root \u003Cspan class=\"emphasis\">\u003Cem>&lt;directory_name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>chmod 755 \u003Cspan class=\"emphasis\">\u003Cem>&lt;directory_name&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\t\tIn the \u003Ccode class=\"literal\">/etc/httpd/conf/httpd.conf\u003C/code> file, you can configure the following options:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">FollowSymLinks\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThis directive is enabled by default and follows symbolic links in the directory.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">Indexes\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThis directive is enabled by default. Disable this directive to prevent visitors from browsing files on the server.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">UserDir\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\tThis directive is disabled by default because it can confirm the presence of a user account on the system. To activate user directory browsing for all user directories other than \u003Ccode class=\"literal\">/root/\u003C/code>, use the \u003Ccode class=\"literal\">UserDir enabled\u003C/code> and \u003Ccode class=\"literal\">UserDir disabled\u003C/code> root directives. To add users to the list of disabled accounts, add a space-delimited list of users on the \u003Ccode class=\"literal\">UserDir disabled\u003C/code> line.\n\t\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ServerTokens\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis directive controls the server response header field which is sent back to clients. You can use the following parameters to customize the information:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ServerTokens Full\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tProvides all available information such as web server version number, server operating system details, installed Apache modules, for example:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Apache/2.4.37 (Red Hat Enterprise Linux) MyMod/1.2\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ServerTokens Full-Release\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tProvides all available information with release versions, for example:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Apache/2.4.37 (Red Hat Enterprise Linux) (Release 41.module+el8.5.0+11772+c8e0c271)\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ServerTokens Prod / ServerTokens ProductOnly\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tProvides the web server name, for example:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Apache\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ServerTokens Major\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tProvides the web server major release version, for example:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Apache/2\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ServerTokens Minor\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tProvides the web server minor release version, for example:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Apache/2.4\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ServerTokens Min\u003C/code> / \u003Ccode class=\"literal\">ServerTokens Minimal\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tProvides the web server minimal release version, for example:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Apache/2.4.37\u003C/pre>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ServerTokens OS\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tProvides the web server release version and operating system, for example:\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">Apache/2.4.37 (Red Hat Enterprise Linux)\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ServerTokens Prod\u003C/code> option to reduce the risk of attackers gaining any valuable information about your system.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\tDo not remove the \u003Ccode class=\"literal\">IncludesNoExec\u003C/code> directive. By default, the Server Side Includes (SSI) module cannot execute commands. Changing this can allow an attacker to enter commands on the system.\n\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Removing httpd modules\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\tYou can remove the \u003Ccode class=\"literal\">httpd\u003C/code> modules to limit the functionality of the HTTP server. To do so, edit configuration files in the \u003Ccode class=\"literal\">/etc/httpd/conf.modules.d/\u003C/code> or \u003Ccode class=\"literal\">/etc/httpd/conf.d/\u003C/code> directory. For example, to remove the proxy module:\n\t\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"screen\">\u003Cspan class=\"strong strong\">\u003Cstrong>echo '# All proxy modules disabled' &gt; /etc/httpd/conf.modules.d/00-proxy.conf\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/deploying_different_types_of_servers/setting-apache-http-server_deploying-different-types-of-servers\">The Apache HTTP server\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/using_selinux/index#customizing-the-selinux-policy-for-the-apache-http-server-in-a-non-standard-configuration_configuring-selinux-for-applications-and-services-with-non-standard-configurations\">Customizing the SELinux policy for the Apache HTTP server\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"securing-the-nginx-server_securing-http-servers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.5.2. Securing the Nginx server configuration\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tNginx is a high-performance HTTP and proxy server. You can harden your Nginx configuration with the following configuration options.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tTo disable version strings, modify the \u003Ccode class=\"literal\">server_tokens\u003C/code> configuration option:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">server_tokens off;\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis option stops displaying additional details such as server version number. This configuration displays only the server name in all requests served by Nginx, for example:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>curl -sI http://localhost | grep Server\u003C/strong>\u003C/span>\nServer: nginx\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAdd extra security headers that mitigate certain known web application vulnerabilities in specific \u003Ccode class=\"literal\">/etc/nginx/\u003C/code> conf files:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor example, the \u003Ccode class=\"literal\">X-Frame-Options\u003C/code> header option denies any page outside of your domain to frame any content served by Nginx, mitigating clickjacking attacks:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">add_header X-Frame-Options \"SAMEORIGIN\";\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor example, the \u003Ccode class=\"literal\">x-content-type\u003C/code> header prevents MIME-type sniffing in certain older browsers:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">add_header X-Content-Type-Options nosniff;\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tFor example, the \u003Ccode class=\"literal\">X-XSS-Protection\u003C/code> header enables Cross-Site Scripting (XSS) filtering, which prevents browsers from rendering potentially malicious content included in a response by Nginx:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">add_header X-XSS-Protection \"1; mode=block\";\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can limit the services exposed to the public and limit what they do and accept from the visitors, for example:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">limit_except GET {\n    allow 192.168.1.0/32;\n    deny  all;\n}\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe snippet will limit access to all methods except \u003Ccode class=\"literal\">GET\u003C/code> and \u003Ccode class=\"literal\">HEAD\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tYou can disable HTTP methods, for example:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># Allow GET, PUT, POST; return \"405 Method Not Allowed\" for all others.\nif ( $request_method !~ ^(GET|PUT|POST)$ ) {\n    return 405;\n}\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou can configure SSL to protect the data served by your Nginx web server, consider serving it over HTTPS only. Furthermore, you can generate a secure configuration profile for enabling SSL in your Nginx server using the Mozilla SSL Configuration Generator. The generated configuration ensures that known vulnerable protocols (for example, SSLv2 and SSLv3), ciphers, and hashing algorithms (for example, 3DES and MD5) are disabled. You can also use the SSL Server Test to verify that your configuration meets modern security requirements.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://ssl-config.mozilla.org/\">Mozilla SSL Configuration Generator\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.ssllabs.com/ssltest/\">SSL Server Test\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"securing-postgresql-by-limiting-access-to-authenticated-local-users_securing-network-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.6. Securing PostgreSQL by limiting access to authenticated local users\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPostgreSQL is an object-relational database management system (DBMS). In Red Hat Enterprise Linux, PostgreSQL is provided by the \u003Ccode class=\"literal\">postgresql-server\u003C/code> package.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can reduce the risks of attacks by configuring client authentication. The \u003Ccode class=\"literal\">pg_hba.conf\u003C/code> configuration file stored in the database cluster’s data directory controls the client authentication. Follow the procedure to configure PostgreSQL for host-based authentication.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall PostgreSQL:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>yum install postgresql-server\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInitialize a database storage area using one of the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUsing the \u003Ccode class=\"literal\">initdb\u003C/code> utility:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>initdb -D \u003Cspan class=\"emphasis\">\u003Cem>/home/postgresql/db1/\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">initdb\u003C/code> command with the \u003Ccode class=\"literal\">-D\u003C/code> option creates the directory you specify if it does not already exist, for example \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>/home/postgresql/db1/\u003C/em>\u003C/span>\u003C/code>. This directory then contains all the data stored in the database and also the client authentication configuration file.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUsing the \u003Ccode class=\"literal\">postgresql-setup\u003C/code> script:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>postgresql-setup --initdb\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tBy default, the script uses the \u003Ccode class=\"literal\">/var/lib/pgsql/data/\u003C/code> directory. This script helps system administrators with basic database cluster administration.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo allow any authenticated local users to access any database with their usernames, modify the following line in the \u003Ccode class=\"literal\">pg_hba.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">local   all             all                                     trust\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis can be problematic when you use layered applications that create database users and no local users. If you do not want to explicitly control all user names on the system, remove the \u003Ccode class=\"literal\">local\u003C/code> line entry from the \u003Ccode class=\"literal\">pg_hba.conf\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the database to apply the changes:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart postgresql\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe previous command updates the database and also verifies the syntax of the configuration file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"securing-the-memcached-service_securing-network-services\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.7. Securing the Memcached service\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tMemcached is an open source, high-performance, distributed memory object caching system. It can improve the performance of dynamic web applications by lowering database load.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tMemcached is an in-memory key-value store for small chunks of arbitrary data, such as strings and objects, from results of database calls, API calls, or page rendering. Memcached allows assigning memory from underutilized areas to applications that require more memory.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn 2018, vulnerabilities of DDoS amplification attacks by exploiting Memcached servers exposed to the public internet were discovered. These attacks took advantage of Memcached communication using the UDP protocol for transport. The attack was effective because of the high amplification ratio where a request with the size of a few hundred bytes could generate a response of a few megabytes or even hundreds of megabytes in size.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn most situations, the \u003Ccode class=\"literal\">memcached\u003C/code> service does not need to be exposed to the public Internet. Such exposure may have its own security problems, allowing remote attackers to leak or modify information stored in Memcached.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"hardening-memcached-against-ddos_securing-the-memcached-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">6.7.1. Hardening Memcached against DDoS\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tTo mitigate security risks, perform as many of the following steps as applicable for your configuration.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tConfigure a firewall in your LAN. If your Memcached server should be accessible only in your local network, do not route external traffic to ports used by the \u003Ccode class=\"literal\">memcached\u003C/code> service. For example, remove the default port \u003Ccode class=\"literal\">11211\u003C/code> from the list of allowed ports:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --remove-port=11211/udp\u003C/strong>\u003C/span>\n# \u003Cspan class=\"strong strong\">\u003Cstrong>firewall-cmd --runtime-to-permanent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf you use a single Memcached server on the same machine as your application, set up \u003Ccode class=\"literal\">memcached\u003C/code> to listen to localhost traffic only. Modify the \u003Ccode class=\"literal\">OPTIONS\u003C/code> value in the \u003Ccode class=\"literal\">/etc/sysconfig/memcached\u003C/code> file:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">OPTIONS=\"-l 127.0.0.1,::1\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEnable Simple Authentication and Security Layer (SASL) authentication:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tModify or add the \u003Ccode class=\"literal\">/etc/sasl2/memcached.conf\u003C/code> file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">sasldb_path: /path.to/memcached.sasldb\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tAdd an account in the SASL database:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>saslpasswd2 -a memcached -c cacheuser -f /path.to/memcached.sasldb\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tEnsure that the database is accessible for the \u003Ccode class=\"literal\">memcached\u003C/code> user and group:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chown memcached:memcached /path.to/memcached.sasldb\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tEnable SASL support in Memcached by adding the \u003Ccode class=\"literal\">-S\u003C/code> value to the \u003Ccode class=\"literal\">OPTIONS\u003C/code> parameter in the \u003Ccode class=\"literal\">/etc/sysconfig/memcached\u003C/code> file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">OPTIONS=\"-S\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tRestart the Memcached server to apply the changes:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart memcached\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tAdd the username and password created in the SASL database to the Memcached client configuration of your application.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEncrypt communication between Memcached clients and servers with TLS:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tEnable encrypted communication between Memcached clients and servers with TLS by adding the \u003Ccode class=\"literal\">-Z\u003C/code> value to the \u003Ccode class=\"literal\">OPTIONS\u003C/code> parameter in the \u003Ccode class=\"literal\">/etc/sysconfig/memcached\u003C/code> file:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">OPTIONS=\"-Z\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tAdd the certificate chain file path in the PEM format using the \u003Ccode class=\"literal\">-o ssl_chain_cert\u003C/code> option.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tAdd a private key file path using the \u003Ccode class=\"literal\">-o ssl_key\u003C/code> option.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 7. Using MACsec to encrypt layer-2 traffic in the same physical network\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can use MACsec to secure the communication between two devices (point-to-point). For example, your branch office is connected over a Metro-Ethernet connection with the central office, you can configure MACsec on the two hosts that connect the offices to increase the security.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"how-macsec-increases-security_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.1. How MACsec increases security\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tMedia Access Control security (MACsec) is a layer-2 protocol that secures different traffic types over the Ethernet links, including:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDynamic host configuration protocol (DHCP)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\taddress resolution protocol (ARP)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIPv4 and IPv6 traffic\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAny traffic over IP such as TCP or UDP\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tMACsec encrypts and authenticates all traffic in LANs, by default with the GCM-AES-128 algorithm, and uses a pre-shared key to establish the connection between the participant hosts. To change the pre-shared key, you must update the NM configuration on all network hosts that use MACsec.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA MACsec connection uses an Ethernet device, such as an Ethernet network card, VLAN, or tunnel device, as a parent. You can either set an IP configuration only on the MACsec device to communicate with other hosts only by using the encrypted connection, or you can also set an IP configuration on the parent device. In the latter case, you can use the parent device to communicate with other hosts using an unencrypted connection and the MACsec device for encrypted connections.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tMACsec does not require any special hardware. For example, you can use any switch, except if you want to encrypt traffic only between a host and a switch. In this scenario, the switch must also support MACsec.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn other words, you can configure MACsec for two common scenarios:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHost-to-host\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHost-to-switch and switch-to-other-hosts\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can use MACsec only between hosts being in the same physical or virtual LAN.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://developers.redhat.com/blog/2016/10/14/macsec-a-different-solution-to-encrypt-network-traffic\">MACsec: a different solution to encrypt network traffic\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-a-macsec-connection-using-nmcli_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.2. Configuring a MACsec connection by using \u003Ccode class=\"literal\">nmcli\u003C/code>\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">nmcli\u003C/code> utility to configure Ethernet interfaces to use MACsec. For example, you can create a MACsec connection between two hosts that are connected over Ethernet.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the first host on which you configure MACsec:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the connectivity association key (CAK) and connectivity-association key name (CKN) for the pre-shared key:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tCreate a 16-byte hexadecimal CAK:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dd if=/dev/urandom count=16 bs=1 2&gt; /dev/null | hexdump -e '1/2 \"%04x\"'\u003C/strong>\u003C/span>\n50b71a8ef0bd5751ea76de6d6c98c03a\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tCreate a 32-byte hexadecimal CKN:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dd if=/dev/urandom count=32 bs=1 2&gt; /dev/null | hexdump -e '1/2 \"%04x\"'\u003C/strong>\u003C/span>\nf2b4297d39da7330910a74abc0449feb45b5c0b9fc23df1430e1898fcf1c4550\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOn both hosts you want to connect over a MACsec connection:\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the MACsec connection:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmcli connection add type macsec con-name macsec0 ifname macsec0 connection.autoconnect yes macsec.parent enp1s0 macsec.mode psk macsec.mka-cak 50b71a8ef0bd5751ea76de6d6c98c03a macsec.mka-ckn f2b4297d39da7330910a74abc0449feb45b5c0b9fc23df1430e1898fcf1c4550\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the CAK and CKN generated in the previous step in the \u003Ccode class=\"literal\">macsec.mka-cak\u003C/code> and \u003Ccode class=\"literal\">macsec.mka-ckn\u003C/code> parameters. The values must be the same on every host in the MACsec-protected network.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConfigure the IP settings on the MACsec connection.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConfigure the \u003Ccode class=\"literal\">IPv4\u003C/code> settings. For example, to set a static \u003Ccode class=\"literal\">IPv4\u003C/code> address, network mask, default gateway, and DNS server to the \u003Ccode class=\"literal\">macsec0\u003C/code> connection, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmcli connection modify macsec0 ipv4.method manual ipv4.addresses '192.0.2.1/24' ipv4.gateway '192.0.2.254' ipv4.dns '192.0.2.253'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConfigure the \u003Ccode class=\"literal\">IPv6\u003C/code> settings. For example, to set a static \u003Ccode class=\"literal\">IPv6\u003C/code> address, network mask, default gateway, and DNS server to the \u003Ccode class=\"literal\">macsec0\u003C/code> connection, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmcli connection modify macsec0 ipv6.method manual ipv6.addresses '2001:db8:1::1/32' ipv6.gateway '2001:db8:1::fffe' ipv6.dns '2001:db8:1::fffd'\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tActivate the connection:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmcli connection up macsec0\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the traffic is encrypted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tcpdump -nn -i enp1s0\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Display the unencrypted traffic:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tcpdump -nn -i macsec0\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay MACsec statistics:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip macsec show\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay individual counters for each type of protection: integrity-only (encrypt off) and encryption (encrypt on)\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip -s macsec show\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://developers.redhat.com/blog/2016/10/14/macsec-a-different-solution-to-encrypt-network-traffic\">MACsec: a different solution to encrypt network traffic\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-macsec-connection-using-nmstatectl_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.3. Configuring a MACsec connection by using \u003Ccode class=\"literal\">nmstatectl\u003C/code>\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can configure Ethernet interfaces to use MACsec through the \u003Ccode class=\"literal\">nmstatectl\u003C/code> utility in a declarative way. For example, in a YAML file, you describe the desired state of your network, which is supposed to have a MACsec connection between two hosts connected over Ethernet. The \u003Ccode class=\"literal\">nmstatectl\u003C/code> utility interprets the YAML file and deploys persistent and consistent network configuration across the hosts.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUsing the MACsec security standard for securing communication at the link layer, also known as layer 2 of the Open Systems Interconnection (OSI) model provides the following notable benefits:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEncryption at layer 2 eliminates the need for encrypting individual services at layer 7. This reduces the overhead associated with managing a large number of certificates for each endpoint on each host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPoint-to-point security between directly connected network devices such as routers and switches.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo changes needed for applications and higher-layer protocols.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA physical or virtual Ethernet Network Interface Controller (NIC) exists in the server configuration.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">nmstate\u003C/code> package is installed.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the first host on which you configure MACsec, create the connectivity association key (CAK) and connectivity-association key name (CKN) for the pre-shared key:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a 16-byte hexadecimal CAK:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dd if=/dev/urandom count=16 bs=1 2&gt; /dev/null | hexdump -e '1/2 \"%04x\"'\u003C/strong>\u003C/span>\n50b71a8ef0bd5751ea76de6d6c98c03a\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a 32-byte hexadecimal CKN:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dd if=/dev/urandom count=32 bs=1 2&gt; /dev/null | hexdump -e '1/2 \"%04x\"'\u003C/strong>\u003C/span>\nf2b4297d39da7330910a74abc0449feb45b5c0b9fc23df1430e1898fcf1c4550\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn both hosts that you want to connect over a MACsec connection, complete the following steps:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a YAML file, for example \u003Ccode class=\"literal\">create-macsec-connection.yml\u003C/code>, with the following settings:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\nroutes:\n  config:\n  - destination: 0.0.0.0/0\n    next-hop-interface: macsec0\n    next-hop-address: 192.0.2.2\n    table-id: 254\n  - destination: 192.0.2.2/32\n    next-hop-interface: macsec0\n    next-hop-address: 0.0.0.0\n    table-id: 254\ndns-resolver:\n  config:\n    search:\n    - example.com\n    server:\n    - 192.0.2.200\n    - 2001:db8:1::ffbb\ninterfaces:\n- name: macsec0\n  type: macsec\n  state: up\n  ipv4:\n    enabled: true\n    address:\n    - ip: 192.0.2.1\n      prefix-length: 32\n  ipv6:\n    enabled: true\n    address:\n    - ip: 2001:db8:1::1\n      prefix-length: 64\n  macsec:\n    encrypt: true\n    base-iface: enp0s1\n    mka-cak: 50b71a8ef0bd5751ea76de6d6c98c03a\n    mka-ckn: f2b4297d39da7330910a74abc0449feb45b5c0b9fc23df1430e1898fcf1c4550\n    port: 0\n    validation: strict\n    send-sci: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the CAK and CKN generated in the previous step in the \u003Ccode class=\"literal\">mka-cak\u003C/code> and \u003Ccode class=\"literal\">mka-ckn\u003C/code> parameters. The values must be the same on every host in the MACsec-protected network.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: In the same YAML configuration file, you can also configure the following settings:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tA static IPv4 address - \u003Ccode class=\"literal\">192.0.2.1\u003C/code> with the \u003Ccode class=\"literal\">/32\u003C/code> subnet mask\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tA static IPv6 address - \u003Ccode class=\"literal\">2001:db8:1::1\u003C/code> with the \u003Ccode class=\"literal\">/64\u003C/code> subnet mask\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAn IPv4 default gateway - \u003Ccode class=\"literal\">192.0.2.2\u003C/code>\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAn IPv4 DNS server - \u003Ccode class=\"literal\">192.0.2.200\u003C/code>\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAn IPv6 DNS server - \u003Ccode class=\"literal\">2001:db8:1::ffbb\u003C/code>\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tA DNS search domain - \u003Ccode class=\"literal\">example.com\u003C/code>\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tApply the settings to the system:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmstatectl apply create-macsec-connection.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the current state in YAML format:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>nmstatectl show macsec0\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the traffic is encrypted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tcpdump -nn -i enp0s1\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Display the unencrypted traffic:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>tcpdump -nn -i macsec0\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay MACsec statistics:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip macsec show\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay individual counters for each type of protection: integrity-only (encrypt off) and encryption (encrypt on)\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ip -s macsec show\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://developers.redhat.com/blog/2016/10/14/macsec-a-different-solution-to-encrypt-network-traffic\">MACsec: a different solution to encrypt network traffic\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_securing-the-postfix-service_securing-networks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 8. Securing the Postfix service\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tPostfix is a mail transfer agent (MTA) that uses the Simple Mail Transfer Protocol (SMTP) to deliver electronic messages between other MTAs and to email clients or delivery agents. Although MTAs can encrypt traffic between one another, they might not do so by default. You can also mitigate risks to various attacks by changing setting to more secure values.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"ref_reducing-postfix-network-related-security-risks_assembly_securing-the-postfix-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.1. Reducing Postfix network-related security risks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo reduce the risk of attackers invading your system through the network, perform as many of the following tasks as possible.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDo not share the \u003Ccode class=\"literal\">/var/spool/postfix/\u003C/code> mail spool directory on a Network File System (NFS) shared volume. NFSv2 and NFSv3 do not maintain control over user and group IDs. Therefore, if two or more users have the same UID, they can receive and read each other’s mail, which is a security risk.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThis rule does not apply to NFSv4 using Kerberos, because the \u003Ccode class=\"literal\">SECRPC_GSS\u003C/code> kernel module does not use UID-based authentication. However, to reduce the security risks, you should not put the mail spool directory on NFS shared volumes.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo reduce the probability of Postfix server exploits, mail users must access the Postfix server using an email program. Do not allow shell accounts on the mail server, and set all user shells in the \u003Ccode class=\"literal\">/etc/passwd\u003C/code> file to \u003Ccode class=\"literal\">/sbin/nologin\u003C/code> (with the possible exception of the \u003Ccode class=\"literal\">root\u003C/code> user).\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo protect Postfix from a network attack, it is set up to only listen to the local loopback address by default. You can verify this by viewing the \u003Ccode class=\"literal\">inet_interfaces = localhost\u003C/code> line in the \u003Ccode class=\"literal\">/etc/postfix/main.cf\u003C/code> file. This ensures that Postfix only accepts mail messages (such as \u003Ccode class=\"literal\">cron\u003C/code> job reports) from the local system and not from the network. This is the default setting and protects Postfix from a network attack. To remove the localhost restriction and allow Postfix to listen on all interfaces, set the \u003Ccode class=\"literal\">inet_interfaces\u003C/code> parameter to \u003Ccode class=\"literal\">all\u003C/code> in \u003Ccode class=\"literal\">/etc/postfix/main.cf\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_postfix-configuration-options-for-limiting-dos-attacks_assembly_securing-the-postfix-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.2. Postfix configuration options for limiting DoS attacks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAn attacker can flood the server with traffic, or send information that triggers a crash, causing a denial of service (DoS) attack. You can configure your system to reduce the risk of such attacks by setting limits in the \u003Ccode class=\"literal\">/etc/postfix/main.cf\u003C/code> file. You can change the value of the existing directives or you can add new directives with custom values in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;directive&gt;\u003C/em>\u003C/span> = \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUse the following list of directives for limiting a DoS attack:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">smtpd_client_connection_rate_limit\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tLimits the maximum number of connection attempts any client can make to this service per time unit. The default value is \u003Ccode class=\"literal\">0\u003C/code>, which means a client can make as many connections per time unit as Postfix can accept. By default, the directive excludes clients in trusted networks.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">anvil_rate_time_unit\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines a time unit to calculate the rate limit. The default value is \u003Ccode class=\"literal\">60\u003C/code> seconds.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">smtpd_client_event_limit_exceptions\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tExcludes clients from the connection and rate limit commands. By default, the directive excludes clients in trusted networks.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">smtpd_client_message_rate_limit\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the maximum number of message deliveries from client to request per time unit (regardless of whether or not Postfix actually accepts those messages).\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">default_process_limit\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the default maximum number of Postfix child processes that provide a given service. You can ignore this rule for specific services in the \u003Ccode class=\"literal\">master.cf\u003C/code> file. By default, the value is \u003Ccode class=\"literal\">100\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">queue_minfree\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the minimum amount of free space required to receive mail in the queue file system. The directive is currently used by the Postfix SMTP server to decide if it accepts any mail at all. By default, the Postfix SMTP server rejects \u003Ccode class=\"literal\">MAIL FROM\u003C/code> commands when the amount of free space is less than 1.5 times the \u003Ccode class=\"literal\">message_size_limit\u003C/code>. To specify a higher minimum free space limit, specify a \u003Ccode class=\"literal\">queue_minfree\u003C/code> value that is at least 1.5 times the \u003Ccode class=\"literal\">message_size_limit\u003C/code>. By default, the \u003Ccode class=\"literal\">queue_minfree\u003C/code> value is \u003Ccode class=\"literal\">0\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">header_size_limit\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the maximum amount of memory in bytes for storing a message header. If a header is large, it discards the excess header. By default, the value is \u003Ccode class=\"literal\">102400\u003C/code> bytes.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">message_size_limit\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDefines the maximum size of a message including the envelope information in bytes. By default, the value is \u003Ccode class=\"literal\">10240000\u003C/code> bytes.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_configuring-postfix-to-use-sasl_assembly_securing-the-postfix-service\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.3. Configuring Postfix to use SASL\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPostfix supports Simple Authentication and Security Layer (SASL) based SMTP Authentication (AUTH). SMTP AUTH is an extension of the Simple Mail Transfer Protocol. Currently, the Postfix SMTP server supports the SASL implementations in the following ways:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Dovecot SASL\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe Postfix SMTP server can communicate with the Dovecot SASL implementation using either a UNIX-domain socket or a TCP socket. Use this method if Postfix and Dovecot applications are running on separate machines.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Cyrus SASL\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tWhen enabled, SMTP clients must authenticate with the SMTP server using an authentication method supported and accepted by both the server and the client.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">dovecot\u003C/code> package is installed on the system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet up Dovecot:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tInclude the following lines in the \u003Ccode class=\"literal\">/etc/dovecot/conf.d/10-master.conf\u003C/code> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">service auth {\n  unix_listener /var/spool/postfix/private/auth {\n    mode = 0660\n    user = postfix\n    group = postfix\n  }\n}\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe previous example uses UNIX-domain sockets for communication between Postfix and Dovecot. The example also assumes default Postfix SMTP server settings, which include the mail queue located in the \u003Ccode class=\"literal\">/var/spool/postfix/\u003C/code> directory, and the application running under the \u003Ccode class=\"literal\">postfix\u003C/code> user and group.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: Set up Dovecot to listen for Postfix authentication requests through TCP:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">service auth {\n  inet_listener {\n      port = \u003Cspan class=\"emphasis\">\u003Cem>port-number\u003C/em>\u003C/span>\n  }\n}\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the method that the email client uses to authenticate with Dovecot by editing the \u003Ccode class=\"literal\">auth_mechanisms\u003C/code> parameter in \u003Ccode class=\"literal\">/etc/dovecot/conf.d/10-auth.conf\u003C/code> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">auth_mechanisms = plain login\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">auth_mechanisms\u003C/code> parameter supports different plaintext and non-plaintext authentication methods.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet up Postfix by modifying the \u003Ccode class=\"literal\">/etc/postfix/main.cf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnable SMTP Authentication on the Postfix SMTP server:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">smtpd_sasl_auth_enable = yes\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnable the use of Dovecot SASL implementation for SMTP Authentication:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">smtpd_sasl_type = dovecot\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tProvide the authentication path relative to the Postfix queue directory. Note that the use of a relative path ensures that the configuration works regardless of whether the Postfix server runs in \u003Ccode class=\"literal\">chroot\u003C/code> or not:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">smtpd_sasl_path = private/auth\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis step uses UNIX-domain sockets for communication between Postfix and Dovecot.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo configure Postfix to look for Dovecot on a different machine in case you use TCP sockets for communication, use configuration values similar to the following:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">smtpd_sasl_path = inet: \u003Cspan class=\"emphasis\">\u003Cem>ip-address\u003C/em>\u003C/span> : \u003Cspan class=\"emphasis\">\u003Cem>port-number\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the previous example, replace the \u003Cspan class=\"emphasis\">\u003Cem>ip-address\u003C/em>\u003C/span> with the IP address of the Dovecot machine and \u003Cspan class=\"emphasis\">\u003Cem>port-number\u003C/em>\u003C/span> with the port number specified in Dovecot’s \u003Ccode class=\"literal\">/etc/dovecot/conf.d/10-master.conf\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify SASL mechanisms that the Postfix SMTP server makes available to clients. Note that you can specify different mechanisms for encrypted and unencrypted sessions.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">smtpd_sasl_security_options = noanonymous, noplaintext\nsmtpd_sasl_tls_security_options = noanonymous\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe previous directives specify that during unencrypted sessions, no anonymous authentication is allowed and no mechanisms that transmit unencrypted user names or passwords are allowed. For encrypted sessions that use TLS, only non-anonymous authentication mechanisms are allowed.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://www.postfix.org/SASL_README.html#smtpd_sasl_security_options\">Postfix SMTP server policy - SASL mechanism properties\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://doc.dovecot.org/configuration_manual/howto/postfix_and_dovecot_sasl/\">Postfix and Dovecot SASL\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"http://www.postfix.org/SASL_README.html#server_sasl\">Configuring SASL authentication in the Postfix SMTP server\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"legalnotice\" id=\"idm140078480740000\">\u003Ch2 class=\"legalnotice\">Legal Notice\u003C/h2>\u003Cdiv class=\"para\">\n\t\tCopyright \u003Cspan class=\"trademark\">\u003C!--Empty-->\u003C/span>© 2024 Red Hat, Inc.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license (\"CC-BY-SA\"). An explanation of CC-BY-SA is available at \u003Ca class=\"uri\" href=\"http://creativecommons.org/licenses/by-sa/3.0/\">http://creativecommons.org/licenses/by-sa/3.0/\u003C/a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Linux\u003C/span>® is the registered trademark of Linus Torvalds in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Java\u003C/span>® is a registered trademark of Oracle and/or its affiliates.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">XFS\u003C/span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">MySQL\u003C/span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Node.js\u003C/span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe \u003Cspan class=\"trademark\">OpenStack\u003C/span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tAll other trademarks are the property of their respective owners.\n\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003C/body>",[14,21,26,95,136,153,196,317,394,411,428],{"title":11,"visible":15,"weight":16,"urlFragment":17,"anchor":18,"singlePageAnchor":18,"docTitle":19,"url":20},true,1,"index",null,"securing_networks","#",{"title":22,"visible":15,"weight":23,"urlFragment":24,"anchor":18,"singlePageAnchor":24,"docTitle":19,"url":25},"Providing feedback on Red Hat documentation",2,"proc_providing-feedback-on-red-hat-documentation_securing-networks","#proc_providing-feedback-on-red-hat-documentation_securing-networks",{"title":27,"visible":15,"weight":28,"urlFragment":29,"anchor":18,"singlePageAnchor":29,"sections":30,"docTitle":19,"url":94},"1. Using secure communications between two systems with OpenSSH",3,"assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks",[31,35,39,43,48,53,58,63,89],{"title":32,"visible":15,"weight":16,"urlFragment":29,"anchor":33,"singlePageAnchor":33,"docTitle":19,"url":34},"1.1. SSH and OpenSSH","ssh-and-openssh_assembly_using-secure-communications-between-two-systems-with-openssh","#ssh-and-openssh_assembly_using-secure-communications-between-two-systems-with-openssh",{"title":36,"visible":15,"weight":23,"urlFragment":29,"anchor":37,"singlePageAnchor":37,"docTitle":19,"url":38},"1.2. Generating SSH key pairs","generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh","#generating-ssh-key-pairs_assembly_using-secure-communications-between-two-systems-with-openssh",{"title":40,"visible":15,"weight":28,"urlFragment":29,"anchor":41,"singlePageAnchor":41,"docTitle":19,"url":42},"1.3. Setting key-based authentication as the only method on an OpenSSH server","setting-an-openssh-server-for-key-based-authentication_assembly_using-secure-communications-between-two-systems-with-openssh","#setting-an-openssh-server-for-key-based-authentication_assembly_using-secure-communications-between-two-systems-with-openssh",{"title":44,"visible":15,"weight":45,"urlFragment":29,"anchor":46,"singlePageAnchor":46,"docTitle":19,"url":47},"1.4. Caching your SSH credentials by using ssh-agent",4,"connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh","#connecting-to-remote-machines-with-ssh-keys-using-ssh-agent_assembly_using-secure-communications-between-two-systems-with-openssh",{"title":49,"visible":15,"weight":50,"urlFragment":29,"anchor":51,"singlePageAnchor":51,"docTitle":19,"url":52},"1.5. Authenticating by SSH keys stored on a smart card",5,"using-ssh-keys-stored-on-a-smart-card_assembly_using-secure-communications-between-two-systems-with-openssh","#using-ssh-keys-stored-on-a-smart-card_assembly_using-secure-communications-between-two-systems-with-openssh",{"title":54,"visible":15,"weight":55,"urlFragment":29,"anchor":56,"singlePageAnchor":56,"docTitle":19,"url":57},"1.6. Making OpenSSH more secure",6,"making-openssh-more-secure_assembly_using-secure-communications-between-two-systems-with-openssh","#making-openssh-more-secure_assembly_using-secure-communications-between-two-systems-with-openssh",{"title":59,"visible":15,"weight":60,"urlFragment":29,"anchor":61,"singlePageAnchor":61,"docTitle":19,"url":62},"1.7. Connecting to a remote server through an SSH jump host",7,"connecting-to-a-remote-server-using-an-ssh-jump-host_assembly_using-secure-communications-between-two-systems-with-openssh","#connecting-to-a-remote-server-using-an-ssh-jump-host_assembly_using-secure-communications-between-two-systems-with-openssh",{"title":64,"visible":15,"weight":65,"urlFragment":29,"anchor":66,"singlePageAnchor":66,"sections":67,"docTitle":19,"url":88},"1.8. Configuring secure communication with the ssh system roles",8,"configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh",[68,72,76,80,84],{"title":69,"visible":15,"weight":16,"urlFragment":29,"anchor":70,"singlePageAnchor":70,"docTitle":19,"url":71},"1.8.1. Variables of the sshd RHEL system role","sshd-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles","#sshd-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles",{"title":73,"visible":15,"weight":23,"urlFragment":29,"anchor":74,"singlePageAnchor":74,"docTitle":19,"url":75},"1.8.2. Configuring OpenSSH servers by using the sshd RHEL system role","configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-with-the-ssh-system-roles","#configuring-openssh-servers-using-the-sshd-system-role_configuring-secure-communication-with-the-ssh-system-roles",{"title":77,"visible":15,"weight":28,"urlFragment":29,"anchor":78,"singlePageAnchor":78,"docTitle":19,"url":79},"1.8.3. Variables of the ssh RHEL system role","ref_ssh-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles","#ref_ssh-system-role-variables_configuring-secure-communication-with-the-ssh-system-roles",{"title":81,"visible":15,"weight":45,"urlFragment":29,"anchor":82,"singlePageAnchor":82,"docTitle":19,"url":83},"1.8.4. Configuring OpenSSH clients by using the ssh RHEL system role","proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-with-the-ssh-system-roles","#proc_configuring-openssh-clients-using-the-ssh-system-role_configuring-secure-communication-with-the-ssh-system-roles",{"title":85,"visible":15,"weight":50,"urlFragment":29,"anchor":86,"singlePageAnchor":86,"docTitle":19,"url":87},"1.8.5. Using the sshd RHEL system role for non-exclusive configuration","proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-with-the-ssh-system-roles","#proc_using-the-ssh-server-system-role-for-non-exclusive-configuration_configuring-secure-communication-with-the-ssh-system-roles","#configuring-secure-communication-with-the-ssh-system-roles_assembly_using-secure-communications-between-two-systems-with-openssh",{"title":90,"visible":15,"weight":91,"urlFragment":29,"anchor":92,"singlePageAnchor":92,"docTitle":19,"url":93},"1.9. Additional resources",9,"additional_resources","#additional_resources","#assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks",{"title":96,"visible":15,"weight":45,"urlFragment":97,"anchor":18,"singlePageAnchor":97,"sections":98,"docTitle":19,"url":135},"2. Creating and managing TLS keys and certificates","creating-and-managing-tls-keys-and-certificates_securing-networks",[99,103,107,111,115,119,123,127,131],{"title":100,"visible":15,"weight":16,"urlFragment":97,"anchor":101,"singlePageAnchor":101,"docTitle":19,"url":102},"2.1. TLS certificates","con_tls-certificates_creating-and-managing-tls-keys-and-certificates","#con_tls-certificates_creating-and-managing-tls-keys-and-certificates",{"title":104,"visible":15,"weight":23,"urlFragment":97,"anchor":105,"singlePageAnchor":105,"docTitle":19,"url":106},"2.2. Creating a private CA using OpenSSL","creating-a-private-ca-using-openssl_creating-and-managing-tls-keys-and-certificates","#creating-a-private-ca-using-openssl_creating-and-managing-tls-keys-and-certificates",{"title":108,"visible":15,"weight":28,"urlFragment":97,"anchor":109,"singlePageAnchor":109,"docTitle":19,"url":110},"2.3. Creating a private key and a CSR for a TLS server certificate using OpenSSL","creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates","#creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates",{"title":112,"visible":15,"weight":45,"urlFragment":97,"anchor":113,"singlePageAnchor":113,"docTitle":19,"url":114},"2.4. Creating a private key and a CSR for a TLS client certificate using OpenSSL","creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates","#creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-openssl_creating-and-managing-tls-keys-and-certificates",{"title":116,"visible":15,"weight":50,"urlFragment":97,"anchor":117,"singlePageAnchor":117,"docTitle":19,"url":118},"2.5. Using a private CA to issue certificates for CSRs with OpenSSL","using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates","#using-a-private-ca-to-issue-certificates-for-csrs-with-openssl_creating-and-managing-tls-keys-and-certificates",{"title":120,"visible":15,"weight":55,"urlFragment":97,"anchor":121,"singlePageAnchor":121,"docTitle":19,"url":122},"2.6. Creating a private CA using GnuTLS","creating-a-private-ca-using-gnutls_creating-and-managing-tls-keys-and-certificates","#creating-a-private-ca-using-gnutls_creating-and-managing-tls-keys-and-certificates",{"title":124,"visible":15,"weight":60,"urlFragment":97,"anchor":125,"singlePageAnchor":125,"docTitle":19,"url":126},"2.7. Creating a private key and a CSR for a TLS server certificate using GnuTLS","creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-gnutls_creating-and-managing-tls-keys-and-certificates","#creating-a-private-key-and-a-csr-for-a-tls-server-certificate-using-gnutls_creating-and-managing-tls-keys-and-certificates",{"title":128,"visible":15,"weight":65,"urlFragment":97,"anchor":129,"singlePageAnchor":129,"docTitle":19,"url":130},"2.8. Creating a private key and a CSR for a TLS client certificate using GnuTLS","creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-gnutlscreating-and-managing-tls-keys-and-certificates","#creating-a-private-key-and-a-csr-for-a-tls-client-certificate-using-gnutlscreating-and-managing-tls-keys-and-certificates",{"title":132,"visible":15,"weight":91,"urlFragment":97,"anchor":133,"singlePageAnchor":133,"docTitle":19,"url":134},"2.9. Using a private CA to issue certificates for CSRs with GnuTLS","using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates","#using-a-private-ca-to-issue-certificates-for-csrs-with-gnutls_creating-and-managing-tls-keys-and-certificates","#creating-and-managing-tls-keys-and-certificates_securing-networks",{"title":137,"visible":15,"weight":50,"urlFragment":138,"anchor":18,"singlePageAnchor":138,"sections":139,"docTitle":19,"url":152},"3. Using shared system certificates","using-shared-system-certificates_securing-networks",[140,144,148],{"title":141,"visible":15,"weight":16,"urlFragment":138,"anchor":142,"singlePageAnchor":142,"docTitle":19,"url":143},"3.1. The system-wide truststore","the-system-wide-trust-store_using-shared-system-certificates","#the-system-wide-trust-store_using-shared-system-certificates",{"title":145,"visible":15,"weight":23,"urlFragment":138,"anchor":146,"singlePageAnchor":146,"docTitle":19,"url":147},"3.2. Adding new certificates","adding-new-certificates_using-shared-system-certificates","#adding-new-certificates_using-shared-system-certificates",{"title":149,"visible":15,"weight":28,"urlFragment":138,"anchor":150,"singlePageAnchor":150,"docTitle":19,"url":151},"3.3. Managing trusted system certificates","managing-trusted-system-certificates_using-shared-system-certificates","#managing-trusted-system-certificates_using-shared-system-certificates","#using-shared-system-certificates_securing-networks",{"title":154,"visible":15,"weight":55,"urlFragment":155,"anchor":18,"singlePageAnchor":155,"sections":156,"docTitle":19,"url":195},"4. Planning and implementing TLS","planning-and-implementing-tls_securing-networks",[157,161,178],{"title":158,"visible":15,"weight":16,"urlFragment":155,"anchor":159,"singlePageAnchor":159,"docTitle":19,"url":160},"4.1. SSL and TLS protocols","ssl-and-tls-protocols_planning-and-implementing-tls","#ssl-and-tls-protocols_planning-and-implementing-tls",{"title":162,"visible":15,"weight":23,"urlFragment":155,"anchor":163,"singlePageAnchor":163,"sections":164,"docTitle":19,"url":177},"4.2. Security considerations for TLS in RHEL 9","security-considerations-for-tls-in-rhel_planning-and-implementing-tls",[165,169,173],{"title":166,"visible":15,"weight":16,"urlFragment":155,"anchor":167,"singlePageAnchor":167,"docTitle":19,"url":168},"4.2.1. Protocols","protocols","#protocols",{"title":170,"visible":15,"weight":23,"urlFragment":155,"anchor":171,"singlePageAnchor":171,"docTitle":19,"url":172},"4.2.2. Cipher suites","cipher_suites","#cipher_suites",{"title":174,"visible":15,"weight":28,"urlFragment":155,"anchor":175,"singlePageAnchor":175,"docTitle":19,"url":176},"4.2.3. Public key length","public_key_length","#public_key_length","#security-considerations-for-tls-in-rhel_planning-and-implementing-tls",{"title":179,"visible":15,"weight":28,"urlFragment":155,"anchor":180,"singlePageAnchor":180,"sections":181,"docTitle":19,"url":194},"4.3. Hardening TLS configuration in applications","hardening-tls-configuration-in-applications_planning-and-implementing-tls",[182,186,190],{"title":183,"visible":15,"weight":16,"urlFragment":155,"anchor":184,"singlePageAnchor":184,"docTitle":19,"url":185},"4.3.1. Configuring the Apache HTTP server to use TLS","configuring-the-apache-http-server_planning-and-implementing-tls","#configuring-the-apache-http-server_planning-and-implementing-tls",{"title":187,"visible":15,"weight":23,"urlFragment":155,"anchor":188,"singlePageAnchor":188,"docTitle":19,"url":189},"4.3.2. Configuring the Nginx HTTP and proxy server to use TLS","configuring-the-nginx-http-and-proxy-server_planning-and-implementing-tls","#configuring-the-nginx-http-and-proxy-server_planning-and-implementing-tls",{"title":191,"visible":15,"weight":28,"urlFragment":155,"anchor":192,"singlePageAnchor":192,"docTitle":19,"url":193},"4.3.3. Configuring the Dovecot mail server to use TLS","configuring-the-Dovecot-mail-server_planning-and-implementing-tls","#configuring-the-Dovecot-mail-server_planning-and-implementing-tls","#hardening-tls-configuration-in-applications_planning-and-implementing-tls","#planning-and-implementing-tls_securing-networks",{"title":197,"visible":15,"weight":60,"urlFragment":198,"anchor":18,"singlePageAnchor":198,"sections":199,"docTitle":19,"url":316},"5. Setting up an IPsec VPN","configuring-a-vpn-connection_securing-networks",[200,204,208,212,216,220,224,228,232,236,241,246,251,265,270,275,280,285,311],{"title":201,"visible":15,"weight":16,"urlFragment":198,"anchor":202,"singlePageAnchor":202,"docTitle":19,"url":203},"5.1. Libreswan as an IPsec VPN implementation","libreswan-as-an-ipsec-vpn-implementation_configuring-a-vpn-with-ipsec","#libreswan-as-an-ipsec-vpn-implementation_configuring-a-vpn-with-ipsec",{"title":205,"visible":15,"weight":23,"urlFragment":198,"anchor":206,"singlePageAnchor":206,"docTitle":19,"url":207},"5.2. Authentication methods in Libreswan","con_authentication-methods-in-libreswan_configuring-a-vpn-with-ipsec","#con_authentication-methods-in-libreswan_configuring-a-vpn-with-ipsec",{"title":209,"visible":15,"weight":28,"urlFragment":198,"anchor":210,"singlePageAnchor":210,"docTitle":19,"url":211},"5.3. Installing Libreswan","installing-libreswan_configuring-a-vpn-with-ipsec","#installing-libreswan_configuring-a-vpn-with-ipsec",{"title":213,"visible":15,"weight":45,"urlFragment":198,"anchor":214,"singlePageAnchor":214,"docTitle":19,"url":215},"5.4. Creating a host-to-host VPN","creating-a-host-to-host-vpn_configuring-a-vpn-with-ipsec","#creating-a-host-to-host-vpn_configuring-a-vpn-with-ipsec",{"title":217,"visible":15,"weight":50,"urlFragment":198,"anchor":218,"singlePageAnchor":218,"docTitle":19,"url":219},"5.5. Configuring a site-to-site VPN","configuring-a-site-to-site-vpn_configuring-a-vpn-with-ipsec","#configuring-a-site-to-site-vpn_configuring-a-vpn-with-ipsec",{"title":221,"visible":15,"weight":55,"urlFragment":198,"anchor":222,"singlePageAnchor":222,"docTitle":19,"url":223},"5.6. Configuring a remote access VPN","configuring-a-remote-access-vpn_configuring-a-vpn-with-ipsec","#configuring-a-remote-access-vpn_configuring-a-vpn-with-ipsec",{"title":225,"visible":15,"weight":60,"urlFragment":198,"anchor":226,"singlePageAnchor":226,"docTitle":19,"url":227},"5.7. Configuring a mesh VPN","configuring-a-mesh-vpn_configuring-a-vpn-with-ipsec","#configuring-a-mesh-vpn_configuring-a-vpn-with-ipsec",{"title":229,"visible":15,"weight":65,"urlFragment":198,"anchor":230,"singlePageAnchor":230,"docTitle":19,"url":231},"5.8. Deploying a FIPS-compliant IPsec VPN","deploying-a-fips-compliant-ipsec-vpn_configuring-a-vpn-with-ipsec","#deploying-a-fips-compliant-ipsec-vpn_configuring-a-vpn-with-ipsec",{"title":233,"visible":15,"weight":91,"urlFragment":198,"anchor":234,"singlePageAnchor":234,"docTitle":19,"url":235},"5.9. Protecting the IPsec NSS database by a password","protecting-the-ipsec-nss-database-by-a-password_configuring-a-vpn-with-ipsec","#protecting-the-ipsec-nss-database-by-a-password_configuring-a-vpn-with-ipsec",{"title":237,"visible":15,"weight":238,"urlFragment":198,"anchor":239,"singlePageAnchor":239,"docTitle":19,"url":240},"5.10. Configuring an IPsec VPN to use TCP",10,"proc_configuring-an-ipsec-vpn-to-use-tcp_configuring-a-vpn-with-ipsec","#proc_configuring-an-ipsec-vpn-to-use-tcp_configuring-a-vpn-with-ipsec",{"title":242,"visible":15,"weight":243,"urlFragment":198,"anchor":244,"singlePageAnchor":244,"docTitle":19,"url":245},"5.11. Configuring automatic detection and usage of ESP hardware offload to accelerate an IPsec connection",11,"proc_configuring-automatic-detection-and-usage-of-esp-hardware-offload-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec","#proc_configuring-automatic-detection-and-usage-of-esp-hardware-offload-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec",{"title":247,"visible":15,"weight":248,"urlFragment":198,"anchor":249,"singlePageAnchor":249,"docTitle":19,"url":250},"5.12. Configuring ESP hardware offload on a bond to accelerate an IPsec connection",12,"proc_configuring-esp-hardware-offload-on-a-bond-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec","#proc_configuring-esp-hardware-offload-on-a-bond-to-accelerate-an-ipsec-connection_configuring-a-vpn-with-ipsec",{"title":252,"visible":15,"weight":253,"urlFragment":198,"anchor":254,"singlePageAnchor":254,"sections":255,"docTitle":19,"url":264},"5.13. Configuring VPN connections with IPsec by using the RHEL system role",13,"assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec",[256,260],{"title":257,"visible":15,"weight":16,"urlFragment":198,"anchor":258,"singlePageAnchor":258,"docTitle":19,"url":259},"5.13.1. Creating a host-to-host VPN with IPsec by using the vpn RHEL system role","proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role","#proc_creating-a-host-to-host-vpn-with-ipsec-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role",{"title":261,"visible":15,"weight":23,"urlFragment":198,"anchor":262,"singlePageAnchor":262,"docTitle":19,"url":263},"5.13.2. Creating an opportunistic mesh VPN connection with IPsec by using the vpn RHEL system role","proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role","#proc_creating-an-opportunistic-mesh-vpn-connection-with-ipsec-by-using-the-vpn-system-role_assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role","#assembly_configuring-vpn-connections-with-ipsec-by-using-the-rhel-vpn-system-role_configuring-a-vpn-with-ipsec",{"title":266,"visible":15,"weight":267,"urlFragment":198,"anchor":268,"singlePageAnchor":268,"docTitle":19,"url":269},"5.14. Configuring IPsec connections that opt out of the system-wide crypto policies",14,"configuring-ipsec-connections-that-opt-out-of-the-system-wide-crypto-policies_configuring-a-vpn-with-ipsec","#configuring-ipsec-connections-that-opt-out-of-the-system-wide-crypto-policies_configuring-a-vpn-with-ipsec",{"title":271,"visible":15,"weight":272,"urlFragment":198,"anchor":273,"singlePageAnchor":273,"docTitle":19,"url":274},"5.15. Troubleshooting IPsec VPN configurations",15,"ref_troubleshooting-ipsec-vpn-configurations_configuring-a-vpn-with-ipsec","#ref_troubleshooting-ipsec-vpn-configurations_configuring-a-vpn-with-ipsec",{"title":276,"visible":15,"weight":277,"urlFragment":198,"anchor":278,"singlePageAnchor":278,"docTitle":19,"url":279},"5.16. Configuring a VPN connection with control-center",16,"configuring-a-VPN-connection-with-control-center_configuring-a-vpn-with-ipsec","#configuring-a-VPN-connection-with-control-center_configuring-a-vpn-with-ipsec",{"title":281,"visible":15,"weight":282,"urlFragment":198,"anchor":283,"singlePageAnchor":283,"docTitle":19,"url":284},"5.17. Configuring a VPN connection using nm-connection-editor",17,"configuring-a-vpn-connection-using-nm-connection-editor_configuring-a-vpn-with-ipsec","#configuring-a-vpn-connection-using-nm-connection-editor_configuring-a-vpn-with-ipsec",{"title":286,"visible":15,"weight":287,"urlFragment":198,"anchor":288,"singlePageAnchor":288,"sections":289,"docTitle":19,"url":310},"5.18. Configuring an IPsec based VPN connection by using nmstatectl",18,"configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec",[290,294,298,302,306],{"title":291,"visible":15,"weight":16,"urlFragment":198,"anchor":292,"singlePageAnchor":292,"docTitle":19,"url":293},"5.18.1. Configuring a host-to-subnet IPSec VPN with PKI authentication and tunnel mode by using nmstatectl","configuring-a-host-to-subnet-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl","#configuring-a-host-to-subnet-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl",{"title":295,"visible":15,"weight":23,"urlFragment":198,"anchor":296,"singlePageAnchor":296,"docTitle":19,"url":297},"5.18.2. Configuring a host-to-subnet IPSec VPN with RSA authentication and tunnel mode by using nmstatectl","configuring-a-host-to-subnet-ipsec-vpn-with-rsa-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl","#configuring-a-host-to-subnet-ipsec-vpn-with-rsa-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl",{"title":299,"visible":15,"weight":28,"urlFragment":198,"anchor":300,"singlePageAnchor":300,"docTitle":19,"url":301},"5.18.3. Configuring a host-to-subnet IPSec VPN with PSK authentication and tunnel mode by using nmstatectl","configuring-a-host-to-subnet-ipsec-vpn-with-psk-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl","#configuring-a-host-to-subnet-ipsec-vpn-with-psk-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl",{"title":303,"visible":15,"weight":45,"urlFragment":198,"anchor":304,"singlePageAnchor":304,"docTitle":19,"url":305},"5.18.4. Configuring a host-to-host IPsec VPN with PKI authentication and tunnel mode by using nmstatectl","configuring-a-host-to-host-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl","#configuring-a-host-to-host-ipsec-vpn-with-pki-authentication-and-tunnel-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl",{"title":307,"visible":15,"weight":50,"urlFragment":198,"anchor":308,"singlePageAnchor":308,"docTitle":19,"url":309},"5.18.5. Configuring a host-to-host IPsec VPN with PSK authentication and transport mode by using nmstatectl","configuring-a-host-to-host-ipsec-vpn-with-psk-authentication-and-transport-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl","#configuring-a-host-to-host-ipsec-vpn-with-psk-authentication-and-transport-mode-by-using-nmstatectl_configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl","#configuring-an-ipsec-based-vpn-connection-by-using-nmstatectl_configuring-a-vpn-with-ipsec",{"title":312,"visible":15,"weight":313,"urlFragment":198,"anchor":314,"singlePageAnchor":314,"docTitle":19,"url":315},"5.19. Additional resources",19,"related-information-configuring-a-vpn-with-ipsec","#related-information-configuring-a-vpn-with-ipsec","#configuring-a-vpn-connection_securing-networks",{"title":318,"visible":15,"weight":65,"urlFragment":319,"anchor":18,"singlePageAnchor":319,"sections":320,"docTitle":19,"url":393},"6. Securing network services","securing-network-services_securing-networks",[321,325,329,346,367,380,384],{"title":322,"visible":15,"weight":16,"urlFragment":319,"anchor":323,"singlePageAnchor":323,"docTitle":19,"url":324},"6.1. Securing the rpcbind service","securing-the-rpcbind-service_securing-network-services","#securing-the-rpcbind-service_securing-network-services",{"title":326,"visible":15,"weight":23,"urlFragment":319,"anchor":327,"singlePageAnchor":327,"docTitle":19,"url":328},"6.2. Securing the rpc.mountd service","securing-the-rpc-mountd-service_securing-network-services","#securing-the-rpc-mountd-service_securing-network-services",{"title":330,"visible":15,"weight":28,"urlFragment":319,"anchor":331,"singlePageAnchor":331,"sections":332,"docTitle":19,"url":345},"6.3. Securing the NFS service","securing-the-nfs-service_securing-network-services",[333,337,341],{"title":334,"visible":15,"weight":16,"urlFragment":319,"anchor":335,"singlePageAnchor":335,"docTitle":19,"url":336},"6.3.1. Export options for securing an NFS server","export-options-for-securing-an-nfs-server_securing-the-nfs-service","#export-options-for-securing-an-nfs-server_securing-the-nfs-service",{"title":338,"visible":15,"weight":23,"urlFragment":319,"anchor":339,"singlePageAnchor":339,"docTitle":19,"url":340},"6.3.2. Mount options for securing an NFS client","mount-options-for-securing-an-nfs-client_securing-the-nfs-service","#mount-options-for-securing-an-nfs-client_securing-the-nfs-service",{"title":342,"visible":15,"weight":28,"urlFragment":319,"anchor":343,"singlePageAnchor":343,"docTitle":19,"url":344},"6.3.3. Securing NFS with firewall","securing-nfs-with-firewall_securing-the-nfs-service","#securing-nfs-with-firewall_securing-the-nfs-service","#securing-the-nfs-service_securing-network-services",{"title":347,"visible":15,"weight":45,"urlFragment":319,"anchor":348,"singlePageAnchor":348,"sections":349,"docTitle":19,"url":366},"6.4. Securing the FTP service","securing-the-ftp-service_securing-network-services",[350,354,358,362],{"title":351,"visible":15,"weight":16,"urlFragment":319,"anchor":352,"singlePageAnchor":352,"docTitle":19,"url":353},"6.4.1. Securing the FTP greeting banner","securing-the-ftp-greeting-banner_securing-the-ftp-service","#securing-the-ftp-greeting-banner_securing-the-ftp-service",{"title":355,"visible":15,"weight":23,"urlFragment":319,"anchor":356,"singlePageAnchor":356,"docTitle":19,"url":357},"6.4.2. Preventing anonymous access and uploads in FTP","preventing-anonymous-access-and-uploads-in-ftp_securing-the-ftp-service","#preventing-anonymous-access-and-uploads-in-ftp_securing-the-ftp-service",{"title":359,"visible":15,"weight":28,"urlFragment":319,"anchor":360,"singlePageAnchor":360,"docTitle":19,"url":361},"6.4.3. Securing user accounts for FTP","securing-user-accounts-for-ftp_securing-the-ftp-service","#securing-user-accounts-for-ftp_securing-the-ftp-service",{"title":363,"visible":15,"weight":45,"urlFragment":319,"anchor":364,"singlePageAnchor":364,"docTitle":19,"url":365},"6.4.4. Additional resources","additional_resources_2","#additional_resources_2","#securing-the-ftp-service_securing-network-services",{"title":368,"visible":15,"weight":50,"urlFragment":319,"anchor":369,"singlePageAnchor":369,"sections":370,"docTitle":19,"url":379},"6.5. Securing HTTP servers","securing-http-servers_securing-network-services",[371,375],{"title":372,"visible":15,"weight":16,"urlFragment":319,"anchor":373,"singlePageAnchor":373,"docTitle":19,"url":374},"6.5.1. Security enhancements in httpd.conf","security-enhancements-in-http-conf_securing-http-servers","#security-enhancements-in-http-conf_securing-http-servers",{"title":376,"visible":15,"weight":23,"urlFragment":319,"anchor":377,"singlePageAnchor":377,"docTitle":19,"url":378},"6.5.2. Securing the Nginx server configuration","securing-the-nginx-server_securing-http-servers","#securing-the-nginx-server_securing-http-servers","#securing-http-servers_securing-network-services",{"title":381,"visible":15,"weight":55,"urlFragment":319,"anchor":382,"singlePageAnchor":382,"docTitle":19,"url":383},"6.6. Securing PostgreSQL by limiting access to authenticated local users","securing-postgresql-by-limiting-access-to-authenticated-local-users_securing-network-services","#securing-postgresql-by-limiting-access-to-authenticated-local-users_securing-network-services",{"title":385,"visible":15,"weight":60,"urlFragment":319,"anchor":386,"singlePageAnchor":386,"sections":387,"docTitle":19,"url":392},"6.7. Securing the Memcached service","securing-the-memcached-service_securing-network-services",[388],{"title":389,"visible":15,"weight":16,"urlFragment":319,"anchor":390,"singlePageAnchor":390,"docTitle":19,"url":391},"6.7.1. Hardening Memcached against DDoS","hardening-memcached-against-ddos_securing-the-memcached-service","#hardening-memcached-against-ddos_securing-the-memcached-service","#securing-the-memcached-service_securing-network-services","#securing-network-services_securing-networks",{"title":395,"visible":15,"weight":91,"urlFragment":396,"anchor":18,"singlePageAnchor":396,"sections":397,"docTitle":19,"url":410},"7. Using MACsec to encrypt layer-2 traffic in the same physical network","assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks",[398,402,406],{"title":399,"visible":15,"weight":16,"urlFragment":396,"anchor":400,"singlePageAnchor":400,"docTitle":19,"url":401},"7.1. How MACsec increases security","how-macsec-increases-security_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network","#how-macsec-increases-security_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network",{"title":403,"visible":15,"weight":23,"urlFragment":396,"anchor":404,"singlePageAnchor":404,"docTitle":19,"url":405},"7.2. Configuring a MACsec connection by using nmcli","proc_configuring-a-macsec-connection-using-nmcli_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network","#proc_configuring-a-macsec-connection-using-nmcli_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network",{"title":407,"visible":15,"weight":28,"urlFragment":396,"anchor":408,"singlePageAnchor":408,"docTitle":19,"url":409},"7.3. Configuring a MACsec connection by using nmstatectl","configuring-a-macsec-connection-using-nmstatectl_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network","#configuring-a-macsec-connection-using-nmstatectl_assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network","#assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks",{"title":412,"visible":15,"weight":238,"urlFragment":413,"anchor":18,"singlePageAnchor":413,"sections":414,"docTitle":19,"url":427},"8. Securing the Postfix service","assembly_securing-the-postfix-service_securing-networks",[415,419,423],{"title":416,"visible":15,"weight":16,"urlFragment":413,"anchor":417,"singlePageAnchor":417,"docTitle":19,"url":418},"8.1. Reducing Postfix network-related security risks","ref_reducing-postfix-network-related-security-risks_assembly_securing-the-postfix-service","#ref_reducing-postfix-network-related-security-risks_assembly_securing-the-postfix-service",{"title":420,"visible":15,"weight":23,"urlFragment":413,"anchor":421,"singlePageAnchor":421,"docTitle":19,"url":422},"8.2. Postfix configuration options for limiting DoS attacks","ref_postfix-configuration-options-for-limiting-dos-attacks_assembly_securing-the-postfix-service","#ref_postfix-configuration-options-for-limiting-dos-attacks_assembly_securing-the-postfix-service",{"title":424,"visible":15,"weight":28,"urlFragment":413,"anchor":425,"singlePageAnchor":425,"docTitle":19,"url":426},"8.3. Configuring Postfix to use SASL","proc_configuring-postfix-to-use-sasl_assembly_securing-the-postfix-service","#proc_configuring-postfix-to-use-sasl_assembly_securing-the-postfix-service","#assembly_securing-the-postfix-service_securing-networks",{"title":429,"visible":15,"weight":243,"urlFragment":430,"anchor":18,"singlePageAnchor":431,"docTitle":19,"url":432},"Legal Notice","legal-notice","idm140078480740000","#idm140078480740000",[434,437,440],{"text":435,"link":436},"Red Hat Enterprise Linux","/documentation/red_hat_enterprise_linux/",{"text":438,"link":439},"9","/documentation/red_hat_enterprise_linux/9/",{"text":11},{"name":11,"translations":442,"productVersion":443,"singlePage":444,"pdf":447,"publishingStatus":449},[5,6,7,8,9],{"name":438},{"contentUrl":445,"name":11,"new":446,"url":19},"https://d2bhdhkti9t3uj.cloudfront.net/html/44755b55-f682-4bd8-b0b8-481068dab07a/80cdf4cc113e18bc78e4d8f6c3cda2e7.html","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/securing_networks/index",{"url":448},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/pdf/securing_networks/Red_Hat_Enterprise_Linux-9-Securing_networks-en-US.pdf","PUBLISHED",[451,456,459,463,467,471,475],{"name":452,"new":453,"url":454,"urlAliases":455},"10.0-Beta","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10-beta","10-beta",[],{"name":438,"new":457,"url":438,"urlAliases":458},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9",[],{"name":460,"new":461,"url":460,"urlAliases":462},"8","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8",[],{"name":464,"new":465,"url":464,"urlAliases":466},"7","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7",[],{"name":468,"new":469,"url":468,"urlAliases":470},"6","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/6",[],{"name":472,"new":473,"url":472,"urlAliases":474},"5","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/5",[],{"name":476,"new":477,"url":476,"urlAliases":478},"4","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/4",[],{"securing_networks/index":480,"securing_networks/proc_providing-feedback-on-red-hat-documentation_securing-networks":481,"securing_networks/assembly_using-secure-communications-between-two-systems-with-openssh_securing-networks":482,"securing_networks/creating-and-managing-tls-keys-and-certificates_securing-networks":483,"securing_networks/using-shared-system-certificates_securing-networks":484,"securing_networks/planning-and-implementing-tls_securing-networks":485,"securing_networks/configuring-a-vpn-connection_securing-networks":486,"securing_networks/securing-network-services_securing-networks":487,"securing_networks/assembly_using-macsec-to-encrypt-layer-2-traffic-in-the-same-physical-network_securing-networks":488,"securing_networks/assembly_securing-the-postfix-service_securing-networks":489,"securing_networks/legal-notice":490},{"prevt":18,"next":24},{"prevt":17,"next":29},{"prevt":18,"next":29},{"prevt":18,"next":97},{"prevt":18,"next":138},{"prevt":18,"next":155},{"prevt":18,"next":198},{"prevt":18,"next":18},{"prevt":18,"next":396},{"prevt":18,"next":413},{"prevt":413,"next":18},{"product":18,"version":18},{"securing_networks":493},[446],{"products":495},[496,497,498,499,500,501,502,503,504,505,506,507,508],"builds_for_red_hat_openshift","migration_toolkit_for_virtualization","openshift_container_platform","openshift_sandboxed_containers","red_hat_advanced_cluster_security_for_kubernetes","red_hat_advanced_cluster_management_for_kubernetes","red_hat_openshift_data_foundation","red_hat_openshift_dev_spaces","red_hat_openshift_gitops","red_hat_openshift_local","red_hat_openshift_pipelines","red_hat_openshift_serverless","workload_availability_for_red_hat_openshift",[],{"default":511},[512,521,527,536,544,552,559,567,574],{"nid":513,"type":514,"langcode":515,"Published":16,"title":516,"Created":517,"Updated":518,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":519,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":520},580,"rebrand banner","en","OpenShift Container Storage is now OpenShift Data Foundation starting with version 4.9.","2023-01-11 15:38:32","2023-01-11 15:40:04","/documentation/red_hat_openshift_container_storage\r\n/documentation/red_hat_openshift_container_storage/\r\n/documentation/red_hat_openshift_container_storage/*","internal:/documentation/red_hat_openshift_data_foundation/",{"nid":522,"type":514,"langcode":515,"Published":16,"title":516,"Created":523,"Updated":524,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":525,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":526},581,"2023-01-11 15:41:31","2023-01-11 15:42:04","/documentation/red_hat_openshift_data_foundation/4.9\r\n/documentation/red_hat_openshift_data_foundation/4.9/\r\n/documentation/red_hat_openshift_data_foundation/4.9/*\r\n/documentation/red_hat_openshift_data_foundation/4.10\r\n/documentation/red_hat_openshift_data_foundation/4.10/\r\n/documentation/red_hat_openshift_data_foundation/4.10/*\r\n/documentation/red_hat_openshift_data_foundation/4.11\r\n/documentation/red_hat_openshift_data_foundation/4.11/\r\n/documentation/red_hat_openshift_data_foundation/4.11/*","internal:/documentation/red_hat_openshift_container_storage/",{"nid":528,"type":529,"langcode":515,"Published":16,"title":530,"Created":531,"Updated":532,"body_value":18,"field_documentation banner_text_value":533,"field_documentation banner_text_format":534,"field_paths_value":535,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},582,"developer preview banner","MicroShift is Developer Preview software only","2023-01-11 15:50:24","2023-01-30 19:00:52","\u003Cp slot=header>MicroShift is Developer Preview software only.\u003C/p>For more information about the support scope of Red Hat Developer Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/devpreview/\">Developer Preview Support Scope\u003C/a>.","documentation banner","/documentation/microshift/4.12\r\n/documentation/microshift/4.12/*\r\n/documentation/red_hat_build_of_microshift/4.12\r\n/documentation/red_hat_build_of_microshift/4.12/*",{"nid":537,"type":538,"langcode":515,"Published":16,"title":539,"Created":540,"Updated":541,"body_value":18,"field_documentation banner_text_value":542,"field_documentation banner_text_format":534,"field_paths_value":543,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},583,"obsolete documentation banner","RHACS EOL - DAT-3433","2023-01-23 16:36:43","2023-01-23 16:39:14","\u003Cp slot=header>You are viewing documentation for a release that is no longer maintained. To view the documentation for the most recent version, see the \u003Ca href=\"/documentation/red_hat_advanced_cluster_security_for_kubernetes/\">latest RHACS docs\u003C/a>.\u003C/p>","/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71/*",{"nid":545,"type":546,"langcode":515,"Published":16,"title":547,"Created":548,"Updated":549,"body_value":18,"field_documentation banner_text_value":550,"field_documentation banner_text_format":534,"field_paths_value":551,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},584,"end of life banner","EOL banner for RHV","2023-05-23 14:58:05","2023-05-24 15:19:42","\u003Cp slot=header>The Red Hat Virtualization\u003C/p>Maintenance Phase runs until August 31, 2024, followed by the Extended Life Phase with no more software fixes through August 31, 2026. See \u003Ca href=\"https://access.redhat.com/articles/6975303\">Migration Paths for OpenShift Container Platform deployed on Red Hat Virtualization\u003C/a> for details.","/documentation/red_hat_virtualization/4.4",{"nid":553,"type":546,"langcode":515,"Published":16,"title":554,"Created":555,"Updated":556,"body_value":18,"field_documentation banner_text_value":557,"field_documentation banner_text_format":534,"field_paths_value":558,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},585,"RHHI-V EOL","2023-06-01 16:52:57","2023-06-01 17:03:44","\u003Cp slot=header>Red Hat Hyperconverged Infrastructure for Virtualization\u003C/p> is in the \u003Ca href=\"https://access.redhat.com/support/policy/updates/rhhiv\">Maintenance Support Phase\u003C/a> of its lifecycle until October 31, 2024. After that date, the product will be End of Life. See the \u003Ca href=\"https://access.redhat.com/announcements/6972521\">RHHI-V announcement\u003C/a> for next steps.","/documentation/red_hat_hyperconverged_infrastructure_for_virtualization/1.8",{"nid":560,"type":561,"langcode":515,"Published":16,"title":562,"Created":563,"Updated":564,"body_value":18,"field_documentation banner_text_value":565,"field_documentation banner_text_format":534,"field_paths_value":566,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},586,"preview banner","MicroShift is Technology Preview software only","2024-03-18 16:53:05","2024-03-18 16:54:56","\u003Cp slot=header>MicroShift is Technology Preview software only.\u003C/p>For more information about the support scope of Red Hat Technology Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/techpreview/\">Technology Preview Support Scope\u003C/a>.","/documentation/red_hat_build_of_microshift/4.13\r\n/documentation/red_hat_build_of_microshift/4.13/*",{"nid":568,"type":561,"langcode":515,"Published":16,"title":569,"Created":570,"Updated":571,"body_value":18,"field_documentation banner_text_value":572,"field_documentation banner_text_format":534,"field_paths_value":573,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},588,"Ansible 2.5 upgrade limitation","2024-09-30 16:53:05","2024-10-28 16:54:56","\u003Cp slot=\"header\">Support added for upgrades from 2.4\u003C/p>Ansible Automation Platform 2.5-3, released on October 28, 2024, adds support for upgrades from 2.4. See the upgrade documentation for more information.","",{"nid":575,"alertType":576,"type":577,"langcode":515,"Published":16,"title":578,"Created":573,"Updated":573,"body_value":18,"field_documentation banner_text_value":579,"field_documentation banner_text_format":534,"field_paths_value":580,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},587,"warning","Warning banner","Red Hat build of Apache Camel K","\u003Cp slot=header>Red Hat Camel K is deprecated\u003C/p>Red Hat Camel K is deprecated and the End of Life date for this product is June 30, 2025. For help migrating to the current go-to solution, \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel\">Red Hat build of Apache Camel\u003C/a>, see the \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel_k/1.10.7/html/migration_guide_camel_k_to_camel_extensions_for_quarkus/index\">Migration Guide\u003C/a>.","/documentation/red_hat_build_of_apache_camel_k/*",{"product":435},["Reactive",583],{"$snuxt-i18n-meta":584,"$sisLoading":585,"$sisSinglePage":15,"$sisInFocusMode":585,"$smobileTocOpen":585,"$sisLargeTOC":585,"$scurrentChapter":17,"$scurrentSection":17,"$scurrentSubSection":573},{},false,["Set"],["ShallowReactive",588],{"s8LoCEfG4A":18,"rFVLKcOK8e":18,"uUstF4AIyn":18,"MdHNSZP4nR":18,"Pn02PlJOas":18},"/en/documentation/red_hat_enterprise_linux/9/html-single/securing_networks/index"]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{contentEnv:"",collectFeedback:true,i18n:{baseUrl:"",defaultLocale:"en",defaultDirection:"ltr",strategy:"prefix",lazy:false,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:false,differentDomains:false,trailingSlash:false,configLocales:[{code:"en",name:"English",iso:"en-US"},{code:"fr",name:"Français",iso:"fr-FR"},{code:"ko",name:"한국어",iso:"ko-KR"},{code:"ja",name:"日本語",iso:"ja-JP"},{code:"zh-cn",name:"中文 (中国)",iso:"zh-CN"},{code:"de",name:"Deutsch",iso:"de_DE"},{code:"it",name:"Italiano",iso:"it_IT"},{code:"pt-br",name:"Português",iso:"pt_BR"},{code:"es",name:"Español",iso:"es-ES"}],locales:{en:{domain:""},fr:{domain:""},ko:{domain:""},ja:{domain:""},"zh-cn":{domain:""},de:{domain:""},it:{domain:""},"pt-br":{domain:""},es:{domain:""}},detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",switchLocalePathLinkSSR:false,autoImportTranslationFunctions:false}}},app:{baseURL:"/",buildId:"5ff82c51-785e-4a7d-aca6-77d6692e8c7a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>
