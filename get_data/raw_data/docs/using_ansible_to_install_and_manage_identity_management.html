<!DOCTYPE html><html  data-capo=""><head><script type="importmap">
  {
    "imports": {
      "@patternfly/elements/": "/scripts/v1/@patternfly/elements/",
      "@patternfly/pfe-clipboard/": "/scripts/v1/@patternfly/pfe-clipboard/",
      "@rhds/elements/": "/scripts/v1/@rhds/elements/elements/",
      "@cpelements/elements/": "/scripts/v1/@cpelements/elements/elements/"
    },
    "scopes": {
      "/": {
        "@floating-ui/core": "/scripts/v1/@floating-ui/core/dist/floating-ui.core.mjs",
        "@floating-ui/dom": "/scripts/v1/@floating-ui/dom/dist/floating-ui.dom.mjs",
        "@floating-ui/utils": "/scripts/v1/@floating-ui/utils/dist/floating-ui.utils.mjs",
        "@floating-ui/utils/dom": "/scripts/v1/@floating-ui/utils/dom/dist/floating-ui.utils.dom.mjs",
        "@lit/reactive-element": "/scripts/v1/@lit/reactive-element/reactive-element.js",
        "@lit/reactive-element/decorators/": "/scripts/v1/@lit/reactive-element/decorators/",
        "@patternfly/pfe-core": "/scripts/v1/@patternfly/pfe-core/core.js",
        "@patternfly/pfe-core/": "/scripts/v1/@patternfly/pfe-core/",
        "@rhds/tokens/media.js": "/scripts/v1/@rhds/tokens/js/media.js",
        "lit": "/scripts/v1/lit/index.js",
        "lit-element/lit-element.js": "/scripts/v1/lit-element/lit-element.js",
        "lit-html": "/scripts/v1/lit-html/lit-html.js",
        "lit-html/": "/scripts/v1/lit-html/",
        "lit/": "/scripts/v1/lit/",
        "tslib": "/scripts/v1/tslib/tslib.es6.mjs",
        "@cpelements/rh-table/dist/rh-table.js": "/scripts/v1/@cpelements/rh-table/dist/rh-table.js"
      }
    }
  }
</script><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Using Ansible to install and manage Identity Management | Red Hat Product Documentation</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<script type="text/javascript" id="trustarc" src="//static.redhat.com/libs/redhat/marketing/latest/trustarc/trustarc.js"></script>
<script src="//www.redhat.com/dtm.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@400;500;700&family=Red+Hat+Text:wght@400;500;700&display=swap">
<link rel="stylesheet" href="/styles/rh-table--lightdom.min.css">
<style>.section .titlepage{gap:.75rem}.section .titlepage,div.edit{align-items:center;display:flex}div.edit{font-size:.9rem;margin-bottom:8px}div.edit>a{align-items:center;display:flex}.edit pf-icon{margin-right:4px}</style>
<style>#error[data-v-df31ff14]{align-items:center;display:flex;flex-direction:column;justify-content:center;min-height:80vh}h1[data-v-df31ff14]{font-size:calc(var(--rh-font-size-body-text-md, 1rem)*4);font-weight:700;margin-bottom:0}h1[data-v-df31ff14],h1 span[data-v-df31ff14]{line-height:var(--rh-line-height-heading,1.3)}h1 span[data-v-df31ff14]{color:var(--rh-color-text-brand-on-light,#e00);display:block;text-transform:uppercase}h1 span[data-v-df31ff14],p[data-v-df31ff14]{font-size:var(--rh-font-size-body-text-lg,1.125rem)}aside[data-v-df31ff14]{align-items:center;background:var(--rh-color-surface-lightest,#fff);border:var(--rh-border-width-sm,1px) solid var(--rh-color-border-subtle-on-light,#c7c7c7);border-radius:var(--rh-border-radius-default,3px);border-top:calc(var(--rh-border-width-md, 2px)*2) solid var(--rh-color-text-brand-on-light,#e00);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2));display:flex;flex-direction:column;justify-content:space-between;margin-top:var(--rh-space-2xl,32px);padding:var(--rh-space-xl,24px)}aside[data-v-df31ff14],aside>div[data-v-df31ff14]{width:100%}.text-container[data-v-df31ff14]{margin:auto;max-width:442px;text-align:center}.desktop[data-v-df31ff14]{display:none}.sr-only[data-v-df31ff14]{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;clip-path:inset(50%);white-space:nowrap}form[data-v-df31ff14]{display:flex}button[data-v-df31ff14],input[data-v-df31ff14]{border:1px solid var(--rh-color-black-500,#8a8d90);box-sizing:border-box;height:40px}input[data-v-df31ff14]{border-right:none;flex:1;font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);padding-left:var(--rh-space-md,8px);width:100%}button[data-v-df31ff14]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border-left:none;display:flex;width:var(--rh-size-icon-04,40px)}button[data-v-df31ff14]:before{background:var(--rh-context-light-color-text-link,#06c);content:"";cursor:pointer;display:block;height:28px;margin:auto;width:28px}.search-icon[data-v-df31ff14]{margin:auto}ul[data-v-df31ff14]{max-width:275px;padding:0}ul li[data-v-df31ff14]{display:inline-block;list-style:none;margin-right:var(--rh-space-xl,24px);padding:var(--rh-space-xs,4px) 0}ul li a[data-v-df31ff14]{color:var(--rh-context-light-color-text-link,#06c);text-decoration:none}@media (min-width:992px){aside[data-v-df31ff14]{flex-direction:row}.mobile[data-v-df31ff14]{display:none}.desktop[data-v-df31ff14]{display:block}input[data-v-df31ff14]{width:auto}}</style>
<style>@keyframes fade-in{0%{opacity:0;visibility:hidden}1%{visibility:visible}to{opacity:1;visibility:visible}}@media (min-height:48em){.rhdocs{--rh-table--maxHeight:calc(100vh - 12.5rem)}}*,.rhdocs *,.rhdocs :after,.rhdocs :before,:after,:before{box-sizing:border-box}.rhdocs img,.rhdocs object,.rhdocs svg,img,object,svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs hr{border:0;border-top:.0625rem solid #d2d2d2;clear:both;margin:1rem 0}.rhdocs a{color:#06c;text-decoration:underline}.rhdocs a:focus,.rhdocs a:hover{color:#036}.rhdocs a.anchor-heading{color:#151515;cursor:pointer;text-decoration:none;word-break:break-all}.rhdocs p{margin:1.49963rem 0}.rhdocs li>p{margin:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:500;margin:0 0 .625rem}.rhdocs h1{font-size:2.25rem;margin:2rem 0}.rhdocs h2{font-size:1.625rem;margin:2rem 0}.rhdocs h3{font-size:1.5rem;font-weight:400}.rhdocs h4,.rhdocs h5{font-size:1.25rem}.rhdocs h5{font-weight:400}.rhdocs h6{font-size:1.125rem;font-weight:500;line-height:1.6667}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ol ::marker,.rhdocs ul ::marker{font:inherit}.rhdocs li{margin:0 0 .5em;padding:0}.rhdocs li>p{margin:.5rem 0}.rhdocs li>ol,.rhdocs li>ul{margin:0}.rhdocs dl dd{margin:.5rem 0 .5rem 1rem}.rhdocs dl dd>p{margin:.5rem 0}.rhdocs .informaltable,.rhdocs .table-contents,.rhdocs .table-wrapper{max-height:var(--rh-table--maxHeight);overflow:auto}.rhdocs table{border:0;font-size:1rem;line-height:1.6667;table-layout:fixed}.rhdocs table caption{color:#585858;margin-bottom:.5rem;margin-top:.5rem;text-align:left}.rhdocs table td,.rhdocs table th{border:0;border-bottom:.0625rem solid #d2d2d2;border-bottom:.0625rem solid var(--pfe-table--Border,#d2d2d2);padding:.5em 1rem}.rhdocs table td.halign-left,.rhdocs table th.halign-left{text-align:left}.rhdocs table td.halign-center,.rhdocs table th.halign-center,table td.halign-center,table th.halign-center{text-align:center}.rhdocs table td.halign-right,.rhdocs table th.halign-right{text-align:right}.rhdocs table td.valign-top,.rhdocs table th.valign-top{vertical-align:top}.rhdocs table td.valign-middle,.rhdocs table th.valign-middle{vertical-align:middle}.rhdocs table td.valign-bottom,.rhdocs table th.valign-bottom{vertical-align:bottom}.rhdocs table thead td,.rhdocs table thead th{background:#f5f5f5;font-weight:600}.rhdocs rh-table table,.rhdocs rh-table.rh-table--expanded-vertically{max-height:-moz-max-content;max-height:max-content}.rhdocs pre.nowrap{overflow:auto;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs .codeblock__wrapper pre{background:transparent}.rh-table--full-screen code,.rhdocs .content--md code,.rhdocs .content--sm code,.rhdocs .rh-table--full-screen code{overflow-wrap:normal;word-break:normal}.rhdocs[class] pre code,[class] pre code{background:inherit;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.rhdocs .keycap,.rhdocs kbd{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.keycap strong,.rhdocs .keycap strong{font-weight:inherit}.rhdocs kbd.keyseq,kbd.keyseq{background:transparent;border:0;box-shadow:none;padding:0}.rhdocs kbd.keyseq kbd,kbd.keyseq kbd{display:inline-block;margin:0 .375rem}.rhdocs kbd.keyseq kbd:first-child,kbd.keyseq kbd:first-child{margin-left:0}.rhdocs b.button{font-size:90%;font-weight:700;padding:.1875rem}.rhdocs b.button:before{content:"["}.rhdocs b.button:after{content:"]"}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}.rhdocs audio,.rhdocs canvas,.rhdocs progress,.rhdocs video{display:inline-block;vertical-align:baseline}.rhdocs audio:not([controls]){display:none;height:0}[hidden],template{display:none}.rhdocs a{background:transparent}.rhdocs a:active,.rhdocs a:hover{outline:0}.rhdocs a.anchor-heading:hover:before{color:#151515;content:"#";margin-left:-1.6rem;position:absolute}.rhdocs a.anchor-heading:focus-visible{color:#151515}@media screen and (max-width:990px){.rhdocs a.anchor-heading:hover:before{font-size:16px;margin-left:-1rem;padding-top:8px}.rhdocs h1 a.anchor-heading:hover:before{padding-top:12px}.rhdocs h4 a.anchor-heading:hover:before,.rhdocs h5 a.anchor-heading:hover:before{padding-top:4px}.rhdocs h6 a.anchor-heading:hover:before{padding-top:2px}}.rhdocs abbr[title]{border-bottom:.0625rem dotted}.rhdocs dfn{font-style:italic}.rhdocs h1{font-size:2em;margin:.67em 0}.rhdocs mark{background:#ff0;color:#000}.rhdocs small{font-size:80%}.rhdocs sub,.rhdocs sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}.rhdocs sup{top:-.5em}.rhdocs sub{bottom:-.25em}.rhdocs img{border:0}.rhdocs svg:not(:root){overflow:hidden}.rhdocs figure{margin:1em 2.5rem}.rhdocs hr{box-sizing:content-box;height:0}.rhdocs code,.rhdocs kbd,.rhdocs pre,.rhdocs samp{font-family:monospace,monospace;font-size:1em}.rhdocs button,.rhdocs optgroup,.rhdocs select,.rhdocs textarea,.rhdocsinput{color:inherit;font:inherit;margin:0}.rhdocs button.copy-link-btn{background:none;border:2px solid #fff;font:1px Red Hat Text}.rhdocs button.copy-link-btn:hover{border-bottom:2px solid #06c}.rhdocs button.copy-link-btn .link-icon{padding-bottom:4px}.rhdocs button{overflow:visible}.rhdocs button,.rhdocs select{text-transform:none}.rhdocs button,.rhdocs html input[type=button],.rhdocs input[type=reset],.rhdocs input[type=submit]{-moz-appearance:button;appearance:button;-webkit-appearance:button;cursor:pointer}.rhdocs button[disabled],.rhdocs html input[disabled]{cursor:default}.rhdocs button::-moz-focus-inner,.rhdocs input::-moz-focus-inner{border:0;padding:0}.rhdocs input{line-height:normal}.rhdocs input[type=checkbox],.rhdocs input[type=radio]{box-sizing:border-box;padding:0}.rhdocs input[type=number]::-webkit-inner-spin-button,.rhdocs input[type=number]::-webkit-outer-spin-button{height:auto}.rhdocs input[type=search]{-moz-appearance:textfield;appearance:textfield;-webkit-appearance:textfield;box-sizing:content-box}.rhdocs input[type=search]::-webkit-search-cancel-button,.rhdocs input[type=search]::-webkit-search-decoration{-webkit-appearance:none}.rhdocs fieldset{border:.0625rem solid silver;margin:0 .125rem;padding:.35em .625em .75em}.rhdocs legend{border:0;padding:0}.rhdocs textarea{overflow:auto}.rhdocs optgroup{font-weight:700}.rhdocs table{border-collapse:collapse;border-spacing:0}.rhdocs td,.rhdocs th{padding:0}.rhdocs ._additional-resources[class][class][id]:last-child{margin-top:-2rem}.rhdocs ._additional-resources[class][class]:only-child{grid-column:1/-1}._additional-resources[class][class] .additional-resources__heading,._additional-resources[class][class] .heading,._additional-resources[class][class] h1,._additional-resources[class][class] h2,._additional-resources[class][class] h3,._additional-resources[class][class] h4,._additional-resources[class][class] h5,._additional-resources[class][class] h6,._additional-resources[class][class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper ._additional-resources[class][class] ul{display:block}._additional-resources[class][class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}._additional-resources[class][class] li:only-child{grid-column:1/-1}._additional-resources[class][class] li:last-child{border:0}@media (min-width:1100px){._additional-resources[class][class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}._additional-resources[class][class] li p:only-child{margin:0;padding:0}._additional-resources[class][class] li a{text-decoration:none}._additional-resources[class][class] li a:focus,._additional-resources[class][class] li a:hover{text-decoration:underline}.rhdocs table .admonitionblock>div:nth-child(2),.rhdocs table .caution>div:nth-child(2),.rhdocs table .important>div:nth-child(2),.rhdocs table .note>div:nth-child(2),.rhdocs table .tip>div:nth-child(2),.rhdocs table .warning>div:nth-child(2){margin:.5rem 0}.rhdocs table .admonitionblock>div:nth-child(2)>:first-child,.rhdocs table .caution>div:nth-child(2)>:first-child,.rhdocs table .important>div:nth-child(2)>:first-child,.rhdocs table .note>div:nth-child(2)>:first-child,.rhdocs table .tip>div:nth-child(2)>:first-child,.rhdocs table .warning>div:nth-child(2)>:first-child{margin-top:0}.rhdocs table .admonitionblock>div:nth-child(2)>:last-child,.rhdocs table .caution>div:nth-child(2)>:last-child,.rhdocs table .important>div:nth-child(2)>:last-child,.rhdocs table .note>div:nth-child(2)>:last-child,.rhdocs table .tip>div:nth-child(2)>:last-child,.rhdocs table .warning>div:nth-child(2)>:last-child{margin-bottom:0}.rhdocs .codeblock__wrapper+.codeblock__wrapper,.rhdocs pre+pre,.rhdocs pre[class]+pre[class]{margin-top:2rem}.rhdocs .codeblock__wrapper{background:#f8f8f8;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__wrapper:before{background-repeat:no-repeat;background-size:6.25rem 100%;bottom:var(--scrollbar__height,1px);content:"";display:block;height:7.125rem;max-height:100%;max-height:calc(100% - var(--scrollbar__height, 2px));position:absolute;right:var(--scrollbar__width,6px);top:.0625rem;width:4.0625rem;z-index:1}.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 6.25rem)}@media (min-height:48em){.rhdocs .codeblock__inner-wrapper,.rhdocs pre{max-height:calc(100vh - 12.5rem)}}.rhdocs .codeblock__inner-wrapper{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs .codeblock__wrapper--expanded .codeblock__inner-wrapper{max-height:-moz-max-content;max-height:max-content}.codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.codeblock__copy:focus{outline:.0625rem dashed currentcolor}.codeblock__copy svg#icon--copy{height:1rem;width:1rem}.codeblock__expand{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;border:0;cursor:pointer;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));position:absolute;text-indent:-9999em;top:3.25rem;width:1.75rem;z-index:2}.codeblock__expand:before{background:#6a6e73;content:"";height:100%;left:0;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");mask-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512'%3E%3C!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc.--%3E%3Cpath d='M182.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l41.4-41.4v293.4l-41.4-41.3c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 402.7V109.3l41.4 41.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-96-96z'/%3E%3C/svg%3E");-webkit-mask-position:center center;mask-position:center center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:auto 1rem;mask-size:auto 1rem;position:absolute;top:0;width:100%}.codeblock__wrapper--expanded .codeblock__expand{background:#2b9af3}.codeblock__wrapper--expanded .codeblock__expand:before{background:#fff}.codeblock__expand:focus:before,.codeblock__expand:hover:before{background:#06c}.codeblock__wrapper--expanded .codeblock__expand:focus:before,.codeblock__wrapper--expanded .codeblock__expand:hover:before{background:#fff}.codeblock__expand:focus{outline:.0625rem dashed currentcolor}.rhdocs .calloutlist>ol,.rhdocs .colist>ol{counter-reset:colist;list-style:none;margin:1rem 0 2rem;padding:0}.rhdocs .calloutlist>ol>li,.rhdocs .colist>ol>li{counter-increment:colist;font-size:1rem;margin:.5rem 0;padding-left:1.75rem;position:relative}.rhdocs .calloutlist>ol>li .colist-num,.rhdocs .colist>ol>li .colist-num{display:none}.calloutlist>ol>li:before,.colist>ol>li:before{content:counter(colist);left:0;position:absolute;top:.1875rem}.calloutlist dt{clear:left;float:left;margin:0;padding:0 .5rem 0 0}.included-in-guides[class],.included-in-guides[class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.included-in-guides[class][id]:last-child{margin-top:-2rem}.included-in-guides[class]:only-child{grid-column:1/-1}.included-in-guides[class] .additional-resources__heading,.included-in-guides[class] .heading,.included-in-guides[class] h1,.included-in-guides[class] h2,.included-in-guides[class] h3,.included-in-guides[class] h4,.included-in-guides[class] h5,.included-in-guides[class] h6,.included-in-guides[class] p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.included-in-guides[class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.related-topic-content__wrapper .included-in-guides[class] ul{display:block}.included-in-guides[class] ul:after{background-color:#fff;bottom:0;content:"";display:block;height:.125rem;position:absolute;width:100%}.included-in-guides[class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.included-in-guides[class] li:only-child{grid-column:1/-1}.included-in-guides[class] li:last-child{border:0}@media (min-width:1100px){.included-in-guides[class] li:last-child{border-bottom:.0625rem solid #d2d2d2}}.included-in-guides[class] li p:only-child{margin:0;padding:0}.included-in-guides[class] li a{text-decoration:none}.included-in-guides[class] li a:focus,.included-in-guides[class] li a:hover{text-decoration:underline}.menuseq{display:inline-flex;overflow:hidden;text-indent:-9999em}.menuseq .menu,.menuseq .menuitem,.menuseq .submenu{display:block;position:relative;text-indent:0}.menuseq .menu+.menu:before,.menuseq .menu+.menuitem:before,.menuseq .menu+.submenu:before,.menuseq .menuitem+.menu:before,.menuseq .menuitem+.menuitem:before,.menuseq .menuitem+.submenu:before,.menuseq .submenu+.menu:before,.menuseq .submenu+.menuitem:before,.menuseq .submenu+.submenu:before{content:">";display:inline-block;font-weight:700;padding:0 .25em}.related-topic-content__wrapper{margin:2em 0}.related-topic-content__wrapper--for-guide{margin-bottom:-2.5rem;padding-bottom:.0625rem;position:relative;z-index:1}.related-topic-content__wrapper--for-guide:before{background:#f0f0f0;content:"";display:block;height:100%;left:-3rem;position:absolute;right:-4.5rem;top:0;width:auto;z-index:-1}@media (min-width:1100px){.related-topic-content__wrapper--for-guide:before{left:-2.5rem;right:-3.625rem}}.related-topic-content__wrapper--for-guide summary{padding:1em 2em 1em 2.1875rem}@media (min-width:950px){.related-topic-content__inner-wrapper{display:grid;gap:2em;grid-template-columns:repeat(2,minmax(0,1fr))}}.local-render .rhdocs-content{margin:0 auto}.rhdocs cp-documentation{display:block;padding-bottom:2.5rem}.rhdocs cp-documentation.PFElement,.rhdocs cp-documentation[pfelement]{padding:0}rh-table{display:block}::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar{height:.625rem;width:.625rem}::-webkit-scrollbar,::-webkit-scrollbar-track,:host .rhdocs ::-webkit-scrollbar,:host .rhdocs ::-webkit-scrollbar-track{background-color:#d6d6d6}::-webkit-scrollbar-thumb,:host .rhdocs ::-webkit-scrollbar-thumb{background-color:#8e8e8e}*,:host .rhdocs *{scrollbar-color:#8e8e8e #d6d6d6}.rhdocs p:empty,p:empty{display:none}.rhdocs[class] h1 code,.rhdocs[class] h2 code,.rhdocs[class] h3 code,.rhdocs[class] h4 code,.rhdocs[class] h5 code,.rhdocs[class] h6 code,[class] h1 code,[class] h2 code,[class] h3 code,[class] h4 code,[class] h5 code,[class] h6 code{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.pane-page-title h1,.rhdocs__header__primary-wrapper h1{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:2.25rem;line-height:1.333}.rhdocs details[class]{list-style:none;margin:1rem 0 3rem;padding:0}.rhdocs-toc[class]{background:#f2f2f2;margin:1rem 0 2rem;padding:1rem}.rhdocs-toc[class]>:last-child{margin-bottom:0}.rhdocs-toc[class] .rhdocs-toctitle{font-size:1.25rem;font-weight:400;line-height:1.6667;margin-top:0;text-transform:none}.rhdocs-toc[class] li{margin-bottom:.25em;padding-left:.5em}.preamble{margin:0 0 2rem}.sect1{margin:2rem 0 1rem}:host .sect1,cp-documentation .sect1{margin:0 0 2rem;padding:.0625rem 0 0}:host(.cp-documentation--has-external-header) .sect1:first-child>h2:first-child,:host(.cp-documentation--has-external-header) .sect1:first-child>h3:first-child{margin-top:0}.listingblock,.literalblock{margin:1rem 0}.quoteblock,.verseblock{border-left:.25rem solid #d2d2d2;margin:1rem 0;padding:1rem 1rem 1rem 2rem}.quoteblock.pullleft,.verseblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.quoteblock.pullleft,.verseblock.pullleft{margin-left:-1rem}}.quoteblock.pullright,.verseblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.quoteblock.pullright,.verseblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.quoteblock.pullright,.verseblock.pullright{margin-right:-10rem}}.quoteblock>:first-child,.verseblock>:first-child{margin-top:0}.quoteblock .content,.verseblock .content{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.25rem;line-height:1.6667}.quoteblock .attribution,.verseblock .attribution{font-size:.875rem;font-style:italic;font-weight:600;line-height:1.6667;text-transform:uppercase}.quoteblock .attribution .citetitle,.verseblock .attribution .citetitle{color:#585858}.quoteblock .attribution cite,.verseblock .attribution cite{font-size:1em}.quoteblock blockquote{font-style:italic;margin:0;padding:0}.quoteblock blockquote .content>:first-child{margin-top:0}.quoteblock blockquote .content>:first-child:before{color:#e00;content:"â€œ";display:block;float:left;font-size:2.75rem;font-style:normal;line-height:1.125em;margin-right:.5rem}.quoteblock blockquote .content>:first-child .content>:first-child:before{content:none}.imageblock{margin:1rem 0}.imageblock.pullleft{float:left;margin-right:3rem;width:25rem}@media (min-width:768px){.imageblock.pullleft{margin-left:-1rem}}.imageblock.pullright{float:right;margin-left:3rem;width:25rem}@media (min-width:768){.imageblock.pullright{margin-right:-2rem}}@media (min-width:1100px){.imageblock.pullright{margin-right:-10rem}}.imageblock.interrupter{margin:2rem 0}@media (min-width:768px){.imageblock.interrupter{margin-left:-1rem;margin-right:-2rem}.imageblock.interrupter .caption{margin-left:1rem;margin-right:2rem}}@media (min-width:1100px){.imageblock.interrupter{margin-right:-10rem}.imageblock.interrupter .caption{margin-right:10rem}}.imageblock.interrupter img{max-width:100%}.imageblock .caption{color:#585858;display:block;font-size:.875rem;line-height:1.6667;margin:.5rem 0 0}.rhdocs-footnotes{border-top:.0625rem solid #d2d2d2;margin:3rem 0 1rem;padding:1rem 0 0}.rhdocs-footnotes>ol{margin:0;padding:0 0 0 1.5rem}@supports (counter-reset:footnotenum){.rhdocs-footnotes>ol{counter-reset:footnotenum;list-style:none;padding:0}.rhdocs-footnotes>ol>li{counter-increment:footnotenum}.rhdocs-footnotes>ol>li:before{color:#585858;content:"[" counter(footnotenum) "]";display:inline-block;margin-right:.25rem}}.rhdocs-footer{background:#ededed;color:#151515;font-size:.875rem;line-height:1.6667;margin:3rem 0 0;padding:1rem}.center{margin-left:auto;margin-right:auto}.stretch{width:100%}.visually-hidden{overflow:hidden;position:absolute;clip:rect(0,0,0,0);border:0;height:.0625rem;margin:-.0625rem;padding:0;width:.0625rem}.rh-docs-legal-notice{margin-top:4em}pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}code.language-none,code.language-text,code.language-txt,pre.language-none,pre.language-text,pre.language-txt{color:#151515}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:#cceae7;color:#263238}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#cceae7;color:#263238}:not(pre)>code[class*=language-]{border-radius:.2em;padding:.1em;white-space:normal}.token.atrule{color:#40199a}.token.attr-name{color:#06c}.token.attr-value,.token.attribute{color:#b300b3}.token.boolean{color:#40199a}.token.builtin,.token.cdata,.token.char,.token.class,.token.class-name{color:#06c}.token.comment{color:#6a6e73}.token.constant{color:#40199a}.token.deleted{color:#c9190b}.token.doctype{color:#6a6e73}.token.entity{color:#c9190b}.token.function{color:#40199a}.token.hexcode{color:#b300b3}.token.id,.token.important{color:#40199a;font-weight:700}.token.inserted{color:#06c}.token.keyword{color:#40199a}.token.number{color:#b300b3}.token.operator{color:#06c}.token.prolog{color:#6a6e73}.token.property{color:#06c}.token.pseudo-class,.token.pseudo-element{color:#b300b3}.token.punctuation,.token.regex{color:#06c}.token.selector{color:#c9190b}.token.string{color:#b300b3}.token.symbol{color:#40199a}.token.unit{color:#b300b3}.token.url,.token.variable{color:#c9190b}.rhdocs.local-render{margin:0 auto;max-width:45.8125rem;padding:0 1.5rem}@media print{.field code,.field pre,code[class*=language-],pre,pre[class*=language-]{white-space:pre-wrap!important;word-wrap:break-word!important;overflow-wrap:break-word!important;word-break:break-word!important}}.book-nav__list[class]{display:flex;justify-content:space-between;line-height:var(--jupiter__lineHeight--xs,1.3333);list-style:none;margin:5rem 0 0;padding:0}@media (min-width:1200px){.book-nav__list[class]{display:grid;gap:2rem;grid-template-columns:repeat(2,minmax(0,1fr))}}.book-nav__item a{display:inline-block;font-size:.875rem;font-weight:500;padding-left:1.25rem;position:relative;text-transform:uppercase}.book-nav__item a:before{background:url(/sites/dxp-docs/penumbra-dist/jupiter/images/arrow-down-solid.svg) no-repeat;background-size:contain;content:"";display:block;height:.875rem;left:0;position:absolute;top:.125rem;transform:rotate(90deg);width:.875rem}.book>.titlepage:not(:last-child),.rhdocs .chapter,section[id]{padding-bottom:3.75rem}.book>.titlepage .chapter:last-child,.book>.titlepage section[id]:last-child,.chapter .chapter:last-child,.chapter section[id]:last-child,section[id] .chapter:last-child,section[id] section[id]:last-child{margin-bottom:-3.75rem}.rhdocs .codeblock__wrapper+section[id],pre+section[id]{padding-top:3.75rem}.rhdocs .cta-link{font-size:inherit}.rhdocs a{word-wrap:break-word;overflow-wrap:break-word}.rhdocs .caution,.rhdocs .important,.rhdocs .note,.rhdocs .tip,.rhdocs .warning{padding:.8888888889em;position:relative}.rhdocs .QSIPopOver{bottom:18.75rem!important;top:auto!important}.rhdocs .alert{position:relative}.rhdocs button.dismiss-button{background:none;border:0;cursor:pointer;height:2.5rem;margin-top:-1.25rem;padding:0;position:absolute;right:.3125rem;text-align:center;top:50%;width:2.5rem;z-index:50}.rhdocs button.dismiss-button:after{content:"\f109";display:inline-block;filter:alpha(opacity=30);font-family:rh-web-iconfont;font-size:1.3125rem;font-style:normal;font-variant:normal;font-weight:400;line-height:1;line-height:2.5rem;opacity:.3;text-decoration:inherit;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs .book>.titlepage,.rhdocs .chapter,.rhdocs section[id]{padding-bottom:var(--rh-space-4xl,64px)}.rhdocs .alert{border:0;border-radius:0}.rhdocs .alert>h2:first-child,.rhdocs .alert>h3:first-child,.rhdocs .alert>h4:first-child,.rhdocs .alert>h5:first-child,.rhdocs .alert>h6:first-child,.rhdocs .alert>p:first-child{margin-top:0!important}.rhdocs .alert>p:last-child{margin-bottom:0!important}.rhdocs .alert-w-icon[class]{padding-left:2.8125rem}.rhdocs .alert-w-icon .alert-icon{float:left;font-size:1.125rem;margin-left:-1.875rem;margin-right:.625rem}.rhdocs .alert-w-icon .alert-icon[class*=" rh-icon-"],.rhdocs .alert-w-icon .alert-icon[class^=rh-icon-]{font-size:2.25rem;line-height:1em;margin-left:-2.5rem;margin-top:-.375rem}.rhdocs .alert-w-icon .alert-icon[class*=" icon-innov-prev"],.rhdocs .alert-w-icon .alert-icon[class^=icon-innov-prev]{font-size:1.3125rem;margin-top:.25rem}.rhdocs .alert-w-icon.alert-plain{background:none;color:#151515;padding-left:5rem}.rhdocs .alert-w-icon.alert-plain .alert-icon{font-size:3rem;margin-left:-4.375rem;margin-right:0}.rhdocs .alert-w-icon.alert-plain.alert-success .alert-icon{color:#3f9c35}.rhdocs .alert-w-icon.alert-plain.alert-info .alert-icon{color:#0088ce}.rhdocs .alert-w-icon.alert-plain.alert-warning .alert-icon{color:#f0ab00}.rhdocs .alert-w-icon.alert-plain.alert-danger .alert-icon{color:#e00}#target_banner .copy-url{float:right;margin-top:0}#target_banner .dropdown-menu{font-size:inherit}.titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.para{margin:1.49963rem 0}.para[class]{margin-bottom:1.49963rem}dd{margin-bottom:2.5rem}.rhdocs .card-light,.rhdocs .card-light-gray,.rhdocs .card-light-grey{background:#f0f0f0;border:.0625rem solid #f0f0f0;color:#151515}.rhdocs .card-light-gray.push-bottom:first-child,.rhdocs .card-light-grey.push-bottom:first-child,.rhdocs .card-light.push-bottom:first-child{margin-bottom:3.125rem!important}.rhdocs .card-light a.card-link,.rhdocs .card-light h1,.rhdocs .card-light h2,.rhdocs .card-light h3,.rhdocs .card-light h4,.rhdocs .card-light h5,.rhdocs .card-light h6,.rhdocs .card-light-gray a.card-link,.rhdocs .card-light-gray h1,.rhdocs .card-light-gray h2,.rhdocs .card-light-gray h3,.rhdocs .card-light-gray h4,.rhdocs .card-light-gray h5,.rhdocs .card-light-gray h6,.rhdocs .card-light-grey a.card-link,.rhdocs .card-light-grey h1,.rhdocs .card-light-grey h2,.rhdocs .card-light-grey h3,.rhdocs .card-light-grey h4,.rhdocs .card-light-grey h5,.rhdocs .card-light-grey h6{color:#151515}.rhdocs .card-light-gray.card-active:after,.rhdocs .card-light-grey.card-active:after,.rhdocs .card-light.card-active:after{border-top-color:#f0f0f0}.rhdocs .card-md,.rhdocs .card-narrow{display:block;padding:1.1875rem;white-space:normal;word-wrap:break-word}.rhdocs .card .card-heading.card-heading-sm,.rhdocs .card-sm .card .card-heading{font-size:1.0625em;font-weight:500;line-height:1.5}.rhdocs .card .card-heading.card-heading-flush{margin-bottom:.25rem}.rhdocs .card .card-heading.card-heading-red{color:#d10000}.rhdocs .card>p{margin-top:0}.rhdocs .card>p:last-child{margin-bottom:0}.rhdocs .new-experience{background-color:#e7f1fa;border:.0625rem solid #bee1f4;font-size:1rem;margin:1.5rem;padding:1.5rem;position:relative;z-index:1}@media (min-width:48rem){.new-experience{display:flex}.new-experience--contained{left:50%;position:relative;transform:translateX(-50%);width:calc(100vw - 2.5rem)}}.new-experience__primary-content{flex-grow:1}@media (min-width:48rem){.new-experience__primary-content{margin-right:1.25rem}}.new-experience__title{font-size:inherit;font-weight:inherit;line-height:1.6;margin:0;padding:0}.new-experience__title+a,.new-experience__title+pfe-cta{display:inline-block;margin-top:1.5em}.new-experience__secondary-content{min-width:12.5rem}@media (min-width:48rem){.new-experience__secondary-content{text-align:right}}.example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:min-content 1fr}dl.calloutlist[class] dt{float:none;margin:0;padding:0}dl.calloutlist[class] dd{margin:0;padding:0}dl.calloutlist[class] dd>:first-child{margin-top:0}dl.calloutlist[class] dd>:last-child{margin-bottom:0}.toast{background-color:#000;background-color:rgba(0,0,0,.9);bottom:.9375rem;box-shadow:0 .125rem .3125rem 0 rgba(0,0,0,.26);color:#fff;left:.9375rem;max-width:32.8125rem;min-width:6.25rem;padding:.9375rem;position:fixed;right:.9375rem;transform:translate3d(0,150%,0);transition:transform .2s cubic-bezier(.465,.183,.153,.946);will-change:transform;z-index:999}.toast.show{transform:translateZ(0)}.toast a{color:#fff;text-decoration:underline}.toast a:focus,.toast a:hover{color:#2b9af3}.toast a.btn{text-decoration:none}.toast .btn.btn-link{color:#fff}.toast .close{color:#fff;opacity:.3;text-decoration:none}.toast .close:focus,.toast .close:hover{color:#fff;opacity:.5}.no-csstransforms3d.csstransitions .toast{transition:all .2s cubic-bezier(.465,.183,.153,.946)}.no-csstransforms3d .toast{opacity:0;visibility:hidden}.no-csstransforms3d .toast.show{opacity:1;visibility:visible}.annotator-outer[class][class]{display:none;flex-direction:column;flex-grow:1;height:auto;margin:0;position:static;width:auto}@media (min-width:1400px){.annotator-outer[class][class]{display:flex}}.annotator-frame[class] *{height:auto}@media (min-width:1400px){.annotator-frame .h-sidebar-iframe[class]{position:static;width:calc(100% + 1.5rem)}}.annotator-toolbar[class][class]{position:static;width:auto}.annotator-toolbar>ul,.annotator-toolbar>ul>li{display:block;height:auto;list-style:none;margin:0;padding:0;width:auto}.annotator-toolbar>ul>li{display:flex;justify-content:flex-end}.annotator-frame[class] .annotator-frame-button--sidebar_toggle,.annotator-outer .annotator-frame-button[class][class],.app-content-wrapper *{font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif!important}.annotator-outer .annotator-frame-button[class][class]{font-size:.9375rem;font-weight:500;height:auto;line-height:1.333;margin-right:1.875rem;padding:.75em 1em;position:static}@media (min-width:1400px){.annotator-outer .annotator-frame-button[class][class]{margin-right:0}}.annotator-outer iframe{flex-grow:1;margin-bottom:1.25rem}@media (min-width:1400px){.annotator-outer iframe{min-height:37.5rem}}.producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.producttitle .productnumber{color:var(--jupiter__palette__red--50,#e00)}.cp-modal-open,.zoom-open{overflow:hidden}.cp-modal,.cp-video-modal,.zoom-modal{bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;outline:0;overflow:hidden;position:fixed;right:0;top:0;transition:all .2s cubic-bezier(.465,.183,.153,.946);z-index:1040;z-index:1050;-webkit-overflow-scrolling:touch}.rhdocs .in.cp-modal,.rhdocs .in.cp-video-modal,.rhdocs .in.zoom-modal{display:block;filter:alpha(opacity=100);opacity:1;overflow-x:hidden;overflow-y:auto}.rhdocs .cp-modal .close,.rhdocs .cp-video-modal .close,.rhdocs .zoom-modal .close{background-color:#fff;border-radius:50%;color:#1a1a1a;font-size:1.75rem;height:28px;height:1.75rem;line-height:1.75rem;margin-bottom:.375rem;margin-top:0;opacity:.9;position:absolute;right:-.5rem;text-shadow:none;top:0;width:28px;width:1.75rem}.cp-modal .close:after,.cp-video-modal .close:after,.zoom-modal .close:after{line-height:1.75rem}.cp-modal-wrap,.zoom-wrap{margin:.625rem;padding-top:.5rem;position:relative}@media (min-width:48rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{margin:2.8125rem auto;width:38.4375rem}}@media (min-width:62rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:49.8958rem}}@media (min-width:75rem){.rhdocs .cp-modal-wrap,.rhdocs .zoom-wrap{width:60.3125rem}}.rhdocs .cp-modal-body :last-child{margin-bottom:0}.rhdocs .cp-modal-backdrop,.rhdocs .zoom-backdrop{background-color:#000;bottom:0;display:none;filter:alpha(opacity=0);left:0;opacity:0;position:fixed;right:0;top:0;transition:opacity .2s cubic-bezier(.465,.183,.153,.946);z-index:1040}.rhdocs .in.cp-modal-backdrop,.rhdocs .in.zoom-backdrop{display:block;filter:alpha(opacity=80);opacity:.8}.rhdocs .cp-modal-body{background:#fff;padding:1.875rem}.rhdocs .cp-modal[data-cp-modal-video=true] .cp-modal-body,.rhdocs .cp-video-modal .cp-modal-body{padding:0}.rhdocs [data-action=zoom]{position:relative}.rhdocs [data-action=zoom]:after{background:rgba(0,0,0,.4);bottom:0;color:#fff;display:inline-block;font-family:rh-web-iconfont;font-style:normal;font-variant:normal;font-weight:400;line-height:1;padding:.375rem;position:absolute;right:0;text-decoration:inherit;text-decoration:none!important;text-rendering:optimizeLegibility;text-transform:none!important;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.rhdocs [data-action=zoom]:focus:after,.rhdocs [data-action=zoom]:hover:after{background:rgba(0,0,0,.9)}.rhdocs .zoom-wrap .zoom-larger{text-align:center}.rhdocs .zoom-wrap .zoom-larger a{color:#fff}.rhdocs .zoom-wrap .zoom-larger a:focus,.rhdocs .zoom-wrap .zoom-larger a:hover{color:#fff;text-decoration:underline}.rhdocs .zoom-wrap .zoom-larger a:after{content:"â¿»";display:inline-block;margin-left:.25rem}.rhdocs .zoom-body{background:#fff;border-radius:.5rem;margin:0 0 1rem;padding:1rem;text-align:center}.rhdocs .zoom-body .video-wrapper{height:0;overflow:hidden;padding-bottom:56.25%;position:relative}.rhdocs .zoom-body .video-wrapper[data-aspect-ratio="4:3"]{padding-bottom:75%}.rhdocs .zoom-body iframe{height:100%;left:0;position:absolute;top:0;width:100%}.rhdocs .para>.title[class],.rhdocs p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0;text-transform:none}.rhdocs .para>.title[class]+.content>:first-child,.rhdocs .para>.title[class]+p,.rhdocs p.title[class]+.content>:first-child,.rhdocs p.title[class]+p{margin-top:0}.rhdocs [class] pre .caution,.rhdocs [class] pre .important,.rhdocs [class] pre .note,.rhdocs [class] pre .tip,.rhdocs [class] pre .warning{background:transparent;border:0;color:inherit;font:inherit;margin:0;padding:0}.rhdocs [class] pre .caution:after,.rhdocs [class] pre .important:after,.rhdocs [class] pre .note:after,.rhdocs [class] pre .tip:after,.rhdocs [class] pre .warning:after{content:none}.rhdocs [class] code.email{background-color:transparent;font:inherit;padding:0}.rhdocs [class] .author{margin-bottom:1.5rem}.rhdocs [class] .author .author{margin-bottom:0}.rhdocs table{margin:2rem 0}.rhdocs [class] table{width:auto}.rhdocs table .table-contents table{max-width:100%;overflow:auto}.rhdocs rh-table table{margin:0;max-width:9999em;overflow:visible}.rhdocs td,.rhdocs th{border-left:0;padding:.5em 1rem;transition:background .25s ease-out}.rhdocs td.content--md[class][class],.rhdocs th.content--md[class][class]{min-width:13em}.rhdocs td.content--lg[class][class],.rhdocs th.content--lg[class][class]{min-width:20em}.rhdocs thead th{padding-top:1.5em}.rhdocs caption{color:currentColor;color:var(--pfe-table__caption--Color,currentColor);font-weight:700;margin-bottom:.5rem;margin-top:.5rem;text-align:center}.rhdocs .revhistory table td,.rhdocs .revhistory table th{border-color:transparent}.rhdocs .revhistory table td{padding:.625rem .875rem}.rhdocs .revhistory table.simplelist{margin:0}@media print{#masthead{display:none!important}}.rh-table--is-full-screen #to-top{display:none}.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:var(--rh-font-family-body-text,RedHatText,"Red Hat Text","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);font-size:var(--rh-body-copy-lage,1.125rem);line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs rh-codeblock::slotted(#content){border-radius:.25rem;padding:var (--rh-space-lg,16px)}.rhdocs rh-codeblock .screen{display:grid;grid-template-columns:1fr 4.375rem}.rhdocs rh-codeblock[class][class][class][class][class]{max-width:99999em}.rhdocs .codeblock__copy span{display:block;height:0;position:absolute;visibility:hidden;width:0}.rhdocs .codeblock__copy:focus{outline:.0625rem dashed currentcolor}.rhdocs .codeblock__copy svg#icon--copy{height:1rem;width:1rem}.rhdocs pre{border:0;max-height:-moz-max-content;max-height:max-content}.rhdocs pre,pre[class]{margin:0;padding:1.25em 1em;position:relative}.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre,.rhdocs rh-code-block>div.codeblock__inner-wrapper>pre[class]{margin:0;padding:0;position:relative}.rhdocs code[class*=language-],pre[class*=language-]{color:#151515;-moz-tab-size:4;-o-tab-size:4;tab-size:4}.rhdocs code.literal{background:#eee;border-radius:.25rem;color:#000;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs code.literal,.rhdocs kbd,.rhdocs span.keycap{font-family:RedHatMono,Red Hat Mono,Consolas,monospace}.rhdocs kbd,.rhdocs span.keycap{background-color:#eee;background-image:linear-gradient(180deg,#ddd,#eee,#fff);border-radius:.1875rem;box-shadow:0 -.0625rem 0 0 #fff,0 .0625rem 0 .1875rem #aaa;font-size:90%;font-weight:400;margin:0 .25rem;padding:.125rem .375rem}.rhdocs ol,.rhdocs ul{margin:1rem 0;padding:0 0 0 1.5rem}.rhdocs ._additional-resources[class][class],.rhdocs ._additional-resources[class][class][id]:last-child{background:#fff;border:.0625rem solid #d2d2d2;border-radius:.1875rem;margin:2em 0 4em;padding:2rem 2rem 1rem}.rhdocs ._additional-resources[class][class] ul{border:0;list-style:none;margin:0;padding:0;position:relative}.rhdocs ._additional-resources[class][class] li{border-bottom:.0625rem solid #d2d2d2;box-sizing:content-box;margin:0;padding:1rem 1.5rem 1rem 0;-moz-column-break-inside:avoid;break-inside:avoid}.rhdocs ._additional-resources[class][class] li:last-child{border:0}.rhdocs section.section#additional_resource .additional-resources__heading,.rhdocs section.section#additional_resource .heading,.rhdocs section.section#additional_resource h1,.rhdocs section.section#additional_resource h2,.rhdocs section.section#additional_resource h3,.rhdocs section.section#additional_resource h4,.rhdocs section.section#additional_resource h5,.rhdocs section.section#additional_resource h6,.rhdocs section.section#additional_resource p.title{display:block;font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;font-weight:700;line-height:1.5rem;margin:0 0 .5rem;padding:0;text-transform:uppercase}.rhdocs section.section:first-of-type{margin-top:var(--rh-space-4xl,64px)}.rhdocs section.section p{margin-bottom:var(--rh-space-lg,16px);margin-top:0;word-wrap:break-word}.rhdocs .section.section h1,.rhdocs .section.section h2,.rhdocs .section.section h3,.rhdocs .section.section h4,.rhdocs .section.section h5,.rhdocs .section.section h6,.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica Neue,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h1:first-of-type,.rhdocs h2:first-of-type,.rhdocs h3:first-of-type,.rhdocs h4:first-of-type,.rhdocs h5:first-of-type,.rhdocs h6:first-of-type{margin-top:0}.rhdocs h1,.rhdocs h2,.rhdocs h3,.rhdocs h4,.rhdocs h5,.rhdocs h6{font-family:RedHatDisplay,Red Hat Display,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.3333}.rhdocs h2,.rhdocs section.section h2{font-size:var(--rh-font-size-heading-md,1.75rem)}.rhdocs h3,.rhdocs section.section h3{font-size:1.5rem;font-weight:400}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs dl{display:block;margin-block-end:1em;margin-block-start:1em;margin-inline-end:0;margin-inline-start:0}.rhdocs .para{margin:1.49963rem 0}.rhdocs dl.calloutlist[class] dt{float:none;margin:0;padding:0}.rhdocs dl.calloutlist[class] dd>:last-child{margin-bottom:0}.rhdocs dl.calloutlist[class]{display:grid;gap:1.25em .75em;grid-template-columns:fit-content(40%) 1fr}.rhdocs .calloutlist dt{clear:left;display:flex;flex-wrap:wrap;float:left;margin:0;padding:0 .5rem 0 0}.rhdocs .calloutlist dt a:not(:first-child){padding-left:4px}.rhdocs dl.calloutlist[class] dd{margin:0;padding:0}.rhdocs .callout,.rhdocs .colist>ol>li:before,.rhdocs .conum{background:#06c;border-radius:50%;color:#fff;display:inline-block;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:.75rem;font-style:normal;font-weight:600;height:1.25rem;line-height:1.35rem;padding:0;position:relative;text-align:center;top:-.125em;vertical-align:middle;width:1.25rem}.rhdocs img,.rhdocs object,.rhdocs svg{display:inline-block;max-width:100%;vertical-align:middle}.rhdocs .titlepage .svg-img[data*="title_logo.svg"]{margin:1.5rem 0;width:15rem}.rhdocs[class] .author{margin-bottom:1.5rem}.rhdocs[class] .author .author{margin-bottom:0}.rhdocs .para>.title[class],p.title[class]{font-size:1rem;font-style:normal;font-weight:700;line-height:1.6667;margin:1.25rem 0 0}.rhdocs .example{border-left:.3125rem solid #ccc;margin-bottom:2rem;padding:1rem 0 1rem 1rem}.rhdocs code{background:#eee;color:#000;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:break-word;padding:.125em .5em;word-break:break-word}.rhdocs .para[class]{margin-bottom:1.49963rem}.rhdocs[class] code.email{background-color:transparent;font:inherit;padding:0}rh-alert.admonition #description,rh-alert.admonition p{font-size:var(--rh-font-size-body-text-md,1rem)}rh-alert{width:-moz-fit-content;width:fit-content}.rhdocs .producttitle{color:#000;font-size:1.25rem;text-transform:uppercase}.rhdocs dl{margin:1rem 0}.rhdocs dl dt{font-weight:600;margin:.5rem 0}.rhdocs ol ol{list-style:lower-roman}.rhdocs .codeblock--processed pf-clipboard-copy::part(input),.rhdocs .codeblock--processed pf-clipboard-copy::part(span){display:none}.token.tag{color:#c9190b}.calloutlist div.para{margin:0}rh-alert.admonition{margin-bottom:var(--rh-space-lg,1rem)}.guibutton,.guimenu,.guimenuitem{font-weight:700}.guibutton{font-size:90%;padding:.1875rem}.guibutton:before{content:"["}.guibutton:after{content:"]"}.docs-content-container,.rhdocs{--rh-table--maxHeight:calc(100vh - 6.25rem);color:#151515;font-family:RedHatText,Red Hat Text,Helvetica Neue,Arial,sans-serif;font-size:1.125rem;line-height:1.6667;-moz-tab-size:4;-o-tab-size:4;tab-size:4}pre[hidden]{display:none}.codeblock[class][class][class][class][class]{max-width:99999em}.codeblock__wrapper{background:var(--rh-color-surface-lighter,#f2f2f2);margin:1rem 0;overflow:visible;position:relative;transform:translate(0);z-index:0}.codeblock__inner-wrapper:after{content:"";display:block;min-height:.625rem;width:4.375rem}.codeblock__copy{--pfe-clipboard--icon--Color--hover:#06c;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#f0efef;height:1.75rem;left:calc(100% - 2.75rem - var(--scrollbar__width, 0px));padding:.3125rem .375rem;position:absolute;top:1rem;width:1.75rem;z-index:2}.codeblock__inner-wrapper pre{border:0;max-height:-moz-max-content;max-height:max-content}.pfe-clipboard:not([copied]) .pfe-clipboard__text--success,:host(:not([copied])) .pfe-clipboard__text--success{display:none!important}.codeblock[class]{margin:0;overflow:visible;padding-right:0}pre{display:block;font-size:.8125rem;line-height:1.42857;margin:0 0 .625rem;word-break:break-all;word-wrap:break-word;background-color:var(--rh-color-surface-lighter,#f2f2f2);border:.0625rem solid #ccc;border-radius:.25rem;color:#333}.docs-content-container pre,.rhdocs pre{background:var(--rh-color-surface-lighter,#f2f2f2);color:#151515;font-family:RedHatMono,Red Hat Mono,Consolas,monospace;font-size:.875rem;line-height:1.6667;overflow-wrap:normal;white-space:pre;word-break:normal}.rhdocs pre[class]{line-height:1.6667;overflow-x:auto}rh-codeblock pre[class][class]{overflow-x:auto}.pfe-clipboard__text--success{background-color:#ddd;border:1px solid #000;border-radius:2px}*,:after,:before{box-sizing:border-box}:root{--rh-space-xs:4px;--rh-space-sm:6px;--rh-space-md:8px;--rh-space-lg:16px;--rh-space-xl:24px;--rh-space-2xl:32px;--rh-space-3xl:48px;--rh-space-4xl:64px;--rh-space-5xl:80px;--rh-space-6xl:96px;--rh-space-7xl:128px;--rh-font-size-body-text-xs:.75rem;--rh-font-size-body-text-sm:.875rem;--rh-font-size-body-text-md:1rem;--rh-font-size-body-text-lg:1.125rem;--rh-font-size-body-text-xl:1.25rem;--rh-font-size-body-text-2xl:1.5rem;--rh-font-size-heading-xs:1.25rem;--rh-font-size-heading-sm:1.5rem;--rh-font-size-heading-md:1.75rem;--rh-font-size-heading-lg:2.25rem;--rh-font-size-heading-xl:2.5rem;--rh-font-size-heading-2xl:3rem;--pfe-navigation--logo--maxWidth:200px;--pfe-navigation__logo--height:40px;--pfe-navigation--fade-transition-delay:500ms;--pfe-navigation__nav-bar--highlight-color:var(--rh-color-brand-red-on-dark,#e00);--pf-global--icon--FontSize--sm:.75rem}body,html{font-family:Red Hat Text,sans-serif;font-size:var(--rh-font-size-body-text-md,1rem);line-height:var(--rh-line-height-body-text,1.5);margin:0}h1,h2,h3,h4,h5,h6{font-family:Red Hat Display,sans-serif;font-weight:400;line-height:var(--rh-line-height-heading,1.3)}h1{font-size:var(--rh-font-size-heading-2xl,3rem);line-height:62px}h2{font-size:var(--rh-font-size-heading-xl,2.5rem);line-height:48px}h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}h4{font-size:var(--rh-font-size-heading-md,2.25rem)}h5{font-size:var(--rh-font-size-heading-sm,2.25rem)}h6{font-size:var(--rh-font-size-heading-xs,2.25rem)}main{line-height:30px}section{padding-bottom:3rem;padding-top:3rem}img{height:auto;max-width:100%}a{color:var(--rh-color-interactive-blue-darker,#06c);text-decoration:none}a:hover{color:var(--rh-color-interactive-blue-darkest,#004080)}rh-alert.html-container a{text-decoration:underline}.container{padding-left:12px;padding-right:12px}.container,.container-fluid{margin-left:auto;margin-right:auto;width:100%}.container-fluid{padding:12px}@media (min-width:576px){.container{max-width:540px}}@media (min-width:768px){.container{max-width:720px}}@media (min-width:992px){.container{max-width:960px}}@media (min-width:1200px){.container{min-width:1140px}}@media (min-width:1400px){.container{min-width:1320px}}.grid{display:grid;gap:var(--rh-space-xl,24px)}.grid-center{margin:auto}.grid.grid-col-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-12{grid-template-columns:repeat(12,1fr)}@media (min-width:768px){.grid.grid-col-md-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-md-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-md-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-md-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-md-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-md-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-md-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-md-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-md-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-md-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-md-12{grid-template-columns:repeat(12,1fr)}}@media (min-width:992px){.grid.grid-col-lg-2{grid-template-columns:repeat(2,1fr)}.grid.grid-col-lg-3{grid-template-columns:repeat(3,1fr)}.grid.grid-col-lg-4{grid-template-columns:repeat(4,1fr)}.grid.grid-col-lg-5{grid-template-columns:repeat(5,1fr)}.grid.grid-col-lg-6{grid-template-columns:repeat(6,1fr)}.grid.grid-col-lg-7{grid-template-columns:repeat(7,1fr)}.grid.grid-col-lg-8{grid-template-columns:repeat(8,1fr)}.grid.grid-col-lg-9{grid-template-columns:repeat(9,1fr)}.grid.grid-col-lg-10{grid-template-columns:repeat(10,1fr)}.grid.grid-col-lg-11{grid-template-columns:repeat(11,1fr)}.grid.grid-col-lg-12{grid-template-columns:repeat(12,1fr)}}.span-1{grid-column:span 1}.span-2{grid-column:span 2}.span-3{grid-column:span 3}.span-4{grid-column:span 4}.span-5{grid-column:span 5}.span-6{grid-column:span 6}.span-7{grid-column:span 7}.span-8{grid-column:span 8}.span-9{grid-column:span 9}.span-10{grid-column:span 10}.span-11{grid-column:span 11}.span-12{grid-column:span 12}@media (min-width:399px){.span-xs-1{grid-column:span 1}.span-xs-2{grid-column:span 2}.span-xs-3{grid-column:span 3}.span-xs-4{grid-column:span 4}.span-xs-5{grid-column:span 5}.span-xs-6{grid-column:span 6}.span-xs-7{grid-column:span 7}.span-xs-8{grid-column:span 8}.span-xs-9{grid-column:span 9}.span-xs-10{grid-column:span 10}.span-xs-11{grid-column:span 11}.span-xs-12{grid-column:span 12}}@media (min-width:768px){.span-md-1{grid-column:span 1}.span-md-2{grid-column:span 2}.span-md-3{grid-column:span 3}.span-md-4{grid-column:span 4}.span-md-5{grid-column:span 5}.span-md-6{grid-column:span 6}.span-md-7{grid-column:span 7}.span-md-8{grid-column:span 8}.span-md-9{grid-column:span 9}.span-md-10{grid-column:span 10}.span-md-11{grid-column:span 11}.span-md-12{grid-column:span 12}}@media (min-width:992px){.span-lg-1{grid-column:span 1}.span-lg-2{grid-column:span 2}.span-lg-3{grid-column:span 3}.span-lg-4{grid-column:span 4}.span-lg-5{grid-column:span 5}.span-lg-6{grid-column:span 6}.span-lg-7{grid-column:span 7}.span-lg-8{grid-column:span 8}.span-lg-9{grid-column:span 9}.span-lg-10{grid-column:span 10}.span-lg-11{grid-column:span 11}.span-lg-12{grid-column:span 12}}@media (min-width:1025px){.span-xl-1{grid-column:span 1}.span-xl-2{grid-column:span 2}.span-xl-3{grid-column:span 3}.span-xl-4{grid-column:span 4}.span-xl-5{grid-column:span 5}.span-xl-6{grid-column:span 6}.span-xl-7{grid-column:span 7}.span-xl-8{grid-column:span 8}.span-xl-9{grid-column:span 9}.span-xl-10{grid-column:span 10}.span-xl-11{grid-column:span 11}.span-xl-12{grid-column:span 12}}@media (min-width:1200px){.span-2xl-1{grid-column:span 1}.span-2xl-2{grid-column:span 2}.span-2xl-3{grid-column:span 3}.span-2xl-4{grid-column:span 4}.span-2xl-5{grid-column:span 5}.span-2xl-6{grid-column:span 6}.span-2xl-7{grid-column:span 7}.span-2xl-8{grid-column:span 8}.span-2xl-9{grid-column:span 9}.span-2xl-10{grid-column:span 10}.span-2xl-11{grid-column:span 11}.span-2xl-12{grid-column:span 12}}.flex{display:flex;flex-direction:column;gap:var(--rh-space-lg,16px)}.flex-row{flex-direction:row}.flex-column{flex-direction:column}@media (min-width:768px){.flex-md-row{flex-direction:row}.flex-md-column{flex-direction:column}}.typography-h1{font-size:var(--rh-font-size-heading-2xl,3rem)}.typography-h2{font-size:var(--rh-font-size-heading-xl,2.5rem)}.typography-h3{font-size:var(--rh-font-size-heading-lg,2.25rem)}.typography-h4{font-size:var(--rh-font-size-heading-md,1.75rem)}.typography-h5{font-size:var(--rh-font-size-heading-sm,1.5rem)}.typography-h6{font-size:var(--rh-font-size-heading-xs,1.25rem)}.content section{padding:0}.content h1,.content h2,.content h3,.content h4,.content h5,.content h6{margin:var(--rh-space-lg,16px) 0}.sr-only{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0}.list-unstyled{list-style:none;padding-left:0}.tooltip-content{align-items:center;display:flex;font-family:Red Hat Text;justify-content:center;text-transform:none}.tooltip-content .check-icon{margin-left:var(--rh-space-md,8px)}.doc-image-link{display:inline-block;text-decoration:none}.modal-img{display:block;width:100%}.modal-helper-text{margin-top:.5rem;text-align:center}.modal-helper-text a{color:#000;cursor:pointer}.modal-helper-text a:hover{text-decoration:underline}.modal-helper-text a:after{content:"⿻";margin-left:.25rem}pf-modal.pf-img-modal{--pf-c-modal-box--MaxHeight:90vh;overflow-y:scroll}pf-modal.pf-img-modal::part(close-button){background-color:#fff;border-radius:50%;color:#000;margin-right:-2rem;margin-top:-2rem}pf-modal.pf-img-modal::part(close-button):hover{opacity:.7}h2.truste-title{line-height:normal;margin-top:0}rh-alert p[slot=header]{color:#002952}@media (width < 992px){html:has(nav.mobile-nav .mobile-nav-wrapper){scroll-behavior:smooth;scroll-padding-top:4rem}html:has(nav.mobile-nav .mobile-jump-links){scroll-padding-top:7rem}html:has(nav.mobile-nav.hide-mobile-nav){scroll-padding-top:2rem}}.highlight{background:#fff4cc;color:#000}</style>
<style>rh-alert[data-v-84359384]{width:100%}</style>
<style>.search-btn[data-v-edc0d12c]{align-items:center;background-color:var(--rh-color-canvas-black,#151515);border:3px solid var(--rh-color-canvas-black,#151515);cursor:pointer;display:flex;flex-direction:column;height:100%;justify-content:center;outline:none;padding:14px var(--rh-space-md,8px)}.search-btn[data-v-edc0d12c]:focus{border-top:3px solid var(--rh-color-accent-brand-on-light,#e00);outline:2px dotted var(--rh-color-white,#fff)}.search-btn .search-icon[data-v-edc0d12c]{height:26px;padding:2px 0 var(--rh-space-xs,4px);width:20px}.search-btn .search-icon[data-v-edc0d12c],.search-icon-helper-text[data-v-edc0d12c]{color:var(--rh-color-white,#fff)}.search-mobile[data-v-edc0d12c]{margin-bottom:var(--rh-space-2xl,32px)}.search-mobile form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto}.search-box[data-v-edc0d12c]{width:35rem}nav[data-v-edc0d12c]{background-color:#151515;justify-content:space-between;width:100%}a[data-v-edc0d12c],a[data-v-edc0d12c]:visited{color:#fff;display:inline-block;font-size:var(--rh-font-size-body-text-md,1rem)}.skip-link[class][class][data-v-edc0d12c]{font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class][data-v-edc0d12c]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}.visually-hidden[data-v-edc0d12c]{border:1px solid #06c;height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);white-space:nowrap}h3[data-v-edc0d12c]{color:#464646;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-lg,1.125rem)}.language-picker[data-v-edc0d12c]{align-items:center;background-color:#fff;display:flex;flex-direction:column;padding:var(--rh-space-xl,24px);width:100%}.language-picker h3[data-v-edc0d12c]{margin:0;padding:0 1rem 1rem}.language-picker ul[data-v-edc0d12c]{margin:0;padding:0}.language-picker a[data-v-edc0d12c]{color:#06c}.language-picker li[data-v-edc0d12c]{list-style:none}.language-dropdown[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:block!important;position:absolute;right:0;width:100%;z-index:104}.pfe-navigation.pfe-navigation--processed>[slot=secondary-links][data-v-edc0d12c]{height:auto;overflow:visible;visibility:visible;width:auto}.upper-navigation[data-v-edc0d12c]{padding:0 var(--rh-space-2xl,32px)}.upper-nav-container[data-v-edc0d12c]{border-bottom:1px solid #404040;margin:0}.upper-nav-hidden[data-v-edc0d12c]:not(:focus):not(:active){clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.upper-nav-menu[data-v-edc0d12c]{align-items:center;display:flex;justify-content:flex-end;line-height:1.444;list-style:none;margin-bottom:0;margin-top:0;padding-left:0}.upper-nav-menu[data-v-edc0d12c],.upper-nav-menu>li[data-v-edc0d12c]{position:relative}.upper-nav-menu>li:not(:first-child)>a[data-v-edc0d12c]:before,.upper-nav-menu>li:not(:first-child)>button[data-v-edc0d12c]:before{background-color:#404040;content:"";height:40%;left:0;position:absolute;top:30%;width:1px}li[data-v-edc0d12c]{display:list-item;margin:0;padding:0;text-align:-webkit-match-parent}.upper-nav-menu button.upper-nav-links[data-v-edc0d12c]{border:0;border-top:3px solid transparent;cursor:pointer;line-height:1.444}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]{outline-color:#151515}.upper-nav-menu button.upper-nav-links[aria-expanded=true] .upper-nav-arrow[data-v-edc0d12c]{filter:invert(0) sepia(2%) saturate(21%) hue-rotate(257deg) brightness(108%) contrast(100%);transform:rotate(270deg)}.upper-nav-menu button.upper-nav-links[aria-expanded=true][data-v-edc0d12c]:before{display:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]{background-color:var(--pfe-navigation--BackgroundColor,var(--pfe-theme--color--surface--darkest,#151515));border-top:3px solid transparent;color:#fff;display:block;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);outline:none;padding:12px 12px 14px;text-decoration:none}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:hover{border-top-color:#b8bbbe}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within{outline:1px dashed var(--rh-color-white,#fff);outline-offset:-1px}.upper-nav-menu .upper-nav-links[data-v-edc0d12c]:focus-within:before{display:none}.upper-nav-dropdown-container[data-v-edc0d12c]{background:#fff;box-shadow:0 3px 6px rgba(0,0,0,.098);display:none;padding:5px 30px 24px;position:absolute;right:0;top:100%;width:500px;z-index:105}.upper-nav-dropdown-container>ul[data-v-edc0d12c]{-moz-column-count:2;column-count:2;list-style-type:none;padding:0;width:auto}.upper-nav-dropdown-container>ul li[data-v-edc0d12c]{color:#151515;font-family:var(--rh-font-family-heading,"Red Hat Display",Helvetica,Arial,sans-serif);font-size:var(--rh-font-size-body-text-sm,.875rem);list-style-type:none;margin-bottom:0}.upper-nav-dropdown-container>ul li span[data-v-edc0d12c]{font-weight:var(--rh-font-weight-body-text-medium,500)}.upper-nav-dropdown-container>ul ul[data-v-edc0d12c]{padding-left:0;padding-top:9px}.upper-nav-dropdown-container>ul>li[data-v-edc0d12c]{padding-top:19px;-moz-column-break-inside:avoid;break-inside:avoid}.upper-nav-dropdown-container>ul>li>ul>li[data-v-edc0d12c]{line-height:1.45;padding:4px 0}.upper-nav-menu .upper-nav-arrow[data-v-edc0d12c]{display:inline-block;filter:invert(100%) sepia(8%) saturate(7%) hue-rotate(1turn) brightness(100%) contrast(93%);height:18px;margin-left:5px;transform:rotate(90deg);vertical-align:middle;width:8px}#pfe-navigation__secondary-links .show[data-v-edc0d12c],.upper-navigation .show[data-v-edc0d12c]{display:block}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:active,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:focus,.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]:hover{background-color:#fff;color:#151515}.upper-nav-menu .upper-nav-links[aria-expanded=true][data-v-edc0d12c]{background-color:#fff;border-top-color:#b8bbbe;color:#000;position:relative;z-index:1}.upper-nav-dropdown-container>ul a[data-v-edc0d12c]{color:var(--rh-color-accent-base-on-light,#06c);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;text-decoration:none}.pfe-navigation__search[data-v-edc0d12c]{background-color:var(--rh-color-white,#fff)}.pfe-navigation__search form[data-v-edc0d12c]{display:flex;gap:var(--rh-space-md,8px);margin:auto;max-width:992px}pfe-navigation [slot=secondary-links] .buttons[data-v-edc0d12c]{display:flex;flex-wrap:wrap;gap:var(--rh-space-md,8px);margin-top:4px}pfe-navigation [slot=secondary-links] .buttons a[data-v-edc0d12c]{border:1px solid #d2d2d2;border-radius:3px;color:#06c;cursor:pointer;flex-basis:calc(50% - 5px);font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-weight:var(--rh-font-weight-code-regular,400);padding:1em;text-align:center;text-decoration:none}pfe-navigation [slot=secondary-links] .mobile-lang-select[data-v-edc0d12c]{border:1px solid #d2d2d2;border-bottom-color:#3c3f42;cursor:pointer;display:flex;margin:3rem 0;position:relative}pfe-navigation [slot=secondary-links] .mobile-lang-select label[data-v-edc0d12c]{bottom:100%;color:#000;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:14px;font-weight:500;margin-bottom:5px;position:absolute}pfe-navigation [slot=secondary-links] .mobile-lang-select select[data-v-edc0d12c]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:#fff;border-style:none;color:#000;flex-basis:100%;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:16px;line-height:24px;padding:6px 24px 6px 8px}select[data-v-edc0d12c]{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position:98% 50%;background-repeat:no-repeat}#inputLabel[data-v-edc0d12c]{align-items:center;display:flex;position:relative}#inputLabel form[data-v-edc0d12c]{width:100%}.input-box[data-v-edc0d12c]{font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 8px;width:100%}.input-box[data-v-edc0d12c]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-box[data-v-edc0d12c]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}@media(max-width:960px){.search-box[data-v-edc0d12c]{width:28rem}}@media (max-width:768px){.right-navigation[data-v-edc0d12c],.upper-navigation[data-v-edc0d12c]{display:none}}@media (min-width:767px){.pfe-navigation__search form[data-v-edc0d12c]{padding:var(--rh-space-2xl,32px) 0}}</style>
<style>.element-invisible,.sr-only,.visually-hidden{height:1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border:0;white-space:nowrap}@keyframes reveal-nav{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@keyframes reveal-nav-parts{0%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px);opacity:0;visibility:hidden}1%{visibility:visible}99%{max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}to{max-height:9999em;opacity:1;visibility:visible}}@media print{.pfe-navigation__menu,pfe-navigation [slot]{display:none!important}}pfe-navigation{--pfe-broadcasted--text:var(--pfe-theme--color--text,#151515);--pfe-broadcasted--text--muted:var(--pfe-theme--color--text--muted,#6a6e73);--pfe-broadcasted--link:var(--pfe-theme--color--link,#06c);--pfe-broadcasted--link--hover:var(--pfe-theme--color--link--hover,#004080);--pfe-broadcasted--link--focus:var(--pfe-theme--color--link--focus,#004080);--pfe-broadcasted--link--visited:var(--pfe-theme--color--link--visited,#6753ac);--pfe-broadcasted--link-decoration:var(--pfe-theme--link-decoration,none);--pfe-broadcasted--link-decoration--hover:var(--pfe-theme--link-decoration--hover,underline);--pfe-broadcasted--link-decoration--focus:var(--pfe-theme--link-decoration--focus,underline);--pfe-broadcasted--link-decoration--visited:var(--pfe-theme--link-decoration--visited,none)}@supports (display:grid){pfe-navigation{animation:reveal-nav .1618s 4s 1 forwards;max-height:72px;max-height:var(--pfe-navigation__nav-bar--Height,72px)}pfe-navigation>*{animation:reveal-nav-parts .1618s 4s 1 forwards;opacity:0;transition:opacity .1618s ease-in-out;transition:opacity var(--pfe-reveal-duration,.1618s) ease-in-out;visibility:hidden}}pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed>*{animation:none;opacity:1;visibility:visible}pfe-navigation pfe-primary-detail{display:none}pfe-navigation[pfelement]{display:block}pfe-navigation-dropdown{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515)}#pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],#pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],#pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class],pfe-navigation[breakpoint=desktop] .hidden-at-desktop[class][class][class],pfe-navigation[breakpoint=mobile] .hidden-at-mobile[class][class][class],pfe-navigation[breakpoint=tablet] .hidden-at-tablet[class][class][class]{display:none}#pfe-navigation,#pfe-navigation *,pfe-navigation,pfe-navigation *{box-sizing:border-box}#pfe-navigation [pfelement] .pfe-navigation__log-in-link,pfe-navigation [pfelement] .pfe-navigation__log-in-link{display:none}#pfe-navigation,pfe-navigation{align-items:stretch;background:#151515;background:var(--pfe-navigation__nav-bar--Background,#151515);color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;font-family:Red Hat Text,RedHatText,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamily,Red Hat Text,RedHatText,Arial,Helvetica,sans-serif);font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);height:auto;line-height:1.5;margin:0;max-width:9999em;min-height:72px;min-height:var(--pfe-navigation__nav-bar--Height,72px);padding:0 16px;position:relative;z-index:95;z-index:var(--pfe-navigation--ZIndex,var(--pfe-theme--zindex--navigation,95))}@media (min-width:768px){#pfe-navigation,pfe-navigation{flex-wrap:wrap;margin:0;max-width:9999em;padding:0 16px}}@media (min-width:1200px){#pfe-navigation,pfe-navigation{margin:0 auto;padding:0 32px}}#pfe-navigation .pfe-navigation__dropdown,#pfe-navigation pfe-navigation-dropdown,pfe-navigation .pfe-navigation__dropdown,pfe-navigation pfe-navigation-dropdown{display:none}#pfe-navigation>[slot=account],#pfe-navigation>[slot=search],#pfe-navigation>[slot=secondary-links],pfe-navigation>[slot=account],pfe-navigation>[slot=search],pfe-navigation>[slot=secondary-links]{height:0;overflow:hidden;visibility:hidden;width:0}@media (min-width:768px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{align-items:stretch;display:flex;flex-wrap:wrap}}@media (min-width:992px){#pfe-navigation nav.pfe-navigation,pfe-navigation nav.pfe-navigation{flex-wrap:nowrap}}#pfe-navigation .pfe-navigation__logo-wrapper,pfe-navigation .pfe-navigation__logo-wrapper{align-items:center;display:flex;justify-content:flex-start;margin:0;min-width:150px;padding:10px 16px 10px 0}@media (min-width:768px){.pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:auto}}.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu #pfe-navigation .pfe-navigation__logo-wrapper,.pfe-navigation--collapse-secondary-links .pfe-navigation--no-main-menu pfe-navigation .pfe-navigation__logo-wrapper{margin-right:0}#pfe-navigation .pfe-navigation__logo-link,pfe-navigation .pfe-navigation__logo-link{border-radius:3px;display:block;margin-left:-8px;outline:0;padding:6px 8px;position:relative}#pfe-navigation .pfe-navigation__logo-link:focus,pfe-navigation .pfe-navigation__logo-link:focus{outline:0}#pfe-navigation .pfe-navigation__logo-link:focus:after,pfe-navigation .pfe-navigation__logo-link:focus:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:block;height:auto;width:100%}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{height:40px;height:var(--pfe-navigation__logo--height,40px);width:auto}}@media print{#pfe-navigation .pfe-navigation__logo-image,pfe-navigation .pfe-navigation__logo-image{display:none}}#pfe-navigation .pfe-navigation__logo-image:only-child,pfe-navigation .pfe-navigation__logo-image:only-child{display:block}@media (min-width:576px){#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--small{height:32px;height:var(--pfe-navigation__logo--height,32px)}}@media print{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen{display:none!important}}@media screen{#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--print{display:none!important}}#pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print,pfe-navigation .pfe-navigation__logo-image.pfe-navigation__logo-image--screen.pfe-navigation__logo-image--print{display:inline-block!important}#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;justify-content:center;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{display:none!important}}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation .pfe-navigation__fallback-links a,#pfe-navigation .pfe-navigation__log-in-link,#pfe-navigation .pfe-navigation__menu-link,#pfe-navigation .pfe-navigation__secondary-link,pfe-navigation .pfe-navigation__fallback-links a,pfe-navigation .pfe-navigation__log-in-link,pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__secondary-link{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__fallback-links a[class]:focus,#pfe-navigation .pfe-navigation__fallback-links a[class]:hover,#pfe-navigation .pfe-navigation__log-in-link[class]:focus,#pfe-navigation .pfe-navigation__log-in-link[class]:hover,#pfe-navigation .pfe-navigation__menu-link[class]:focus,#pfe-navigation .pfe-navigation__menu-link[class]:hover,#pfe-navigation .pfe-navigation__secondary-link[class]:focus,#pfe-navigation .pfe-navigation__secondary-link[class]:hover,pfe-navigation .pfe-navigation__fallback-links a[class]:focus,pfe-navigation .pfe-navigation__fallback-links a[class]:hover,pfe-navigation .pfe-navigation__log-in-link[class]:focus,pfe-navigation .pfe-navigation__log-in-link[class]:hover,pfe-navigation .pfe-navigation__menu-link[class]:focus,pfe-navigation .pfe-navigation__menu-link[class]:hover,pfe-navigation .pfe-navigation__secondary-link[class]:focus,pfe-navigation .pfe-navigation__secondary-link[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__fallback-links a:hover,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__log-in-link:hover,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__menu-link:hover,#pfe-navigation .pfe-navigation__secondary-link:focus,#pfe-navigation .pfe-navigation__secondary-link:hover,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__fallback-links a:hover,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__log-in-link:hover,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__menu-link:hover,pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link:hover,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:focus,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__fallback-links a:focus,#pfe-navigation .pfe-navigation__log-in-link:focus,#pfe-navigation .pfe-navigation__menu-link:focus,#pfe-navigation .pfe-navigation__secondary-link:focus,pfe-navigation .pfe-navigation__fallback-links a:focus,pfe-navigation .pfe-navigation__log-in-link:focus,pfe-navigation .pfe-navigation__menu-link:focus,pfe-navigation .pfe-navigation__secondary-link:focus{outline:0}#pfe-navigation .pfe-navigation__fallback-links a:focus:after,#pfe-navigation .pfe-navigation__log-in-link:focus:after,#pfe-navigation .pfe-navigation__menu-link:focus:after,#pfe-navigation .pfe-navigation__secondary-link:focus:after,pfe-navigation .pfe-navigation__fallback-links a:focus:after,pfe-navigation .pfe-navigation__log-in-link:focus:after,pfe-navigation .pfe-navigation__menu-link:focus:after,pfe-navigation .pfe-navigation__secondary-link:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{pointer-events:none}#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,#pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__log-in-link>pfe-icon,#pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__menu-link>pfe-icon,#pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation .pfe-navigation__secondary-link>pfe-icon,pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__log-in-link>pfe-icon,pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__menu-link>pfe-icon,pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__secondary-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__fallback-links a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__log-in-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__menu-link>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__secondary-link>pfe-icon{padding:0 16px 0 0}#pfe-navigation .pfe-navigation__fallback-links a pfe-icon,#pfe-navigation .pfe-navigation__log-in-link pfe-icon,#pfe-navigation .pfe-navigation__menu-link pfe-icon,#pfe-navigation .pfe-navigation__secondary-link pfe-icon,pfe-navigation .pfe-navigation__fallback-links a pfe-icon,pfe-navigation .pfe-navigation__log-in-link pfe-icon,pfe-navigation .pfe-navigation__menu-link pfe-icon,pfe-navigation .pfe-navigation__secondary-link pfe-icon{display:block;height:18px}#pfe-navigation .pfe-navigation__fallback-links a[class],#pfe-navigation .pfe-navigation__fallback-links a[href],#pfe-navigation .pfe-navigation__log-in-link[class],#pfe-navigation .pfe-navigation__log-in-link[href],#pfe-navigation .pfe-navigation__menu-link[class],#pfe-navigation .pfe-navigation__menu-link[href],#pfe-navigation .pfe-navigation__secondary-link[class],#pfe-navigation .pfe-navigation__secondary-link[href],pfe-navigation .pfe-navigation__fallback-links a[class],pfe-navigation .pfe-navigation__fallback-links a[href],pfe-navigation .pfe-navigation__log-in-link[class],pfe-navigation .pfe-navigation__log-in-link[href],pfe-navigation .pfe-navigation__menu-link[class],pfe-navigation .pfe-navigation__menu-link[href],pfe-navigation .pfe-navigation__secondary-link[class],pfe-navigation .pfe-navigation__secondary-link[href]{align-items:center;justify-content:center}#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%;--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none!important}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation [slot=account]>a[href]:focus,#pfe-navigation [slot=account]>a[href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation [slot=account]>a[href]:focus,pfe-navigation [slot=account]>a[href]:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation [slot=account]>a[href]:focus,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation [slot=account]>a[href]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle:focus:after,#pfe-navigation [slot=account]>a[href]:focus:after,pfe-navigation .pfe-navigation__account-toggle:focus:after,pfe-navigation [slot=account]>a[href]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{pointer-events:none}@supports (display:grid){#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation .pfe-navigation__account-toggle[class]:focus,#pfe-navigation .pfe-navigation__account-toggle[class]:hover,#pfe-navigation [slot=account]>a[href][class]:focus,#pfe-navigation [slot=account]>a[href][class]:hover,pfe-navigation .pfe-navigation__account-toggle[class]:focus,pfe-navigation .pfe-navigation__account-toggle[class]:hover,pfe-navigation [slot=account]>a[href][class]:focus,pfe-navigation [slot=account]>a[href][class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media print{#pfe-navigation .pfe-navigation__account-toggle,#pfe-navigation [slot=account]>a[href],pfe-navigation .pfe-navigation__account-toggle,pfe-navigation [slot=account]>a[href]{display:none}}#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{--pfe-icon--size:18px;padding:2px 0 4px}@media (min-width:768px){#pfe-navigation .pfe-navigation__account-toggle pfe-icon,#pfe-navigation [slot=account]>a[href] pfe-icon,pfe-navigation .pfe-navigation__account-toggle pfe-icon,pfe-navigation [slot=account]>a[href] pfe-icon{padding-right:0}}#pfe-navigation .pfe-navigation__account-toggle:focus,#pfe-navigation .pfe-navigation__account-toggle:hover,#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],#pfe-navigation [slot=account]>a[href][href]:focus,#pfe-navigation [slot=account]>a[href][href]:hover,pfe-navigation .pfe-navigation__account-toggle:focus,pfe-navigation .pfe-navigation__account-toggle:hover,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation [slot=account]>a[href][href]:focus,pfe-navigation [slot=account]>a[href][href]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true],pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus{outline:0}#pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after,pfe-navigation .pfe-navigation__account-toggle[aria-expanded=true]:focus:after{border:1px dashed #151515;border:1px dashed var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{font-size:inherit;list-style:none;margin:0;padding:0}@media (min-width:768px){#pfe-navigation .pfe-navigation__fallback-links,#pfe-navigation .pfe-navigation__menu,pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__menu{align-items:stretch;display:flex}}#pfe-navigation .pfe-navigation__fallback-links li,#pfe-navigation .pfe-navigation__menu li,pfe-navigation .pfe-navigation__fallback-links li,pfe-navigation .pfe-navigation__menu li{font-size:inherit;margin:0;padding:0}#pfe-navigation .pfe-navigation__fallback-links li:before,#pfe-navigation .pfe-navigation__menu li:before,pfe-navigation .pfe-navigation__fallback-links li:before,pfe-navigation .pfe-navigation__menu li:before{content:none}#pfe-navigation .pfe-navigation__fallback-links,pfe-navigation .pfe-navigation__fallback-links{margin-left:auto}#pfe-navigation .pfe-navigation__menu-link,pfe-navigation .pfe-navigation__menu-link{display:flex;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);white-space:nowrap}#pfe-navigation.pfe-navigation--processed,pfe-navigation.pfe-navigation--processed{display:block;padding:0}#pfe-navigation.pfe-navigation--processed:before,pfe-navigation.pfe-navigation--processed:before{content:none}#pfe-navigation.pfe-navigation--processed>[slot=account],#pfe-navigation.pfe-navigation--processed>[slot=search],#pfe-navigation.pfe-navigation--processed>[slot=secondary-links],pfe-navigation.pfe-navigation--processed>[slot=account],pfe-navigation.pfe-navigation--processed>[slot=search],pfe-navigation.pfe-navigation--processed>[slot=secondary-links]{height:auto;overflow:visible;visibility:visible;width:auto}#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,#pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,#pfe-navigation.pfe-navigation--processed>[slot],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed>[slot]{animation:none;opacity:1}#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{display:block;height:auto;list-style:none;margin:0 0 8px;padding:0;width:auto}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links],pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]{margin:0 0 8px}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));align-items:center;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:0 0;border:0;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;display:flex;font-family:inherit;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);justify-content:flex-start;margin:0;outline:0;padding:8px 24px;position:relative;text-align:center;text-decoration:none;white-space:nowrap;width:100%}@media print{#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{display:none!important}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));color:#fff;color:var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));display:flex;flex-direction:column;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);height:72px;height:var(--pfe-navigation__nav-bar--Height,72px);justify-content:flex-end;padding:14px 8px;width:auto}@supports (display:grid){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button{align-items:center;display:grid;grid-template-rows:26px 18px;justify-items:center}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[class]:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[class]:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 0 4px 0 0 #06c;box-shadow:inset 0 4px 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:hover,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:hover{box-shadow:inset 4px 0 0 0 #06c;box-shadow:inset 4px 0 0 0 var(--pfe-navigation__nav-bar--highlight-color,var(--pfe-theme--color--ui-accent,#06c))}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{pointer-events:none}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{--pfe-icon--size:18px;padding-right:5px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding-right:0;padding:2px 0 4px}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a>pfe-icon,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button .secondary-link__icon-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button>pfe-icon{padding:0 16px 0 0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button pfe-icon{display:block;height:18px}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{outline:0}#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus:after,pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus:after{border:1px dashed #fff;border:1px dashed var(--pfe-navigation__nav-bar--Color--default,var(--pfe-theme--color--ui-base--text,#fff));bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a:focus,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button:focus{box-shadow:none}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],#pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>a[aria-expanded=true],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links]>button[aria-expanded=true]{background:0 0;box-shadow:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper--single-column{position:relative}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown__wrapper{display:block}#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{height:0;transition:height .25s ease-in-out;transition:var(--pfe-navigation--accordion-transition,height .25s ease-in-out)}@media (prefers-reduced-motion){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{transition:none}}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:absolute;right:0;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class]{position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:auto}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed [slot=secondary-links] .pfe-navigation__dropdown-wrapper[class][aria-hidden=false]{height:0}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper{left:100vw;left:calc(100vw - 32px);left:calc(100vw - var(--pfe-navigation__mobile-dropdown--PaddingHorizontal,32px));position:absolute;top:0;width:100vw}#pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false],pfe-navigation.pfe-navigation--processed[breakpoint=mobile] [slot=secondary-links][mobile-slider] .pfe-navigation__dropdown-wrapper[aria-hidden=false]{height:100vh;height:calc(100vh - 72px);height:calc(100vh - var(--pfe-navigation__nav-bar--Height,72px));overflow-y:scroll}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 64px24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px) var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown-wrapper{padding:0 24px;padding:0 var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a{border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));display:inline-block}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6{margin:32px 0 .75em;margin:var(--pfe-navigation--gutter,32px) 0 .75em;padding:0;-moz-column-break-inside:avoid;break-inside:avoid;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);font-family:Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif;font-family:var(--pfe-navigation--FontFamilyHeadline,Red Hat Display,RedHatDisplay,Arial,Helvetica,sans-serif);font-size:1.125rem;font-size:var(--pf-global--FontSize--lg,1.125rem);font-weight:500}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level]:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5:first-child,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6:first-child{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a{border:1px solid transparent;color:#464646;color:var(--pfe-navigation__dropdown--headings--Color,#464646);text-decoration:underline}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:hover{color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);text-decoration:none}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container h6 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles .pfe-link-list--header a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles [role=heading][aria-heading-level] a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h2 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h3 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h4 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h5 a:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles h6 a:focus{border:1px dashed;outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li{margin:0 0 16px;-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container a,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles a,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-card,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{-moz-column-break-inside:avoid;break-inside:avoid}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--BackgroundColor,#e00);--pfe-cta--BackgroundColor--hover:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00);--pfe-theme--ui--border-width:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta[priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[pfe-priority=primary]:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta[priority=primary]:hover{--pfe-cta--BackgroundColor:var(--pfe-navigation__dropdown--pfe-cta--hover--BackgroundColor,#c00)}pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container pfe-cta,pfe-card pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles pfe-cta{margin-top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,#pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container li,pfe-navigation.pfe-navigation--processed .pfe-navigation-item__tray--container ul,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles li,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--default-styles ul{list-style:none;margin:0;padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{color:#151515;color:var(--pfe-navigation__dropdown--Color,#151515);-moz-column-count:auto;column-count:auto;display:block;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);gap:0;margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:flex;flex-wrap:wrap;padding-bottom:32px;padding-top:32px}@supports (display:grid){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{display:grid;gap:32px;gap:var(--pfe-navigation--gutter,32px);grid-auto-flow:row;grid-template-columns:repeat(4,minmax(0,1fr))}}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:3;column-count:3;display:block;gap:32px;gap:var(--pfe-navigation--gutter,32px);padding-bottom:12px;padding-top:12px}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{-moz-column-count:auto;column-count:auto;display:block;gap:0;margin-left:-16px;margin-right:-16px;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding-bottom:12px;padding-top:12px;width:calc(100% + 32px)}.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,.pfe-navigation__menu-item--open pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles{transition-delay:0s;visibility:visible}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px;-moz-column-break-inside:avoid;break-inside:avoid}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation-grid>*,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--default-styles>*{margin:0 0 18px}#pfe-navigation.pfe-navigation--processed .pfe-navigation-grid,pfe-navigation.pfe-navigation--processed .pfe-navigation-grid{max-width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown--1-x{display:block}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown{background:#fff}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{margin-left:auto;margin-right:auto;max-width:1136px;max-width:var(--pfe-navigation--content-max-width,1136px);padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}@media (min-width:1200px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:32px 64px;padding:32px var(--pfe-navigation__dropdown--full-width--spacing--desktop,64px)}}.pfe-navigation--collapse-main-menu #pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher,.pfe-navigation--collapse-main-menu pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher{padding:12px 24px;padding:12px var(--pfe-navigation__dropdown--full-width--spacing--mobile,24px)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container,pfe-navigation.pfe-navigation--processed .pfe-navigation__site-switcher .pfe-navigation__dropdown site-switcher .container{margin:0;padding:0;width:auto}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible[class]{padding:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__dropdown-wrapper--invisible pfe-navigation-dropdown{visibility:hidden}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{padding:0}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:0 1px 2px rgba(0,0,0,.12);box-shadow:var(--pfe-navigation__dropdown--BoxShadow,0 1px 2px rgba(0,0,0,.12));max-width:100%;min-width:13em;padding:0 32px;position:absolute;top:100%}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{box-shadow:none;max-width:100%;position:static}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--single-column[class]{right:0}}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{width:100%}@media (min-width:768px){#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{left:0;position:absolute;right:0}}.pfe-navigation--collapse-secondary-links #pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class],.pfe-navigation--collapse-secondary-links pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class]{position:static}#pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--processed .pfe-navigation__custom-dropdown--full[class] .pfe-navigation__dropdown{width:100%}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles{padding-left:16px;padding-right:16px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles form{align-items:center;display:flex}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{padding:10px;transition:box-shadow .2s}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input{border:1px solid #f0f0f0;border-bottom-color:#8b8e91;color:#717579;flex-basis:0%;flex-grow:1;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);margin-right:8px}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::-moz-placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input::placeholder{color:#717579}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button{background-color:#e00;border:1px solid #e00;border-radius:2px;color:#fff;flex-basis:auto;flex-grow:0;flex-shrink:1;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem)}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles input:hover:after{border:1px dashed #000;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover{outline:0}#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,#pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:focus:after,pfe-navigation.pfe-navigation--processed .pfe-navigation__search--default-styles button:hover:after{border:1px dashed #fff;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{border-bottom:1px solid #d2d2d2;border-bottom:var(--pfe-navigation__dropdown--separator--Border,1px solid var(--pfe-theme--color--ui--border--lighter,#d2d2d2));display:block}@media (min-width:768px){#pfe-navigation .pfe-navigation__site-switcher__back-wrapper,pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:none}}.pfe-navigation--collapse-secondary-links #pfe-navigation .pfe-navigation__site-switcher__back-wrapper,.pfe-navigation--collapse-secondary-links pfe-navigation .pfe-navigation__site-switcher__back-wrapper{display:block}#pfe-navigation .pfe-navigation__site-switcher__back-button,pfe-navigation .pfe-navigation__site-switcher__back-button{background-color:transparent;border:1px solid transparent;color:#06c;color:var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));cursor:pointer;font-size:1rem;font-size:var(--pf-global--FontSize--md,1rem);padding:21px 21px 21px 45px;position:relative;text-align:left;width:100%}#pfe-navigation .pfe-navigation__site-switcher__back-button:before,pfe-navigation .pfe-navigation__site-switcher__back-button:before{border:2px solid #06c;border:2px solid var(--pfe-navigation__dropdown--link--Color,var(--pfe-theme--color--link,#06c));border-right:0;border-top:0;content:"";display:block;height:8px;left:35px;position:absolute;right:auto;top:27px;transform:rotate(45deg);transform-origin:left top;width:8px}#pfe-navigation .pfe-navigation__site-switcher__back-button:focus,#pfe-navigation .pfe-navigation__site-switcher__back-button:hover,pfe-navigation .pfe-navigation__site-switcher__back-button:focus,pfe-navigation .pfe-navigation__site-switcher__back-button:hover{border:1px dashed #151515;border-top:1px dashed #151515;border:1px dashed var(--pfe-navigation__dropdown--Color,#151515);color:#036;color:var(--pfe-navigation__dropdown--link--Color--hover,#036);outline:0}#pfe-navigation.pfe-navigation--processed site-switcher,pfe-navigation.pfe-navigation--processed site-switcher{-moz-columns:auto;columns:auto;display:block}#pfe-navigation.pfe-navigation--stuck,pfe-navigation.pfe-navigation--stuck{left:0;position:fixed;top:0;width:100%;z-index:95;z-index:var(--pfe-theme--zindex--navigation,95)}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__outer-menu-wrapper__inner{opacity:1!important}#pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser rh-account-dropdown{display:none!important}#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,#pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] pfe-navigation-account,pfe-navigation.pfe-navigation--in-crusty-browser[open-toggle=pfe-navigation__account-toggle] rh-account-dropdown{display:block!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-item{display:block}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]{--pfe-icon--color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515));background:#fff;background:var(--pfe-navigation__nav-bar--toggle--BackgroundColor--active,var(--pfe-theme--color--surface--lightest,#fff));color:#151515;color:var(--pfe-navigation__nav-bar--Color--active,var(--pfe-theme--color--text,#151515))}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus{outline:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__menu-link[aria-expanded=true]:focus:after{border:1px dashed;bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown{display:flex;flex-wrap:wrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown>.style-scope{flex-basis:25%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope{flex-basis:100%}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown .pfe-navigation__footer.style-scope>.style-scope{margin-right:16px}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column ul,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{display:flex;flex-direction:column;flex-wrap:nowrap}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__dropdown--single-column>.style-scope{flex-basis:auto}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a{color:#fff!important;justify-content:center!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link[aria-expanded=true],pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a[aria-expanded=true]{color:#151515!important}#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,#pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__account-wrapper--logged-in .pfe-navigation__log-in-link,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__search-toggle pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser .pfe-navigation__secondary-link pfe-icon,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a .secondary-link__icon-wrapper,pfe-navigation.pfe-navigation--in-crusty-browser [slot=secondary-links]>a pfe-icon{display:none!important}[id=pfe-navigation__account-dropdown][class][class]{display:block;height:auto;left:0;padding:0;position:absolute;top:72px;top:var(--pfe-navigation__nav-bar--Height,72px);width:100%}[id=pfe-navigation__account-dropdown].pfe-navigation__dropdown-wrapper--invisible[class]{display:none}.pfe-navigation__dropdown-wrapper{overflow:hidden}@media (min-width:768px){.pfe-navigation__custom-dropdown--single-column{min-width:25em}}.pfe-navigation--collapse-secondary-links .pfe-navigation__custom-dropdown--single-column{min-width:0}.secondary-link__icon-wrapper{align-items:center;display:flex;justify-content:center}.secondary-link__alert-count{background:#06c;background:var(--pfe-navigation__nav-bar--alert-color,var(--pfe-theme--color--link,#06c));border-radius:20px;color:#fff;color:var(--pfe-navigation__nav-bar--Color--on-highlight,var(--pfe-theme--color--text--on-saturated,#fff));display:block;font-size:12px;font-size:var(--pfe-navigation--FontSize--xs,12px);line-height:20px;margin:0 4px 0 2px;min-width:23px;overflow:hidden;padding:0 8px}.secondary-link__alert-count:empty{display:none}#pfe-navigation__1x-skip-links{left:0;position:absolute;top:0}#pfe-navigation__1x-skip-links,#pfe-navigation__1x-skip-links li{height:0;list-style:none;margin:0;padding:0;width:0}.skip-link[class][class]{font-size:.875rem;font-size:var(--pf-global--FontSize--sm,.875rem);line-height:18px}.skip-link[class][class]:focus{border-radius:.21429em;height:auto;left:50%;padding:.42857em .57143em;position:fixed;top:8px;transform:translateX(-50%);width:auto;z-index:99999;clip:auto;background:#fff;background:var(--pfe-navigation__skip-link--BackgroundColor,var(--pfe-theme--color--surface--lightest,#fff));color:#06c;color:var(--pfe-navigation__skip-link--Color,var(--pfe-theme--color--link,#06c));text-decoration:none}pfe-navigation pfe-navigation-account[slot=account]{background:#fff;background:var(--pfe-navigation__dropdown--Background,var(--pfe-theme--color--surface--lightest,#fff));width:100%}</style>
<style>:host([size=sm]) #container[data-v-8589d091]{--_size:var(--pf-global--icon--FontSize--sm,12px)}.content-wrapper[data-v-8589d091]{height:auto;margin:0 auto;min-height:46vh}.content[data-v-8589d091]{max-width:1000px}#left-content[data-v-8589d091]{max-width:330px;z-index:1}.line-below-chp[data-v-8589d091]{margin:var(--rh-space-xl,24px) 0 var(--rh-space-3xl,48px)}.toc-container[data-v-8589d091]{border-right:1px solid var(--rh-color-gray-30,#c7c7c7);min-height:100vh;position:sticky;top:0;transition:transform .3s ease-in-out}nav#toc[data-v-8589d091]{height:auto;overflow-y:auto;padding-bottom:var(--rh-space-2xl,32px)}.max-height-85[data-v-8589d091]{max-height:85vh}.max-height-75[data-v-8589d091]{max-height:75vh}.toc-filter[data-v-8589d091]{background-color:#fff;padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px);position:sticky;top:-1px;width:100%;z-index:1}#text[data-v-8589d091],.toc-filter[data-v-8589d091]{align-items:center;display:flex}#text[data-v-8589d091]{flex:1;flex-direction:row}#search-icon[data-v-8589d091]{color:#151515;left:2.5rem;position:absolute;top:55%;transform:translateY(-50%)}pf-icon[data-v-8589d091]{--pf-icon--size:16px}#text:focus-within #icon[data-v-8589d091],#text:hover #icon[data-v-8589d091]{color:#151515}#text[data-v-8589d091]:after,#text[data-v-8589d091]:before{content:"";inset:0;pointer-events:none;position:absolute}#text-input[data-v-8589d091]:focus,#text-input:focus+#utilities[data-v-8589d091]{border-bottom:2px solid #06c;outline:none}#text-input[data-v-8589d091]{background-color:transparent;border:1px solid #f0f0f0;border-bottom-color:#8a8d90;color:#151515;font-family:inherit;font-size:100%;grid-area:text-input;line-height:1.5;overflow:hidden;padding:.375rem .25rem .375rem 2rem;position:relative;text-overflow:ellipsis;white-space:nowrap;width:100%}#utilities[data-v-8589d091]{align-items:center;border:1px solid #f0f0f0;border-bottom:1px solid #8a8d90;border-left:0;display:flex}#utilities rh-badge[data-v-8589d091]{border-radius:80px;font-weight:var(--rh-font-weight-heading-medium,500);--_background-color:#e0e0e0;margin-right:8px}#clear-button[data-v-8589d091]{--pf-c-button--PaddingTop:0.625rem;--pf-c-button--PaddingRight:.25rem;--pf-c-button--PaddingBottom:0.625rem;--pf-c-button--PaddingLeft:.25rem;margin-right:8px}#text-input.no-right-border[data-v-8589d091]{border-right:0}.btn-container[data-v-8589d091]{bottom:0;display:flex;justify-content:flex-end;padding:1rem;pointer-events:none;position:fixed;right:0;z-index:2}.top-scroll-btn[data-v-8589d091]{--pf-c-button--BorderRadius:64px;pointer-events:all}.focusable[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-interactive-blue,#06c)}.mobile-nav-wrapper[data-v-8589d091]{align-items:center;border-bottom:1px solid #c7c7c7;display:flex;height:auto;justify-content:space-between;padding:var(--rh-space-sm,.5rem)}.mobile-nav[data-v-8589d091]{align-items:center;background-color:var(--rh-color-bg-page,#fff);min-height:51px;position:sticky;top:0;z-index:5}.active-mobile-menu[data-v-8589d091]{color:#151515;padding-left:.5rem}.hidden[data-v-8589d091]{display:none}.mobile-nav-btn[data-v-8589d091]{background-color:transparent;border:none;font-family:inherit;font-size:.875rem;font-weight:500;margin:0;min-height:40px;min-width:40px}.border-right[data-v-8589d091]{border-right:1px solid #c7c7c7}.toc-focus-container[data-v-8589d091]{position:sticky;top:0;z-index:2}.toc-focus-btn[data-v-8589d091]{align-items:center;background-color:var(--rh-color-white,#fff);border:1px solid var(--rh-color-blue-50,#06c);border-radius:50%;cursor:pointer;display:flex;height:40px;justify-content:center;position:absolute;right:-20px;top:15px;width:40px}.toc-focus-btn[data-v-8589d091]:focus-visible,.toc-focus-btn[data-v-8589d091]:hover{background-color:var(--rh-color-blue-10,#e0f0ff);box-shadow:var(--rh-box-shadow-sm,0 2px 4px 0 hsla(0,0%,8%,.2))}.toc-focus-btn[data-v-8589d091]:focus-visible{border:2px solid var(--rh-color-blue-50,#06c)}.toc-focus-btn-icon[data-v-8589d091]{color:var(--rh-color-blue-50,#06c)}.toc-wrapper[data-v-8589d091]{padding:0}.product-container[data-v-8589d091]{border-bottom:1px solid var(--rh-color-gray-30,#c7c7c7);padding:var(--rh-space-xl,24px) var(--rh-space-2xl,32px)}.product-container h1.product-title[data-v-8589d091]{font-size:var(--rh-font-size-code-xl,1.25rem);line-height:30px;margin-bottom:0;margin-top:0}.product-container .product-version[data-v-8589d091]{align-items:center;display:flex;flex-wrap:wrap;margin-top:var(--rh-space-lg,16px)}.product-version .version-label[data-v-8589d091]{color:var(--rh-color-canvas-black,#151515);font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:500}.product-version .version-select-dropdown[data-v-8589d091]{margin:var(--rh-space-md,8px) var(--rh-space-sm,6px);max-width:9.75rem;min-height:2rem;min-width:3rem;overflow:hidden;width:-moz-min-content;width:min-content;word-wrap:nowrap;-webkit-appearance:none;-moz-appearance:none;background:var(--rh-color-white,#fff);background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' fill='none' viewBox='0 0 10 6'%3E%3Cpath fill='%23151515' d='M.678 0h8.644c.596 0 .895.797.497 1.195l-4.372 4.58c-.298.3-.695.3-.993 0L.18 1.196C-.216.797.081 0 .678 0'/%3E%3C/svg%3E");background-position-x:85%;background-position-y:50%;background-repeat:no-repeat;border:1px solid var(--rh-color-gray-30,#c7c7c7);border-bottom:0;box-shadow:0 -1px 0 0 var(--rh-color-gray-60,#4d4d4d) inset;cursor:pointer;font-size:var(--rh-font-size-body-text-md,1rem);padding:var(--rh-space-md,8px);padding-right:24px;text-overflow:ellipsis}pf-popover[data-v-8589d091]{margin-top:var(--rh-space-md,8px);--pf-c-popover__arrow--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover__content--BackgroundColor:var(--rh-color-canvas-black,#151515);--pf-c-popover--BoxShadow:0px 4px 8px 0px #15151540;--pf-c-popover__title-text--Color:var(--rh-color-white,#fff);--pf-c-popover--MaxWidth:300px;--pf-c-popover--MinWidth:300px;--pf-c-popover--c-button--Top:20px;--pf-c-popover--c-button--Right:4px;--pf-c-button--m-plain--hover--Color:var(--rh-color-white,#fff)}pf-popover[data-v-8589d091]::part(content){padding:var(--rh-space-2xl,32px)}pf-popover[data-v-8589d091]::part(body){margin-top:var(--rh-space-lg,16px)}pf-popover[data-v-8589d091]::part(close-button){--pf-c-button--m-plain--focus--Color:var(--rh-color-gray-30,#c7c7c7);--pf-c-button--m-plain--Color:var(--rh-color-gray-30,#c7c7c7)}.popover-header-text[data-v-8589d091]{color:var(--rh-color-white,#fff);font-size:var(--rh-font-size-code-md,1rem);margin:0;max-width:80%;padding:0}.popover-body-link[data-v-8589d091]{color:var(--rh-color-blue-30,#92c5f9);text-decoration:none}.popover-trigger-btn[data-v-8589d091]{align-items:center;background:none;border:none;cursor:pointer;display:flex;justify-content:center}#first-button[data-v-8589d091]{width:80%}#second-button[data-v-8589d091]{text-align:right;width:20%}#toc-btn[data-v-8589d091]{text-align:left;width:100%}.toc-error[data-v-8589d091]{margin:0;max-width:100%}#layout label[data-v-8589d091]{font-weight:500}.page-layout-options[data-v-8589d091]{background-color:#fff;display:flex;flex-direction:column;padding-bottom:var(--rh-space-lg,16px)}.sticky-top[data-v-8589d091]{position:sticky;top:0}summary[data-v-8589d091]{cursor:pointer;list-style:none;position:relative}summary[data-v-8589d091]::-webkit-details-marker{display:none}details#jump-links-details .jump-links-heading[data-v-8589d091]{background-color:var(--rh-color-white,#fff);display:block;margin-top:var(--rh-space-lg,16px);padding:var(--rh-space-lg,16px) 0 0 var(--rh-space-xl,24px);position:sticky;top:0}details#jump-links-details .jump-links-heading[data-v-8589d091]:before{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;height:9px;left:2px;position:absolute;top:26px;transform:rotate(-135deg);width:9px}details#jump-links-details[open] .jump-links-heading[data-v-8589d091]:before{transform:rotate(135deg)}.table-of-contents>ol[data-v-8589d091]{list-style:none;margin:0;padding:0}nav.table-of-contents[data-v-8589d091]{z-index:1}nav.table-of-contents ol[data-v-8589d091]{list-style:none;margin:0;padding:0}#mobile-browse-docs[data-v-8589d091]{font-weight:var(--rh-font-weight-body-text-medium,500);padding-left:var(--rh-space-2xl,32px)}.docs-content-container[data-v-8589d091]{font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:1.6667;padding-left:6rem;padding-right:6rem;padding-top:var(--rh-space-3xl,4rem)}.chapter-title[data-v-8589d091]{font-family:Red Hat Display}h1.chapter-title[data-v-8589d091]{font-size:var(--rh-fontsize-heading-xl,2.25rem);line-height:46.8px;margin:0;padding:0}.chapter .section h4[data-v-8589d091]{font-size:24px;font-weight:400}.banner-wrapper[data-v-8589d091]{padding:3rem 6rem 0}.page-format-dropdown[data-v-8589d091]{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:#fff;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABtSURBVHgBhc4xCoAwDAXQxE6li0K76w0cPZqjHsEb6AlcHb2BR9ADdG7GmIKTWv0QSOAFPjrndgAo4TtHxszTD4JoVAhh1VoXiNgkUO+971Q8iGgxxlSy1jc3CGof39baWTrzNSOkkksEbG/oBGEJIn6gD3jAAAAAAElFTkSuQmCC");background-position:8.5rem;background-repeat:no-repeat;background-size:auto;border:1px solid #c7c7c7;box-shadow:inset 0 -1px 0 0 #4d4d4d;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-md,1rem);margin-top:var(--rh-space-xs,4px);max-width:168px;min-height:36px;min-width:168px;overflow:hidden;padding:0 var(--rh-space-xl,24px) 0 var(--rh-space-md,8px);text-overflow:ellipsis;white-space:nowrap}.content-format-selectors[data-v-8589d091]{color:#151515;font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-sm,.875rem);font-weight:var(--rh-font-weight-body-text-medium,500);margin-right:var(--rh-space-2xl,32px);max-width:250px;min-width:250px;padding-top:var(--rh-space-2xl,32px)}.chapter .section .simpara[data-v-8589d091],.chapter .section p[data-v-8589d091]{font-family:Red Hat Text;font-size:var(--rh-font-size-body-text-lg,1.125rem);font-weight:var(--rh-font-weight-body-text-regular,400);line-height:30px}#toggle-focus-mode[data-v-8589d091]{padding-right:var(--rh-space-lg,1rem)}@keyframes slideaway-left-8589d091{0%{display:block}to{opacity:0;transform:translateX(-40px)}}@keyframes slideaway-right-8589d091{0%{display:block}to{opacity:0;transform:translateX(40px)}}@keyframes enter-left-8589d091{0%{display:none;transform:translateX(-40px)}to{opacity:1}}@keyframes enter-right-8589d091{0%{display:none;transform:translateX(40px)}to{opacity:1}}.hide-left[data-v-8589d091]{animation:slideaway-left-8589d091 .2s;display:none}.enter-left[data-v-8589d091]{animation:enter-left-8589d091 .3s;border-right:none;display:block}.enter-right[data-v-8589d091]{animation:enter-right-8589d091 .3s;display:block}.hide-right[data-v-8589d091]{animation:slideaway-right-8589d091 .2s;display:none}.toc-container.enter-toc-container-left[data-v-8589d091]{transform:translateX(-85%)}.alert-section[data-v-8589d091]{padding-bottom:3rem}rh-alert[data-v-8589d091]{width:auto}@media (min-width:992px){#mobile-nav[data-v-8589d091],#toc-list-mobile[data-v-8589d091]{display:none}}@media (min-width:992px) and (max-width:1400px){.docs-ocp-content-container[data-v-8589d091]{padding:var(--rh-space-4xl,64px) var(--rh-space-lg,16px) 0}}@media (width < 992px){#breadcrumbs[data-v-8589d091],.content-format-selectors[data-v-8589d091],.toc-container[data-v-8589d091]{display:none}#mobile-nav-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7}#toc-wrapper-mobile[data-v-8589d091]{padding:var(--rh-space-md,1.5rem)}.product-container[data-v-8589d091]{padding:var(--rh-space-2xl,32px) var(--rh-space-lg,16px)}.product-container.shrink-product-padding[data-v-8589d091]{padding:var(--rh-space-lg,16px)}.product-version .version-select-dropdown[data-v-8589d091]{margin:0 var(--rh-space-lg,16px)}#page-content-options-mobile[data-v-8589d091]{padding:var(--rh-space-lg,2rem)}label[for=page-format][data-v-8589d091],label[for=toggle-focus-mode][data-v-8589d091]{display:block}.page-format-dropdown[data-v-8589d091]{background-position:97%;max-width:100%}nav#mobile-toc-menu[data-v-8589d091]{max-height:50vh;overflow-y:scroll}.mobile-jump-links #first-button[data-v-8589d091]{width:100%}#jump-links-btn[data-v-8589d091]{text-align:left;width:100%}#mobile-jump-links-content-wrapper[data-v-8589d091]{border-bottom:1px solid #c7c7c7;border-top:1px solid #c7c7c7;padding:0 var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}.table-of-contents #browse-docs[data-v-8589d091]{margin-top:1rem;padding-top:var(--rh-space-md,1.5rem)}.mobile-nav[data-v-8589d091]{display:block}.hide-mobile-nav[data-v-8589d091],.mobile-nav[data-v-8589d091]{transition:transform .3s ease-in-out}.hide-mobile-nav[data-v-8589d091]{transform:translateY(-100%)}.docs-content-container[data-v-8589d091]{padding-left:1.25rem;padding-right:1.25rem;padding-top:var(--rh-space-xl,24px)}.banner-wrapper[data-v-8589d091]{padding:0 1rem}.toc-filter-mobile[data-v-8589d091]{align-items:center;display:flex;padding:var(--rh-space-lg,16px);width:100%}#text-input[data-v-8589d091]{padding-left:.5rem}.toc-filter[data-v-8589d091]{display:none}}@media (width <=576px){.content-format-selectors[data-v-8589d091]{display:none}}.informaltable[data-v-8589d091],.rhdocs .informaltable[data-v-8589d091],.rhdocs .table-contents[data-v-8589d091],.rhdocs .table-wrapper[data-v-8589d091],.table-contents[data-v-8589d091],.table-wrapper[data-v-8589d091]{max-height:var(--rh-table--maxHeight);overflow:auto}rh-table[data-v-8589d091]{display:block;margin:2rem 0;max-width:100%}.pvof-doc__wrapper[data-v-8589d091],.rhdocs[data-v-8589d091]{--rh-table--maxHeight:calc(100vh - 12.5rem)}</style>
<style>:is(rh-footer-block) a[data-v-97dd2752]{text-decoration:underline}</style>
<style>:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a{color:var(--rh-color-link-inline-on-dark,var(--rh-color-interactive-blue-lighter,#92c5f9));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:hover{color:var(--rh-color-link-inline-hover-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:is(:focus,:focus-within){color:var(--rh-color-link-inline-focus-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:underline}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a:visited{color:var(--rh-color-link-inline-visited-on-dark,var(--rh-color-interactive-blue-lightest,#b9dafc));text-decoration:none}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) a[slot^=logo]{display:block}:is(rh-footer) a[slot^=logo]>img{display:block;height:100%;height:var(--rh-size-icon-04,40px);width:auto}:is(rh-footer,rh-footer-universal,rh-global-footer) :is(h1,h2,h3,h4,h5,h6){font-family:var(--rh-font-family-heading,RedHatDisplay,"Red Hat Display","Noto Sans Arabic","Noto Sans Hebrew","Noto Sans JP","Noto Sans KR","Noto Sans Malayalam","Noto Sans SC","Noto Sans TC","Noto Sans Thai",Helvetica,Arial,sans-serif);line-height:var(--rh-line-height-heading,1.3)}rh-footer [slot=links]:is(h1,h2,h3,h4,h5):nth-of-type(n+5){--_link-header-margin:calc(var(--rh-space-2xl, 32px) - var(--rh-space-lg, 16px))}rh-footer [slot^=links] a{gap:var(--rh-footer-links-gap,var(--rh-space-md,8px))}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] li{display:contents;margin:0;padding:0}:is(rh-footer,:is(rh-footer-universal,rh-global-footer)) [slot^=links] a{color:var(--rh-color-text-primary-on-dark,#fff)!important;display:block;font-size:var(--rh-footer-link-font-size,var(--rh-font-size-body-text-sm,.875rem));width:-moz-fit-content;width:fit-content}:is(rh-footer-universal,rh-global-footer) [slot^=links] a{font-size:inherit}:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-lg,16px)}@media screen and (min-width:768px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-2xl,32px)}}@media screen and (min-width:1440px){:is(rh-footer,rh-footer-universal,rh-global-footer){--rh-footer-section-side-gap:var(--rh-space-4xl,64px)}}rh-footer:not(:defined){background-color:var(--rh-color-surface-darker,#1f1f1f);display:grid;grid-template-areas:"footer" "global";grid-template-rows:1fr auto;min-height:var(--rh-footer-nojs-min-height,750px);width:100%}:is(rh-footer-universal,rh-global-footer):not(:defined):before{grid-area:global}rh-footer:not(:defined)>[slot=logo]{padding:var(--rh-space-2xl,32px) var(--_section-side-gap)}:is(rh-footer-universal,rh-global-footer):not(:defined)>*,rh-footer:not(:defined)>:not([slot=logo],:is(rh-footer-universal,rh-global-footer)){border:0;clip:rect(1px,1px,1px,1px);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}:is(rh-footer-universal,rh-global-footer):not(:defined){background-color:var(--rh-color-surface-darkest,#151515);display:block;min-height:176px;width:100%}rh-footer-universal rh-footer-copyright{grid-column:-1/1}</style>
<style>.status-legal .status-page-widget[data-v-5f538988]{display:block;margin:.5rem 0;width:11.3125rem;width:-moz-max-content;width:max-content}.status-page-widget[data-v-5f538988]{align-items:center;display:flex;flex-direction:row}.status-legal .status-page-widget .status-description[data-v-5f538988]{color:#ccc;font-weight:600;letter-spacing:.0125rem;line-height:1.5;margin-right:.5rem}.status-good[data-v-5f538988]{background-color:#3e8536}.status-critical[data-v-5f538988]{background-color:#a30100}.status-partial[data-v-5f538988]{background-color:#f5c12d}.status-maintentance[data-v-5f538988]{background-color:#316dc1}.status-minor[data-v-5f538988]{background-color:#b85c00}.status-description[data-v-5f538988]{color:#ccc;font-weight:500;letter-spacing:.2px;line-height:1.5}.current-status-indicator[data-v-5f538988]{border-radius:6px;display:inline-block;height:12px;margin:0 0 0 5px;width:12px}.current-status-indicator.small[data-v-5f538988]{border-radius:4px;display:inline-block;height:8px;margin:0 0 0 5px;width:8px}</style>
<style>.breadcrumbs[data-v-798f280c]{align-items:center;background-color:#f6f6f6;display:flex;gap:var(--rh-space-xl,24px);padding:var(--rh-space-lg,16px) var(--rh-space-2xl,32px)}nav[data-v-798f280c]{flex:1}ol[data-v-798f280c]{background-color:#f6f6f6;font-size:.875rem;list-style:none;margin:0;padding:0}li[data-v-798f280c]{color:#151515;display:inline}a[data-v-798f280c]:after{border-bottom-color:transparent;border-left-color:transparent;box-shadow:inset .25rem .25rem 0 .0625rem #8a8d8d;content:"";display:inline-block;height:1.07143em;margin:0 .5em;position:relative;right:0;top:.75em;transform:translateY(-.5em) rotate(135deg) scale(.5);width:1.07143em}</style>
<style>ol[data-v-fa0dae77]{margin:0;padding:0}li[data-v-fa0dae77],ol[data-v-fa0dae77],ul[data-v-fa0dae77]{list-style:none;margin:0}.chapter-title[data-v-fa0dae77]{font-size:1em}.sub-chapter-title[data-v-fa0dae77],.sub-chapter-title a[data-v-fa0dae77]{font-size:.875rem}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77],.heading[data-v-fa0dae77],.sub-nav .link[data-v-fa0dae77],.sub-nav .link .link[data-v-fa0dae77]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-fa0dae77]:hover,.link[data-v-fa0dae77]:hover,.sub-nav .link[data-v-fa0dae77]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}details[open]:first-of-type>.heading[data-v-fa0dae77]:after{transform:rotate(135deg)}.item[data-v-fa0dae77]{line-height:22px}#toc .link[data-v-fa0dae77],#toc-mobile .link[data-v-fa0dae77]{color:var(--rh-color-text-primary-on-light,#151515)}.sub-nav[data-v-fa0dae77],.toc-wrapper[data-v-fa0dae77]{list-style:none;margin:0}.toc-wrapper[data-v-fa0dae77]{min-width:100%;padding:0}.sub-nav[data-v-fa0dae77]{font-size:1em;line-height:24px;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-fa0dae77]:hover{color:#151515}.active[data-v-fa0dae77]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.chapter-landing-page[data-v-fa0dae77]{font-weight:500}summary[data-v-fa0dae77]{cursor:pointer;list-style:none;position:relative}summary[data-v-fa0dae77]::-webkit-details-marker{display:none}@keyframes slideDown-fa0dae77{0%{height:0;opacity:0}to{height:var(--details-height-open,"100%");opacity:1}}html[data-v-fa0dae77]{--details-transition-time:400ms}details[data-v-fa0dae77]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-fa0dae77]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-fa0dae77]:after,details .heading[data-v-fa0dae77]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-fa0dae77]:after{height:8px;width:8px}</style>
<style>.item[data-v-b883c74f]{line-height:22px}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f]{color:var(--rh-color-text-primary-on-light,#151515)}#toc .link[data-v-b883c74f],#toc-mobile .link[data-v-b883c74f],.heading[data-v-b883c74f],.sub-nav .link[data-v-b883c74f],.sub-nav .link .link[data-v-b883c74f]{display:block;padding:var(--rh-space-md,8px) var(--rh-space-2xl,32px);padding-right:2.5em;text-decoration:none;transition:background-color .25s}.heading[data-v-b883c74f]:hover,.link[data-v-b883c74f]:hover,.sub-nav .link[data-v-b883c74f]:hover{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 #d2d2d2;color:#151515}ol[data-v-b883c74f]{margin:0;padding:0}li[data-v-b883c74f],ol[data-v-b883c74f],ul[data-v-b883c74f]{list-style:none;margin:0}.chapter-title[data-v-b883c74f]{font-size:1em}.sub-nav[data-v-b883c74f]{font-size:1em;line-height:24px;list-style:none;margin:0;padding-left:1rem;padding-left:16px}.sub-nav .link[data-v-b883c74f]:hover{color:#151515}.active[data-v-b883c74f]{background:var(--rh-color-surface-lighter,#f2f2f2);box-shadow:inset 3px 0 0 0 var(--rh-color-icon-primary-on-light,#e00)}.sub-chapter-title[data-v-b883c74f],.sub-chapter-title a[data-v-b883c74f]{font-size:.875rem}summary[data-v-b883c74f]{cursor:pointer;list-style:none;position:relative}summary[data-v-b883c74f]::-webkit-details-marker{display:none}html[data-v-b883c74f]{--details-transition-time:400ms}.chapter-landing-page[data-v-b883c74f]{font-weight:500}details[open]:first-of-type>.heading[data-v-b883c74f]:after{transform:rotate(135deg)}details[data-v-b883c74f]{max-height:var(--details-height-closed,auto);transition:all ease-out var(--details-transition-time,0)}details[open][data-v-b883c74f]{max-height:var(--details-height-open,auto)}details .heading.sub-chapter-title[data-v-b883c74f]:after,details .heading[data-v-b883c74f]:after{border-right:3px solid #151515;border-top:3px solid #151515;color:#151515;content:"";display:flex;float:right;height:9px;margin-left:16px;position:absolute;right:var(--rh-space-xl,24px);top:14px;transform:rotate(45deg);width:9px}details .heading.sub-chapter-title[data-v-b883c74f]:after{height:8px;width:8px}</style>
<style>.html-container[data-v-9c2a9ddb]{padding:2rem 1.5rem 0}rh-alert[data-v-9c2a9ddb]{color:#151515}@media (max-width:772px){.html-container[data-v-9c2a9ddb]{padding:3rem 1rem 0}}</style>
<style>.search-container[data-v-69710f44]{height:100%}.form-box[data-v-69710f44],.search-container[data-v-69710f44]{justify-content:center}.form-box[data-v-69710f44],.search-box[data-v-69710f44],.search-container[data-v-69710f44]{align-items:center;display:flex;width:100%}.search-box[data-v-69710f44]{justify-content:space-between;position:relative}ul[data-v-69710f44]{list-style-type:none}#search-list[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;box-shadow:0 4px 4px 0 #00000040;color:#151515;display:block;left:0;margin:0;padding:0;position:absolute;top:37px;width:100%;z-index:200}#search-list li[data-v-69710f44]{align-items:center;display:flex;justify-content:space-between;padding:.75rem}#search-list .active[data-v-69710f44],#search-list li[data-v-69710f44]:hover{background:#f0f0f0}.group-title[data-v-69710f44]{border-top:1px solid #4d4d4d;color:#4d4d4d;cursor:default;font-size:12px;font-weight:400;pointer-events:none}.group-title[data-v-69710f44],.group-title[data-v-69710f44]:hover{background:#fff}.search-item-text-elipsis[data-v-69710f44]{display:inline-block;max-width:48%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.search-item-text[data-v-69710f44]{padding-left:1.75rem}.search-item-chip[data-v-69710f44]{float:right}.search-product-version[data-v-69710f44]{background:#fff;border:1px solid #f0f0f0;border-radius:3px;font-size:1rem;font-weight:400;line-height:24px}.search-icon-form[data-v-69710f44]{color:var(--rh-color-gray-50,#707070);left:12px;position:absolute}.input-search-box[data-v-69710f44]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:0;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);height:36px;padding:0 40px;width:100%}.input-clear-btn[data-v-69710f44]{align-items:center;background-color:transparent;border:none;display:flex;height:36px;justify-content:center;margin-right:-30px;outline:none;transform:translateX(-30px)}.input-clear-btn[data-v-69710f44]:focus{border:1px solid var(--rh-color-accent-base-on-light,#06c)}.input-clear-btn:focus .input-clear-icon[data-v-69710f44]{color:var(--rh-color-canvas-black,#151515)}.input-clear-icon[data-v-69710f44]{color:#6b6e72;cursor:pointer}.input-clear-icon[data-v-69710f44]:hover{color:var(--rh-color-canvas-black,#151515)}.form-submit-btn[data-v-69710f44]::part(button){align-items:center;background-color:var(--rh-color-gray-20,#e0e0e0);border-radius:0;display:flex;height:36px;justify-content:center;--_default-border-color:var(--rh-color-gray-20,#e0e0e0)}.input-close-btn[data-v-69710f44]{background:none;border:none;cursor:pointer;margin:0 var(--rh-space-lg,16px)}.input-close-icon[data-v-69710f44]{color:var(--rh-color-white,#fff)}@media (max-width:992px){.form-box[data-v-69710f44]{gap:var(--rh-space-md,8px);margin:auto;width:100%}.input-search-box[data-v-69710f44]{border:1px solid var(--rh-color-gray-30,#c7c7c7)}.input-search-box[data-v-69710f44]::-moz-placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.input-search-box[data-v-69710f44]::placeholder{color:#6a6e73;font-family:var(--rh-font-family-body-text,"Red Hat Text","RedHatText",Arial,sans-serif);font-size:var(--rh-font-size-body-text-md,1rem);font-weight:var(--rh-font-weight-code-regular,400);line-height:24px}.search-item-text-elipsis[data-v-69710f44]{max-width:60%}}@media (max-width:767px){.input-close-btn[data-v-69710f44]{display:none}.search-container[data-v-69710f44]{border:1px solid #f0f0f0}}</style>
<link rel="stylesheet" href="/_nuxt/entry.DNAluCmw.css" integrity="sha384-FnrZajt9k3u4tri3ClqikI96k+jP7kyrvgKKgdzBr5Y8CQEi3gusKE0+eMSLvGxm">
<link rel="stylesheet" href="/_nuxt/SearchAutocomplete.DkrJaF8R.css" integrity="sha384-Zw8gf6w7SrpWDmknvrab5QanIN+DSJRS/bPB9/lgDkhR7JhDmG/VF++MTMKU8mKB">
<link rel="stylesheet" href="/_nuxt/Breadcrumbs.BLkLxUMB.css" integrity="sha384-f6iEfCywVoZB0/hIKTRaxywtS21KzhBx2JOI/uVjjU9aqFcP7X9cqLH29w2HQvLe">
<link rel="stylesheet" href="/_nuxt/Alert.fTkXFs3h.css" integrity="sha384-yFMpT5E64LAQi3qJ10AJJ1oOH3DrI68OvLSjSivjNCQXZ25pmFxlPavPQ0TEyEpq">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C3PvZR0C.js" integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ds9UYxCD.js" integrity="sha384-PFyBx6Pvk48yXM+prD4CDErW/3HFtPEqORVyAch5qDvJSyubA93+vR4jsWGRQKZs">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BUXK7nH-.js" integrity="sha384-Kqf3r1QrD7+NOn9EuK/ba9sTBZjn7vLAjnCoRtq7IKz+QV0JUUBFf1Snf1yVkkgr">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BxBriHwM.js" integrity="sha384-bejD6BN5N1iVRo5Ymn+LdVN0jvrnJTzgqgFD9xQ5+Yi46U6ff+s5W2AISzRWvJaM">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DB5Lt3x5.js" integrity="sha384-Ae/gV/4Dt4jnJApC0CWbckKJ7omq+W9Hb4jjdMyhxGJpwk6FlO7pGYMD3bPO/h1y">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D8BFaW0S.js" integrity="sha384-/m09v/yYk14L9Hra6/9jYtMTn2IdkKQvzpFPRQ5P/baRKwdZQN98873hqvwuYXFS">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/_58Q44fW.js" integrity="sha384-EdSd8jpnetO/BWDAc8C4SpQExZ7pYjMygNPvbLmiA1TaYsNUdVOqIIyOIzaErEeU">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DOCUiUcq.js" integrity="sha384-9H868K5q7MLzC8TSRXT3pVqDzsOVxZLYvUQ8cLGpHPZCFEyEJjnwSHE+/7FWrJPV">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CiTVMRA7.js" integrity="sha384-xBIJ2xO0t62/oREKqSxPtW1tRxKY+5YYXbGcJ0QR9IRM28JhL+53NOiAvVFn3rmF">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CR3F0y4K.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Bn-QuJwp.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/T_zvNmZe.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Ciddaed-.js">
<link rel="prefetch" as="image" type="image/svg+xml" href="/_nuxt/Footer_Cloud.DpSdW8MR.svg">
<script type="module">
      import "@rhds/elements/rh-cta/rh-cta.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@cpelements/pfe-navigation/dist/pfe-navigation.min.js";
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">import "@rhds/elements/rh-footer/rh-footer.js"</script>
<link rel="canonical" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/using_ansible_to_install_and_manage_identity_management/index">
<script type="module">
      import "@rhds/elements/rh-alert/rh-alert.js";
      import "@rhds/elements/rh-code-block/rh-code-block.js";
      import '@rhds/elements/rh-cta/rh-cta.js';
      import '@patternfly/elements/pf-switch/pf-switch.js';
      import '@cpelements/rh-table/dist/rh-table.js';
      import '@patternfly/pfe-clipboard/dist/pfe-clipboard.min.js';
      import '@patternfly/elements/pf-button/pf-button.js';
      import '@patternfly/elements/pf-modal/pf-modal.js';
      import '@patternfly/elements/pf-icon/pf-icon.js';
      import '@patternfly/elements/pf-popover/pf-popover.js';
      import '@patternfly/elements/pf-tooltip/pf-tooltip.js';
      import '@rhds/elements/rh-badge/rh-badge.js';
      </script>
<meta name="description" content="Using Ansible to install and manage Identity Management | Red Hat Documentation">
<meta name="app-version" content="v0.0.1">
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
      </script>
<script type="module">
      import '@rhds/elements/rh-alert/rh-alert.js';
      </script>
<script type="module">
        import "/scripts/v1/@rhds/elements/elements/rh-button/rh-button.js";
        import "@patternfly/elements/pf-badge/pf-badge.js";
      </script>
<script type="module" src="/_nuxt/C3PvZR0C.js" crossorigin integrity="sha384-H9Can2ny34kmIBk2SNFJRaBH6FotFjI6LVF8tQ4HqJnqY0a1tGDF/4RHxK2LFs7c"></script></head><body><div id="__nuxt"><!--[--><!--[--><!----><header data-v-edc0d12c><a href="#pfe-navigation" id="global-skip-to-nav" class="skip-link visually-hidden" data-v-edc0d12c>Skip to navigation</a><a href="#main-content" class="skip-link visually-hidden" data-v-edc0d12c>Skip to content</a><nav id="upper-navigation" class="upper-navigation" aria-labelledby="upper-navigation-label" data-analytics-region="upper-navigation" data-v-edc0d12c><p id="upper-navigation-label" class="upper-nav-hidden" data-v-edc0d12c>Featured links</p><div class="upper-nav-container" data-v-edc0d12c><ul class="upper-nav-menu" data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/" class="upper-nav-links" data-analytics-text="Support" data-analytics-category="Featured Links" data-v-edc0d12c>Support</a></li><li data-v-edc0d12c><a href="https://console.redhat.com/" class="upper-nav-links" data-analytics-text="Console" data-analytics-category="Featured Links" data-v-edc0d12c>Console</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" class="upper-nav-links" data-analytics-text="Developers" data-analytics-category="Featured Links" data-v-edc0d12c>Developers</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" class="upper-nav-links" data-analytics-text="Start a trial" data-analytics-category="Featured Links" data-v-edc0d12c>Start a trial</a></li><li data-v-edc0d12c><button id="all-red-hat" class="upper-nav-links" data-analytics-text="All Red Hat" data-analytics-category="Featured Links" aria-expanded="false" data-analytics-linktype="tab" data-v-edc0d12c>All Red Hat<svg class="upper-nav-arrow" xmlns="http://www.w3.org/2000/svg" width="1024" height="1024" viewBox="0 0 1024 1024" aria-hidden="true" data-v-edc0d12c=""><path d="M810.642 511.557c0 8.905-3.447 16.776-10.284 23.613L322.31 1013.216c-6.835 6.837-14.706 10.284-23.61 10.284s-16.776-3.447-23.613-10.284l-51.303-51.303c-6.837-6.837-10.284-14.707-10.284-23.612s3.447-16.775 10.284-23.61L626.972 511.5 223.784 108.31c-6.837-6.835-10.284-14.706-10.284-23.61s3.447-16.776 10.284-23.613l51.303-51.303C281.924 2.947 289.794-.5 298.7-.5s16.775 3.447 23.61 10.284L800.36 487.83c6.837 6.837 10.284 14.708 10.284 23.613v.114" data-v-edc0d12c=""/></svg></button><div class="upper-nav-dropdown-container" data-v-edc0d12c><ul data-v-edc0d12c><li data-v-edc0d12c><span data-v-edc0d12c>For customers</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://access.redhat.com/support" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Customer support" data-v-edc0d12c>Customer support</a></li><li data-v-edc0d12c><a href="/products" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Documentation" data-v-edc0d12c>Documentation</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/support/cases" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Support cases" data-v-edc0d12c>Support Cases</a></li><li data-v-edc0d12c><a href="https://access.redhat.com/management" data-pzn-audience="customers" data-analytics-category="All Red Hat|For customers" data-analytics-text="Subscription management" data-v-edc0d12c>Subscription management</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/" data-analytics-category="All Red Hat|For customers" data-analytics-text="Red Hat Ecosystem Catalog" data-v-edc0d12c>Red Hat Ecosystem Catalog</a></li><li data-v-edc0d12c><a href="https://catalog.redhat.com/partners" data-analytics-category="All Red Hat|For customers" data-analytics-text="Find a partner" data-v-edc0d12c>Find a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>For partners</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://connect.redhat.com/login" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner login" data-v-edc0d12c>Partner login</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/en/support" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Partner support" data-v-edc0d12c>Partner support</a></li><li data-v-edc0d12c><a href="https://connect.redhat.com/" data-pzn-audience="partners" data-analytics-category="All Red Hat|For partners" data-analytics-text="Become a partner " data-v-edc0d12c>Become a partner</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Try, buy, &amp; sell</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://marketplace.redhat.com/en-us" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Marketplace" data-v-edc0d12c>Red Hat Marketplace</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/store" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Red Hat Store" data-v-edc0d12c>Red Hat Store</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/contact" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Contact sales" data-v-edc0d12c>Contact Sales</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/products/trials" data-analytics-category="All Red Hat|Try, buy, &amp; sell" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Learning resources</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.redhat.com/en/services/training-and-certification" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Training and certification " data-v-edc0d12c>Training and certification</a></li><li data-v-edc0d12c><a href="https://developers.redhat.com/" data-pzn-audience="developers|community" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="For developers" data-v-edc0d12c>For developers</a></li><li data-v-edc0d12c><a href="https://cloud.redhat.com/learn" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Hybrid cloud learning hub" data-v-edc0d12c>Hybrid cloud learning hub</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Interactive labs" data-v-edc0d12c>Interactive labs</a></li><li data-v-edc0d12c><a href="https://learn.redhat.com/" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Learning community" data-v-edc0d12c>Learning community</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/en/tv" data-analytics-category="All Red Hat|Learning resources" data-analytics-text="Red Hat TV" data-v-edc0d12c>Red Hat TV</a></li></ul></li><li data-v-edc0d12c><span data-v-edc0d12c>Open source communities</span><ul data-v-edc0d12c><li data-v-edc0d12c><a href="https://www.ansible.com/community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="Ansible" data-v-edc0d12c>Ansible</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/sysadmin/" id="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For system administrators" data-v-edc0d12c>For system administrators</a></li><li data-v-edc0d12c><a href="https://www.redhat.com/architect/" data-pzn-audience="community" data-analytics-category="All Red Hat|Open source communities" data-analytics-text="For architects" data-v-edc0d12c>For architects</a></li></ul></li></ul></div></li></ul></div></nav><pfe-navigation full-width id="pfe-navigation" pf-sticky="true" lang="en" data-v-edc0d12c><nav class="pfe-navigation" aria-label="Main Navigation" data-v-edc0d12c><div class="pfe-navigation__logo-wrapper" id="pfe-navigation__logo-wrapper" data-v-edc0d12c><a href="/en" class="pfe-navigation__logo-link" data-v-edc0d12c><img class="pfe-navigation__logo-image pfe-navigation__logo-image--screen pfe-navigation__logo-image--small" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" width="240" height="40" alt="Red Hat Documentation" data-v-edc0d12c></a></div></nav><span data-v-edc0d12c></span><div slot="secondary-links" data-v-edc0d12c><div class="hidden-at-desktop hidden-at-tablet search-mobile" data-v-edc0d12c><div id="search-form" class="search-container" opensearchbox="true" data-v-edc0d12c data-v-69710f44><form role="search" class="form-box" autocomplete="off" data-v-69710f44><div class="search-box" data-v-69710f44><pf-icon icon="search" size="md" class="search-icon-form" data-v-69710f44></pf-icon><input type="text" id="input-search" class="input-search-box" placeholder="Search documentation" value aria-autocomplete="list" data-v-69710f44><!----><!----><!----><rh-button disabled variant="tertiary" class="form-submit-btn" data-v-69710f44><img src="data:image/svg+xml,%3csvg%20width=&#39;14&#39;%20height=&#39;14&#39;%20viewBox=&#39;0%200%2014%2014&#39;%20fill=&#39;none&#39;%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%3e%3cpath%20d=&#39;M7%200L5.6%201.4L10.3%206H0V8H10.3L5.6%2012.6L7%2014L14%207L7%200Z&#39;%20fill=&#39;%23707070&#39;/%3e%3c/svg%3e" alt="Submit button" data-v-69710f44></rh-button></div></form><!----></div></div><div class="hidden-at-desktop hidden-at-tablet buttons" data-v-edc0d12c><a href="https://access.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Support" data-v-edc0d12c>Support</a><a href="https://console.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Console" data-v-edc0d12c>Console</a><a href="https://developers.redhat.com/" data-analytics-category="More Red Hat" data-analytics-text="Developers" data-v-edc0d12c>Developers</a><a href="https://www.redhat.com/en/products/trials" data-analytics-category="More Red Hat" data-analytics-text="Start a trial" data-v-edc0d12c>Start a trial</a><a href="https://www.redhat.com/en/contact" data-analytics-category="More Red Hat" data-analytics-text="Contact" data-v-edc0d12c>Contact</a></div><div class="hidden-at-desktop hidden-at-tablet mobile-lang-select" data-v-edc0d12c><label for="lang_selection" data-v-edc0d12c>Select your language</label><select id="lang_selection" data-v-edc0d12c><!--[--><option value="en" xml:lang="en" hreflang="en" data-v-edc0d12c>English</option><option value="fr" xml:lang="fr" hreflang="fr" data-v-edc0d12c>Français</option><option value="ko" xml:lang="ko" hreflang="ko" data-v-edc0d12c>한국어</option><option value="ja" xml:lang="ja" hreflang="ja" data-v-edc0d12c>日本語</option><option value="zh-cn" xml:lang="zh-cn" hreflang="zh-cn" data-v-edc0d12c>中文 (中国)</option><option value="de" xml:lang="de" hreflang="de" data-v-edc0d12c>Deutsch</option><option value="it" xml:lang="it" hreflang="it" data-v-edc0d12c>Italiano</option><option value="pt-br" xml:lang="pt-br" hreflang="pt-br" data-v-edc0d12c>Português</option><option value="es" xml:lang="es" hreflang="es" data-v-edc0d12c>Español</option><!--]--></select></div></div></pfe-navigation></header><main id="main-content"><!--[--><!--[--><!--[--><!----><!----><!--]--><div class="breadcrumbs" id="breadcrumbs" data-v-8589d091 data-v-798f280c><nav aria-label="Breadcrumb" class="breadcrumb" data-v-798f280c><ol data-v-798f280c><li data-v-798f280c><a href="/" data-v-798f280c>Home</a></li><li data-v-798f280c><a href="/en/products" data-v-798f280c>Products</a></li><!--[--><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/" data-v-798f280c>Red Hat Enterprise Linux</a></li><li data-v-798f280c><a href="/en/documentation/red_hat_enterprise_linux/9/" data-v-798f280c>9</a></li><li data-v-798f280c><!--[-->Using Ansible to install and manage Identity Management<!--]--></li><!--]--></ol></nav><span data-v-798f280c></span></div><!----><nav id="mobile-nav" class="mobile-nav" aria-label="mobile menu" data-v-8589d091><div class="mobile-nav-wrapper" data-v-8589d091><div id="first-button" data-v-8589d091><button id="toc-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><span class="sr-only" data-v-8589d091>Open </span>Table of contents</button></div><div id="second-button" data-v-8589d091><button id="settings-btn" aria-expanded="false" aria-controls="mobile-nav-content-wrapper" class="mobile-nav-btn" data-v-8589d091><pf-icon icon="cog" size="md" data-v-8589d091></pf-icon><span class="sr-only" data-v-8589d091>Open page settings</span></button></div></div><div id="mobile-nav-content-wrapper" class="hidden" role="navigation" tabindex="0" data-v-8589d091><div id="toc-mobile" class="hidden" aria-labelledby="toc-btn" data-v-8589d091><div class="shrink-product-padding product-container" id="product-container-mobile" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter-mobile" data-v-8589d091><span id="text" part="text" data-v-8589d091><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper-mobile" class="span-xs-12 span-sm-4 span-md-3" lang="en" data-v-8589d091><nav id="mobile-toc-menu" class="table-of-contents" aria-label="table of content - mobile" data-v-8589d091><!----></nav></div><!----></div><div id="page-content-options-mobile" class="hidden" aria-labelledby="settings-btn" data-v-8589d091><div class="page-layout-options" data-v-8589d091><label for="page-format-mobile" data-v-8589d091>Format</label><select id="page-format-mobile" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div></div></div><!----><!----></nav><div class="grid grid-col-12 content-wrapper" data-v-8589d091><aside id="left-content" class="span-xs-12 span-sm-4 span-md-3" lang="en-us" aria-label="left navigation" xml:lang="en-us" data-v-8589d091><div class="toc-container" id="toc-container" visible="true" data-v-8589d091><div class="toc-focus-container" id="toc-focus-container" data-v-8589d091><button class="toc-focus-btn" aria-label="toggle left menu" aria-controls="toc-container" aria-expanded="true" data-v-8589d091><pf-icon size="md" icon="angle-left" class="toc-focus-btn-icon" data-v-8589d091></pf-icon></button></div><div class="product-container" id="product-container-desktop" data-v-8589d091><h1 class="product-title" data-v-8589d091>Red Hat Enterprise Linux</h1><!----></div><div class="toc-filter" id="toc-filter" data-v-8589d091><span id="text" part="text" data-v-8589d091><span id="search-icon" part="search-icon" data-v-8589d091><pf-icon icon="filter" size="md" data-v-8589d091></pf-icon></span><input id="text-input" aria-label="Search input" part="text-input" placeholder="Filter table of contents" type="text" class value data-v-8589d091><!----></span></div><div id="toc-wrapper" class="toc-wrapper" data-v-8589d091><nav id="toc" class="max-height-85 table-of-contents" aria-label="Table of contents" data-v-8589d091><ol id="toc-list" data-v-8589d091><!--[--><li class="item chapter" data-v-fa0dae77><a class="link active" href id="chapter-index" data-v-fa0dae77>Using Ansible to install and manage Identity Management</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#proc_providing-feedback-on-red-hat-documentation_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-proc_providing-feedback-on-red-hat-documentation_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Providing feedback on Red Hat documentation</a></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#ansible-terminology_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-ansible-terminology_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>1. Ansible terminology</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--installing-an-Identity-Management-server-using-an-Ansible-playbook_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="installing-an-Identity-Management-server-using-an-Ansible-playbook_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>2. Installing an Identity Management server using an Ansible playbook</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#installing-an-Identity-Management-server-using-an-Ansible-playbook_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-installing-an-identity-management-server-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Installing an Identity Management server using an Ansible playbook</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ansible-and-its-advantages-for-installing-IdM_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ansible-and-its-advantages-for-installing-IdM_server-ansible" data-v-b883c74f>2.1. Ansible and its advantages for installing IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-the-ansible-freeipa-package_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-installing-the-ansible-freeipa-package_server-ansible" data-v-b883c74f>2.2. Installing the ansible-freeipa package</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ansible-roles-location-in-the-file-system_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ansible-roles-location-in-the-file-system_server-ansible" data-v-b883c74f>2.3. Ansible roles location in the file system</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-integrated-ca-as-the-root-ca_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-integrated-ca-as-the-root-ca_server-ansible" data-v-b883c74f>2.4. Setting the parameters for a deployment with an integrated DNS and an integrated CA as the root CA</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-the-parameters-for-a-deployment-with-external-dns-and-an-integrated-ca-as-the-root-ca_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-setting-the-parameters-for-a-deployment-with-external-dns-and-an-integrated-ca-as-the-root-ca_server-ansible" data-v-b883c74f>2.5. Setting the parameters for a deployment with external DNS and an integrated CA as the root CA</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-an-IdM-server-with-an-integrated-CA-using-an-Ansible-playbook_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-deploying-an-IdM-server-with-an-integrated-CA-using-an-Ansible-playbook_server-ansible" data-v-b883c74f>2.6. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-external-ca-as-the-root-ca_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-external-ca-as-the-root-ca_server-ansible" data-v-b883c74f>2.7. Setting the parameters for a deployment with an integrated DNS and an external CA as the root CA</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-the-parameters-for-a-deployment-with-external-dns-and-an-external-ca-as-the-root-ca_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-setting-the-parameters-for-a-deployment-with-external-dns-and-an-external-ca-as-the-root-ca_server-ansible" data-v-b883c74f>2.8. Setting the parameters for a deployment with external DNS and an external CA as the root CA</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-an-IdM-server-with-an-external-CA-using-an-Ansible-playbook_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-deploying-an-IdM-server-with-an-external-CA-using-an-Ansible-playbook_server-ansible" data-v-b883c74f>2.9. Deploying an IdM server with an external CA as the root CA using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#uninstalling-an-idm-server-using-an-ansible-playbook_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-uninstalling-an-idm-server-using-an-ansible-playbook_server-ansible" data-v-b883c74f>2.10. Uninstalling an IdM server using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible" data-v-b883c74f>2.11. Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--installing-an-Identity-Management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="installing-an-Identity-Management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>3. Installing an Identity Management replica using an Ansible playbook</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#installing-an-Identity-Management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-installing-an-identity-management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Installing an Identity Management replica using an Ansible playbook</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible" data-v-b883c74f>3.1. Specifying the base, server and client variables for installing the IdM replica</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible" data-v-b883c74f>3.2. Specifying the credentials for installing the IdM replica using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible" data-v-b883c74f>3.3. Deploying an IdM replica using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#uninstalling-an-idm-replica-using-an-ansible-playbook_replica-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-uninstalling-an-idm-replica-using-an-ansible-playbook_replica-ansible" data-v-b883c74f>3.4. Uninstalling an IdM replica using an Ansible playbook</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--installing-an-Identity-Management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="installing-an-Identity-Management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>4. Installing an Identity Management client using an Ansible playbook</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#installing-an-Identity-Management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-installing-an-identity-management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Installing an Identity Management client using an Ansible playbook</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible" data-v-b883c74f>4.1. Setting the parameters of the inventory file for the autodiscovery client installation mode</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible" data-v-b883c74f>4.2. Setting the parameters of the inventory file when autodiscovery is not possible during client installation</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible" data-v-b883c74f>4.3. Authorization options for IdM client enrollment using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible" data-v-b883c74f>4.4. Deploying an IdM client using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-the-one-time-password-method-in-ansible-to-install-an-idm-client_client-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-the-one-time-password-method-in-ansible-to-install-an-idm-client_client-ansible" data-v-b883c74f>4.5. Using the one-time password method in Ansible to install an IdM client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#testing-an-Identity-Management-after-Ansible-installation_client-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-testing-an-Identity-Management-after-Ansible-installation_client-ansible" data-v-b883c74f>4.6. Testing an Identity Management client after Ansible installation</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#uninstalling-an-IdM-client-using-an-Ansible-playbook_client-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-uninstalling-an-IdM-client-using-an-Ansible-playbook_client-ansible" data-v-b883c74f>4.7. Uninstalling an IdM client using an Ansible playbook</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>5. Preparing your environment for managing IdM using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Preparing your environment for managing IdM using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks" data-v-b883c74f>5.1. Preparing a control node and managed nodes for managing IdM using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks" data-v-b883c74f>5.2. Different methods to provide the credentials required for ansible-freeipa playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_the-inventory-plugin-in-ansible-freeipa_preparing-your-environment-for-managing-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-con_the-inventory-plugin-in-ansible-freeipa_preparing-your-environment-for-managing-idm-using-ansible-playbooks" data-v-b883c74f>5.3. The inventory plugin in ansible-freeipa</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--configuring-global-IdM-settings-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="configuring-global-IdM-settings-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>6. Configuring global IdM settings using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#configuring-global-IdM-settings-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-configuring-global-idm-settings-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Configuring global IdM settings using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" data-v-b883c74f>6.1. Retrieving IdM configuration using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-IdM-ca-renewal-server-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-configuring-the-IdM-ca-renewal-server-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" data-v-b883c74f>6.2. Configuring the IdM CA renewal server using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-the-default-shell-for-IdM-users-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-configuring-the-default-shell-for-IdM-users-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" data-v-b883c74f>6.3. Configuring the default shell for IdM users using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-a-netbios-name-for-an-idm-domain-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-configuring-a-netbios-name-for-an-idm-domain-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks" data-v-b883c74f>6.4. Configuring a NetBIOS name for an IdM domain by using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-that-idm-users-and-groups-have-sids-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-that-idm-users-and-groups-have-sids-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks" data-v-b883c74f>6.5. Ensuring that IdM users and groups have SIDs by using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional_resources" data-v-b883c74f>6.6. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>7. Managing user accounts using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-managing-user-accounts-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Managing user accounts using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#user-life-cycle_managing-idm-users-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-user-life-cycle_managing-idm-users-using-Ansible-playbooks" data-v-b883c74f>7.1. User life cycle</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks" data-v-b883c74f>7.2. Ensuring the presence of an IdM user using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-multiple-IdM-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-multiple-IdM-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" data-v-b883c74f>7.3. Ensuring the presence of multiple IdM users using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-multiple-IdM-users-from-a-json-file-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-multiple-IdM-users-from-a-json-file-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" data-v-b883c74f>7.4. Ensuring the presence of multiple IdM users from a JSON file using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" data-v-b883c74f>7.5. Ensuring the absence of users using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_2" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional_resources_2" data-v-b883c74f>7.6. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>8. Managing user groups using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Managing user groups using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#the-different-group-types-in-idm_managing-user-groups-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-the-different-group-types-in-idm_managing-user-groups-using-ansible-playbooks" data-v-b883c74f>8.1. The different group types in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#direct-and-indirect-group-members_managing-user-groups-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-direct-and-indirect-group-members_managing-user-groups-using-ansible-playbooks" data-v-b883c74f>8.2. Direct and indirect group members</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks" data-v-b883c74f>8.3. Ensuring the presence of IdM groups and group members using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-add-multiple-idm-groups-in-a-single-task_managing-user-groups-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-add-multiple-idm-groups-in-a-single-task_managing-user-groups-using-ansible-playbooks" data-v-b883c74f>8.4. Using Ansible to add multiple IdM groups in a single task</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-ansible-to-enable-ad-users-to-administer-idm_managing-user-groups-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_using-ansible-to-enable-ad-users-to-administer-idm_managing-user-groups-using-ansible-playbooks" data-v-b883c74f>8.5. Using Ansible to enable AD users to administer IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks" data-v-b883c74f>8.6. Ensuring the presence of member managers in IdM user groups using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks" data-v-b883c74f>8.7. Ensuring the absence of member managers in IdM user groups using Ansible playbooks</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>9. Using Ansible to automate group membership in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to automate group membership in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-present_using-ansible-to-automate-group-membership-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-present_using-ansible-to-automate-group-membership-in-idm" data-v-b883c74f>9.1. Using Ansible to ensure that an automember rule for an IdM user group is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-specified-condition-is-present-in-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-specified-condition-is-present-in-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" data-v-b883c74f>9.2. Using Ansible to ensure that a specified condition is present in an IdM user group automember rule</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" data-v-b883c74f>9.3. Using Ansible to ensure that a condition is absent from an IdM user group automember rule</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-absent_using-ansible-to-automate-group-membership-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-absent_using-ansible-to-automate-group-membership-in-idm" data-v-b883c74f>9.4. Using Ansible to ensure that an automember rule for an IdM user group is absent</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-condition-is-present-in-an-idm-host-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-condition-is-present-in-an-idm-host-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" data-v-b883c74f>9.5. Using Ansible to ensure that a condition is present in an IdM host group automember rule</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>10. Using Ansible playbooks to manage self-service rules in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible playbooks to manage self-service rules in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm" data-v-b883c74f>10.1. Self-service access control in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-self-service-rule-is-present_using-ansible-playbooks-to-manage-self-service-rules-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-self-service-rule-is-present_using-ansible-playbooks-to-manage-self-service-rules-in-idm" data-v-b883c74f>10.2. Using Ansible to ensure that a self-service rule is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-self-service-rule-is-absent_using-ansible-playbooks-to-manage-self-service-rules-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-self-service-rule-is-absent_using-ansible-playbooks-to-manage-self-service-rules-in-idm" data-v-b883c74f>10.3. Using Ansible to ensure that a self-service rule is absent</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-self-service-rule-has-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-self-service-rule-has-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm" data-v-b883c74f>10.4. Using Ansible to ensure that a self-service rule has specific attributes</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-self-service-rule-does-not-have-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-self-service-rule-does-not-have-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm" data-v-b883c74f>10.5. Using Ansible to ensure that a self-service rule does not have specific attributes</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>11. Delegating permissions to user groups to manage users using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Delegating permissions to user groups to manage users using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" data-v-b883c74f>11.1. Delegation rules</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#creating-an-ansible-inventory-file-for-idm_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-creating-an-ansible-inventory-file-for-idm_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" data-v-b883c74f>11.2. Creating an Ansible inventory file for IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-ansible-to-ensure-that-a-delegation-rule-is-present_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_using-ansible-to-ensure-that-a-delegation-rule-is-present_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" data-v-b883c74f>11.3. Using Ansible to ensure that a delegation rule is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-ansible-to-ensure-that-a-delegation-rule-is-absent_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_using-ansible-to-ensure-that-a-delegation-rule-is-absent_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" data-v-b883c74f>11.4. Using Ansible to ensure that a delegation rule is absent</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-ansible-to-ensure-that-a-delegation-rule-has-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_using-ansible-to-ensure-that-a-delegation-rule-has-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" data-v-b883c74f>11.5. Using Ansible to ensure that a delegation rule has specific attributes</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_using-ansible-to-ensure-that-a-delegation-rule-does-not-have-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_using-ansible-to-ensure-that-a-delegation-rule-does-not-have-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" data-v-b883c74f>11.6. Using Ansible to ensure that a delegation rule does not have specific attributes</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>12. Using Ansible playbooks to manage role-based access control in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible playbooks to manage role-based access control in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.1. Permissions in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#default-managed-permissions_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-default-managed-permissions_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.2. Default managed permissions</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.3. Privileges in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.4. Roles in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#predefined-roles-in-identity-management_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-predefined-roles-in-identity-management_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.5. Predefined roles in Identity Management</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-idm-rbac-role-with-privileges-is-present_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-idm-rbac-role-with-privileges-is-present_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.6. Using Ansible to ensure an IdM RBAC role with privileges is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-idm-rbac-role-is-absent_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-idm-rbac-role-is-absent_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.7. Using Ansible to ensure an IdM RBAC role is absent</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-group-of-users-is-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-group-of-users-is-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.8. Using Ansible to ensure that a group of users is assigned to an IdM RBAC role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-specific-users-are-not-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-specific-users-are-not-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.9. Using Ansible to ensure that specific users are not assigned to an IdM RBAC role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-a-service-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-a-service-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.10. Using Ansible to ensure a service is a member of an IdM RBAC role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-a-host-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-a-host-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.11. Using Ansible to ensure a host is a member of an IdM RBAC role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-a-host-group-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-a-host-group-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" data-v-b883c74f>12.12. Using Ansible to ensure a host group is a member of an IdM RBAC role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>13. Using Ansible playbooks to manage RBAC privileges</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible playbooks to manage RBAC privileges</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges" data-v-b883c74f>13.1. Using Ansible to ensure a custom IdM RBAC privilege is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-member-permissions-are-present-in-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-member-permissions-are-present-in-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges" data-v-b883c74f>13.2. Using Ansible to ensure member permissions are present in a custom IdM RBAC privilege</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-idm-rbac-privilege-does-not-include-a-permission_using-ansible-playbooks-to-manage-rbac-privileges" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-idm-rbac-privilege-does-not-include-a-permission_using-ansible-playbooks-to-manage-rbac-privileges" data-v-b883c74f>13.3. Using Ansible to ensure an IdM RBAC privilege does not include a permission</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-rename-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-rename-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges" data-v-b883c74f>13.4. Using Ansible to rename a custom IdM RBAC privilege</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-idm-rbac-privilege-is-absent_using-ansible-playbooks-to-manage-rbac-privileges" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-idm-rbac-privilege-is-absent_using-ansible-playbooks-to-manage-rbac-privileges" data-v-b883c74f>13.5. Using Ansible to ensure an IdM RBAC privilege is absent</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_3" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional_resources_3" data-v-b883c74f>13.6. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>14. Using Ansible playbooks to manage RBAC permissions in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible playbooks to manage RBAC permissions in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-rbac-permission-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-rbac-permission-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" data-v-b883c74f>14.1. Using Ansible to ensure an RBAC permission is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-rbac-permission-with-an-attribute-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-rbac-permission-with-an-attribute-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" data-v-b883c74f>14.2. Using Ansible to ensure an RBAC permission with an attribute is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-rbac-permission-is-absent_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-rbac-permission-is-absent_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" data-v-b883c74f>14.3. Using Ansible to ensure an RBAC permission is absent</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-attribute-is-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-attribute-is-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" data-v-b883c74f>14.4. Using Ansible to ensure an attribute is a member of an IdM RBAC permission</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-attribute-is-not-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-attribute-is-not-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" data-v-b883c74f>14.5. Using Ansible to ensure an attribute is not a member of an IdM RBAC permission</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-rename-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-rename-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" data-v-b883c74f>14.6. Using Ansible to rename an IdM RBAC permission</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_4" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional_resources_4" data-v-b883c74f>14.7. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>15. Using Ansible to manage the replication topology in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to manage the replication topology in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-a-replication-agreement-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-a-replication-agreement-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm" data-v-b883c74f>15.1. Using Ansible to ensure a replication agreement exists in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-replication-agreements-exist-between-multiple-idm-replicas_using-ansible-to-manage-the-replication-topology-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-replication-agreements-exist-between-multiple-idm-replicas_using-ansible-to-manage-the-replication-topology-in-idm" data-v-b883c74f>15.2. Using Ansible to ensure replication agreements exist between multiple IdM replicas</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-check-if-a-replication-agreement-exists-between-two-replicas_using-ansible-to-manage-the-replication-topology-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-check-if-a-replication-agreement-exists-between-two-replicas_using-ansible-to-manage-the-replication-topology-in-idm" data-v-b883c74f>15.3. Using Ansible to check if a replication agreement exists between two replicas</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-verify-that-a-topology-suffix-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-verify-that-a-topology-suffix-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm" data-v-b883c74f>15.4. Using Ansible to verify that a topology suffix exists in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-reinitialize-an-idm-replica_using-ansible-to-manage-the-replication-topology-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-reinitialize-an-idm-replica_using-ansible-to-manage-the-replication-topology-in-idm" data-v-b883c74f>15.5. Using Ansible to reinitialize an IdM replica</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-a-replication-agreement-is-absent-in-idm_using-ansible-to-manage-the-replication-topology-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-a-replication-agreement-is-absent-in-idm_using-ansible-to-manage-the-replication-topology-in-idm" data-v-b883c74f>15.6. Using Ansible to ensure a replication agreement is absent in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional-resources_using-ansible-to-manage-the-replication-topology-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional-resources_using-ansible-to-manage-the-replication-topology-in-idm" data-v-b883c74f>15.7. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>16. Managing IdM servers by using Ansible</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Managing IdM servers by using Ansible</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#checking-that-an-idm-server-is-present-by-using-ansible_managing-idm-servers-by-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-checking-that-an-idm-server-is-present-by-using-ansible_managing-idm-servers-by-using-ansible" data-v-b883c74f>16.1. Checking that an IdM server is present by using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-that-an-idm-server-is-absent-from-an-idm-topology-by-using-ansible_managing-idm-servers-by-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-that-an-idm-server-is-absent-from-an-idm-topology-by-using-ansible_managing-idm-servers-by-using-ansible" data-v-b883c74f>16.2. Ensuring that an IdM server is absent from an IdM topology by using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-an-idm-server-despite-hosting-a-last-idm-server-role_managing-idm-servers-by-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-an-idm-server-despite-hosting-a-last-idm-server-role_managing-idm-servers-by-using-ansible" data-v-b883c74f>16.3. Ensuring the absence of an IdM server despite hosting a last IdM server role</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-that-an-idm-server-is-absent-but-not-necessarily-disconnected-from-other-idm-servers_managing-idm-servers-by-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-that-an-idm-server-is-absent-but-not-necessarily-disconnected-from-other-idm-servers_managing-idm-servers-by-using-ansible" data-v-b883c74f>16.4. Ensuring that an IdM server is absent but not necessarily disconnected from other IdM servers</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-that-an-existing-idm-server-is-hidden-using-an-ansible-playbook_managing-idm-servers-by-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-that-an-existing-idm-server-is-hidden-using-an-ansible-playbook_managing-idm-servers-by-using-ansible" data-v-b883c74f>16.5. Ensuring that an existing IdM server is hidden using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-that-an-existing-idm-server-is-visible-using-an-ansible-playbook_managing-idm-servers-by-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-that-an-existing-idm-server-is-visible-using-an-ansible-playbook_managing-idm-servers-by-using-ansible" data-v-b883c74f>16.6. Ensuring that an existing IdM server is visible by using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-that-an-existing-idm-server-has-an-idm-dns-location-assigned_managing-idm-servers-by-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-that-an-existing-idm-server-has-an-idm-dns-location-assigned_managing-idm-servers-by-using-ansible" data-v-b883c74f>16.7. Ensuring that an existing IdM server has an IdM DNS location assigned</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-that-an-existing-idm-server-has-no-idm-dns-location-assigned_managing-idm-servers-by-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-that-an-existing-idm-server-has-no-idm-dns-location-assigned_managing-idm-servers-by-using-ansible" data-v-b883c74f>16.8. Ensuring that an existing IdM server has no IdM DNS location assigned</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>17. Managing hosts using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-managing-hosts-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Managing hosts using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-IdM-host-entry-with-FQDN-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-IdM-host-entry-with-FQDN-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" data-v-b883c74f>17.1. Ensuring the presence of an IdM host entry with FQDN using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" data-v-b883c74f>17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-multiple-IdM-host-entries-with-random-passwords-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-multiple-IdM-host-entries-with-random-passwords-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" data-v-b883c74f>17.3. Ensuring the presence of multiple IdM host entries with random passwords using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-IdM-host-entry-with-multiple-IP-addresses-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-IdM-host-entry-with-multiple-IP-addresses-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" data-v-b883c74f>17.4. Ensuring the presence of an IdM host entry with multiple IP addresses using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-an-IdM-host-entry-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-an-IdM-host-entry-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" data-v-b883c74f>17.5. Ensuring the absence of an IdM host entry using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_5" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional_resources_5" data-v-b883c74f>17.6. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>18. Managing host groups using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-managing-host-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Managing host groups using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#host-groups-in-idm_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-host-groups-in-idm_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.1. Host groups in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.2. Ensuring the presence of IdM host groups using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-hosts-in-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-hosts-in-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.3. Ensuring the presence of hosts in IdM host groups using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#nesting-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-nesting-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.4. Nesting IdM host groups using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-member-managers-in-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-member-managers-in-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.5. Ensuring the presence of member managers in IDM host groups using Ansible Playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-hosts-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-hosts-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.6. Ensuring the absence of hosts from IdM host groups using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-nested-host-groups-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-nested-host-groups-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.7. Ensuring the absence of nested host groups from IdM host groups using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.8. Ensuring the absence of IdM host groups using Ansible playbooks</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-member-managers-from-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-member-managers-from-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks" data-v-b883c74f>18.9. Ensuring the absence of member managers from IdM host groups using Ansible playbooks</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>19. Defining IdM password policies</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Defining IdM password policies</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#what-is-a-password-policy_defining-idm-password-policies" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-what-is-a-password-policy_defining-idm-password-policies" data-v-b883c74f>19.1. What is a password policy</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#password-policies-in-idm_defining-idm-password-policies" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-password-policies-in-idm_defining-idm-password-policies" data-v-b883c74f>19.2. Password policies in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#password-policy-priorities-in-idm_defining-idm-password-policies" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-password-policy-priorities-in-idm_defining-idm-password-policies" data-v-b883c74f>19.3. Password policy priorities in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-a-password-policy-in-idm-using-an-ansible-playbook_defining-idm-password-policies" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-a-password-policy-in-idm-using-an-ansible-playbook_defining-idm-password-policies" data-v-b883c74f>19.4. Ensuring the presence of a password policy in IdM using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><details id="nested-toc--adding-a-new-password-policy-in-idm_defining-idm-password-policies" data-v-b883c74f><summary class="heading sub-chapter-title" id="adding-a-new-password-policy-in-idm_defining-idm-password-policies--summary" data-v-b883c74f>19.5. Adding a new password policy in IdM using the WebUI or the CLI</summary><ol id="sub-nav--adding-a-new-password-policy-in-idm_defining-idm-password-policies" class="sub-nav" data-v-b883c74f><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title chapter-landing-page" href="#adding-a-new-password-policy-in-idm_defining-idm-password-policies" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-adding-a-new-password-policy-in-idm_defining-idm-password-policies" data-v-b883c74f>Adding a new password policy in IdM using the WebUI or the CLI</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-new-password-policy-webui_adding-a-new-password-policy-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-adding-a-new-password-policy-webui_adding-a-new-password-policy-in-idm" data-v-b883c74f>19.5.1. Adding a new password policy in the IdM WebUI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-new-password-policy-in-the-idm-cli_adding-a-new-password-policy-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-adding-a-new-password-policy-in-the-idm-cli_adding-a-new-password-policy-in-idm" data-v-b883c74f>19.5.2. Adding a new password policy in the IdM CLI</a></li><!--]--><!--]--></ol></details></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional-password-policy-options-in-idm_defining-idm-password-policies" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional-password-policy-options-in-idm_defining-idm-password-policies" data-v-b883c74f>19.6. Additional password policy options in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#applying-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-applying-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies" data-v-b883c74f>19.7. Applying additional password policy options to an IdM group</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-apply-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-apply-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies" data-v-b883c74f>19.8. Using an Ansible playbook to apply additional password policy options to an IdM group</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--granting-sudo-access-to-an-IdM-user-on-an-IdM-client_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="granting-sudo-access-to-an-IdM-user-on-an-IdM-client_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>20. Granting sudo access to an IdM user on an IdM client</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#granting-sudo-access-to-an-IdM-user-on-an-IdM-client_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-granting-sudo-access-to-an-idm-user-on-an-idm-client_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Granting sudo access to an IdM user on an IdM client</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.1. Sudo access on an IdM client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.2. Granting sudo access to an IdM user on an IdM client using the CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_granting-sudo-access-to-an-ad-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_granting-sudo-access-to-an-ad-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.3. Granting sudo access to an AD user on an IdM client using the CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.4. Granting sudo access to an IdM user on an IdM client using the IdM Web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_creating-a-sudo-rule-on-the-cli-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_creating-a-sudo-rule-on-the-cli-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.5. Creating a sudo rule on the CLI that runs a command as a service account on an IdM client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_creating-a-sudo-rule-in-the-idm-webui-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_creating-a-sudo-rule-in-the-idm-webui-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.6. Creating a sudo rule in the IdM WebUI that runs a command as a service account on an IdM client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_enabling-gssapi-authentication-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_enabling-gssapi-authentication-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.7. Enabling GSSAPI authentication for sudo on an IdM client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_enabling-gssapi-authentication-and-enforcing-kerberos-authentication-indicators-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_enabling-gssapi-authentication-and-enforcing-kerberos-authentication-indicators-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.8. Enabling GSSAPI authentication and enforcing Kerberos authentication indicators for sudo on an IdM client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ref_sssd-options-controlling-gssapi-authentication-for-pam-services_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ref_sssd-options-controlling-gssapi-authentication-for-pam-services_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.9. SSSD options controlling GSSAPI authentication for PAM services</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#proc_troubleshooting-gssapi-authentication-for-sudo_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-proc_troubleshooting-gssapi-authentication-for-sudo_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.10. Troubleshooting GSSAPI authentication for sudo</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-Ansible-playbook-to-ensure-sudo-access-for-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-Ansible-playbook-to-ensure-sudo-access-for-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" data-v-b883c74f>20.11. Using an Ansible playbook to ensure sudo access for an IdM user on an IdM client</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>21. Ensuring the presence of host-based access control rules in IdM using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Ensuring the presence of host-based access control rules in IdM using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#host-based-access-control-rules-in-idm_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-host-based-access-control-rules-in-idm_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks" data-v-b883c74f>21.1. Host-based access control rules in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-hbac-rule-in-idm-using-an-ansible-playbook_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-hbac-rule-in-idm-using-an-ansible-playbook_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks" data-v-b883c74f>21.2. Ensuring the presence of an HBAC rule in IdM using an Ansible playbook</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>22. Managing IdM certificates using Ansible</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Managing IdM certificates using Ansible</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible" data-v-b883c74f>22.1. Using Ansible to request SSL certificates for IdM hosts, services and users</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible" data-v-b883c74f>22.2. Using Ansible to revoke SSL certificates for IdM hosts, services and users</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible" data-v-b883c74f>22.3. Using Ansible to restore SSL certificates for IdM users, hosts, and services</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible" data-v-b883c74f>22.4. Using Ansible to retrieve SSL certificates for IdM users, hosts, and services</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--vaults-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="vaults-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>23. Vaults in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#vaults-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-vaults-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Vaults in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#vaults-and-their-benefits_vaults-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-vaults-and-their-benefits_vaults-in-idm" data-v-b883c74f>23.1. Vaults and their benefits</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#vault-owners-members-and-administrators_vaults-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-vault-owners-members-and-administrators_vaults-in-idm" data-v-b883c74f>23.2. Vault owners, members, and administrators</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#standard-symmetric-and-asymmetric-vaults_vaults-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-standard-symmetric-and-asymmetric-vaults_vaults-in-idm" data-v-b883c74f>23.3. Standard, symmetric, and asymmetric vaults</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#user-service-and-shared-vaults_vaults-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-user-service-and-shared-vaults_vaults-in-idm" data-v-b883c74f>23.4. User, service, and shared vaults</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#vault-containers_vaults-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-vault-containers_vaults-in-idm" data-v-b883c74f>23.5. Vault containers</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#basic-idm-vault-commands_vaults-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-basic-idm-vault-commands_vaults-in-idm" data-v-b883c74f>23.6. Basic IdM vault commands</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-installing-the-key-recovery-authority-component-in-idm_vaults-in-idm" data-v-b883c74f>23.7. Installing the Key Recovery Authority in IdM</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>24. Using Ansible to manage IdM user vaults: storing and retrieving secrets</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to manage IdM user vaults: storing and retrieving secrets</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" data-v-b883c74f>24.1. Ensuring the presence of a standard user vault in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#archiving-a-secret-in-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-archiving-a-secret-in-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" data-v-b883c74f>24.2. Archiving a secret in a standard user vault in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#retrieving-a-secret-from-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-retrieving-a-secret-from-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" data-v-b883c74f>24.3. Retrieving a secret from a standard user vault in IdM using Ansible</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>25. Using Ansible to manage IdM service vaults: storing and retrieving secrets</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to manage IdM service vaults: storing and retrieving secrets</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" data-v-b883c74f>25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-member-services-to-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-adding-member-services-to-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" data-v-b883c74f>25.2. Adding member services to an asymmetric vault using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" data-v-b883c74f>25.3. Storing an IdM service secret in an asymmetric vault using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" data-v-b883c74f>25.4. Retrieving a service secret for an IdM service using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#changing-an-idm-service-vault-secret-when-compromised-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-changing-an-idm-service-vault-secret-when-compromised-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" data-v-b883c74f>25.5. Changing an IdM service vault secret when compromised using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_6" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional_resources_6" data-v-b883c74f>25.6. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>26. Ensuring the presence and absence of services in IdM using Ansible</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Ensuring the presence and absence of services in IdM using Ansible</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.1. Ensuring the presence of an HTTP service in IdM using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-multiple-services-in-idm-on-an-idm-client-using-a-single-ansible-task_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-multiple-services-in-idm-on-an-idm-client-using-a-single-ansible-task_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.2. Ensuring the presence of multiple services in IdM on an IdM client using a single Ansible task</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-http-service-in-idm-on-a-non-idm-client-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-http-service-in-idm-on-a-non-idm-client-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.3. Ensuring the presence of an HTTP service in IdM on a non-IdM client using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-http-service-on-an-idm-client-without-dns-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-http-service-on-an-idm-client-without-dns-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.4. Ensuring the presence of an HTTP service on an IdM client without DNS using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.5. Ensuring the presence of an externally signed certificate in an IdM service entry using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-create-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-create-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.6. Using an Ansible playbook to allow IdM users, groups, hosts, or host groups to create a keytab of a service</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-retrieve-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-retrieve-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.7. Using an Ansible playbook to allow IdM users, groups, hosts, or host groups to retrieve a keytab of a service</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-a-kerberos-principal-alias-of-a-service-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-a-kerberos-principal-alias-of-a-service-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.8. Ensuring the presence of a Kerberos principal alias of a service using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible" data-v-b883c74f>26.9. Ensuring the absence of an HTTP service in IdM using an Ansible playbook</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_7" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional_resources_7" data-v-b883c74f>26.10. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>27. Managing global DNS configuration in IdM using Ansible playbooks</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Managing global DNS configuration in IdM using Ansible playbooks</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#how-idm-ensures-that-global-forwarders-from-etc-resolv-conf-are-not-removed-by-networkmanager_managing-global-dns-configuration-in-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-how-idm-ensures-that-global-forwarders-from-etc-resolv-conf-are-not-removed-by-networkmanager_managing-global-dns-configuration-in-idm-using-ansible-playbooks" data-v-b883c74f>27.1. How IdM ensures that global forwarders from /etc/resolv.conf are not removed by NetworkManager</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks" data-v-b883c74f>27.2. Ensuring the presence of a DNS global forwarder in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks" data-v-b883c74f>27.3. Ensuring the absence of a DNS global forwarder in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks" data-v-b883c74f>27.4. The action: member option in ipadnsconfig ansible-freeipa modules</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks" data-v-b883c74f>27.5. DNS forward policies in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-ensure-that-the-forward-first-policy-is-set-in-idm-dns-global-configuration_managing-global-dns-configuration-in-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-ensure-that-the-forward-first-policy-is-set-in-idm-dns-global-configuration_managing-global-dns-configuration-in-idm-using-ansible-playbooks" data-v-b883c74f>27.6. Using an Ansible playbook to ensure that the forward first policy is set in IdM DNS global configuration</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-ensure-that-global-forwarders-are-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-ensure-that-global-forwarders-are-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks" data-v-b883c74f>27.7. Using an Ansible playbook to ensure that global forwarders are disabled in IdM DNS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-ensure-that-synchronization-of-forward-and-reverse-lookup-zones-is-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-ensure-that-synchronization-of-forward-and-reverse-lookup-zones-is-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks" data-v-b883c74f>27.8. Using an Ansible playbook to ensure that synchronization of forward and reverse lookup zones is disabled in IdM DNS</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>28. Using Ansible playbooks to manage IdM DNS zones</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible playbooks to manage IdM DNS zones</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#supported-dns-zone-types_using-ansible-playbooks-to-manage-idm-dns-zones" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-supported-dns-zone-types_using-ansible-playbooks-to-manage-idm-dns-zones" data-v-b883c74f>28.1. Supported DNS zone types</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones" data-v-b883c74f>28.2. Configuration attributes of primary IdM DNS zones</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-create-a-primary-zone-in-idm-dns_using-ansible-playbooks-to-manage-idm-dns-zones" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-create-a-primary-zone-in-idm-dns_using-ansible-playbooks-to-manage-idm-dns-zones" data-v-b883c74f>28.3. Using Ansible to create a primary zone in IdM DNS</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-ensure-the-presence-of-a-primary-dns-zone-in-idm-with-multiple-variables_using-ansible-playbooks-to-manage-idm-dns-zones" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-ensure-the-presence-of-a-primary-dns-zone-in-idm-with-multiple-variables_using-ansible-playbooks-to-manage-idm-dns-zones" data-v-b883c74f>28.4. Using an Ansible playbook to ensure the presence of a primary DNS zone in IdM with multiple variables</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-an-ansible-playbook-to-ensure-the-presence-of-a-zone-for-reverse-dns-lookup-when-an-ip-address-is-given_using-ansible-playbooks-to-manage-idm-dns-zones" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-an-ansible-playbook-to-ensure-the-presence-of-a-zone-for-reverse-dns-lookup-when-an-ip-address-is-given_using-ansible-playbooks-to-manage-idm-dns-zones" data-v-b883c74f>28.5. Using an Ansible playbook to ensure the presence of a zone for reverse DNS lookup when an IP address is given</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>29. Using Ansible to manage DNS locations in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to manage DNS locations in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#dns-based-service-discovery_using-ansible-to-manage-dns-locations-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-dns-based-service-discovery_using-ansible-to-manage-dns-locations-in-idm" data-v-b883c74f>29.1. DNS-based service discovery</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm" data-v-b883c74f>29.2. Deployment considerations for DNS locations</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#dns-time-to-live-ttl_using-ansible-to-manage-dns-locations-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-dns-time-to-live-ttl_using-ansible-to-manage-dns-locations-in-idm" data-v-b883c74f>29.3. DNS time to live (TTL)</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm" data-v-b883c74f>29.4. Using Ansible to ensure an IdM location is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-an-idm-location-is-absent_using-ansible-to-manage-dns-locations-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-an-idm-location-is-absent_using-ansible-to-manage-dns-locations-in-idm" data-v-b883c74f>29.5. Using Ansible to ensure an IdM location is absent</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#additional_resources_8" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-additional_resources_8" data-v-b883c74f>29.6. Additional resources</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>30. Managing DNS forwarding in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Managing DNS forwarding in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#the-two-roles-of-an-idm-dns-server_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-the-two-roles-of-an-idm-dns-server_managing-dns-forwarding-in-idm" data-v-b883c74f>30.1. The two roles of an IdM DNS server</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#dns-forward-policies-in-idm_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-dns-forward-policies-in-idm_managing-dns-forwarding-in-idm" data-v-b883c74f>30.2. DNS forward policies in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-global-forwarder-in-the-idm-web-ui_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-adding-a-global-forwarder-in-the-idm-web-ui_managing-dns-forwarding-in-idm" data-v-b883c74f>30.3. Adding a global forwarder in the IdM Web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-global-forwarder-in-the-cli_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-adding-a-global-forwarder-in-the-cli_managing-dns-forwarding-in-idm" data-v-b883c74f>30.4. Adding a global forwarder in the CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-dns-forward-zone-in-the-idm-web-ui_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-adding-a-dns-forward-zone-in-the-idm-web-ui_managing-dns-forwarding-in-idm" data-v-b883c74f>30.5. Adding a DNS Forward Zone in the IdM Web UI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#adding-a-dns-forward-zone-in-the-cli_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-adding-a-dns-forward-zone-in-the-cli_managing-dns-forwarding-in-idm" data-v-b883c74f>30.6. Adding a DNS Forward Zone in the CLI</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#establishing-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-establishing-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" data-v-b883c74f>30.7. Establishing a DNS Global Forwarder in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" data-v-b883c74f>30.8. Ensuring the presence of a DNS global forwarder in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" data-v-b883c74f>30.9. Ensuring the absence of a DNS global forwarder in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-dns-global-forwarders-are-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-dns-global-forwarders-are-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm" data-v-b883c74f>30.10. Ensuring DNS Global Forwarders are disabled in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm" data-v-b883c74f>30.11. Ensuring the presence of a DNS Forward Zone in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-a-dns-forward-zone-has-multiple-forwarders-in-idm-using-ansible_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-a-dns-forward-zone-has-multiple-forwarders-in-idm-using-ansible_managing-dns-forwarding-in-idm" data-v-b883c74f>30.12. Ensuring a DNS Forward Zone has multiple forwarders in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-a-dns-forward-zone-is-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-a-dns-forward-zone-is-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm" data-v-b883c74f>30.13. Ensuring a DNS Forward Zone is disabled in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-absence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-absence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm" data-v-b883c74f>30.14. Ensuring the absence of a DNS Forward Zone in IdM using Ansible</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>31. Using Ansible to manage DNS records in IdM</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to manage DNS records in IdM</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#dns-records-in-idm_using-ansible-to-manage-dns-records-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-dns-records-in-idm_using-ansible-to-manage-dns-records-in-idm" data-v-b883c74f>31.1. DNS records in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#common-ipa-dnsrecord-options_using-ansible-to-manage-dns-records-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-common-ipa-dnsrecord-options_using-ansible-to-manage-dns-records-in-idm" data-v-b883c74f>31.2. Common ipa dnsrecord-* options</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-a-and-aaaa-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-a-and-aaaa-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" data-v-b883c74f>31.3. Ensuring the presence of A and AAAA DNS records in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-a-and-ptr-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-a-and-ptr-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" data-v-b883c74f>31.4. Ensuring the presence of A and PTR DNS records in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-multiple-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-multiple-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" data-v-b883c74f>31.5. Ensuring the presence of multiple DNS records in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-multiple-cname-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-multiple-cname-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" data-v-b883c74f>31.6. Ensuring the presence of multiple CNAME records in IdM using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#ensuring-the-presence-of-an-srv-record-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-ensuring-the-presence-of-an-srv-record-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" data-v-b883c74f>31.7. Ensuring the presence of an SRV record in IdM using Ansible</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>32. Using Ansible to automount NFS shares for IdM users</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to automount NFS shares for IdM users</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#autofs-and-automount-in-idm_using-ansible-to-automount-nfs-shares-for-idm-users" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-autofs-and-automount-in-idm_using-ansible-to-automount-nfs-shares-for-idm-users" data-v-b883c74f>32.1. Autofs and automount in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users" data-v-b883c74f>32.2. Setting up an NFS server with Kerberos in a Red Hat Identity Management domain</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users" data-v-b883c74f>32.3. Configuring automount locations, maps, and keys in IdM by using Ansible</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users" data-v-b883c74f>32.4. Using Ansible to add IdM users to a group that owns NFS shares</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users" data-v-b883c74f>32.5. Configuring automount on an IdM client</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#verifying-that-an-idm-user-can-access-nfs-shares-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-verifying-that-an-idm-user-can-access-nfs-shares-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users" data-v-b883c74f>32.6. Verifying that an IdM user can access NFS shares on an IdM client</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>33. Using Ansible to integrate IdM with NIS domains and netgroups</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to integrate IdM with NIS domains and netgroups</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#nis-and-its-benefits_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-nis-and-its-benefits_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" data-v-b883c74f>33.1. NIS and its benefits</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" data-v-b883c74f>33.2. NIS in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#nis-netgroups-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-nis-netgroups-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" data-v-b883c74f>33.3. NIS netgroups in IdM</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-netgroup-is-present_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-netgroup-is-present_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" data-v-b883c74f>33.4. Using Ansible to ensure that a netgroup is present</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-members-are-present-in-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-members-are-present-in-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" data-v-b883c74f>33.5. Using Ansible to ensure that members are present in a netgroup</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-member-is-absent-from-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-member-is-absent-from-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" data-v-b883c74f>33.6. Using Ansible to ensure that a member is absent from a netgroup</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-ensure-that-a-netgroup-is-absent_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-ensure-that-a-netgroup-is-absent_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" data-v-b883c74f>33.7. Using Ansible to ensure that a netgroup is absent</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#using-ansible-to-configure-hbac-and-sudo-rules-in-idm_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-configure-hbac-and-sudo-rules-in-idm_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>34. Using Ansible to configure HBAC and sudo rules in IdM</a></li><li class="item chapter" data-v-fa0dae77><details id="toc--using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>35. Using Ansible to delegate authentication for IdM users to external identity providers</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Using Ansible to delegate authentication for IdM users to external identity providers</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#con_the-benefits-of-connecting-idm-to-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-con_the-benefits-of-connecting-idm-to-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" data-v-b883c74f>35.1. The benefits of connecting IdM to an external IdP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#how-idm-incorporates-logins-via-external-idps_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-how-idm-incorporates-logins-via-external-idps_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" data-v-b883c74f>35.2. How IdM incorporates logins via external IdPs</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" data-v-b883c74f>35.3. Using Ansible to create a reference to an external identity provider</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" data-v-b883c74f>35.4. Using Ansible to enable an IdM user to authenticate via an external IdP</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#retrieving-an-idm-ticket-granting-ticket-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-retrieving-an-idm-ticket-granting-ticket-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" data-v-b883c74f>35.5. Retrieving an IdM ticket-granting ticket as an external IdP user</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#logging-in-to-an-idm-client-via-ssh-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-logging-in-to-an-idm-client-via-ssh-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" data-v-b883c74f>35.6. Logging in to an IdM client via SSH as an external IdP user</a></li><!--]--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#the-provider-option-in-the-ipaidp-ansible-module_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-the-provider-option-in-the-ipaidp-ansible-module_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" data-v-b883c74f>35.7. The provider option in the ipaidp Ansible module</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><details id="toc--integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77><summary class="heading chapter-title" id="integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management--summary" data-v-fa0dae77>36. Joining RHEL systems to an Active Directory by using RHEL system roles</summary><ol class="sub-nav" data-v-fa0dae77><li class="item sub-chapter" data-v-fa0dae77><a class="link sub-chapter-title chapter-landing-page" href="#integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management" data-v-fa0dae77>Joining RHEL systems to an Active Directory by using RHEL system roles</a></li><!--[--><!--[--><li class="item sub-chapter" data-v-b883c74f><a class="link sub-chapter-title" href="#connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles" id="sub-link-to-using_ansible_to_install_and_manage_identity_management-connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles" data-v-b883c74f>36.1. Joining RHEL to an Active Directory domain by using the ad_integration RHEL system role</a></li><!--]--><!--]--></ol></details></li><li class="item chapter" data-v-fa0dae77><a class="link" href="#idm140464232589344" id="chapter-landing--using_ansible_to_install_and_manage_identity_management-idm140464232589344" data-v-fa0dae77>Legal Notice</a></li><!--]--></ol></nav><!----></div></div></aside><article class="content span-xs-12 span-sm-6 span-md-12 span-lg-7" aria-live="polite" data-v-8589d091><!----><div lang="en-us" xml:lang="en-us" class="docs-content-container" data-v-8589d091><!----><!----><h1 data-id="content_chapter" class="chapter-title" data-v-8589d091>Using Ansible to install and manage Identity Management</h1><hr class="line-below-chp" data-v-8589d091><section class="rhdocs" data-v-8589d091><body><div xml:lang="en-US" class="book" id="idm140464245800272"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red Hat Enterprise Linux</span> <span class="productnumber">9</span></div><div><h3 class="subtitle">Using Ansible to maintain an IdM environment</h3></div><div><div xml:lang="en-US" class="authorgroup"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div><a href="#idm140464232589344">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				Red Hat provides the <code class="literal">ansible-freeipa</code> package to enable administrators to run Red Hat Identity Management (IdM) by using Ansible. You can use playbooks to install IdM and manage users, groups, hosts, access control, and configuration settings.
			</div></div></div></div><hr></div><section class="preface" id="proc_providing-feedback-on-red-hat-documentation_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Providing feedback on Red Hat documentation</h2></div></div></div><p class="_abstract _abstract">
			We appreciate your feedback on our documentation. Let us know how we can improve it.
		</p><div class="orderedlist"><p class="title"><strong>Submitting feedback through Jira (account required)</strong></p><ol class="orderedlist" type="1"><li class="listitem">
					Log in to the <a class="link" href="https://issues.redhat.com/projects/RHELDOCS/issues">Jira</a> website.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> in the top navigation bar
				</li><li class="listitem">
					Enter a descriptive title in the <span class="strong strong"><strong>Summary</strong></span> field.
				</li><li class="listitem">
					Enter your suggestion for improvement in the <span class="strong strong"><strong>Description</strong></span> field. Include links to the relevant parts of the documentation.
				</li><li class="listitem">
					Click <span class="strong strong"><strong>Create</strong></span> at the bottom of the dialogue.
				</li></ol></div></section><section class="chapter" id="ansible-terminology_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 1. Ansible terminology</h2></div></div></div><p>
			The chapters in this title use the official Ansible terminology. If you are not familiar with the terminology, read the <a class="link" href="https://docs.ansible.com/">official Ansible upstream documentation</a> before proceeding, especially the following sections:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The <a class="link" href="https://docs.ansible.com/ansible/latest/network/getting_started/basic_concepts.html">Basic concepts in Ansible</a> section provides an overview of the most commonly used concepts in Ansible.
				</li><li class="listitem">
					The <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/index.html">User guide</a> outlines the most common situations and questions when starting to use Ansible, such as using the command line; working with an inventory; interacting with data; writing tasks, plays, and playbooks; and executing playbooks.
				</li><li class="listitem">
					<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#intro-inventory">How to build your inventory</a> offers tips on how to design your inventory. An inventory is a list or a group of lists that Ansible uses to work against multiple managed nodes or hosts in your infrastructure.
				</li><li class="listitem">
					<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_intro.html">Intro to playbooks</a> introduces the concept of an Ansible playbook as a repeatable and re-usable system for managing configurations, deploying machines, and deploying complex applications.
				</li><li class="listitem">
					The <a class="link" href="https://docs.ansible.com/ansible/2.9/user_guide/playbooks_reuse_roles.html">Ansible roles</a> section explains how to automate loading variables, tasks, and handlers based on a known file structure.
				</li><li class="listitem">
					The <a class="link" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html">Glossary</a> explains terms that are used elsewhere in the Ansible documentation.
				</li></ul></div></section><section class="chapter" id="installing-an-Identity-Management-server-using-an-Ansible-playbook_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 2. Installing an Identity Management server using an Ansible playbook</h2></div></div></div><p>
			The following sections describe how to configure a system as an IdM server by using <a class="link" href="https://www.ansible.com/">Ansible</a>. Configuring a system as an IdM server establishes an IdM domain and enables the system to offer IdM services to IdM clients. The deployment is managed by the <code class="literal">ipaserver</code> Ansible role.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					You understand <a class="link" href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> and IdM concepts:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							Ansible roles
						</li><li class="listitem">
							Ansible nodes
						</li><li class="listitem">
							Ansible inventory
						</li><li class="listitem">
							Ansible tasks
						</li><li class="listitem">
							Ansible modules
						</li><li class="listitem">
							Ansible plays and playbooks
						</li></ul></div></li></ul></div><section class="section" id="ansible-and-its-advantages-for-installing-IdM_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.1. Ansible and its advantages for installing IdM</h3></div></div></div><p>
				Ansible is an automation tool used to configure systems, deploy software, and perform rolling updates. Ansible includes support for Identity Management (IdM), and you can use Ansible modules to automate installation tasks such as the setup of an IdM server, replica, client, or an entire IdM topology.
			</p><h5 id="advantages_of_using_ansible_to_install_idm">Advantages of using Ansible to install IdM</h5><p>
				The following list presents advantages of installing Identity Management using Ansible in contrast to manual installation.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You do not need to log into the managed node.
					</li><li class="listitem">
						You do not need to configure settings on each host to be deployed individually. Instead, you can have one inventory file to deploy a complete cluster.
					</li><li class="listitem">
						You can reuse an inventory file later for management tasks, for example to add users and hosts. You can reuse an inventory file even for such tasks as are not related to IdM.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/blog/automating-red-hat-identity-management-installation">Automating Red Hat Identity Management installation</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/planning_identity_management/index">Planning Identity Management</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#preparing-the-system-for-ipa-server-installation_installing-identity-management">Preparing the system for IdM server installation</a>
					</li></ul></div></section><section class="section" id="installing-the-ansible-freeipa-package_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.2. Installing the ansible-freeipa package</h3></div></div></div><p>
				The following procedure describes how to install the the <code class="literal package">ansible-freeipa</code> roles.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Ensure that the controller is a Red Hat Enterprise Linux system with a valid subscription. If this is not the case, see the official Ansible documentation <a class="link" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html">Installation guide</a> for alternative installation instructions.
					</li><li class="listitem">
						Ensure that you can reach the managed node over the <code class="literal">SSH</code> protocol from the controller. Check that the managed node is listed in the <code class="literal">/root/.ssh/known_hosts</code> file of the controller.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Procedure</strong></p><p>
					Run the following procedure on the Ansible controller.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Enable the required repository:
					</p><pre class="literallayout"># <span class="strong strong"><strong>subscription-manager repos --enable rhel-9-for-x86_64-appstream-rpms</strong></span></pre></li><li class="listitem"><p class="simpara">
						Install the IdM Ansible roles:
					</p><pre class="literallayout"># <span class="strong strong"><strong>dnf install ansible-freeipa</strong></span></pre></li></ol></div><p>
				The roles are installed to the <code class="literal">/usr/share/ansible/roles/</code> directory.
			</p></section><section class="section" id="ansible-roles-location-in-the-file-system_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.3. Ansible roles location in the file system</h3></div></div></div><p>
				By default, the <code class="literal">ansible-freeipa</code> roles are installed to the <code class="literal">/usr/share/ansible/roles/</code> directory. The structure of the <code class="literal">ansible-freeipa</code> package is as follows:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						The <code class="literal">/usr/share/ansible/roles/</code> directory stores the <code class="literal">ipaserver</code>, <code class="literal">ipareplica</code>, and <code class="literal">ipaclient</code> roles on the Ansible controller. Each role directory stores examples, a basic overview, the license and documentation about the role in a <code class="literal">README.md</code> Markdown file.
					</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/ansible/roles/</strong></span>
ipaclient
ipareplica
ipaserver</pre></li><li class="listitem"><p class="simpara">
						The <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory stores the documentation about individual roles and the topology in <code class="literal">README.md</code> Markdown files. It also stores the <code class="literal">playbooks/</code> subdirectory.
					</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/doc/ansible-freeipa/</strong></span>
playbooks
README-client.md
README.md
README-replica.md
README-server.md
README-topology.md</pre></li><li class="listitem"><p class="simpara">
						The <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/</code> directory stores the example playbooks:
					</p><pre class="literallayout">[root@server]# <span class="strong strong"><strong>ls -1 /usr/share/doc/ansible-freeipa/playbooks/</strong></span>
install-client.yml
install-cluster.yml
install-replica.yml
install-server.yml
uninstall-client.yml
uninstall-cluster.yml
uninstall-replica.yml
uninstall-server.yml</pre></li></ul></div></section><section class="section" id="setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-integrated-ca-as-the-root-ca_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.4. Setting the parameters for a deployment with an integrated DNS and an integrated CA as the root CA</h3></div></div></div><p>
				Complete this procedure to configure the inventory file for installing an IdM server with an integrated CA as the root CA in an environment that uses the IdM integrated DNS solution.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The inventory in this procedure uses the <code class="literal">INI</code> format. You can, alternatively, use the <code class="literal">YAML</code> or <code class="literal">JSON</code> formats.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a <code class="literal">~/MyPlaybooks/</code> directory:
					</p><pre class="literallayout">$ mkdir MyPlaybooks</pre></li><li class="listitem">
						Create a <code class="literal">~/MyPlaybooks/inventory</code> file.
					</li><li class="listitem"><p class="simpara">
						Open the inventory file for editing. Specify the fully-qualified domain names (<code class="literal">FQDN</code>) of the host you want to use as an IdM server. Ensure that the <code class="literal">FQDN</code> meets the following criteria:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Only alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
							</li><li class="listitem">
								The host name must be all lower-case.
							</li></ul></div></li><li class="listitem">
						Specify the IdM domain and realm information.
					</li><li class="listitem"><p class="simpara">
						Specify that you want to use integrated DNS by adding the following option:
					</p><pre class="literallayout"><code class="literal">ipaserver_setup_dns=true</code></pre></li><li class="listitem"><p class="simpara">
						Specify the DNS forwarding settings. Choose one of the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Use the <code class="literal">ipaserver_auto_forwarders=true</code> option if you want the installer to use forwarders from the <code class="literal">/etc/resolv.conf</code> file. Do not use this option if the nameserver specified in the <code class="literal">/etc/resolv.conf</code> file is the localhost 127.0.0.1 address or if you are on a virtual private network and the DNS servers you are using are normally unreachable from the public internet.
							</li><li class="listitem">
								Use the <code class="literal">ipaserver_forwarders</code> option to specify your forwarders manually. The installation process adds the forwarder IP addresses to the <code class="literal">/etc/named.conf</code> file on the installed IdM server.
							</li><li class="listitem"><p class="simpara">
								Use the <code class="literal">ipaserver_no_forwarders=true</code> option to configure root DNS servers to be used instead.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									With no DNS forwarders, your environment is isolated, and names from other DNS domains in your infrastructure are not resolved.
								</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
						Specify the DNS reverse record and zone settings. Choose from the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Use the <code class="literal">ipaserver_allow_zone_overlap=true</code> option to allow the creation of a (reverse) zone even if the zone is already resolvable.
							</li><li class="listitem">
								Use the <code class="literal">ipaserver_reverse_zones</code> option to specify your reverse zones manually.
							</li><li class="listitem"><p class="simpara">
								Use the <code class="literal">ipaserver_no_reverse=true</code> option if you do not want the installer to create a reverse DNS zone.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Using IdM to manage reverse zones is optional. You can use an external DNS service for this purpose instead.
								</p></div></rh-alert></li></ul></div></li><li class="listitem">
						Specify the passwords for <code class="literal">admin</code> and for the <code class="literal">Directory Manager</code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.
					</li><li class="listitem"><p class="simpara">
						Optional: Specify a custom <code class="literal">firewalld</code> zone to be used by the IdM server. If you do not set a custom zone, IdM will add its services to the default <code class="literal">firewalld</code> zone. The predefined default zone is <code class="literal">public</code>.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The specified <code class="literal">firewalld</code> zone must exist and be permanent.
						</p></div></rh-alert><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (excluding the passwords)</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=true
ipaserver_auto_forwarders=true
[...]</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (including the passwords)</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=true
ipaserver_auto_forwarders=true
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234

[...]</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with a custom <code class="literal">firewalld</code> zone</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=true
ipaserver_auto_forwarders=true
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234
<span class="strong strong"><strong>ipaserver_firewalld_zone=<span class="emphasis"><em>custom zone</em></span></strong></span></pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example playbook to set up an IdM server using admin and Directory Manager passwords stored in an Ansible Vault file</strong></p><p>

</p><pre class="literallayout">---
- name: Playbook to configure IPA server
  hosts: ipaserver
  become: true
  vars_files:
  - playbook_sensitive_data.yml

  roles:
  - role: ipaserver
    state: present</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example playbook to set up an IdM server using admin and Directory Manager passwords from an inventory file</strong></p><p>

</p><pre class="literallayout">---
- name: Playbook to configure IPA server
  hosts: ipaserver
  become: true

  roles:
  - role: ipaserver
    state: present</pre>

						<p></p></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						man <code class="literal">ipa-server-install(1)</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-server.md</code>
					</li></ul></div></section><section class="section" id="setting-the-parameters-for-a-deployment-with-external-dns-and-an-integrated-ca-as-the-root-ca_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.5. Setting the parameters for a deployment with external DNS and an integrated CA as the root CA</h3></div></div></div><p>
				Complete this procedure to configure the inventory file for installing an IdM server with an integrated CA as the root CA in an environment that uses an external DNS solution.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The inventory file in this procedure uses the <code class="literal">INI</code> format. You can, alternatively, use the <code class="literal">YAML</code> or <code class="literal">JSON</code> formats.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a <code class="literal">~/MyPlaybooks/</code> directory:
					</p><pre class="literallayout">$ mkdir MyPlaybooks</pre></li><li class="listitem">
						Create a <code class="literal">~/MyPlaybooks/inventory</code> file.
					</li><li class="listitem"><p class="simpara">
						Open the inventory file for editing. Specify the fully-qualified domain names (<code class="literal">FQDN</code>) of the host you want to use as an IdM server. Ensure that the <code class="literal">FQDN</code> meets the following criteria:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Only alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
							</li><li class="listitem">
								The host name must be all lower-case.
							</li></ul></div></li><li class="listitem">
						Specify the IdM domain and realm information.
					</li><li class="listitem">
						Make sure that the <code class="literal">ipaserver_setup_dns</code> option is set to <code class="literal">no</code> or that it is absent.
					</li><li class="listitem">
						Specify the passwords for <code class="literal">admin</code> and for the <code class="literal">Directory Manager</code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.
					</li><li class="listitem"><p class="simpara">
						Optional: Specify a custom <code class="literal">firewalld</code> zone to be used by the IdM server. If you do not set a custom zone, IdM will add its services to the default <code class="literal">firewalld</code> zone. The predefined default zone is <code class="literal">public</code>.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The specified <code class="literal">firewalld</code> zone must exist and be permanent.
						</p></div></rh-alert><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (excluding the passwords)</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=no
[...]</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (including the passwords)</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=no
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234

[...]</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with a custom <code class="literal">firewalld</code> zone</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=no
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234
<span class="strong strong"><strong>ipaserver_firewalld_zone=<span class="emphasis"><em>custom zone</em></span></strong></span></pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example playbook to set up an IdM server using admin and Directory Manager passwords stored in an Ansible Vault file</strong></p><p>

</p><pre class="literallayout">---
- name: Playbook to configure IPA server
  hosts: ipaserver
  become: true
  vars_files:
  - playbook_sensitive_data.yml

  roles:
  - role: ipaserver
    state: present</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example playbook to set up an IdM server using admin and Directory Manager passwords from an inventory file</strong></p><p>

</p><pre class="literallayout">---
- name: Playbook to configure IPA server
  hosts: ipaserver
  become: true

  roles:
  - role: ipaserver
    state: present</pre>

						<p></p></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						man <code class="literal">ipa-server-install(1)</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-server.md</code>
					</li></ul></div></section><section class="section" id="deploying-an-IdM-server-with-an-integrated-CA-using-an-Ansible-playbook_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.6. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook</h3></div></div></div><p>
				Complete this procedure to deploy an IdM server with an integrated certificate authority (CA) as the root CA using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.
					</li><li class="listitem"><p class="simpara">
						You have set the parameters that correspond to your scenario by choosing one of the following procedures:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<a class="link" href="#setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-integrated-ca-as-the-root-ca_server-ansible" title="2.4. Setting the parameters for a deployment with an integrated DNS and an integrated CA as the root CA">Procedure with integrated DNS</a>
							</li><li class="listitem">
								<a class="link" href="#setting-the-parameters-for-a-deployment-with-external-dns-and-an-integrated-ca-as-the-root-ca_server-ansible" title="2.5. Setting the parameters for a deployment with external DNS and an integrated CA as the root CA">Procedure with external DNS</a>
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the Ansible playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-server.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Choose one of the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If your IdM deployment uses external DNS: add the DNS resource records contained in the <code class="literal">/tmp/ipa.system.records.UFRPto.db</code> file to the existing external DNS servers. The process of updating the DNS records varies depending on the particular DNS solution.
							</p><pre class="literallayout">...
Restarting the KDC
<span class="strong strong"><strong>Please add records in this file to your DNS system: /tmp/ipa.system.records.UFRBto.db</strong></span>
<span class="strong strong"><strong>Restarting the web server</strong></span>
...</pre></li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The server installation is not complete until you add the DNS records to the existing DNS servers.
						</p></div></rh-alert><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If your IdM deployment uses integrated DNS:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
										Add DNS delegation from the parent domain to the IdM DNS domain. For example, if the IdM DNS domain is <code class="literal"><span class="emphasis"><em>idm.example.com</em></span></code>, add a name server (NS) record to the <code class="literal">example.com</code> parent domain.
									</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
											Repeat this step each time after an IdM DNS server is installed.
										</p></div></rh-alert></li><li class="listitem">
										Add an <code class="literal">_ntp._udp</code> service (SRV) record for your time server to your IdM DNS. The presence of the SRV record for the time server of the newly-installed IdM server in IdM DNS ensures that future replica and client installations are automatically configured to synchronize with the time server used by this primary IdM server.
									</li></ul></div></li></ul></div></li></ol></div></section><section class="section" id="setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-external-ca-as-the-root-ca_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.7. Setting the parameters for a deployment with an integrated DNS and an external CA as the root CA</h3></div></div></div><p>
				Complete this procedure to configure the inventory file for installing an IdM server with an external CA as the root CA in an environment that uses the IdM integrated DNS solution.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The inventory file in this procedure uses the <code class="literal">INI</code> format. You can, alternatively, use the <code class="literal">YAML</code> or <code class="literal">JSON</code> formats.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a <code class="literal">~/MyPlaybooks/</code> directory:
					</p><pre class="literallayout">$ mkdir MyPlaybooks</pre></li><li class="listitem">
						Create a <code class="literal">~/MyPlaybooks/inventory</code> file.
					</li><li class="listitem"><p class="simpara">
						Open the inventory file for editing. Specify the fully-qualified domain names (<code class="literal">FQDN</code>) of the host you want to use as an IdM server. Ensure that the <code class="literal">FQDN</code> meets the following criteria:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Only alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
							</li><li class="listitem">
								The host name must be all lower-case.
							</li></ul></div></li><li class="listitem">
						Specify the IdM domain and realm information.
					</li><li class="listitem"><p class="simpara">
						Specify that you want to use integrated DNS by adding the following option:
					</p><pre class="literallayout"><code class="literal">ipaserver_setup_dns=true</code></pre></li><li class="listitem"><p class="simpara">
						Specify the DNS forwarding settings. Choose one of the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Use the <code class="literal">ipaserver_auto_forwarders=true</code> option if you want the installation process to use forwarders from the <code class="literal">/etc/resolv.conf</code> file. This option is not recommended if the nameserver specified in the <code class="literal">/etc/resolv.conf</code> file is the localhost 127.0.0.1 address or if you are on a virtual private network and the DNS servers you are using are normally unreachable from the public internet.
							</li><li class="listitem">
								Use the <code class="literal">ipaserver_forwarders</code> option to specify your forwarders manually. The installation process adds the forwarder IP addresses to the <code class="literal">/etc/named.conf</code> file on the installed IdM server.
							</li><li class="listitem"><p class="simpara">
								Use the <code class="literal">ipaserver_no_forwarders=true</code> option to configure root DNS servers to be used instead.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									With no DNS forwarders, your environment is isolated, and names from other DNS domains in your infrastructure are not resolved.
								</p></div></rh-alert></li></ul></div></li><li class="listitem"><p class="simpara">
						Specify the DNS reverse record and zone settings. Choose from the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Use the <code class="literal">ipaserver_allow_zone_overlap=true</code> option to allow the creation of a (reverse) zone even if the zone is already resolvable.
							</li><li class="listitem">
								Use the <code class="literal">ipaserver_reverse_zones</code> option to specify your reverse zones manually.
							</li><li class="listitem"><p class="simpara">
								Use the <code class="literal">ipaserver_no_reverse=true</code> option if you do not want the installation process to create a reverse DNS zone.
							</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Using IdM to manage reverse zones is optional. You can use an external DNS service for this purpose instead.
								</p></div></rh-alert></li></ul></div></li><li class="listitem">
						Specify the passwords for <code class="literal">admin</code> and for the <code class="literal">Directory Manager</code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.
					</li><li class="listitem"><p class="simpara">
						Optional: Specify a custom <code class="literal">firewalld</code> zone to be used by the IdM server. If you do not set a custom zone, IdM adds its services to the default <code class="literal">firewalld</code> zone. The predefined default zone is <code class="literal">public</code>.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The specified <code class="literal">firewalld</code> zone must exist and be permanent.
						</p></div></rh-alert><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (excluding the passwords)</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=true
ipaserver_auto_forwarders=true
[...]</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (including the passwords)</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=true
ipaserver_auto_forwarders=true
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234

[...]</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with a custom <code class="literal">firewalld</code> zone</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=true
ipaserver_auto_forwarders=true
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234
<span class="strong strong"><strong>ipaserver_firewalld_zone=<span class="emphasis"><em>custom zone</em></span></strong></span>

[...]</pre>

						<p></p></div></li><li class="listitem"><p class="simpara">
						Create a playbook for the first step of the installation. Enter instructions for generating the certificate signing request (CSR) and copying it from the controller to the managed node.
					</p><pre class="literallayout">---
- name: Playbook to configure IPA server Step 1
  hosts: ipaserver
  become: true
  vars_files:
  - playbook_sensitive_data.yml
  vars:
    ipaserver_external_ca: true

  roles:
  - role: ipaserver
    state: present

  post_tasks:
  - name: Copy CSR /root/ipa.csr from node to "{{ groups.ipaserver[0] + '-ipa.csr' }}"
    fetch:
      src: /root/ipa.csr
      dest: "{{ groups.ipaserver[0] + '-ipa.csr' }}"
      flat: true</pre></li><li class="listitem"><p class="simpara">
						Create another playbook for the final step of the installation.
					</p><pre class="literallayout">---
- name: Playbook to configure IPA server Step 2
  hosts: ipaserver
  become: true
  vars_files:
  - playbook_sensitive_data.yml
  vars:
    ipaserver_external_cert_files:
      - "/root/servercert20240601.pem"
      - "/root/cacert.pem"

  pre_tasks:
  - name: Copy "{{ groups.ipaserver[0] }}-{{ item }}" to "/root/{{ item }}" on node
    ansible.builtin.copy:
      src: "{{ groups.ipaserver[0] }}-{{ item }}"
      dest: "/root/{{ item }}"
      force: true
    with_items:
    - servercert20240601.pem
    - cacert.pem

  roles:
  - role: ipaserver
    state: present</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						man <code class="literal">ipa-server-install(1)</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-server.md</code>
					</li></ul></div></section><section class="section" id="setting-the-parameters-for-a-deployment-with-external-dns-and-an-external-ca-as-the-root-ca_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.8. Setting the parameters for a deployment with external DNS and an external CA as the root CA</h3></div></div></div><p>
				Complete this procedure to configure the inventory file for installing an IdM server with an external CA as the root CA in an environment that uses an external DNS solution.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The inventory file in this procedure uses the <code class="literal">INI</code> format. You can, alternatively, use the <code class="literal">YAML</code> or <code class="literal">JSON</code> formats.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a <code class="literal">~/MyPlaybooks/</code> directory:
					</p><pre class="literallayout">$ mkdir MyPlaybooks</pre></li><li class="listitem">
						Create a <code class="literal">~/MyPlaybooks/inventory</code> file.
					</li><li class="listitem"><p class="simpara">
						Open the inventory file for editing. Specify the fully-qualified domain names (<code class="literal">FQDN</code>) of the host you want to use as an IdM server. Ensure that the <code class="literal">FQDN</code> meets the following criteria:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Only alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.
							</li><li class="listitem">
								The host name must be all lower-case.
							</li></ul></div></li><li class="listitem">
						Specify the IdM domain and realm information.
					</li><li class="listitem">
						Make sure that the <code class="literal">ipaserver_setup_dns</code> option is set to <code class="literal">no</code> or that it is absent.
					</li><li class="listitem">
						Specify the passwords for <code class="literal">admin</code> and for the <code class="literal">Directory Manager</code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.
					</li><li class="listitem"><p class="simpara">
						Optional: Specify a custom <code class="literal">firewalld</code> zone to be used by the IdM server. If you do not set a custom zone, IdM will add its services to the default <code class="literal">firewalld</code> zone. The predefined default zone is <code class="literal">public</code>.
					</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The specified <code class="literal">firewalld</code> zone must exist and be permanent.
						</p></div></rh-alert><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (excluding the passwords)</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=no
[...]</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with the required server information (including the passwords)</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=no
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234

[...]</pre>

						<p></p></div><div class="formalpara"><p class="title"><strong>Example of an inventory file with a custom <code class="literal">firewalld</code> zone</strong></p><p>

</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[ipaserver:vars]
ipaserver_domain=idm.example.com
ipaserver_realm=IDM.EXAMPLE.COM
ipaserver_setup_dns=no
ipaadmin_password=MySecretPassword123
ipadm_password=MySecretPassword234
<span class="strong strong"><strong>ipaserver_firewalld_zone=<span class="emphasis"><em>custom zone</em></span></strong></span>

[...]</pre>

						<p></p></div></li><li class="listitem"><p class="simpara">
						Create a playbook for the first step of the installation. Enter instructions for generating the certificate signing request (CSR) and copying it from the controller to the managed node.
					</p><pre class="literallayout">---
- name: Playbook to configure IPA server Step 1
  hosts: ipaserver
  become: true
  vars_files:
  - playbook_sensitive_data.yml
  vars:
    ipaserver_external_ca: true

  roles:
  - role: ipaserver
    state: present

  post_tasks:
  - name: Copy CSR /root/ipa.csr from node to "{{ groups.ipaserver[0] + '-ipa.csr' }}"
    fetch:
      src: /root/ipa.csr
      dest: "{{ groups.ipaserver[0] + '-ipa.csr' }}"
      flat: true</pre></li><li class="listitem"><p class="simpara">
						Create another playbook for the final step of the installation.
					</p><pre class="literallayout">---
- name: Playbook to configure IPA server Step 2
  hosts: ipaserver
  become: true
  vars_files:
  - playbook_sensitive_data.yml
  vars:
    ipaserver_external_cert_files:
      - "/root/servercert20240601.pem"
      - "/root/cacert.pem"

  pre_tasks:
  - name: Copy "{{ groups.ipaserver[0] }}-{{ item }}" to "/root/{{ item }}" on node
    ansible.builtin.copy:
      src: "{{ groups.ipaserver[0] }}-{{ item }}"
      dest: "/root/{{ item }}"
      force: true
    with_items:
    - servercert20240601.pem
    - cacert.pem

  roles:
  - role: ipaserver
    state: present</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_installing-an-ipa-server-without-dns-with-external-ca_installing-identity-management">Installing an IdM server: Without integrated DNS, with an external CA as the root CA</a>
					</li><li class="listitem">
						man <code class="literal">ipa-server-install(1)</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-server.md</code>
					</li></ul></div></section><section class="section" id="deploying-an-IdM-server-with-an-external-CA-using-an-Ansible-playbook_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.9. Deploying an IdM server with an external CA as the root CA using an Ansible playbook</h3></div></div></div><p>
				Complete this procedure to deploy an IdM server with an external certificate authority (CA) as the root CA using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.
					</li><li class="listitem"><p class="simpara">
						You have set the parameters that correspond to your scenario by choosing one of the following procedures:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<a class="link" href="#setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-external-ca-as-the-root-ca_server-ansible" title="2.7. Setting the parameters for a deployment with an integrated DNS and an external CA as the root CA">Procedure with integrated DNS</a>
							</li><li class="listitem">
								<a class="link" href="#setting-the-parameters-for-a-deployment-with-external-dns-and-an-external-ca-as-the-root-ca_server-ansible" title="2.8. Setting the parameters for a deployment with external DNS and an external CA as the root CA">Procedure with external DNS</a>
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Run the Ansible playbook with the instructions for the first step of the installation, for example <code class="literal">install-server-step1.yml</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-server-step1.yml</strong></span></pre></li><li class="listitem">
						Locate the <code class="literal">ipa.csr</code> certificate signing request file on the controller and submit it to the external CA.
					</li><li class="listitem">
						Place the IdM CA certificate signed by the external CA in the controller file system so that the playbook in the next step can find it.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook with the instructions for the final step of the installation, for example <code class="literal">install-server-step2.yml</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-server-step2.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Choose one of the following options:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If your IdM deployment uses external DNS: add the DNS resource records contained in the <code class="literal">/tmp/ipa.system.records.UFRPto.db</code> file to the existing external DNS servers. The process of updating the DNS records varies depending on the particular DNS solution.
							</p><pre class="literallayout">...
Restarting the KDC
<span class="strong strong"><strong>Please add records in this file to your DNS system: /tmp/ipa.system.records.UFRBto.db</strong></span>
<span class="strong strong"><strong>Restarting the web server</strong></span>
...</pre></li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							The server installation is not complete until you add the DNS records to the existing DNS servers.
						</p></div></rh-alert><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								If your IdM deployment uses integrated DNS:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
										Add DNS delegation from the parent domain to the IdM DNS domain. For example, if the IdM DNS domain is <code class="literal"><span class="emphasis"><em>idm.example.com</em></span></code>, add a name server (NS) record to the <code class="literal">example.com</code> parent domain.
									</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
											Repeat this step each time after an IdM DNS server is installed.
										</p></div></rh-alert></li><li class="listitem">
										Add an <code class="literal">_ntp._udp</code> service (SRV) record for your time server to your IdM DNS. The presence of the SRV record for the time server of the newly-installed IdM server in IdM DNS ensures that future replica and client installations are automatically configured to synchronize with the time server used by this primary IdM server.
									</li></ul></div></li></ul></div></li></ol></div></section><section class="section" id="uninstalling-an-idm-server-using-an-ansible-playbook_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.10. Uninstalling an IdM server using an Ansible playbook</h3></div></div></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In an existing Identity Management (IdM) deployment, <span class="strong strong"><strong>replica</strong></span> and <span class="strong strong"><strong>server</strong></span> are interchangeable terms.
				</p></div></rh-alert><p>
				Complete this procedure to uninstall an IdM replica using an Ansible playbook. In this example:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM configuration is uninstalled from <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
					</li><li class="listitem">
						<span class="strong strong"><strong>server123.idm.example.com</strong></span> and the associated host entry are removed from the IdM topology.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li><li class="listitem">
								For the <code class="literal">ipaserver_remove_from_topology</code> option to work, the system must be running on RHEL 9.3 or later.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						On the managed node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The system is running on RHEL 9.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>uninstall-server.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to uninstall an IdM replica
  hosts: ipaserver
  become: true

  roles:
  - role: ipaserver
    ipaserver_remove_from_domain: true
    state: absent</pre><p class="simpara">
						The <code class="literal">ipaserver_remove_from_domain</code> option unenrolls the host from the IdM topology.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							If the removal of server123.idm.example.com should lead to a disconnected topology, the removal will be aborted. For more information, see <a class="link" href="#using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible" title="2.11. Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology">Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology</a>.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Uninstall the replica:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/inventory &lt;path_to_playbooks_directory&gt;/uninstall-server.yml</strong></span></pre></li><li class="listitem">
						Ensure that all name server (NS) DNS records pointing to <span class="strong strong"><strong>server123.idm.example.com</strong></span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS. For more information on how to delete DNS records from IdM, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#deleting-dns-records-in-the-idm-cli_managing-dns-records-in-idm">Deleting DNS records in the IdM CLI</a>.
					</li></ol></div></section><section class="section" id="using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible"><div class="titlepage"><div><div><h3 class="title">2.11. Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology</h3></div></div></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In an existing Identity Management (IdM) deployment, <span class="strong strong"><strong>replica</strong></span> and <span class="strong strong"><strong>server</strong></span> are interchangeable terms.
				</p></div></rh-alert><p>
				Complete this procedure to uninstall an IdM replica using an Ansible playbook even if this results in a disconnected IdM topology. In the example, <span class="strong strong"><strong>server456.idm.example.com</strong></span> is used to remove the replica and the associated host entry with the FQDN of <span class="strong strong"><strong>server123.idm.example.com</strong></span> from the topology, leaving certain replicas disconnected from <span class="strong strong"><strong>server456.idm.example.com</strong></span> and the rest of the topology.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If removing a replica from the topology using only the <code class="literal">remove_server_from_domain</code> does not result in a disconnected topology, no other options are required. If the result is a disconnected topology, you must specify which part of the domain you want to preserve. In that case, you must do the following:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							Specify the <code class="literal">ipaserver_remove_on_server</code> value.
						</li><li class="listitem">
							Set <code class="literal">ipaserver_ignore_topology_disconnect</code> to True.
						</li></ul></div></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								The system is running on RHEL 9.3 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						On the managed node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The system is running on 9 or later.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>uninstall-server.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to uninstall an IdM replica
  hosts: ipaserver
  become: true

  roles:
  - role: ipaserver
    ipaserver_remove_from_domain: true
    ipaserver_remove_on_server: server456.idm.example.com
    ipaserver_ignore_topology_disconnect: true
    state: absent</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Under normal circumstances, if the removal of server123 does not result in a disconnected topology: if the value for <code class="literal">ipaserver_remove_on_server</code> is not set, the replica on which server123 is removed is automatically determined using the replication agreements of server123.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Uninstall the replica:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/uninstall-server.yml</strong></span></pre></li><li class="listitem">
						Ensure that all name server (NS) DNS records pointing to <span class="strong strong"><strong>server123.idm.example.com</strong></span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS. For more information on how to delete DNS records from IdM, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#deleting-dns-records-in-the-idm-cli_managing-dns-records-in-idm">Deleting DNS records in the IdM CLI</a>.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#inventory-basics-formats-hosts-and-groups">Inventory basics: formats, hosts, and groups</a>
					</li><li class="listitem">
						You can see sample Ansible playbooks for installing an IdM server and a list of possible variables in the <a class="link" href="https://github.com/freeipa/ansible-freeipa/tree/master/roles/ipaserver"><code class="literal">ansible-freeipa</code> upstream documentation</a>.
					</li></ul></div></section></section><section class="chapter" id="installing-an-Identity-Management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 3. Installing an Identity Management replica using an Ansible playbook</h2></div></div></div><p class="_abstract _abstract">
			Configuring a system as an IdM replica by using <a class="link" href="https://www.ansible.com/">Ansible</a> enrolls it into an IdM domain and enables the system to use IdM services on IdM servers in the domain.
		</p><p>
			The deployment is managed by the <code class="literal">ipareplica</code> Ansible role. The role can use the autodiscovery mode for identifying the IdM servers, domain and other settings. However, if you deploy multiple replicas in a tier-like model, with different groups of replicas being deployed at different times, you must define specific servers or replicas for each group.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-the-ansible-freeipa-package_server-ansible">ansible-freeipa</a> package on the Ansible control node.
				</li><li class="listitem">
					You understand the general <a class="link" href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> and IdM concepts.
				</li><li class="listitem">
					You have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/planning_identity_management/index#planning-the-replica-topology_planning-identity-management">planned the replica topology in your deployment</a>.
				</li></ul></div><section class="section" id="specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible"><div class="titlepage"><div><div><h3 class="title">3.1. Specifying the base, server and client variables for installing the IdM replica</h3></div></div></div><p>
				Complete this procedure to configure the inventory file for installing an IdM replica.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the inventory file for editing. Specify the fully-qualified domain names (FQDN) of the hosts to become IdM replicas. The FQDNs must be valid DNS names:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Only numbers, alphabetic characters, and hyphens (<code class="literal">-</code>) are allowed. For example, underscores are not allowed and can cause DNS failures.
							</li><li class="listitem"><p class="simpara">
								The host name must be all lower-case.
							</p><div class="formalpara"><p class="title"><strong>Example of a simple inventory hosts file with only the replicas' FQDN defined</strong></p><p>

</p><pre class="screen">[ipareplicas]
replica1.idm.example.com
replica2.idm.example.com
replica3.idm.example.com
[...]</pre>

								<p></p></div><p class="simpara">
								If the IdM server is already deployed and the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values.
							</p></li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: Provide additional information in the inventory file based on how you have designed your topology:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Scenario 1</span></dt><dd><p class="simpara">
									If you want to avoid autodiscovery and have all replicas listed in the <code class="literal">[ipareplicas]</code> section use a specific IdM server, set the server in the <code class="literal">[ipaservers]</code> section of the inventory file.
								</p><div class="formalpara"><p class="title"><strong>Example inventory hosts file with the FQDN of the IdM server and replicas defined</strong></p><p>

</p><pre class="screen">[ipaservers]
server.idm.example.com

[ipareplicas]
replica1.idm.example.com
replica2.idm.example.com
replica3.idm.example.com
[...]</pre>

									<p></p></div></dd><dt><span class="term">Scenario 2</span></dt><dd><p class="simpara">
									Alternatively, if you want to avoid autodiscovery but want to deploy specific replicas with specific servers, set the servers for specific replicas individually in the <code class="literal">[ipareplicas]</code> section in the inventory file.
								</p><div class="formalpara"><p class="title"><strong>Example inventory file with a specific IdM server defined for a specific replica</strong></p><p>

</p><pre class="screen">[ipaservers]
server.idm.example.com
replica1.idm.example.com

[ipareplicas]
replica2.idm.example.com
<span class="strong strong"><strong>replica3.idm.example.com ipareplica_servers=replica1.idm.example.com</strong></span></pre>

									<p></p></div><p class="simpara">
									In the example above, <code class="literal">replica3.idm.example.com</code> uses the already deployed <code class="literal">replica1.idm.example.com</code> as its replication source.
								</p></dd><dt><span class="term">Scenario 3</span></dt><dd><p class="simpara">
									If you are deploying several replicas in one batch and time is a concern to you, multitier replica deployment can be useful for you. Define specific groups of replicas in the inventory file, for example <code class="literal">[ipareplicas_tier1]</code> and <code class="literal">[ipareplicas_tier2]</code>, and design separate plays for each group in the <code class="literal">install-replica.yml</code> playbook.
								</p><div class="formalpara"><p class="title"><strong>Example inventory file with replica tiers defined</strong></p><p>

</p><pre class="screen">[ipaservers]
server.idm.example.com

<span class="strong strong"><strong>[ipareplicas_tier1]</strong></span>
replica1.idm.example.com

<span class="strong strong"><strong>[ipareplicas_tier2]</strong></span>
replica2.idm.example.com \ ipareplica_servers=replica1.idm.example.com,server.idm.example.com</pre>

									<p></p></div><p class="simpara">
									The first entry in <code class="literal">ipareplica_servers</code> will be used. The second entry will be used as a fallback option. When using multiple tiers for deploying IdM replicas, you must have separate tasks in the playbook to first deploy replicas from tier1 and then replicas from tier2:
								</p><div class="formalpara"><p class="title"><strong>Example of a playbook file with different plays for different replica groups</strong></p><p>

</p><pre class="screen">---
- name: Playbook to configure IPA replicas (tier1)
  hosts: ipareplicas_tier1
  become: true

  roles:
  - role: ipareplica
    state: present

- name: Playbook to configure IPA replicas (tier2)
  hosts: ipareplicas_tier2
  become: true

  roles:
  - role: ipareplica
    state: present</pre>

									<p></p></div></dd></dl></div></li><li class="listitem"><p class="simpara">
						Optional: Provide additional information regarding <code class="literal">firewalld</code> and DNS:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Scenario 1</span></dt><dd><p class="simpara">
									If you want the replica to use a specified <code class="literal">firewalld</code> zone, for example an internal one, you can specify it in the inventory file. If you do not set a custom zone, IdM will add its services to the default <code class="literal">firewalld</code> zone. The predefined default zone is <code class="literal">public</code>.
								</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
										The specified <code class="literal">firewalld</code> zone must exist and be permanent.
									</p></div></rh-alert><div class="formalpara"><p class="title"><strong>Example of a simple inventory hosts file with a custom <code class="literal">firewalld</code> zone</strong></p><p>

</p><pre class="screen">[ipaservers]
server.idm.example.com

[ipareplicas]
replica1.idm.example.com
replica2.idm.example.com
replica3.idm.example.com
[...]

[ipareplicas:vars]
<span class="strong strong"><strong>ipareplica_firewalld_zone=<span class="emphasis"><em>custom zone</em></span></strong></span></pre>

									<p></p></div></dd><dt><span class="term">Scenario 2</span></dt><dd><p class="simpara">
									If you want the replica to host the IdM DNS service, add the <span class="strong strong"><strong>ipareplica_setup_dns=true</strong></span> line to the <code class="literal">[ipareplicas:vars]</code> section. Additionally, specify if you want to use per-server DNS forwarders:
								</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
											To configure per-server forwarders, add the <code class="literal">ipareplica_forwarders</code> variable and a list of strings to the <code class="literal">[ipareplicas:vars]</code> section, for example: <span class="strong strong"><strong>ipareplica_forwarders=192.0.2.1,192.0.2.2</strong></span>
										</li><li class="listitem">
											To configure no per-server forwarders, add the following line to the <code class="literal">[ipareplicas:vars]</code> section: <span class="strong strong"><strong>ipareplica_no_forwarders=true</strong></span>.
										</li><li class="listitem">
											To configure per-server forwarders based on the forwarders listed in the <code class="literal">/etc/resolv.conf</code> file of the replica, add the <code class="literal">ipareplica_auto_forwarders</code> variable to the <code class="literal">[ipareplicas:vars]</code> section.
										</li></ul></div><div class="formalpara"><p class="title"><strong>Example inventory file with instructions to set up DNS and per-server forwarders on the replicas</strong></p><p>

</p><pre class="screen">[ipaservers]
server.idm.example.com

[ipareplicas]
replica1.idm.example.com
replica2.idm.example.com
replica3.idm.example.com
[...]

[ipareplicas:vars]
<span class="strong strong"><strong>ipareplica_setup_dns=true</strong></span>
<span class="strong strong"><strong>ipareplica_forwarders=192.0.2.1,192.0.2.2</strong></span></pre>

									<p></p></div></dd><dt><span class="term">Scenario 3</span></dt><dd><p class="simpara">
									Specify the DNS resolver using the <code class="literal">ipaclient_configure_dns_resolve</code> and <code class="literal">ipaclient_dns_servers</code> options (if available) to simplify cluster deployments. This is especially useful if your IdM deployment is using integrated DNS:
								</p><div class="formalpara"><p class="title"><strong>An inventory file snippet specifying a DNS resolver:</strong></p><p>

</p><pre class="screen">[...]
[ipaclient:vars]
ipaclient_configure_dns_resolver=true
ipaclient_dns_servers=192.168.100.1</pre>

									<p></p></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
										The <code class="literal">ipaclient_dns_servers</code> list must contain only IP addresses. Host names are not allowed.
									</p></div></rh-alert></dd></dl></div></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/ipareplica/README.md</code>
					</li></ul></div></section><section class="section" id="specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible"><div class="titlepage"><div><div><h3 class="title">3.2. Specifying the credentials for installing the IdM replica using an Ansible playbook</h3></div></div></div><p>
				Complete this procedure to configure the authorization for installing the IdM replica.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Specify the <span class="strong strong"><strong>password of a user authorized to deploy replicas</strong></span>, for example the IdM <code class="literal">admin</code>.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Red Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example <code class="literal">install-replica.yml</code>:
							</p><div class="formalpara"><p class="title"><strong>Example playbook file using principal from inventory file and password from an Ansible Vault file</strong></p><p>

</p><pre class="literallayout">- name: Playbook to configure IPA replicas
  hosts: ipareplicas
  become: true
  vars_files:
  - <code class="literal">playbook_sensitive_data.yml</code>

  roles:
  - role: ipareplica
    state: present</pre>

								<p></p></div><p class="simpara">
								For details how to use Ansible Vault, see the official <a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Ansible Vault</a> documentation.
							</p></li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								Less securely, provide the credentials of <code class="literal">admin</code> directly in the inventory file. Use the <code class="literal">ipaadmin_password</code> option in the <code class="literal">[ipareplicas:vars]</code> section of the inventory file. The inventory file and the <code class="literal">install-replica.yml</code> playbook file can then look as follows:
							</p><div class="formalpara"><p class="title"><strong>Example inventory hosts.replica file</strong></p><p>

</p><pre class="literallayout">[...]
[ipareplicas:vars]
<span class="strong strong"><strong>ipaadmin_password=Secret123</strong></span></pre>

								<p></p></div><div class="formalpara"><p class="title"><strong>Example playbook using principal and password from inventory file</strong></p><p>

</p><pre class="literallayout">- name: Playbook to configure IPA replicas
  hosts: ipareplicas
  become: true

  roles:
  - role: ipareplica
    state: present</pre>

								<p></p></div></li><li class="listitem"><p class="simpara">
								Alternatively but also less securely, provide the credentials of another user authorized to deploy a replica directly in the inventory file. To specify a different authorized user, use the <code class="literal">ipaadmin_principal</code> option for the user name, and the <code class="literal">ipaadmin_password</code> option for the password. The inventory file and the <code class="literal">install-replica.yml</code> playbook file can then look as follows:
							</p><div class="formalpara"><p class="title"><strong>Example inventory hosts.replica file</strong></p><p>

</p><pre class="literallayout">[...]
[ipareplicas:vars]
<span class="strong strong"><strong>ipaadmin_principal=my_admin</strong></span>
<span class="strong strong"><strong>ipaadmin_password=my_admin_secret123</strong></span></pre>

								<p></p></div><div class="formalpara"><p class="title"><strong>Example playbook using principal and password from inventory file</strong></p><p>

</p><pre class="literallayout">- name: Playbook to configure IPA replicas
  hosts: ipareplicas
  become: true

  roles:
  - role: ipareplica
    state: present</pre>

								<p></p></div></li></ul></div></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					As of RHEL 9.5, during the installation of an IdM replica, checking if the provided Kerberos principal has the required privilege also extends to checking user ID overrides. As a result, you can deploy a replica using the credentials of an AD administrator that is configured to act as an IdM administrator.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/ipareplica/README.md</code>
					</li></ul></div></section><section class="section" id="deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible"><div class="titlepage"><div><div><h3 class="title">3.3. Deploying an IdM replica using an Ansible playbook</h3></div></div></div><p>
				Complete this procedure to use an Ansible playbook to deploy an IdM replica.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.
					</li><li class="listitem">
						You have configured <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-replica-using-an-ansible-playbook_installing-identity-management#specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible">the inventory file for installing an IdM replica</a>.
					</li><li class="listitem">
						You have configured <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-replica-using-an-ansible-playbook_installing-identity-management#specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible">the authorization for installing the IdM replica</a>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Run the Ansible playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-replica.yml</strong></span></pre></li></ul></div></section><section class="section" id="uninstalling-an-idm-replica-using-an-ansible-playbook_replica-ansible"><div class="titlepage"><div><div><h3 class="title">3.4. Uninstalling an IdM replica using an Ansible playbook</h3></div></div></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In an existing Identity Management (IdM) deployment, <span class="strong strong"><strong>replica</strong></span> and <span class="strong strong"><strong>server</strong></span> are interchangeable terms. For information on how to uninstall an IdM server, see <a class="link" href="#uninstalling-an-idm-server-using-an-ansible-playbook_server-ansible" title="2.10. Uninstalling an IdM server using an Ansible playbook">Uninstalling an IdM server using an Ansible playbook</a> or <a class="link" href="#using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible" title="2.11. Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology">Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology</a>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/overview-of-identity-management-and-access-control-planning-identity-management#introduction-to-ipa-servers-and-clients_overview-of-idm-and-access-control">Introduction to IdM servers and clients</a>
					</li></ul></div></section></section><section class="chapter" id="installing-an-Identity-Management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 4. Installing an Identity Management client using an Ansible playbook</h2></div></div></div><p class="_abstract _abstract">
			Learn more about how to configure a system as an Identity Management (IdM) client by using <a class="link" href="https://www.ansible.com/">Ansible</a>. Configuring a system as an IdM client enrolls it into an IdM domain and enables the system to use IdM services on IdM servers in the domain.
		</p><p>
			The deployment is managed by the <code class="literal">ipaclient</code> Ansible role. By default, the role uses the autodiscovery mode for identifying the IdM servers, domain and other settings. The role can be modified to have the Ansible playbook use the settings specified, for example in the inventory file.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-the-ansible-freeipa-package_server-ansible">ansible-freeipa</a> package on the Ansible control node.
				</li><li class="listitem">
					You are using Ansible version 2.15 or later.
				</li><li class="listitem">
					You understand the general <a class="link" href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a> and IdM concepts.
				</li></ul></div><section class="section" id="setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible"><div class="titlepage"><div><div><h3 class="title">4.1. Setting the parameters of the inventory file for the autodiscovery client installation mode</h3></div></div></div><p>
				To install an Identity Management (IdM) client using an Ansible playbook, configure the target host parameters in an inventory file, for example <code class="literal">inventory</code>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The information about the host
					</li><li class="listitem">
						The authorization for the task
					</li></ul></div><p>
				The inventory file can be in one of many formats, depending on the inventory plugins you have. The <code class="literal">INI-like</code> format is one of Ansible’s defaults and is used in the examples below.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To use smart cards with the graphical user interface in RHEL, ensure that you include the <code class="literal">ipaclient_mkhomedir</code> variable in your Ansible playbook.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open your <code class="literal">inventory</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Specify the fully-qualified hostname (FQDN) of the host to become an IdM client. The fully qualified domain name must be a valid DNS name:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Only numbers, alphabetic characters, and hyphens (<code class="literal">-</code>) are allowed. For example, underscores are not allowed and can cause DNS failures.
							</li><li class="listitem">
								The host name must be all lower-case. No capital letters are allowed.
							</li></ul></div><p class="simpara">
						If the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values.
					</p><div class="formalpara"><p class="title"><strong>Example of a simple inventory hosts file with only the client FQDN defined</strong></p><p>

</p><pre class="screen">[ipaclients]
client.idm.example.com
[...]</pre>

						<p></p></div></li><li class="listitem"><p class="simpara">
						Specify the credentials for enrolling the client. The following authentication methods are available:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The <span class="strong strong"><strong>password of a user authorized to enroll clients</strong></span>. This is the default option.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
										Red Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example <code class="literal">install-client.yml</code>, directly:
									</p><div class="formalpara"><p class="title"><strong>Example playbook file using principal from inventory file and password from an Ansible Vault file</strong></p><p>

</p><pre class="screen">- name: Playbook to configure IPA clients with username/password
  hosts: ipaclients
  become: true
  vars_files:
  - <span class="strong strong"><strong>playbook_sensitive_data.yml</strong></span>

  roles:
  - role: ipaclient
    state: present</pre>

										<p></p></div></li><li class="listitem"><p class="simpara">
										Less securely, provide the credentials of <code class="literal">admin</code> using the <code class="literal">ipaadmin_password</code> option in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file. Alternatively, to specify a different authorized user, use the <code class="literal">ipaadmin_principal</code> option for the user name, and the <code class="literal">ipaadmin_password</code> option for the password. The <code class="literal">inventory/hosts</code> inventory file and the <code class="literal">install-client.yml</code> playbook file can then look as follows:
									</p><div class="formalpara"><p class="title"><strong>Example inventory hosts file</strong></p><p>

</p><pre class="screen">[...]
[ipaclients:vars]
<span class="strong strong"><strong>ipaadmin_principal=my_admin</strong></span>
<span class="strong strong"><strong>ipaadmin_password=Secret123</strong></span></pre>

										<p></p></div><div class="formalpara"><p class="title"><strong>Example Playbook using principal and password from inventory file</strong></p><p>

</p><pre class="screen">- name: Playbook to unconfigure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre>

										<p></p></div></li></ul></div></li><li class="listitem"><p class="simpara">
								The <span class="strong strong"><strong>client keytab</strong></span> from the previous enrollment if it is still available.
							</p><p class="simpara">
								This option is available if the system was previously enrolled as an Identity Management client. To use this authentication method, uncomment the <code class="literal">#ipaclient_keytab</code> option, specifying the path to the file storing the keytab, for example in the <code class="literal">[ipaclient:vars]</code> section of <code class="literal">inventory/hosts</code>.
							</p></li><li class="listitem"><p class="simpara">
								A <span class="strong strong"><strong>random, one-time password</strong></span> (OTP) to be generated during the enrollment. To use this authentication method, use the <code class="literal">ipaclient_use_otp=true</code> option in your inventory file. For example, you can uncomment the <code class="literal">ipaclient_use_otp=true</code> option in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file. Note that with OTP you must also specify one of the following options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The <span class="strong strong"><strong>password of a user authorized to enroll clients</strong></span>, for example by providing a value for <code class="literal">ipaadmin_password</code> in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file.
									</li><li class="listitem">
										The <span class="strong strong"><strong>admin keytab</strong></span>, for example by providing a value for <code class="literal">ipaadmin_keytab</code> in the <code class="literal">[ipaclients:vars]</code> section of <code class="literal">inventory/hosts</code>.
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Optional: Specify the DNS resolver using the <code class="literal">ipaclient_configure_dns_resolve</code> and <code class="literal">ipaclient_dns_servers</code> options (if available) to simplify cluster deployments. This is especially useful if your IdM deployment is using integrated DNS:
					</p><div class="formalpara"><p class="title"><strong>An inventory file snippet specifying a DNS resolver:</strong></p><p>

</p><pre class="screen">[...]
[ipaclients:vars]
ipaadmin_password: "{{ ipaadmin_password }}"
ipaclient_domain=idm.example.com
ipaclient_configure_dns_resolver=true
ipaclient_dns_servers=192.168.100.1</pre>

						<p></p></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							The <code class="literal">ipaclient_dns_servers</code> list must contain only IP addresses. Host names are not allowed.
						</p></div></rh-alert></li><li class="listitem">
						Starting with RHEL 9.3, you can also specify the <code class="literal">ipaclient_subid: true</code> option to have subid ranges configured for IdM users on the IdM level.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/ipaclient/README.md</code>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management/index#assembly_managing-subid-ranges-manually_configuring-and-managing-idm">Managing subID ranges manually</a>
					</li></ul></div></section><section class="section" id="setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible"><div class="titlepage"><div><div><h3 class="title">4.2. Setting the parameters of the inventory file when autodiscovery is not possible during client installation</h3></div></div></div><p>
				To install an Identity Management client using an Ansible playbook, configure the target host parameters in an inventory file, for example <code class="literal">inventory/hosts</code>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The information about the host, the IdM server and the IdM domain or the IdM realm
					</li><li class="listitem">
						The authorization for the task
					</li></ul></div><p>
				The inventory file can be in one of many formats, depending on the inventory plugins you have. The <code class="literal">INI-like</code> format is one of Ansible’s defaults and is used in the examples below.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To use smart cards with the graphical user interface in RHEL, ensure that you include the <code class="literal">ipaclient_mkhomedir</code> variable in your Ansible playbook.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Specify the fully-qualified hostname (FQDN) of the host to become an IdM client. The fully qualified domain name must be a valid DNS name:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Only numbers, alphabetic characters, and hyphens (<code class="literal">-</code>) are allowed. For example, underscores are not allowed and can cause DNS failures.
							</li><li class="listitem">
								The host name must be all lower-case. No capital letters are allowed.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Specify other options in the relevant sections of the <code class="literal">inventory/hosts</code> file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The FQDN of the servers in the <code class="literal">[ipaservers]</code> section to indicate which IdM server the client will be enrolled with
							</li><li class="listitem"><p class="simpara">
								One of the two following options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The <code class="literal">ipaclient_domain</code> option in the <code class="literal">[ipaclients:vars]</code> section to indicate the DNS domain name of the IdM server the client will be enrolled with
									</li><li class="listitem"><p class="simpara">
										The <code class="literal">ipaclient_realm</code> option in the <code class="literal">[ipaclients:vars]</code> section to indicate the name of the Kerberos realm controlled by the IdM server
									</p><div class="formalpara"><p class="title"><strong>Example of an inventory hosts file with the client FQDN, the server FQDN and the domain defined</strong></p><p>

</p><pre class="screen">[ipaclients]
<span class="strong strong"><strong>client.idm.example.com</strong></span>

[ipaservers]
<span class="strong strong"><strong>server.idm.example.com</strong></span>

[ipaclients:vars]
<span class="strong strong"><strong>ipaclient_domain=idm.example.com</strong></span>
[...]</pre>

										<p></p></div></li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						Specify the credentials for enrolling the client. The following authentication methods are available:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
								The <span class="strong strong"><strong>password of a user authorized to enroll clients</strong></span>. This is the default option.
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
										Red Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example <code class="literal">install-client.yml</code>, directly:
									</p><div class="formalpara"><p class="title"><strong>Example playbook file using principal from inventory file and password from an Ansible Vault file</strong></p><p>

</p><pre class="screen">- name: Playbook to configure IPA clients with username/password
  hosts: ipaclients
  become: true
  vars_files:
  - <span class="strong strong"><strong>playbook_sensitive_data.yml</strong></span>

  roles:
  - role: ipaclient
    state: present</pre>

										<p></p></div></li></ul></div></li><li class="listitem"><p class="simpara">
								Less securely, the credentials of <code class="literal">admin</code> to be provided using the <code class="literal">ipaadmin_password</code> option in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file. Alternatively, to specify a different authorized user, use the <code class="literal">ipaadmin_principal</code> option for the user name, and the <code class="literal">ipaadmin_password</code> option for the password. The <code class="literal">install-client.yml</code> playbook file can then look as follows:
							</p><div class="formalpara"><p class="title"><strong>Example inventory hosts file</strong></p><p>

</p><pre class="screen">[...]
[ipaclients:vars]
<span class="strong strong"><strong>ipaadmin_principal=my_admin</strong></span>
<span class="strong strong"><strong>ipaadmin_password=Secret123</strong></span></pre>

								<p></p></div><div class="formalpara"><p class="title"><strong>Example Playbook using principal and password from inventory file</strong></p><p>

</p><pre class="screen">- name: Playbook to unconfigure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre>

								<p></p></div></li><li class="listitem"><p class="simpara">
								The <span class="strong strong"><strong>client keytab</strong></span> from the previous enrollment if it is still available:
							</p><p class="simpara">
								This option is available if the system was previously enrolled as an Identity Management client. To use this authentication method, uncomment the <code class="literal">ipaclient_keytab</code> option, specifying the path to the file storing the keytab, for example in the <code class="literal">[ipaclient:vars]</code> section of <code class="literal">inventory/hosts</code>.
							</p></li><li class="listitem"><p class="simpara">
								A <span class="strong strong"><strong>random, one-time password</strong></span> (OTP) to be generated during the enrollment. To use this authentication method, use the <code class="literal">ipaclient_use_otp=true</code> option in your inventory file. For example, you can uncomment the <code class="literal">#ipaclient_use_otp=true</code> option in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file. Note that with OTP you must also specify one of the following options:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										The <span class="strong strong"><strong>password of a user authorized to enroll clients</strong></span>, for example by providing a value for <code class="literal">ipaadmin_password</code> in the <code class="literal">[ipaclients:vars]</code> section of the <code class="literal">inventory/hosts</code> file.
									</li><li class="listitem">
										The <span class="strong strong"><strong>admin keytab</strong></span>, for example by providing a value for <code class="literal">ipaadmin_keytab</code> in the <code class="literal">[ipaclients:vars]</code> section of <code class="literal">inventory/hosts</code>.
									</li></ul></div></li></ul></div></li><li class="listitem">
						Starting with RHEL 9.3, you can also specify the <code class="literal">ipaclient_subid: true</code> option to have subid ranges configured for IdM users on the IdM level.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/ipaclient/README.md</code>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management/index#assembly_managing-subid-ranges-manually_configuring-and-managing-idm">Managing subID ranges manually</a>
					</li></ul></div></section><section class="section" id="authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible"><div class="titlepage"><div><div><h3 class="title">4.3. Authorization options for IdM client enrollment using an Ansible playbook</h3></div></div></div><p>
				You can authorize IdM client enrollment by using any of the following methods:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A random, one-time password (OTP) + administrator password
					</li><li class="listitem">
						A random, one-time password (OTP) + an admin keytab
					</li><li class="listitem">
						The client keytab from the previous enrollment
					</li><li class="listitem">
						The password of a user authorized to enroll a client (<code class="literal">admin</code>) stored in an inventory file
					</li><li class="listitem">
						The password of a user authorized to enroll a client (<code class="literal">admin</code>) stored in an Ansible vault
					</li></ul></div><p>
				It is possible to have the OTP generated by an IdM administrator before the IdM client installation. In that case, you do not need any credentials for the installation other than the OTP itself.
			</p><p>
				The following are sample inventory files for these methods:
			</p><rh-table id="sample-inventory-file_client-ansible"><table class="lt-4-cols lt-7-rows"><caption>Table 4.1. Sample inventory files</caption><colgroup><col style="width: 29%; " class="col_1"><!--Empty--><col style="width: 71%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464247438784" scope="col">Authorization option</th><th align="left" valign="top" id="idm140464247437696" scope="col">Inventory file</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464247438784"> <p>
								A random, one-time password (OTP) + administrator password
							</p>
							 </td><td align="left" valign="top" headers="idm140464247437696">
<pre class="screen">[ipaclients:vars]
ipaadmin_password=Secret123
ipaclient_use_otp=true</pre>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464247438784"> <p>
								A random, one-time password (OTP)
							</p>
							 </td><td align="left" valign="top" headers="idm140464247437696">
<pre class="screen">[ipaclients:vars]
ipaclient_otp=&lt;W5YpARl=7M.&gt;</pre>
							 <p>
								This scenario assumes that the OTP was already generated by an IdM <code class="literal">admin</code> before the installation.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464247438784"> <p>
								A random, one-time password (OTP) + an admin keytab
							</p>
							 </td><td align="left" valign="top" headers="idm140464247437696">
<pre class="screen">[ipaclients:vars]
ipaadmin_keytab=/root/admin.keytab
ipaclient_use_otp=true</pre>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464247438784"> <p>
								The client keytab from the previous enrollment
							</p>
							 </td><td align="left" valign="top" headers="idm140464247437696">
<pre class="screen">[ipaclients:vars]
ipaclient_keytab=/root/krb5.keytab</pre>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464247438784"> <p>
								Password of an <code class="literal">admin</code> user stored in an inventory file
							</p>
							 </td><td align="left" valign="top" headers="idm140464247437696">
<pre class="screen">[ipaclients:vars]
ipaadmin_password=Secret123</pre>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464247438784"> <p>
								Password of an <code class="literal">admin</code> user stored in an Ansible vault file
							</p>
							 </td><td align="left" valign="top" headers="idm140464247437696">
<pre class="screen">[ipaclients:vars]
[...]</pre>
							 </td></tr></tbody></table></rh-table><p>
				If you are using the password of an <code class="literal">admin</code> user stored in an Ansible vault file, the corresponding playbook file must have an additional <code class="literal">vars_files</code> directive:
			</p><rh-table id="user-password-stored-in-ansible-vault_client-ansible"><table class="lt-4-cols lt-7-rows"><caption>Table 4.2. User password stored in an Ansible vault</caption><colgroup><col style="width: 29%; " class="col_1"><!--Empty--><col style="width: 71%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464244897408" scope="col">Inventory file</th><th align="left" valign="top" id="idm140464244896320" scope="col">Playbook file</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464244897408">
<pre class="screen">[ipaclients:vars]
[...]</pre>
							 </td><td align="left" valign="top" headers="idm140464244896320">
<pre class="screen">- name: Playbook to configure IPA clients
  hosts: ipaclients
  become: true
  vars_files:
  - ansible_vault_file.yml

  roles:
  - role: ipaclient
    state: present</pre>
							 </td></tr></tbody></table></rh-table><p>
				In all the other authorization scenarios described above, a basic playbook file could look as follows:
			</p><pre class="literallayout">- name: Playbook to configure IPA clients
  hosts: ipaclients
  become: true

  roles:
  - role: ipaclient
    state: true</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					As of RHEL 9.2, in the two OTP authorization scenarios described above, the requesting of the administrator’s TGT by using the <code class="literal">kinit</code> command occurs on the first specified or discovered IdM server. Therefore, no additional modification of the Ansible control node is required. Before RHEL 9.2, the <code class="literal">krb5-workstation</code> package was required on the control node.
				</p></div></rh-alert></section><section class="section" id="deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible"><div class="titlepage"><div><div><h3 class="title">4.4. Deploying an IdM client using an Ansible playbook</h3></div></div></div><p>
				Complete this procedure to use an Ansible playbook to deploy an IdM client in your IdM environment.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.
					</li><li class="listitem"><p class="simpara">
						You have set the parameters of the IdM client deployment to correspond to your deployment scenario:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management#setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible">Setting the parameters of the inventory file for the autodiscovery client installation mode</a>
							</li><li class="listitem">
								<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management#setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible">Setting the parameters of the inventory file when autodiscovery is not possible during client installation</a>
							</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Run the Ansible playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-client.yml</strong></span></pre></li></ul></div></section><section class="section" id="using-the-one-time-password-method-in-ansible-to-install-an-idm-client_client-ansible"><div class="titlepage"><div><div><h3 class="title">4.5. Using the one-time password method in Ansible to install an IdM client</h3></div></div></div><p class="_abstract _abstract">
				You can generate a one-time password (OTP) for a new host in Identity Management (IdM) and use it to enroll a system into the IdM domain. This procedure describes how to use Ansible to install an IdM client after generating an OTP for it on another IdM host.
			</p><p>
				This method of installing an IdM client is convenient if two system administrators with different privileges exist in your organisation:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						One that has the credentials of an IdM administrator.
					</li><li class="listitem">
						Another that has the required Ansible credentials, including <code class="literal">root</code> access to the host to become an IdM client.
					</li></ul></div><p>
				The IdM administrator performs the first part of the procedure in which the OTP password is generated. The Ansible administrator performs the remaining part of the procedure in which the OTP is used to install an IdM client.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the IdM <code class="literal">admin</code> credentials or at least the <code class="literal">Host Enrollment</code> privilege and a permission to add DNS records in IdM.
					</li><li class="listitem">
						You have configured a user escalation method on the Ansible managed node to allow you to install an IdM client.
					</li><li class="listitem">
						If your Ansible control node is running on RHEL 8.7 or earlier, you must be able to install packages on your Ansible control node.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li></ul></div></li><li class="listitem">
						The managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						<code class="literal">SSH</code> to an IdM host as an IdM user with a role that has the <code class="literal">Host Enrollment</code> privilege and a permission to add DNS records:
					</p><pre class="literallayout"><span class="strong strong"><strong>$ ssh admin@server.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						Generate an OTP for the new client:
					</p><pre class="literallayout">[admin@server ~]$ <span class="strong strong"><strong>ipa host-add client.idm.example.com --ip-address=172.25.250.11 --random</strong></span>
 --------------------------------------------------
 Added host "client.idm.example.com"
 --------------------------------------------------
  Host name: client.idm.example.com
  Random password: <span class="strong strong"><strong>W5YpARl=7M.n</strong></span>
  Password: True
  Keytab: False
  Managed by: server.idm.example.com</pre><p class="simpara">
						The <span class="strong strong"><strong>--ip-address=<span class="emphasis"><em>&lt;your_host_ip_address&gt;</em></span></strong></span> option adds the host to IdM DNS with the specified IP address.
					</p></li><li class="listitem"><p class="simpara">
						Exit the IdM host:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>exit</strong></span>
logout
Connection to server.idm.example.com closed.</pre></li><li class="listitem"><p class="simpara">
						On the ansible controller, update the inventory file to include the random password:
					</p><pre class="literallayout">[...]
[ipaclients]
client.idm.example.com

[ipaclients:vars]
ipaclient_domain=idm.example.com
<span class="strong strong"><strong>ipaclient_otp=W5YpARl=7M.n</strong></span>
[...]</pre></li><li class="listitem"><p class="simpara">
						If your ansible controller is running RHEL ⇐ 9.1, install the <code class="literal">kinit</code> utility provided by the <code class="literal">krb5-workstation</code> package:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>sudo dnf install krb5-workstation</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the playbook to install the client:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -i inventory install-client.yml</strong></span></pre></li></ol></div></section><section class="section" id="testing-an-Identity-Management-after-Ansible-installation_client-ansible"><div class="titlepage"><div><div><h3 class="title">4.6. Testing an Identity Management client after Ansible installation</h3></div></div></div><p>
				The command-line interface (CLI) informs you that the <code class="literal command">ansible-playbook</code> command was successful, but you can also do your own test.
			</p><p>
				To test that the Identity Management client can obtain information about users defined on the server, check that you are able to resolve a user defined on the server. For example, to check the default <code class="literal">admin</code> user:
			</p><pre class="literallayout">[user@client1 ~]$ <span class="strong strong"><strong>id admin</strong></span>
uid=1254400000(admin) gid=1254400000(admins) groups=1254400000(admins)</pre><p>
				To test that authentication works correctly, <code class="literal command">su -</code> as another already existing IdM user:
			</p><pre class="literallayout">[user@client1 ~]$ <span class="strong strong"><strong>su - idm_user</strong></span>
Last login: Thu Oct 18 18:39:11 CEST 2018 from 192.168.122.1 on pts/0
[idm_user@client1 ~]$</pre></section><section class="section" id="uninstalling-an-IdM-client-using-an-Ansible-playbook_client-ansible"><div class="titlepage"><div><div><h3 class="title">4.7. Uninstalling an IdM client using an Ansible playbook</h3></div></div></div><p>
				Complete this procedure to use an Ansible playbook to uninstall your host as an IdM client.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM administrator credentials.
					</li><li class="listitem">
						The managed node is a Red Hat Enterprise Linux 9 system with a static IP address.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Run the Ansible playbook with the instructions to uninstall the client, for example <code class="literal">uninstall-client.yml</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i ~/MyPlaybooks/inventory ~/MyPlaybooks/uninstall-client.yml</strong></span></pre></li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					The uninstallation of the client only removes the basic IdM configuration from the host but leaves the configuration files on the host in case you decide to re-install the client. In addition, the uninstallation has the following limitations:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							It does not remove the client host entry from the IdM LDAP server. The uninstallation only unenrolls the host.
						</li><li class="listitem">
							It does not remove any services residing on the client from IdM.
						</li><li class="listitem">
							It does not remove the DNS entries for the client from the IdM server.
						</li><li class="listitem">
							It does not remove the old principals for keytabs other than <code class="literal">/etc/krb5.keytab</code>.
						</li></ul></div><p>
					Note that the uninstallation does remove all certificates that were issued for the host by the IdM CA.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-client_installing-identity-management">Uninstalling an IdM client</a>
					</li></ul></div></section></section><section class="chapter" id="preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 5. Preparing your environment for managing IdM using Ansible playbooks</h2></div></div></div><p>
			As a system administrator managing Identity Management (IdM), when working with Red Hat Ansible Engine, it is good practice to do the following:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Keep a subdirectory dedicated to Ansible playbooks in your home directory, for example <span class="strong strong"><strong>~/MyPlaybooks</strong></span>.
				</li><li class="listitem">
					Copy and adapt sample Ansible playbooks from the <code class="literal">/usr/share/doc/ansible-freeipa/*</code> and <code class="literal">/usr/share/doc/rhel-system-roles/*</code> directories and subdirectories into your <span class="strong strong"><strong>~/MyPlaybooks</strong></span> directory.
				</li><li class="listitem">
					Include your inventory file in your <span class="strong strong"><strong>~/MyPlaybooks</strong></span> directory.
				</li></ul></div><p>
			Using this practice, you can find all your playbooks in one place.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				You can run your <code class="literal">ansible-freeipa</code> playbooks without invoking <code class="literal">root</code> privileges on the managed nodes. Exceptions include playbooks that use the <code class="literal">ipaserver</code>, <code class="literal">ipareplica</code>, <code class="literal">ipaclient</code>, <code class="literal">ipasmartcard_server</code>, <code class="literal">ipasmartcard_client</code> and <code class="literal">ipabackup</code> <code class="literal">ansible-freeipa</code> roles. These roles require privileged access to directories and the <code class="literal">dnf</code> software package manager.
			</p></div></rh-alert><p>
			The playbooks in the Red Hat Enterprise Linux IdM documentation assume the following <a class="link" href="#proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks" title="5.1. Preparing a control node and managed nodes for managing IdM using Ansible playbooks">security configuration</a>:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The IdM <code class="literal">admin</code> is your remote Ansible user on the managed nodes.
				</li><li class="listitem">
					You store the IdM <code class="literal">admin</code> password encrypted in an Ansible vault.
				</li><li class="listitem">
					You have placed the password that protects the Ansible vault in a password file.
				</li><li class="listitem">
					You block access to the vault password file to everyone except your local ansible user.
				</li><li class="listitem">
					You regularly remove and re-create the vault password file.
				</li></ul></div><p>
			Consider also <a class="link" href="#con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks" title="5.2. Different methods to provide the credentials required for ansible-freeipa playbooks">alternative security configurations</a>.
		</p><section class="section" id="proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">5.1. Preparing a control node and managed nodes for managing IdM using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to create the <span class="strong strong"><strong>~/MyPlaybooks</strong></span> directory and configure it so that you can use it to store and run Ansible playbooks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed an IdM server on your managed nodes, <span class="strong strong"><strong><span class="emphasis"><em>server.idm.example.com</em></span></strong></span> and <span class="strong strong"><strong><span class="emphasis"><em>replica.idm.example.com</em></span></strong></span>.
					</li><li class="listitem">
						You have configured DNS and networking so you can log in to the managed nodes, <span class="strong strong"><strong><span class="emphasis"><em>server.idm.example.com</em></span></strong></span> and <span class="strong strong"><strong><span class="emphasis"><em>replica.idm.example.com</em></span></strong></span>, directly from the control node.
					</li><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Change into the <span class="strong strong"><strong>~/MyPlaybooks/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/MyPlaybooks</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create the <span class="strong strong"><strong>~/MyPlaybooks/ansible.cfg</strong></span> file with the following content:
					</p><pre class="literallayout">[defaults]
inventory = /home/<span class="emphasis"><em>your_username</em></span>/MyPlaybooks/inventory
remote_user = admin</pre></li><li class="listitem"><p class="simpara">
						Create the <span class="strong strong"><strong>~/MyPlaybooks/inventory</strong></span> file with the following content:
					</p><pre class="literallayout">[eu]
server.idm.example.com

[us]
replica.idm.example.com

[ipaserver:children]
eu
us</pre><p class="simpara">
						This configuration defines two host groups, <span class="strong strong"><strong>eu</strong></span> and <span class="strong strong"><strong>us</strong></span>, for hosts in these locations. Additionally, this configuration defines the <span class="strong strong"><strong>ipaserver</strong></span> host group, which contains all hosts from the <span class="strong strong"><strong>eu</strong></span> and <span class="strong strong"><strong>us</strong></span> groups.
					</p></li><li class="listitem"><p class="simpara">
						Optional: Create an SSH public and private key. To simplify access in your test environment, do not set a password on the private key:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh-keygen</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the SSH public key to the IdM <code class="literal">admin</code> account on each managed node:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh-copy-id admin@server.idm.example.com</strong></span>
$ <span class="strong strong"><strong>ssh-copy-id admin@replica.idm.example.com</strong></span></pre><p class="simpara">
						These commands require that you enter the IdM <code class="literal">admin</code> password.
					</p></li><li class="listitem"><p class="simpara">
						Create a <span class="strong strong"><strong>password_file</strong></span> file that contains the vault password:
					</p><pre class="literallayout"><span class="strong strong"><strong>redhat</strong></span></pre></li><li class="listitem"><p class="simpara">
						Change the permissions to modify the file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>chmod 0600 password_file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create a <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault to store the IdM <code class="literal">admin</code> password:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Configure <span class="strong strong"><strong>password_file</strong></span> to store the vault password:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create --vault-password-file=password_file secret.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
								When prompted, enter the content of the <span class="strong strong"><strong>secret.yml</strong></span> file:
							</p><pre class="literallayout"><span class="strong strong"><strong>ipaadmin_password: <span class="emphasis"><em>Secret123</em></span></strong></span></pre></li></ol></div></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To use the encrypted <code class="literal">ipaadmin_password</code> in a playbook, you must use the <code class="literal">vars_file</code> directive. For example, a simple playbook to delete an IdM user can look as follows:
				</p><pre class="literallayout">---
- name: Playbook to handle users
  hosts: ipaserver

  <span class="strong strong"><strong>vars_files:</strong></span>
  <span class="strong strong"><strong>- /home/<span class="emphasis"><em>user_name</em></span>/MyPlaybooks/secret.yml</strong></span>

  tasks:
  - name: Delete user robot
    ipauser:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      name: robot
      state: absent</pre><p>
					When executing a playbook, instruct Ansible use the vault password to decrypt <code class="literal">ipaadmin_password</code> by adding the <code class="literal">--vault-password-file=<span class="emphasis"><em>password_file</em></span></code> option. For example:
				</p><pre class="literallayout"><span class="strong strong"><strong>ansible-playbook -i inventory --vault-password-file=password_file del-user.yml</strong></span></pre></div></rh-alert><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					For security reasons, remove the vault password file at the end of each session, and repeat steps 6-8 at the start of each new session.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks" title="5.2. Different methods to provide the credentials required for ansible-freeipa playbooks">Different methods to provide the credentials required for ansible-freeipa playbooks</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management server using an Ansible playbook</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html">How to build your inventory</a>
					</li></ul></div></section><section class="section" id="con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">5.2. Different methods to provide the credentials required for ansible-freeipa playbooks</h3></div></div></div><p>
				There are advantages and disadvantages in the different methods for providing the credentials required for running playbooks that use <code class="literal">ansible-freeipa</code> roles and modules.
			</p><div class="formalpara"><p class="title"><strong>Storing passwords in plain text in a playbook</strong></p><p>
					<span class="strong strong"><strong>Benefits</strong></span>:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Not being prompted all the time you run the playbook.
					</li><li class="listitem">
						Easy to implement.
					</li></ul></div><p>
				<span class="strong strong"><strong>Drawbacks</strong></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Everyone with access to the file can read the password. Setting wrong permissions and sharing the file, for example in an internal or external repository, can compromise security.
					</li><li class="listitem">
						High maintenance work: if the password is changed, it needs to be changed in all playbooks.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Entering passwords interactively when you execute a playbook</strong></p><p>
					<span class="strong strong"><strong>Benefits</strong></span>:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						No-one can steal the password as it is not stored anywhere.
					</li><li class="listitem">
						You can update the password easily.
					</li><li class="listitem">
						Easy to implement.
					</li></ul></div><p>
				<span class="strong strong"><strong>Drawbacks</strong></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If you are using Ansible playbooks in scripts, the requirement to enter the password interactively can be inconvenient.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Storing passwords in an Ansible vault and the vault password in a file:</strong></p><p>
					<span class="strong strong"><strong>Benefits</strong></span>:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The user password is stored encrypted.
					</li><li class="listitem">
						You can update the user password easily, by creating a new Ansible vault.
					</li><li class="listitem">
						You can update the password file that protects the ansible vault easily, by using the <code class="literal">ansible-vault rekey --new-vault-password-file=NEW_VAULT_PASSWORD_FILE secret.yml</code> command.
					</li><li class="listitem">
						If you are using Ansible playbooks in scripts, it is convenient not to have to enter the password protecting the Ansible vault interactively.
					</li></ul></div><p>
				<span class="strong strong"><strong>Drawbacks</strong></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						It is vital that the file that contains the sensitive plain text password be protected through file permissions and other security measures.
					</li></ul></div><div class="formalpara"><p class="title"><strong>Storing passwords in an Ansible vault and entering the vault password interactively</strong></p><p>
					<span class="strong strong"><strong>Benefits</strong></span>:
				</p></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The user password is stored encrypted.
					</li><li class="listitem">
						No-one can steal the vault password as it is not stored anywhere.
					</li><li class="listitem">
						You can update the user password easily, by creating a new Ansible vault.
					</li><li class="listitem">
						You can update the vault password easily too, by using the <code class="literal">ansible-vault rekey <span class="emphasis"><em>file_name</em></span></code> command.
					</li></ul></div><p>
				<span class="strong strong"><strong>Drawbacks</strong></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						If you are using Ansible playbooks in scripts, the need to enter the vault password interactively can be inconvenient.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks" title="5.1. Preparing a control node and managed nodes for managing IdM using Ansible playbooks">Preparing a control node and managed nodes for managing IdM using Ansible playbooks</a>
					</li><li class="listitem">
						<a class="link" href="https://www.redhat.com/en/topics/security/what-is-zero-trust">What is Zero trust?</a>
					</li><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/vault_guide/index.html">Protecting sensitive data with Ansible vault</a>
					</li></ul></div></section><section class="section" id="con_the-inventory-plugin-in-ansible-freeipa_preparing-your-environment-for-managing-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">5.3. The inventory plugin in <code class="literal">ansible-freeipa</code></h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">freeipa</code> inventory plugin to create dynamic inventories of Identity Management (IdM) servers to be used in <code class="literal">ansible-freeipa</code> playbooks. The plugin gathers data about the IdM servers in the domain, and selects only those that have a specified IdM server role or roles assigned. To use the plugin with the <code class="literal">ansible-playbook</code> command, set the value of the <code class="literal">-i</code> option to the inventory file that uses the <code class="literal">freeipa</code> plugin. As a result, the plays in the playbook are executed only against those servers that have the roles specified in the inventory file.
			</p><p>
				The example below describes how to use the <code class="literal">freeipa</code> plugin to determine the versions of the <code class="literal">bind</code> package on the IdM servers in the topology that have the DNS role.
			</p><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a file, for example <span class="strong strong"><strong>inventory.yml</strong></span>, to generate a dynamic inventory based on your selected IdM server role or roles. For example, to create an inventory of servers that have the IdM DNS server role:
					</p><pre class="literallayout">---
plugin: freeipa
server: server.idm.example.com
ipaadmin_password: Secret123
verify: ca.crt
role: DNS server</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<code class="literal">server</code> defines the fully-qualified domain name of the host to start the scan.
							</li><li class="listitem">
								<code class="literal">verify</code> defines the server TLS certificate file for verification.
							</li><li class="listitem">
								<code class="literal">role</code> defines all the server roles that a host must have for the host to be returned.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Create a playbook, for example <span class="strong strong"><strong>bind-playbook.yml</strong></span>, that you want to execute against the IdM servers identified by the <code class="literal">freeipa</code> inventory plugin. For example, to determine the release version of the <code class="literal">bind</code> package installed on the IdM DNS servers:
					</p><pre class="literallayout">---
- name: Check bind version
  hosts: ipaservers

  tasks:
    - name: Query bind package version
      package:
        name: bind
        state: present
      register: bind_version

    - name: Display bind release info
      debug:
        msg: "Bind release: {{ bind_version.results[0].version }}"</pre></li><li class="listitem"><p class="simpara">
						[Optional] Create a graph representation of the IdM servers identified by the plugin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-inventory -i inventory.yml --graph</strong></span>
@all:
  |--@ungrouped
  |--@ipaservers:
  |  |--replica01.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the inventory.yml file as inventory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -i inventory.yml bind-playbook.yml</strong></span>
[...]
TASK [Display bind release info] <span class="strong strong"><strong><span class="strong strong"><strong><!--Empty--></strong></span><span class="strong strong"><strong><!--Empty--></strong></span></strong></span><span class="strong strong"><strong><span class="strong strong"><strong><!--Empty--></strong></span><span class="strong strong"><strong><!--Empty--></strong></span></strong></span><span class="strong strong"><strong><span class="strong strong"><strong><!--Empty--></strong></span><span class="strong strong"><strong><!--Empty--></strong></span></strong></span><span class="strong strong"><strong><span class="strong strong"><strong><!--Empty--></strong></span><span class="strong strong"><strong><!--Empty--></strong></span></strong></span><span class="strong strong"><strong><span class="strong strong"><strong><!--Empty--></strong></span><span class="strong strong"><strong><!--Empty--></strong></span></strong></span><span class="strong strong"><strong><span class="strong strong"><strong><!--Empty--></strong></span><span class="strong strong"><strong><!--Empty--></strong></span></strong></span>
ok: [10.0.193.174] =&gt; {
    "msg": "Bind release: 9.20.3"
}
[...]</pre></li></ol></div></section></section><section class="chapter" id="configuring-global-IdM-settings-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 6. Configuring global IdM settings using Ansible playbooks</h2></div></div></div><p class="_abstract _abstract">
			Using the Ansible <code class="literal">config</code> module, you can retrieve and set global configuration parameters for Identity Management (IdM).
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" title="6.1. Retrieving IdM configuration using an Ansible playbook">Retrieving IdM configuration using an Ansible playbook</a>
				</li><li class="listitem">
					<a class="link" href="#configuring-the-IdM-ca-renewal-server-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" title="6.2. Configuring the IdM CA renewal server using an Ansible playbook">Configuring the IdM CA renewal server using an Ansible playbook</a>
				</li><li class="listitem">
					<a class="link" href="#configuring-the-default-shell-for-IdM-users-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks" title="6.3. Configuring the default shell for IdM users using an Ansible playbook">Configuring the default shell for IdM users using an Ansible playbook</a>
				</li><li class="listitem">
					<a class="link" href="#configuring-a-netbios-name-for-an-idm-domain-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks" title="6.4. Configuring a NetBIOS name for an IdM domain by using Ansible">Configuring a NETBIOS name for an IdM domain by using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-that-idm-users-and-groups-have-sids-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks" title="6.5. Ensuring that IdM users and groups have SIDs by using Ansible">Ensuring that IdM users and groups have SIDs by using Ansible</a>
				</li></ul></div><section class="section" id="retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">6.1. Retrieving IdM configuration using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how you can use an Ansible playbook to retrieve information about the current global IdM configuration.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Open the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/config/retrieve-config.yml</code> Ansible playbook file for editing:
					</p><pre class="literallayout">---
- name: Playbook to handle global IdM configuration
  hosts: ipaserver
  become: no
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Query IPA global configuration
    ipaconfig:
      ipaadmin_password: "{{ ipaadmin_password }}"
    register: serverconfig

  - debug:
      msg: "{{ serverconfig }}"</pre></li><li class="listitem"><p class="simpara">
						Adapt the file by changing the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The password of IdM administrator.
							</li><li class="listitem">
								Other values, if necessary.
							</li></ul></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/config/retrieve-config.yml</strong></span>
[...]
TASK [debug]
ok: [server.idm.example.com] =&gt; {
    "msg": {
        "ansible_facts": {
            "discovered_interpreter_
        },
        "changed": false,
        "config": {
            "ca_renewal_master_server": "server.idm.example.com",
            "configstring": [
                "AllowNThash",
                "KDC:Disable Last Success"
            ],
            "defaultgroup": "ipausers",
            "defaultshell": "/bin/bash",
            "emaildomain": "idm.example.com",
            "enable_migration": false,
            "groupsearch": [
                "cn",
                "description"
            ],
            "homedirectory": "/home",
            "maxhostname": "64",
            "maxusername": "64",
            "pac_type": [
                "MS-PAC",
                "nfs:NONE"
            ],
            "pwdexpnotify": "4",
            "searchrecordslimit": "100",
            "searchtimelimit": "2",
            "selinuxusermapdefault": "unconfined_u:s0-s0:c0.c1023",
            "selinuxusermaporder": [
                "guest_u:s0$xguest_u:s0$user_
            ],
            "usersearch": [
                "uid",
                "givenname",
                "sn",
                "telephonenumber",
                "ou",
                "title"
            ]
        },
        "failed": false
    }
}</pre></li></ol></div></section><section class="section" id="configuring-the-IdM-ca-renewal-server-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">6.2. Configuring the IdM CA renewal server using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				In an Identity Management (IdM) deployment that uses an embedded certificate authority (CA), the CA renewal server maintains and renews IdM system certificates. It ensures robust IdM deployments.
			</p><p>
				For more details on the role of the IdM CA renewal server, see <a class="link" href="https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/ipa-ca-renewal_managing-certificates-in-idm">Using IdM CA renewal server</a>.
			</p><p>
				The following procedure describes how you can use an Ansible playbook to configure the IdM CA renewal server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Optional: Identify the current IdM CA renewal server:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa config-show | grep 'CA renewal'</strong></span>
  IPA CA renewal master: server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/config/set-ca-renewal-master-server.yml</code> Ansible playbook file for editing:
					</p><pre class="literallayout">---
- name: Playbook to handle global DNS configuration
  hosts: ipaserver
  become: no
  gather_facts: no
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: set ca_renewal_master_server
    ipaconfig:
      ipaadmin_password: "{{ ipaadmin_password }}"
      ca_renewal_master_server: carenewal.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Adapt the file by changing:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The password of IdM administrator set by the <code class="literal">ipaadmin_password</code> variable.
							</li><li class="listitem">
								The name of the CA renewal server set by the <code class="literal">ca_renewal_master_server</code> variable.
							</li></ul></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/config/set-ca-renewal-master-server.yml</strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					You can verify that the CA renewal server has been changed:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as IdM administrator:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Request the identity of the IdM CA renewal server:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa config-show | grep ‘CA renewal’</strong></span>
IPA CA renewal master:  carenewal.idm.example.com</pre><p class="simpara">
						The output shows the <span class="strong strong"><strong>carenewal.idm.example.com</strong></span> server is the new CA renewal server.
					</p></li></ol></div></section><section class="section" id="configuring-the-default-shell-for-IdM-users-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">6.3. Configuring the default shell for IdM users using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				The shell is a program that accepts and interprets commands. Several shells are available in Red Hat Enterprise Linux (RHEL), such as <code class="literal">bash</code>, <code class="literal">sh</code>, <code class="literal">ksh</code>, <code class="literal">zsh</code>, <code class="literal">fish</code>, and others. <code class="literal">Bash</code>, or <code class="literal">/bin/bash</code>, is a popular shell on most Linux systems, and it is normally the default shell for user accounts on RHEL.
			</p><p>
				The following procedure describes how you can use an Ansible playbook to configure <code class="literal">sh</code>, an alternative shell, as the default shell for IdM users.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Optional: Use the <code class="literal">retrieve-config.yml</code> Ansible playbook to identify the current shell for IdM users. See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/configuring-global-idm-settings-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management#retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks">Retrieving IdM configuration using an Ansible playbook</a> for details.
					</li><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/config/ensure-config-options-are-set.yml</code> Ansible playbook file for editing:
					</p><pre class="literallayout">---
- name: Playbook to ensure some config options are set
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  # Set defaultlogin and maxusername
  - ipaconfig:
      ipaadmin_password: "{{ ipaadmin_password }}"
      defaultshell: /bin/bash
      maxusername: 64</pre></li><li class="listitem"><p class="simpara">
						Adapt the file by changing the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The password of IdM administrator set by the <code class="literal">ipaadmin_password</code> variable.
							</li><li class="listitem">
								The default shell of the IdM users set by the <code class="literal">defaultshell</code> variable into <code class="literal">/bin/sh</code>.
							</li></ul></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/config/ensure-config-options-are-set.yml</strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					You can verify that the default user shell has been changed by starting a new session in IdM:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as IdM administrator:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Display the current shell:
					</p><pre class="literallayout">[admin@server /]$ <span class="strong strong"><strong>echo "$SHELL"</strong></span>
/bin/sh</pre><p class="simpara">
						The logged-in user is using the <code class="literal">sh</code> shell.
					</p></li></ol></div></section><section class="section" id="configuring-a-netbios-name-for-an-idm-domain-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">6.4. Configuring a NetBIOS name for an IdM domain by using Ansible</h3></div></div></div><p>
				The NetBIOS name is used for Microsoft Windows' (SMB) type of sharing and messaging. You can use NetBIOS names to map a drive or connect to a printer.
			</p><p>
				Follow this procedure to use an Ansible playbook to configure a NetBIOS name for your Identity Management (IdM) domain.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package is installed.
							</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Assumptions</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
					</li><li class="listitem">
						The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code> and that you know the vault file password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem">
						Create a <span class="emphasis"><em>netbios-domain-name-present.yml</em></span> Ansible playbook file.
					</li><li class="listitem"><p class="simpara">
						Add the following content to the file:
					</p><pre class="literallayout">---
- name: Playbook to change IdM domain netbios name
  hosts: ipaserver
  become: no
  gather_facts: no


  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
    - name: Set IdM domain netbios name
      ipaconfig:
        ipaadmin_password: "{{ ipaadmin_password }}"
        netbios_name: IPADOM</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory <span class="emphasis"><em>netbios-domain-name-present.yml</em></span></strong></span></pre><p class="simpara">
						When prompted, provide the vault file password.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/planning_identity_management/index#guidelines-for-configuring-netbios-names_planning-a-cross-forest-trust-between-idm-and-ad">Guidelines for configuring NetBIOS names</a>
					</li></ul></div></section><section class="section" id="ensuring-that-idm-users-and-groups-have-sids-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">6.5. Ensuring that IdM users and groups have SIDs by using Ansible</h3></div></div></div><p class="_abstract _abstract">
				The Identity Management (IdM) server can assign unique security identifiers (SIDs) to IdM users and groups internally, based on the data from the ID ranges of the local domain. The SIDs are stored in the user and group objects.
			</p><p>
				The goal of ensuring that IdM users and groups have SIDs is to allow the generation of the Privileged Attribute Certificate (PAC), which is the first step towards IdM-IdM trusts. If IdM users and groups have SIDs, IdM is able to issue Kerberos tickets with PAC data.
			</p><p>
				Follow this procedure to achieve the following goals:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Generate SIDs for already existing IdM users and user groups.
					</li><li class="listitem">
						Enable the generation of SIDs for IdM new users and groups.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package is installed.
							</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Assumptions</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
					</li><li class="listitem">
						The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code> and that you know the vault file password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem">
						Create a <span class="emphasis"><em>sids-for-users-and-groups-present.yml</em></span> Ansible playbook file.
					</li><li class="listitem"><p class="simpara">
						Add the following content to the file:
					</p><pre class="literallayout">---
- name: Playbook to ensure SIDs are enabled and users and groups have SIDs
  hosts: ipaserver
  become: no
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
    - name: Enable SID and generate users and groups SIDS
      ipaconfig:
        ipaadmin_password: "{{ ipaadmin_password }}"
        enable_sid: true
        add_sids: true</pre><p class="simpara">
						The <code class="literal">enable_sid</code> variable enables SID generation for future IdM users and groups. The <code class="literal">add_sids</code> variable generates SIDs for existing IdM users and groups.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							When using <code class="literal">add_sids: true</code>, you must also set the <code class="literal">enable_sid</code> variable to <code class="literal">true</code>.
						</p></div></rh-alert></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory <span class="emphasis"><em>sids-for-users-and-groups-present.yml</em></span></strong></span></pre><p class="simpara">
						When prompted, provide the vault file password.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management/index#con_the-role-of-security-and-relative-identifiers-in-idm-id-ranges_adjusting-id-ranges-manually">The role of security and relative identifiers in IdM ID ranges</a>.
					</li></ul></div></section><section class="section _additional-resources" id="additional_resources"><div class="titlepage"><div><div><h3 class="title">6.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See <code class="literal">README-config.md</code> in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/config</code> directory.
					</li></ul></div></section></section><section class="chapter" id="managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 7. Managing user accounts using Ansible playbooks</h2></div></div></div><p class="_abstract _abstract">
			You can manage users in IdM using Ansible playbooks. After presenting the <a class="link" href="#user-life-cycle_managing-idm-users-using-Ansible-playbooks" title="7.1. User life cycle">user life cycle</a>, this chapter describes how to use Ansible playbooks for the following operations:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks" title="7.2. Ensuring the presence of an IdM user using an Ansible playbook">Ensuring the presence of a single user</a> listed directly in the <code class="literal">YML</code> file.
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-multiple-IdM-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" title="7.3. Ensuring the presence of multiple IdM users using Ansible playbooks">Ensuring the presence of multiple users</a> listed directly in the <code class="literal">YML</code> file.
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-multiple-IdM-users-from-a-json-file-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" title="7.4. Ensuring the presence of multiple IdM users from a JSON file using Ansible playbooks">Ensuring the presence of multiple users</a> listed in a <code class="literal">JSON</code> file that is referenced from the <code class="literal">YML</code> file.
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks" title="7.5. Ensuring the absence of users using Ansible playbooks">Ensuring the absence of users</a> listed directly in the <code class="literal">YML</code> file.
				</li></ul></div><section class="section" id="user-life-cycle_managing-idm-users-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">7.1. User life cycle</h3></div></div></div><p class="_abstract _abstract">
				Identity Management (IdM) supports three user account states:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>Stage</strong></span> users are not allowed to authenticate. This is an initial state. Some of the user account properties required for active users cannot be set, for example, group membership.
					</li><li class="listitem">
						<span class="strong strong"><strong>Active</strong></span> users are allowed to authenticate. All required user account properties must be set in this state.
					</li><li class="listitem">
						<span class="strong strong"><strong>Preserved</strong></span> users are former active users that are considered inactive and cannot authenticate to IdM. Preserved users retain most of the account properties they had as active users, but they are not part of any user groups.
					</li></ul></div><p>
				<span class="inlinemediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/163ee6fd905d1b3426a2b114cb7ee3a3/84_RHEL_IdM_0420_life-cycle.png" alt="A flow chart displaying 4 items: Active users - Stage users - Preserved users - Deleted users. Arrows communicate the relationships between each kind of user: Active users can be &quot;preserved&quot; as Preserved users. Preserved users can be &quot;restored&quot; as Active users. Preserved users can be &quot;staged&quot; as Stage users and Stage users can be &quot;activated&quot; into Active users. All users can be deleted to become &quot;Deleted users&quot;."></span>

			</p><p>
				You can delete user entries permanently from the IdM database.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Deleted user accounts cannot be restored. When you delete a user account, all the information associated with the account is permanently lost.
				</p></div></rh-alert><p>
				A new administrator can only be created by a user with administrator rights, such as the default admin user. If you accidentally delete all administrator accounts, the Directory Manager must create a new administrator manually in the Directory Server.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Do not delete the <code class="literal">admin</code> user. As <code class="literal">admin</code> is a pre-defined user required by IdM, this operation causes problems with certain commands. If you want to define and use an alternative admin user, disable the pre-defined <code class="literal">admin</code> user with <code class="literal">ipa user-disable admin</code> after you granted admin permissions to at least one different user.
				</p></div></rh-alert><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Do not add local users to IdM. The Name Service Switch (NSS) always resolves IdM users and groups before resolving local users and groups. This means that, for example, IdM group membership does not work for local users.
				</p></div></rh-alert></section><section class="section" id="ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">7.2. Ensuring the presence of an IdM user using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes ensuring the presence of a user in IdM using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the data of the user whose presence in IdM you want to ensure. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/user/add-user.yml</code> file. For example, to create user named <span class="emphasis"><em>idm_user</em></span> and add <span class="emphasis"><em>Password123</em></span> as the user password:
					</p><pre class="programlisting language-java">---
- name: Playbook to handle users
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Create user idm_user
    ipauser:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: idm_user
      first: Alice
      last: Acme
      uid: 1000111
      gid: 10011
      phone: "+555123457"
      email: idm_user@acme.com
      passwordexpiration: "2023-01-19 23:59:59"
      password: "Password123"
      update_password: on_create</pre><p class="simpara">
						You must use the following options to add a user:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								<span class="strong strong"><strong>name</strong></span>: the login name
							</li><li class="listitem">
								<span class="strong strong"><strong>first</strong></span>: the first name string
							</li><li class="listitem">
								<span class="strong strong"><strong>last</strong></span>: the last name string
							</li></ul></div><p class="simpara">
						For the full list of available user options, see the <code class="literal">/usr/share/doc/ansible-freeipa/README-user.md</code> Markdown file.
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							If you use the <code class="literal">update_password: on_create</code> option, Ansible only creates the user password when it creates the user. If the user is already created with a password, Ansible does not generate a new password.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/add-IdM-user.yml</em></span></strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You can verify if the new user account exists in IdM by using the <code class="literal">ipa user-show</code> command:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log into <code class="literal">ipaserver</code> as admin:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
								Request a Kerberos ticket for admin:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
								Request information about <span class="emphasis"><em>idm_user</em></span>:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-show idm_user</strong></span>
  User login: idm_user
  First name: Alice
  Last name: Acme
  ....</pre></li></ol></div><p class="simpara">
						The user named <span class="emphasis"><em>idm_user</em></span> is present in IdM.
					</p></li></ul></div></section><section class="section" id="ensuring-the-presence-of-multiple-IdM-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">7.3. Ensuring the presence of multiple IdM users using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes ensuring the presence of multiple users in IdM using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the data of the users whose presence you want to ensure in IdM. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/user/ensure-users-present.yml</code> file. For example, to create users <span class="emphasis"><em>idm_user_1</em></span>, <span class="emphasis"><em>idm_user_2</em></span>, and <span class="emphasis"><em>idm_user_3</em></span>, and add <span class="emphasis"><em>Password123</em></span> as the password of <span class="emphasis"><em>idm_user_1</em></span>:
					</p><pre class="programlisting language-java">---
- name: Playbook to handle users
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Create user idm_users
    ipauser:
      ipaadmin_password: "{{ ipaadmin_password }}"
      users:
      - name: idm_user_1
        first: Alice
        last: Acme
        uid: 10001
        gid: 10011
        phone: "+555123457"
        email: idm_user@acme.com
        passwordexpiration: "2023-01-19 23:59:59"
        password: "Password123"
      - name: idm_user_2
        first: Bob
        last: Acme
        uid: 100011
        gid: 10011
      - name: idm_user_3
        first: Eve
        last: Acme
        uid: 1000111
        gid: 10011</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							If you do not specify the <span class="strong strong"><strong>update_password: on_create</strong></span> option, Ansible re-sets the user password every time the playbook is run: if the user has changed the password since the last time the playbook was run, Ansible re-sets password.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/add-users.yml</em></span></strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You can verify if the user account exists in IdM by using the <code class="literal">ipa user-show</code> command:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log into <code class="literal">ipaserver</code> as administrator:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh administrator@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
								Display information about <span class="emphasis"><em>idm_user_1</em></span>:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-show idm_user_1</strong></span>
  User login: idm_user_1
  First name: Alice
  Last name: Acme
  Password: True
  ....</pre></li></ol></div><p class="simpara">
						The user named <span class="emphasis"><em>idm_user_1</em></span> is present in IdM.
					</p></li></ul></div></section><section class="section" id="ensuring-the-presence-of-multiple-IdM-users-from-a-json-file-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">7.4. Ensuring the presence of multiple IdM users from a JSON file using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how you can ensure the presence of multiple users in IdM using an Ansible playbook. The users are stored in a <code class="literal">JSON</code> file.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary tasks. Reference the <code class="literal">JSON</code> file with the data of the users whose presence you want to ensure. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/ensure-users-present-ymlfile.yml</code> file:
					</p><pre class="programlisting language-java">---
- name: Ensure users' presence
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Include users.json
    include_vars:
      file: users.json

  - name: Users present
    ipauser:
      ipaadmin_password: "{{ ipaadmin_password }}"
      users: "{{ users }}"</pre></li><li class="listitem"><p class="simpara">
						Create the <code class="literal">users.json</code> file, and add the IdM users into it. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/user/users.json</code> file. For example, to create users <span class="emphasis"><em>idm_user_1</em></span>, <span class="emphasis"><em>idm_user_2</em></span>, and <span class="emphasis"><em>idm_user_3</em></span>, and add <span class="emphasis"><em>Password123</em></span> as the password of <span class="emphasis"><em>idm_user_1</em></span>:
					</p><pre class="programlisting language-java">{
  "users": [
   {
    "name": "idm_user_1",
    "first": "Alice",
    "last": "Acme",
    "password": "Password123"
   },
   {
    "name": "idm_user_2",
    "first": "Bob",
    "last": "Acme"
   },
   {
    "name": "idm_user_3",
    "first": "Eve",
    "last": "Acme"
   }
  ]
}</pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file <span class="emphasis"><em>path_to_playbooks_directory</em></span>/ensure-users-present-jsonfile.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You can verify if the user accounts are present in IdM using the <code class="literal">ipa user-show</code> command:
					</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
								Log into <code class="literal">ipaserver</code> as administrator:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh administrator@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
								Display information about <span class="emphasis"><em>idm_user_1</em></span>:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-show idm_user_1</strong></span>
  User login: idm_user_1
  First name: Alice
  Last name: Acme
  Password: True
  ....</pre></li></ol></div><p class="simpara">
						The user named <span class="emphasis"><em>idm_user_1</em></span> is present in IdM.
					</p></li></ul></div></section><section class="section" id="ensuring-the-absence-of-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">7.5. Ensuring the absence of users using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how you can use an Ansible playbook to ensure that specific users are absent from IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the users whose absence from IdM you want to ensure. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/user/ensure-users-present.yml</code> file. For example, to delete users <span class="emphasis"><em>idm_user_1</em></span>, <span class="emphasis"><em>idm_user_2</em></span>, and <span class="emphasis"><em>idm_user_3</em></span>:
					</p><pre class="programlisting language-java">---
- name: Playbook to handle users
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Delete users idm_user_1, idm_user_2, idm_user_3
    ipauser:
      ipaadmin_password: "{{ ipaadmin_password }}"
      users:
      - name: idm_user_1
      - name: idm_user_2
      - name: idm_user_3
      state: absent</pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file <span class="emphasis"><em>path_to_playbooks_directory</em></span>/delete-users.yml</strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					You can verify that the user accounts do not exist in IdM by using the <code class="literal">ipa user-show</code> command:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as administrator:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh administrator@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Request information about <span class="emphasis"><em>idm_user_1</em></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-show idm_user_1</strong></span>
ipa: ERROR: idm_user_1: user not found</pre><p class="simpara">
						The user named <span class="emphasis"><em>idm_user_1</em></span> does not exist in IdM.
					</p></li></ol></div></section><section class="section _additional-resources" id="additional_resources_2"><div class="titlepage"><div><div><h3 class="title">7.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal">README-user.md</code> Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/user</code> directory.
					</li></ul></div></section></section><section class="chapter" id="managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 8. Managing user groups using Ansible playbooks</h2></div></div></div><p class="_abstract _abstract">
			This section introduces user group management using Ansible playbooks.
		</p><p>
			A user group is a set of users with common privileges, password policies, and other characteristics.
		</p><p>
			A user group in Identity Management (IdM) can include:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					IdM users
				</li><li class="listitem">
					other IdM user groups
				</li><li class="listitem">
					external users, which are users that exist outside of IdM
				</li></ul></div><p>
			The section includes the following topics:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#the-different-group-types-in-idm_managing-user-groups-using-ansible-playbooks" title="8.1. The different group types in IdM">The different group types in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#direct-and-indirect-group-members_managing-user-groups-using-ansible-playbooks" title="8.2. Direct and indirect group members">Direct and indirect group members</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks" title="8.3. Ensuring the presence of IdM groups and group members using Ansible playbooks">Ensuring the presence of IdM groups and group members using Ansible playbooks</a>
				</li><li class="listitem">
					<a class="link" href="#proc_using-ansible-to-enable-ad-users-to-administer-idm_managing-user-groups-using-ansible-playbooks" title="8.5. Using Ansible to enable AD users to administer IdM">Using Ansible to enable AD users to administer IdM</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks" title="8.6. Ensuring the presence of member managers in IdM user groups using Ansible playbooks">Ensuring the presence of member managers in IDM user groups using Ansible playbooks</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks" title="8.7. Ensuring the absence of member managers in IdM user groups using Ansible playbooks">Ensuring the absence of member managers in IDM user groups using Ansible playbooks</a>
				</li></ul></div><section class="section" id="the-different-group-types-in-idm_managing-user-groups-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">8.1. The different group types in IdM</h3></div></div></div><p class="_abstract _abstract">
				IdM supports the following types of groups:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">POSIX groups (the default)</span></dt><dd><p class="simpara">
							POSIX groups support Linux POSIX attributes for their members. Note that groups that interact with Active Directory cannot use POSIX attributes.
						</p><p class="simpara">
							POSIX attributes identify users as separate entities. Examples of POSIX attributes relevant to users include <code class="literal command">uidNumber</code>, a user number (UID), and <code class="literal command">gidNumber</code>, a group number (GID).
						</p></dd><dt><span class="term">Non-POSIX groups</span></dt><dd><p class="simpara">
							Non-POSIX groups do not support POSIX attributes. For example, these groups do not have a GID defined.
						</p><p class="simpara">
							All members of this type of group must belong to the IdM domain.
						</p></dd><dt><span class="term">External groups</span></dt><dd><p class="simpara">
							Use external groups to add group members that exist in an identity store outside of the IdM domain, such as:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A local system
								</li><li class="listitem">
									An Active Directory domain
								</li><li class="listitem">
									A directory service
								</li></ul></div><p class="simpara">
							External groups do not support POSIX attributes. For example, these groups do not have a GID defined.
						</p></dd></dl></div><rh-table id="idm140464244540640"><table class="lt-4-cols lt-7-rows"><caption>Table 8.1. User groups created by default</caption><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 80%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464244535792" scope="col">Group name</th><th align="left" valign="top" id="idm140464242152032" scope="col">Default group members</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464244535792"> <p>
								<code class="literal">ipausers</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464242152032"> <p>
								All IdM users
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464244535792"> <p>
								<code class="literal">admins</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464242152032"> <p>
								Users with administrative privileges, including the default <code class="literal">admin</code> user
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464244535792"> <p>
								<code class="literal">editors</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464242152032"> <p>
								This is a legacy group that no longer has any special privileges
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464244535792"> <p>
								<code class="literal">trust admins</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464242152032"> <p>
								Users with privileges to manage the Active Directory trusts
							</p>
							 </td></tr></tbody></table></rh-table><p>
				When you add a user to a user group, the user gains the privileges and policies associated with the group. For example, to grant administrative privileges to a user, add the user to the <code class="literal">admins</code> group.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Do not delete the <code class="literal">admins</code> group. As <code class="literal">admins</code> is a pre-defined group required by IdM, this operation causes problems with certain commands.
				</p></div></rh-alert><p>
				In addition, IdM creates <span class="emphasis"><em>user private groups</em></span> by default whenever a new user is created in IdM. For more information about private groups, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-groups-in-idm-cli_managing-users-groups-hosts#adding-users-without-a-user-private-group_managing-user-groups-in-idm-cli">Adding users without a private group</a>.
			</p></section><section class="section" id="direct-and-indirect-group-members_managing-user-groups-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">8.2. Direct and indirect group members</h3></div></div></div><p class="_abstract _abstract">
				User group attributes in IdM apply to both direct and indirect members: when group B is a member of group A, all users in group B are considered indirect members of group A.
			</p><p>
				For example, in the following diagram:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						User 1 and User 2 are <span class="emphasis"><em>direct members</em></span> of group A.
					</li><li class="listitem">
						User 3, User 4, and User 5 are <span class="emphasis"><em>indirect members</em></span> of group A.
					</li></ul></div><div class="figure" id="idm140464231199568"><p class="title"><strong>Figure 8.1. Direct and Indirect Group Membership</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/cabd9971fadfd526f0a83c209e2b7f3b/84_RHEL_IdM_0420_user-group.png" alt="A chart with Group A (with 2 users) and Group B (with 3 users). Group B is nested inside Group A so Group A contains a total of 5 users."></div></div></div><p>
				If you set a password policy for user group A, the policy also applies to all users in user group B.
			</p></section><section class="section" id="ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">8.3. Ensuring the presence of IdM groups and group members using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes ensuring the presence of IdM groups and group members - both users and user groups - using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The users you want to reference in your Ansible playbook exist in IdM. For details on ensuring the presence of users using Ansible, see <a class="link" href="#managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" title="Chapter 7. Managing user accounts using Ansible playbooks">Managing user accounts using Ansible playbooks</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary user and group information:
					</p><pre class="programlisting language-java">---
- name: Playbook to handle groups
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Create group ops with gid 1234
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: ops
      gidnumber: 1234

  - name: Create group sysops
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: sysops
      user:
      - idm_user

  - name: Create group appops
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: appops

  - name: Add group members sysops and appops to group ops
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: ops
      group:
      - sysops
      - appops</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/add-group-members.yml</em></span></strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					You can verify if the <span class="strong strong"><strong>ops</strong></span> group contains <span class="strong strong"><strong>sysops</strong></span> and <span class="strong strong"><strong>appops</strong></span> as direct members and <span class="strong strong"><strong>idm_user</strong></span> as an indirect member by using the <code class="literal">ipa group-show</code> command:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as administrator:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Display information about <span class="emphasis"><em>ops</em></span>:
					</p><pre class="literallayout">ipaserver]$ <span class="strong strong"><strong>ipa group-show ops</strong></span>
  Group name: ops
  GID: 1234
  Member groups: sysops, appops
  Indirect Member users: idm_user</pre><p class="simpara">
						The <span class="strong strong"><strong>appops</strong></span> and <span class="strong strong"><strong>sysops</strong></span> groups - the latter including the <span class="strong strong"><strong>idm_user</strong></span> user - exist in IdM.
					</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">/usr/share/doc/ansible-freeipa/README-group.md</code> Markdown file.
					</li></ul></div></section><section class="section" id="using-ansible-to-add-multiple-idm-groups-in-a-single-task_managing-user-groups-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">8.4. Using Ansible to add multiple IdM groups in a single task</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipagroup</code> module to add, modify, and delete multiple Identity Management (IdM) user groups with a single Ansible task. For that, use the <code class="literal">groups</code> option of the <code class="literal">ipagroup</code> module.
			</p><p>
				Using the <code class="literal">groups</code> option, you can also specify multiple group variables that only apply to a particular group. Define this group by the <code class="literal">name</code> variable, which is the only mandatory variable for the <code class="literal">groups</code> option.
			</p><p>
				Complete this procedure to ensure the presence of the <span class="strong strong"><strong>sysops</strong></span> and the <span class="strong strong"><strong>appops</strong></span> groups in IdM in a single task. Define the sysops group as a nonposix group and the appops group as an external group.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You are using RHEL 9.3 and later.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>add-nonposix-and-external-groups.yml</strong></span> with the following content:
					</p><pre class="screen">---
- name: Playbook to add nonposix and external groups
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Add nonposix group sysops and external group appops
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      groups:
      - name: sysops
        nonposix: true
      - name: appops
        external: true</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/add-nonposix-and-external-groups.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-group.md">The group module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li></ul></div></section><section class="section" id="proc_using-ansible-to-enable-ad-users-to-administer-idm_managing-user-groups-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">8.5. Using Ansible to enable AD users to administer IdM</h3></div></div></div><p>
				Follow this procedure to use an Ansible playbook to ensure that a user ID override is present in an Identity Management (IdM) group. The user ID override is the override of an Active Directory (AD) user that you created in the Default Trust View after you established a trust with AD. As a result of running the playbook, an AD user, for example an AD administrator, is able to fully administer IdM without having two different accounts and passwords.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem">
						You have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_trust_between_idm_and_ad/index">installed a trust with AD</a>.
					</li><li class="listitem">
						The user ID override of the AD user already exists in IdM. If it does not, create it with the <code class="literal">ipa idoverrideuser-add 'default trust view' <span class="emphasis"><em>ad_user@ad.example.com</em></span></code> command.
					</li><li class="listitem">
						The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks">group to which you are adding the user ID override already exists in IdM</a>.
					</li><li class="listitem">
						You are using the 4.8.7 version of IdM or later. To view the version of IdM you have installed on your server, enter <code class="literal">ipa --version</code>.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an <code class="literal">add-useridoverride-to-group.yml</code> playbook with the following content:
					</p><pre class="literallayout">---
- name: Playbook to ensure presence of users in a group
  hosts: ipaserver


  - name: Ensure the ad_user@ad.example.com user ID override is a member of the admins group:
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: admins
      idoverrideuser:
      - ad_user@ad.example.com</pre><p class="simpara">
						In the example:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Secret123 is the IdM <code class="literal">admin</code> password.
							</li><li class="listitem">
								<code class="literal">admins</code> is the name of the IdM POSIX group to which you are adding the <span class="strong strong"><strong>ad_user@ad.example.com</strong></span> ID override. Members of this group have full administrator privileges.
							</li><li class="listitem">
								<span class="strong strong"><strong>ad_user@ad.example.com</strong></span> is the user ID override of an AD administrator. The user is stored in the AD domain with which a trust has been established.
							</li></ul></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory add-useridoverride-to-group.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/enabling-ad-users-to-administer-idm_managing-users-groups-hosts#id-overrides-for-ad-users_enabling-ad-users-to-administer-idm">ID overrides for AD users</a>
					</li><li class="listitem">
						/usr/share/doc/ansible-freeipa/README-group.md
					</li><li class="listitem">
						/usr/share/doc/ansible-freeipa/playbooks/user
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/assembly_using-id-views-for-active-directory-users_managing-users-groups-hosts">Using ID views in Active Directory environments</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/enabling-ad-users-to-administer-idm_managing-users-groups-hosts">Enabling AD users to administer IdM</a>
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">8.6. Ensuring the presence of member managers in IdM user groups using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes ensuring the presence of IdM member managers - both users and user groups - using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You must have the name of the user or group you are adding as member managers and the name of the group you want them to manage.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary user and group member management information:
					</p><pre class="literallayout">---
- name: Playbook to handle membership management
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure user test is present for group_a
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: group_a
      membermanager_user: test

  - name: Ensure group_admins is present for group_a
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: group_a
      membermanager_group: group_admins</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/add-member-managers-user-groups.yml</em></span></strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					You can verify if the <span class="strong strong"><strong>group_a</strong></span> group contains <span class="strong strong"><strong>test</strong></span> as a member manager and <span class="strong strong"><strong>group_admins</strong></span> is a member manager of <span class="strong strong"><strong>group_a</strong></span> by using the <code class="literal">ipa group-show</code> command:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as administrator:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Display information about <span class="emphasis"><em>managergroup1</em></span>:
					</p><pre class="literallayout">ipaserver]$ <span class="strong strong"><strong>ipa group-show group_a</strong></span>
  Group name: group_a
  GID: 1133400009
  Membership managed by groups: group_admins
  Membership managed by users: test</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">ipa host-add-member-manager --help</code>.
					</li><li class="listitem">
						See the <code class="literal">ipa</code> man page on your system.
					</li></ul></div></section><section class="section" id="ensuring-the-absence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">8.7. Ensuring the absence of member managers in IdM user groups using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes ensuring the absence of IdM member managers - both users and user groups - using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You must have the name of the existing member manager user or group you are removing and the name of the group they are managing.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary user and group member management information:
					</p><pre class="programlisting language-java">---
- name: Playbook to handle membership management
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure member manager user and group members are absent for group_a
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: group_a
      membermanager_user: test
      membermanager_group: group_admins
      action: member
      state: absent</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-member-managers-are-absent.yml</em></span></strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					You can verify if the <span class="strong strong"><strong>group_a</strong></span> group does not contain <span class="strong strong"><strong>test</strong></span> as a member manager and <span class="strong strong"><strong>group_admins</strong></span> as a member manager of <span class="strong strong"><strong>group_a</strong></span> by using the <code class="literal">ipa group-show</code> command:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as administrator:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Display information about group_a:
					</p><pre class="literallayout">ipaserver]$ <span class="strong strong"><strong>ipa group-show group_a</strong></span>
  Group name: group_a
  GID: 1133400009</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">ipa host-remove-member-manager --help</code>.
					</li><li class="listitem">
						See the <code class="literal">ipa</code> man page on your system.
					</li></ul></div></section></section><section class="chapter" id="using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 9. Using Ansible to automate group membership in IdM</h2></div></div></div><p class="_abstract _abstract">
			Using automatic group membership, you can assign users and hosts user groups and host groups automatically, based on their attributes. For example, you can:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					Divide employees' user entries into groups based on the employees' manager, location, position or any other attribute. You can list all attributes by entering <code class="literal">ipa user-add --help</code> on the command-line.
				</li><li class="listitem">
					Divide hosts into groups based on their class, location, or any other attribute. You can list all attributes by entering <code class="literal">ipa host-add --help</code> on the command-line.
				</li><li class="listitem">
					Add all users or all hosts to a single global group.
				</li></ul></div><p>
			You can use Red Hat Ansible Engine to automate the management of automatic group membership in Identity Management (IdM).
		</p><p>
			This section covers the following topics:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-present_using-ansible-to-automate-group-membership-in-idm" title="9.1. Using Ansible to ensure that an automember rule for an IdM user group is present">Using Ansible to ensure that an automember rule for an IdM user group is present</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-a-specified-condition-is-present-in-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" title="9.2. Using Ansible to ensure that a specified condition is present in an IdM user group automember rule">Using Ansible to ensure that a condition is present in an IdM user group automember rule</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" title="9.3. Using Ansible to ensure that a condition is absent from an IdM user group automember rule">Using Ansible to ensure that a condition is absent in an IdM user group automember rule</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-absent_using-ansible-to-automate-group-membership-in-idm" title="9.4. Using Ansible to ensure that an automember rule for an IdM user group is absent">Using Ansible to ensure that an automember rule for an IdM group is absent</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-a-condition-is-present-in-an-idm-host-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" title="9.5. Using Ansible to ensure that a condition is present in an IdM host group automember rule">Using Ansible to ensure that a condition is present in an IdM host group automember rule</a>
				</li></ul></div><section class="section" id="using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-present_using-ansible-to-automate-group-membership-in-idm"><div class="titlepage"><div><div><h3 class="title">9.1. Using Ansible to ensure that an automember rule for an IdM user group is present</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to ensure an <code class="literal">automember</code> rule for an Identity Management (IdM) group exists. In the example, the presence of an <code class="literal">automember</code> rule is ensured for the <span class="strong strong"><strong>testing_group</strong></span> user group.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>testing_group</strong></span> user group exists in IdM.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">automember-group-present.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/automember/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-group-present.yml automember-group-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">automember-group-present-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaautomember</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>testing_group</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">automember_type</code> variable to <span class="strong strong"><strong>group</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">present</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Automember group present example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure group automember rule admins is present
    ipaautomember:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: testing_group</strong></span>
      <span class="strong strong"><strong>automember_type: group</strong></span>
      <span class="strong strong"><strong>state: present</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-group-present-copy.yml</strong></span></pre></li></ol></div></section><section class="section _additional-resources" id="using-ansible-to-ensure-that-a-specified-condition-is-present-in-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm"><div class="titlepage"><div><div><h3 class="title">9.2. Using Ansible to ensure that a specified condition is present in an IdM user group automember rule</h3></div></div></div><div class="_abstract _abstract"><p class="title"><strong>Additional resources</strong></p><p>
					The following procedure describes how to use an Ansible playbook to ensure that a specified condition exists in an <code class="literal">automember</code> rule for an Identity Management (IdM) group. In the example, the presence of a UID-related condition in the <code class="literal">automember</code> rule is ensured for the <span class="strong strong"><strong>testing_group</strong></span> group. By specifying the <span class="strong strong"><strong>.*</strong></span> condition, you ensure that all future IdM users automatically become members of the <span class="strong strong"><strong>testing_group</strong></span>.
				</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>testing_group</strong></span> user group and automember user group rule exist in IdM.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">automember-hostgroup-rule-present.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/automember/</code> directory and name it, for example, <span class="strong strong"><strong>automember-usergroup-rule-present.yml</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-hostgroup-rule-present.yml automember-usergroup-rule-present.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">automember-usergroup-rule-present.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by modifying the following parameters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Rename the playbook to correspond to your use case, for example: <span class="strong strong"><strong>Automember user group rule member present</strong></span>.
							</li><li class="listitem">
								Rename the task to correspond to your use case, for example: <span class="strong strong"><strong>Ensure an automember condition for a user group is present</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Set the following variables in the <code class="literal">ipaautomember</code> task section:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
									</li><li class="listitem">
										Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>testing_group</strong></span>.
									</li><li class="listitem">
										Set the <code class="literal">automember_type</code> variable to <code class="literal">group</code>.
									</li><li class="listitem">
										Ensure that the <code class="literal">state</code> variable is set to <code class="literal">present</code>.
									</li><li class="listitem">
										Ensure that the <code class="literal">action</code> variable is set to <code class="literal">member</code>.
									</li><li class="listitem">
										Set the <code class="literal">inclusive</code> <code class="literal">key</code> variable to <code class="literal">UID</code>.
									</li><li class="listitem">
										Set the <code class="literal">inclusive</code> <code class="literal">expression</code> variable to <span class="strong strong"><strong>.</strong></span>*
									</li></ul></div></li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Automember user group rule member present
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure an automember condition for a user group is present</strong></span>
    ipaautomember:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: testing_group</strong></span>
      <span class="strong strong"><strong>automember_type: group</strong></span>
      <span class="strong strong"><strong>state: present</strong></span>
      <span class="strong strong"><strong>action: member</strong></span>
      inclusive:
        - <span class="strong strong"><strong>key: UID</strong></span>
          <span class="strong strong"><strong>expression: .</strong></span>*</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-usergroup-rule-present.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in as an IdM administrator.
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add a user, for example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add user101 --first user --last 101</strong></span>
-----------------------
Added user "user101"
-----------------------
  User login: user101
  First name: user
  Last name: 101
  ...
  <span class="strong strong"><strong>Member of groups: ipausers, testing_group</strong></span>
  ...</pre></li></ol></div></section><section class="section _additional-resources" id="using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm"><div class="titlepage"><div><div><h3 class="title">9.3. Using Ansible to ensure that a condition is absent from an IdM user group automember rule</h3></div></div></div><div class="_abstract _abstract"><p class="title"><strong>Additional resources</strong></p><p>
					The following procedure describes how to use an Ansible playbook to ensure a condition is absent from an <code class="literal">automember</code> rule for an Identity Management (IdM) group. In the example, the absence of a condition in the <code class="literal">automember</code> rule is ensured that specifies that users whose <code class="literal">initials</code> are <span class="strong strong"><strong>dp</strong></span> should be included. The automember rule is applied to the <span class="strong strong"><strong>testing_group</strong></span> group. By applying the condition, you ensure that no future IdM user whose initials are <span class="strong strong"><strong>dp</strong></span> becomes a member of the <span class="strong strong"><strong>testing_group</strong></span>.
				</p></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>testing_group</strong></span> user group and automember user group rule exist in IdM.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">automember-hostgroup-rule-absent.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/automember/</code> directory and name it, for example, <span class="strong strong"><strong>automember-usergroup-rule-absent.yml</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-hostgroup-rule-absent.yml automember-usergroup-rule-absent.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">automember-usergroup-rule-absent.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by modifying the following parameters:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Rename the playbook to correspond to your use case, for example: <span class="strong strong"><strong>Automember user group rule member absent</strong></span>.
							</li><li class="listitem">
								Rename the task to correspond to your use case, for example: <span class="strong strong"><strong>Ensure an automember condition for a user group is absent</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Set the following variables in the <code class="literal">ipaautomember</code> task section:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
									</li><li class="listitem">
										Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>testing_group</strong></span>.
									</li><li class="listitem">
										Set the <code class="literal">automember_type</code> variable to <span class="strong strong"><strong>group</strong></span>.
									</li><li class="listitem">
										Ensure that the <code class="literal">state</code> variable is set to <code class="literal">absent</code>.
									</li><li class="listitem">
										Ensure that the <code class="literal">action</code> variable is set to <code class="literal">member</code>.
									</li><li class="listitem">
										Set the <code class="literal">inclusive</code> <code class="literal">key</code> variable to <code class="literal">initials</code>.
									</li><li class="listitem">
										Set the <code class="literal">inclusive</code> <code class="literal">expression</code> variable to <span class="strong strong"><strong>dp</strong></span>.
									</li></ul></div></li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Automember user group rule member absent
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure an automember condition for a user group is absent</strong></span>
    ipaautomember:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: testing_group</strong></span>
      <span class="strong strong"><strong>automember_type: group</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span>
      <span class="strong strong"><strong>action: member</strong></span>
      inclusive:
        - <span class="strong strong"><strong>key: initials</strong></span>
          <span class="strong strong"><strong>expression: dp</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-usergroup-rule-absent.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in as an IdM administrator.
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
						View the automember group:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa automember-show --type=group testing_group</strong></span>
 Automember Rule: testing_group</pre></li></ol></div><p>
				The absence of an <code class="literal">Inclusive Regex: initials=dp</code> entry in the output confirms that the <span class="strong strong"><strong>testing_group</strong></span> automember rule does not contain the condition specified.
			</p></section><section class="section _additional-resources" id="using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-absent_using-ansible-to-automate-group-membership-in-idm"><div class="titlepage"><div><div><h3 class="title">9.4. Using Ansible to ensure that an automember rule for an IdM user group is absent</h3></div></div></div><div class="_abstract _abstract"><p class="title"><strong>Additional resources</strong></p><p>
					The following procedure describes how to use an Ansible playbook to ensure an <code class="literal">automember</code> rule is absent for an Identity Management (IdM) group. In the example, the absence of an <code class="literal">automember</code> rule is ensured for the <span class="strong strong"><strong>testing_group</strong></span> group.
				</p></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Deleting an automember rule also deletes all conditions associated with the rule. To remove only specific conditions from a rule, see <a class="link" href="#using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm" title="9.3. Using Ansible to ensure that a condition is absent from an IdM user group automember rule">Using Ansible to ensure that a condition is absent in an IdM user group automember rule</a>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">automember-group-absent.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/automember/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-group-absent.yml automember-group-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">automember-group-absent-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaautomember</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>testing_group</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">automember_type</code> variable to <span class="strong strong"><strong>group</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Automember group absent example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure group automember rule admins is absent
    ipaautomember:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: testing_group</strong></span>
      <span class="strong strong"><strong>automember_type: group</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-group-absent.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-automember.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/automember</code> directory.
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-a-condition-is-present-in-an-idm-host-group-automember-rule_using-ansible-to-automate-group-membership-in-idm"><div class="titlepage"><div><div><h3 class="title">9.5. Using Ansible to ensure that a condition is present in an IdM host group automember rule</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use Ansible to ensure that a condition is present in an IdM host group automember rule. The example describes how to ensure that hosts with the <code class="literal">FQDN</code> of <span class="strong strong"><strong>.*.idm.example.com</strong></span> are members of the <span class="strong strong"><strong>primary_dns_domain_hosts</strong></span> host group and hosts whose <code class="literal">FQDN</code> is <span class="strong strong"><strong>.*.example.org</strong></span> are not members of the <span class="strong strong"><strong>primary_dns_domain_hosts</strong></span> host group.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>primary_dns_domain_hosts</strong></span> host group and automember host group rule exist in IdM.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">automember-hostgroup-rule-present.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/automember/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-hostgroup-rule-present.yml automember-hostgroup-rule-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">automember-hostgroup-rule-present-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaautomember</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>primary_dns_domain_hosts</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">automember_type</code> variable to <span class="strong strong"><strong>hostgroup</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">present</code>.
							</li><li class="listitem">
								Ensure that the <code class="literal">action</code> variable is set to <code class="literal">member</code>.
							</li><li class="listitem">
								Ensure that the <code class="literal">inclusive</code> <code class="literal">key</code> variable is set to <code class="literal">fqdn</code>.
							</li><li class="listitem">
								Set the corresponding <code class="literal">inclusive</code> <code class="literal">expression</code> variable to <span class="strong strong"><strong>.*.idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">exclusive</code> <code class="literal">key</code> variable to <code class="literal">fqdn</code>.
							</li><li class="listitem">
								Set the corresponding <code class="literal">exclusive</code> <code class="literal">expression</code> variable to <span class="strong strong"><strong>.*.example.org</strong></span>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Automember user group rule member present
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure an automember condition for a user group is present
    ipaautomember:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: primary_dns_domain_hosts</strong></span>
      <span class="strong strong"><strong>automember_type: hostgroup</strong></span>
      <span class="strong strong"><strong>state: present</strong></span>
      <span class="strong strong"><strong>action: member</strong></span>
      inclusive:
        <span class="strong strong"><strong>- key: fqdn</strong></span>
          <span class="strong strong"><strong>expression: .*.idm.example.com</strong></span>
      exclusive:
        - <span class="strong strong"><strong>key: fqdn</strong></span>
          <span class="strong strong"><strong>expression: .*.example.org</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-hostgroup-rule-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-automember.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/automember</code> directory.
					</li></ul></div></section></section><section class="chapter" id="using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 10. Using Ansible playbooks to manage self-service rules in IdM</h2></div></div></div><p class="_abstract _abstract">
			This section introduces self-service rules in Identity Management (IdM) and describes how to create and edit self-service access rules using Ansible playbooks. Self-service access control rules allow an IdM entity to perform specified operations on its IdM Directory Server entry.
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.1. Self-service access control in IdM">Self-service access control in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-a-self-service-rule-is-present_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.2. Using Ansible to ensure that a self-service rule is present">Using Ansible to ensure that a self-service rule is present</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-a-self-service-rule-is-absent_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.3. Using Ansible to ensure that a self-service rule is absent">Using Ansible to ensure that a self-service rule is absent</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-a-self-service-rule-has-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.4. Using Ansible to ensure that a self-service rule has specific attributes">Using Ansible to ensure that a self-service rule has specific attributes</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-a-self-service-rule-does-not-have-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.5. Using Ansible to ensure that a self-service rule does not have specific attributes">Using Ansible to ensure that a self-service rule does not have specific attributes</a>
				</li></ul></div><section class="section" id="self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm"><div class="titlepage"><div><div><h3 class="title">10.1. Self-service access control in IdM</h3></div></div></div><p class="_abstract _abstract">
				Self-service access control rules define which operations an Identity Management (IdM) entity can perform on its IdM Directory Server entry: for example, IdM users have the ability to update their own passwords.<br>
			</p><p>
				This method of control allows an authenticated IdM entity to edit specific attributes within its LDAP entry, but does not allow <code class="literal">add</code> or <code class="literal">delete</code> operations on the entire entry.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					Be careful when working with self-service access control rules: configuring access control rules improperly can inadvertently elevate an entity’s privileges.
				</p></div></rh-alert></section><section class="section" id="using-ansible-to-ensure-that-a-self-service-rule-is-present_using-ansible-playbooks-to-manage-self-service-rules-in-idm"><div class="titlepage"><div><div><h3 class="title">10.2. Using Ansible to ensure that a self-service rule is present</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to define self-service rules and ensure their presence on an Identity Management (IdM) server. In this example, the new <span class="strong strong"><strong>Users can manage their own name details</strong></span> rule grants users the ability to change their own <code class="literal">givenname</code>, <code class="literal">displayname</code>, <code class="literal">title</code> and <code class="literal">initials</code> attributes. This allows them to, for example, change their display name or initials if they want to.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">selfservice-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/selfservice/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/selfservice/selfservice-present.yml selfservice-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">selfservice-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaselfservice</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the new self-service rule.
							</li><li class="listitem">
								Set the <code class="literal">permission</code> variable to a comma-separated list of permissions to grant: <code class="literal">read</code> and <code class="literal">write</code>.
							</li><li class="listitem">
								Set the <code class="literal">attribute</code> variable to a list of attributes that users can manage themselves: <code class="literal">givenname</code>, <code class="literal">displayname</code>, <code class="literal">title</code>, and <code class="literal">initials</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Self-service present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure self-service rule "Users can manage their own name details" is present
    ipaselfservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: "Users can manage their own name details"</strong></span>
      <span class="strong strong"><strong>permission: read, write</strong></span>
      <span class="strong strong"><strong>attribute:</strong></span>
      <span class="strong strong"><strong>- givenname</strong></span>
      <span class="strong strong"><strong>- displayname</strong></span>
      <span class="strong strong"><strong>- title</strong></span>
      <span class="strong strong"><strong>- initials</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory selfservice-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.1. Self-service access control in IdM">Self-service access control in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-selfservice.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						The <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/selfservice</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-a-self-service-rule-is-absent_using-ansible-playbooks-to-manage-self-service-rules-in-idm"><div class="titlepage"><div><div><h3 class="title">10.3. Using Ansible to ensure that a self-service rule is absent</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to ensure a specified self-service rule is absent from your IdM configuration. The example below describes how to make sure the <span class="strong strong"><strong>Users can manage their own name details</strong></span> self-service rule does not exist in IdM. This will ensure that users cannot, for example, change their own display name or initials.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">selfservice-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/selfservice/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/selfservice/selfservice-absent.yml selfservice-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">selfservice-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaselfservice</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the self-service rule.
							</li><li class="listitem">
								Set the <code class="literal">state</code> variable to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Self-service absent
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure self-service rule "Users can manage their own name details" is absent
    ipaselfservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: "Users can manage their own name details"</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory selfservice-absent-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.1. Self-service access control in IdM">Self-service access control in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-selfservice.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/selfservice</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-a-self-service-rule-has-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm"><div class="titlepage"><div><div><h3 class="title">10.4. Using Ansible to ensure that a self-service rule has specific attributes</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to ensure that an already existing self-service rule has specific settings. In the example, you ensure the <span class="strong strong"><strong>Users can manage their own name details</strong></span> self-service rule also has the <code class="literal">surname</code> member attribute.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>Users can manage their own name details</strong></span> self-service rule exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">selfservice-member-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/selfservice/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/selfservice/selfservice-member-present.yml selfservice-member-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">selfservice-member-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaselfservice</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the self-service rule to modify.
							</li><li class="listitem">
								Set the <code class="literal">attribute</code> variable to <code class="literal">surname</code>.
							</li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Self-service member present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure selfservice "Users can manage their own name details" member attribute surname is present
    ipaselfservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: "Users can manage their own name details"</strong></span>
      <span class="strong strong"><strong>attribute:</strong></span>
      <span class="strong strong"><strong>- surname</strong></span>
      <span class="strong strong"><strong>action: member</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory selfservice-member-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.1. Self-service access control in IdM">Self-service access control in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-selfservice.md</code> file available in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						The sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/selfservice</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-a-self-service-rule-does-not-have-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm"><div class="titlepage"><div><div><h3 class="title">10.5. Using Ansible to ensure that a self-service rule does not have specific attributes</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to ensure that a self-service rule does not have specific settings. You can use this playbook to make sure a self-service rule does not grant undesired access. In the example, you ensure the <span class="strong strong"><strong>Users can manage their own name details</strong></span> self-service rule does not have the <code class="literal">givenname</code> and <code class="literal">surname</code> member attributes.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>Users can manage their own name details</strong></span> self-service rule exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">selfservice-member-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/selfservice/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/selfservice/selfservice-member-absent.yml selfservice-member-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">selfservice-member-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaselfservice</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the self-service rule you want to modify.
							</li><li class="listitem">
								Set the <code class="literal">attribute</code> variable to <code class="literal">givenname</code> and <code class="literal">surname</code>.
							</li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li><li class="listitem">
								Set the <code class="literal">state</code> variable to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Self-service member absent
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure selfservice "Users can manage their own name details" member attributes givenname and surname are absent
    ipaselfservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: "Users can manage their own name details"</strong></span>
      <span class="strong strong"><strong>attribute:</strong></span>
      <span class="strong strong"><strong>- givenname</strong></span>
      <span class="strong strong"><strong>- surname</strong></span>
      <span class="strong strong"><strong>action: member</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory selfservice-member-absent-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm" title="10.1. Self-service access control in IdM">Self-service access control in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-selfservice.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						The sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/selfservice</code> directory
					</li></ul></div></section></section><section class="chapter" id="assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 11. Delegating permissions to user groups to manage users using Ansible playbooks</h2></div></div></div><p class="_abstract _abstract">
			Delegation is one of the access control methods in IdM, along with self-service rules and role-based access control (RBAC). You can use delegation to assign permissions to one group of users to manage entries for another group of users.
		</p><p>
			This section covers the following topics:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.1. Delegation rules">Delegation rules</a>
				</li><li class="listitem">
					<a class="link" href="#creating-an-ansible-inventory-file-for-idm_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.2. Creating an Ansible inventory file for IdM">Creating the Ansible inventory file for IdM</a>
				</li><li class="listitem">
					<a class="link" href="#proc_using-ansible-to-ensure-that-a-delegation-rule-is-present_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.3. Using Ansible to ensure that a delegation rule is present">Using Ansible to ensure that a delegation rule is present</a>
				</li><li class="listitem">
					<a class="link" href="#proc_using-ansible-to-ensure-that-a-delegation-rule-is-absent_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.4. Using Ansible to ensure that a delegation rule is absent">Using Ansible to ensure that a delegation rule is absent</a>
				</li><li class="listitem">
					<a class="link" href="#proc_using-ansible-to-ensure-that-a-delegation-rule-has-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.5. Using Ansible to ensure that a delegation rule has specific attributes">Using Ansible to ensure that a delegation rule has specific attributes</a>
				</li><li class="listitem">
					<a class="link" href="#proc_using-ansible-to-ensure-that-a-delegation-rule-does-not-have-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.6. Using Ansible to ensure that a delegation rule does not have specific attributes">Using Ansible to ensure that a delegation rule does not have specific attributes</a>
				</li></ul></div><section class="section" id="delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">11.1. Delegation rules</h3></div></div></div><p class="_abstract _abstract">
				You can delegate permissions to user groups to manage users by creating <span class="strong strong"><strong>delegation rules</strong></span>.
			</p><p>
				Delegation rules allow a specific user group to perform write (edit) operations on specific attributes for users in another user group. This form of access control rule is limited to editing the values of a subset of attributes you specify in a delegation rule; it does not grant the ability to add or remove whole entries or control over unspecified attributes.
			</p><p>
				Delegation rules grant permissions to existing user groups in IdM. You can use delegation to, for example, allow the <code class="literal">managers</code> user group to manage selected attributes of users in the <code class="literal">employees</code> user group.
			</p></section><section class="section" id="creating-an-ansible-inventory-file-for-idm_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">11.2. Creating an Ansible inventory file for IdM</h3></div></div></div><p class="_abstract _abstract">
				When working with Ansible, it is good practice to create, in your home directory, a subdirectory dedicated to Ansible playbooks that you copy and adapt from the <code class="literal">/usr/share/doc/ansible-freeipa/*</code> and <code class="literal">/usr/share/doc/rhel-system-roles/*</code> subdirectories. This practice has the following advantages:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You can find all your playbooks in one place.
					</li><li class="listitem">
						You can run your playbooks without invoking <code class="literal">root</code> privileges.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create a directory for your Ansible configuration and playbooks in your home directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>mkdir ~/MyPlaybooks/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Change into the <span class="strong strong"><strong>~/MyPlaybooks/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/MyPlaybooks</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create the <span class="strong strong"><strong>~/MyPlaybooks/ansible.cfg</strong></span> file with the following content:
					</p><pre class="literallayout">[defaults]
inventory = /home/<span class="emphasis"><em>&lt;username&gt;</em></span>/MyPlaybooks/inventory

[privilege_escalation]
become=True</pre></li><li class="listitem"><p class="simpara">
						Create the <span class="strong strong"><strong>~/MyPlaybooks/inventory</strong></span> file with the following content:
					</p><pre class="literallayout">[eu]
server.idm.example.com

[us]
replica.idm.example.com

[ipaserver:children]
eu
us</pre><p class="simpara">
						This configuration defines two host groups, <span class="strong strong"><strong>eu</strong></span> and <span class="strong strong"><strong>us</strong></span>, for hosts in these locations. Additionally, this configuration defines the <span class="strong strong"><strong>ipaserver</strong></span> host group, which contains all hosts from the <span class="strong strong"><strong>eu</strong></span> and <span class="strong strong"><strong>us</strong></span> groups.
					</p></li></ol></div></section><section class="section" id="proc_using-ansible-to-ensure-that-a-delegation-rule-is-present_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">11.3. Using Ansible to ensure that a delegation rule is present</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to define privileges for a new IdM delegation rule and ensure its presence. In the example, the new <span class="strong strong"><strong>basic manager attributes</strong></span> delegation rule grants the <code class="literal">managers</code> group the ability to read and write the following attributes for members of the <code class="literal">employees</code> group:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">businesscategory</code>
					</li><li class="listitem">
						<code class="literal">departmentnumber</code>
					</li><li class="listitem">
						<code class="literal">employeenumber</code>
					</li><li class="listitem">
						<code class="literal">employeetype</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">delegation-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/delegation/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/delegation/delegation-present.yml delegation-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">delegation-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadelegation</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the new delegation rule.
							</li><li class="listitem">
								Set the <code class="literal">permission</code> variable to a comma-separated list of permissions to grant: <code class="literal">read</code> and <code class="literal">write</code>.
							</li><li class="listitem">
								Set the <code class="literal">attribute</code> variable to a list of attributes the delegated user group can manage: <code class="literal">businesscategory</code>, <code class="literal">departmentnumber</code>, <code class="literal">employeenumber</code>, and <code class="literal">employeetype</code>.
							</li><li class="listitem">
								Set the <code class="literal">group</code> variable to the name of the group that is being given access to view or modify attributes.
							</li><li class="listitem">
								Set the <code class="literal">membergroup</code> variable to the name of the group whose attributes can be viewed or modified.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to manage a delegation rule
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure delegation "basic manager attributes" is present
    ipadelegation:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: "basic manager attributes"</strong></span>
      <span class="strong strong"><strong>permission: read, write</strong></span>
      <span class="strong strong"><strong>attribute:</strong></span>
      <span class="strong strong"><strong>- businesscategory</strong></span>
      <span class="strong strong"><strong>- departmentnumber</strong></span>
      <span class="strong strong"><strong>- employeenumber</strong></span>
      <span class="strong strong"><strong>- employeetype</strong></span>
      <span class="strong strong"><strong>group: managers</strong></span>
      <span class="strong strong"><strong>membergroup: employees</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>MyPlaybooks</em></span>/inventory delegation-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.1. Delegation rules">Delegation rules</a>
					</li><li class="listitem">
						The <code class="literal">README-delegation.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/ipadelegation</code> directory
					</li></ul></div></section><section class="section" id="proc_using-ansible-to-ensure-that-a-delegation-rule-is-absent_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">11.4. Using Ansible to ensure that a delegation rule is absent</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to ensure a specified delegation rule is absent from your IdM configuration. The example below describes how to make sure the custom <span class="strong strong"><strong>basic manager attributes</strong></span> delegation rule does not exist in IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks&gt;</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">delegation-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/delegation/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/delegation/delegation-present.yml delegation-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">delegation-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadelegation</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the delegation rule.
							</li><li class="listitem">
								Set the <code class="literal">state</code> variable to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Delegation absent
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure delegation "basic manager attributes" is absent
    ipadelegation:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: "basic manager attributes"</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>MyPlaybooks</em></span>/inventory delegation-absent-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.1. Delegation rules">Delegation rules</a>
					</li><li class="listitem">
						The <code class="literal">README-delegation.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/ipadelegation</code> directory
					</li></ul></div></section><section class="section" id="proc_using-ansible-to-ensure-that-a-delegation-rule-has-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">11.5. Using Ansible to ensure that a delegation rule has specific attributes</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to ensure that a delegation rule has specific settings. You can use this playbook to modify a delegation role you have previously created. In the example, you ensure the <span class="strong strong"><strong>basic manager attributes</strong></span> delegation rule only has the <code class="literal">departmentnumber</code> member attribute.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>basic manager attributes</strong></span> delegation rule exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">delegation-member-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/delegation/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/delegation/delegation-member-present.yml delegation-member-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">delegation-member-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadelegation</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the delegation rule to modify.
							</li><li class="listitem">
								Set the <code class="literal">attribute</code> variable to <code class="literal">departmentnumber</code>.
							</li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Delegation member present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure delegation "basic manager attributes" member attribute departmentnumber is present
    ipadelegation:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: "basic manager attributes"</strong></span>
      <span class="strong strong"><strong>attribute:</strong></span>
      <span class="strong strong"><strong>- departmentnumber</strong></span>
      <span class="strong strong"><strong>action: member</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>MyPlaybooks</em></span>/inventory delegation-member-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.1. Delegation rules">Delegation rules</a>
					</li><li class="listitem">
						The <code class="literal">README-delegation.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						The sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/ipadelegation</code> directory
					</li></ul></div></section><section class="section" id="proc_using-ansible-to-ensure-that-a-delegation-rule-does-not-have-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">11.6. Using Ansible to ensure that a delegation rule does not have specific attributes</h3></div></div></div><p class="_abstract _abstract">
				The following procedure describes how to use an Ansible playbook to ensure that a delegation rule does not have specific settings. You can use this playbook to make sure a delegation role does not grant undesired access. In the example, you ensure the <span class="strong strong"><strong>basic manager attributes</strong></span> delegation rule does not have the <code class="literal">employeenumber</code> and <code class="literal">employeetype</code> member attributes.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>basic manager attributes</strong></span> delegation rule exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">delegation-member-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/delegation/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/delegation/delegation-member-absent.yml delegation-member-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">delegation-member-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadelegation</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the delegation rule to modify.
							</li><li class="listitem">
								Set the <code class="literal">attribute</code> variable to <code class="literal">employeenumber</code> and <code class="literal">employeetype</code>.
							</li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li><li class="listitem">
								Set the <code class="literal">state</code> variable to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Delegation member absent
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure delegation "basic manager attributes" member attributes employeenumber and employeetype are absent
    ipadelegation:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: "basic manager attributes"</strong></span>
      attribute:
      <span class="strong strong"><strong>- employeenumber</strong></span>
      <span class="strong strong"><strong>- employeetype</strong></span>
      <span class="strong strong"><strong>action: member</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>MyPlaybooks</em></span>/inventory delegation-member-absent-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks" title="11.1. Delegation rules">Delegation rules</a>
					</li><li class="listitem">
						The <code class="literal">README-delegation.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/ipadelegation</code> directory
					</li></ul></div></section></section><section class="chapter" id="using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 12. Using Ansible playbooks to manage role-based access control in IdM</h2></div></div></div><p class="_abstract _abstract">
			Role-based access control (RBAC) is a policy-neutral access-control mechanism defined around roles and privileges. The components of RBAC in Identity Management (IdM) are roles, privileges and permissions:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<span class="strong strong"><strong>Permissions</strong></span> grant the right to perform a specific task such as adding or deleting users, modifying a group, and enabling read-access.
				</li><li class="listitem">
					<span class="strong strong"><strong>Privileges</strong></span> combine permissions, for example all the permissions needed to add a new user.
				</li><li class="listitem">
					<span class="strong strong"><strong>Roles</strong></span> grant a set of privileges to users, user groups, hosts or host groups.
				</li></ul></div><p>
			Especially in large companies, using RBAC can help create a hierarchical system of administrators with their individual areas of responsibility.
		</p><p>
			This chapter describes the following operations performed when managing RBAC using Ansible playbooks:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.1. Permissions in IdM">Permissions in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#default-managed-permissions_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.2. Default managed permissions">Default managed permissions</a>
				</li><li class="listitem">
					<a class="link" href="#privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.3. Privileges in IdM">Privileges in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.4. Roles in IdM">Roles in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#predefined-roles-in-identity-management_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.5. Predefined roles in Identity Management">Predefined roles in IdM</a>
				</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-idm-rbac-role-with-privileges-is-present_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.6. Using Ansible to ensure an IdM RBAC role with privileges is present">Using Ansible to ensure an IdM RBAC role with privileges is present</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-idm-rbac-role-is-absent_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.7. Using Ansible to ensure an IdM RBAC role is absent">Using Ansible to ensure an IdM RBAC role is absent</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-a-group-of-users-is-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.8. Using Ansible to ensure that a group of users is assigned to an IdM RBAC role">Using Ansible to ensure that a group of users is assigned to an IdM RBAC role</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-that-specific-users-are-not-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.9. Using Ansible to ensure that specific users are not assigned to an IdM RBAC role">Using Ansible to ensure that specific users are not assigned to an IdM RBAC role</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-a-service-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.10. Using Ansible to ensure a service is a member of an IdM RBAC role">Using Ansible to ensure a service is a member of an IdM RBAC role</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-a-host-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.11. Using Ansible to ensure a host is a member of an IdM RBAC role">Using Ansible to ensure a host is a member of an IdM RBAC role</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-a-host-group-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.12. Using Ansible to ensure a host group is a member of an IdM RBAC role">Using Ansible to ensure a host group is a member of an IdM RBAC role</a>
				</li></ul></div><section class="section" id="permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.1. Permissions in IdM</h3></div></div></div><p class="_abstract _abstract">
				Permissions are the lowest level unit of role-based access control, they define operations together with the LDAP entries to which those operations apply. Comparable to building blocks, permissions can be assigned to as many privileges as needed.<br> One or more <span class="strong strong"><strong>rights</strong></span> define what operations are allowed:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">write</code>
					</li><li class="listitem">
						<code class="literal">read</code>
					</li><li class="listitem">
						<code class="literal">search</code>
					</li><li class="listitem">
						<code class="literal">compare</code>
					</li><li class="listitem">
						<code class="literal">add</code>
					</li><li class="listitem">
						<code class="literal">delete</code>
					</li><li class="listitem">
						<code class="literal">all</code>
					</li></ul></div><p>
				These operations apply to three basic <span class="strong strong"><strong>targets</strong></span>:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">subtree</code>: a domain name (DN); the subtree under this DN
					</li><li class="listitem">
						<code class="literal">target filter</code>: an LDAP filter
					</li><li class="listitem">
						<code class="literal">target</code>: DN with possible wildcards to specify entries
					</li></ul></div><p>
				Additionally, the following convenience options set the corresponding attribute(s):
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">type</code>: a type of object (user, group, etc); sets <code class="literal">subtree</code> and <code class="literal">target filter</code>
					</li><li class="listitem"><p class="simpara">
						<code class="literal">memberof</code>: members of a group; sets a <code class="literal">target filter</code>
					</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							Setting the <code class="literal">memberof</code> attribute permission is not applied if the target LDAP entry does not contain any reference to group membership.
						</p></div></rh-alert></li><li class="listitem">
						<code class="literal">targetgroup</code>: grants access to modify a specific group (such as granting the rights to manage group membership); sets a <code class="literal">target</code>
					</li></ul></div><p>
				With IdM permissions, you can control which users have access to which objects and even which attributes of these objects. IdM enables you to allow or block individual attributes or change the entire visibility of a specific IdM function, such as users, groups, or sudo, to all anonymous users, all authenticated users, or just a certain group of privileged users.<br> For example, the flexibility of this approach to permissions is useful for an administrator who wants to limit access of users or groups only to the specific sections these users or groups need to access and to make the other sections completely hidden to them.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					A permission cannot contain other permissions.
				</p></div></rh-alert></section><section class="section" id="default-managed-permissions_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.2. Default managed permissions</h3></div></div></div><p class="_abstract _abstract">
				Managed permissions are permissions that come by default with IdM. They behave like other permissions created by the user, with the following differences:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You cannot delete them or modify their name, location, and target attributes.
					</li><li class="listitem"><p class="simpara">
						They have three sets of attributes:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>Default</strong></span> attributes, the user cannot modify them, as they are managed by IdM
							</li><li class="listitem">
								<span class="strong strong"><strong>Included</strong></span> attributes, which are additional attributes added by the user
							</li><li class="listitem">
								<span class="strong strong"><strong>Excluded</strong></span> attributes, which are attributes removed by the user
							</li></ul></div></li></ul></div><p>
				A managed permission applies to all attributes that appear in the default and included attribute sets but not in the excluded set.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					While you cannot delete a managed permission, setting its bind type to permission and removing the managed permission from all privileges effectively disables it.
				</p></div></rh-alert><p>
				Names of all managed permissions start with <code class="literal">System:</code>, for example <code class="literal">System: Add Sudo rule</code> or <code class="literal">System: Modify Services</code>. Earlier versions of IdM used a different scheme for default permissions. For example, the user could not delete them and was only able to assign them to privileges. Most of these default permissions have been turned into managed permissions, however, the following permissions still use the previous scheme:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Add Automember Rebuild Membership Task
					</li><li class="listitem">
						Add Configuration Sub-Entries
					</li><li class="listitem">
						Add Replication Agreements
					</li><li class="listitem">
						Certificate Remove Hold
					</li><li class="listitem">
						Get Certificates status from the CA
					</li><li class="listitem">
						Read DNA Range
					</li><li class="listitem">
						Modify DNA Range
					</li><li class="listitem">
						Read PassSync Managers Configuration
					</li><li class="listitem">
						Modify PassSync Managers Configuration
					</li><li class="listitem">
						Read Replication Agreements
					</li><li class="listitem">
						Modify Replication Agreements
					</li><li class="listitem">
						Remove Replication Agreements
					</li><li class="listitem">
						Read LDBM Database Configuration
					</li><li class="listitem">
						Request Certificate
					</li><li class="listitem">
						Request Certificate ignoring CA ACLs
					</li><li class="listitem">
						Request Certificates from a different host
					</li><li class="listitem">
						Retrieve Certificates from the CA
					</li><li class="listitem">
						Revoke Certificate
					</li><li class="listitem">
						Write IPA Configuration
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you attempt to modify a managed permission from the command line, the system does not allow you to change the attributes that you cannot modify, the command fails. If you attempt to modify a managed permission from the Web UI, the attributes that you cannot modify are disabled.
				</p></div></rh-alert></section><section class="section" id="privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.3. Privileges in IdM</h3></div></div></div><p class="_abstract _abstract">
				A privilege is a group of permissions applicable to a role.<br> While a permission provides the rights to do a single operation, there are certain IdM tasks that require multiple permissions to succeed. Therefore, a privilege combines the different permissions required to perform a specific task.<br> For example, setting up an account for a new IdM user requires the following permissions:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Creating a new user entry
					</li><li class="listitem">
						Resetting a user password
					</li><li class="listitem">
						Adding the new user to the default IPA users group
					</li></ul></div><p>
				Combining these three low-level tasks into a higher level task in the form of a custom privilege named, for example, <span class="strong strong"><strong>Add User</strong></span> makes it easier for a system administrator to manage roles. IdM already contains several default privileges. Apart from users and user groups, privileges are also assigned to hosts and host groups, as well as network services. This practice permits a fine-grained control of operations by a set of users on a set of hosts using specific network services.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					A privilege may not contain other privileges.
				</p></div></rh-alert></section><section class="section" id="roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.4. Roles in IdM</h3></div></div></div><p class="_abstract _abstract">
				A role is a list of privileges that users specified for the role possess.<br> In effect, permissions grant the ability to perform given low-level tasks (such as creating a user entry and adding an entry to a group), privileges combine one or more of these permissions needed for a higher-level task (such as creating a new user in a given group). Roles gather privileges together as needed: for example, a User Administrator role would be able to add, modify, and delete users.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Roles are used to classify permitted actions. They are not used as a tool to implement privilege separation or to protect from privilege escalation.
				</p></div></rh-alert><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Roles can not contain other roles.
				</p></div></rh-alert></section><section class="section" id="predefined-roles-in-identity-management_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.5. Predefined roles in Identity Management</h3></div></div></div><p class="_abstract _abstract">
				Red Hat Identity Management provides the following range of pre-defined roles:
			</p><rh-table id="idm140464239121952"><table class="lt-4-cols lt-7-rows"><caption>Table 12.1. Predefined Roles in Identity Management</caption><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 33%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464228067040" scope="col">Role</th><th align="left" valign="top" id="idm140464228065952" scope="col">Privilege</th><th align="left" valign="top" id="idm140464226069360" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464228067040"> <p>
								Enrollment Administrator
							</p>
							 </td><td align="left" valign="top" headers="idm140464228065952"> <p>
								Host Enrollment
							</p>
							 </td><td align="left" valign="top" headers="idm140464226069360"> <p>
								Responsible for client, or host, enrollment
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464228067040"> <p>
								helpdesk
							</p>
							 </td><td align="left" valign="top" headers="idm140464228065952"> <p>
								Modify Users and Reset passwords, Modify Group membership
							</p>
							 </td><td align="left" valign="top" headers="idm140464226069360"> <p>
								Responsible for performing simple user administration tasks
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464228067040"> <p>
								IT Security Specialist
							</p>
							 </td><td align="left" valign="top" headers="idm140464228065952"> <p>
								Netgroups Administrators, HBAC Administrator, Sudo Administrator
							</p>
							 </td><td align="left" valign="top" headers="idm140464226069360"> <p>
								Responsible for managing security policy such as host-based access controls, sudo rules
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464228067040"> <p>
								IT Specialist
							</p>
							 </td><td align="left" valign="top" headers="idm140464228065952"> <p>
								Host Administrators, Host Group Administrators, Service Administrators, Automount Administrators
							</p>
							 </td><td align="left" valign="top" headers="idm140464226069360"> <p>
								Responsible for managing hosts
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464228067040"> <p>
								Security Architect
							</p>
							 </td><td align="left" valign="top" headers="idm140464228065952"> <p>
								Delegation Administrator, Replication Administrators, Write IPA Configuration, Password Policy Administrator
							</p>
							 </td><td align="left" valign="top" headers="idm140464226069360"> <p>
								Responsible for managing the Identity Management environment, creating trusts, creating replication agreements
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464228067040"> <p>
								User Administrator
							</p>
							 </td><td align="left" valign="top" headers="idm140464228065952"> <p>
								User Administrators, Group Administrators, Stage User Administrators
							</p>
							 </td><td align="left" valign="top" headers="idm140464226069360"> <p>
								Responsible for creating users and groups
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="using-ansible-to-ensure-an-idm-rbac-role-with-privileges-is-present_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.6. Using Ansible to ensure an IdM RBAC role with privileges is present</h3></div></div></div><p class="_abstract _abstract">
				To exercise more granular control over role-based access (RBAC) to resources in Identity Management (IdM) than the default roles provide, create a custom role.
			</p><p>
				The following procedure describes how to use an Ansible playbook to define privileges for a new IdM custom role and ensure its presence. In the example, the new <span class="strong strong"><strong>user_and_host_administrator</strong></span> role contains a unique combination of the following privileges that are present in IdM by default:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<code class="literal">Group Administrators</code>
					</li><li class="listitem">
						<code class="literal">User Administrators</code>
					</li><li class="listitem">
						<code class="literal">Stage User Administrators</code>
					</li><li class="listitem">
						<code class="literal">Group Administrators</code>
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">role-member-user-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/role/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-user-present.yml role-member-user-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">role-member-user-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">iparole</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the new role.
							</li><li class="listitem">
								Set the <code class="literal">privilege</code> list to the names of the IdM privileges that you want to include in the new role.
							</li><li class="listitem">
								Optionally, set the <code class="literal">user</code> variable to the name of the user to whom you want to grant the new role.
							</li><li class="listitem">
								Optionally, set the <code class="literal">group</code> variable to the name of the group to which you want to grant the new role.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA role with members.
  hosts: ipaserver
  become: true
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - iparole:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: user_and_host_administrator</strong></span>
      <span class="strong strong"><strong>user: idm_user01</strong></span>
      <span class="strong strong"><strong>group: idm_group01</strong></span>
      <span class="strong strong"><strong>privilege:</strong></span>
      <span class="strong strong"><strong>- Group Administrators</strong></span>
      <span class="strong strong"><strong>- User Administrators</strong></span>
      <span class="strong strong"><strong>- Stage User Administrators</strong></span>
      <span class="strong strong"><strong>- Group Administrators</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/inventory role-member-user-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>
					</li><li class="listitem">
						<a class="link" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.4. Roles in IdM">Roles in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-role</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/iparole</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-an-idm-rbac-role-is-absent_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.7. Using Ansible to ensure an IdM RBAC role is absent</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator managing role-based access control (RBAC) in Identity Management (IdM), you may want to ensure the absence of an obsolete role so that no administrator assigns it to any user accidentally.
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure a role is absent. The example below describes how to make sure the custom <span class="strong strong"><strong>user_and_host_administrator</strong></span> role does not exist in IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">role-is-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/role/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-is-absent.yml role-is-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">role-is-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">iparole</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the role.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA role with members.
  hosts: ipaserver
  become: true
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - iparole:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: user_and_host_administrator</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/inventory role-is-absent-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>
					</li><li class="listitem">
						<a class="link" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.4. Roles in IdM">Roles in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-role</code> Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/iparole</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-a-group-of-users-is-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.8. Using Ansible to ensure that a group of users is assigned to an IdM RBAC role</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator managing role-based access control (RBAC) in Identity Management (IdM), you may want to assign a role to a specific group of users, for example junior administrators.
			</p><p>
				The following example describes how to use an Ansible playbook to ensure the built-in IdM RBAC <span class="strong strong"><strong>helpdesk</strong></span> role is assigned to <span class="strong strong"><strong>junior_sysadmins</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">role-member-group-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/role/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-group-present.yml role-member-group-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">role-member-group-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">iparole</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the role you want to assign.
							</li><li class="listitem">
								Set the <code class="literal">group</code> variable to the name of the group.
							</li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA role with members.
  hosts: ipaserver
  become: true
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - iparole:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: helpdesk</strong></span>
      <span class="strong strong"><strong>group: junior_sysadmins</strong></span>
      <span class="strong strong"><strong>action: member</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/inventory role-member-group-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>
					</li><li class="listitem">
						<a class="link" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.4. Roles in IdM">Roles in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-role</code> Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/iparole</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-specific-users-are-not-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.9. Using Ansible to ensure that specific users are not assigned to an IdM RBAC role</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator managing role-based access control (RBAC) in Identity Management (IdM), you may want to ensure that an RBAC role is not assigned to specific users after they have, for example, moved to different positions within the company.
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure that the users named <span class="strong strong"><strong>user_01</strong></span> and <span class="strong strong"><strong>user_02</strong></span> are not assigned to the <span class="strong strong"><strong>helpdesk</strong></span> role.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">role-member-user-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/role/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-user-absent.yml role-member-user-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">role-member-user-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">iparole</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the role you want to assign.
							</li><li class="listitem">
								Set the <code class="literal">user</code> list to the names of the users.
							</li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li><li class="listitem">
								Set the <code class="literal">state</code> variable to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA role with members.
  hosts: ipaserver
  become: true
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - iparole:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: helpdesk</strong></span>
      <span class="strong strong"><strong>user</strong></span>
      <span class="strong strong"><strong>- user_01</strong></span>
      <span class="strong strong"><strong>- user_02</strong></span>
      <span class="strong strong"><strong>action: member</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/inventory role-member-user-absent-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>
					</li><li class="listitem">
						<a class="link" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.4. Roles in IdM">Roles in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-role</code> Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/iparole</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-a-service-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.10. Using Ansible to ensure a service is a member of an IdM RBAC role</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator managing role-based access control (RBAC) in Identity Management (IdM), you may want to ensure that a specific service that is enrolled into IdM is a member of a particular role. The following example describes how to ensure that the custom <span class="strong strong"><strong>web_administrator</strong></span> role can manage the <code class="literal">HTTP</code> service that is running on the <span class="strong strong"><strong>client01.idm.example.com</strong></span> server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>web_administrator</strong></span> role exists in IdM.
					</li><li class="listitem">
						The <span class="strong strong"><strong>HTTP/client01.idm.example.com@IDM.EXAMPLE.COM</strong></span> service exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">role-member-service-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/role/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-service-present-absent.yml role-member-service-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">role-member-service-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">iparole</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the role you want to assign.
							</li><li class="listitem">
								Set the <code class="literal">service</code> list to the name of the service.
							</li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA role with members.
  hosts: ipaserver
  become: true
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - iparole:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: web_administrator</strong></span>
      <span class="strong strong"><strong>service:</strong></span>
      <span class="strong strong"><strong>- HTTP/client01.idm.example.com</strong></span>
      <span class="strong strong"><strong>action: member</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/inventory role-member-service-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>
					</li><li class="listitem">
						<a class="link" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.4. Roles in IdM">Roles in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-role</code> Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						The sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/iparole</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-a-host-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.11. Using Ansible to ensure a host is a member of an IdM RBAC role</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator managing role-based access control in Identity Management (IdM), you may want to ensure that a specific host or host group is associated with a specific role. The following example describes how to ensure that the custom <span class="strong strong"><strong>web_administrator</strong></span> role can manage the <span class="strong strong"><strong>client01.idm.example.com</strong></span> IdM host on which the <code class="literal">HTTP</code> service is running.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>web_administrator</strong></span> role exists in IdM.
					</li><li class="listitem">
						The <span class="strong strong"><strong>client01.idm.example.com</strong></span> host exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">role-member-host-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/role/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-host-present.yml role-member-host-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">role-member-host-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">iparole</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the role you want to assign.
							</li><li class="listitem">
								Set the <code class="literal">host</code> list to the name of the host.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA role with members.
  hosts: ipaserver
  become: true
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - iparole:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: web_administrator</strong></span>
      host:
      <span class="strong strong"><strong>- client01.idm.example.com</strong></span>
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/inventory role-member-host-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>
					</li><li class="listitem">
						<a class="link" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.4. Roles in IdM">Roles in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-role</code> Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/iparole</code> directory
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-a-host-group-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm"><div class="titlepage"><div><div><h3 class="title">12.12. Using Ansible to ensure a host group is a member of an IdM RBAC role</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator managing role-based access control in Identity Management (IdM), you may want to ensure that a specific host or host group is associated with a specific role. The following example describes how to ensure that the custom <span class="strong strong"><strong>web_administrator</strong></span> role can manage the <span class="strong strong"><strong>web_servers</strong></span> group of IdM hosts on which the <code class="literal">HTTP</code> service is running.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>web_administrator</strong></span> role exists in IdM.
					</li><li class="listitem">
						The <span class="strong strong"><strong>web_servers</strong></span> host group exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">role-member-hostgroup-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/role/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-hostgroup-present.yml role-member-hostgroup-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">role-member-hostgroup-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">iparole</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the role you want to assign.
							</li><li class="listitem">
								Set the <code class="literal">hostgroup</code> list to the name of the hostgroup.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA role with members.
  hosts: ipaserver
  become: true
  gather_facts: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - iparole:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: web_administrator</strong></span>
      hostgroup:
      <span class="strong strong"><strong>- web_servers</strong></span>
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i ~/<span class="emphasis"><em>&lt;MyPlaybooks&gt;</em></span>/inventory role-member-hostgroup-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://docs.ansible.com/ansible/latest/user_guide/vault.html">Encrypting content with Ansible Vault</a>
					</li><li class="listitem">
						<a class="link" href="#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.4. Roles in IdM">Roles in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-role</code> Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						The sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/iparole</code> directory
					</li></ul></div></section></section><section class="chapter" id="using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 13. Using Ansible playbooks to manage RBAC privileges</h2></div></div></div><p class="_abstract _abstract">
			Role-based access control (RBAC) is a policy-neutral access-control mechanism defined around roles, privileges, and permissions. Especially in large companies, using RBAC can help create a hierarchical system of administrators with their individual areas of responsibility.
		</p><p>
			This chapter describes the following operations for using Ansible playbooks to manage RBAC privileges in Identity Management (IdM):
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges" title="13.1. Using Ansible to ensure a custom IdM RBAC privilege is present">Using Ansible to ensure a custom RBAC privilege is present</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-member-permissions-are-present-in-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges" title="13.2. Using Ansible to ensure member permissions are present in a custom IdM RBAC privilege">Using Ansible to ensure member permissions are present in a custom IdM RBAC privilege</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-idm-rbac-privilege-does-not-include-a-permission_using-ansible-playbooks-to-manage-rbac-privileges" title="13.3. Using Ansible to ensure an IdM RBAC privilege does not include a permission">Using Ansible to ensure an IdM RBAC privilege does not include a permission</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-rename-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges" title="13.4. Using Ansible to rename a custom IdM RBAC privilege">Using Ansible to rename a custom IdM RBAC privilege</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-idm-rbac-privilege-is-absent_using-ansible-playbooks-to-manage-rbac-privileges" title="13.5. Using Ansible to ensure an IdM RBAC privilege is absent">Using Ansible to ensure an IdM RBAC privilege is absent</a>
				</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					You understand the <a class="link" href="#using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management" title="Chapter 12. Using Ansible playbooks to manage role-based access control in IdM">concepts and principles of RBAC</a>.
				</li></ul></div><section class="section" id="using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges"><div class="titlepage"><div><div><h3 class="title">13.1. Using Ansible to ensure a custom IdM RBAC privilege is present</h3></div></div></div><p class="_abstract _abstract">
				To have a fully-functioning custom privilege in Identity Management (IdM) role-based access control (RBAC), you need to proceed in stages:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Create a privilege with no permissions attached.
					</li><li class="listitem">
						Add permissions of your choice to the privilege.
					</li></ol></div><p>
				The following procedure describes how to create an empty privilege using an Ansible playbook so that you can later add permissions to it. The example describes how to create a privilege named <span class="strong strong"><strong>full_host_administration</strong></span> that is meant to combine all IdM permissions related to host administration.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">privilege-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/privilege/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-present.yml privilege-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">privilege-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaprivilege</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the new privilege, <span class="strong strong"><strong>full_host_administration</strong></span>.
							</li><li class="listitem">
								Optionally, describe the privilege using the <code class="literal">description</code> variable.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Privilege present example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure privilege full_host_administration is present
    ipaprivilege:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: full_host_administration</strong></span>
      <span class="strong strong"><strong>description: This privilege combines all IdM permissions related to host administration</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory privilege-present-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-ensure-member-permissions-are-present-in-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges"><div class="titlepage"><div><div><h3 class="title">13.2. Using Ansible to ensure member permissions are present in a custom IdM RBAC privilege</h3></div></div></div><p class="_abstract _abstract">
				To have a fully-functioning custom privilege in Identity Management (IdM) role-based access control (RBAC), you need to proceed in stages:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Create a privilege with no permissions attached.
					</li><li class="listitem">
						Add permissions of your choice to the privilege.
					</li></ol></div><p>
				The following procedure describes how to use an Ansible playbook to add permissions to a privilege created in the previous step. The example describes how to add all IdM permissions related to host administration to a privilege named <span class="strong strong"><strong>full_host_administration</strong></span>. By default, the permissions are distributed between the <code class="literal">Host Enrollment</code>, <code class="literal">Host Administrators</code> and <code class="literal">Host Group Administrator</code> privileges.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong><span class="emphasis"><em>full_host_administration</em></span></strong></span> privilege exists. For information about how to create a privilege using Ansible, see <a class="link" href="#using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges" title="13.1. Using Ansible to ensure a custom IdM RBAC privilege is present">Using Ansible to ensure a custom IdM RBAC privilege is present</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">privilege-member-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/privilege/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-member-present.yml privilege-member-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">privilege-member-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaprivilege</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the privilege.
							</li><li class="listitem">
								Set the <code class="literal">permission</code> list to the names of the permissions that you want to include in the privilege.
							</li><li class="listitem">
								Make sure that the <code class="literal">action</code> variable is set to <code class="literal">member</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Privilege member present example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure that permissions are present for the "full_host_administration" privilege
    ipaprivilege:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: full_host_administration</strong></span>
      <span class="strong strong"><strong>permission:</strong></span>
      - "System: Add krbPrincipalName to a Host"
      - "System: Enroll a Host"
      - "System: Manage Host Certificates"
      - "System: Manage Host Enrollment Password"
      - "System: Manage Host Keytab"
      - "System: Manage Host Principals"
      - "Retrieve Certificates from the CA"
      - "Revoke Certificate"
      - "System: Add Hosts"
      - "System: Add krbPrincipalName to a Host"
      - "System: Enroll a Host"
      - "System: Manage Host Certificates"
      - "System: Manage Host Enrollment Password"
      - "System: Manage Host Keytab"
      - "System: Manage Host Keytab Permissions"
      - "System: Manage Host Principals"
      - "System: Manage Host SSH Public Keys"
      - "System: Manage Service Keytab"
      - "System: Manage Service Keytab Permissions"
      - "System: Modify Hosts"
      - "System: Remove Hosts"
      - "System: Add Hostgroups"
      - "System: Modify Hostgroup Membership"
      - "System: Modify Hostgroups"
      - "System: Remove Hostgroups"</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory privilege-member-present-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-ensure-an-idm-rbac-privilege-does-not-include-a-permission_using-ansible-playbooks-to-manage-rbac-privileges"><div class="titlepage"><div><div><h3 class="title">13.3. Using Ansible to ensure an IdM RBAC privilege does not include a permission</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control.
			</p><p>
				The following procedure describes how to use an Ansible playbook to remove a permission from a privilege. The example describes how to remove the <code class="literal">Request Certificates ignoring CA ACLs</code> permission from the default <code class="literal">Certificate Administrators</code> privilege because, for example, the administrator considers it a security risk.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">privilege-member-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/privilege/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-member-absent.yml privilege-member-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">privilege-member-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaprivilege</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the privilege.
							</li><li class="listitem">
								Set the <code class="literal">permission</code> list to the names of the permissions that you want to remove from the privilege.
							</li><li class="listitem">
								Make sure that the <code class="literal">action</code> variable is set to <code class="literal">member</code>.
							</li><li class="listitem">
								Make sure that the <code class="literal">state</code> variable is set to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Privilege absent example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure that the "Request Certificate ignoring CA ACLs" permission is absent from the "Certificate Administrators" privilege
    ipaprivilege:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: Certificate Administrators</strong></span>
      <span class="strong strong"><strong>permission:</strong></span>
      <span class="strong strong"><strong>- "Request Certificate ignoring CA ACLs"</strong></span>
      <span class="strong strong"><strong>action: member</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory privilege-member-absent-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-rename-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges"><div class="titlepage"><div><div><h3 class="title">13.4. Using Ansible to rename a custom IdM RBAC privilege</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control.
			</p><p>
				The following procedure describes how to rename a privilege because, for example, you have removed a few permissions from it. As a result, the name of the privilege is no longer accurate. In the example, the administrator renames a <span class="strong strong"><strong>full_host_administration</strong></span> privilege to <span class="strong strong"><strong>limited_host_administration</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong><span class="emphasis"><em>full_host_administration</em></span></strong></span> privilege exists. For more information about how to add a privilege, see <a class="link" href="#using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges" title="13.1. Using Ansible to ensure a custom IdM RBAC privilege is present">Using Ansible to ensure a custom IdM RBAC privilege is present</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">privilege-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/privilege/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-present.yml rename-privilege.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">rename-privilege.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaprivilege</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the current name of the privilege.
							</li><li class="listitem">
								Add the <code class="literal">rename</code> variable and set it to the new name of the privilege.
							</li><li class="listitem">
								Add the <code class="literal">state</code> variable and set it to <code class="literal">renamed</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Rename the playbook itself, for example:
					</p><pre class="literallayout">---
- <span class="strong strong"><strong>name: Rename a privilege</strong></span>
  hosts: ipaserver</pre></li><li class="listitem"><p class="simpara">
						Rename the task in the playbook, for example:
					</p><pre class="literallayout">[...]
tasks:
- <span class="strong strong"><strong>name: Ensure the full_host_administration privilege is renamed to limited_host_administration</strong></span>
  ipaprivilege:
  [...]</pre><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- <span class="strong strong"><strong>name: Rename a privilege</strong></span>
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure the full_host_administration privilege is renamed to limited_host_administration</strong></span>
    ipaprivilege:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: full_host_administration</strong></span>
      <span class="strong strong"><strong>rename: limited_host_administration</strong></span>
      <span class="strong strong"><strong>state: renamed</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory rename-privilege.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-ensure-an-idm-rbac-privilege-is-absent_using-ansible-playbooks-to-manage-rbac-privileges"><div class="titlepage"><div><div><h3 class="title">13.5. Using Ansible to ensure an IdM RBAC privilege is absent</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control. The following procedure describes how to use an Ansible playbook to ensure that an RBAC privilege is absent. The example describes how to ensure that the <code class="literal">CA administrator</code> privilege is absent. As a result of the procedure, the <code class="literal">admin</code> administrator becomes the only user capable of managing certificate authorities in IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">privilege-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/privilege/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-absent.yml privilege-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">privilege-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaprivilege</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the privilege you want to remove.
							</li><li class="listitem">
								Make sure that the <code class="literal">state</code> variable is set it to <code class="literal">absent</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						Rename the task in the playbook, for example:
					</p><pre class="literallayout">[...]
tasks:
- <span class="strong strong"><strong>name: Ensure privilege "CA administrator" is absent</strong></span>
  ipaprivilege:
  [...]</pre><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Privilege absent example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure privilege "CA administrator" is absent</strong></span>
    ipaprivilege:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: CA administrator</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory privilege-absent-copy.yml</strong></span></pre></li></ol></div></section><section class="section _additional-resources" id="additional_resources_3"><div class="titlepage"><div><div><h3 class="title">13.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See <a class="link" href="#privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.3. Privileges in IdM">Privileges in IdM</a>.
					</li><li class="listitem">
						See <a class="link" href="#permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.1. Permissions in IdM">Permissions in IdM</a>.
					</li><li class="listitem">
						See the <code class="literal">README-privilege</code> file available in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See the sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/ipaprivilege</code> directory.
					</li></ul></div></section></section><section class="chapter" id="using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 14. Using Ansible playbooks to manage RBAC permissions in IdM</h2></div></div></div><p class="_abstract _abstract">
			Role-based access control (RBAC) is a policy-neutral access control mechanism defined around roles, privileges, and permissions. Especially in large companies, using RBAC can help create a hierarchical system of administrators with their individual areas of responsibility.
		</p><p>
			This chapter describes the following operations performed when managing RBAC permissions in Identity Management (IdM) using Ansible playbooks:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-rbac-permission-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" title="14.1. Using Ansible to ensure an RBAC permission is present">Using Ansible to ensure an RBAC permission is present</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-rbac-permission-with-an-attribute-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" title="14.2. Using Ansible to ensure an RBAC permission with an attribute is present">Using Ansible to ensure an RBAC permission with an attribute is present</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-rbac-permission-is-absent_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" title="14.3. Using Ansible to ensure an RBAC permission is absent">Using Ansible to ensure an RBAC permission is absent</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-attribute-is-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" title="14.4. Using Ansible to ensure an attribute is a member of an IdM RBAC permission">Using Ansible to ensure an attribute is a member of an IdM RBAC permission</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-attribute-is-not-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" title="14.5. Using Ansible to ensure an attribute is not a member of an IdM RBAC permission">Using Ansible to ensure an attribute is not a member of an IdM RBAC permission</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-rename-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm" title="14.6. Using Ansible to rename an IdM RBAC permission">Using Ansible to rename an IdM RBAC permission</a>
				</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					You understand the <a class="link" href="#using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management" title="Chapter 12. Using Ansible playbooks to manage role-based access control in IdM">concepts and principles of RBAC</a>.
				</li></ul></div><section class="section" id="using-ansible-to-ensure-an-rbac-permission-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm"><div class="titlepage"><div><div><h3 class="title">14.1. Using Ansible to ensure an RBAC permission is present</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure a permission is present in IdM so that it can be added to a privilege. The example describes how to ensure the following target state:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">MyPermission</code> permission exists.
					</li><li class="listitem">
						The <code class="literal">MyPermission</code> permission can only be applied to hosts.
					</li><li class="listitem"><p class="simpara">
						A user granted a privilege that contains the permission can do all of the following possible operations on an entry:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Write
							</li><li class="listitem">
								Read
							</li><li class="listitem">
								Search
							</li><li class="listitem">
								Compare
							</li><li class="listitem">
								Add
							</li><li class="listitem">
								Delete
							</li></ul></div></li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">permission-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/permission/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-present.yml permission-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">permission-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipapermission</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the permission.
							</li><li class="listitem">
								Set the <code class="literal">object_type</code> variable to <code class="literal">host</code>.
							</li><li class="listitem">
								Set the <code class="literal">right</code> variable to <code class="literal">all</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Permission present example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure that the "MyPermission" permission is present</strong></span>
    ipapermission:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: MyPermission</strong></span>
      <span class="strong strong"><strong>object_type: host</strong></span>
      <span class="strong strong"><strong>right: all</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-present-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-ensure-an-rbac-permission-with-an-attribute-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm"><div class="titlepage"><div><div><h3 class="title">14.2. Using Ansible to ensure an RBAC permission with an attribute is present</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure a permission is present in IdM so that it can be added to a privilege. The example describes how to ensure the following target state:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <span class="strong strong"><strong>MyPermission</strong></span> permission exists.
					</li><li class="listitem">
						The <span class="strong strong"><strong>MyPermission</strong></span> permission can only be used to add hosts.
					</li><li class="listitem"><p class="simpara">
						A user granted a privilege that contains the permission can do all of the following possible operations on a host entry:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								Write
							</li><li class="listitem">
								Read
							</li><li class="listitem">
								Search
							</li><li class="listitem">
								Compare
							</li><li class="listitem">
								Add
							</li><li class="listitem">
								Delete
							</li></ul></div></li><li class="listitem">
						The host entries created by a user that is granted a privilege that contains the <span class="strong strong"><strong>MyPermission</strong></span> permission can have a <code class="literal">description</code> value.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The type of attribute that you can specify when creating or modifying a permission is not constrained by the IdM LDAP schema. However, specifying, for example, <code class="literal">attrs: car_licence</code> if the <code class="literal">object_type</code> is <code class="literal">host</code> later results in the <code class="literal">ipa: ERROR: attribute "car-license" not allowed</code> error message when you try to exercise the permission and add a specific car licence value to a host.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">permission-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/permission/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-present.yml permission-present-with-attribute.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">permission-present-with-attribute.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipapermission</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the permission.
							</li><li class="listitem">
								Set the <code class="literal">object_type</code> variable to <code class="literal">host</code>.
							</li><li class="listitem">
								Set the <code class="literal">right</code> variable to <code class="literal">all</code>.
							</li><li class="listitem">
								Set the <code class="literal">attrs</code> variable to <code class="literal">description</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Permission present example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure that the "MyPermission" permission is present with an attribute</strong></span>
    ipapermission:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: MyPermission</strong></span>
      <span class="strong strong"><strong>object_type: host</strong></span>
      <span class="strong strong"><strong>right: all</strong></span>
      <span class="strong strong"><strong>attrs: description</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-present-with-attribute.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/user-schema">User and group schema</a> in <span class="emphasis"><em>Linux Domain Identity, Authentication and Policy Guide</em></span> in RHEL 7.
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-an-rbac-permission-is-absent_using-ansible-playbooks-to-manage-rbac-permissions-in-idm"><div class="titlepage"><div><div><h3 class="title">14.3. Using Ansible to ensure an RBAC permission is absent</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure a permission is absent in IdM so that it cannot be added to a privilege.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">permission-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/permission/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-absent.yml permission-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">permission-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipapermission</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the permission.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Permission absent example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure that the "MyPermission" permission is absent</strong></span>
    ipapermission:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: MyPermission</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-absent-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-ensure-an-attribute-is-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm"><div class="titlepage"><div><div><h3 class="title">14.4. Using Ansible to ensure an attribute is a member of an IdM RBAC permission</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure that an attribute is a member of an RBAC permission in IdM. As a result, a user with the permission can create entries that have the attribute.
			</p><p>
				The example describes how to ensure that the host entries created by a user with a privilege that contains the <span class="strong strong"><strong>MyPermission</strong></span> permission can have <code class="literal">gecos</code> and <code class="literal">description</code> values.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The type of attribute that you can specify when creating or modifying a permission is not constrained by the IdM LDAP schema. However, specifying, for example, <code class="literal">attrs: car_licence</code> if the <code class="literal">object_type</code> is <code class="literal">host</code> later results in the <code class="literal">ipa: ERROR: attribute "car-license" not allowed</code> error message when you try to exercise the permission and add a specific car licence value to a host.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>MyPermission</strong></span> permission exists.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">permission-member-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/permission/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-member-present.yml permission-member-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">permission-member-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipapermission</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the permission.
							</li><li class="listitem">
								Set the <code class="literal">attrs</code> list to the <code class="literal">description</code> and <code class="literal">gecos</code> variables.
							</li><li class="listitem">
								Make sure the <code class="literal">action</code> variable is set to <code class="literal">member</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Permission member present example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure that the "gecos" and "description" attributes are present in "MyPermission"</strong></span>
    ipapermission:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: MyPermission</strong></span>
      <span class="strong strong"><strong>attrs:</strong></span>
      <span class="strong strong"><strong>- description</strong></span>
      <span class="strong strong"><strong>- gecos</strong></span>
      <span class="strong strong"><strong>action: member</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-member-present-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-ensure-an-attribute-is-not-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm"><div class="titlepage"><div><div><h3 class="title">14.5. Using Ansible to ensure an attribute is not a member of an IdM RBAC permission</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure that an attribute is not a member of an RBAC permission in IdM. As a result, when a user with the permission creates an entry in IdM LDAP, that entry cannot have a value associated with the attribute.
			</p><p>
				The example describes how to ensure the following target state:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <span class="strong strong"><strong>MyPermission</strong></span> permission exists.
					</li><li class="listitem">
						The host entries created by a user with a privilege that contains the <span class="strong strong"><strong>MyPermission</strong></span> permission cannot have the <code class="literal">description</code> attribute.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>MyPermission</strong></span> permission exists.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">permission-member-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/permission/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-member-absent.yml permission-member-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">permission-member-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipapermission</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the permission.
							</li><li class="listitem">
								Set the <code class="literal">attrs</code> variable to <code class="literal">description</code>.
							</li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li><li class="listitem">
								Make sure the <code class="literal">state</code> variable is set to <code class="literal">absent</code>
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Permission absent example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure that an attribute is not a member of "MyPermission"</strong></span>
    ipapermission:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: MyPermission</strong></span>
      <span class="strong strong"><strong>attrs: description</strong></span>
      <span class="strong strong"><strong>action: member</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-member-absent-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-rename-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm"><div class="titlepage"><div><div><h3 class="title">14.6. Using Ansible to rename an IdM RBAC permission</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can customize the IdM role-based access control.
			</p><p>
				The following procedure describes how to use an Ansible playbook to rename a permission. The example describes how to rename <span class="strong strong"><strong>MyPermission</strong></span> to <span class="strong strong"><strong>MyNewPermission</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The <span class="strong strong"><strong>MyPermission</strong></span> exists in IdM.
					</li><li class="listitem">
						The <span class="strong strong"><strong>MyNewPermission</strong></span> does not exist in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">permission-renamed.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/permission/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-renamed.yml permission-renamed-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">permission-renamed-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipapermission</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the permission.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Permission present example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Rename the "MyPermission" permission</strong></span>
    ipapermission:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: MyPermission</strong></span>
      <span class="strong strong"><strong>rename: MyNewPermission</strong></span>
      <span class="strong strong"><strong>state: renamed</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-renamed-copy.yml</strong></span></pre></li></ol></div></section><section class="section _additional-resources" id="additional_resources_4"><div class="titlepage"><div><div><h3 class="title">14.7. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See <a class="link" href="#permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.1. Permissions in IdM">Permissions in IdM</a>.
					</li><li class="listitem">
						See <a class="link" href="#privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm" title="12.3. Privileges in IdM">Privileges in IdM</a>.
					</li><li class="listitem">
						See the <code class="literal">README-permission</code> file available in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See the sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/ipapermission</code> directory.
					</li></ul></div></section></section><section class="chapter" id="using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 15. Using Ansible to manage the replication topology in IdM</h2></div></div></div><p class="_abstract _abstract">
			You can maintain multiple Identity Management (IdM) servers and let them replicate each other for redundancy purposes to mitigate or prevent server loss. For example, if one server fails, the other servers keep providing services to the domain. You can also recover the lost server by creating a new replica based on one of the remaining servers.
		</p><p>
			Data stored on an IdM server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. The data that is replicated is stored in the topology <code class="literal">suffixes</code>. When two replicas have a replication agreement between their suffixes, the suffixes form a topology <code class="literal">segment</code>.
		</p><p>
			This chapter describes how to use Ansible to manage IdM replication agreements, topology segments, and topology suffixes.
		</p><section class="section" id="using-ansible-to-ensure-a-replication-agreement-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm"><div class="titlepage"><div><div><h3 class="title">15.1. Using Ansible to ensure a replication agreement exists in IdM</h3></div></div></div><p class="_abstract _abstract">
				Data stored on an Identity Management (IdM) server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. Replication agreements are always bilateral: the data is replicated from the first replica to the other one as well as from the other replica to the first one.
			</p><p>
				Follow this procedure to use an Ansible playbook to ensure that a replication agreement of the <code class="literal">domain</code> type exists between <span class="strong strong"><strong>server.idm.example.com</strong></span> and <span class="strong strong"><strong>replica.idm.example.com</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Ensure that you understand the recommendations for designing your IdM topology listed in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#guidelines-for-connecting-idm-replicas-in-a-topology_planning-the-replica-topology">Guidelines for connecting IdM replicas in a topology</a>.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code> and that you have access to a file that stores the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">add-topologysegment.yml</code> Ansible playbook file provided by the <code class="literal">ansible-freeipa</code> package:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/add-topologysegment.yml add-topologysegment-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">add-topologysegment-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipatopologysegment</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Indicate that the value of the <code class="literal">ipaadmin_password</code> variable is defined in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault file.
							</li><li class="listitem">
								Set the <code class="literal">suffix</code> variable to either <code class="literal">domain</code> or <code class="literal">ca</code>, depending on what type of segment you want to add.
							</li><li class="listitem">
								Set the <code class="literal">left</code> variable to the name of the IdM server that you want to be the left node of the replication agreement.
							</li><li class="listitem">
								Set the <code class="literal">right</code> variable to the name of the IdM server that you want to be the right node of the replication agreement.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">present</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to handle topologysegment
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
- name: Add topology segment
    ipatopologysegment:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>suffix: domain</strong></span>
      <span class="strong strong"><strong>left: server.idm.example.com</strong></span>
      <span class="strong strong"><strong>right: replica.idm.example.com</strong></span>
      <span class="strong strong"><strong>state: present</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory add-topologysegment-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology">Explaining Replication Agreements, Topology Suffixes, and Topology Segments</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-topology.md</code>
					</li><li class="listitem">
						Sample playbooks in <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/topology</code>
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-replication-agreements-exist-between-multiple-idm-replicas_using-ansible-to-manage-the-replication-topology-in-idm"><div class="titlepage"><div><div><h3 class="title">15.2. Using Ansible to ensure replication agreements exist between multiple IdM replicas</h3></div></div></div><p class="_abstract _abstract">
				Data stored on an Identity Management (IdM) server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. Replication agreements are always bilateral: the data is replicated from the first replica to the other one as well as from the other replica to the first one.
			</p><p>
				Follow this procedure to ensure replication agreements exist between multiple pairs of replicas in IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Ensure that you understand the recommendations for designing your IdM topology listed in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#guidelines-for-connecting-idm-replicas-in-a-topology_planning-the-replica-topology">Connecting the replicas in a topology</a>.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code> and that you have access to a file that stores the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">add-topologysegments.yml</code> Ansible playbook file provided by the <code class="literal">ansible-freeipa</code> package:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/add-topologysegments.yml add-topologysegments-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">add-topologysegments-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">vars</code> section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Indicate that the value of the <code class="literal">ipaadmin_password</code> variable is defined in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault file.
							</li><li class="listitem"><p class="simpara">
								For every topology segment, add a line in the <code class="literal">ipatopology_segments</code> section and set the following variables:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">suffix</code> variable to either <code class="literal">domain</code> or <code class="literal">ca</code>, depending on what type of segment you want to add.
									</li><li class="listitem">
										Set the <code class="literal">left</code> variable to the name of the IdM server that you want to be the left node of the replication agreement.
									</li><li class="listitem">
										Set the <code class="literal">right</code> variable to the name of the IdM server that you want to be the right node of the replication agreement.
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						In the <code class="literal">tasks</code> section of the <code class="literal">add-topologysegments-copy.yml</code> file, ensure that the <code class="literal">state</code> variable is set to <code class="literal">present</code>.
					</p><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Add topology segments
  hosts: ipaserver
  gather_facts: false

  vars:
    <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
    ipatopology_segments:
    - {suffix: domain, left: <span class="strong strong"><strong>replica1.idm.example.com</strong></span> , right: <span class="strong strong"><strong>replica2.idm.example.com</strong></span> }
    - {suffix: domain, left: <span class="strong strong"><strong>replica2.idm.example.com</strong></span> , right: <span class="strong strong"><strong>replica3.idm.example.com</strong></span> }
    - {suffix: domain, left: <span class="strong strong"><strong>replica3.idm.example.com</strong></span> , right: <span class="strong strong"><strong>replica4.idm.example.com</strong></span> }
    - {suffix: domain+ca, left: <span class="strong strong"><strong>replica4.idm.example.com</strong></span> , right: <span class="strong strong"><strong>replica1.idm.example.com</strong></span> }

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Add topology segment
    ipatopologysegment:
      ipaadmin_password: "{{ ipaadmin_password }}"
      suffix: "{{ item.suffix }}"
      name: "{{ item.name | default(omit) }}"
      left: "{{ item.left }}"
      right: "{{ item.right }}"
      <span class="strong strong"><strong>state: present</strong></span>
    loop: "{{ ipatopology_segments | default([]) }}"</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory add-topologysegments-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology">Explaining Replication Agreements, Topology Suffixes, and Topology Segments</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-topology.md</code>
					</li><li class="listitem">
						Sample playbooks in <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/topology</code>
					</li></ul></div></section><section class="section" id="using-ansible-to-check-if-a-replication-agreement-exists-between-two-replicas_using-ansible-to-manage-the-replication-topology-in-idm"><div class="titlepage"><div><div><h3 class="title">15.3. Using Ansible to check if a replication agreement exists between two replicas</h3></div></div></div><p class="_abstract _abstract">
				Data stored on an Identity Management (IdM) server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. Replication agreements are always bilateral: the data is replicated from the first replica to the other one as well as from the other replica to the first one.
			</p><p>
				Follow this procedure to verify that replication agreements exist between multiple pairs of replicas in IdM. In contrast to <a class="link" href="#using-ansible-to-ensure-a-replication-agreement-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm" title="15.1. Using Ansible to ensure a replication agreement exists in IdM">Using Ansible to ensure a replication agreement exists in IdM</a>, this procedure does not modify the existing configuration.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Ensure that you understand the recommendations for designing your Identity Management (IdM) topology listed in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#guidelines-for-connecting-idm-replicas-in-a-topology_planning-the-replica-topology">Connecting the replicas in a topology</a>.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code> and that you have access to a file that stores the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">check-topologysegments.yml</code> Ansible playbook file provided by the <code class="literal">ansible-freeipa</code> package:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/check-topologysegments.yml check-topologysegments-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">check-topologysegments-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">vars</code> section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Indicate that the value of the <code class="literal">ipaadmin_password</code> variable is defined in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault file.
							</li><li class="listitem"><p class="simpara">
								For every topology segment, add a line in the <code class="literal">ipatopology_segments</code> section and set the following variables:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">suffix</code> variable to either <code class="literal">domain</code> or <code class="literal">ca</code>, depending on the type of segment you are adding.
									</li><li class="listitem">
										Set the <code class="literal">left</code> variable to the name of the IdM server that you want to be the left node of the replication agreement.
									</li><li class="listitem">
										Set the <code class="literal">right</code> variable to the name of the IdM server that you want to be the right node of the replication agreement.
									</li></ul></div></li></ul></div></li><li class="listitem"><p class="simpara">
						In the <code class="literal">tasks</code> section of the <code class="literal">check-topologysegments-copy.yml</code> file, ensure that the <code class="literal">state</code> variable is set to <code class="literal">present</code>.
					</p><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Add topology segments
  hosts: ipaserver
  gather_facts: false

  vars:
    <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
    <span class="strong strong"><strong>ipatopology_segments:</strong></span>
    - <span class="strong strong"><strong>{suffix: domain, left: replica1.idm.example.com, right: replica2.idm.example.com }</strong></span>
    - <span class="strong strong"><strong>{suffix: domain, left: replica2.idm.example.com , right: replica3.idm.example.com }</strong></span>
    - <span class="strong strong"><strong>{suffix: domain, left: replica3.idm.example.com , right: replica4.idm.example.com }</strong></span>
    - <span class="strong strong"><strong>{suffix: domain+ca, left: replica4.idm.example.com , right: replica1.idm.example.com }</strong></span>

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Check topology segment
    ipatopologysegment:
      ipaadmin_password: "{{ ipaadmin_password }}"
      suffix: "{{ item.suffix }}"
      name: "{{ item.name | default(omit) }}"
      left: "{{ item.left }}"
      right: "{{ item.right }}"
      state: <span class="strong strong"><strong>checked</strong></span>
    loop: "{{ ipatopology_segments | default([]) }}"</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory check-topologysegments-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology">Explaining Replication Agreements, Topology Suffixes, and Topology Segments</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-topology.md</code>
					</li><li class="listitem">
						Sample playbooks in <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/topology</code>
					</li></ul></div></section><section class="section" id="using-ansible-to-verify-that-a-topology-suffix-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm"><div class="titlepage"><div><div><h3 class="title">15.4. Using Ansible to verify that a topology suffix exists in IdM</h3></div></div></div><p class="_abstract _abstract">
				In the context of replication agreements in Identity Management (IdM), topology suffixes store the data that is replicated. IdM supports two types of topology suffixes: <code class="literal">domain</code> and <code class="literal">ca</code>. Each suffix represents a separate back end, a separate replication topology. When a replication agreement is configured, it joins two topology suffixes of the same type on two different servers.
			</p><p>
				The <code class="literal">domain</code> suffix contains all domain-related data, such as data about users, groups, and policies. The <code class="literal">ca</code> suffix contains data for the Certificate System component. It is only present on servers with a certificate authority (CA) installed.
			</p><p>
				Follow this procedure to use an Ansible playbook to ensure that a topology suffix exists in IdM. The example describes how to ensure that the <code class="literal">domain</code> suffix exists in IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code> and that you have access to a file that stores the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">verify-topologysuffix.yml</code> Ansible playbook file provided by the <code class="literal">ansible-freeipa</code> package:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/ verify-topologysuffix.yml verify-topologysuffix-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">verify-topologysuffix-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipatopologysuffix</code> section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Indicate that the value of the <code class="literal">ipaadmin_password</code> variable is defined in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault file.
							</li><li class="listitem">
								Set the <code class="literal">suffix</code> variable to <code class="literal">domain</code>. If you are verifying the presence of the <code class="literal">ca</code> suffix, set the variable to <code class="literal">ca</code>.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">verified</code>. No other option is possible.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to handle topologysuffix
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Verify topology suffix
    ipatopologysuffix:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>suffix: domain</strong></span>
      <span class="strong strong"><strong>state: verified</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory verify-topologysuffix-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology">Explaining Replication Agreements, Topology Suffixes, and Topology Segments</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-topology.md</code>
					</li><li class="listitem">
						Sample playbooks in <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/topology</code>
					</li></ul></div></section><section class="section" id="using-ansible-to-reinitialize-an-idm-replica_using-ansible-to-manage-the-replication-topology-in-idm"><div class="titlepage"><div><div><h3 class="title">15.5. Using Ansible to reinitialize an IdM replica</h3></div></div></div><p class="_abstract _abstract">
				If a replica has been offline for a long period of time or its database has been corrupted, you can reinitialize it. Reinitialization refreshes the replica with an updated set of data. Reinitialization can, for example, be used if an authoritative restore from backup is required.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In contrast to replication updates, during which replicas only send changed entries to each other, reinitialization refreshes the whole database.
				</p></div></rh-alert><p>
				The local host on which you run the command is the reinitialized replica. To specify the replica from which the data is obtained, use the <code class="literal">direction</code> option.
			</p><p>
				Follow this procedure to use an Ansible playbook to reinitialize the <code class="literal">domain</code> data on <span class="strong strong"><strong>replica.idm.example.com</strong></span> from <span class="strong strong"><strong>server.idm.example.com</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code> and that you have access to a file that stores the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">reinitialize-topologysegment.yml</code> Ansible playbook file provided by the <code class="literal">ansible-freeipa</code> package:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/reinitialize-topologysegment.yml reinitialize-topologysegment-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">reinitialize-topologysegment-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipatopologysegment</code> section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Indicate that the value of the <code class="literal">ipaadmin_password</code> variable is defined in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault file.
							</li><li class="listitem">
								Set the <code class="literal">suffix</code> variable to <code class="literal">domain</code>. If you are reinitializing the <code class="literal">ca</code> data, set the variable to <code class="literal">ca</code>.
							</li><li class="listitem">
								Set the <code class="literal">left</code> variable to the left node of the replication agreement.
							</li><li class="listitem">
								Set the <code class="literal">right</code> variable to the right node of the replication agreement.
							</li><li class="listitem">
								Set the <code class="literal">direction</code> variable to the direction of the reinitializing data. The <code class="literal">left-to-right</code> direction means that data flows from the left node to the right node.
							</li><li class="listitem"><p class="simpara">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">reinitialized</code>.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p><pre class="literallayout">---
- name: Playbook to handle topologysegment
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Reinitialize topology segment
    ipatopologysegment:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>suffix: domain</strong></span>
      <span class="strong strong"><strong>left: server.idm.example.com</strong></span>
      <span class="strong strong"><strong>right: replica.idm.example.com</strong></span>
      <span class="strong strong"><strong>direction: left-to-right</strong></span>
      <span class="strong strong"><strong>state: reinitialized</strong></span></pre></li></ul></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory reinitialize-topologysegment-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology">Explaining Replication Agreements, Topology Suffixes, and Topology Segments</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-topology.md</code>
					</li><li class="listitem">
						Sample playbooks in <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/topology</code>
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-a-replication-agreement-is-absent-in-idm_using-ansible-to-manage-the-replication-topology-in-idm"><div class="titlepage"><div><div><h3 class="title">15.6. Using Ansible to ensure a replication agreement is absent in IdM</h3></div></div></div><p class="_abstract _abstract">
				Data stored on an Identity Management (IdM) server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. Replication agreements are always bilateral: the data is replicated from the first replica to the other one as well as from the other replica to the first one.
			</p><p>
				Follow this procedure to ensure a replication agreement between two replicas does not exist in IdM. The example describes how to ensure a replication agreement of the <code class="literal">domain</code> type does not exist between the <span class="strong strong"><strong>replica01.idm.example.com</strong></span> and <span class="strong strong"><strong>replica02.idm.example.com</strong></span> IdM servers.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You understand the recommendations for designing your IdM topology listed in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#guidelines-for-connecting-idm-replicas-in-a-topology_planning-the-replica-topology">Connecting the replicas in a topology</a>.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code> and that you have access to a file that stores the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">delete-topologysegment.yml</code> Ansible playbook file provided by the <code class="literal">ansible-freeipa</code> package:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/delete-topologysegment.yml delete-topologysegment-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">delete-topologysegment-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipatopologysegment</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Indicate that the value of the <code class="literal">ipaadmin_password</code> variable is defined in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault file.
							</li><li class="listitem">
								Set the <code class="literal">suffix</code> variable to <code class="literal">domain</code>. Alternatively, if you are ensuring that the <code class="literal">ca</code> data are not replicated between the left and right nodes, set the variable to <code class="literal">ca</code>.
							</li><li class="listitem">
								Set the <code class="literal">left</code> variable to the name of the IdM server that is the left node of the replication agreement.
							</li><li class="listitem">
								Set the <code class="literal">right</code> variable to the name of the IdM server that is the right node of the replication agreement.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to handle topologysegment
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
- name: Delete topology segment
    ipatopologysegment:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>suffix: domain</strong></span>
      <span class="strong strong"><strong>left: replica01.idm.example.com</strong></span>
      <span class="strong strong"><strong>right: replica02.idm.example.com:</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory delete-topologysegment-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology">Explaining Replication Agreements, Topology Suffixes, and Topology Segments</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-topology.md</code>
					</li><li class="listitem">
						Sample playbooks in <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/topology</code>
					</li></ul></div></section><section class="section _additional-resources" id="additional-resources_using-ansible-to-manage-the-replication-topology-in-idm"><div class="titlepage"><div><div><h3 class="title">15.7. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/planning_identity_management/index#planning-the-replica-topology_planning-identity-management">Planning the replica topology</a>.
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-an-ipa-replica_installing-identity-management">Installing an IdM replica</a>.
					</li></ul></div></section></section><section class="chapter" id="managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 16. Managing IdM servers by using Ansible</h2></div></div></div><p class="_abstract _abstract">
			You can use <code class="literal">Red Hat Ansible Engine</code> to manage the servers in your Identity Management (IdM) topology. You can use the <code class="literal">server</code> module in the <code class="literal">ansible-freeipa</code> package to check the presence or absence of a server in the IdM topology. You can also hide any replica or make a replica visible.
		</p><p>
			The section contains the following topics:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#checking-that-an-idm-server-is-present-by-using-ansible_managing-idm-servers-by-using-ansible" title="16.1. Checking that an IdM server is present by using Ansible">Checking that an IdM server is present by using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-that-an-idm-server-is-absent-from-an-idm-topology-by-using-ansible_managing-idm-servers-by-using-ansible" title="16.2. Ensuring that an IdM server is absent from an IdM topology by using Ansible">Ensuring that an IdM server is absent from an IdM topology by using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-an-idm-server-despite-hosting-a-last-idm-server-role_managing-idm-servers-by-using-ansible" title="16.3. Ensuring the absence of an IdM server despite hosting a last IdM server role">Ensuring the absence of an IdM server despite hosting a last IdM server role</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-that-an-idm-server-is-absent-but-not-necessarily-disconnected-from-other-idm-servers_managing-idm-servers-by-using-ansible" title="16.4. Ensuring that an IdM server is absent but not necessarily disconnected from other IdM servers">Ensuring that an IdM server is absent but not necessarily disconnected from other IdM servers</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-that-an-existing-idm-server-is-hidden-using-an-ansible-playbook_managing-idm-servers-by-using-ansible" title="16.5. Ensuring that an existing IdM server is hidden using an Ansible playbook">Ensuring that an existing IdM server is hidden using an Ansible playbook</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-that-an-existing-idm-server-is-visible-using-an-ansible-playbook_managing-idm-servers-by-using-ansible" title="16.6. Ensuring that an existing IdM server is visible by using an Ansible playbook">Ensuring that an existing IdM server is visible using an Ansible playbook</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-that-an-existing-idm-server-has-an-idm-dns-location-assigned_managing-idm-servers-by-using-ansible" title="16.7. Ensuring that an existing IdM server has an IdM DNS location assigned">Ensuring that an existing IdM server has an IdM DNS location assigned</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-that-an-existing-idm-server-has-no-idm-dns-location-assigned_managing-idm-servers-by-using-ansible" title="16.8. Ensuring that an existing IdM server has no IdM DNS location assigned">Ensuring that an existing IdM server has no IdM DNS location assigned</a>
				</li></ul></div><section class="section" id="checking-that-an-idm-server-is-present-by-using-ansible_managing-idm-servers-by-using-ansible"><div class="titlepage"><div><div><h3 class="title">16.1. Checking that an IdM server is present by using Ansible</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">ipaserver</code> <code class="literal">ansible-freeipa</code> module in an Ansible playbook to verify that an Identity Management (IdM) server exists.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal">ipaserver</code> Ansible module does not install the IdM server.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">SSH</code> connection from the control node to the IdM server defined in the inventory file is working correctly.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">server-present.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-present.yml server-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">server-present-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaserver</code> task section and save the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the <code class="literal">FQDN</code> of the server. The <code class="literal">FQDN</code> of the example server is <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
							</li></ul></div><pre class="literallayout">---
- name: Server present example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure server server123.idm.example.com is present
    ipaserver:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: server123.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook file and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory server-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management server using an Ansible playbook</a>
					</li><li class="listitem">
						The <code class="literal">README-server.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						The sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server</code> directory
					</li></ul></div></section><section class="section" id="ensuring-that-an-idm-server-is-absent-from-an-idm-topology-by-using-ansible_managing-idm-servers-by-using-ansible"><div class="titlepage"><div><div><h3 class="title">16.2. Ensuring that an IdM server is absent from an IdM topology by using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Use an Ansible playbook to ensure an Identity Management (IdM) server does not exist in an IdM topology, even as a host.
			</p><p>
				In contrast to the <code class="literal">ansible-freeipa</code> <code class="literal">ipaserver</code> role, the <code class="literal">ipaserver</code> module used in this playbook does not uninstall IdM services from the server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">SSH</code> connection from the control node to the IdM server defined in the inventory file is working correctly.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">server-absent.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-absent.yml server-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">server-absent-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaserver</code> task section and save the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the <code class="literal">FQDN</code> of the server. The <code class="literal">FQDN</code> of the example server is <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">absent</code>.
							</li></ul></div><pre class="literallayout">---
- name: Server absent example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure server server123.idm.example.com is absent
    ipaserver:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: server123.idm.example.com</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook file and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory server-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Make sure all name server (NS) DNS records pointing to <span class="strong strong"><strong>server123.idm.example.com</strong></span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-server_installing-identity-management">Uninstalling an IdM server</a>
					</li><li class="listitem">
						The <code class="literal">README-server.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server</code> directory
					</li></ul></div></section><section class="section" id="ensuring-the-absence-of-an-idm-server-despite-hosting-a-last-idm-server-role_managing-idm-servers-by-using-ansible"><div class="titlepage"><div><div><h3 class="title">16.3. Ensuring the absence of an IdM server despite hosting a last IdM server role</h3></div></div></div><p class="_abstract _abstract">
				You can use Ansible to ensure that an Identity Management (IdM) server is absent even if the last IdM service instance is running on the server. A certificate authority (CA), key recovery authority (KRA), or DNS server are all examples of IdM services.
			</p><rh-alert class="admonition warning" state="danger"><div class="admonition_header" slot="header">Warning</div><div><p>
					If you remove the last server that serves as a CA, KRA, or DNS server, you disrupt IdM functionality seriously. You can manually check which services are running on which IdM servers with the <code class="literal">ipa service-find</code> command. The principal name of a CA server is <code class="literal">dogtag/<span class="emphasis"><em>server_name</em></span>/<span class="emphasis"><em>REALM_NAME</em></span></code>.
				</p></div></rh-alert><p>
				In contrast to the <code class="literal">ansible-freeipa</code> <code class="literal">ipaserver</code> role, the <code class="literal">ipaserver</code> module used in this playbook does not uninstall IdM services from the server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">SSH</code> connection from the control node to the IdM server defined in the inventory file is working correctly.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">server-absent-ignore-last-of-role.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-absent-ignore-last-of-role.yml server-absent-ignore-last-of-role-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">server-absent-ignore-last-of-role-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaserver</code> task section and save the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the <code class="literal">FQDN</code> of the server. The <code class="literal">FQDN</code> of the example server is <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">ignore_last_of_role</code> variable is set to <code class="literal">true</code>.
							</li><li class="listitem">
								Set the <code class="literal">state</code> variable to <code class="literal">absent</code>.
							</li></ul></div><pre class="literallayout">---
- name: Server absent with last of role skip example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure server “server123.idm.example.com” is absent with last of role skip
    ipaserver:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: server123.idm.example.com</strong></span>
      <span class="strong strong"><strong>ignore_last_of_role: true</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook file and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory server-absent-ignore-last-of-role-copy.yml</strong></span></pre></li><li class="listitem">
						Make sure all name server (NS) DNS records that point to <span class="strong strong"><strong>server123.idm.example.com</strong></span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-server_installing-identity-management">Uninstalling an IdM server</a>
					</li><li class="listitem">
						The <code class="literal">README-server.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server</code> directory
					</li></ul></div></section><section class="section" id="ensuring-that-an-idm-server-is-absent-but-not-necessarily-disconnected-from-other-idm-servers_managing-idm-servers-by-using-ansible"><div class="titlepage"><div><div><h3 class="title">16.4. Ensuring that an IdM server is absent but not necessarily disconnected from other IdM servers</h3></div></div></div><p class="_abstract _abstract">
				If you are removing an Identity Management (IdM) server from the topology, you can keep its replication agreements intact with an Ansible playbook. The playbook also ensures that the IdM server does not exist in IdM, even as a host.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Ignoring a server’s replication agreements when removing it is only recommended when the other servers are dysfunctional servers that you are planning to remove anyway. Removing a server that serves as a central point in the topology can split your topology into two disconnected clusters.
				</p><p>
					You can remove a dysfunctional server from the topology with the <code class="literal">ipa server-del</code> command.
				</p></div></rh-alert><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					If you remove the last server that serves as a certificate authority (CA), key recovery authority (KRA), or DNS server, you seriously disrupt the Identity Management (IdM) functionality. To prevent this problem, the playbook makes sure these services are running on another server in the domain before it uninstalls a server that serves as a CA, KRA, or DNS server.
				</p></div></rh-alert><p>
				In contrast to the <code class="literal">ansible-freeipa</code> <code class="literal">ipaserver</code> role, the <code class="literal">ipaserver</code> module used in this playbook does not uninstall IdM services from the server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">SSH</code> connection from the control node to the IdM server defined in the inventory file is working correctly.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">server-absent-ignore_topology_disconnect.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-absent-ignore_topology_disconnect.yml server-absent-ignore_topology_disconnect-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">server-absent-ignore_topology_disconnect-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaserver</code> task section and save the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the <code class="literal">FQDN</code> of the server. The <code class="literal">FQDN</code> of the example server is <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">ignore_topology_disconnect</code> variable is set to <code class="literal">true</code>.
							</li><li class="listitem">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">absent</code>.
							</li></ul></div><pre class="literallayout">---
- name: Server absent with ignoring topology disconnects example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure server “server123.idm.example.com” with ignoring topology disconnects
    ipaserver:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: server123.idm.example.com</strong></span>
      <span class="strong strong"><strong>ignore_topology_disconnect: true</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook file and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory server-absent-ignore_topology_disconnect-copy.yml</strong></span></pre></li><li class="listitem">
						Optional: Make sure all name server (NS) DNS records pointing to <span class="strong strong"><strong>server123.idm.example.com</strong></span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-server_installing-identity-management">Uninstalling an IdM server</a>
					</li><li class="listitem">
						The <code class="literal">README-server.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server</code> directory.
					</li></ul></div></section><section class="section" id="ensuring-that-an-existing-idm-server-is-hidden-using-an-ansible-playbook_managing-idm-servers-by-using-ansible"><div class="titlepage"><div><div><h3 class="title">16.5. Ensuring that an existing IdM server is hidden using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal">ipaserver</code> <code class="literal">ansible-freeipa</code> module in an Ansible playbook to ensure that an existing Identity Management (IdM) server is hidden. Note that this playbook does not install the IdM server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">SSH</code> connection from the control node to the IdM server defined in the inventory file is working correctly.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">server-hidden.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-hidden.yml server-hidden-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">server-hidden-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaserver</code> task section and save the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the <code class="literal">FQDN</code> of the server. The <code class="literal">FQDN</code> of the example server is <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">hidden</code> variable is set to <code class="literal">True</code>.
							</li></ul></div><pre class="literallayout">---
- name: Server hidden example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure server server123.idm.example.com is hidden
    ipaserver:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: server123.idm.example.com</strong></span>
      <span class="strong strong"><strong>hidden: True</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook file and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory server-hidden-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management server using an Ansible playbook</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#the-hidden-replica-mode_planning-the-replica-topology">The hidden replica mode</a>
					</li><li class="listitem">
						The <code class="literal">README-server.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server</code> directory
					</li></ul></div></section><section class="section" id="ensuring-that-an-existing-idm-server-is-visible-using-an-ansible-playbook_managing-idm-servers-by-using-ansible"><div class="titlepage"><div><div><h3 class="title">16.6. Ensuring that an existing IdM server is visible by using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal">ipaserver</code> <code class="literal">ansible-freeipa</code> module in an Ansible playbook to ensure that an existing Identity Management (IdM) server is visible. Note that this playbook does not install the IdM server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">SSH</code> connection from the control node to the IdM server defined in the inventory file is working correctly.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">server-not-hidden.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-not-hidden.yml server-not-hidden-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">server-not-hidden-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaserver</code> task section and save the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the <code class="literal">FQDN</code> of the server. The <code class="literal">FQDN</code> of the example server is <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">hidden</code> variable is set to <code class="literal">no</code>.
							</li></ul></div><pre class="literallayout">---
- name: Server not hidden example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure server server123.idm.example.com is not hidden
    ipaserver:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: server123.idm.example.com</strong></span>
      <span class="strong strong"><strong>hidden: no</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook file and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory server-not-hidden-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management server using an Ansible playbook</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#the-hidden-replica-mode_planning-the-replica-topology">The hidden replica mode</a>
					</li><li class="listitem">
						The <code class="literal">README-server.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						The sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server</code> directory
					</li></ul></div></section><section class="section" id="ensuring-that-an-existing-idm-server-has-an-idm-dns-location-assigned_managing-idm-servers-by-using-ansible"><div class="titlepage"><div><div><h3 class="title">16.7. Ensuring that an existing IdM server has an IdM DNS location assigned</h3></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal">ipaserver</code> <code class="literal">ansible-freeipa</code> module in an Ansible playbook to ensure that an existing Identity Management (IdM) server is assigned a specific IdM DNS location.
			</p><p>
				Note that the <code class="literal">ipaserver</code> Ansible module does not install the IdM server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem">
						The IdM DNS location exists. The example location is <span class="strong strong"><strong>germany</strong></span>.
					</li><li class="listitem">
						You have <code class="literal">root</code> access to the server. The example server is <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">SSH</code> connection from the control node to the IdM server defined in the inventory file is working correctly.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">server-location.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-location.yml server-location-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">server-location-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaserver</code> task section and save the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">location</code> variable to <span class="strong strong"><strong>germany</strong></span>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Server enabled example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure server server123.idm.example.com with location “germany” is present
    ipaserver:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: server123.idm.example.com</strong></span>
      <span class="strong strong"><strong>location: germany</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook file and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory server-location-copy.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Connect to <span class="strong strong"><strong>server123.idm.example.com</strong></span> as <code class="literal">root</code> using <code class="literal">SSH</code>:
					</p><pre class="literallayout"><span class="strong strong"><strong>ssh root@server123.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">named-pkcs11</code> service on the server for the updates to take effect immediately:
					</p><pre class="literallayout">[root@server123.idm.example.com ~]# <span class="strong strong"><strong>systemctl restart named-pkcs11</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management server using an Ansible playbook</a>
					</li><li class="listitem">
						<a class="link" href="#using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm" title="29.4. Using Ansible to ensure an IdM location is present">Using Ansible to ensure an IdM location is present</a>
					</li><li class="listitem">
						The <code class="literal">README-server.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server</code> directory
					</li></ul></div></section><section class="section" id="ensuring-that-an-existing-idm-server-has-no-idm-dns-location-assigned_managing-idm-servers-by-using-ansible"><div class="titlepage"><div><div><h3 class="title">16.8. Ensuring that an existing IdM server has no IdM DNS location assigned</h3></div></div></div><p class="_abstract _abstract">
				Use the <code class="literal">ipaserver</code> <code class="literal">ansible-freeipa</code> module in an Ansible playbook to ensure that an existing Identity Management (IdM) server has no IdM DNS location assigned to it. Do not assign a DNS location to servers that change geographical location frequently. Note that the playbook does not install the IdM server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem">
						You have <code class="literal">root</code> access to the server. The example server is <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								The <code class="literal">SSH</code> connection from the control node to the IdM server defined in the inventory file is working correctly.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">server-no-location.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-no-location.yml server-no-location-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">server-no-location-copy.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaserver</code> task section and save the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>server123.idm.example.com</strong></span>.
							</li><li class="listitem">
								Ensure that the <code class="literal">location</code> variable is set to <span class="strong strong"><strong>””</strong></span>.
							</li></ul></div><pre class="literallayout">---
- name: Server no location example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure server server123.idm.example.com is present with no location
    ipaserver:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: server123.idm.example.com</strong></span>
      <span class="strong strong"><strong>location: “”</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook file and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory server-no-location-copy.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Connect to <span class="strong strong"><strong>server123.idm.example.com</strong></span> as <code class="literal">root</code> using <code class="literal">SSH</code>:
					</p><pre class="literallayout"><span class="strong strong"><strong>ssh root@server123.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						Restart the <code class="literal">named-pkcs11</code> service on the server for the updates to take effect immediately:
					</p><pre class="literallayout">[root@server123.idm.example.com ~]# <span class="strong strong"><strong>systemctl restart named-pkcs11</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management server using an Ansible playbook</a>
					</li><li class="listitem">
						<a class="link" href="#using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management" title="Chapter 29. Using Ansible to manage DNS locations in IdM">Using Ansible to manage DNS locations in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-server.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/server</code> directory
					</li></ul></div></section></section><section class="chapter" id="managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 17. Managing hosts using Ansible playbooks</h2></div></div></div><p class="_abstract _abstract">
			Ansible is an automation tool used to configure systems, deploy software, and perform rolling updates. Ansible includes support for Identity Management (IdM), and you can use Ansible modules to automate host management.
		</p><p>
			The following concepts and operations are performed when managing hosts and host entries using Ansible playbooks:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-an-IdM-host-entry-with-FQDN-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" title="17.1. Ensuring the presence of an IdM host entry with FQDN using Ansible playbooks">Ensuring the presence of IdM host entries that are only defined by their <code class="literal">FQDNs</code></a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" title="17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks">Ensuring the presence of IdM host entries with IP addresses</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-multiple-IdM-host-entries-with-random-passwords-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" title="17.3. Ensuring the presence of multiple IdM host entries with random passwords using Ansible playbooks">Ensuring the presence of multiple IdM host entries with random passwords</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-an-IdM-host-entry-with-multiple-IP-addresses-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" title="17.4. Ensuring the presence of an IdM host entry with multiple IP addresses using Ansible playbooks">Ensuring the presence of an IdM host entry with multiple IP addresses</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-an-IdM-host-entry-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" title="17.5. Ensuring the absence of an IdM host entry using Ansible playbooks">Ensuring the absence of IdM host entries</a>
				</li></ul></div><section class="section" id="ensuring-the-presence-of-an-IdM-host-entry-with-FQDN-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">17.1. Ensuring the presence of an IdM host entry with FQDN using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the presence of host entries in Identity Management (IdM) using Ansible playbooks. The host entries are only defined by their <code class="literal">fully-qualified domain names</code> (FQDNs).
			</p><p>
				Specifying the <code class="literal">FQDN</code> name of the host is enough if at least one of the following conditions applies:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The IdM server is not configured to manage DNS.
					</li><li class="listitem">
						The host does not have a static IP address or the IP address is not known at the time the host is configured. Adding a host defined only by an <code class="literal">FQDN</code> essentially creates a placeholder entry in the IdM DNS service. For example, laptops may be preconfigured as IdM clients, but they do not have IP addresses at the time they are configured. When the DNS service dynamically updates its records, the host’s current IP address is detected and its DNS record is updated.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Without Ansible, host entries are created in IdM using the <code class="literal command">ipa host-add</code> command. The result of adding a host to IdM is the state of the host being present in IdM. Because of the Ansible reliance on idempotence, to add a host to IdM using Ansible, you must create a playbook in which you define the state of the host as present: <span class="strong strong"><strong>state: present</strong></span>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the <code class="literal">FQDN</code> of the host whose presence in IdM you want to ensure. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/host/add-host.yml</code> file:
					</p><pre class="literallayout">---
- name: Host present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Host host01.idm.example.com present
    ipahost:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: host01.idm.example.com
      state: present
      force: true</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-host-is-present.yml</em></span></strong></span></pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The procedure results in a host entry in the IdM LDAP server being created but not in enrolling the host into the IdM Kerberos realm. For that, you must deploy the host as an IdM client. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management client using an Ansible playbook</a>.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to your IdM server as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:</pre></li><li class="listitem"><p class="simpara">
						Enter the <code class="literal">ipa host-show</code> command and specify the name of the host:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-show host01.idm.example.com</strong></span>
  Host name: host01.idm.example.com
  Principal name: host/host01.idm.example.com@IDM.EXAMPLE.COM
  Principal alias: host/host01.idm.example.com@IDM.EXAMPLE.COM
  Password: False
  Keytab: False
  Managed by: host01.idm.example.com</pre></li></ol></div><p>
				The output confirms that <span class="strong strong"><strong>host01.idm.example.com</strong></span> exists in IdM.
			</p></section><section class="section" id="ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the presence of host entries in Identity Management (IdM) using Ansible playbooks. The host entries are defined by their <code class="literal">fully-qualified domain names</code> (FQDNs) and their IP addresses.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Without Ansible, host entries are created in IdM using the <code class="literal command">ipa host-add</code> command. The result of adding a host to IdM is the state of the host being present in IdM. Because of the Ansible reliance on idempotence, to add a host to IdM using Ansible, you must create a playbook in which you define the state of the host as present: <span class="strong strong"><strong>state: present</strong></span>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the <code class="literal">fully-qualified domain name</code> (FQDN) of the host whose presence in IdM you want to ensure. In addition, if the IdM server is configured to manage DNS and you know the IP address of the host, specify a value for the <code class="literal">ip_address</code> parameter. The IP address is necessary for the host to exist in the DNS resource records. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/host/host-present.yml</code> file. You can also include other, additional information:
					</p><pre class="literallayout">---
- name: Host present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure host01.idm.example.com is present
    ipahost:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: host01.idm.example.com
      description: Example host
      ip_address: 192.168.0.123
      locality: Lab
      ns_host_location: Lab
      ns_os_version: CentOS 7
      ns_hardware_platform: Lenovo T61
      mac_address:
      - "08:00:27:E3:B1:2D"
      - "52:54:00:BD:97:1E"
      state: present</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-host-is-present.yml</em></span></strong></span></pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The procedure results in a host entry in the IdM LDAP server being created but not in enrolling the host into the IdM Kerberos realm. For that, you must deploy the host as an IdM client. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management client using an Ansible playbook</a>.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to your IdM server as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:</pre></li><li class="listitem"><p class="simpara">
						Enter the <code class="literal">ipa host-show</code> command and specify the name of the host:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-show host01.idm.example.com</strong></span>
  Host name: host01.idm.example.com
  Description: Example host
  Locality: Lab
  Location: Lab
  Platform: Lenovo T61
  Operating system: CentOS 7
  Principal name: host/host01.idm.example.com@IDM.EXAMPLE.COM
  Principal alias: host/host01.idm.example.com@IDM.EXAMPLE.COM
  MAC address: 08:00:27:E3:B1:2D, 52:54:00:BD:97:1E
  Password: False
  Keytab: False
  Managed by: host01.idm.example.com</pre></li></ol></div><p>
				The output confirms <span class="strong strong"><strong>host01.idm.example.com</strong></span> exists in IdM.
			</p></section><section class="section" id="ensuring-the-presence-of-multiple-IdM-host-entries-with-random-passwords-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">17.3. Ensuring the presence of multiple IdM host entries with random passwords using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">ipahost</code> module allows the system administrator to ensure the presence or absence of multiple host entries in IdM using just one Ansible task. Follow this procedure to ensure the presence of multiple host entries that are only defined by their <code class="literal">fully-qualified domain names</code> (FQDNs). Running the Ansible playbook generates random passwords for the hosts.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Without Ansible, host entries are created in IdM using the <code class="literal command">ipa host-add</code> command. The result of adding a host to IdM is the state of the host being present in IdM. Because of the Ansible reliance on idempotence, to add a host to IdM using Ansible, you must create a playbook in which you define the state of the host as present: <span class="strong strong"><strong>state: present</strong></span>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the <code class="literal">fully-qualified domain name</code> (FQDN) of the hosts whose presence in IdM you want to ensure. To make the Ansible playbook generate a random password for each host even when the host already exists in IdM and <code class="literal">update_password</code> is limited to <code class="literal">on_create</code>, add the <code class="literal">random: true</code> and <code class="literal">force: true</code> options. To simplify this step, you can copy and modify the example from the <code class="literal">/usr/share/doc/ansible-freeipa/README-host.md</code> Markdown file:
					</p><pre class="literallayout">---
- name: Ensure hosts with random password
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Hosts host01.idm.example.com and host02.idm.example.com present with random passwords
    ipahost:
      ipaadmin_password: "{{ ipaadmin_password }}"
      hosts:
      - name: host01.idm.example.com
        random: true
        force: true
      - name: host02.idm.example.com
        random: true
        force: true
    register: ipahost</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-hosts-are-present.yml</em></span></strong></span>
[...]
TASK [Hosts host01.idm.example.com and host02.idm.example.com present with random passwords]
changed: [r8server.idm.example.com] =&gt; {"changed": true, "host": {"host01.idm.example.com": {"randompassword": "0HoIRvjUdH0Ycbf6uYdWTxH"}, "host02.idm.example.com": {"randompassword": "5VdLgrf3wvojmACdHC3uA3s"}}}</pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To deploy the hosts as IdM clients using random, one-time passwords (OTPs), see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management#authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible">Authorization options for IdM client enrollment using an Ansible playbook</a> or <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_installing-an-idm-client_installing-identity-management#proc_installing-a-client-by-using-a-one-time-password-interactive-installation_assembly_installing-an-idm-client">Installing a client by using a one-time password: Interactive installation</a>.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to your IdM server as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:</pre></li><li class="listitem"><p class="simpara">
						Enter the <code class="literal">ipa host-show</code> command and specify the name of one of the hosts:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-show host01.idm.example.com</strong></span>
  Host name: host01.idm.example.com
  Password: True
  Keytab: False
  Managed by: host01.idm.example.com</pre></li></ol></div><p>
				The output confirms <span class="strong strong"><strong>host01.idm.example.com</strong></span> exists in IdM with a random password.
			</p></section><section class="section" id="ensuring-the-presence-of-an-IdM-host-entry-with-multiple-IP-addresses-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">17.4. Ensuring the presence of an IdM host entry with multiple IP addresses using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the presence of a host entry in Identity Management (IdM) using Ansible playbooks. The host entry is defined by its <code class="literal">fully-qualified domain name</code> (FQDN) and its multiple IP addresses.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In contrast to the <code class="literal">ipa host</code> utility, the Ansible <code class="literal">ipahost</code> module can ensure the presence or absence of several IPv4 and IPv6 addresses for a host. The <code class="literal">ipa host-mod</code> command cannot handle IP addresses.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file. Specify, as the <code class="literal">name</code> of the <code class="literal">ipahost</code> variable, the <code class="literal">fully-qualified domain name</code> (FQDN) of the host whose presence in IdM you want to ensure. Specify each of the multiple IPv4 and IPv6 <code class="literal">ip_address</code> values on a separate line by using the <span class="strong strong"><strong><span class="emphasis"><em>ip_address</em></span></strong></span> syntax. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/host/host-member-ipaddresses-present.yml</code> file. You can also include additional information:
					</p><pre class="literallayout">---
- name: Host member IP addresses present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure host101.example.com IP addresses present
    ipahost:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: host01.idm.example.com
      ip_address:
      - 192.168.0.123
      - fe80::20c:29ff:fe02:a1b3
      - 192.168.0.124
      - fe80::20c:29ff:fe02:a1b4
      force: true</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-host-with-multiple-IP-addreses-is-present.yml</em></span></strong></span></pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The procedure creates a host entry in the IdM LDAP server but does not enroll the host into the IdM Kerberos realm. For that, you must deploy the host as an IdM client. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management">Installing an Identity Management client using an Ansible playbook</a>.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to your IdM server as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:</pre></li><li class="listitem"><p class="simpara">
						Enter the <code class="literal">ipa host-show</code> command and specify the name of the host:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-show host01.idm.example.com</strong></span>
  Principal name: host/host01.idm.example.com@IDM.EXAMPLE.COM
  Principal alias: host/host01.idm.example.com@IDM.EXAMPLE.COM
  Password: False
  Keytab: False
  Managed by: host01.idm.example.com</pre><p class="simpara">
						The output confirms that <span class="strong strong"><strong>host01.idm.example.com</strong></span> exists in IdM.
					</p></li><li class="listitem"><p class="simpara">
						To verify that the multiple IP addresses of the host exist in the IdM DNS records, enter the <code class="literal">ipa dnsrecord-show</code> command and specify the following information:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The name of the IdM domain
							</li><li class="listitem"><p class="simpara">
								The name of the host
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa dnsrecord-show idm.example.com host01</strong></span>
[...]
  Record name: host01
  A record: 192.168.0.123, 192.168.0.124
  AAAA record: fe80::20c:29ff:fe02:a1b3, fe80::20c:29ff:fe02:a1b4</pre></li></ul></div><p class="simpara">
						The output confirms that all the IPv4 and IPv6 addresses specified in the playbook are correctly associated with the <span class="strong strong"><strong>host01.idm.example.com</strong></span> host entry.
					</p></li></ol></div></section><section class="section" id="ensuring-the-absence-of-an-IdM-host-entry-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">17.5. Ensuring the absence of an IdM host entry using Ansible playbooks</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the absence of host entries in Identity Management (IdM) using Ansible playbooks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM administrator credentials
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the <code class="literal">fully-qualified domain name</code> (FQDN) of the host whose absence from IdM you want to ensure. If your IdM domain has integrated DNS, use the <code class="literal">updatedns: true</code> option to remove the associated records of any kind for the host from the DNS.
					</p><p class="simpara">
						To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/host/delete-host.yml</code> file:
					</p><pre class="literallayout">---
- name: Host absent
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Host host01.idm.example.com absent
    ipahost:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: host01.idm.example.com
      updatedns: true
      state: absent</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-host-absent.yml</em></span></strong></span></pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The procedure results in:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							The host not being present in the IdM Kerberos realm.
						</li><li class="listitem">
							The host entry not being present in the IdM LDAP server.
						</li></ul></div><p>
					To remove the specific IdM configuration of system services, such as System Security Services Daemon (SSSD), from the client host itself, you must run the <code class="literal">ipa-client-install --uninstall</code> command on the client. For details, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-client_installing-identity-management">Uninstalling an IdM client</a>.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Display information about <span class="emphasis"><em>host01.idm.example.com</em></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa host-show host01.idm.example.com</strong></span>
ipa: ERROR: host01.idm.example.com: host not found</pre></li></ol></div><p>
				The output confirms that the host does not exist in IdM.
			</p></section><section class="section _additional-resources" id="additional_resources_5"><div class="titlepage"><div><div><h3 class="title">17.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal">/usr/share/doc/ansible-freeipa/README-host.md</code> Markdown file.
					</li><li class="listitem">
						See the additional playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/host</code> directory.
					</li></ul></div></section></section><section class="chapter" id="managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 18. Managing host groups using Ansible playbooks</h2></div></div></div><p>
			To learn more about <a class="link" href="#host-groups-in-idm_managing-host-groups-using-Ansible-playbooks" title="18.1. Host groups in IdM">host groups in Identity Management</a> (IdM) and using Ansible to perform operations involving host groups in Identity Management (IdM), see the following:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#host-groups-in-idm_managing-host-groups-using-Ansible-playbooks" title="18.1. Host groups in IdM">Host groups in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.2. Ensuring the presence of IdM host groups using Ansible playbooks">Ensuring the presence of IdM host groups</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-hosts-in-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.3. Ensuring the presence of hosts in IdM host groups using Ansible playbooks">Ensuring the presence of hosts in IdM host groups</a>
				</li><li class="listitem">
					<a class="link" href="#nesting-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.4. Nesting IdM host groups using Ansible playbooks">Nesting IdM host groups</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-member-managers-in-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.5. Ensuring the presence of member managers in IDM host groups using Ansible Playbooks">Ensuring the presence of member managers in IdM host groups</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-hosts-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.6. Ensuring the absence of hosts from IdM host groups using Ansible playbooks">Ensuring the absence of hosts from IdM host groups</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-nested-host-groups-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.7. Ensuring the absence of nested host groups from IdM host groups using Ansible playbooks">Ensuring the absence of nested host groups from IdM host groups</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-member-managers-from-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.9. Ensuring the absence of member managers from IdM host groups using Ansible playbooks">Ensuring the absence of member managers from IdM host groups</a>
				</li></ul></div><section class="section" id="host-groups-in-idm_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.1. Host groups in IdM</h3></div></div></div><p class="_abstract _abstract">
				IdM host groups can be used to centralize control over important management tasks, particularly access control.
			</p><div class="formalpara"><p class="title"><strong>Definition of host groups</strong></p><p>
					A host group is an entity that contains a set of IdM hosts with common access control rules and other characteristics. For example, you can define host groups based on company departments, physical locations, or access control requirements.
				</p></div><p>
				A host group in IdM can include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						IdM servers and clients
					</li><li class="listitem">
						Other IdM host groups
					</li></ul></div><div class="formalpara"><p class="title"><strong>Host groups created by default</strong></p><p>
					By default, the IdM server creates the host group <code class="literal">ipaservers</code> for all IdM server hosts.
				</p></div><div class="formalpara"><p class="title"><strong>Direct and indirect group members</strong></p><p>
					Group attributes in IdM apply to both direct and indirect members: when host group B is a member of host group A, all members of host group B are considered indirect members of host group A.
				</p></div></section><section class="section" id="ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.2. Ensuring the presence of IdM host groups using Ansible playbooks</h3></div></div></div><p>
				Follow this procedure to ensure the presence of host groups in Identity Management (IdM) using Ansible playbooks.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Without Ansible, host group entries are created in IdM using the <code class="literal command">ipa hostgroup-add</code> command. The result of adding a host group to IdM is the state of the host group being present in IdM. Because of the Ansible reliance on idempotence, to add a host group to IdM using Ansible, you must create a playbook in which you define the state of the host group as present: <span class="strong strong"><strong>state: present</strong></span>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it with the list of IdM servers to target:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary host group information. For example, to ensure the presence of a host group named <span class="strong strong"><strong>databases</strong></span>, specify <code class="literal">name: databases</code> in the <code class="literal">- ipahostgroup</code> task. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/user/ensure-hostgroup-is-present.yml</code> file.
					</p><pre class="literallayout">---
- name: Playbook to handle hostgroups
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure host-group databases is present
  - ipahostgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: databases
      state: present</pre><p class="simpara">
						In the playbook, <span class="strong strong"><strong>state: present</strong></span> signifies a request to add the host group to IdM unless it already exists there.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-hostgroup-is-present.yml</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Request a Kerberos ticket for admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
						Display information about the host group whose presence in IdM you wanted to ensure:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa hostgroup-show databases</strong></span>
  Host-group: databases</pre></li></ol></div><p>
				The <span class="strong strong"><strong>databases</strong></span> host group exists in IdM.
			</p></section><section class="section" id="ensuring-the-presence-of-hosts-in-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.3. Ensuring the presence of hosts in IdM host groups using Ansible playbooks</h3></div></div></div><p>
				Follow this procedure to ensure the presence of hosts in host groups in Identity Management (IdM) using Ansible playbooks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The hosts you want to reference in your Ansible playbook exist in IdM. For details, see <a class="link" href="#ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" title="17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks">Ensuring the presence of an IdM host entry using Ansible playbooks</a>.
					</li><li class="listitem">
						The host groups you reference from the Ansible playbook file have been added to IdM. For details, see <a class="link" href="#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.2. Ensuring the presence of IdM host groups using Ansible playbooks">Ensuring the presence of IdM host groups using Ansible playbooks</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it with the list of IdM servers to target:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary host information. Specify the name of the host group using the <code class="literal">name</code> parameter of the <code class="literal">ipahostgroup</code> variable. Specify the name of the host with the <code class="literal">host</code> parameter of the <code class="literal">ipahostgroup</code> variable. To simplify this step, you can copy and modify the examples in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/hostgroup/ensure-hosts-and-hostgroups-are-present-in-hostgroup.yml</code> file:
					</p><pre class="literallayout">---
- name: Playbook to handle hostgroups
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure host-group databases is present
  - ipahostgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: databases
      host:
      - db.idm.example.com
      action: member</pre><p class="simpara">
						This playbook adds the <span class="strong strong"><strong>db.idm.example.com</strong></span> host to the <span class="strong strong"><strong>databases</strong></span> host group. The <code class="literal">action: member</code> line indicates that when the playbook is run, no attempt is made to add the <span class="strong strong"><strong>databases</strong></span> group itself. Instead, only an attempt is made to add <span class="strong strong"><strong>db.idm.example.com</strong></span> to <span class="strong strong"><strong>databases</strong></span>.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-hosts-or-hostgroups-are-present-in-hostgroup.yml</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Request a Kerberos ticket for admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
						Display information about a host group to see which hosts are present in it:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa hostgroup-show databases</strong></span>
  Host-group: databases
  Member hosts: db.idm.example.com</pre></li></ol></div><p>
				The <span class="strong strong"><strong>db.idm.example.com</strong></span> host is present as a member of the <span class="strong strong"><strong>databases</strong></span> host group.
			</p></section><section class="section" id="nesting-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.4. Nesting IdM host groups using Ansible playbooks</h3></div></div></div><p>
				Follow this procedure to ensure the presence of nested host groups in Identity Management (IdM) host groups using Ansible playbooks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The host groups you reference from the Ansible playbook file exist in IdM. For details, see <a class="link" href="#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.2. Ensuring the presence of IdM host groups using Ansible playbooks">Ensuring the presence of IdM host groups using Ansible playbooks</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it with the list of IdM servers to target:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary host group information. To ensure that a nested host group <span class="emphasis"><em>A</em></span> exists in a host group <span class="emphasis"><em>B</em></span>: in the Ansible playbook, specify, among the <code class="literal">- ipahostgroup</code> variables, the name of the host group <span class="emphasis"><em>B</em></span> using the <code class="literal">name</code> variable. Specify the name of the nested hostgroup <span class="emphasis"><em>A</em></span> with the <code class="literal">hostgroup</code> variable. To simplify this step, you can copy and modify the examples in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/hostgroup/ensure-hosts-and-hostgroups-are-present-in-hostgroup.yml</code> file:
					</p><pre class="literallayout">---
- name: Playbook to handle hostgroups
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure hosts and hostgroups are present in existing databases hostgroup
  - ipahostgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: databases
      hostgroup:
      - mysql-server
      - oracle-server
      action: member</pre><p class="simpara">
						This Ansible playbook ensures the presence of the <span class="strong strong"><strong>myqsl-server</strong></span> and <span class="strong strong"><strong>oracle-server</strong></span> host groups in the <span class="strong strong"><strong>databases</strong></span> host group. The <code class="literal">action: member</code> line indicates that when the playbook is run, no attempt is made to add the <span class="strong strong"><strong>databases</strong></span> group itself to IdM.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-hosts-or-hostgroups-are-present-in-hostgroup.yml</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Request a Kerberos ticket for admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
						Display information about the host group in which nested host groups are present:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa hostgroup-show databases</strong></span>
  Host-group: databases
  Member hosts: db.idm.example.com
  Member host-groups: mysql-server, oracle-server</pre></li></ol></div><p>
				The <span class="strong strong"><strong>mysql-server</strong></span> and <span class="strong strong"><strong>oracle-server</strong></span> host groups exist in the <span class="strong strong"><strong>databases</strong></span> host group.
			</p></section><section class="section" id="ensuring-the-presence-of-member-managers-in-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.5. Ensuring the presence of member managers in IDM host groups using Ansible Playbooks</h3></div></div></div><p>
				The following procedure describes ensuring the presence of member managers in IdM hosts and host groups using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You must have the name of the host or host group you are adding as member managers and the name of the host group you want them to manage.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary host and host group member management information:
					</p><pre class="literallayout">---

- name: Playbook to handle host group membership management
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure member manager user example_member is present for group_name
      ipahostgroup:
        ipaadmin_password: "{{ ipaadmin_password }}"
        name: group_name
        membermanager_user: example_member

  - name: Ensure member manager group project_admins is present for group_name
      ipahostgroup:
        ipaadmin_password: "{{ ipaadmin_password }}"
        name: group_name
        membermanager_group: project_admins</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/add-member-managers-host-groups.yml</em></span></strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					You can verify if the <span class="strong strong"><strong>group_name</strong></span> group contains <span class="strong strong"><strong>example_member</strong></span> and <span class="strong strong"><strong>project_admins</strong></span> as member managers by using the <code class="literal">ipa group-show</code> command:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as administrator:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Display information about <span class="emphasis"><em>testhostgroup</em></span>:
					</p><pre class="literallayout">ipaserver]$ <span class="strong strong"><strong>ipa hostgroup-show group_name</strong></span>
  Host-group: group_name
  Member hosts: server.idm.example.com
  Member host-groups: testhostgroup2
  Membership managed by groups: project_admins
  Membership managed by users: example_member</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">ipa hostgroup-add-member-manager --help</code>.
					</li><li class="listitem">
						See the <code class="literal">ipa</code> man page on your system.
					</li></ul></div></section><section class="section" id="ensuring-the-absence-of-hosts-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.6. Ensuring the absence of hosts from IdM host groups using Ansible playbooks</h3></div></div></div><p>
				Follow this procedure to ensure the absence of hosts from host groups in Identity Management (IdM) using Ansible playbooks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The hosts you want to reference in your Ansible playbook exist in IdM. For details, see <a class="link" href="#ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks" title="17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks">Ensuring the presence of an IdM host entry using Ansible playbooks</a>.
					</li><li class="listitem">
						The host groups you reference from the Ansible playbook file exist in IdM. For details, see <a class="link" href="#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.2. Ensuring the presence of IdM host groups using Ansible playbooks">Ensuring the presence of IdM host groups using Ansible playbooks</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it with the list of IdM servers to target:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary host and host group information. Specify the name of the host group using the <code class="literal">name</code> parameter of the <code class="literal">ipahostgroup</code> variable. Specify the name of the host whose absence from the host group you want to ensure using the <code class="literal">host</code> parameter of the <code class="literal">ipahostgroup</code> variable. To simplify this step, you can copy and modify the examples in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/hostgroup/ensure-hosts-and-hostgroups-are-absent-in-hostgroup.yml</code> file:
					</p><pre class="literallayout">---
- name: Playbook to handle hostgroups
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure host-group databases is absent
  - ipahostgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: databases
      host:
      - db.idm.example.com
      action: member
      state: absent</pre><p class="simpara">
						This playbook ensures the absence of the <span class="strong strong"><strong>db.idm.example.com</strong></span> host from the <span class="strong strong"><strong>databases</strong></span> host group. The <span class="strong strong"><strong>action: member</strong></span> line indicates that when the playbook is run, no attempt is made to remove the <span class="strong strong"><strong>databases</strong></span> group itself.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-hosts-or-hostgroups-are-absent-in-hostgroup.yml</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Request a Kerberos ticket for admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
						Display information about the host group and the hosts it contains:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa hostgroup-show databases</strong></span>
  Host-group: databases
  Member host-groups: mysql-server, oracle-server</pre></li></ol></div><p>
				The <span class="strong strong"><strong>db.idm.example.com</strong></span> host does not exist in the <span class="strong strong"><strong>databases</strong></span> host group.
			</p></section><section class="section" id="ensuring-the-absence-of-nested-host-groups-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.7. Ensuring the absence of nested host groups from IdM host groups using Ansible playbooks</h3></div></div></div><p>
				Follow this procedure to ensure the absence of nested host groups from outer host groups in Identity Management (IdM) using Ansible playbooks.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The host groups you reference from the Ansible playbook file exist in IdM. For details, see <a class="link" href="#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks" title="18.2. Ensuring the presence of IdM host groups using Ansible playbooks">Ensuring the presence of IdM host groups using Ansible playbooks</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it with the list of IdM servers to target:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary host group information. Specify, among the <code class="literal">- ipahostgroup</code> variables, the name of the outer host group using the <code class="literal">name</code> variable. Specify the name of the nested hostgroup with the <code class="literal">hostgroup</code> variable. To simplify this step, you can copy and modify the examples in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/hostgroup/ensure-hosts-and-hostgroups-are-absent-in-hostgroup.yml</code> file:
					</p><pre class="literallayout">---
- name: Playbook to handle hostgroups
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure hosts and hostgroups are absent in existing databases hostgroup
  - ipahostgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: databases
      hostgroup:
      - mysql-server
      - oracle-server
      action: member
      state: absent</pre><p class="simpara">
						This playbook makes sure that the <span class="strong strong"><strong>mysql-server</strong></span> and <span class="strong strong"><strong>oracle-server</strong></span> host groups are absent from the <span class="strong strong"><strong>databases</strong></span> host group. The <code class="literal">action: member</code> line indicates that when the playbook is run, no attempt is made to ensure the <span class="strong strong"><strong>databases</strong></span> group itself is deleted from IdM.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-hosts-or-hostgroups-are-absent-in-hostgroup.yml</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Request a Kerberos ticket for admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
						Display information about the host group from which nested host groups should be absent:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa hostgroup-show databases</strong></span>
  Host-group: databases</pre></li></ol></div><p>
				The output confirms that the <span class="strong strong"><strong>mysql-server</strong></span> and <span class="strong strong"><strong>oracle-server</strong></span> nested host groups are absent from the outer <span class="strong strong"><strong>databases</strong></span> host group.
			</p></section><section class="section" id="ensuring-the-absence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.8. Ensuring the absence of IdM host groups using Ansible playbooks</h3></div></div></div><p>
				Follow this procedure to ensure the absence of host groups in Identity Management (IdM) using Ansible playbooks.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Without Ansible, host group entries are removed from IdM using the <code class="literal command">ipa hostgroup-del</code> command. The result of removing a host group from IdM is the state of the host group being absent from IdM. Because of the Ansible reliance on idempotence, to remove a host group from IdM using Ansible, you must create a playbook in which you define the state of the host group as absent: <span class="strong strong"><strong>state: absent</strong></span>.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it with the list of IdM servers to target:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary host group information. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/user/ensure-hostgroup-is-absent.yml</code> file.
					</p><pre class="literallayout">---
- name: Playbook to handle hostgroups
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - Ensure host-group databases is absent
    ipahostgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: databases
      state: absent</pre><p class="simpara">
						This playbook ensures the absence of the <span class="strong strong"><strong>databases</strong></span> host group from IdM. The <code class="literal">state: absent</code> means a request to delete the host group from IdM unless it is already deleted.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-hostgroup-is-absent.yml</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Request a Kerberos ticket for admin:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit admin</strong></span>
Password for admin@IDM.EXAMPLE.COM:</pre></li><li class="listitem"><p class="simpara">
						Display information about the host group whose absence you ensured:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa hostgroup-show databases</strong></span>
ipa: ERROR: databases: host group not found</pre></li></ol></div><p>
				The <span class="strong strong"><strong>databases</strong></span> host group does not exist in IdM.
			</p></section><section class="section" id="ensuring-the-absence-of-member-managers-from-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">18.9. Ensuring the absence of member managers from IdM host groups using Ansible playbooks</h3></div></div></div><p>
				The following procedure describes ensuring the absence of member managers in IdM hosts and host groups using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You must have the name of the user or user group you are removing as member managers and the name of the host group they are managing.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create an Ansible playbook file with the necessary host and host group member management information:
					</p><pre class="literallayout">---

- name: Playbook to handle host group membership management
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure member manager host and host group members are absent for group_name
    ipahostgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: group_name
      membermanager_user: example_member
      membermanager_group: project_admins
      action: member
      state: absent</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-member-managers-host-groups-are-absent.yml</em></span></strong></span></pre></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					You can verify if the <span class="strong strong"><strong>group_name</strong></span> group does not contain <span class="strong strong"><strong>example_member</strong></span> or <span class="strong strong"><strong>project_admins</strong></span> as member managers by using the <code class="literal">ipa group-show</code> command:
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into <code class="literal">ipaserver</code> as administrator:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh admin@server.idm.example.com</strong></span>
Password:
[admin@server /]$</pre></li><li class="listitem"><p class="simpara">
						Display information about <span class="emphasis"><em>testhostgroup</em></span>:
					</p><pre class="literallayout">ipaserver]$ <span class="strong strong"><strong>ipa hostgroup-show group_name</strong></span>
  Host-group: group_name
  Member hosts: server.idm.example.com
  Member host-groups: testhostgroup2</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <code class="literal">ipa hostgroup-add-member-manager --help</code>.
					</li><li class="listitem">
						See the <code class="literal">ipa</code> man page on your system.
					</li></ul></div></section></section><section class="chapter" id="defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 19. Defining IdM password policies</h2></div></div></div><p class="_abstract _abstract">
			This chapter describes Identity Management (IdM) password policies and how to add a new password policy in IdM using an Ansible playbook.
		</p><section class="section" id="what-is-a-password-policy_defining-idm-password-policies"><div class="titlepage"><div><div><h3 class="title">19.1. What is a password policy</h3></div></div></div><p class="_abstract _abstract">
				A password policy is a set of rules that passwords must meet. For example, a password policy can define the minimum password length and the maximum password lifetime. All users affected by this policy are required to set a sufficiently long password and change it frequently enough to meet the specified conditions. In this way, password policies help reduce the risk of someone discovering and misusing a user’s password.
			</p></section><section class="section" id="password-policies-in-idm_defining-idm-password-policies"><div class="titlepage"><div><div><h3 class="title">19.2. Password policies in IdM</h3></div></div></div><p class="_abstract _abstract">
				Passwords are the most common way for Identity Management (IdM) users to authenticate to the IdM Kerberos domain. Password policies define the requirements that these IdM user passwords must meet.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The IdM password policy is set in the underlying LDAP directory, but the Kerberos Key Distribution Center (KDC) enforces the password policy.
				</p></div></rh-alert><p>
				<a class="link" href="#tab-password-policy-attributes_defining-idm-password-policies" title="Table 19.1. Password Policy Attributes">Password policy attributes</a> lists the attributes you can use to define a password policy in IdM.
			</p><rh-table id="tab-password-policy-attributes_defining-idm-password-policies"><table class="lt-4-cols lt-7-rows"><caption>Table 19.1. Password Policy Attributes</caption><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 40%; " class="col_2"><!--Empty--><col style="width: 40%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464213311728" scope="col">Attribute</th><th align="left" valign="top" id="idm140464213310640" scope="col">Explanation</th><th align="left" valign="top" id="idm140464213309552" scope="col">Example</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464213311728"> <p>
								Max lifetime
							</p>
							 </td><td align="left" valign="top" headers="idm140464213310640"> <p>
								The maximum amount of time in days that a password is valid before a user must reset it. The default value is 90 days.
							</p>
							 <p>
								Note that if the attribute is set to 0, the password never expires.
							</p>
							 </td><td align="left" valign="top" headers="idm140464213309552"> <p>
								Max lifetime = 180
							</p>
							 <p>
								User passwords are valid only for 180 days. After that, IdM prompts users to change them.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464213311728"> <p>
								Min lifetime
							</p>
							 </td><td align="left" valign="top" headers="idm140464213310640"> <p>
								The minimum amount of time in hours that must pass between two password change operations.
							</p>
							 </td><td align="left" valign="top" headers="idm140464213309552"> <p>
								Min lifetime = 1
							</p>
							 <p>
								After users change their passwords, they must wait at least 1 hour before changing them again.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464213311728"> <p>
								History size
							</p>
							 </td><td align="left" valign="top" headers="idm140464213310640"> <p>
								The number of previous passwords that are stored. A user cannot reuse a password from their password history but can reuse old passwords that are not stored.
							</p>
							 </td><td align="left" valign="top" headers="idm140464213309552"> <p>
								History size = 0
							</p>
							 <p>
								In this case, the password history is empty and users can reuse any of their previous passwords.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464213311728"> <p>
								Character classes
							</p>
							 </td><td align="left" valign="top" headers="idm140464213310640"> <p>
								The number of different character classes the user must use in the password. The character classes are:
							</p>
							 <p>
								* Uppercase characters
							</p>
							 <p>
								* Lowercase characters
							</p>
							 <p>
								* Digits
							</p>
							 <p>
								* Special characters, such as comma (,), period (.), asterisk (*)
							</p>
							 <p>
								* Other UTF-8 characters
							</p>
							 <p>
								Using a character three or more times in a row decreases the character class by one. For example:
							</p>
							 <p>
								* <code class="literal">Secret1</code> has 3 character classes: uppercase, lowercase, digits
							</p>
							 <p>
								* <code class="literal">Secret111</code> has 2 character classes: uppercase, lowercase, digits, and a -1 penalty for using <code class="literal">1</code> repeatedly
							</p>
							 </td><td align="left" valign="top" headers="idm140464213309552"> <p>
								Character classes = 0
							</p>
							 <p>
								The default number of classes required is 0. To configure the number, run the <code class="literal command">ipa pwpolicy-mod</code> command with the <code class="literal option">--minclasses</code> option.
							</p>
							 <p>
								See also the <a class="link" href="#english-alphabet" title="Important">Important</a> note below this table.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464213311728"> <p>
								Min length
							</p>
							 </td><td align="left" valign="top" headers="idm140464213310640"> <p>
								The minimum number of characters in a password.
							</p>
							 <p>
								If any of the <a class="link" href="#additional-password-policy-options-in-idm_defining-idm-password-policies" title="19.6. Additional password policy options in IdM">additional password policy options</a> are set, then the minimum length of passwords is 6 characters.
							</p>
							 </td><td align="left" valign="top" headers="idm140464213309552"> <p>
								Min length = 8
							</p>
							 <p>
								Users cannot use passwords shorter than 8 characters.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464213311728"> <p>
								Max failures
							</p>
							 </td><td align="left" valign="top" headers="idm140464213310640"> <p>
								The maximum number of failed login attempts before IdM locks the user account.
							</p>
							 </td><td align="left" valign="top" headers="idm140464213309552"> <p>
								Max failures = 6
							</p>
							 <p>
								IdM locks the user account when the user enters a wrong password 7 times in a row.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464213311728"> <p>
								Failure reset interval
							</p>
							 </td><td align="left" valign="top" headers="idm140464213310640"> <p>
								The amount of time in seconds after which IdM resets the current number of failed login attempts.
							</p>
							 </td><td align="left" valign="top" headers="idm140464213309552"> <p>
								Failure reset interval = 60
							</p>
							 <p>
								If the user waits for more than 1 minute after the number of failed login attempts defined in <code class="literal">Max failures</code>, the user can attempt to log in again without risking a user account lock.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464213311728"> <p>
								Lockout duration
							</p>
							 </td><td align="left" valign="top" headers="idm140464213310640"> <p>
								The amount of time in seconds that the user account is locked after the number of failed login attempts defined in <code class="literal">Max failures</code>.
							</p>
							 </td><td align="left" valign="top" headers="idm140464213309552"> <p>
								Lockout duration = 600
							</p>
							 <p>
								Users with locked accounts are unable to log in for 10 minutes.
							</p>
							 </td></tr></tbody></table></rh-table><rh-alert class="admonition important" id="english-alphabet" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Use the English alphabet and common symbols for the character classes requirement if you have a diverse set of hardware that may not have access to international characters and symbols. For more information about character class policies in passwords, see <a class="link" href="https://access.redhat.com/solutions/3143431">What characters are valid in a password?</a> in Red Hat Knowledgebase.
				</p></div></rh-alert></section><section class="section" id="password-policy-priorities-in-idm_defining-idm-password-policies"><div class="titlepage"><div><div><h3 class="title">19.3. Password policy priorities in IdM</h3></div></div></div><p>
				Password policies help reduce the risk of someone discovering and misusing a user’s password. The default password policy is the <span class="emphasis"><em>global password policy</em></span>. You can also create additional group password policies. The global policy rules apply to all users without a group password policy. Group password policies apply to all members of the corresponding user group.
			</p><p>
				Note that only one password policy can be in effect at a time for any user. If a user has multiple password policies assigned, one of them takes precedence based on priority according to the following rules:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Every group password policy has a priority set. The lower the value, the higher the policy’s priority. The lowest supported value is <code class="literal">0</code>.
					</li><li class="listitem">
						If multiple password policies are applicable to a user, the policy with the lowest priority value takes precedence. All rules defined in other policies are ignored.
					</li><li class="listitem">
						The password policy with the lowest priority value applies to all password policy attributes, even the attributes that are not defined in the policy.
					</li></ul></div><p>
				The global password policy does not have a priority value set. It serves as a fallback policy when no group policy is set for a user. The global policy can never take precedence over a group policy.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The <code class="literal">ipa pwpolicy-show --user=user_name</code> command shows which policy is currently in effect for a particular user.
				</p></div></rh-alert></section><section class="section" id="ensuring-the-presence-of-a-password-policy-in-idm-using-an-ansible-playbook_defining-idm-password-policies"><div class="titlepage"><div><div><h3 class="title">19.4. Ensuring the presence of a password policy in IdM using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the presence of a password policy in Identity Management (IdM) using an Ansible playbook.
			</p><p>
				In the default <code class="literal">global_policy</code> password policy in IdM, the number of different character classes in the password is set to 0. The history size is also set to 0.
			</p><p>
				Complete this procedure to enforce a stronger password policy for an IdM group using an Ansible playbook.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You can only define a password policy for an IdM group. You cannot define a password policy for an individual user.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						The group for which you are ensuring the presence of a password policy exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define the <code class="literal">FQDN</code> of your IdM server in the <code class="literal">[ipaserver]</code> section:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create your Ansible playbook file that defines the password policy whose presence you want to ensure. To simplify this step, copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/pwpolicy/pwpolicy_present.yml</code> file:
					</p><pre class="literallayout">---
- name: Tests
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure presence of pwpolicy for group ops
    ipapwpolicy:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: ops
      minlife: 7
      maxlife: 49
      history: 5
      priority: 1
      lockouttime: 300
      minlength: 8
      minclasses: 4
      maxfail: 3
      failinterval: 5</pre><p class="simpara">
						For details on what the individual variables mean, see <a class="link" href="#tab-password-policy-attributes_defining-idm-password-policies" title="Table 19.1. Password Policy Attributes">Password policy attributes</a>.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory_/new_pwpolicy_present.yml</em></span></strong></span></pre></li></ol></div><p>
				You have successfully used an Ansible playbook to ensure that a password policy for the <span class="strong strong"><strong>ops</strong></span> group is present in IdM.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					The priority of the <span class="strong strong"><strong>ops</strong></span> password policy is set to <span class="emphasis"><em>1</em></span>, whereas the <span class="strong strong"><strong>global_policy</strong></span> password policy has no priority set. For this reason, the <span class="strong strong"><strong>ops</strong></span> policy automatically supersedes <span class="strong strong"><strong>global_policy</strong></span> for the <span class="strong strong"><strong>ops</strong></span> group and is enforced immediately.
				</p><p>
					<span class="strong strong"><strong>global_policy</strong></span> serves as a fallback policy when no group policy is set for a user, and it can never take precedence over a group policy.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-pwpolicy.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See <a class="link" href="#password-policy-priorities-in-idm_defining-idm-password-policies" title="19.3. Password policy priorities in IdM">Password policy priorities in IdM</a>.
					</li></ul></div></section><section class="section" id="adding-a-new-password-policy-in-idm_defining-idm-password-policies"><div class="titlepage"><div><div><h3 class="title">19.5. Adding a new password policy in IdM using the WebUI or the CLI</h3></div></div></div><p>
				Password policies help reduce the risk of someone discovering and misusing a user’s password. The default password policy is the <span class="emphasis"><em>global password policy</em></span>. You can also create additional group password policies.
			</p><section class="section" id="adding-a-new-password-policy-webui_adding-a-new-password-policy-in-idm"><div class="titlepage"><div><div><h4 class="title">19.5.1. Adding a new password policy in the IdM WebUI</h4></div></div></div><p>
					Password policies help reduce the risk of someone discovering and misusing a user’s password. The default password policy is the <span class="emphasis"><em>global password policy</em></span>. You can also create additional group password policies.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A user group to which the policy applies.
						</li><li class="listitem">
							A priority assigned to the policy
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
							Log in to the IdM Web UI.
						</p><p class="simpara">
							<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/accessing_identity_management_services/accessing-the-ipa-web-ui-in-a-web-browser_accessing-idm-services">https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/accessing_identity_management_services/accessing-the-ipa-web-ui-in-a-web-browser_accessing-idm-services</a>
						</p></li><li class="listitem">
							Select <span class="strong strong"><strong>Policy&gt;Password Policies</strong></span>.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add</strong></span>.
						</li><li class="listitem">
							Define the user group and priority.
						</li><li class="listitem">
							Click <span class="strong strong"><strong>Add</strong></span> to confirm.
						</li></ol></div><p>
					To configure the attributes of the new password policy, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/defining-idm-password-policies_managing-users-groups-hosts#password-policies-in-idm_defining-idm-password-policies">Password policies in IdM</a>.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="#password-policy-priorities-in-idm_defining-idm-password-policies" title="19.3. Password policy priorities in IdM">Password policy priorities in IdM</a>.
						</li></ul></div></section><section class="section" id="adding-a-new-password-policy-in-the-idm-cli_adding-a-new-password-policy-in-idm"><div class="titlepage"><div><div><h4 class="title">19.5.2. Adding a new password policy in the IdM CLI</h4></div></div></div><p>
					Password policies help reduce the risk of someone discovering and misusing a user’s password. The default password policy is the <span class="emphasis"><em>global password policy</em></span>. You can also create additional group password policies.
				</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
							A user group to which the policy applies.
						</li><li class="listitem">
							A priority assigned to the policy
						</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
							Open terminal and connect to the IdM server.
						</li><li class="listitem"><p class="simpara">
							Use the <span class="strong strong"><strong>ipa pwpolicy-add</strong></span> command. Specify the user group and priority:
						</p><pre class="literallayout">$ ipa pwpolicy-add
Group: group_name
Priority: priority_level</pre></li><li class="listitem"><p class="simpara">
							Optional. Use the <span class="strong strong"><strong>ipa pwpolicy-find</strong></span> command to verify that the policy has been successfully added:
						</p><pre class="literallayout">$ ipa pwpolicy-find</pre></li></ol></div><p>
					To configure the attributes of the new password policy, see <a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/defining-idm-password-policies_managing-users-groups-hosts#password-policies-in-idm_defining-idm-password-policies">Password policies in IdM</a>.
				</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
							See <a class="link" href="#password-policy-priorities-in-idm_defining-idm-password-policies" title="19.3. Password policy priorities in IdM">Password policy priorities in IdM</a>.
						</li></ul></div></section></section><section class="section" id="additional-password-policy-options-in-idm_defining-idm-password-policies"><div class="titlepage"><div><div><h3 class="title">19.6. Additional password policy options in IdM</h3></div></div></div><p class="_abstract _abstract">
				As an Identity Management (IdM) administrator, you can strengthen the default password requirements by enabling additional password policy options based on the <code class="literal">libpwquality</code> feature set. The additional password policy options include the following:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">--maxrepeat</code></span></dt><dd>
							Specifies the maximum acceptable number of same consecutive characters in the new password.
						</dd><dt><span class="term"><code class="literal">--maxsequence</code></span></dt><dd>
							Specifies the maximum length of monotonic character sequences in the new password. Examples of such a sequence are <span class="strong strong"><strong>12345</strong></span> or <span class="strong strong"><strong>fedcb</strong></span>. Most such passwords will not pass the simplicity check.
						</dd><dt><span class="term"><code class="literal">--dictcheck</code></span></dt><dd>
							If nonzero, checks whether the password, with possible modifications, matches a word in a dictionary. Currently <code class="literal">libpwquality</code> performs the dictionary check using the <code class="literal">cracklib</code> library.
						</dd><dt><span class="term"><code class="literal">--usercheck</code></span></dt><dd>
							If nonzero, checks whether the password, with possible modifications, contains the user name in some form. It is not performed for user names shorter than 3 characters.
						</dd></dl></div><p>
				You cannot apply the additional password policy options to existing passwords. If you apply any of the additional options, IdM automatically sets the <code class="literal">--minlength</code> option, the minimum number of characters in a password, to <span class="strong strong"><strong>6</strong></span> characters.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					In a mixed environment with RHEL 7, RHEL 8, and RHEL 9 servers, you can enforce the additional password policy settings only on servers running on RHEL 8.4 and later. If a user is logged in to an IdM client and the IdM client is communicating with an IdM server running on RHEL 8.3 or earlier, then the new password policy requirements set by the system administrator will not be applied. To ensure consistent behavior, upgrade or update all servers to RHEL 8.4 and later.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources:</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#applying-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies" title="19.7. Applying additional password policy options to an IdM group">Applying additional password policies to an IdM group</a>
					</li><li class="listitem">
						<code class="literal">pwquality(3)</code> man page on your system
					</li></ul></div></section><section class="section" id="applying-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies"><div class="titlepage"><div><div><h3 class="title">19.7. Applying additional password policy options to an IdM group</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to apply additional password policy options in Identity Management (IdM). The example describes how to strengthen the password policy for the <span class="strong strong"><strong>managers</strong></span> group by making sure that the new passwords do not contain the users' respective user names and that the passwords contain no more than two identical characters in succession.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as an IdM administrator.
					</li><li class="listitem">
						The <span class="strong strong"><strong>managers</strong></span> group exists in IdM.
					</li><li class="listitem">
						The <span class="strong strong"><strong>managers</strong></span> password policy exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Apply the user name check to all new passwords suggested by the users in the <span class="strong strong"><strong>managers</strong></span> group:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa pwpolicy-mod --usercheck=True managers</strong></span></pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
							If you do not specify the name of the password policy, the default <code class="literal">global_policy</code> is modified.
						</p></div></rh-alert></li><li class="listitem"><p class="simpara">
						Set the maximum number of identical consecutive characters to 2 in the <span class="strong strong"><strong>managers</strong></span> password policy:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa pwpolicy-mod --maxrepeat=2 managers</strong></span></pre><p class="simpara">
						A password now will not be accepted if it contains more than 2 identical consecutive characters. For example, the <span class="strong strong"><strong>eR873mUi111YJQ</strong></span> combination is unacceptable because it contains three <span class="strong strong"><strong>1</strong></span>s in succession.
					</p></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add a test user named <span class="strong strong"><strong>test_user</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add test_user</strong></span>
First name: test
Last name: user
----------------------------
Added user "test_user"
----------------------------</pre></li><li class="listitem"><p class="simpara">
						Add the test user to the <span class="strong strong"><strong>managers</strong></span> group:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								In the IdM Web UI, click <span class="guimenu">Identity</span> → <span class="guisubmenu">Groups</span> → <span class="guimenuitem">User Groups</span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>managers</strong></span>.
							</li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Add users into user group 'managers'</strong></span> page, check <span class="strong strong"><strong>test_user</strong></span>.
							</li><li class="listitem">
								Click the <code class="literal">&gt;</code> arrow to move the user to the <code class="literal">Prospective</code> column.
							</li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Reset the password for the test user:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Go to <span class="guimenu">Identity</span> → <span class="guimenuitem">Users</span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>test_user</strong></span>.
							</li><li class="listitem">
								In the <code class="literal">Actions</code> menu, click <code class="literal">Reset Password</code>.
							</li><li class="listitem">
								Enter a temporary password for the user.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						On the command line, try to obtain a Kerberos ticket-granting ticket (TGT) for the <span class="strong strong"><strong>test_user</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit test_user</strong></span></pre><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Enter the temporary password.
							</li><li class="listitem"><p class="simpara">
								The system informs you that you must change your password. Enter a password that contains the user name of <span class="strong strong"><strong>test_user</strong></span>:
							</p><pre class="literallayout">Password expired. You must change it now.
Enter new password:
Enter it again:
Password change rejected: Password not changed.
Unspecified password quality failure while trying to change password.
Please try again.</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Kerberos does not have fine-grained error password policy reporting and, in certain cases, does not provide a clear reason why a password was rejected.
								</p></div></rh-alert></li><li class="listitem"><p class="simpara">
								The system informs you that the entered password was rejected. Enter a password that contains three or more identical characters in succession:
							</p><pre class="literallayout">Password change rejected: Password not changed.
Unspecified password quality failure while trying to change password.
Please try again.

Enter new password:
Enter it again:</pre></li><li class="listitem"><p class="simpara">
								The system informs you that the entered password was rejected. Enter a password that meets the criteria of the <span class="strong strong"><strong>managers</strong></span> password policy:
							</p><pre class="literallayout">Password change rejected: Password not changed.
Unspecified password quality failure while trying to change password.
Please try again.

Enter new password:
Enter it again:</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						View the obtained TGT:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>klist</strong></span>
Ticket cache: KCM:0:33945
Default principal: test_user@IDM.EXAMPLE.COM

Valid starting       Expires              Service principal
07/07/2021 12:44:44  07/08/2021 12:44:44  krbtgt@IDM.EXAMPLE.COM@IDM.EXAMPLE.COM</pre></li></ol></div><p>
				The <span class="strong strong"><strong>managers</strong></span> password policy now works correctly for users in the <span class="strong strong"><strong>managers</strong></span> group.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#additional-password-policy-options-in-idm_defining-idm-password-policies" title="19.6. Additional password policy options in IdM">Additional password policies in IdM</a>
					</li></ul></div></section><section class="section" id="using-an-ansible-playbook-to-apply-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies"><div class="titlepage"><div><div><h3 class="title">19.8. Using an Ansible playbook to apply additional password policy options to an IdM group</h3></div></div></div><p>
				You can use an Ansible playbook to apply additional password policy options to strengthen the password policy requirements for a specific IdM group. You can use the <code class="literal">maxrepeat</code>, <code class="literal">maxsequence</code>, <code class="literal">dictcheck</code> and <code class="literal">usercheck</code> password policy options for this purpose. The example describes how to set the following requirements for the <span class="strong strong"><strong>managers</strong></span> group:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users' new passwords do not contain the users' respective user names.
					</li><li class="listitem">
						The passwords contain no more than two identical characters in succession.
					</li><li class="listitem">
						Any monotonic character sequences in the passwords are not longer than 3 characters. This means that the system does not accept a password with a sequence such as <span class="strong strong"><strong>1234</strong></span> or <span class="strong strong"><strong>abcd</strong></span>.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						The group for which you are ensuring the presence of a password policy exists in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>manager_pwpolicy_present.yml</strong></span> that defines the password policy whose presence you want to ensure. To simplify this step, copy and modify the following example:
					</p><pre class="literallayout">---
- name: Tests
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure presence of usercheck and maxrepeat pwpolicy for group managers
    ipapwpolicy:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: managers
      usercheck: True
      maxrepeat: 2
      maxsequence: 3</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory_/manager_pwpolicy_present.yml</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add a test user named <span class="strong strong"><strong>test_user</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-add test_user</strong></span>
First name: test
Last name: user
----------------------------
Added user "test_user"
----------------------------</pre></li><li class="listitem"><p class="simpara">
						Add the test user to the <span class="strong strong"><strong>managers</strong></span> group:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								In the IdM Web UI, click <span class="guimenu">Identity</span> → <span class="guisubmenu">Groups</span> → <span class="guimenuitem">User Groups</span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>managers</strong></span>.
							</li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li><li class="listitem">
								In the <span class="strong strong"><strong>Add users into user group 'managers'</strong></span> page, check <span class="strong strong"><strong>test_user</strong></span>.
							</li><li class="listitem">
								Click the <code class="literal">&gt;</code> arrow to move the user to the <code class="literal">Prospective</code> column.
							</li><li class="listitem">
								Click <code class="literal">Add</code>.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Reset the password for the test user:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Go to <span class="guimenu">Identity</span> → <span class="guimenuitem">Users</span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>test_user</strong></span>.
							</li><li class="listitem">
								In the <code class="literal">Actions</code> menu, click <code class="literal">Reset Password</code>.
							</li><li class="listitem">
								Enter a temporary password for the user.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						On the command line, try to obtain a Kerberos ticket-granting ticket (TGT) for the <span class="strong strong"><strong>test_user</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit test_user</strong></span></pre><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Enter the temporary password.
							</li><li class="listitem"><p class="simpara">
								The system informs you that you must change your password. Enter a password that contains the user name of <span class="strong strong"><strong>test_user</strong></span>:
							</p><pre class="literallayout">Password expired. You must change it now.
Enter new password:
Enter it again:
Password change rejected: Password not changed.
Unspecified password quality failure while trying to change password.
Please try again.</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Kerberos does not have fine-grained error password policy reporting and, in certain cases, does not provide a clear reason why a password was rejected.
								</p></div></rh-alert></li><li class="listitem"><p class="simpara">
								The system informs you that the entered password was rejected. Enter a password that contains three or more identical characters in succession:
							</p><pre class="literallayout">Password change rejected: Password not changed.
Unspecified password quality failure while trying to change password.
Please try again.

Enter new password:
Enter it again:</pre></li><li class="listitem"><p class="simpara">
								The system informs you that the entered password was rejected. Enter a password that contains a monotonic character sequence longer than 3 characters. Examples of such sequences include <span class="strong strong"><strong>1234</strong></span> and <span class="strong strong"><strong>fedc</strong></span>:
							</p><pre class="literallayout">Password change rejected: Password not changed.
Unspecified password quality failure while trying to change password.
Please try again.

Enter new password:
Enter it again:</pre></li><li class="listitem"><p class="simpara">
								The system informs you that the entered password was rejected. Enter a password that meets the criteria of the <span class="strong strong"><strong>managers</strong></span> password policy:
							</p><pre class="literallayout">Password change rejected: Password not changed.
Unspecified password quality failure while trying to change password.
Please try again.

Enter new password:
Enter it again:</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Verify that you have obtained a TGT, which is only possible after having entered a valid password:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>klist</strong></span>
Ticket cache: KCM:0:33945
Default principal: test_user@IDM.EXAMPLE.COM

Valid starting       Expires              Service principal
07/07/2021 12:44:44  07/08/2021 12:44:44  krbtgt@IDM.EXAMPLE.COM@IDM.EXAMPLE.COM</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#additional-password-policy-options-in-idm_defining-idm-password-policies" title="19.6. Additional password policy options in IdM">Additional password policies in IdM</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-pwpolicy.md</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/playbooks/pwpolicy</code>
					</li></ul></div></section></section><section class="chapter" id="granting-sudo-access-to-an-IdM-user-on-an-IdM-client_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 20. Granting sudo access to an IdM user on an IdM client</h2></div></div></div><p class="_abstract _abstract">
			Learn more about granting <code class="literal">sudo</code> access to users in Identity Management.
		</p><section class="section" id="sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.1. Sudo access on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				System administrators can grant <code class="literal">sudo</code> access to allow non-root users to execute administrative commands that are normally reserved for the <code class="literal">root</code> user. Consequently, when users need to perform an administrative command normally reserved for the <code class="literal">root</code> user, they precede that command with <code class="literal">sudo</code>. After entering their password, the command is executed as if they were the <code class="literal">root</code> user. To execute a <code class="literal">sudo</code> command as another user or group, such as a database service account, you can configure a <span class="emphasis"><em>RunAs alias</em></span> for a <code class="literal">sudo</code> rule.
			</p><p>
				If a Red Hat Enterprise Linux (RHEL) 8 host is enrolled as an Identity Management (IdM) client, you can specify <code class="literal">sudo</code> rules defining which IdM users can perform which commands on the host in the following ways:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Locally in the <code class="literal">/etc/sudoers</code> file
					</li><li class="listitem">
						Centrally in IdM
					</li></ul></div><p>
				You can create a <span class="strong strong"><strong>central <code class="literal">sudo</code> rule</strong></span> for an IdM client using the command line interface (CLI) and the IdM Web UI.
			</p><p>
				You can also configure password-less authentication for <code class="literal">sudo</code> using the Generic Security Service Application Programming Interface (GSSAPI), the native way for UNIX-based operating systems to access and authenticate Kerberos services. You can use the <code class="literal">pam_sss_gss.so</code> Pluggable Authentication Module (PAM) to invoke GSSAPI authentication via the SSSD service, allowing users to authenticate to the <code class="literal">sudo</code> command with a valid Kerberos ticket.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_basic_system_settings/managing-sudo-access_configuring-basic-system-settings">Managing sudo access</a>
					</li></ul></div></section><section class="section" id="proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.2. Granting sudo access to an IdM user on an IdM client using the CLI</h3></div></div></div><p class="_abstract _abstract">
				In Identity Management (IdM), you can grant <code class="literal">sudo</code> access for a specific command to an IdM user account on a specific IdM host. First, add a <code class="literal">sudo</code> command and then create a <code class="literal">sudo</code> rule for one or more commands.
			</p><p>
				For example, complete this procedure to create the <span class="strong strong"><strong>idm_user_reboot</strong></span> <code class="literal">sudo</code> rule to grant the <span class="strong strong"><strong>idm_user</strong></span> account the permission to run the <code class="literal">/usr/sbin/reboot</code> command on the <span class="strong strong"><strong>idmclient</strong></span> machine.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as IdM administrator.
					</li><li class="listitem">
						You have created a user account for <span class="strong strong"><strong>idm_user</strong></span> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the CLI, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line">Adding users using the command line</a>.
					</li><li class="listitem">
						No local <span class="strong strong"><strong>idm_user</strong></span> account is present on the <span class="strong strong"><strong>idmclient</strong></span> host. The <span class="strong strong"><strong>idm_user</strong></span> user is not listed in the local <code class="literal">/etc/passwd</code> file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Retrieve a Kerberos ticket as the IdM <code class="literal">admin</code>.
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">/usr/sbin/reboot</code> command to the IdM database of <code class="literal">sudo</code> commands:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudocmd-add /usr/sbin/reboot</strong></span>
-------------------------------------
Added Sudo Command "/usr/sbin/reboot"
-------------------------------------
  Sudo Command: /usr/sbin/reboot</pre></li><li class="listitem"><p class="simpara">
						Create a <code class="literal">sudo</code> rule named <span class="strong strong"><strong>idm_user_reboot</strong></span>:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add <span class="emphasis"><em>idm_user_reboot</em></span></strong></span>
---------------------------------
Added Sudo Rule "idm_user_reboot"
---------------------------------
  Rule name: idm_user_reboot
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">/usr/sbin/reboot</code> command to the <span class="strong strong"><strong>idm_user_reboot</strong></span> rule:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-allow-command idm_user_reboot --sudocmds '/usr/sbin/reboot'</strong></span>
  Rule name: idm_user_reboot
  Enabled: TRUE
  Sudo Allow Commands: /usr/sbin/reboot
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
						Apply the <span class="strong strong"><strong>idm_user_reboot</strong></span> rule to the IdM <span class="strong strong"><strong>idmclient</strong></span> host:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-host idm_user_reboot --hosts idmclient.idm.example.com</strong></span>
Rule name: idm_user_reboot
Enabled: TRUE
Hosts: idmclient.idm.example.com
Sudo Allow Commands: /usr/sbin/reboot
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
						Add the <span class="strong strong"><strong>idm_user</strong></span> account to the <span class="strong strong"><strong>idm_user_reboot</strong></span> rule:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-user idm_user_reboot --users idm_user</strong></span>
Rule name: idm_user_reboot
Enabled: TRUE
Users: idm_user
Hosts: idmclient.idm.example.com
Sudo Allow Commands: /usr/sbin/reboot
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
						Optional: Define the validity of the <span class="strong strong"><strong>idm_user_reboot</strong></span> rule:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								To define the time at which a <code class="literal">sudo</code> rule starts to be valid, use the <code class="literal">ipa sudorule-mod <span class="emphasis"><em>sudo_rule_name</em></span></code> command with the <code class="literal">--setattr sudonotbefore=<span class="emphasis"><em>DATE</em></span></code> option. The <span class="emphasis"><em>DATE</em></span> value must follow the <span class="strong strong"><strong>yyyymmddHHMMSSZ</strong></span> format, with seconds specified explicitly. For example, to set the start of the validity of the <span class="strong strong"><strong>idm_user_reboot</strong></span> rule to 31 December 2025 12:34:00, enter:
							</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-mod idm_user_reboot --setattr sudonotbefore=20251231123400Z</strong></span></pre></li><li class="listitem"><p class="simpara">
								To define the time at which a sudo rule stops being valid, use the <code class="literal">--setattr sudonotafter=DATE</code> option. For example, to set the end of the <span class="strong strong"><strong>idm_user_reboot</strong></span> rule validity to 31 December 2026 12:34:00, enter:
							</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-mod idm_user_reboot --setattr sudonotafter=20261231123400Z</strong></span></pre></li></ol></div></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Propagating the changes from the server to the client can take a few minutes.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the <span class="strong strong"><strong>idmclient</strong></span> host as the <span class="strong strong"><strong>idm_user</strong></span> account.
					</li><li class="listitem"><p class="simpara">
						Display which <code class="literal">sudo</code> rules the <span class="strong strong"><strong>idm_user</strong></span> account is allowed to perform.
					</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo -l</strong></span>
Matching Defaults entries for <span class="strong strong"><strong>idm_user</strong></span> on <span class="strong strong"><strong>idmclient</strong></span>:
    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,
    env_reset, env_keep="COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS",
    env_keep+="MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE",
    env_keep+="LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES",
    env_keep+="LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE",
    env_keep+="LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME",
    secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin

User <span class="strong strong"><strong>idm_user</strong></span> may run the following commands on <span class="strong strong"><strong>idmclient</strong></span>:
    <span class="strong strong"><strong>(root) /usr/sbin/reboot</strong></span></pre></li><li class="listitem"><p class="simpara">
						Reboot the machine using <code class="literal">sudo</code>. Enter the password for <span class="strong strong"><strong>idm_user</strong></span> when prompted:
					</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo /usr/sbin/reboot</strong></span>
[sudo] password for idm_user:</pre></li></ol></div></section><section class="section" id="proc_granting-sudo-access-to-an-ad-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.3. Granting sudo access to an AD user on an IdM client using the CLI</h3></div></div></div><p class="_abstract _abstract">
				Identity Management (IdM) system administrators can use IdM user groups to set access permissions, host-based access control, <code class="literal">sudo</code> rules, and other controls on IdM users. IdM user groups grant and restrict access to IdM domain resources.
			</p><p>
				You can add both Active Directory (AD) <span class="emphasis"><em>users</em></span> and AD <span class="emphasis"><em>groups</em></span> to IdM user groups. To do that:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Add the AD users or groups to a <span class="emphasis"><em>non-POSIX</em></span> external IdM group.
					</li><li class="listitem">
						Add the non-POSIX external IdM group to an IdM <span class="emphasis"><em>POSIX</em></span> group.
					</li></ol></div><p>
				You can then manage the privileges of the AD users by managing the privileges of the POSIX group. For example, you can grant <code class="literal">sudo</code> access for a specific command to an IdM POSIX user group on a specific IdM host.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					It is also possible to add AD user groups as members to IdM external groups. This might make it easier to define policies for Windows users, by keeping the user and group management within the single AD realm.
				</p></div></rh-alert><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Do <span class="strong strong"><strong>not</strong></span> use ID overrides of AD users for SUDO rules in IdM. ID overrides of AD users represent only POSIX attributes of AD users, not AD users themselves.
				</p><p>
					You can add ID overrides as group members. However, you can only use this functionality to manage IdM resources in the IdM API. The possibility to add ID overrides as group members is not extended to POSIX environments and you therefore cannot use it for membership in <code class="literal">sudo</code> or host-based access control (HBAC) rules.
				</p></div></rh-alert><p>
				Follow this procedure to create the <span class="strong strong"><strong>ad_users_reboot</strong></span> <code class="literal">sudo</code> rule to grant the <span class="strong strong"><strong>administrator@ad-domain.com</strong></span> AD user the permission to run the <code class="literal">/usr/sbin/reboot</code> command on the <span class="strong strong"><strong>idmclient</strong></span> IdM host, which is normally reserved for the <code class="literal">root</code> user. <span class="strong strong"><strong>administrator@ad-domain.com</strong></span> is a member of the <span class="strong strong"><strong>ad_users_external</strong></span> non-POSIX group, which is, in turn, a member of the <span class="strong strong"><strong>ad_users</strong></span> POSIX group.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have obtained the IdM <code class="literal">admin</code> Kerberos ticket-granting ticket (TGT).
					</li><li class="listitem">
						A cross-forest trust exists between the IdM domain and the <span class="strong strong"><strong>ad-domain.com</strong></span> AD domain.
					</li><li class="listitem">
						No local <span class="strong strong"><strong>administrator</strong></span> account is present on the <span class="strong strong"><strong>idmclient</strong></span> host: the <span class="strong strong"><strong>administrator</strong></span> user is not listed in the local <code class="literal">/etc/passwd</code> file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create the <span class="strong strong"><strong><span class="emphasis"><em>ad_users</em></span></strong></span> group that contains the <span class="strong strong"><strong><span class="emphasis"><em>ad_users_external</em></span></strong></span> group with the <span class="strong strong"><strong>administrator@ad-domain</strong></span> member:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Optional: Create or select a corresponding group in the AD domain to use to manage AD users in the IdM realm. You can use multiple AD groups and add them to different groups on the IdM side.
							</li><li class="listitem"><p class="simpara">
								Create the <span class="strong strong"><strong><span class="emphasis"><em>ad_users_external</em></span></strong></span> group and indicate that it contains members from outside the IdM domain by adding the <code class="literal option">--external</code> option:
							</p><pre class="literallayout">[root@ipaserver ~]# <span class="strong strong"><strong>ipa group-add --desc='AD users external map' ad_users_external --external</strong></span>
-------------------------------
Added group "ad_users_external"
-------------------------------
  Group name: ad_users_external
  Description: AD users external map</pre><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
									Ensure that the external group that you specify here is an AD security group with a <code class="literal">global</code> or <code class="literal">universal</code> group scope as defined in the <a class="link" href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups">Active Directory security groups</a> document. For example, the <span class="strong strong"><strong>Domain users</strong></span> or <span class="strong strong"><strong>Domain admins</strong></span> AD security groups cannot be used because their group scope is <code class="literal">domain local</code>.
								</p></div></rh-alert></li><li class="listitem"><p class="simpara">
								Create the <span class="strong strong"><strong>ad_users</strong></span> group:
							</p><pre class="literallayout">[root@ipaserver ~]# <span class="strong strong"><strong>ipa group-add --desc='AD users' ad_users</strong></span>
----------------------
Added group "ad_users"
----------------------
  Group name: ad_users
  Description: AD users
  GID: 129600004</pre></li><li class="listitem"><p class="simpara">
								Add the <span class="strong strong"><strong>administrator@ad-domain.com</strong></span> AD user to <span class="strong strong"><strong>ad_users_external</strong></span> as an external member:
							</p><pre class="literallayout">[root@ipaserver ~]# <span class="strong strong"><strong>ipa group-add-member ad_users_external --external "administrator@ad-domain.com"</strong></span>
 [member user]:
 [member group]:
  Group name: ad_users_external
  Description: AD users external map
  External member: S-1-5-21-3655990580-1375374850-1633065477-513
-------------------------
Number of members added 1
-------------------------</pre><p class="simpara">
								The AD user must be identified by a fully-qualified name, such as <code class="literal">DOMAIN\user_name</code> or <code class="literal">user_name@DOMAIN</code>. The AD identity is then mapped to the AD SID for the user. The same applies to adding AD groups.
							</p></li><li class="listitem"><p class="simpara">
								Add <span class="strong strong"><strong>ad_users_external</strong></span> to <span class="strong strong"><strong>ad_users</strong></span> as a member:
							</p><pre class="literallayout">[root@ipaserver ~]# <span class="strong strong"><strong>ipa group-add-member ad_users --groups ad_users_external</strong></span>
  Group name: ad_users
  Description: AD users
  GID: 129600004
  Member groups: ad_users_external
-------------------------
Number of members added 1
-------------------------</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Grant the members of <span class="strong strong"><strong>ad_users</strong></span> the permission to run <code class="literal">/usr/sbin/reboot</code> on the <span class="strong strong"><strong>idmclient</strong></span> host:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Add the <code class="literal">/usr/sbin/reboot</code> command to the IdM database of <code class="literal">sudo</code> commands:
							</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudocmd-add /usr/sbin/reboot</strong></span>
-------------------------------------
Added Sudo Command "/usr/sbin/reboot"
-------------------------------------
  Sudo Command: /usr/sbin/reboot</pre></li><li class="listitem"><p class="simpara">
								Create a <code class="literal">sudo</code> rule named <span class="strong strong"><strong>ad_users_reboot</strong></span>:
							</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add <span class="emphasis"><em>ad_users_reboot</em></span></strong></span>
---------------------------------
Added Sudo Rule "ad_users_reboot"
---------------------------------
  Rule name: ad_users_reboot
  Enabled: True</pre></li><li class="listitem"><p class="simpara">
								Add the <code class="literal">/usr/sbin/reboot</code> command to the <span class="strong strong"><strong>ad_users_reboot</strong></span> rule:
							</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-allow-command ad_users_reboot --sudocmds '/usr/sbin/reboot'</strong></span>
  Rule name: ad_users_reboot
  Enabled: True
  Sudo Allow Commands: /usr/sbin/reboot
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
								Apply the <span class="strong strong"><strong>ad_users_reboot</strong></span> rule to the IdM <span class="strong strong"><strong>idmclient</strong></span> host:
							</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-host ad_users_reboot --hosts idmclient.idm.example.com</strong></span>
Rule name: ad_users_reboot
Enabled: True
Hosts: idmclient.idm.example.com
Sudo Allow Commands: /usr/sbin/reboot
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
								Add the <code class="literal">ad_users</code> group to the <span class="strong strong"><strong>ad_users_reboot</strong></span> rule:
							</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-user ad_users_reboot --groups ad_users</strong></span>
Rule name: ad_users_reboot
Enabled: TRUE
User Groups: ad_users
Hosts: idmclient.idm.example.com
Sudo Allow Commands: /usr/sbin/reboot
-------------------------
Number of members added 1
-------------------------</pre></li></ol></div></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Propagating the changes from the server to the client can take a few minutes.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log in to the <span class="strong strong"><strong>idmclient</strong></span> host as <span class="strong strong"><strong>administrator@ad-domain.com</strong></span>, an indirect member of the <code class="literal">ad_users</code> group:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh administrator@ad-domain.com@ipaclient</strong></span>
Password:</pre></li><li class="listitem"><p class="simpara">
						Optional: Display the <code class="literal">sudo</code> commands that <code class="literal">administrator@ad-domain.com</code> is allowed to execute:
					</p><pre class="literallayout">[administrator@ad-domain.com@idmclient ~]$ <span class="strong strong"><strong>sudo -l</strong></span>
Matching Defaults entries for <span class="strong strong"><strong>administrator@ad-domain.com</strong></span> on <span class="strong strong"><strong>idmclient</strong></span>:
    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,
    env_reset, env_keep="COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS",
    env_keep+="MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE",
    env_keep+="LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES",
    env_keep+="LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE",
    env_keep+="LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME",
    secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin

User <span class="strong strong"><strong>administrator@ad-domain.com</strong></span> may run the following commands on <span class="strong strong"><strong>idmclient</strong></span>:
    <span class="strong strong"><strong>(root) /usr/sbin/reboot</strong></span></pre></li><li class="listitem"><p class="simpara">
						Reboot the machine using <code class="literal">sudo</code>. Enter the password for <code class="literal">administrator@ad-domain.com</code> when prompted:
					</p><pre class="literallayout">[administrator@ad-domain.com@idmclient ~]$ <span class="strong strong"><strong>sudo /usr/sbin/reboot</strong></span>
[sudo] password for administrator@ad-domain.com:</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/windows_integration_guide/index#trust-win-groups">Active Directory users and Identity Management groups</a>
					</li><li class="listitem">
						<a class="link" href="https://freeipa.readthedocs.io/en/latest/designs/adtrust/sudorules-with-ad-objects.html">Include users and groups from a trusted Active Directory domain into SUDO rules</a>
					</li></ul></div></section><section class="section" id="using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.4. Granting sudo access to an IdM user on an IdM client using the IdM Web UI</h3></div></div></div><p class="_abstract _abstract">
				In Identity Management (IdM), you can grant <code class="literal">sudo</code> access for a specific command to an IdM user account on a specific IdM host. First, add a <code class="literal">sudo</code> command and then create a <code class="literal">sudo</code> rule for one or more commands.
			</p><p>
				Complete this procedure to create the <code class="literal">idm_user_reboot</code> sudo rule to grant the <code class="literal">idm_user</code> account the permission to run the <code class="literal">/usr/sbin/reboot</code> command on the <code class="literal">idmclient</code> machine.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as IdM administrator.
					</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						You have created a user account for <code class="literal">idm_user</code> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the command-line interface, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line">Adding users using the command line</a>.
					</li><li class="listitem">
						No local <code class="literal">idm_user</code> account is present on the <code class="literal">idmclient</code> host. The <code class="literal">idm_user</code> user is not listed in the local <code class="literal">/etc/passwd</code> file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the <code class="literal">/usr/sbin/reboot</code> command to the IdM database of <code class="literal">sudo</code> commands:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Policy</strong></span> → <span class="strong strong"><strong>Sudo</strong></span> → <span class="strong strong"><strong>Sudo Commands</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span> in the upper right corner to open the <span class="strong strong"><strong>Add sudo command</strong></span> dialog box.
							</li><li class="listitem"><p class="simpara">
								Enter the command you want the user to be able to perform using <code class="literal">sudo</code>: <code class="literal">/usr/sbin/reboot</code>.
							</p><div class="figure" id="adding-IdM-sudo-command_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><p class="title"><strong>Figure 20.1. Adding IdM sudo command</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/9a1e57c1b7862f10d8e7fd8bc6392a7c/adding-IdM-sudo-command.png" alt="A screenshot of a pop-up window labeled &quot;Add sudo command.&quot; There is a required field labeled &quot;Sudo command&quot; with contents &quot;/usr/sbin/reboot&quot;. A &quot;Description&quot; field is empty. The lower-right of the window has four buttons: &quot;Add&quot; - &quot;Add and Add Another&quot; - &quot;Add and Edit&quot; - &quot;Cancel&quot;."></div></div></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span>.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Use the new <code class="literal">sudo</code> command entry to create a sudo rule to allow <span class="strong strong"><strong>idm_user</strong></span> to reboot the <span class="strong strong"><strong>idmclient</strong></span> machine:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Policy</strong></span> → <span class="strong strong"><strong>Sudo</strong></span> → <span class="strong strong"><strong>Sudo rules</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span> in the upper right corner to open the <span class="strong strong"><strong>Add sudo rule</strong></span> dialog box.
							</li><li class="listitem">
								Enter the name of the <code class="literal">sudo</code> rule: <span class="strong strong"><strong>idm_user_reboot</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add and Edit</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Specify the user:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>Who</strong></span> section, check the <span class="strong strong"><strong>Specified Users and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>User category the rule applies to</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add users into sudo rule "idm_user_reboot"</strong></span> dialog box.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Add users into sudo rule "idm_user_reboot"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <span class="strong strong"><strong>idm_user</strong></span> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Specify the host:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>Access this host</strong></span> section, check the <span class="strong strong"><strong>Specified Hosts and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Host category this rule applies to</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add hosts into sudo rule "idm_user_reboot"</strong></span> dialog box.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Add hosts into sudo rule "idm_user_reboot"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <span class="strong strong"><strong>idmclient.idm.example.com</strong></span> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Specify the commands:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>Command category the rule applies to</strong></span> subsection of the <span class="strong strong"><strong>Run Commands</strong></span> section, check the <span class="strong strong"><strong>Specified Commands and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Sudo Allow Commands</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add allow sudo commands into sudo rule "idm_user_reboot"</strong></span> dialog box.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Add allow sudo commands into sudo rule "idm_user_reboot"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <code class="literal">/usr/sbin/reboot</code> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span> to return to the <span class="strong strong"><strong>idm_sudo_reboot</strong></span> page.
									</li></ol></div><div class="figure" id="adding-IdM-sudo-rule_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><p class="title"><strong>Figure 20.2. Adding IdM sudo rule</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/3be5fa7d17bf8835989c8e9411a4c1c0/IdM-sudo-rule-WebUI.png" alt="A screenshot of an overview of the sudo rule that was added. There is a &quot;Who&quot; section with a table of users the rule applies to. There is an &quot;Access this host&quot; section with a table of hosts that the rule applies to. There is a &quot;Run Commands&quot; section with a table of commands that pertain to the rule."></div></div></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span> in the top left corner.
							</li></ol></div></li></ol></div><p>
				The new rule is enabled by default.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Propagating the changes from the server to the client can take a few minutes.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to <code class="literal">idmclient</code> as <code class="literal">idm_user</code>.
					</li><li class="listitem"><p class="simpara">
						Reboot the machine using <code class="literal">sudo</code>. Enter the password for <code class="literal">idm_user</code> when prompted:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>sudo /usr/sbin/reboot</strong></span>
[sudo] password for idm_user:</pre></li></ol></div><p>
				If the <code class="literal">sudo</code> rule is configured correctly, the machine reboots.
			</p></section><section class="section" id="proc_creating-a-sudo-rule-on-the-cli-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.5. Creating a sudo rule on the CLI that runs a command as a service account on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				In IdM, you can configure a <code class="literal">sudo</code> rule with a <span class="emphasis"><em>RunAs alias</em></span> to run a <code class="literal">sudo</code> command as another user or group. For example, you might have an IdM client that hosts a database application, and you need to run commands as the local service account that corresponds to that application.
			</p><p>
				Use this example to create a <code class="literal">sudo</code> rule on the command line called <code class="literal">run_third-party-app_report</code> to allow the <code class="literal">idm_user</code> account to run the <code class="literal">/opt/third-party-app/bin/report</code> command as the <code class="literal">thirdpartyapp</code> service account on the <code class="literal">idmclient</code> host.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as IdM administrator.
					</li><li class="listitem">
						You have created a user account for <code class="literal">idm_user</code> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the CLI, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line">Adding users using the command line</a>.
					</li><li class="listitem">
						No local <code class="literal">idm_user</code> account is present on the <code class="literal">idmclient</code> host. The <code class="literal">idm_user</code> user is not listed in the local <code class="literal">/etc/passwd</code> file.
					</li><li class="listitem">
						You have a custom application named <code class="literal">third-party-app</code> installed on the <code class="literal">idmclient</code> host.
					</li><li class="listitem">
						The <code class="literal">report</code> command for the <code class="literal">third-party-app</code> application is installed in the <code class="literal">/opt/third-party-app/bin/report</code> directory.
					</li><li class="listitem">
						You have created a local service account named <code class="literal">thirdpartyapp</code> to execute commands for the <code class="literal">third-party-app</code> application.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Retrieve a Kerberos ticket as the IdM <code class="literal">admin</code>.
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">/opt/third-party-app/bin/report</code> command to the IdM database of <code class="literal">sudo</code> commands:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudocmd-add /opt/third-party-app/bin/report</strong></span>
----------------------------------------------------
Added Sudo Command "/opt/third-party-app/bin/report"
----------------------------------------------------
  Sudo Command: /opt/third-party-app/bin/report</pre></li><li class="listitem"><p class="simpara">
						Create a <code class="literal">sudo</code> rule named <code class="literal">run_third-party-app_report</code>:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add <span class="emphasis"><em>run_third-party-app_report</em></span></strong></span>
--------------------------------------------
Added Sudo Rule "run_third-party-app_report"
--------------------------------------------
  Rule name: run_third-party-app_report
  Enabled: TRUE</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">--users=<span class="emphasis"><em>&lt;user&gt;</em></span></code> option to specify the RunAs user for the <code class="literal">sudorule-add-runasuser</code> command:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-runasuser <span class="emphasis"><em>run_third-party-app_report</em></span> --users=<span class="emphasis"><em>thirdpartyapp</em></span></strong></span>
  Rule name: run_third-party-app_report
  Enabled: TRUE
  RunAs External User: thirdpartyapp
-------------------------
Number of members added 1
-------------------------</pre><p class="simpara">
						The user (or group specified with the <code class="literal">--groups=*</code> option) can be external to IdM, such as a local service account or an Active Directory user. Do not add a <code class="literal">%</code> prefix for group names.
					</p></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">/opt/third-party-app/bin/report</code> command to the <code class="literal">run_third-party-app_report</code> rule:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-allow-command run_third-party-app_report --sudocmds '/opt/third-party-app/bin/report'</strong></span>
Rule name: run_third-party-app_report
Enabled: TRUE
Sudo Allow Commands: /opt/third-party-app/bin/report
RunAs External User: thirdpartyapp
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
						Apply the <code class="literal">run_third-party-app_report</code> rule to the IdM <code class="literal">idmclient</code> host:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-host run_third-party-app_report --hosts idmclient.idm.example.com</strong></span>
Rule name: run_third-party-app_report
Enabled: TRUE
Hosts: idmclient.idm.example.com
Sudo Allow Commands: /opt/third-party-app/bin/report
RunAs External User: thirdpartyapp
-------------------------
Number of members added 1
-------------------------</pre></li><li class="listitem"><p class="simpara">
						Add the <code class="literal">idm_user</code> account to the <code class="literal">run_third-party-app_report</code> rule:
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ipa sudorule-add-user run_third-party-app_report --users idm_user</strong></span>
Rule name: run_third-party-app_report
Enabled: TRUE
Users: idm_user
Hosts: idmclient.idm.example.com
Sudo Allow Commands: /opt/third-party-app/bin/report
RunAs External User: thirdpartyapp
-------------------------
Number of members added 1</pre></li></ol></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Propagating the changes from the server to the client can take a few minutes.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the <code class="literal">idmclient</code> host as the <code class="literal">idm_user</code> account.
					</li><li class="listitem"><p class="simpara">
						Test the new sudo rule:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Display which <code class="literal">sudo</code> rules the <code class="literal">idm_user</code> account is allowed to perform.
							</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo -l</strong></span>
Matching Defaults entries for idm_user@idm.example.com on idmclient:
    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,
    env_reset, env_keep="COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS",
    env_keep+="MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE",
    env_keep+="LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES",
    env_keep+="LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE",
    env_keep+="LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME",
    secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin

User idm_user@idm.example.com may run the following commands on idmclient:
    <span class="strong strong"><strong>(thirdpartyapp) /opt/third-party-app/bin/report</strong></span></pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">report</code> command as the <code class="literal">thirdpartyapp</code> service account.
							</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo -u <span class="emphasis"><em>thirdpartyapp</em></span> /opt/third-party-app/bin/report</strong></span>
[sudo] password for idm_user@idm.example.com:
Executing report...
Report successful.</pre></li></ol></div></li></ol></div></section><section class="section" id="proc_creating-a-sudo-rule-in-the-idm-webui-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.6. Creating a sudo rule in the IdM WebUI that runs a command as a service account on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				In IdM, you can configure a <code class="literal">sudo</code> rule with a <span class="emphasis"><em>RunAs alias</em></span> to run a <code class="literal">sudo</code> command as another user or group. For example, you might have an IdM client that hosts a database application, and you need to run commands as the local service account that corresponds to that application.
			</p><p>
				Use this example to create a <code class="literal">sudo</code> rule in the IdM WebUI called <code class="literal">run_third-party-app_report</code> to allow the <code class="literal">idm_user</code> account to run the <code class="literal">/opt/third-party-app/bin/report</code> command as the <code class="literal">thirdpartyapp</code> service account on the <code class="literal">idmclient</code> host.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as IdM administrator.
					</li><li class="listitem">
						You have created a user account for <code class="literal">idm_user</code> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the CLI, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line">Adding users using the command line</a>.
					</li><li class="listitem">
						No local <code class="literal">idm_user</code> account is present on the <code class="literal">idmclient</code> host. The <code class="literal">idm_user</code> user is not listed in the local <code class="literal">/etc/passwd</code> file.
					</li><li class="listitem">
						You have a custom application named <code class="literal">third-party-app</code> installed on the <code class="literal">idmclient</code> host.
					</li><li class="listitem">
						The <code class="literal">report</code> command for the <code class="literal">third-party-app</code> application is installed in the <code class="literal">/opt/third-party-app/bin/report</code> directory.
					</li><li class="listitem">
						You have created a local service account named <code class="literal">thirdpartyapp</code> to execute commands for the <code class="literal">third-party-app</code> application.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Add the <code class="literal">/opt/third-party-app/bin/report</code> command to the IdM database of <code class="literal">sudo</code> commands:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Policy</strong></span> → <span class="strong strong"><strong>Sudo</strong></span> → <span class="strong strong"><strong>Sudo Commands</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span> in the upper right corner to open the <span class="strong strong"><strong>Add sudo command</strong></span> dialog box.
							</li><li class="listitem"><p class="simpara">
								Enter the command: <code class="literal">/opt/third-party-app/bin/report</code>.
							</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/38569bcd46893efb28021dda70cb30dc/idm-sudo-rule-runas-command.png" alt="A screenshot of a pop-up window labeled &quot;Add sudo command.&quot; There is a required field labeled &quot;Sudo command&quot; with contents &quot;/opt/third-party-app/bin/report&quot;. A &quot;Description&quot; field is empty. The lower-right of the window has four buttons: &quot;Add&quot; - &quot;Add and Add Another&quot; - &quot;Add and Edit&quot; - &quot;Cancel&quot;."></div></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span>.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Use the new <code class="literal">sudo</code> command entry to create the new <code class="literal">sudo</code> rule:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Navigate to <span class="strong strong"><strong>Policy</strong></span> → <span class="strong strong"><strong>Sudo</strong></span> → <span class="strong strong"><strong>Sudo rules</strong></span>.
							</li><li class="listitem">
								Click <span class="strong strong"><strong>Add</strong></span> in the upper right corner to open the <span class="strong strong"><strong>Add sudo rule</strong></span> dialog box.
							</li><li class="listitem"><p class="simpara">
								Enter the name of the <code class="literal">sudo</code> rule: <span class="strong strong"><strong>run_third-party-app_report</strong></span>.
							</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/9851a7603c04519b9be8dc4303556240/idm-sudo-rule-runas-rule.png" alt="A screenshot of a pop-up window labeled &quot;Add sudo rule.&quot; There is a required field labeled &quot;Rule name&quot; with contents &quot;run_third-party-app_report&quot;. The lower-right of the window has four buttons: &quot;Add&quot; - &quot;Add and Add Another&quot; - &quot;Add and Edit&quot; - &quot;Cancel&quot;."></div></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Add and Edit</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Specify the user:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>Who</strong></span> section, check the <span class="strong strong"><strong>Specified Users and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>User category the rule applies to</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add users into sudo rule "run_third-party-app_report"</strong></span> dialog box.
									</li><li class="listitem"><p class="simpara">
										In the <span class="strong strong"><strong>Add users into sudo rule "run_third-party-app_report"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <span class="strong strong"><strong>idm_user</strong></span> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/27d4a17b3ecf6010c206a566a0b5d0f7/idm-sudo-rule-runas-user.png" alt="A screenshot of a pop-up window labeled &quot;Add users into sudo rule.&quot; You can select users from an Available list on the left and move them to a Prospective column on the right. The lower-right of the window has two buttons: &quot;Add&quot; - &quot;Cancel&quot;."></div></div></li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Specify the host:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>Access this host</strong></span> section, check the <span class="strong strong"><strong>Specified Hosts and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Host category this rule applies to</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add hosts into sudo rule "run_third-party-app_report"</strong></span> dialog box.
									</li><li class="listitem"><p class="simpara">
										In the <span class="strong strong"><strong>Add hosts into sudo rule "run_third-party-app_report"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <span class="strong strong"><strong>idmclient.idm.example.com</strong></span> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/f00e257165b307caa6a17f528e1f7982/idm-sudo-rule-runas-host.png" alt="A screenshot of a pop-up window labeled &quot;Add hosts into sudo rule.&quot; You can select hosts from an Available list on the left and move them to a Prospective column on the right. The lower-right of the window has two buttons: &quot;Add&quot; - &quot;Cancel&quot;."></div></div></li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Specify the commands:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>Command category the rule applies to</strong></span> subsection of the <span class="strong strong"><strong>Run Commands</strong></span> section, check the <span class="strong strong"><strong>Specified Commands and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>Sudo Allow Commands</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add allow sudo commands into sudo rule "run_third-party-app_report"</strong></span> dialog box.
									</li><li class="listitem"><p class="simpara">
										In the <span class="strong strong"><strong>Add allow sudo commands into sudo rule "run_third-party-app_report"</strong></span> dialog box in the <span class="strong strong"><strong>Available</strong></span> column, check the <code class="literal">/opt/third-party-app/bin/report</code> checkbox, and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/2c36f0491d1c88cc71936d2a1eafb28d/idm-sudo-rule-runas-commandinrule.png" alt="A screenshot of a pop-up window labeled &quot;Add allow sudo commands into sudo rule.&quot; You can select sudo commands from an Available list on the left and move them to a Prospective column on the right. The lower-right of the window has two buttons: &quot;Add&quot; - &quot;Cancel&quot;."></div></div></li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span> to return to the <span class="strong strong"><strong>run_third-party-app_report</strong></span> page.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Specify the RunAs user:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										In the <span class="strong strong"><strong>As Whom</strong></span> section, check the <span class="strong strong"><strong>Specified Users and Groups</strong></span> radio button.
									</li><li class="listitem">
										In the <span class="strong strong"><strong>RunAs Users</strong></span> subsection, click <span class="strong strong"><strong>Add</strong></span> to open the <span class="strong strong"><strong>Add RunAs users into sudo rule "run_third-party-app_report"</strong></span> dialog box.
									</li><li class="listitem"><p class="simpara">
										In the <span class="strong strong"><strong>Add RunAs users into sudo rule "run_third-party-app_report"</strong></span> dialog box, enter the <code class="literal">thirdpartyapp</code> service account in the <span class="strong strong"><strong>External</strong></span> box and move it to the <span class="strong strong"><strong>Prospective</strong></span> column.
									</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/497802711769ecefebdacbb726cf8f9c/idm-sudo-rule-runas-runasuser.png" alt="A screenshot of a dialog box where you can specify the &quot;thirdpartyapp&quot; service account as an external user."></div></div></li><li class="listitem">
										Click <span class="strong strong"><strong>Add</strong></span> to return to the <span class="strong strong"><strong>run_third-party-app_report</strong></span> page.
									</li></ol></div></li><li class="listitem">
								Click <span class="strong strong"><strong>Save</strong></span> in the top left corner.
							</li></ol></div></li></ol></div><p>
				The new rule is enabled by default.
			</p><div class="figure" id="details-of-RunAs-sudo-rule_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><p class="title"><strong>Figure 20.3. Details of the sudo rule</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/fba1243a13c367506fa2a57e70f8bb25/idm-sudo-rule-runas-details.png" alt="A screenshot of an overview of the sudo rule that was added. The &quot;Who&quot; section has an entry for &quot;idm_user.&quot; The &quot;Access this host&quot; section has &quot;idmclient.idm.example.com.&quot; The &quot;Run Commands&quot; section has the &quot;/opt/third-party-app/bin/report&quot; command. The &quot;As Whom&quot; section lists the &quot;thirdpartyapp&quot; account."></div></div></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Propagating the changes from the server to the client can take a few minutes.
				</p></div></rh-alert><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the <code class="literal">idmclient</code> host as the <code class="literal">idm_user</code> account.
					</li><li class="listitem"><p class="simpara">
						Test the new sudo rule:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Display which <code class="literal">sudo</code> rules the <code class="literal">idm_user</code> account is allowed to perform.
							</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo -l</strong></span>
Matching Defaults entries for idm_user@idm.example.com on idmclient:
    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,
    env_reset, env_keep="COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS",
    env_keep+="MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE",
    env_keep+="LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES",
    env_keep+="LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE",
    env_keep+="LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME",
    secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin

User idm_user@idm.example.com may run the following commands on idmclient:
    <span class="strong strong"><strong>(thirdpartyapp) /opt/third-party-app/bin/report</strong></span></pre></li><li class="listitem"><p class="simpara">
								Run the <code class="literal">report</code> command as the <code class="literal">thirdpartyapp</code> service account.
							</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo -u <span class="emphasis"><em>thirdpartyapp</em></span> /opt/third-party-app/bin/report</strong></span>
[sudo] password for idm_user@idm.example.com:
Executing report...
Report successful.</pre></li></ol></div></li></ol></div></section><section class="section" id="proc_enabling-gssapi-authentication-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.7. Enabling GSSAPI authentication for sudo on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				Enable Generic Security Service Application Program Interface (GSSAPI) authentication on an IdM client for the <code class="literal">sudo</code> and <code class="literal">sudo -i</code> commands via the <code class="literal">pam_sss_gss.so</code> PAM module. With this configuration, IdM users can authenticate to the <code class="literal">sudo</code> command with their Kerberos ticket.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have created a <code class="literal">sudo</code> rule for an IdM user that applies to an IdM host. For this example, you have created the <code class="literal">idm_user_reboot</code> <code class="literal">sudo</code> rule to grant the <code class="literal">idm_user</code> account the permission to run the <code class="literal">/usr/sbin/reboot</code> command on the <code class="literal">idmclient</code> host.
					</li><li class="listitem">
						You need <code class="literal">root</code> privileges to modify the <code class="literal">/etc/sssd/sssd.conf</code> file and PAM files in the <code class="literal">/etc/pam.d/</code> directory.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the <code class="literal">/etc/sssd/sssd.conf</code> configuration file.
					</li><li class="listitem"><p class="simpara">
						Add the following entry to the <code class="literal">[domain/<span class="emphasis"><em>&lt;domain_name&gt;</em></span>]</code> section.
					</p><pre class="literallayout">[domain/<span class="emphasis"><em>&lt;domain_name&gt;</em></span>]
<span class="strong strong"><strong>pam_gssapi_services = sudo, sudo-i</strong></span></pre></li><li class="listitem">
						Save and close the <code class="literal">/etc/sssd/sssd.conf</code> file.
					</li><li class="listitem"><p class="simpara">
						Restart the SSSD service to load the configuration changes.
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li><li class="listitem"><p class="simpara">
						On RHEL 9.2 or later:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Optional: Determine if you have selected the <code class="literal">sssd</code> <code class="literal">authselect</code> profile:
							</p><pre class="literallayout"># <span class="strong strong"><strong>authselect current</strong></span>
Profile ID: sssd</pre></li><li class="listitem"><p class="simpara">
								If the <code class="literal">sssd</code> <code class="literal">authselect</code> profile is selected, enable GSSAPI authentication:
							</p><pre class="literallayout"># <span class="strong strong"><strong>authselect enable-feature with-gssapi</strong></span></pre></li><li class="listitem"><p class="simpara">
								If the <code class="literal">sssd</code> <code class="literal">authselect</code> profile is not selected, select it and enable GSSAPI authentication:
							</p><pre class="literallayout"># <span class="strong strong"><strong>authselect select sssd with-gssapi</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						On RHEL 9.1 or earlier:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Open the <code class="literal">/etc/pam.d/sudo</code> PAM configuration file.
							</li><li class="listitem"><p class="simpara">
								Add the following entry as the first line of the <code class="literal">auth</code> section in the <code class="literal">/etc/pam.d/sudo</code> file.
							</p><pre class="literallayout">#%PAM-1.0
<span class="strong strong"><strong>auth sufficient pam_sss_gss.so</strong></span>
auth       include      system-auth
account    include      system-auth
password   include      system-auth
session    include      system-auth</pre></li><li class="listitem">
								Save and close the <code class="literal">/etc/pam.d/sudo</code> file.
							</li></ol></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into the host as the <code class="literal">idm_user</code> account.
					</p><pre class="literallayout">[root@idm-client ~]# <span class="strong strong"><strong>ssh -l <span class="emphasis"><em>idm_user@idm.example.com</em></span> localhost</strong></span>
idm_user@idm.example.com's password:</pre></li><li class="listitem"><p class="simpara">
						Verify that you have a ticket-granting ticket as the <code class="literal">idm_user</code> account.
					</p><pre class="literallayout">[idmuser@idmclient ~]$ <span class="strong strong"><strong>klist</strong></span>
Ticket cache: KCM:1366201107
Default principal: <span class="strong strong"><strong>idm_user@IDM.EXAMPLE.COM</strong></span>

Valid starting       Expires              Service principal
01/08/2021 09:11:48  01/08/2021 19:11:48  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM
	renew until 01/15/2021 09:11:44</pre></li><li class="listitem"><p class="simpara">
						Optional: If you do not have Kerberos credentials for the <code class="literal">idm_user</code> account, delete your current Kerberos credentials and request the correct ones.
					</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>kdestroy -A</strong></span>

[idm_user@idmclient ~]$ <span class="strong strong"><strong>kinit idm_user@IDM.EXAMPLE.COM</strong></span>
Password for <span class="strong strong"><strong>idm_user@idm.example.com</strong></span>:</pre></li><li class="listitem"><p class="simpara">
						Reboot the machine using <code class="literal">sudo</code>, without specifying a password.
					</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo /usr/sbin/reboot</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The GSSAPI entry in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/overview-of-identity-management-and-access-control-planning-identity-management#IdM_terminology_overview-of-idm-and-access-control">IdM terminology</a> listing
					</li><li class="listitem">
						<a class="link" href="#using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" title="20.4. Granting sudo access to an IdM user on an IdM client using the IdM Web UI">Granting sudo access to an IdM user on an IdM client using IdM Web UI</a>
					</li><li class="listitem">
						<a class="link" href="#proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" title="20.2. Granting sudo access to an IdM user on an IdM client using the CLI">Granting sudo access to an IdM user on an IdM client using the CLI</a>
					</li><li class="listitem">
						<code class="literal">pam_sss_gss (8)</code> and <code class="literal">sssd.conf (5)</code> man pages on your system
					</li></ul></div></section><section class="section" id="proc_enabling-gssapi-authentication-and-enforcing-kerberos-authentication-indicators-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.8. Enabling GSSAPI authentication and enforcing Kerberos authentication indicators for sudo on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				Enable Generic Security Service Application Program Interface (GSSAPI) authentication on an IdM client for the <code class="literal">sudo</code> and <code class="literal">sudo -i</code> commands via the <code class="literal">pam_sss_gss.so</code> PAM module. Additionally, only users who have logged in with a smart card will authenticate to those commands with their Kerberos ticket.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You can use this procedure as a template to configure GSSAPI authentication with SSSD for other PAM-aware services, and further restrict access to only those users that have a specific authentication indicator attached to their Kerberos ticket.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have created a <code class="literal">sudo</code> rule for an IdM user that applies to an IdM host. For this example, you have created the <code class="literal">idm_user_reboot</code> <code class="literal">sudo</code> rule to grant the <code class="literal">idm_user</code> account the permission to run the <code class="literal">/usr/sbin/reboot</code> command on the <code class="literal">idmclient</code> host.
					</li><li class="listitem">
						You have configured smart card authentication for the <code class="literal">idmclient</code> host.
					</li><li class="listitem">
						You need <code class="literal">root</code> privileges to modify the <code class="literal">/etc/sssd/sssd.conf</code> file and PAM files in the <code class="literal">/etc/pam.d/</code> directory.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Open the <code class="literal">/etc/sssd/sssd.conf</code> configuration file.
					</li><li class="listitem"><p class="simpara">
						Add the following entries to the <code class="literal">[domain/<span class="emphasis"><em>&lt;domain_name&gt;</em></span>]</code> section.
					</p><pre class="literallayout">[domain/<span class="emphasis"><em>&lt;domain_name&gt;</em></span>]
<span class="strong strong"><strong>pam_gssapi_services = sudo, sudo-i</strong></span>
<span class="strong strong"><strong>pam_gssapi_indicators_map = sudo:pkinit, sudo-i:pkinit</strong></span></pre></li><li class="listitem">
						Save and close the <code class="literal">/etc/sssd/sssd.conf</code> file.
					</li><li class="listitem"><p class="simpara">
						Restart the SSSD service to load the configuration changes.
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>systemctl restart sssd</strong></span></pre></li><li class="listitem"><p class="simpara">
						On RHEL 9.2 or later:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Determine if you have selected the <code class="literal">sssd</code> <code class="literal">authselect</code> profile:
							</p><pre class="literallayout"># <span class="strong strong"><strong>authselect current</strong></span>
Profile ID: sssd</pre></li><li class="listitem"><p class="simpara">
								Optional: Select the <code class="literal">sssd</code> <code class="literal">authselect</code> profile:
							</p><pre class="literallayout"># <span class="strong strong"><strong>authselect select sssd</strong></span></pre></li><li class="listitem"><p class="simpara">
								Enable GSSAPI authentication:
							</p><pre class="literallayout"># <span class="strong strong"><strong>authselect enable-feature with-gssapi</strong></span></pre></li><li class="listitem"><p class="simpara">
								Configure the system to authenticate only users with smart cards:
							</p><pre class="literallayout"># <span class="strong strong"><strong>authselect with-smartcard-required</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						On RHEL 9.1 or earlier:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Open the <code class="literal">/etc/pam.d/sudo</code> PAM configuration file.
							</li><li class="listitem"><p class="simpara">
								Add the following entry as the first line of the <code class="literal">auth</code> section in the <code class="literal">/etc/pam.d/sudo</code> file.
							</p><pre class="literallayout">#%PAM-1.0
<span class="strong strong"><strong>auth sufficient pam_sss_gss.so</strong></span>
auth       include      system-auth
account    include      system-auth
password   include      system-auth
session    include      system-auth</pre></li><li class="listitem">
								Save and close the <code class="literal">/etc/pam.d/sudo</code> file.
							</li><li class="listitem">
								Open the <code class="literal">/etc/pam.d/sudo-i</code> PAM configuration file.
							</li><li class="listitem"><p class="simpara">
								Add the following entry as the first line of the <code class="literal">auth</code> section in the <code class="literal">/etc/pam.d/sudo-i</code> file.
							</p><pre class="literallayout">#%PAM-1.0
<span class="strong strong"><strong>auth sufficient pam_sss_gss.so</strong></span>
auth       include      sudo
account    include      sudo
password   include      sudo
session    optional     pam_keyinit.so force revoke
session    include      sudo</pre></li><li class="listitem">
								Save and close the <code class="literal">/etc/pam.d/sudo-i</code> file.
							</li></ol></div></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Log into the host as the <code class="literal">idm_user</code> account and authenticate with a smart card.
					</p><pre class="literallayout">[root@idmclient ~]# <span class="strong strong"><strong>ssh -l <span class="emphasis"><em>idm_user@idm.example.com</em></span> localhost</strong></span>
PIN for smart_card</pre></li><li class="listitem"><p class="simpara">
						Verify that you have a ticket-granting ticket as the smart card user.
					</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>klist</strong></span>
Ticket cache: KEYRING:persistent:1358900015:krb_cache_TObtNMd
Default principal: <span class="strong strong"><strong>idm_user@IDM.EXAMPLE.COM</strong></span>

Valid starting       Expires              Service principal
02/15/2021 16:29:48  02/16/2021 02:29:48  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM
	renew until 02/22/2021 16:29:44</pre></li><li class="listitem"><p class="simpara">
						Display which <code class="literal">sudo</code> rules the <code class="literal">idm_user</code> account is allowed to perform.
					</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo -l</strong></span>
Matching Defaults entries for <span class="strong strong"><strong>idmuser</strong></span> on <span class="strong strong"><strong>idmclient</strong></span>:
    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,
    env_reset, env_keep="COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS",
    env_keep+="MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE",
    env_keep+="LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES",
    env_keep+="LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE",
    env_keep+="LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME",
    secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin

User <span class="strong strong"><strong>idm_user</strong></span> may run the following commands on <span class="strong strong"><strong>idmclient</strong></span>:
    <span class="strong strong"><strong>(root) /usr/sbin/reboot</strong></span></pre></li><li class="listitem"><p class="simpara">
						Reboot the machine using <code class="literal">sudo</code>, without specifying a password.
					</p><pre class="literallayout">[idm_user@idmclient ~]$ <span class="strong strong"><strong>sudo /usr/sbin/reboot</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/granting-sudo-access-to-an-idm-user-on-an-idm-client_using-ansible-to-install-and-manage-identity-management#ref_sssd-options-controlling-gssapi-authentication-for-pam-services_granting-sudo-access-to-an-IdM-user-on-an-IdM-client">SSSD options controlling GSSAPI authentication for PAM services</a>
					</li><li class="listitem">
						The GSSAPI entry in the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/overview-of-identity-management-and-access-control-planning-identity-management#IdM_terminology_overview-of-idm-and-access-control">IdM terminology</a> listing
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication">Configuring Identity Management for smart card authentication</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-kerberos-ticket-policies_managing-users-groups-hosts#kerberos-authentication-indicators_managing-kerberos-ticket-policies">Kerberos authentication indicators</a>
					</li><li class="listitem">
						<a class="link" href="#using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" title="20.4. Granting sudo access to an IdM user on an IdM client using the IdM Web UI">Granting sudo access to an IdM user on an IdM client using IdM Web UI</a>
					</li><li class="listitem">
						<a class="link" href="#proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" title="20.2. Granting sudo access to an IdM user on an IdM client using the CLI">Granting sudo access to an IdM user on an IdM client using the CLI</a>.
					</li><li class="listitem">
						<code class="literal">pam_sss_gss (8)</code> and <code class="literal">sssd.conf (5)</code> man pages on your system
					</li></ul></div></section><section class="section" id="ref_sssd-options-controlling-gssapi-authentication-for-pam-services_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.9. SSSD options controlling GSSAPI authentication for PAM services</h3></div></div></div><p class="_abstract _abstract">
				You can use the following options for the <code class="literal">/etc/sssd/sssd.conf</code> configuration file to adjust the GSSAPI configuration within the SSSD service.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">pam_gssapi_services</span></dt><dd>
							GSSAPI authentication with SSSD is disabled by default. You can use this option to specify a comma-separated list of PAM services that are allowed to try GSSAPI authentication using the <code class="literal">pam_sss_gss.so</code> PAM module. To explicitly disable GSSAPI authentication, set this option to <code class="literal">-</code>.
						</dd><dt><span class="term">pam_gssapi_indicators_map</span></dt><dd><p class="simpara">
							This option only applies to Identity Management (IdM) domains. Use this option to list Kerberos authentication indicators that are required to grant PAM access to a service. Pairs must be in the format <code class="literal"><span class="emphasis"><em>&lt;PAM_service&gt;</em></span>:_&lt;required_authentication_indicator&gt;_</code>.
						</p><p class="simpara">
							Valid authentication indicators are:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									<code class="literal">otp</code> for two-factor authentication
								</li><li class="listitem">
									<code class="literal">radius</code> for RADIUS authentication
								</li><li class="listitem">
									<code class="literal">pkinit</code> for PKINIT, smart card, or certificate authentication
								</li><li class="listitem">
									<code class="literal">hardened</code> for hardened passwords
								</li></ul></div></dd><dt><span class="term">pam_gssapi_check_upn</span></dt><dd>
							This option is enabled and set to <code class="literal">true</code> by default. If this option is enabled, the SSSD service requires that the user name matches the Kerberos credentials. If <code class="literal">false</code>, the <code class="literal">pam_sss_gss.so</code> PAM module authenticates every user that is able to obtain the required service ticket.
						</dd></dl></div><div class="formalpara"><p class="title"><strong>Examples</strong></p><p>
					The following options enable Kerberos authentication for the <code class="literal">sudo</code> and <code class="literal">sudo-i</code> services, requires that <code class="literal">sudo</code> users authenticated with a one-time password, and user names must match the Kerberos principal. Because these settings are in the <code class="literal">[pam]</code> section, they apply to all domains:
				</p></div><pre class="literallayout">[pam]
<span class="strong strong"><strong>pam_gssapi_services</strong></span> = <span class="strong strong"><strong><span class="emphasis"><em>sudo</em></span>, <span class="emphasis"><em>sudo-i</em></span></strong></span>
<span class="strong strong"><strong>pam_gssapi_indicators_map</strong></span> = <span class="strong strong"><strong><span class="emphasis"><em>sudo:otp</em></span></strong></span>
<span class="strong strong"><strong>pam_gssapi_check_upn</strong></span> = <span class="strong strong"><strong><span class="emphasis"><em>true</em></span></strong></span></pre><p>
				You can also set these options in individual <code class="literal">[domain]</code> sections to overwrite any global values in the <code class="literal">[pam]</code> section. The following options apply different GSSAPI settings to each domain:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">For the <code class="literal">idm.example.com</code> domain</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Enable GSSAPI authentication for the <code class="literal">sudo</code> and <code class="literal">sudo -i</code> services.
								</li><li class="listitem">
									Require certificate or smart card authentication authenticators for the <code class="literal">sudo</code> command.
								</li><li class="listitem">
									Require one-time password authentication authenticators for the <code class="literal">sudo -i</code> command.
								</li><li class="listitem">
									Enforce matching user names and Kerberos principals.
								</li></ul></div></dd><dt><span class="term">For the <code class="literal">ad.example.com</code> domain</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									Enable GSSAPI authentication only for the <code class="literal">sudo</code> service.
								</li><li class="listitem">
									Do not enforce matching user names and principals.
								</li></ul></div></dd></dl></div><pre class="literallayout">[domain/<span class="strong strong"><strong><span class="emphasis"><em>idm.example.com</em></span></strong></span>]
pam_gssapi_services = <span class="strong strong"><strong>sudo, sudo-i</strong></span>
pam_gssapi_indicators_map = <span class="strong strong"><strong><span class="emphasis"><em>sudo:pkinit</em></span></strong></span>, <span class="strong strong"><strong><span class="emphasis"><em>sudo-i:otp</em></span></strong></span>
pam_gssapi_check_upn = <span class="strong strong"><strong>true</strong></span>
...

[domain/<span class="strong strong"><strong><span class="emphasis"><em>ad.example.com</em></span></strong></span>]
pam_gssapi_services = <span class="strong strong"><strong>sudo</strong></span>
pam_gssapi_check_upn = <span class="strong strong"><strong>false</strong></span>
...</pre><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-kerberos-ticket-policies_managing-users-groups-hosts#kerberos-authentication-indicators_managing-kerberos-ticket-policies">Kerberos authentication indicators</a>
					</li></ul></div></section><section class="section" id="proc_troubleshooting-gssapi-authentication-for-sudo_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.10. Troubleshooting GSSAPI authentication for sudo</h3></div></div></div><p class="_abstract _abstract">
				If you are unable to authenticate to the <code class="literal">sudo</code> service with a Kerberos ticket from IdM, use the following scenarios to troubleshoot your configuration.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have enabled GSSAPI authentication for the <code class="literal">sudo</code> service. See <a class="link" href="#proc_enabling-gssapi-authentication-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" title="20.7. Enabling GSSAPI authentication for sudo on an IdM client">Enabling GSSAPI authentication for sudo on an IdM client</a>.
					</li><li class="listitem">
						You need <code class="literal">root</code> privileges to modify the <code class="literal">/etc/sssd/sssd.conf</code> file and PAM files in the <code class="literal">/etc/pam.d/</code> directory.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						If you see the following error, the Kerberos service might not able to resolve the correct realm for the service ticket based on the host name:
					</p><pre class="literallayout">Server not found in Kerberos database</pre><p class="simpara">
						In this situation, add the hostname directly to <code class="literal">[domain_realm]</code> section in the <code class="literal">/etc/krb5.conf</code> Kerberos configuration file:
					</p><pre class="literallayout">[idm-user@idm-client ~]$ cat /etc/krb5.conf
...

[domain_realm]
 .example.com = EXAMPLE.COM
 example.com = EXAMPLE.COM
 <span class="strong strong"><strong>server.example.com = EXAMPLE.COM</strong></span></pre></li><li class="listitem"><p class="simpara">
						If you see the following error, you do not have any Kerberos credentials:
					</p><pre class="literallayout">No Kerberos credentials available</pre><p class="simpara">
						In this situation, retrieve Kerberos credentials with the <code class="literal">kinit</code> utility or authenticate with SSSD:
					</p><pre class="literallayout">[idm-user@idm-client ~]$ <span class="strong strong"><strong>kinit idm-user@IDM.EXAMPLE.COM</strong></span>
Password for <span class="strong strong"><strong>idm-user@idm.example.com</strong></span>:</pre></li><li class="listitem"><p class="simpara">
						If you see either of the following errors in the <code class="literal">/var/log/sssd/sssd_pam.log</code> log file, the Kerberos credentials do not match the username of the user currently logged in:
					</p><pre class="literallayout">User with UPN [<span class="emphasis"><em>&lt;UPN&gt;</em></span>] was not found.

UPN [<span class="emphasis"><em>&lt;UPN&gt;</em></span>] does not match target user [<span class="emphasis"><em>&lt;username&gt;</em></span>].</pre><p class="simpara">
						In this situation, verify that you authenticated with SSSD, or consider disabling the <code class="literal">pam_gssapi_check_upn</code> option in the <code class="literal">/etc/sssd/sssd.conf</code> file:
					</p><pre class="literallayout">[idm-user@idm-client ~]$ cat /etc/sssd/sssd.conf
...

<span class="strong strong"><strong>pam_gssapi_check_upn = false</strong></span></pre></li><li class="listitem"><p class="simpara">
						For additional troubleshooting, you can enable debugging output for the <code class="literal">pam_sss_gss.so</code> PAM module.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p class="simpara">
								Add the <code class="literal">debug</code> option at the end of all <code class="literal">pam_sss_gss.so</code> entries in PAM files, such as <code class="literal">/etc/pam.d/sudo</code> and <code class="literal">/etc/pam.d/sudo-i</code>:
							</p><pre class="literallayout">[root@idm-client ~]# cat /etc/pam.d/sudo
#%PAM-1.0
auth       sufficient   pam_sss_gss.so   <span class="strong strong"><strong>debug</strong></span>
auth       include      system-auth
account    include      system-auth
password   include      system-auth
session    include      system-auth</pre><pre class="literallayout">[root@idm-client ~]# cat /etc/pam.d/sudo-i
#%PAM-1.0
auth       sufficient   pam_sss_gss.so   <span class="strong strong"><strong>debug</strong></span>
auth       include      sudo
account    include      sudo
password   include      sudo
session    optional     pam_keyinit.so force revoke
session    include      sudo</pre></li><li class="listitem"><p class="simpara">
								Try to authenticate with the <code class="literal">pam_sss_gss.so</code> module and review the console output. In this example, the user did not have any Kerberos credentials.
							</p><pre class="literallayout">[idm-user@idm-client ~]$ sudo ls -l /etc/sssd/sssd.conf
pam_sss_gss: Initializing GSSAPI authentication with SSSD
pam_sss_gss: Switching euid from 0 to 1366201107
pam_sss_gss: Trying to establish security context
pam_sss_gss: SSSD User name: idm-user@idm.example.com
pam_sss_gss: User domain: idm.example.com
pam_sss_gss: User principal:
pam_sss_gss: Target name: host@idm.example.com
pam_sss_gss: Using ccache: KCM:
pam_sss_gss: Acquiring credentials, principal name will be derived
pam_sss_gss: Unable to read credentials from [KCM:] [maj:0xd0000, min:0x96c73ac3]
pam_sss_gss: GSSAPI: Unspecified GSS failure.  Minor code may provide more information
pam_sss_gss: <span class="strong strong"><strong>GSSAPI: No credentials cache found</strong></span>
pam_sss_gss: Switching euid from 1366200907 to 0
pam_sss_gss: <span class="strong strong"><strong>System error [5]: Input/output error</strong></span></pre></li></ul></div></li></ul></div></section><section class="section" id="using-an-Ansible-playbook-to-ensure-sudo-access-for-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client"><div class="titlepage"><div><div><h3 class="title">20.11. Using an Ansible playbook to ensure sudo access for an IdM user on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				In Identity Management (IdM), you can ensure <code class="literal">sudo</code> access to a specific command is granted to an IdM user account on a specific IdM host.
			</p><p>
				Complete this procedure to ensure a <code class="literal">sudo</code> rule named <span class="strong strong"><strong>idm_user_reboot</strong></span> exists. The rule grants <span class="strong strong"><strong>idm_user</strong></span> the permission to run the <code class="literal">/usr/sbin/reboot</code> command on the <span class="strong strong"><strong>idmclient</strong></span> machine.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You have <a class="link" href="#ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks" title="7.2. Ensuring the presence of an IdM user using an Ansible playbook">ensured the presence of a user account for <span class="strong strong"><strong>idm_user</strong></span> in IdM and unlocked the account by creating a password for the user</a>. For details on adding a new IdM user using the command-line interface, see link: <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line">Adding users using the command line</a>.
					</li><li class="listitem">
						No local <span class="strong strong"><strong>idm_user</strong></span> account exists on <span class="strong strong"><strong>idmclient</strong></span>. The <span class="strong strong"><strong>idm_user</strong></span> user is not listed in the <code class="literal">/etc/passwd</code> file on <span class="strong strong"><strong>idmclient</strong></span>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaservers</code> in it:
					</p><pre class="literallayout">[ipaservers]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Add one or more <code class="literal">sudo</code> commands:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create an <code class="literal">ensure-reboot-sudocmd-is-present.yml</code> Ansible playbook that ensures the presence of the <code class="literal">/usr/sbin/reboot</code> command in the IdM database of <code class="literal">sudo</code> commands. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/sudocmd/ensure-sudocmd-is-present.yml</code> file:
							</p><pre class="literallayout">---
- name: Playbook to manage sudo command
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure sudo command is present
  - ipasudocmd:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: /usr/sbin/reboot
      state: present</pre></li><li class="listitem"><p class="simpara">
								Run the playbook:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file path_to_playbooks_directory</em></span>/ensure-reboot-sudocmd-is-present.yml</strong></span></pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Create a <code class="literal">sudo</code> rule that references the commands:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create an <code class="literal">ensure-sudorule-for-idmuser-on-idmclient-is-present.yml</code> Ansible playbook that uses the <code class="literal">sudo</code> command entry to ensure the presence of a sudo rule. The sudo rule allows <span class="strong strong"><strong>idm_user</strong></span> to reboot the <span class="strong strong"><strong>idmclient</strong></span> machine. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/sudorule/ensure-sudorule-is-present.yml</code> file:
							</p><pre class="literallayout">---
- name: Tests
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure a sudorule is present granting idm_user the permission to run /usr/sbin/reboot on idmclient
  - ipasudorule:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: idm_user_reboot
      description: A test sudo rule.
      allow_sudocmd: /usr/sbin/reboot
      host: idmclient.idm.example.com
      user: idm_user
      state: present</pre></li><li class="listitem"><p class="simpara">
								Run the playbook:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file path_to_playbooks_directory</em></span>/ensure-sudorule-for-idmuser-on-idmclient-is-present.yml</strong></span></pre></li></ol></div></li></ol></div><div class="formalpara"><p class="title"><strong>Verification</strong></p><p>
					Test that the <code class="literal">sudo</code> rule whose presence you have ensured on the IdM server works on <span class="strong strong"><strong>idmclient</strong></span> by verifying that <span class="strong strong"><strong>idm_user</strong></span> can reboot <span class="strong strong"><strong>idmclient</strong></span> using <code class="literal">sudo</code>. Note that it can take a few minutes for the changes made on the server to take effect on the client.
				</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Log in to <span class="strong strong"><strong>idmclient</strong></span> as <span class="strong strong"><strong>idm_user</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Reboot the machine using <code class="literal">sudo</code>. Enter the password for <span class="strong strong"><strong>idm_user</strong></span> when prompted:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>sudo /usr/sbin/reboot</strong></span>
[sudo] password for idm_user:</pre></li></ol></div><p>
				If <code class="literal">sudo</code> is configured correctly, the machine reboots.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-sudocmd.md</code>, <code class="literal">README-sudocmdgroup.md</code>, and <code class="literal">README-sudorule.md</code> files in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li></ul></div></section></section><section class="chapter" id="ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 21. Ensuring the presence of host-based access control rules in IdM using Ansible playbooks</h2></div></div></div><p class="_abstract _abstract">
			Ansible is an automation tool used to configure systems, deploy software, and perform rolling updates. It includes support for Identity Management (IdM).
		</p><p>
			Learn more about Identity Management (IdM) host-based access policies and how to define them using <a class="link" href="https://docs.ansible.com">Ansible</a>.
		</p><section class="section" id="host-based-access-control-rules-in-idm_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">21.1. Host-based access control rules in IdM</h3></div></div></div><p class="_abstract _abstract">
				Host-based access control (HBAC) rules define which users or user groups can access which hosts or host groups by using which services or services in a service group. As a system administrator, you can use HBAC rules to achieve the following goals:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Limit access to a specified system in your domain to members of a specific user group.
					</li><li class="listitem">
						Allow only a specific service to be used to access systems in your domain.
					</li></ul></div><p>
				By default, IdM is configured with a default HBAC rule named <span class="strong strong"><strong>allow_all</strong></span>, which means universal access to every host for every user via every relevant service in the entire IdM domain.
			</p><p>
				You can fine-tune access to different hosts by replacing the default <span class="strong strong"><strong>allow_all</strong></span> rule with your own set of HBAC rules. For centralized and simplified access control management, you can apply HBAC rules to user groups, host groups, or service groups instead of individual users, hosts, or services.
			</p></section><section class="section" id="ensuring-the-presence-of-an-hbac-rule-in-idm-using-an-ansible-playbook_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">21.2. Ensuring the presence of an HBAC rule in IdM using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the presence of a host-based access control (HBAC) rule in Identity Management (IdM) using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The users and user groups you want to use for your HBAC rule exist in IdM. See <a class="link" href="#managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" title="Chapter 7. Managing user accounts using Ansible playbooks">Managing user accounts using Ansible playbooks</a> and <a class="link" href="#ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks" title="8.3. Ensuring the presence of IdM groups and group members using Ansible playbooks">Ensuring the presence of IdM groups and group members using Ansible playbooks</a> for details.
					</li><li class="listitem">
						The hosts and host groups to which you want to apply your HBAC rule exist in IdM. See <a class="link" href="#managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" title="Chapter 17. Managing hosts using Ansible playbooks">Managing hosts using Ansible playbooks</a> and <a class="link" href="#managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management" title="Chapter 18. Managing host groups using Ansible playbooks">Managing host groups using Ansible playbooks</a> for details.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>, and define <code class="literal">ipaserver</code> in it:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Create your Ansible playbook file that defines the HBAC policy whose presence you want to ensure. To simplify this step, you can copy and modify the example in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/hbacrule/ensure-hbacrule-allhosts-present.yml</code> file:
					</p><pre class="literallayout">---
- name: Playbook to handle hbacrules
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure idm_user can access client.idm.example.com via the sshd service
  - ipahbacrule:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: login
      user: idm_user
      host: client.idm.example.com
      hbacsvc:
      - sshd
      state: present</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory/ensure-new-hbacrule-present.yml</em></span></strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log in to the IdM Web UI as administrator.
					</li><li class="listitem">
						Navigate to <span class="strong strong"><strong>Policy</strong></span> → <span class="strong strong"><strong>Host-Based-Access-Control</strong></span> → <span class="strong strong"><strong>HBAC Test</strong></span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Who</strong></span> tab, select idm_user.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Accessing</strong></span> tab, select <span class="strong strong"><strong>client.idm.example.com</strong></span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Via service</strong></span> tab, select <span class="strong strong"><strong>sshd</strong></span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Rules</strong></span> tab, select <span class="strong strong"><strong>login</strong></span>.
					</li><li class="listitem">
						In the <span class="strong strong"><strong>Run test</strong></span> tab, click the <span class="strong strong"><strong>Run test</strong></span> button. If you see ACCESS GRANTED, the HBAC rule is implemented successfully.
					</li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-hbacsvc.md</code>, <code class="literal">README-hbacsvcgroup.md</code>, and <code class="literal">README-hbacrule.md</code> files in the <code class="literal">/usr/share/doc/ansible-freeipa</code> directory.
					</li><li class="listitem">
						See the playbooks in the subdirectories of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks</code> directory.
					</li></ul></div></section></section><section class="chapter" id="managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 22. Managing IdM certificates using Ansible</h2></div></div></div><p>
			You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to request, revoke, and retrieve SSL certificates for Identity Management (IdM) users, hosts and services. You can also restore a certificate that has been put on hold.
		</p><section class="section" id="using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible"><div class="titlepage"><div><div><h3 class="title">22.1. Using Ansible to request SSL certificates for IdM hosts, services and users</h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to request SSL certificates for Identity Management (IdM) users, hosts and services. They can then use these certificates to authenticate to IdM.
			</p><p>
				Complete this procedure to request a certificate for an HTTP server from an IdM certificate authority (CA) using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						Your IdM deployment has an integrated CA.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Generate a certificate-signing request (CSR) for your user, host or service. For example, to use the <code class="literal">openssl</code> utility to generate a CSR for the <code class="literal">HTTP</code> service running on client.idm.example.com, enter:
					</p><pre class="literallayout"># <span class="strong strong"><strong>openssl req -new -newkey rsa:2048 -days 365 -nodes -keyout new.key -out new.csr -subj '/CN=client.idm.example.com,O=IDM.EXAMPLE.COM'</strong></span></pre><p class="simpara">
						As a result, the CSR is stored in <span class="strong strong"><strong>new.csr</strong></span>.
					</p></li><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>request-certificate.yml</strong></span> with the following content:
					</p><pre class="screen">---
- name: Playbook to request a certificate
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Request a certificate for a web server
    ipacert:
      ipaadmin_password: "{{ ipaadmin_password }}"
      state: requested
      csr: |
        -----BEGIN CERTIFICATE REQUEST-----
        MIGYMEwCAQAwGTEXMBUGA1UEAwwOZnJlZWlwYSBydWxlcyEwKjAFBgMrZXADIQBs
        HlqIr4b/XNK+K8QLJKIzfvuNK0buBhLz3LAzY7QDEqAAMAUGAytlcANBAF4oSCbA
        5aIPukCidnZJdr491G4LBE+URecYXsPknwYb+V+ONnf5ycZHyaFv+jkUBFGFeDgU
        SYaXm/gF8cDYjQI=
        -----END CERTIFICATE REQUEST-----
      principal: HTTP/client.idm.example.com
    register: cert</pre><p class="simpara">
						Replace the certificate request with the CSR from <span class="strong strong"><strong>new.csr</strong></span>.
					</p></li><li class="listitem"><p class="simpara">
						Request the certificate:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/request-certificate.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md">The cert module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li></ul></div></section><section class="section" id="using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible"><div class="titlepage"><div><div><h3 class="title">22.2. Using Ansible to revoke SSL certificates for IdM hosts, services and users</h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to revoke SSL certificates used by Identity Management (IdM) users, hosts and services to authenticate to IdM.
			</p><p>
				Complete this procedure to revoke a certificate for an HTTP server using an Ansible playbook. The reason for revoking the certificate is “keyCompromise”.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li><li class="listitem">
								You have obtained the serial number of the certificate, for example by entering the <code class="literal">openssl x509 -noout -text -in &lt;path_to_certificate&gt;</code> command. In this example, the serial number of the certificate is 123456789.
							</li></ul></div></li><li class="listitem">
						Your IdM deployment has an integrated CA.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>revoke-certificate.yml</strong></span> with the following content:
					</p><pre class="screen">---
- name: Playbook to revoke a certificate
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Revoke a certificate for a web server
    ipacert:
      ipaadmin_password: "{{ ipaadmin_password }}"
      serial_number: 123456789
      revocation_reason: "keyCompromise"
      state: revoked</pre></li><li class="listitem"><p class="simpara">
						Revoke the certificate:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/revoke-certificate.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md">The cert module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li><li class="listitem">
						<a class="link" href="https://datatracker.ietf.org/doc/html/rfc5280#section-5.3.1">Reason Code</a> in RFC 5280
					</li></ul></div></section><section class="section" id="using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible"><div class="titlepage"><div><div><h3 class="title">22.3. Using Ansible to restore SSL certificates for IdM users, hosts, and services</h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to restore a revoked SSL certificate previously used by an Identity Management (IdM) user, host or a service to authenticate to IdM.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You can only restore a certificate that was put on hold. You may have put it on hold because, for example, you were not sure if the private key had been lost. However, now you have recovered the key and as you are certain that no-one has accessed it in the meantime, you want to reinstate the certificate.
				</p></div></rh-alert><p>
				Complete this procedure to use an Ansible playbook to release a certificate for a service enrolled into IdM from hold. This example describes how to release a certificate for an HTTP service from hold.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						Your IdM deployment has an integrated CA.
					</li><li class="listitem">
						You have obtained the serial number of the certificate, for example by entering the <code class="literal">openssl x509 -noout -text -in path/to/certificate</code> command. In this example, the certificate serial number is <span class="strong strong"><strong>123456789</strong></span>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>restore-certificate.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to restore a certificate
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Restore a certificate for a web service
    ipacert:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>serial_number: 123456789</strong></span>
      <span class="strong strong"><strong>state: released</strong></span></pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/restore-certificate.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md">The cert module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li></ul></div></section><section class="section" id="using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible"><div class="titlepage"><div><div><h3 class="title">22.4. Using Ansible to retrieve SSL certificates for IdM users, hosts, and services</h3></div></div></div><p>
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipacert</code> module to retrieve an SSL certificate issued for an Identity Management (IdM) user, host or a service, and store it in a file on the managed node.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						You have obtained the serial number of the certificate, for example by entering the <code class="literal">openssl x509 -noout -text -in &lt;path_to_certificate&gt;</code> command. In this example, the serial number of the certificate is 123456789, and the file in which you store the retrieved certificate is <span class="strong strong"><strong>cert.pem</strong></span>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>retrieve-certificate.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to retrieve a certificate and store it locally on the managed node
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Retrieve a certificate and save it to file 'cert.pem'
    ipacert:
      ipaadmin_password: "{{ ipaadmin_password }}"
      serial_number: 123456789
      certificate_out: cert.pem
      state: retrieved</pre></li><li class="listitem"><p class="simpara">
						Retrieve the certificate:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/retrieve-certificate.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md">The cert module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li></ul></div></section></section><section class="chapter" id="vaults-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 23. Vaults in IdM</h2></div></div></div><p class="_abstract _abstract">
			This chapter describes vaults in Identity Management (IdM). It introduces the following topics:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#vaults-and-their-benefits_vaults-in-idm" title="23.1. Vaults and their benefits">The concept of the vault</a>.
				</li><li class="listitem">
					<a class="link" href="#vault-owners-members-and-administrators_vaults-in-idm" title="23.2. Vault owners, members, and administrators">The different roles associated with a vault</a>.
				</li><li class="listitem">
					<a class="link" href="#standard-symmetric-and-asymmetric-vaults_vaults-in-idm" title="23.3. Standard, symmetric, and asymmetric vaults">The different types of vaults available in IdM based on the level of security and access control</a>.
				</li><li class="listitem">
					<a class="link" href="#user-service-and-shared-vaults_vaults-in-idm" title="23.4. User, service, and shared vaults">The different types of vaults available in IdM based on ownership</a>.
				</li><li class="listitem">
					<a class="link" href="#vault-containers_vaults-in-idm" title="23.5. Vault containers">The concept of vault containers</a>.
				</li><li class="listitem">
					<a class="link" href="#basic-idm-vault-commands_vaults-in-idm" title="23.6. Basic IdM vault commands">The basic commands for managing vaults in IdM</a>.
				</li><li class="listitem">
					<a class="link" href="#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm" title="23.7. Installing the Key Recovery Authority in IdM">Installing the key recovery authority (KRA), which is a prerequisite for using vaults in IdM</a>.
				</li></ul></div><section class="section" id="vaults-and-their-benefits_vaults-in-idm"><div class="titlepage"><div><div><h3 class="title">23.1. Vaults and their benefits</h3></div></div></div><p class="_abstract _abstract">
				A vault is a useful feature for those Identity Management (IdM) users who want to keep all their sensitive data stored securely but conveniently in one place. There are various types of vaults and you should choose which vault to use based on your requirements.
			</p><p>
				A vault is a secure location in (IdM) for storing, retrieving, sharing, and recovering a secret. A secret is security-sensitive data, usually authentication credentials, that only a limited group of people or entities can access. For example, secrets include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Passwords
					</li><li class="listitem">
						PINs
					</li><li class="listitem">
						Private SSH keys
					</li></ul></div><p>
				A vault is comparable to a password manager. Just like a password manager, a vault typically requires a user to generate and remember one primary password to unlock and access any information stored in the vault. However, a user can also decide to have a standard vault. A standard vault does not require the user to enter any password to access the secrets stored in the vault.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					The purpose of vaults in IdM is to store authentication credentials that allow you to authenticate to external, non-IdM-related services.
				</p></div></rh-alert><p>
				Other important characteristics of the IdM vaults are:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Vaults are only accessible to the vault owner and those IdM users that the vault owner selects to be the vault members. In addition, the IdM administrator has access to the vault.
					</li><li class="listitem">
						If a user does not have sufficient privileges to create a vault, an IdM administrator can create the vault and set the user as its owner.
					</li><li class="listitem">
						Users and services can access the secrets stored in a vault from any machine enrolled in the IdM domain.
					</li><li class="listitem">
						One vault can only contain one secret, for example, one file. However, the file itself can contain multiple secrets such as passwords, keytabs or certificates.
					</li></ul></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Vault is only available from the IdM command line (CLI), not from the IdM Web UI.
				</p></div></rh-alert></section><section class="section" id="vault-owners-members-and-administrators_vaults-in-idm"><div class="titlepage"><div><div><h3 class="title">23.2. Vault owners, members, and administrators</h3></div></div></div><p class="_abstract _abstract">
				Identity Management (IdM) distinguishes the following vault user types:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Vault owner</span></dt><dd><p class="simpara">
							A vault owner is a user or service with basic management privileges on the vault. For example, a vault owner can modify the properties of the vault or add new vault members.
						</p><p class="simpara">
							Each vault must have at least one owner. A vault can also have multiple owners.
						</p></dd><dt><span class="term">Vault member</span></dt><dd>
							A vault member is a user or service that can access a vault created by another user or service.
						</dd><dt><span class="term">Vault administrator</span></dt><dd><p class="simpara">
							Vault administrators have unrestricted access to all vaults and are allowed to perform all vault operations.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								Symmetric and asymmetric vaults are protected with a password or key and apply special access control rules (see <a class="link" href="#standard-symmetric-and-asymmetric-vaults_vaults-in-idm" title="23.3. Standard, symmetric, and asymmetric vaults">Vault types</a>). The administrator must meet these rules to:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
										Access secrets in symmetric and asymmetric vaults.
									</li><li class="listitem">
										Change or reset the vault password or key.
									</li></ul></div></div></rh-alert><p class="simpara">
							A vault administrator is any user with the <code class="literal">Vault Administrators</code> privilege. In the context of the role-based access control (RBAC) in IdM, a privilege is a group of permissions that you can apply to a role.
						</p></dd><dt><span class="term">Vault User</span></dt><dd><p class="simpara">
							The vault user represents the user in whose container the vault is located. The <code class="literal">Vault user</code> information is displayed in the output of specific commands, such as <code class="literal command">ipa vault-show</code>:
						</p><pre class="literallayout">$ ipa vault-show my_vault
  Vault name: my_vault
  Type: standard
  Owner users: user
  <span class="emphasis"><em>Vault user: user</em></span></pre><p class="simpara">
							For details on vault containers and user vaults, see <a class="link" href="#vault-containers_vaults-in-idm" title="23.5. Vault containers">Vault containers</a>.
						</p></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="#standard-symmetric-and-asymmetric-vaults_vaults-in-idm" title="23.3. Standard, symmetric, and asymmetric vaults">Standard, symmetric and asymmetric vaults</a> for details on vault types.
					</li></ul></div></section><section class="section" id="standard-symmetric-and-asymmetric-vaults_vaults-in-idm"><div class="titlepage"><div><div><h3 class="title">23.3. Standard, symmetric, and asymmetric vaults</h3></div></div></div><p class="_abstract _abstract">
				Based on the level of security and access control, IdM classifies vaults into the following types:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Standard vaults</span></dt><dd>
							Vault owners and vault members can archive and retrieve the secrets without having to use a password or key.
						</dd><dt><span class="term">Symmetric vaults</span></dt><dd>
							Secrets in the vault are protected with a symmetric key. Vault owners and members can archive and retrieve the secrets, but they must provide the vault password.
						</dd><dt><span class="term">Asymmetric vaults</span></dt><dd>
							Secrets in the vault are protected with an asymmetric key. Users archive the secret using a public key and retrieve it using a private key. Vault members can only archive secrets, while vault owners can do both, archive and retrieve secrets.
						</dd></dl></div></section><section class="section" id="user-service-and-shared-vaults_vaults-in-idm"><div class="titlepage"><div><div><h3 class="title">23.4. User, service, and shared vaults</h3></div></div></div><p class="_abstract _abstract">
				Based on ownership, IdM classifies vaults into several types. The <a class="link" href="#tab-idm-vaults-based-on-ownership_vaults-in-idm" title="Table 23.1. IdM vaults based on ownership">table below</a> contains information about each type, its owner and use.
			</p><rh-table id="tab-idm-vaults-based-on-ownership_vaults-in-idm"><table class="gt-4-cols lt-7-rows"><caption>Table 23.1. IdM vaults based on ownership</caption><colgroup><col style="width: 13%; " class="col_1"><!--Empty--><col style="width: 25%; " class="col_2"><!--Empty--><col style="width: 25%; " class="col_3"><!--Empty--><col style="width: 38%; " class="col_4"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464215843296" scope="col">Type</th><th align="left" valign="top" id="idm140464215842208" scope="col">Description</th><th align="left" valign="top" id="idm140464215841120" scope="col">Owner</th><th align="left" valign="top" id="idm140464212775632" scope="col">Note</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464215843296"> <p>
								<span class="strong strong"><strong>User vault</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464215842208"> <p>
								A private vault for a user
							</p>
							 </td><td align="left" valign="top" headers="idm140464215841120"> <p>
								A single user
							</p>
							 </td><td align="left" valign="top" headers="idm140464212775632"> <p>
								Any user can own one or more user vaults if allowed by IdM administrator
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464215843296"> <p>
								<span class="strong strong"><strong>Service vault</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464215842208"> <p>
								A private vault for a service
							</p>
							 </td><td align="left" valign="top" headers="idm140464215841120"> <p>
								A single service
							</p>
							 </td><td align="left" valign="top" headers="idm140464212775632"> <p>
								Any service can own one or more user vaults if allowed by IdM administrator
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464215843296"> <p>
								<span class="strong strong"><strong>Shared vault</strong></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464215842208"> <p>
								A vault shared by multiple users and services
							</p>
							 </td><td align="left" valign="top" headers="idm140464215841120"> <p>
								The vault administrator who created the vault
							</p>
							 </td><td align="left" valign="top" headers="idm140464212775632"> <p>
								Users and services can own one or more user vaults if allowed by IdM administrator. The vault administrators other than the one that created the vault also have full access to the vault.
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="vault-containers_vaults-in-idm"><div class="titlepage"><div><div><h3 class="title">23.5. Vault containers</h3></div></div></div><p class="_abstract _abstract">
				A vault container is a collection of vaults. The <a class="link" href="#tab-default-vault-containers-in-idm_vaults-in-idm" title="Table 23.2. Default vault containers in IdM">table below</a> lists the default vault containers that Identity Management (IdM) provides.
			</p><rh-table id="tab-default-vault-containers-in-idm_vaults-in-idm"><table class="lt-4-cols lt-7-rows"><caption>Table 23.2. Default vault containers in IdM</caption><colgroup><col style="width: 25%; " class="col_1"><!--Empty--><col style="width: 25%; " class="col_2"><!--Empty--><col style="width: 50%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464212740672" scope="col">Type</th><th align="left" valign="top" id="idm140464212739584" scope="col">Description</th><th align="left" valign="top" id="idm140464212738496" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464212740672"> <p>
								User container
							</p>
							 </td><td align="left" valign="top" headers="idm140464212739584"> <p>
								A private container for a user
							</p>
							 </td><td align="left" valign="top" headers="idm140464212738496"> <p>
								Stores user vaults for a particular user
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464212740672"> <p>
								Service container
							</p>
							 </td><td align="left" valign="top" headers="idm140464212739584"> <p>
								A private container for a service
							</p>
							 </td><td align="left" valign="top" headers="idm140464212738496"> <p>
								Stores service vaults for a particular service
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464212740672"> <p>
								Shared container
							</p>
							 </td><td align="left" valign="top" headers="idm140464212739584"> <p>
								A container for multiple users and services
							</p>
							 </td><td align="left" valign="top" headers="idm140464212738496"> <p>
								Stores vaults that can be shared by multiple users or services
							</p>
							 </td></tr></tbody></table></rh-table><p>
				IdM creates user and service containers for each user or service automatically when the first private vault for the user or service is created. After the user or service is deleted, IdM removes the container and its contents.
			</p></section><section class="section" id="basic-idm-vault-commands_vaults-in-idm"><div class="titlepage"><div><div><h3 class="title">23.6. Basic IdM vault commands</h3></div></div></div><p class="_abstract _abstract">
				You can use the basic commands outlined below to manage Identity Management (IdM) vaults. The <a class="link" href="#tab-basic-idm-vault-commands-with-explanations_vaults-in-idm" title="Table 23.3. Basic IdM vault commands with explanations">table below</a> contains a list of <code class="literal">ipa vault-*</code> commands with the explanation of their purpose.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					Before running any <code class="literal">ipa vault-*</code> command, install the Key Recovery Authority (KRA) certificate system component on one or more of the servers in your IdM domain. For details, see <a class="link" href="#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm" title="23.7. Installing the Key Recovery Authority in IdM">Installing the Key Recovery Authority in IdM</a>.
				</p></div></rh-alert><rh-table id="tab-basic-idm-vault-commands-with-explanations_vaults-in-idm"><table class="lt-4-cols lt-7-rows"><caption>Table 23.3. Basic IdM vault commands with explanations</caption><colgroup><col style="width: 25%; " class="col_1"><!--Empty--><col style="width: 75%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464215079680" scope="col">Command</th><th align="left" valign="top" id="idm140464215078592" scope="col">Purpose</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464215079680"> <p>
								<code class="literal">ipa help vault</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464215078592"> <p>
								Displays conceptual information about IdM vaults and sample vault commands.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464215079680"> <p>
								<code class="literal">ipa vault-add --help</code>, <code class="literal">ipa vault-find --help</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464215078592"> <p>
								Adding the <code class="literal">--help</code> option to a specific <code class="literal">ipa vault-*</code> command displays the options and detailed help available for that command.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464215079680"> <p>
								<code class="literal">ipa vault-show user_vault --user idm_user</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464215078592"> <p>
								When accessing a vault as a vault member, you must specify the vault owner. If you do not specify the vault owner, IdM informs you that it did not find the vault:
							</p>

<pre class="literallayout">[admin@server ~]$ ipa vault-show user_vault
ipa: ERROR: user_vault: vault not found</pre>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464215079680"> <p>
								<code class="literal">ipa vault-show shared_vault --shared</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464215078592"> <p>
								When accessing a shared vault, you must specify that the vault you want to access is a shared vault. Otherwise, IdM informs you it did not find the vault:
							</p>

<pre class="literallayout">[admin@server ~]$ ipa vault-show shared_vault
ipa: ERROR: shared_vault: vault not found</pre>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="installing-the-key-recovery-authority-component-in-idm_vaults-in-idm"><div class="titlepage"><div><div><h3 class="title">23.7. Installing the Key Recovery Authority in IdM</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to enable vaults in Identity Management (IdM) by installing the Key Recovery Authority (KRA) Certificate System (CS) component on a specific IdM server.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as <code class="literal">root</code> on the IdM server.
					</li><li class="listitem">
						An IdM certificate authority is installed on the IdM server.
					</li><li class="listitem">
						You have the <code class="literal">Directory Manager</code> credentials.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Install the KRA:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-kra-install</strong></span></pre></li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					You can install the first KRA of an IdM cluster on a hidden replica. However, installing additional KRAs requires temporarily activating the hidden replica before you install the KRA clone on a non-hidden replica. Then you can hide the originally hidden replica again.
				</p></div></rh-alert><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					To make the vault service highly available and resilient, install the KRA on two IdM servers or more. Maintaining multiple KRA servers prevents data loss.
				</p></div></rh-alert><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/demoting-or-promoting-hidden-replicas_configuring-and-managing-idm">Demoting or promoting hidden replicas</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#the-hidden-replica-mode_planning-the-replica-topology">The hidden replica mode</a>
					</li></ul></div></section></section><section class="chapter" id="using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 24. Using Ansible to manage IdM user vaults: storing and retrieving secrets</h2></div></div></div><p class="_abstract _abstract">
			This chapter describes how to manage user vaults in Identity Management using the Ansible <code class="literal">vault</code> module. Specifically, it describes how a user can use Ansible playbooks to perform the following three consecutive actions:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" title="24.1. Ensuring the presence of a standard user vault in IdM using Ansible">Create a user vault in IdM</a>.
				</li><li class="listitem">
					<a class="link" href="#archiving-a-secret-in-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" title="24.2. Archiving a secret in a standard user vault in IdM using Ansible">Store a secret in the vault</a>.
				</li><li class="listitem">
					<a class="link" href="#retrieving-a-secret-from-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets" title="24.3. Retrieving a secret from a standard user vault in IdM using Ansible">Retrieve a secret from the vault</a>.
				</li></ul></div><p>
			The user can do the storing and the retrieving from two different IdM clients.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Key Recovery Authority (KRA) Certificate System component has been installed on one or more of the servers in your IdM domain. For details, see <a class="link" href="#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm" title="23.7. Installing the Key Recovery Authority in IdM">Installing the Key Recovery Authority in IdM</a>.
				</li></ul></div><section class="section" id="ensuring-the-presence-of-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets"><div class="titlepage"><div><div><h3 class="title">24.1. Ensuring the presence of a standard user vault in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to create a vault container with one or more private vaults to securely store sensitive information. In the example used in the procedure below, the <span class="strong strong"><strong>idm_user</strong></span> user creates a vault of the standard type named <span class="strong strong"><strong>my_vault</strong></span>. The standard vault type ensures that <span class="strong strong"><strong>idm_user</strong></span> will not be required to authenticate when accessing the file. <span class="strong strong"><strong>idm_user</strong></span> will be able to retrieve the file from any IdM client to which the user is logged in.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible">ansible-freeipa</a> package on the Ansible controller, that is the host on which you execute the steps in the procedure.
					</li><li class="listitem">
						You know the password of <span class="strong strong"><strong>idm_user</strong></span>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/vault</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create an inventory file, for example <span class="strong strong"><strong>inventory.file</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open <span class="strong strong"><strong>inventory.file</strong></span> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>ensure-standard-vault-is-present.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp ensure-standard-vault-is-present.yml ensure-standard-vault-is-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>ensure-standard-vault-is-present-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_principal</code> variable to <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">user</code> variable to <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>my_vault</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">vault_type</code> variable to <span class="strong strong"><strong>standard</strong></span>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Tests
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - ipavault:
      ipaadmin_principal: <span class="emphasis"><em>idm_user</em></span>
      ipaadmin_password: <span class="emphasis"><em>idm_user_password</em></span>
      user: <span class="emphasis"><em>idm_user</em></span>
      name: <span class="emphasis"><em>my_vault</em></span>
      vault_type: standard</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-standard-vault-is-present-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="archiving-a-secret-in-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets"><div class="titlepage"><div><div><h3 class="title">24.2. Archiving a secret in a standard user vault in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to store sensitive information in a personal vault. In the example used, the <span class="strong strong"><strong>idm_user</strong></span> user archives a file with sensitive information named <span class="strong strong"><strong>password.txt</strong></span> in a vault named <span class="strong strong"><strong>my_vault</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible">ansible-freeipa</a> package on the Ansible controller, that is the host on which you execute the steps in the procedure.
					</li><li class="listitem">
						You know the password of <span class="strong strong"><strong>idm_user</strong></span>.
					</li><li class="listitem">
						<span class="strong strong"><strong>idm_user</strong></span> is the owner, or at least a member user of <span class="strong strong"><strong>my_vault</strong></span>.
					</li><li class="listitem">
						You have access to <span class="strong strong"><strong>password.txt</strong></span>, the secret that you want to archive in <span class="strong strong"><strong>my_vault</strong></span>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/vault</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>data-archive-in-symmetric-vault.yml</strong></span> Ansible playbook file but replace "symmetric" by "standard". For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp data-archive-in-symmetric-vault.yml data-archive-in-standard-vault-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>data-archive-in-standard-vault-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_principal</code> variable to <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">user</code> variable to <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>my_vault</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">in</code> variable to the full path to the file with sensitive information.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">action</code> variable to <span class="strong strong"><strong>member</strong></span>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Tests
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - ipavault:
      ipaadmin_principal: <span class="emphasis"><em>idm_user</em></span>
      ipaadmin_password: <span class="emphasis"><em>idm_user_password</em></span>
      user: <span class="emphasis"><em>idm_user</em></span>
      name: <span class="emphasis"><em>my_vault</em></span>
      in: <span class="emphasis"><em>/usr/share/doc/ansible-freeipa/playbooks/vault/password.txt</em></span>
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file data-archive-in-standard-vault-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="retrieving-a-secret-from-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets"><div class="titlepage"><div><div><h3 class="title">24.3. Retrieving a secret from a standard user vault in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to retrieve a secret from the user personal vault. In the example used in the procedure below, the <span class="strong strong"><strong>idm_user</strong></span> user retrieves a file with sensitive data from a vault of the standard type named <span class="strong strong"><strong>my_vault</strong></span> onto an IdM client named <span class="strong strong"><strong>host01</strong></span>. <span class="strong strong"><strong>idm_user</strong></span> does not have to authenticate when accessing the file. <span class="strong strong"><strong>idm_user</strong></span> can use Ansible to retrieve the file from any IdM client on which Ansible is installed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the password of <span class="strong strong"><strong>idm_user</strong></span>.
					</li><li class="listitem">
						<span class="strong strong"><strong>idm_user</strong></span> is the owner of <span class="strong strong"><strong>my_vault</strong></span>.
					</li><li class="listitem">
						<span class="strong strong"><strong>idm_user</strong></span> has stored a secret in <span class="strong strong"><strong>my_vault</strong></span>.
					</li><li class="listitem">
						Ansible can write into the directory on the IdM host into which you want to retrieve the secret.
					</li><li class="listitem">
						<span class="strong strong"><strong>idm_user</strong></span> can read from the directory on the IdM host into which you want to retrieve the secret.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/vault</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and mention, in a clearly defined section, the IdM client onto which you want to retrieve the secret. For example, to instruct Ansible to retrieve the secret onto <span class="strong strong"><strong>host01.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipahost]
host01.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>retrive-data-symmetric-vault.yml</strong></span> Ansible playbook file. Replace "symmetric" with "standard". For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp retrive-data-symmetric-vault.yml retrieve-data-standard-vault.yml-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>retrieve-data-standard-vault.yml-copy.yml</strong></span> file for editing.
					</li><li class="listitem">
						Adapt the file by setting the <code class="literal">hosts</code> variable to <span class="strong strong"><strong>ipahost</strong></span>.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_principal</code> variable to <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">user</code> variable to <span class="strong strong"><strong>idm_user</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>my_vault</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">out</code> variable to the full path of the file into which you want to export the secret.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">state</code> variable to <span class="strong strong"><strong>retrieved</strong></span>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Tests
  hosts: ipahost
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - ipavault:
      ipaadmin_principal: <span class="emphasis"><em>idm_user</em></span>
      ipaadmin_password: <span class="emphasis"><em>idm_user_password</em></span>
      user: <span class="emphasis"><em>idm_user</em></span>
      name: <span class="emphasis"><em>my_vault</em></span>
      out: <span class="emphasis"><em>/tmp/password_exported.txt</em></span>
      state: retrieved</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file retrieve-data-standard-vault.yml-copy.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						<code class="literal">SSH</code> to <span class="strong strong"><strong>host01</strong></span> as <span class="strong strong"><strong>user01</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh user01@host01.idm.example.com</strong></span></pre></li><li class="listitem"><p class="simpara">
						View the file specified by the <code class="literal">out</code> variable in the Ansible playbook file:
					</p><pre class="literallayout">$ vim /tmp/password_exported.txt</pre></li></ol></div><p>
				You can now see the exported secret.
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						For more information about using Ansible to manage IdM vaults and user secrets and about playbook variables, see the README-vault.md Markdown file available in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory and the sample playbooks available in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault/</code> directory.
					</li></ul></div></section></section><section class="chapter" id="using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 25. Using Ansible to manage IdM service vaults: storing and retrieving secrets</h2></div></div></div><p class="_abstract _abstract">
			This section shows how an administrator can use the <code class="literal">ansible-freeipa</code> <code class="literal">vault</code> module to securely store a service secret in a centralized location. The <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/using_ansible_to_install_and_manage_identity_management/index#vaults-in-idm_using-ansible-to-install-and-manage-identity-management">vault</a> used in the example is asymmetric, which means that to use it, the administrator needs to perform the following steps:
		</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
					Generate a private key using, for example, the <code class="literal">openssl</code> utility.
				</li><li class="listitem">
					Generate a public key based on the private key.
				</li></ol></div><p>
			The service secret is encrypted with the public key when an administrator archives it into the vault. Afterwards, a service instance hosted on a specific machine in the domain retrieves the secret using the private key. Only the service and the administrator are allowed to access the secret.
		</p><p>
			If the secret is compromised, the administrator can replace it in the service vault and then redistribute it to those individual service instances that have not been compromised.
		</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					The Key Recovery Authority (KRA) Certificate System component has been installed on one or more of the servers in your IdM domain. For details, see <a class="link" href="#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm" title="23.7. Installing the Key Recovery Authority in IdM">Installing the Key Recovery Authority in IdM</a>.
				</li></ul></div><p>
			This section includes these procedures:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible">Ensuring the presence of an asymmetric service vault in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.3. Storing an IdM service secret in an asymmetric vault using Ansible">Storing an IdM service secret in an asymmetric vault using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.4. Retrieving a service secret for an IdM service using Ansible">Retrieving a service secret for an IdM service using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#changing-an-idm-service-vault-secret-when-compromised-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.5. Changing an IdM service vault secret when compromised using Ansible">Changing an IdM service vault secret when compromised using Ansible</a>
				</li></ul></div><p>
			In the procedures:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<span class="strong strong"><strong>admin</strong></span> is the administrator who manages the service password.
				</li></ul></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<span class="strong strong"><strong>private-key-to-an-externally-signed-certificate.pem</strong></span> is the file containing the service secret, in this case a private key to an externally signed certificate. Do not confuse this private key with the private key used to retrieve the secret from the vault.
				</li><li class="listitem">
					<span class="strong strong"><strong>secret_vault</strong></span> is the vault created to store the service secret.
				</li><li class="listitem">
					<span class="strong strong"><strong>HTTP/webserver1.idm.example.com</strong></span> is the service that is the owner of the vault.
				</li><li class="listitem">
					<span class="strong strong"><strong>HTTP/webserver2.idm.example.com</strong></span> and <span class="strong strong"><strong>HTTP/webserver3.idm.example.com</strong></span> are the vault member services.
				</li><li class="listitem">
					<span class="strong strong"><strong>service-public.pem</strong></span> is the service public key used to encrypt the password stored in <span class="strong strong"><strong>password_vault</strong></span>.
				</li><li class="listitem">
					<span class="strong strong"><strong>service-private.pem</strong></span> is the service private key used to decrypt the password stored in <span class="strong strong"><strong>secret_vault</strong></span>.
				</li></ul></div><section class="section" id="ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets"><div class="titlepage"><div><div><h3 class="title">25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to create a service vault container with one or more private vaults to securely store sensitive information. In the example used in the procedure below, the administrator creates an asymmetric vault named <span class="strong strong"><strong>secret_vault</strong></span>. This ensures that the vault members have to authenticate using a private key to retrieve the secret in the vault. The vault members will be able to retrieve the file from any IdM client.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the <span class="strong strong"><strong>IdM administrator</strong></span> password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/vault</strong></span></pre></li><li class="listitem"><p class="simpara">
						Obtain the public key of the service instance. For example, using the <code class="literal">openssl</code> utility:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Generate the <code class="literal">service-private.pem</code> private key.
							</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl genrsa -out service-private.pem 2048</strong></span>
Generating RSA private key, 2048 bit long modulus
.+++
...........................................+++
e is 65537 (0x10001)</pre></li><li class="listitem"><p class="simpara">
								Generate the <code class="literal">service-public.pem</code> public key based on the private key.
							</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl rsa -in service-private.pem -out service-public.pem -pubout</strong></span>
writing RSA key</pre></li></ol></div></li><li class="listitem"><p class="simpara">
						Optional: Create an inventory file if it does not exist, for example <span class="strong strong"><strong>inventory.file</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>ensure-asymmetric-vault-is-present.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp ensure-asymmetric-vault-is-present.yml ensure-asymmetric-service-vault-is-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>ensure-asymmetric-vault-is-present-copy.yml</strong></span> file for editing.
					</li><li class="listitem">
						Add a task that copies the <span class="strong strong"><strong>service-public.pem</strong></span> public key from the Ansible controller to the <span class="strong strong"><strong>server.idm.example.com</strong></span> server.
					</li><li class="listitem"><p class="simpara">
						Modify the rest of the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the IdM administrator password.
							</li><li class="listitem">
								Define the name of the vault using the <code class="literal">name</code> variable, for example <span class="strong strong"><strong>secret_vault</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">vault_type</code> variable to <span class="strong strong"><strong>asymmetric</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">service</code> variable to the principal of the service that owns the vault, for example <span class="strong strong"><strong>HTTP/webserver1.idm.example.com</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">public_key_file</code> to the location of your public key.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Tests
  hosts: ipaserver
  gather_facts: false
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Copy public key to ipaserver.
    copy:
      src: /path/to/service-public.pem
      dest: /usr/share/doc/ansible-freeipa/playbooks/vault/service-public.pem
      mode: 0600
  - name: Add data to vault, from a LOCAL file.
    ipavault:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: secret_vault
      vault_type: asymmetric
      service: HTTP/webserver1.idm.example.com
      public_key_file: /usr/share/doc/ansible-freeipa/playbooks/vault/service-public.pem</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-asymmetric-service-vault-is-present-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="adding-member-services-to-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets"><div class="titlepage"><div><div><h3 class="title">25.2. Adding member services to an asymmetric vault using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to add member services to a service vault so that they can all retrieve the secret stored in the vault. In the example used in the procedure below, the IdM administrator adds the <span class="strong strong"><strong>HTTP/webserver2.idm.example.com</strong></span> and <span class="strong strong"><strong>HTTP/webserver3.idm.example.com</strong></span> service principals to the <span class="strong strong"><strong>secret_vault</strong></span> vault that is owned by <span class="strong strong"><strong>HTTP/webserver1.idm.example.com</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the <span class="strong strong"><strong>IdM administrator</strong></span> password.
					</li><li class="listitem">
						You have <a class="link" href="#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible">created an asymmetric vault</a> to store the service secret.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/vault</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Create an inventory file if it does not exist, for example <span class="strong strong"><strong>inventory.file</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>data-archive-in-asymmetric-vault.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp data-archive-in-asymmetric-vault.yml add-services-to-an-asymmetric-vault.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>data-archive-in-asymmetric-vault-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Modify the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the vault, for example <span class="strong strong"><strong>secret_vault</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">service</code> variable to the service owner of the vault, for example <span class="strong strong"><strong>HTTP/webserver1.idm.example.com</strong></span>.
							</li><li class="listitem">
								Define the services that you want to have access to the vault secret using the <code class="literal">services</code> variable.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Tests
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - ipavault:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: secret_vault
      service: HTTP/webserver1.idm.example.com
      services:
      - HTTP/webserver2.idm.example.com
      - HTTP/webserver3.idm.example.com
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file add-services-to-an-asymmetric-vault.yml</strong></span></pre></li></ol></div></section><section class="section" id="storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets"><div class="titlepage"><div><div><h3 class="title">25.3. Storing an IdM service secret in an asymmetric vault using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to store a secret in a service vault so that it can be later retrieved by the service. In the example used in the procedure below, the administrator stores a <code class="literal">PEM</code> file with the secret in an asymmetric vault named <span class="strong strong"><strong>secret_vault</strong></span>. This ensures that the service will have to authenticate using a private key to retrieve the secret from the vault. The vault members will be able to retrieve the file from any IdM client.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the <span class="strong strong"><strong>IdM administrator</strong></span> password.
					</li><li class="listitem">
						You have <a class="link" href="#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible">created an asymmetric vault</a> to store the service secret.
					</li><li class="listitem">
						The secret is stored locally on the Ansible controller, for example in the <span class="strong strong"><strong>/usr/share/doc/ansible-freeipa/playbooks/vault/private-key-to-an-externally-signed-certificate.pem</strong></span> file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/vault</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Create an inventory file if it does not exist, for example <span class="strong strong"><strong>inventory.file</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>data-archive-in-asymmetric-vault.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp data-archive-in-asymmetric-vault.yml data-archive-in-asymmetric-vault-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>data-archive-in-asymmetric-vault-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Modify the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the vault, for example <span class="strong strong"><strong>secret_vault</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">service</code> variable to the service owner of the vault, for example <span class="strong strong"><strong>HTTP/webserver1.idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">in</code> variable to <span class="strong strong"><strong>"{{ lookup('file', 'private-key-to-an-externally-signed-certificate.pem') | b64encode }}"</strong></span>. This ensures that Ansible retrieves the file with the private key from the working directory on the Ansible controller rather than from the IdM server.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Tests
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - ipavault:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: secret_vault
      service: HTTP/webserver1.idm.example.com
      in: "{{ lookup('file', 'private-key-to-an-externally-signed-certificate.pem') | b64encode }}"
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file data-archive-in-asymmetric-vault-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets"><div class="titlepage"><div><div><h3 class="title">25.4. Retrieving a service secret for an IdM service using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to retrieve a secret from a service vault on behalf of the service. In the example used in the procedure below, running the playbook retrieves a <code class="literal">PEM</code> file with the secret from an asymmetric vault named <span class="strong strong"><strong>secret_vault</strong></span>, and stores it in the specified location on all the hosts listed in the Ansible inventory file as <code class="literal">ipaservers</code>.
			</p><p>
				The services authenticate to IdM using keytabs, and they authenticate to the vault using a private key. You can retrieve the file on behalf of the service from any IdM client on which <code class="literal">ansible-freeipa</code> is installed.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						You have <a class="link" href="#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible">created an asymmetric vault</a> to store the service secret.
					</li><li class="listitem">
						You have <a class="link" href="#storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.3. Storing an IdM service secret in an asymmetric vault using Ansible">archived the secret in the vault</a>.
					</li><li class="listitem">
						You have stored the private key used to retrieve the service vault secret in the location specified by the <code class="literal">private_key_file</code> variable on the Ansible controller.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/vault</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Create an inventory file if it does not exist, for example <span class="strong strong"><strong>inventory.file</strong></span>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and define the following hosts:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Define your IdM server in the <code class="literal">[ipaserver]</code> section.
							</li><li class="listitem">
								Define the hosts onto which you want to retrieve the secret in the <code class="literal">[webservers]</code> section. For example, to instruct Ansible to retrieve the secret to <span class="strong strong"><strong>webserver1.idm.example.com</strong></span>, <span class="strong strong"><strong>webserver2.idm.example.com</strong></span>, and <span class="strong strong"><strong>webserver3.idm.example.com</strong></span>, enter:
							</li></ul></div><pre class="literallayout">[ipaserver]
server.idm.example.com

[webservers]
webserver1.idm.example.com
webserver2.idm.example.com
webserver3.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>retrieve-data-asymmetric-vault.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp retrieve-data-asymmetric-vault.yml retrieve-data-asymmetric-vault-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>retrieve-data-asymmetric-vault-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Modify the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the vault, for example <span class="strong strong"><strong>secret_vault</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">service</code> variable to the service owner of the vault, for example <span class="strong strong"><strong>HTTP/webserver1.idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">private_key_file</code> variable to the location of the private key used to retrieve the service vault secret.
							</li><li class="listitem">
								Set the <code class="literal">out</code> variable to the location on the IdM server where you want to retrieve the <span class="strong strong"><strong>private-key-to-an-externally-signed-certificate.pem</strong></span> secret, for example the current working directory.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Retrieve data from vault
  hosts: ipaserver
  become: no
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Retrieve data from the service vault
    ipavault:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: secret_vault
      service: HTTP/webserver1.idm.example.com
      vault_type: asymmetric
      private_key: "{{ lookup('file', 'service-private.pem') | b64encode }}"
      out: private-key-to-an-externally-signed-certificate.pem
      state: retrieved</pre></li><li class="listitem"><p class="simpara">
						Add a section to the playbook that retrieves the data file from the IdM server to the Ansible controller:
					</p><pre class="literallayout">---
- name: Retrieve data from vault
  hosts: ipaserver
  become: no
  gather_facts: false
  tasks:
[...]
  - name: Retrieve data file
    fetch:
      src: private-key-to-an-externally-signed-certificate.pem
      dest: ./
      flat: true
      mode: 0600</pre></li><li class="listitem"><p class="simpara">
						Add a section to the playbook that transfers the retrieved <span class="strong strong"><strong>private-key-to-an-externally-signed-certificate.pem</strong></span> file from the Ansible controller on to the webservers listed in the <code class="literal">webservers</code> section of the inventory file:
					</p><pre class="literallayout">---
- name: Send data file to webservers
  become: no
  gather_facts: no
  hosts: webservers
  tasks:
  - name: Send data to webservers
    copy:
      src: private-key-to-an-externally-signed-certificate.pem
      dest: /etc/pki/tls/private/httpd.key
      mode: 0444</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file retrieve-data-asymmetric-vault-copy.yml</strong></span></pre></li></ol></div></section><section class="section" id="changing-an-idm-service-vault-secret-when-compromised-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets"><div class="titlepage"><div><div><h3 class="title">25.5. Changing an IdM service vault secret when compromised using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to reuse an Ansible playbook to change the secret stored in a service vault when a service instance has been compromised. The scenario in the following example assumes that on <span class="strong strong"><strong>webserver3.idm.example.com</strong></span>, the retrieved secret has been compromised, but not the key to the asymmetric vault storing the secret. In the example, the administrator reuses the Ansible playbooks used when <a class="link" href="#storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.3. Storing an IdM service secret in an asymmetric vault using Ansible">storing a secret in an asymmetric vault</a> and <a class="link" href="#retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.4. Retrieving a service secret for an IdM service using Ansible">retrieving a secret from the asymmetric vault onto IdM hosts</a>. At the start of the procedure, the IdM administrator stores a new <code class="literal">PEM</code> file with a new secret in the asymmetric vault, adapts the inventory file so as not to retrieve the new secret on to the compromised web server, <span class="strong strong"><strong>webserver3.idm.example.com</strong></span>, and then re-runs the two procedures.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the <span class="strong strong"><strong>IdM administrator</strong></span> password.
					</li><li class="listitem">
						You have <a class="link" href="#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets" title="25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible">created an asymmetric vault</a> to store the service secret.
					</li><li class="listitem">
						You have generated a new <code class="literal">httpd</code> key for the web services running on IdM hosts to replace the compromised old key.
					</li><li class="listitem">
						The new <code class="literal">httpd</code> key is stored locally on the Ansible controller, for example in the <span class="strong strong"><strong>/usr/share/doc/ansible-freeipa/playbooks/vault/private-key-to-an-externally-signed-certificate.pem</strong></span> file.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/vault</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the following hosts are defined correctly:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The IdM server in the <code class="literal">[ipaserver]</code> section.
							</li><li class="listitem"><p class="simpara">
								The hosts onto which you want to retrieve the secret in the <code class="literal">[webservers]</code> section. For example, to instruct Ansible to retrieve the secret to <span class="strong strong"><strong>webserver1.idm.example.com</strong></span> and <span class="strong strong"><strong>webserver2.idm.example.com</strong></span>, enter:
							</p><pre class="literallayout">[ipaserver]
server.idm.example.com

[webservers]
webserver1.idm.example.com
webserver2.idm.example.com</pre></li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							Make sure that the list does not contain the compromised webserver, in the current example <span class="strong strong"><strong>webserver3.idm.example.com</strong></span>.
						</p></div></rh-alert></li><li class="listitem">
						Open the <span class="strong strong"><strong>data-archive-in-asymmetric-vault-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Modify the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the vault, for example <span class="strong strong"><strong>secret_vault</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">service</code> variable to the service owner of the vault, for example <span class="strong strong"><strong>HTTP/webserver.idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">in</code> variable to <span class="strong strong"><strong>"{{ lookup('file', 'new-private-key-to-an-externally-signed-certificate.pem') | b64encode }}"</strong></span>. This ensures that Ansible retrieves the file with the private key from the working directory on the Ansible controller rather than from the IdM server.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Tests
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - ipavault:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: secret_vault
      service: HTTP/webserver.idm.example.com
      in: "{{ lookup('file', 'new-private-key-to-an-externally-signed-certificate.pem') | b64encode }}"
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file data-archive-in-asymmetric-vault-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>retrieve-data-asymmetric-vault-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Modify the file by setting the following variables in the <code class="literal">ipavault</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the vault, for example <span class="strong strong"><strong>secret_vault</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">service</code> variable to the service owner of the vault, for example <span class="strong strong"><strong>HTTP/webserver1.idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">private_key_file</code> variable to the location of the private key used to retrieve the service vault secret.
							</li><li class="listitem">
								Set the <code class="literal">out</code> variable to the location on the IdM server where you want to retrieve the <span class="strong strong"><strong>new-private-key-to-an-externally-signed-certificate.pem</strong></span> secret, for example the current working directory.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Retrieve data from vault
  hosts: ipaserver
  become: no
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Retrieve data from the service vault
    ipavault:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: secret_vault
      service: HTTP/webserver1.idm.example.com
      vault_type: asymmetric
      private_key: "{{ lookup('file', 'service-private.pem') | b64encode }}"
      out: new-private-key-to-an-externally-signed-certificate.pem
      state: retrieved</pre></li><li class="listitem"><p class="simpara">
						Add a section to the playbook that retrieves the data file from the IdM server to the Ansible controller:
					</p><pre class="literallayout">---
- name: Retrieve data from vault
  hosts: ipaserver
  become: true
  gather_facts: false
  tasks:
[...]
  - name: Retrieve data file
    fetch:
      src: new-private-key-to-an-externally-signed-certificate.pem
      dest: ./
      flat: true
      mode: 0600</pre></li><li class="listitem"><p class="simpara">
						Add a section to the playbook that transfers the retrieved <span class="strong strong"><strong>new-private-key-to-an-externally-signed-certificate.pem</strong></span> file from the Ansible controller on to the webservers listed in the <code class="literal">webservers</code> section of the inventory file:
					</p><pre class="literallayout">---
- name: Send data file to webservers
  become: true
  gather_facts: no
  hosts: webservers
  tasks:
  - name: Send data to webservers
    copy:
      src: new-private-key-to-an-externally-signed-certificate.pem
      dest: /etc/pki/tls/private/httpd.key
      mode: 0444</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file retrieve-data-asymmetric-vault-copy.yml</strong></span></pre></li></ol></div></section><section class="section _additional-resources" id="additional_resources_6"><div class="titlepage"><div><div><h3 class="title">25.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See the README-vault.md Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See the sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/vault/</code> directory.
					</li></ul></div></section></section><section class="chapter" id="ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 26. Ensuring the presence and absence of services in IdM using Ansible</h2></div></div></div><p class="_abstract _abstract">
			With the Ansible <code class="literal">service</code> module, Identity Management (IdM) administrator can ensure that specific services that are not native to IdM are present or absent in IdM. For example, you can use the <code class="literal">service</code> module to:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					Check that a manually installed service is present on an IdM client and automatically install that service if it is absent. For details, see:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Ensuring the presence of an HTTP service in IdM on an IdM client.</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-on-a-non-idm-client-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Ensuring the presence of an HTTP service in IdM on a non-IdM client.</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-on-an-idm-client-without-dns-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Ensuring the presence of an HTTP service on an IdM client without DNS.</a>
						</li></ul></div></li><li class="listitem">
					Check that a service enrolled in IdM has a certificate attached and automatically install that certificate if it is absent. For details, see:
				</li><li class="listitem">
					<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Ensuring the presence of an externally-signed certificate in an IdM service entry.</a>
				</li><li class="listitem"><p class="simpara">
					Allow IdM users and hosts to retrieve and create the service keytab. For details, see:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-create-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Allowing IdM users, groups, hosts, or host groups to create a keytab of a service.</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-retrieve-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Allowing IdM users, groups, hosts, or host groups to retrieve a keytab of a service.</a>
						</li></ul></div></li><li class="listitem"><p class="simpara">
					Allow IdM users and hosts to add a Kerberos alias to a service. For details, see:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-a-kerberos-principal-alias-of-a-service-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Ensuring the presence of a Kerberos principal alias for a service.</a>
						</li></ul></div></li><li class="listitem"><p class="simpara">
					Check that a service is not present on an IdM client and automatically remove that service if it is present. For details, see:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-absence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Ensuring the absence of an HTTP service in IdM on an IdM client.</a>
						</li></ul></div></li></ul></div><section class="section" id="ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.1. Ensuring the presence of an HTTP service in IdM using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the presence of an HTTP server in IdM using an Ansible playbook.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system to host the HTTP service is an IdM client.
					</li><li class="listitem">
						You have the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">inventory.file</code> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-copy.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-copy.yml</code> Ansible playbook file for editing:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA service.
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure service is present
  - ipaservice:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: HTTP/client.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Adapt the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Change the IdM administrator password defined by the <code class="literal">ipaadmin_password</code> variable.
							</li><li class="listitem">
								Change the name of your IdM client on which the HTTP service is running, as defined by the <code class="literal">name</code> variable of the <code class="literal">ipaservice</code> task.
							</li></ul></div></li><li class="listitem">
						Save and exit the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-copy.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log into the IdM Web UI as IdM administrator.
					</li><li class="listitem">
						Navigate to <code class="literal">Identity</code> → <code class="literal">Services</code>.
					</li></ol></div><p>
				If <span class="strong strong"><strong>HTTP/client.idm.example.com@IDM.EXAMPLE.COM</strong></span> is listed in the <span class="strong strong"><strong>Services</strong></span> list, the Ansible playbook has been successfully added to IdM.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						To secure the communication between the HTTP server and browser clients, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs">adding TLS encryption to an Apache HTTP Server</a>.
					</li><li class="listitem">
						To request a certificate for the HTTP service, see the procedure described in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm">Obtaining an IdM certificate for a service using certmonger</a>.
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-multiple-services-in-idm-on-an-idm-client-using-a-single-ansible-task_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.2. Ensuring the presence of multiple services in IdM on an IdM client using a single Ansible task</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">ansible-freeipa</code> <code class="literal">ipaservice</code> module to add, modify, and delete multiple Identity Management (IdM) services with a single Ansible task. For that, use the <code class="literal">services</code> option of the <code class="literal">ipaservice</code> module.
			</p><p>
				Using the <code class="literal">services</code> option, you can also specify multiple service variables that only apply to a particular service. Define this service by the <code class="literal">name</code> variable, which is the only mandatory variable for the <code class="literal">services</code> option.
			</p><p>
				Complete this procedure to ensure the presence of the <span class="strong strong"><strong>HTTP/client01.idm.example.com@IDM.EXAMPLE.COM</strong></span> and the <span class="strong strong"><strong>ftp/client02.idm.example.com@IDM.EXAMPLE.COM</strong></span> services in IdM with a single task.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On the control node:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You are using RHEL 9.3 and later.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>add-http-and-ftp-services.yml</strong></span> with the following content:
					</p><pre class="screen">---
- name: Playbook to add multiple services in a single task
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml

  tasks:
  - name: Add HTTP and ftp services
    ipaservice:
      ipaadmin_password: "{{ ipaadmin_password }}"
      services:
      - name:  HTTP/client01.idm.example.com@IDM.EXAMPLE.COM
      - name: ftp/client02.idm.example.com@IDM.EXAMPLE.COM</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory add-http-and-ftp-services.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-service.md">The service module in <code class="literal">ansible-freeipa</code> upstream docs</a>
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-an-http-service-in-idm-on-a-non-idm-client-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.3. Ensuring the presence of an HTTP service in IdM on a non-IdM client using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the presence of an HTTP server in IdM on a host that is not an IdM client using an Ansible playbook. By adding the HTTP server to IdM you are also adding the host to IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs">installed an HTTP service</a> on your host.
					</li><li class="listitem">
						The host on which you have set up HTTP is not an IdM client. Otherwise, follow the steps in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">enrolled the HTTP service into IdM.</a>
					</li><li class="listitem">
						You have the IdM administrator password.
					</li><li class="listitem">
						The DNS A record - or the AAAA record if IPv6 is used - for the host is available.
					</li><li class="listitem">
						If the server runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the <a class="link" href="https://access.redhat.com/solutions/7018256">TLS extension "Extended Master Secret" enforced</a> Knowledgebase article.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">inventory.file</code> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check-copy.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the copied file, <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check-copy.yml</code>, for editing. Locate the <code class="literal">ipaadmin_password</code> and <code class="literal">name</code> variables in the <code class="literal">ipaservice</code> task:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA service.
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure service is present
  - ipaservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: HTTP/www2.example.com</strong></span>
      skip_host_check: true</pre></li><li class="listitem"><p class="simpara">
						Adapt the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the host on which the HTTP service is running.
							</li></ul></div></li><li class="listitem">
						Save and exit the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check-copy.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log into the IdM Web UI as IdM administrator.
					</li><li class="listitem">
						Navigate to <code class="literal">Identity</code> → <code class="literal">Services</code>.
					</li></ol></div><p>
				You can now see <span class="strong strong"><strong>HTTP/client.idm.example.com@IDM.EXAMPLE.COM</strong></span> listed in the <span class="strong strong"><strong>Services</strong></span> list.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						To secure the communication, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs">adding TLS encryption to an Apache HTTP Server</a>.
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-an-http-service-on-an-idm-client-without-dns-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.4. Ensuring the presence of an HTTP service on an IdM client without DNS using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to ensure the presence of an HTTP server running on an IdM client that has no DNS entry using an Ansible playbook. The scenario implied is that the IdM host has no DNS A entry available - or no DNS AAAA entry if IPv6 is used instead of IPv4.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The system to host the HTTP service is enrolled in IdM.
					</li><li class="listitem">
						The DNS A or DNS AAAA record for the host may not exist. Otherwise, if the DNS record for the host does exist, follow the procedure in <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">Ensuring the presence of an HTTP service in IdM using an Ansible playbook.</a>
					</li><li class="listitem">
						You have the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">inventory.file</code> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force-copy.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the copied file, <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force-copy.yml</code>, for editing. Locate the <code class="literal">ipaadmin_password</code> and <code class="literal">name</code> variables in the <code class="literal">ipaservice</code> task:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA service.
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure service is present
  - ipaservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: HTTP/ihavenodns.info</strong></span>
      force: true</pre></li><li class="listitem"><p class="simpara">
						Adapt the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the host on which the HTTP service is running.
							</li></ul></div></li><li class="listitem">
						Save and exit the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force-copy.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log into the IdM Web UI as IdM administrator.
					</li><li class="listitem">
						Navigate to <code class="literal">Identity</code> → <code class="literal">Services</code>.
					</li></ol></div><p>
				You can now see <span class="strong strong"><strong>HTTP/client.idm.example.com@IDM.EXAMPLE.COM</strong></span> listed in the <span class="strong strong"><strong>Services</strong></span> list.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						To secure the communication, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs">adding TLS encryption to an Apache HTTP Server</a>.
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.5. Ensuring the presence of an externally signed certificate in an IdM service entry using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use the <code class="literal">ansible-freeipa</code> <code class="literal">service</code> module to ensure that a certificate issued by an external certificate authority (CA) is attached to the IdM entry of the HTTP service. Having the certificate of an HTTP service signed by an external CA rather than the IdM CA is particularly useful if your IdM CA uses a self-signed certificate.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs">installed an HTTP service</a> on your host.
					</li><li class="listitem">
						You have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">enrolled the HTTP service into IdM.</a>
					</li><li class="listitem">
						You have the IdM administrator password.
					</li><li class="listitem">
						You have an externally signed certificate whose Subject corresponds to the principal of the HTTP service.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">inventory.file</code> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present.yml</code> file, for example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present-copy.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: If the certificate is in the Privacy Enhanced Mail (PEM) format, convert the certificate to the Distinguished Encoding Rules (DER) format for easier handling through the command-line interface (CLI):
					</p><pre class="literallayout">$ <span class="strong strong"><strong>openssl x509 -outform der -in cert1.pem -out cert1.der</strong></span></pre></li><li class="listitem"><p class="simpara">
						Decode the <code class="literal">DER</code> file to standard output using the <code class="literal">base64</code> command. Use the <code class="literal">-w0</code> option to disable wrapping:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>base64 cert1.der -w0</strong></span>
MIIC/zCCAeegAwIBAgIUV74O+4kXeg21o4vxfRRtyJm...</pre></li><li class="listitem">
						Copy the certificate from the standard output to the clipboard.
					</li><li class="listitem"><p class="simpara">
						Open the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present-copy.yml</code> file for editing and view its contents:
					</p><pre class="literallayout">---
- name: Service certificate present.
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure service certificate is present
  - ipaservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      name: <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span>
      certificate: |
        - <span class="strong strong"><strong>MIICBjCCAW8CFHnm32VcXaUDGfEGdDL/...</strong></span>
      [...]
      action: member
      state: present</pre></li><li class="listitem"><p class="simpara">
						Adapt the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Replace the certificate, defined using the <code class="literal">certificate</code> variable, with the certificate you copied from the CLI. Note that if you use the <code class="literal">certificate:</code> variable with the "|" pipe character as indicated, you can enter the certificate THIS WAY rather than having it to enter it in a single line. This makes reading the certificate easier.
							</li><li class="listitem">
								Change the IdM administrator password, defined by the <code class="literal">ipaadmin_password</code> variable.
							</li><li class="listitem">
								Change the name of your IdM client on which the HTTP service is running, defined by the <code class="literal">name</code> variable.
							</li><li class="listitem">
								Change any other relevant variables.
							</li></ul></div></li><li class="listitem">
						Save and exit the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present-copy.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log into the IdM Web UI as IdM administrator.
					</li><li class="listitem">
						Navigate to <code class="literal">Identity</code> → <code class="literal">Services</code>.
					</li><li class="listitem">
						Click the name of the service with the newly added certificate, for example <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span>.
					</li></ol></div><p>
				In the <code class="literal">Service Certificate</code> section on the right, you can now see the newly added certificate.
			</p></section><section class="section" id="using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-create-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.6. Using an Ansible playbook to allow IdM users, groups, hosts, or host groups to create a keytab of a service</h3></div></div></div><p class="_abstract _abstract">
				A keytab is a file containing pairs of Kerberos principals and encrypted keys. Keytab files are commonly used to allow scripts to automatically authenticate using Kerberos, without requiring human interaction or access to password stored in a plain-text file. The script is then able to use the acquired credentials to access files stored on a remote system.
			</p><p>
				As an Identity Management (IdM) administrator, you can allow other users to retrieve or even create a keytab for a service running in IdM. By allowing specific users and user groups to create keytabs, you can delegate the administration of the service to them without sharing the IdM administrator password. This delegation provides a more fine-grained system administration.
			</p><p>
				Follow this procedure to allow specific IdM users, user groups, hosts, and host groups to create a keytab for the HTTP service running on an IdM client. Specifically, it describes how you can allow the <span class="strong strong"><strong>user01</strong></span> IdM user to create a keytab for the HTTP service running on an IdM client named <span class="strong strong"><strong>client.idm.example.com</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">enrolled the HTTP service into IdM.</a>
					</li><li class="listitem">
						The system to host the HTTP service is an IdM client.
					</li><li class="listitem">
						The IdM users and user groups that you want to allow to create the keytab exist in IdM.
					</li><li class="listitem">
						The IdM hosts and host groups that you want to allow to create the keytab exist in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">inventory.file</code> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by changing the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The IdM administrator password specified by the <code class="literal">ipaadmin_password</code> variable.
							</li><li class="listitem">
								The name of your IdM client on which the HTTP service is running. In the current example, it is <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span>
							</li><li class="listitem">
								The names of IdM users that are listed in the <code class="literal">allow_create_keytab_user:</code> section. In the current example, it is <span class="strong strong"><strong>user01</strong></span>.
							</li><li class="listitem">
								The names of IdM user groups that are listed in the <code class="literal">allow_create_keytab_group:</code> section.
							</li><li class="listitem">
								The names of IdM hosts that are listed in the <code class="literal">allow_create_keytab_host:</code> section.
							</li><li class="listitem">
								The names of IdM host groups that are listed in the <code class="literal">allow_create_keytab_hostgroup:</code> section.
							</li><li class="listitem"><p class="simpara">
								The name of the task specified by the <code class="literal">name</code> variable in the <code class="literal">tasks</code> section.
							</p><p class="simpara">
								After being adapted for the current example, the copied file looks like this:
							</p></li></ul></div><pre class="literallayout">---
- name: Service member allow_create_keytab present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Service HTTP/client.idm.example.com members allow_create_keytab present for user01
    ipaservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: HTTP/client.idm.example.com</strong></span>
      allow_create_keytab_user:
      - <span class="strong strong"><strong>user01</strong></span>
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present-copy.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						SSH to an IdM server as an IdM user that has the privilege to create a keytab for the particular HTTP service:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh user01@server.idm.example.com</strong></span>
Password:</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">ipa-getkeytab</code> command to generate the new keytab for the HTTP service:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa-getkeytab -s server.idm.example.com -p HTTP/client.idm.example.com -k /etc/httpd/conf/krb5.keytab</strong></span></pre><p class="simpara">
						The <code class="literal">-s</code> option specifies a Key Distribution Center (KDC) server to generate the keytab.
					</p><p class="simpara">
						The <code class="literal">-p</code> option specifies the principal whose keytab you want to create.
					</p><p class="simpara">
						The <code class="literal">-k</code> option specifies the keytab file to append the new key to. The file will be created if it does not exist.
					</p></li></ol></div><p>
				If the command does not result in an error, you have successfully created a keytab of <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span> as <span class="strong strong"><strong>user01</strong></span>.
			</p></section><section class="section" id="using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-retrieve-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.7. Using an Ansible playbook to allow IdM users, groups, hosts, or host groups to retrieve a keytab of a service</h3></div></div></div><p class="_abstract _abstract">
				A keytab is a file containing pairs of Kerberos principals and encrypted keys. Keytab files are commonly used to allow scripts to automatically authenticate using Kerberos, without requiring human interaction or access to a password stored in a plain-text file. The script is then able to use the acquired credentials to access files stored on a remote system.
			</p><p>
				As IdM administrator, you can allow other users to retrieve or even create a keytab for a service running in IdM.
			</p><p>
				Follow this procedure to allow specific IdM users, user groups, hosts, and host groups to retrieve a keytab for the HTTP service running on an IdM client. Specifically, it describes how to allow the <span class="strong strong"><strong>user01</strong></span> IdM user to retrieve the keytab of the HTTP service running on <span class="strong strong"><strong>client.idm.example.com</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">enrolled the HTTP service into IdM.</a>
					</li><li class="listitem">
						The IdM users and user groups that you want to allow to retrieve the keytab exist in IdM.
					</li><li class="listitem">
						The IdM hosts and host groups that you want to allow to retrieve the keytab exist in IdM.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><pre class="literallayout">$ touch <span class="strong strong"><strong>inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">inventory.file</code> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the copied file, <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present-copy.yml</code>, for editing:
					</li><li class="listitem"><p class="simpara">
						Adapt the file:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable of the <code class="literal">ipaservice</code> task to the principal of the HTTP service. In the current example, it is <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span>
							</li><li class="listitem">
								Specify the names of IdM users in the <code class="literal">allow_retrieve_keytab_group:</code> section. In the current example, it is <span class="strong strong"><strong>user01</strong></span>.
							</li><li class="listitem">
								Specify the names of IdM user groups in the <code class="literal">allow_retrieve_keytab_group:</code> section.
							</li><li class="listitem">
								Specify the names of IdM hosts in the <code class="literal">allow_retrieve_keytab_group:</code> section.
							</li><li class="listitem">
								Specify the names of IdM host groups in the <code class="literal">allow_retrieve_keytab_group:</code> section.
							</li><li class="listitem"><p class="simpara">
								Specify the name of the task using the <code class="literal">name</code> variable in the <code class="literal">tasks</code> section.
							</p><p class="simpara">
								After being adapted for the current example, the copied file looks like this:
							</p></li></ul></div><pre class="literallayout">---
- name: Service member allow_retrieve_keytab present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Service HTTP/client.idm.example.com members allow_retrieve_keytab present for user01
    ipaservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: HTTP/client.idm.example.com</strong></span>
      allow_retrieve_keytab_user:
      - <span class="strong strong"><strong>user01</strong></span>
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present-copy.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						SSH to an IdM server as an IdM user with the privilege to retrieve a keytab for the HTTP service:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh user01@server.idm.example.com</strong></span>
Password:</pre></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">ipa-getkeytab</code> command with the <code class="literal">-r</code> option to retrieve the keytab:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa-getkeytab -r -s server.idm.example.com -p HTTP/client.idm.example.com -k /etc/httpd/conf/krb5.keytab</strong></span></pre><p class="simpara">
						The <code class="literal">-s</code> option specifies a Key Distribution Center (KDC) server from which you want to retrieve the keytab.
					</p><p class="simpara">
						The <code class="literal">-p</code> option specifies the principal whose keytab you want to retrieve.
					</p><p class="simpara">
						The <code class="literal">-k</code> option specifies the keytab file to which you want to append the retrieved key. The file will be created if it does not exist.
					</p></li></ol></div><p>
				If the command does not result in an error, you have successfully retrieved a keytab of <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span> as <span class="strong strong"><strong>user01</strong></span>.
			</p></section><section class="section" id="ensuring-the-presence-of-a-kerberos-principal-alias-of-a-service-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.8. Ensuring the presence of a Kerberos principal alias of a service using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				In some scenarios, it is beneficial for IdM administrator to enable IdM users, hosts, or services to authenticate against Kerberos applications using a Kerberos principal alias. These scenarios include:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The user name changed, but the user should be able to log into the system using both the previous and new user names.
					</li><li class="listitem">
						The user needs to log in using the email address even if the IdM Kerberos realm differs from the email domain.
					</li></ul></div><p>
				Follow this procedure to create the principal alias of <span class="strong strong"><strong>HTTP/mycompany.idm.example.com</strong></span> for the HTTP service running on <span class="strong strong"><strong>client.idm.example.com</strong></span>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs">set up an HTTP service</a> on your host.
					</li><li class="listitem">
						You have <a class="link" href="https://access.redhat.com/documentation/ko-kr/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible">enrolled the HTTP service into IdM.</a>
					</li><li class="listitem">
						The host on which you have set up HTTP is an IdM client.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">inventory.file</code> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by changing the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The IdM administrator password specified by the <code class="literal">ipaadmin_password</code> variable.
							</li><li class="listitem">
								The name of the service specified by the <code class="literal">name</code> variable. This is the canonical principal name of the service. In the current example, it is <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span>.
							</li><li class="listitem">
								The Kerberos principal alias specified by the <code class="literal">principal</code> variable. This is the alias you want to add to the service defined by the <code class="literal">name</code> variable. In the current example, it is <span class="strong strong"><strong>host/mycompany.idm.example.com</strong></span>.
							</li><li class="listitem"><p class="simpara">
								The name of the task specified by the <code class="literal">name</code> variable in the <code class="literal">tasks</code> section.
							</p><p class="simpara">
								After being adapted for the current example, the copied file looks like this:
							</p></li></ul></div><pre class="literallayout">---
- name: Service member principal present
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Service HTTP/client.idm.example.com member principals host/mycompany.idm.exmaple.com present
    ipaservice:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: HTTP/client.idm.example.com</strong></span>
      principal:
        - <span class="strong strong"><strong>host/mycompany.idm.example.com</strong></span>
      action: member</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present-copy.yml</strong></span></pre></li></ol></div><p>
				If running the playbook results in 0 unreachable and 0 failed tasks, you have successfully created the <span class="strong strong"><strong>host/mycompany.idm.example.com</strong></span> Kerberos principal for the <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span> service.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/managing-kerberos-aliases">Managing Kerberos principal aliases for users, hosts, and services</a>
					</li></ul></div></section><section class="section" id="ensuring-the-absence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible"><div class="titlepage"><div><div><h3 class="title">26.9. Ensuring the absence of an HTTP service in IdM using an Ansible playbook</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to unenroll a service from IdM. More specifically, it describes how to use an Ansible playbook to ensure the absence of an HTTP server named <span class="strong strong"><strong>HTTP/client.idm.example.com</strong></span> in IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create an inventory file, for example <code class="literal">inventory.file</code>:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>touch inventory.file</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open the <code class="literal">inventory.file</code> and define the IdM server that you want to configure in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by changing the following:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								The IdM administrator password defined by the <code class="literal">ipaadmin_password</code> variable.
							</li><li class="listitem"><p class="simpara">
								The Kerberos principal of the HTTP service, as defined by the <code class="literal">name</code> variable of the <code class="literal">ipaservice</code> task.
							</p><p class="simpara">
								After being adapted for the current example, the copied file looks like this:
							</p></li></ul></div><pre class="literallayout">---
- name: Playbook to manage IPA service.
  hosts: ipaserver
  gather_facts: false

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  # Ensure service is absent
  - ipaservice:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: HTTP/client.idm.example.com
      state: absent</pre></li><li class="listitem">
						Save and exit the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory</em></span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent-copy.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem">
						Log into the IdM Web UI as IdM administrator.
					</li><li class="listitem">
						Navigate to <code class="literal">Identity</code> → <code class="literal">Services</code>.
					</li></ol></div><p>
				If you cannot see the <span class="strong strong"><strong>HTTP/client.idm.example.com@IDM.EXAMPLE.COM</strong></span> service in the <span class="strong strong"><strong>Services</strong></span> list, you have successfully ensured its absence in IdM.
			</p></section><section class="section _additional-resources" id="additional_resources_7"><div class="titlepage"><div><div><h3 class="title">26.10. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal">README-service.md</code> Markdown file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/config</code> directory.
					</li></ul></div></section></section><section class="chapter" id="managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 27. Managing global DNS configuration in IdM using Ansible playbooks</h2></div></div></div><p class="_abstract _abstract">
			Using the Red Hat Ansible Engine <code class="literal">dnsconfig</code> module, you can configure global configuration for Identity Management (IdM) DNS. Settings defined in global DNS configuration are applied to all IdM DNS servers. However, the global configuration has lower priority than the configuration for a specific IdM DNS zone.
		</p><p>
			The <code class="literal">dnsconfig</code> module supports the following variables:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The global forwarders, specifically their IP addresses and the port used for communication.
				</li><li class="listitem">
					The global forwarding policy: only, first, or none. For more details on these types of DNS forward policies, see <a class="link" href="#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.5. DNS forward policies in IdM">DNS forward policies in IdM</a>.
				</li><li class="listitem">
					The synchronization of forward lookup and reverse lookup zones.
				</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					DNS service is installed on the IdM server. For more information about how to install an IdM server with integrated DNS, see one of the following links:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-with-integrated-dns_installing-identity-management">Installing an IdM server: With integrated DNS, with an integrated CA as the root CA</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-with-external-ca_installing-identity-management">Installing an IdM server: With integrated DNS, with an external CA as the root CA</a>
						</li><li class="listitem">
							<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-without-a-ca_installing-identity-management">Installing an IdM server: With integrated DNS, without a CA</a>
						</li></ul></div></li></ul></div><p>
			 <br>
		</p><p>
			This chapter includes the following sections:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#how-idm-ensures-that-global-forwarders-from-etc-resolv-conf-are-not-removed-by-networkmanager_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.1. How IdM ensures that global forwarders from /etc/resolv.conf are not removed by NetworkManager">How IdM ensures that global forwarders from /etc/resolv.conf are not removed by NetworkManager</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.2. Ensuring the presence of a DNS global forwarder in IdM using Ansible">Ensuring the presence of a DNS global forwarder in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.3. Ensuring the absence of a DNS global forwarder in IdM using Ansible">Ensuring the absence of a DNS global forwarder in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.4. The action: member option in ipadnsconfig ansible-freeipa modules">The <code class="literal">action: member</code> option in ipadnsconfig ansible-freeipa modules</a>
				</li><li class="listitem">
					An introduction to <a class="link" href="#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.5. DNS forward policies in IdM">DNS forward policies in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#using-an-ansible-playbook-to-ensure-that-the-forward-first-policy-is-set-in-idm-dns-global-configuration_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.6. Using an Ansible playbook to ensure that the forward first policy is set in IdM DNS global configuration">Using an Ansible playbook to ensure that the forward first policy is set in IdM DNS global configuration</a>
				</li><li class="listitem">
					<a class="link" href="#using-an-ansible-playbook-to-ensure-that-global-forwarders-are-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.7. Using an Ansible playbook to ensure that global forwarders are disabled in IdM DNS">Using an Ansible playbook to ensure that global forwarders are disabled in IdM DNS</a>
				</li><li class="listitem">
					<a class="link" href="#using-an-ansible-playbook-to-ensure-that-synchronization-of-forward-and-reverse-lookup-zones-is-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.8. Using an Ansible playbook to ensure that synchronization of forward and reverse lookup zones is disabled in IdM DNS">Using an Ansible playbook to ensure that synchronization of forward and reverse lookup zones is disabled in IdM DNS</a>
				</li></ul></div><section class="section" id="how-idm-ensures-that-global-forwarders-from-etc-resolv-conf-are-not-removed-by-networkmanager_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">27.1. How IdM ensures that global forwarders from /etc/resolv.conf are not removed by NetworkManager</h3></div></div></div><p class="_abstract _abstract">
				Installing Identity Management (IdM) with integrated DNS configures the <code class="literal">/etc/resolv.conf</code> file to point to the <code class="literal">127.0.0.1</code> localhost address:
			</p><pre class="literallayout"># Generated by NetworkManager
search idm.example.com
nameserver 127.0.0.1</pre><p>
				In certain environments, such as networks that use <code class="literal">Dynamic Host Configuration Protocol</code> (DHCP), the <code class="literal">NetworkManager</code> service may revert changes to the <code class="literal">/etc/resolv.conf</code> file. To make the DNS configuration persistent, the IdM DNS installation process also configures the <code class="literal">NetworkManager</code> service in the following way:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						The DNS installation script creates an <code class="literal">/etc/NetworkManager/conf.d/zzz-ipa.conf</code> <code class="literal">NetworkManager</code> configuration file to control the search order and DNS server list:
					</p><pre class="literallayout"># auto-generated by IPA installer
[main]
dns=default

[global-dns]
searches=$DOMAIN

[global-dns-domain-*]
servers=127.0.0.1</pre></li><li class="listitem">
						The <code class="literal">NetworkManager</code> service is reloaded, which always creates the <code class="literal">/etc/resolv.conf</code> file with the settings from the last file in the <code class="literal">/etc/NetworkManager/conf.d/</code> directory. This is in this case the <code class="literal">zzz-ipa.conf</code> file.
					</li></ol></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Do not modify the <code class="literal">/etc/resolv.conf</code> file manually.
				</p></div></rh-alert></section><section class="section" id="ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">27.2. Ensuring the presence of a DNS global forwarder in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure the presence of a DNS global forwarder in IdM. In the example procedure below, the IdM administrator ensures the presence of a DNS global forwarder to a DNS server with an Internet Protocol (IP) v4 address of <code class="literal">7.7.9.9</code> and IP v6 address of <code class="literal">2001:db8::1:0</code> on port <code class="literal">53</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">forwarders-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp forwarders-absent.yml ensure-presence-of-a-global-forwarder.yml</pre></li><li class="listitem">
						Open the <code class="literal">ensure-presence-of-a-global-forwarder.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to ensure the presence of a global forwarder in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Ensure the presence of a DNS global forwarder to 7.7.9.9 and 2001:db8::1:0 on port 53</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">forwarders</code> section of the <code class="literal">ipadnsconfig</code> portion:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Change the first <code class="literal">ip_address</code> value to the IPv4 address of the global forwarder: <code class="literal">7.7.9.9</code>.
									</li><li class="listitem">
										Change the second <code class="literal">ip_address</code> value to the IPv6 address of the global forwarder: <code class="literal">2001:db8::1:0</code>.
									</li><li class="listitem">
										Verify the <code class="literal">port</code> value is set to <code class="literal">53</code>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Change the <code class="literal">state</code> to <code class="literal">present</code>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ol></div><pre class="literallayout">---
- name: Playbook to ensure the presence of a global forwarder in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure the presence of a DNS global forwarder to 7.7.9.9 and 2001:db8::1:0 on port 53
    ipadnsconfig:
      forwarders:
        - ip_address: 7.7.9.9
        - ip_address: 2001:db8::1:0
          port: 53
      state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-of-a-global-forwarder.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li></ul></div></section><section class="section" id="ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">27.3. Ensuring the absence of a DNS global forwarder in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure the absence of a DNS global forwarder in IdM. In the example procedure below, the IdM administrator ensures the absence of a DNS global forwarder with an Internet Protocol (IP) v4 address of <code class="literal">8.8.6.6</code> and IP v6 address of <code class="literal">2001:4860:4860::8800</code> on port <code class="literal">53</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">forwarders-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp forwarders-absent.yml ensure-absence-of-a-global-forwarder.yml</pre></li><li class="listitem">
						Open the <code class="literal">ensure-absence-of-a-global-forwarder.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to ensure the absence of a global forwarder in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Ensure the absence of a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800 on port 53</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">forwarders</code> section of the <code class="literal">ipadnsconfig</code> portion:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Change the first <code class="literal">ip_address</code> value to the IPv4 address of the global forwarder: <code class="literal">8.8.6.6</code>.
									</li><li class="listitem">
										Change the second <code class="literal">ip_address</code> value to the IPv6 address of the global forwarder: <code class="literal">2001:4860:4860::8800</code>.
									</li><li class="listitem">
										Verify the <code class="literal">port</code> value is set to <code class="literal">53</code>.
									</li></ol></div></li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li><li class="listitem">
								Verify the <code class="literal">state</code> is set to <code class="literal">absent</code>.
							</li></ol></div><p class="simpara">
						This the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to ensure the absence of a global forwarder in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure the absence of a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800 on port 53
    ipadnsconfig:
      forwarders:
        - ip_address: 8.8.6.6
        - ip_address: 2001:4860:4860::8800
          port: 53
      action: member
      state: absent</pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							If you only use the <code class="literal">state: absent</code> option in your playbook without also using <code class="literal">action: member</code>, the playbook fails.
						</p></div></rh-alert></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-absence-of-a-global-forwarder.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						<a class="link" href="#the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.4. The action: member option in ipadnsconfig ansible-freeipa modules">The <code class="literal">action: member</code> option in ipadnsconfig ansible-freeipa modules</a>
					</li></ul></div></section><section class="section" id="the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">27.4. The <code class="literal">action: member</code> option in ipadnsconfig ansible-freeipa modules</h3></div></div></div><p>
				Excluding global forwarders in Identity Management (IdM) by using the <code class="literal">ansible-freeipa</code> <code class="literal">ipadnsconfig</code> module requires using the <code class="literal">action: member</code> option in addition to the <code class="literal">state: absent</code> option. If you only use <code class="literal">state: absent</code> in your playbook without also using <code class="literal">action: member</code>, the playbook fails. Consequently, to remove all global forwarders, you must specify all of them individually in the playbook. In contrast, the <code class="literal">state: present</code> option does not require <code class="literal">action: member</code>.
			</p><p>
				The <a class="link" href="#tab_ipadnsconfig-management-of-global-forwarders_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="Table 27.1. ipadnsconfig management of global forwarders">following table</a> provides configuration examples for both adding and removing DNS global forwarders that demonstrate the correct use of the action: member option. The table shows, in each line:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The global forwarders configured before executing a playbook
					</li><li class="listitem">
						An excerpt from the playbook
					</li><li class="listitem">
						The global forwarders configured after executing the playbook
					</li></ul></div><rh-table id="tab_ipadnsconfig-management-of-global-forwarders_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><table class="lt-4-cols lt-7-rows"><caption>Table 27.1. ipadnsconfig management of global forwarders</caption><colgroup><col style="width: 14%; " class="col_1"><!--Empty--><col style="width: 72%; " class="col_2"><!--Empty--><col style="width: 14%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464216052464" scope="col">Forwarders before</th><th align="left" valign="top" id="idm140464216051376" scope="col">Playbook excerpt</th><th align="left" valign="top" id="idm140464216050288" scope="col">Forwarders after</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464216052464"> <p>
								8.8.6.6
							</p>
							 </td><td align="left" valign="top" headers="idm140464216051376">
<pre class="screen">[...]
tasks:
- name: Ensure the presence of DNS global forwarder 8.8.6.7
  ipadnsconfig:
    forwarders:
      - ip_address: 8.8.6.7
    state: present</pre>
							 </td><td align="left" valign="top" headers="idm140464216050288"> <p>
								8.8.6.7
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464216052464"> <p>
								8.8.6.6
							</p>
							 </td><td align="left" valign="top" headers="idm140464216051376">
<pre class="screen">[...]
tasks:
- name: Ensure the presence of DNS global forwarder 8.8.6.7
  ipadnsconfig:
    forwarders:
      - ip_address: 8.8.6.7
    action: member
    state: present</pre>
							 </td><td align="left" valign="top" headers="idm140464216050288"> <p>
								8.8.6.6, 8.8.6.7
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464216052464"> <p>
								8.8.6.6, 8.8.6.7
							</p>
							 </td><td align="left" valign="top" headers="idm140464216051376">
<pre class="screen">[...]
tasks:
- name: Ensure the absence of DNS global forwarder 8.8.6.7
  ipadnsconfig:
    forwarders:
      - ip_address: 8.8.6.7
    state: absent</pre>
							 </td><td align="left" valign="top" headers="idm140464216050288"> <p>
								Trying to execute the playbook results in an error. The original configuration - 8.8.6.6, 8.8.6.7 - is left unchanged.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464216052464"> <p>
								8.8.6.6, 8.8.6.7
							</p>
							 </td><td align="left" valign="top" headers="idm140464216051376">
<pre class="screen">[...]
tasks:
- name: Ensure the absence of DNS global forwarder 8.8.6.7
  ipadnsconfig:
    forwarders:
      - ip_address: 8.8.6.7
    action: member
    state: absent</pre>
							 </td><td align="left" valign="top" headers="idm140464216050288"> <p>
								8.8.6.6
							</p>
							 </td></tr></tbody></table></rh-table></section><section class="section" id="dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">27.5. DNS forward policies in IdM</h3></div></div></div><p class="_abstract _abstract">
				IdM supports the <code class="literal">first</code> and <code class="literal">only</code> standard BIND forward policies, as well as the <code class="literal">none</code> IdM-specific forward policy.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Forward first <span class="emphasis"><em>(default)</em></span></span></dt><dd>
							The IdM BIND service forwards DNS queries to the configured forwarder. If a query fails because of a server error or timeout, BIND falls back to the recursive resolution using servers on the Internet. The <code class="literal">forward first</code> policy is the default policy, and it is suitable for optimizing DNS traffic.
						</dd><dt><span class="term">Forward only</span></dt><dd>
							The IdM BIND service forwards DNS queries to the configured forwarder. If a query fails because of a server error or timeout, BIND returns an error to the client. The <code class="literal">forward only</code> policy is recommended for environments with split DNS configuration.
						</dd><dt><span class="term">None <span class="emphasis"><em>(forwarding disabled)</em></span></span></dt><dd>
							DNS queries are not forwarded with the <code class="literal">none</code> forwarding policy. Disabling forwarding is only useful as a zone-specific override for global forwarding configuration. This option is the IdM equivalent of specifying an empty list of forwarders in BIND configuration.
						</dd></dl></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You cannot use forwarding to combine data in IdM with data from other DNS servers. You can only forward queries for specific subzones of the primary zone in IdM DNS.
				</p><p>
					By default, the BIND service does not forward queries to another server if the queried DNS name belongs to a zone for which the IdM server is authoritative. In such a situation, if the queried DNS name cannot be found in the IdM database, the <code class="literal">NXDOMAIN</code> answer is returned. Forwarding is not used.
				</p></div></rh-alert><div class="example" id="idm140464213715440"><p class="title"><strong>Example 27.1. Example Scenario</strong></p><div class="example-contents"><p>
					The IdM server is authoritative for the <span class="strong strong"><strong>test.example.</strong></span> DNS zone. BIND is configured to forward queries to the DNS server with the <span class="strong strong"><strong>192.0.2.254</strong></span> IP address.
				</p><p>
					When a client sends a query for the <span class="strong strong"><strong>nonexistent.test.example.</strong></span> DNS name, BIND detects that the IdM server is authoritative for the <span class="strong strong"><strong>test.example.</strong></span> zone and does not forward the query to the <span class="strong strong"><strong>192.0.2.254.</strong></span> server. As a result, the DNS client receives the <code class="literal">NXDomain</code> error message, informing the user that the queried domain does not exist.
				</p></div></div></section><section class="section" id="using-an-ansible-playbook-to-ensure-that-the-forward-first-policy-is-set-in-idm-dns-global-configuration_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">27.6. Using an Ansible playbook to ensure that the forward first policy is set in IdM DNS global configuration</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that global forwarding policy in IdM DNS is set to <span class="strong strong"><strong>forward first</strong></span>.
			</p><p>
				If you use the <span class="strong strong"><strong>forward first</strong></span> DNS forwarding policy, DNS queries are forwarded to the configured forwarder. If a query fails because of a server error or timeout, BIND falls back to the recursive resolution using servers on the Internet. The forward first policy is the default policy. It is suitable for traffic optimization.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						Your IdM environment contains an integrated DNS server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>set-configuration.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp set-configuration.yml set-forward-policy-to-first.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>set-forward-policy-to-first.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnsconfig</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">forward_policy</code> variable to <span class="strong strong"><strong>first</strong></span>.
							</p><p class="simpara">
								Delete all the other lines of the original playbook that are irrelevant. This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Playbook to set global forwarding policy to first
  hosts: ipaserver
  become: true

  tasks:
  - name: Set global forwarding policy to first.
    ipadnsconfig:
      ipaadmin_password: "{{ ipaadmin_password }}"
      forward_policy: first</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file set-forward-policy-to-first.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.5. DNS forward policies in IdM">DNS forward policies in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						For more sample playbooks, see the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory.
					</li></ul></div></section><section class="section" id="using-an-ansible-playbook-to-ensure-that-global-forwarders-are-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">27.7. Using an Ansible playbook to ensure that global forwarders are disabled in IdM DNS</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that global forwarders are disabled in IdM DNS. The disabling is done by setting the <code class="literal">forward_policy</code> variable to <span class="strong strong"><strong>none</strong></span>.
			</p><p>
				Disabling global forwarders causes DNS queries not to be forwarded. Disabling forwarding is only useful as a zone-specific override for global forwarding configuration. This option is the IdM equivalent of specifying an empty list of forwarders in BIND configuration.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						Your IdM environment contains an integrated DNS server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>disable-global-forwarders.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp disable-global-forwarders.yml disable-global-forwarders-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>disable-global-forwarders-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnsconfig</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">forward_policy</code> variable to <span class="strong strong"><strong>none</strong></span>.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Playbook to disable global DNS forwarders
  hosts: ipaserver
  become: true

  tasks:
  - name: Disable global forwarders.
    ipadnsconfig:
      ipaadmin_password: "{{ ipaadmin_password }}"
      forward_policy: none</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file disable-global-forwarders-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.5. DNS forward policies in IdM">DNS forward policies in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory
					</li></ul></div></section><section class="section" id="using-an-ansible-playbook-to-ensure-that-synchronization-of-forward-and-reverse-lookup-zones-is-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks"><div class="titlepage"><div><div><h3 class="title">27.8. Using an Ansible playbook to ensure that synchronization of forward and reverse lookup zones is disabled in IdM DNS</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that forward and reverse lookup zones are not synchronized in IdM DNS.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						Your IdM environment contains an integrated DNS server.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>disallow-reverse-sync.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp disallow-reverse-sync.yml disallow-reverse-sync-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>disallow-reverse-sync-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnsconfig</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">allow_sync_ptr</code> variable to <span class="strong strong"><strong>no</strong></span>.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Playbook to disallow reverse record synchronization
  hosts: ipaserver
  become: true

  tasks:
  - name: Disallow reverse record synchronization.
    ipadnsconfig:
      ipaadmin_password: "{{ ipaadmin_password }}"
      allow_sync_ptr: no</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file disallow-reverse-sync-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						For more sample playbooks, see the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory.
					</li></ul></div></section></section><section class="chapter" id="using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 28. Using Ansible playbooks to manage IdM DNS zones</h2></div></div></div><p class="_abstract _abstract">
			As Identity Management (IdM) administrator, you can manage how IdM DNS zones work using the <code class="literal">dnszone</code> module available in the <code class="literal">ansible-freeipa</code> package.
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#supported-dns-zone-types_using-ansible-playbooks-to-manage-idm-dns-zones" title="28.1. Supported DNS zone types">What DNS zone types are supported in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones" title="28.2. Configuration attributes of primary IdM DNS zones">What DNS attributes you can configure in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-create-a-primary-zone-in-idm-dns_using-ansible-playbooks-to-manage-idm-dns-zones" title="28.3. Using Ansible to create a primary zone in IdM DNS">How to use an Ansible playbook to create a primary zone in IdM DNS</a>
				</li><li class="listitem">
					<a class="link" href="#using-an-ansible-playbook-to-ensure-the-presence-of-a-primary-dns-zone-in-idm-with-multiple-variables_using-ansible-playbooks-to-manage-idm-dns-zones" title="28.4. Using an Ansible playbook to ensure the presence of a primary DNS zone in IdM with multiple variables">How to use an Ansible playbook to ensure the presence of a primary IdM DNS zone with multiple variables</a>
				</li><li class="listitem">
					<a class="link" href="#using-an-ansible-playbook-to-ensure-the-presence-of-a-zone-for-reverse-dns-lookup-when-an-ip-address-is-given_using-ansible-playbooks-to-manage-idm-dns-zones" title="28.5. Using an Ansible playbook to ensure the presence of a zone for reverse DNS lookup when an IP address is given">How to use an Ansible playbook to ensure the presence of a zone for reverse DNS lookup when an IP address is given</a>
				</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
					DNS service is installed on the IdM server. For more information about how to use Red Hat Ansible Engine to install an IdM server with integrated DNS, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-Identity-Management-server-using-an-Ansible-playbook_installing-identity-management">Installing an Identity Management server using an Ansible playbook</a>.
				</li></ul></div><section class="section" id="supported-dns-zone-types_using-ansible-playbooks-to-manage-idm-dns-zones"><div class="titlepage"><div><div><h3 class="title">28.1. Supported DNS zone types</h3></div></div></div><p class="_abstract _abstract">
				Identity Management (IdM) supports two types of DNS zones: <span class="emphasis"><em>primary</em></span> and <span class="emphasis"><em>forward</em></span> zones. These two types of zones are described here, including an example scenario for DNS forwarding.
			</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					This guide uses the BIND terminology for zone types which is different from the terminology used for Microsoft Windows DNS. Primary zones in BIND serve the same purpose as <span class="emphasis"><em>forward lookup zones</em></span> and <span class="emphasis"><em>reverse lookup zones</em></span> in Microsoft Windows DNS. Forward zones in BIND serve the same purpose as <span class="emphasis"><em>conditional forwarders</em></span> in Microsoft Windows DNS.
				</p></div></rh-alert><div class="variablelist"><dl class="variablelist"><dt><span class="term">Primary DNS zones</span></dt><dd><p class="simpara">
							Primary DNS zones contain authoritative DNS data and can accept dynamic DNS updates. This behavior is equivalent to the <code class="literal option">type master</code> setting in standard BIND configuration. You can manage primary zones using the <code class="literal command">ipa dnszone-*</code> commands.
						</p><p class="simpara">
							In compliance with standard DNS rules, every primary zone must contain <code class="literal">start of authority</code> (SOA) and <code class="literal">nameserver</code> (NS) records. IdM generates these records automatically when the DNS zone is created, but you must copy the NS records manually to the parent zone to create proper delegation.
						</p><p class="simpara">
							In accordance with standard BIND behavior, queries for names for which the server is not authoritative are forwarded to other DNS servers. These DNS servers, so called forwarders, may or may not be authoritative for the query.
						</p><div class="example" id="idm140464215546384"><p class="title"><strong>Example 28.1. Example scenario for DNS forwarding</strong></p><div class="example-contents"><p>
								The IdM server contains the <code class="literal">test.example.</code> primary zone. This zone contains an NS delegation record for the <code class="literal">sub.test.example.</code> name. In addition, the <code class="literal">test.example.</code> zone is configured with the <code class="literal">192.0.2.254</code> forwarder IP address for the <code class="literal">sub.text.example</code> subzone.
							</p><p>
								A client querying the name <code class="literal">nonexistent.test.example.</code> receives the <code class="literal">NXDomain</code> answer, and no forwarding occurs because the IdM server is authoritative for this name.
							</p><p>
								On the other hand, querying for the <code class="literal">host1.sub.test.example.</code> name is forwarded to the configured forwarder <code class="literal">192.0.2.254</code> because the IdM server is not authoritative for this name.
							</p></div></div></dd><dt><span class="term">Forward DNS zones</span></dt><dd><p class="simpara">
							From the perspective of IdM, forward DNS zones do not contain any authoritative data. In fact, a forward "zone" usually only contains two pieces of information:
						</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
									A domain name
								</li><li class="listitem">
									The IP address of a DNS server associated with the domain
								</li></ul></div></dd></dl></div><p>
				All queries for names belonging to the domain defined are forwarded to the specified IP address. This behavior is equivalent to the <code class="literal">type forward</code> setting in standard BIND configuration. You can manage forward zones using the <code class="literal command">ipa dnsforwardzone-*</code> commands.
			</p><p>
				Forward DNS zones are especially useful in the context of IdM-Active Directory (AD) trusts. If the IdM DNS server is authoritative for the <span class="strong strong"><strong>idm.example.com</strong></span> zone and the AD DNS server is authoritative for the <span class="strong strong"><strong>ad.example.com</strong></span> zone, then <span class="strong strong"><strong>ad.example.com</strong></span> is a DNS forward zone for the <span class="strong strong"><strong>idm.example.com</strong></span> primary zone. That means that when a query comes from an IdM client for the IP address of <span class="strong strong"><strong>somehost.ad.example.com</strong></span>, the query is forwarded to an AD domain controller specified in the <span class="strong strong"><strong>ad.example.com</strong></span> IdM DNS forward zone.
			</p></section><section class="section" id="configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones"><div class="titlepage"><div><div><h3 class="title">28.2. Configuration attributes of primary IdM DNS zones</h3></div></div></div><p class="_abstract _abstract">
				Identity Management (IdM) creates a new zone with certain default configuration, such as the refresh periods, transfer settings, or cache settings. In <a class="link" href="#tab_idm-dns-zone-attributes_using-ansible-playbooks-to-manage-idm-dns-zones" title="Table 28.1. IdM DNS zone attributes">IdM DNS zone attributes</a>, you can find the attributes of the default zone configuration that you can modify using one of the following options:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <code class="literal">dnszone-mod</code> command in the command-line interface (CLI). For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#editing-the-configuration-of-a-primary-dns-zone-in-idm-cli_managing-dns-zones-in-idm">Editing the configuration of a primary DNS zone in IdM CLI</a>.
					</li><li class="listitem">
						The IdM Web UI. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#editing-the-configuration-of-a-primary-dns-zone-in-idm-web-ui_managing-dns-zones-in-idm">Editing the configuration of a primary DNS zone in IdM Web UI</a>.
					</li><li class="listitem">
						An Ansible playbook that uses the <code class="literal">ipadnszone</code> module. For more information, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management">Managing DNS zones in IdM</a>.
					</li></ul></div><p>
				Along with setting the actual information for the zone, the settings define how the DNS server handles the <span class="emphasis"><em>start of authority</em></span> (SOA) record entries and how it updates its records from the DNS name server.
			</p><rh-table id="tab_idm-dns-zone-attributes_using-ansible-playbooks-to-manage-idm-dns-zones"><table class="lt-4-cols lt-7-rows"><caption>Table 28.1. IdM DNS zone attributes</caption><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 20%; " class="col_2"><!--Empty--><col style="width: 60%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464214144448" scope="col">Attribute</th><th align="left" valign="top" id="idm140464214143360" scope="col">ansible-freeipa variable</th><th align="left" valign="top" id="idm140464214142304" scope="col">Description</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Authoritative name server
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">name_server</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets the domain name of the primary DNS name server, also known as SOA MNAME.
							</p>
							 <p>
								By default, each IdM server advertises itself in the SOA MNAME field. Consequently, the value stored in LDAP using <code class="literal option">--name-server</code> is ignored.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Administrator e-mail address
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">admin_email</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets the email address to use for the zone administrator. This defaults to the root account on the host.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								SOA serial
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">serial</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets a serial number in the SOA record. Note that IdM sets the version number automatically and users are not expected to modify it.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								SOA refresh
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">refresh</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets the interval, in seconds, for a secondary DNS server to wait before requesting updates from the primary DNS server.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								SOA retry
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">retry</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets the time, in seconds, to wait before retrying a failed refresh operation.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								SOA expire
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">expire</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets the time, in seconds, that a secondary DNS server will try to perform a refresh update before ending the operation attempt.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								SOA minimum
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">minimum</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets the time to live (TTL) value in seconds for negative caching according to <a class="link" href="http://tools.ietf.org/html/rfc2308">RFC 2308</a>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								SOA time to live
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">ttl</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets TTL in seconds for records at zone apex. In zone <code class="literal">example.com</code>, for example, all records (A, NS, or SOA) under name <code class="literal">example.com</code> are configured, but no other domain names, like <code class="literal">test.example.com</code>, are affected.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Default time to live
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">default_ttl</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets the default time to live (TTL) value in seconds for negative caching for all values in a zone that never had an individual TTL value set before. Requires a restart of the <code class="literal">named-pkcs11</code> service on all IdM DNS servers after changes to take effect.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								BIND update policy
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">update_policy</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets the permissions allowed to clients in the DNS zone.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Dynamic update
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">dynamic_update</code>=TRUE|FALSE
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Enables dynamic updates to DNS records for clients.
							</p>
							 <p>
								Note that if this is set to false, IdM client machines will not be able to add or update their IP address.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Allow transfer
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">allow_transfer</code>=<span class="emphasis"><em>string</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Gives a list of IP addresses or network names which are allowed to transfer the given zone, separated by semicolons (;).
							</p>
							 <p>
								Zone transfers are disabled by default. The default <code class="literal option">allow_transfer</code> value is <code class="literal">none</code>.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Allow query
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">allow_query</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Gives a list of IP addresses or network names which are allowed to issue DNS queries, separated by semicolons (;).
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Allow PTR sync
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">allow_sync_ptr</code>=1|0
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Sets whether A or AAAA records (forward records) for the zone will be automatically synchronized with the PTR (reverse) records.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Zone forwarders
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">forwarder</code>=<span class="emphasis"><em>IP_address</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Specifies a forwarder specifically configured for the DNS zone. This is separate from any global forwarders used in the IdM domain.
							</p>
							 <p>
								To specify multiple forwarders, use the option multiple times.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214144448"> <p>
								Forward policy
							</p>
							 </td><td align="left" valign="top" headers="idm140464214143360"> <p>
								<code class="literal option">forward_policy</code>=none|only|first
							</p>
							 </td><td align="left" valign="top" headers="idm140464214142304"> <p>
								Specifies the forward policy. For information about the supported policies, see <a class="link" href="#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.5. DNS forward policies in IdM">DNS forward policies in IdM</a>.
							</p>
							 </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-dnszone.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li></ul></div></section><section class="section" id="using-ansible-to-create-a-primary-zone-in-idm-dns_using-ansible-playbooks-to-manage-idm-dns-zones"><div class="titlepage"><div><div><h3 class="title">28.3. Using Ansible to create a primary zone in IdM DNS</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that a primary DNS zone exists. In the example used in the procedure below, you ensure the presence of the <span class="strong strong"><strong>zone.idm.example.com</strong></span> DNS zone.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnszone</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnszone</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>dnszone-present.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp dnszone-present.yml dnszone-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>dnszone-present-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnszone</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">zone_name</code> variable to <span class="strong strong"><strong>zone.idm.example.com</strong></span>.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Ensure dnszone present
  hosts: ipaserver
  become: true

  tasks:
  - name: Ensure zone is present.
    ipadnszone:
      ipaadmin_password: "{{ ipaadmin_password }}"
      zone_name: zone.idm.example.com
      state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file dnszone-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#supported-dns-zone-types_managing-dns-zones-in-idm">Supported DNS zone types</a>
					</li><li class="listitem">
						The <code class="literal">README-dnszone.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnszone</code> directory
					</li></ul></div></section><section class="section" id="using-an-ansible-playbook-to-ensure-the-presence-of-a-primary-dns-zone-in-idm-with-multiple-variables_using-ansible-playbooks-to-manage-idm-dns-zones"><div class="titlepage"><div><div><h3 class="title">28.4. Using an Ansible playbook to ensure the presence of a primary DNS zone in IdM with multiple variables</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that a primary DNS zone exists. In the example used in the procedure below, an IdM administrator ensures the presence of the <span class="strong strong"><strong>zone.idm.example.com</strong></span> DNS zone. The Ansible playbook configures multiple parameters of the zone.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnszone</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnszone</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>dnszone-all-params.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp dnszone-all-params.yml dnszone-all-params-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>dnszone-all-params-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnszone</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">zone_name</code> variable to <span class="strong strong"><strong>zone.idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">allow_sync_ptr</code> variable to true if you want to allow the synchronization of forward and reverse records, that is the synchronization of A and AAAA records with PTR records.
							</li><li class="listitem">
								Set the <code class="literal">dynamic_update</code> variable to true to enable IdM client machines to add or update their IP addresses.
							</li><li class="listitem">
								Set the <code class="literal">dnssec</code> variable to true to allow inline DNSSEC signing of records in the zone.
							</li><li class="listitem">
								Set the <code class="literal">allow_transfer</code> variable to the IP addresses of secondary name servers in the zone.
							</li><li class="listitem">
								Set the <code class="literal">allow_query</code> variable to the IP addresses or networks that are allowed to issue queries.
							</li><li class="listitem">
								Set the <code class="literal">forwarders</code> variable to the IP addresses of global forwarders.
							</li><li class="listitem">
								Set the <code class="literal">serial</code> variable to the SOA record serial number.
							</li><li class="listitem">
								Define the <code class="literal">refresh</code>, <code class="literal">retry</code>, <code class="literal">expire</code>, <code class="literal">minimum</code>, <code class="literal">ttl</code>, and <code class="literal">default_ttl</code> values for DNS records in the zone.
							</li><li class="listitem">
								Define the NSEC3PARAM record for the zone using the <code class="literal">nsec3param_rec</code> variable.
							</li><li class="listitem">
								Set the <code class="literal">skip_overlap_check</code> variable to true to force DNS creation even if it overlaps with an existing zone.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">skip_nameserver_check</code> to true to force DNS zone creation even if the nameserver is not resolvable.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Ensure dnszone present
  hosts: ipaserver
  become: true

  tasks:
  - name: Ensure zone is present.
    ipadnszone:
      ipaadmin_password: "{{ ipaadmin_password }}"
      zone_name: zone.idm.example.com
      allow_sync_ptr: true
      dynamic_update: true
      dnssec: true
      allow_transfer:
        - 1.1.1.1
        - 2.2.2.2
      allow_query:
        - 1.1.1.1
        - 2.2.2.2
      forwarders:
        - ip_address: 8.8.8.8
        - ip_address: 8.8.4.4
          port: 52
      serial: 1234
      refresh: 3600
      retry: 900
      expire: 1209600
      minimum: 3600
      ttl: 60
      default_ttl: 90
      name_server: server.idm.example.com.
      admin_email: admin.admin@idm.example.com
      nsec3param_rec: "1 7 100 0123456789abcdef"
      skip_overlap_check: true
      skip_nameserver_check: true
      state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file dnszone-all-params-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#supported-dns-zone-types_managing-dns-zones-in-idm">Supported DNS zone types</a>.
					</li><li class="listitem">
						See <a class="link" href="#configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones" title="28.2. Configuration attributes of primary IdM DNS zones">Configuration attributes of primary IdM DNS zones</a>.
					</li><li class="listitem">
						See the <code class="literal">README-dnszone.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnszone</code> directory.
					</li></ul></div></section><section class="section" id="using-an-ansible-playbook-to-ensure-the-presence-of-a-zone-for-reverse-dns-lookup-when-an-ip-address-is-given_using-ansible-playbooks-to-manage-idm-dns-zones"><div class="titlepage"><div><div><h3 class="title">28.5. Using an Ansible playbook to ensure the presence of a zone for reverse DNS lookup when an IP address is given</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that a reverse DNS zone exists. In the example used in the procedure below, an IdM administrator ensures the presence of a reverse DNS lookup zone using the IP address and prefix length of an IdM host.
			</p><p>
				Providing the prefix length of the IP address of your DNS server using the <code class="literal">name_from_ip</code> variable allows you to control the zone name. If you do not state the prefix length, the system queries DNS servers for zones and, based on the <code class="literal">name_from_ip</code> value of <span class="strong strong"><strong>192.168.1.2</strong></span>, the query can return any of the following DNS zones:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						<span class="strong strong"><strong>1.168.192.in-addr.arpa.</strong></span>
					</li><li class="listitem">
						<span class="strong strong"><strong>168.192.in-addr.arpa.</strong></span>
					</li><li class="listitem">
						<span class="strong strong"><strong>192.in-addr.arpa.</strong></span>
					</li></ul></div><p>
				Because the zone returned by the query might not be what you expect, <code class="literal">name_from_ip</code> can only be used with the <code class="literal">state</code> option set to <span class="strong strong"><strong>present</strong></span> to prevent accidental removals of zones.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnszone</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnszone</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>dnszone-reverse-from-ip.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp dnszone-reverse-from-ip.yml dnszone-reverse-from-ip-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>dnszone-reverse-from-ip-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnszone</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">name_from_ip</code> variable to the IP of your IdM nameserver, and provide its prefix length.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p><pre class="literallayout">---
- name: Ensure dnszone present
  hosts: ipaserver
  become: true

  tasks:
  - name: Ensure zone for reverse DNS lookup is present.
    ipadnszone:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name_from_ip: 192.168.1.2/24
      state: present
    register: result
  - name: Display inferred zone name.
    debug:
      msg: "Zone name: {{ result.dnszone.name }}"</pre></li></ul></div><p class="simpara">
						The playbook creates a zone for reverse DNS lookup from the <span class="strong strong"><strong>192.168.1.2</strong></span> IP address and its prefix length of 24. Next, the playbook displays the resulting zone name.
					</p></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file dnszone-reverse-from-ip-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#supported-dns-zone-types_managing-dns-zones-in-idm">Supported DNS zone types</a>
					</li><li class="listitem">
						The <code class="literal">README-dnszone.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						Sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnszone</code> directory
					</li></ul></div></section></section><section class="chapter" id="using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 29. Using Ansible to manage DNS locations in IdM</h2></div></div></div><p class="_abstract _abstract">
			As Identity Management (IdM) administrator, you can manage IdM DNS locations using the <code class="literal">location</code> module available in the <code class="literal">ansible-freeipa</code> package.
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#dns-based-service-discovery_using-ansible-to-manage-dns-locations-in-idm" title="29.1. DNS-based service discovery">DNS-based service discovery</a>
				</li><li class="listitem">
					<a class="link" href="#deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm" title="29.2. Deployment considerations for DNS locations">Deployment considerations for DNS locations</a>
				</li><li class="listitem">
					<a class="link" href="#dns-time-to-live-ttl_using-ansible-to-manage-dns-locations-in-idm" title="29.3. DNS time to live (TTL)">DNS time to live (TTL)</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm" title="29.4. Using Ansible to ensure an IdM location is present">Using Ansible to ensure an IdM location is present</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-ensure-an-idm-location-is-absent_using-ansible-to-manage-dns-locations-in-idm" title="29.5. Using Ansible to ensure an IdM location is absent">Using Ansible to ensure an IdM location is absent</a>
				</li></ul></div><section class="section" id="dns-based-service-discovery_using-ansible-to-manage-dns-locations-in-idm"><div class="titlepage"><div><div><h3 class="title">29.1. DNS-based service discovery</h3></div></div></div><p class="_abstract _abstract">
				DNS-based service discovery is a process in which a client uses the DNS protocol to locate servers in a network that offer a specific service, such as <code class="literal">LDAP</code> or <code class="literal">Kerberos</code>. One typical type of operation is to allow clients to locate authentication servers within the closest network infrastructure, because they provide a higher throughput and lower network latency, lowering overall costs.
			</p><p>
				The major advantages of service discovery are:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						No need for clients to be explicitly configured with names of nearby servers.
					</li><li class="listitem">
						DNS servers are used as central providers of policy. Clients using the same DNS server have access to the same policy about service providers and their preferred order.
					</li></ul></div><p>
				In an Identity Management (IdM) domain, DNS service records (SRV records) exist for <code class="literal">LDAP</code>, <code class="literal">Kerberos</code>, and other services. For example, the following command queries the DNS server for hosts providing a TCP-based <code class="literal">Kerberos</code> service in an IdM DNS domain:
			</p><div class="example" id="idm140464213974752"><p class="title"><strong>Example 29.1. DNS location independent results</strong></p><div class="example-contents"><pre class="literallayout">$ <span class="strong strong"><strong>dig -t SRV +short _kerberos._tcp.idm.example.com</strong></span>
0 100 88 idmserver-01.idm.example.com.
0 100 88 idmserver-02.idm.example.com.</pre><p>
					The output contains the following information:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
							<code class="literal option">0</code> (priority): Priority of the target host. A lower value is preferred.
						</li><li class="listitem">
							<code class="literal option">100</code> (weight). Specifies a relative weight for entries with the same priority. For further information, see <a class="link" href="https://tools.ietf.org/html/rfc2782#page-3">RFC 2782, section 3</a>.
						</li><li class="listitem">
							<code class="literal option">88</code> (port number): Port number of the service.
						</li><li class="listitem">
							Canonical name of the host providing the service.
						</li></ul></div></div></div><p>
				In the example, the two host names returned have the same priority and weight. In this case, the client uses a random entry from the result list.
			</p><p>
				When the client is, instead, configured to query a DNS server that is configured in a DNS location, the output differs. For IdM servers that are assigned to a location, tailored values are returned. In the example below, the client is configured to query a DNS server in the location <code class="literal">germany</code>:
			</p><div class="example" id="idm140464213962096"><p class="title"><strong>Example 29.2. DNS location-based results</strong></p><div class="example-contents"><pre class="literallayout">$ <span class="strong strong"><strong>dig -t SRV +short _kerberos._tcp.idm.example.com</strong></span>
_kerberos._tcp.germany._locations.idm.example.com.
0 100 88 idmserver-01.idm.example.com.
50 100 88 idmserver-02.idm.example.com.</pre></div></div><p>
				The IdM DNS server automatically returns a DNS alias (CNAME) pointing to a DNS location specific SRV record which prefers local servers. This CNAME record is shown in the first line of the output. In the example, the host <span class="strong strong"><strong>idmserver-01.idm.example.com</strong></span> has the lowest priority value and is therefore preferred. The <span class="strong strong"><strong>idmserver-02.idm.example.com</strong></span> has a higher priority and thus is used only as backup for cases when the preferred host is unavailable.
			</p></section><section class="section" id="deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm"><div class="titlepage"><div><div><h3 class="title">29.2. Deployment considerations for DNS locations</h3></div></div></div><p class="_abstract _abstract">
				Identity Management (IdM) can generate location-specific service (SRV) records when using the integrated DNS. Because each IdM DNS server generates location-specific SRV records, you have to install at least one IdM DNS server in each DNS location.
			</p><p>
				The client’s affinity to a DNS location is only defined by the DNS records received by the client. For this reason, you can combine IdM DNS servers with non-IdM DNS consumer servers and recursors if the clients doing DNS service discovery resolve location-specific records from IdM DNS servers.
			</p><p>
				In the majority of deployments with mixed IdM and non-IdM DNS services, DNS recursors select the closest IdM DNS server automatically by using round-trip time metrics. Typically, this ensures that clients using non-IdM DNS servers are getting records for the nearest DNS location and thus use the optimal set of IdM servers.
			</p></section><section class="section" id="dns-time-to-live-ttl_using-ansible-to-manage-dns-locations-in-idm"><div class="titlepage"><div><div><h3 class="title">29.3. DNS time to live (TTL)</h3></div></div></div><p class="_abstract _abstract">
				Clients can cache DNS resource records for an amount of time that is set in the zone’s configuration. Because of this caching, a client might not be able to receive the changes until the time to live (TTL) value expires. The default TTL value in Identity Management (IdM) is <code class="literal">1 day</code>.
			</p><p>
				If your client computers roam between sites, you should adapt the TTL value for your IdM DNS zone. Set the value to a lower value than the time clients need to roam between sites. This ensures that cached DNS entries on the client expire before they reconnect to another site and thus query the DNS server to refresh location-specific SRV records.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_working-with-dns-in-identity-management#configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones">Configuration attributes of primary IdM DNS zones</a>
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm"><div class="titlepage"><div><div><h3 class="title">29.4. Using Ansible to ensure an IdM location is present</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can configure IdM DNS locations to allow clients to locate authentication servers within the closest network infrastructure.
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure a DNS location is present in IdM. The example describes how to ensure that the <span class="strong strong"><strong>germany</strong></span> DNS location is present in IdM. As a result, you can assign particular IdM servers to this location so that local IdM clients can use them to reduce server response time.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You understand the <a class="link" href="#deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm" title="29.2. Deployment considerations for DNS locations">deployment considerations for DNS locations</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">location-present.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/location/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/location/location-present.yml location-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">location-present-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipalocation</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the location.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: location present example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure that the "germany" location is present</strong></span>
    ipalocation:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: germany</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory location-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-locations-in-idm_working-with-dns-in-identity-management#assigning-an-idm-server-to-a-dns-location-using-the-idm-web-ui_managing-dns-locations-in-idm">Assigning an IdM server to a DNS location using the IdM Web UI</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-locations-in-idm_working-with-dns-in-identity-management#assigning-an-idm-server-to-a-dns-location-using-the-idm-cli_managing-dns-locations-in-idm">Assigning an IdM server to a DNS location using the IdM CLI</a>
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-an-idm-location-is-absent_using-ansible-to-manage-dns-locations-in-idm"><div class="titlepage"><div><div><h3 class="title">29.5. Using Ansible to ensure an IdM location is absent</h3></div></div></div><p class="_abstract _abstract">
				As a system administrator of Identity Management (IdM), you can configure IdM DNS locations to allow clients to locate authentication servers within the closest network infrastructure.
			</p><p>
				The following procedure describes how to use an Ansible playbook to ensure that a DNS location is absent in IdM. The example describes how to ensure that the <span class="strong strong"><strong>germany</strong></span> DNS location is absent in IdM. As a result, you cannot assign particular IdM servers to this location and local IdM clients cannot use them.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						No IdM server is assigned to the <span class="strong strong"><strong>germany</strong></span> DNS location.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						The example assumes that you have <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">created and configured</a> the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory as a central location to store copies of sample playbooks.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">location-absent.yml</code> file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/location/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/location/location-absent.yml location-absent-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">location-absent-copy.yml</code> Ansible playbook file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipalocation</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Adapt the <code class="literal">name</code> of the task to correspond to your use case.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM administrator.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to the name of the DNS location.
							</li><li class="listitem">
								Make sure that the <code class="literal">state</code> variable is set to <code class="literal">absent</code>.
							</li></ul></div><p class="simpara">
						This is the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: location absent example
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - <span class="strong strong"><strong>name: Ensure that the "germany" location is absent</strong></span>
    ipalocation:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: germany</strong></span>
      <span class="strong strong"><strong>state: absent</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory location-absent-copy.yml</strong></span></pre></li></ol></div></section><section class="section _additional-resources" id="additional_resources_8"><div class="titlepage"><div><div><h3 class="title">29.6. Additional resources</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						See the <code class="literal">README-location.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/location</code> directory.
					</li></ul></div></section></section><section class="chapter" id="managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 30. Managing DNS forwarding in IdM</h2></div></div></div><p class="_abstract _abstract">
			Follow these procedures to configure DNS global forwarders and DNS forward zones in the Identity Management (IdM) Web UI, the IdM CLI, and using Ansible:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#the-two-roles-of-an-idm-dns-server_managing-dns-forwarding-in-idm" title="30.1. The two roles of an IdM DNS server">The two roles of an IdM DNS server</a>
				</li><li class="listitem">
					<a class="link" href="#dns-forward-policies-in-idm_managing-dns-forwarding-in-idm" title="30.2. DNS forward policies in IdM">DNS forward policies in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#adding-a-global-forwarder-in-the-idm-web-ui_managing-dns-forwarding-in-idm" title="30.3. Adding a global forwarder in the IdM Web UI">Adding a global forwarder in the IdM Web UI</a>
				</li><li class="listitem">
					<a class="link" href="#adding-a-global-forwarder-in-the-cli_managing-dns-forwarding-in-idm" title="30.4. Adding a global forwarder in the CLI">Adding a global forwarder in the CLI</a>
				</li><li class="listitem">
					<a class="link" href="#adding-a-dns-forward-zone-in-the-idm-web-ui_managing-dns-forwarding-in-idm" title="30.5. Adding a DNS Forward Zone in the IdM Web UI">Adding a DNS Forward Zone in the IdM Web UI</a>
				</li><li class="listitem">
					<a class="link" href="#adding-a-dns-forward-zone-in-the-cli_managing-dns-forwarding-in-idm" title="30.6. Adding a DNS Forward Zone in the CLI">Adding a DNS Forward Zone in the CLI</a>
				</li><li class="listitem">
					<a class="link" href="#establishing-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" title="30.7. Establishing a DNS Global Forwarder in IdM using Ansible">Establishing a DNS Global Forwarder in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" title="30.8. Ensuring the presence of a DNS global forwarder in IdM using Ansible">Ensuring the presence of a DNS global forwarder in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm" title="30.9. Ensuring the absence of a DNS global forwarder in IdM using Ansible">Ensuring the absence of a DNS global forwarder in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-dns-global-forwarders-are-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm" title="30.10. Ensuring DNS Global Forwarders are disabled in IdM using Ansible">Ensuring DNS Global Forwarders are disabled in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm" title="30.11. Ensuring the presence of a DNS Forward Zone in IdM using Ansible">Ensuring the presence of a DNS Forward Zone in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-a-dns-forward-zone-has-multiple-forwarders-in-idm-using-ansible_managing-dns-forwarding-in-idm" title="30.12. Ensuring a DNS Forward Zone has multiple forwarders in IdM using Ansible">Ensuring a DNS Forward Zone has multiple forwarders in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-a-dns-forward-zone-is-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm" title="30.13. Ensuring a DNS Forward Zone is disabled in IdM using Ansible">Ensuring a DNS Forward Zone is disabled in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-absence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm" title="30.14. Ensuring the absence of a DNS Forward Zone in IdM using Ansible">Ensuring the absence of a DNS Forward Zone in IdM using Ansible</a>
				</li></ul></div><section class="section" id="the-two-roles-of-an-idm-dns-server_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.1. The two roles of an IdM DNS server</h3></div></div></div><p class="_abstract _abstract">
				DNS forwarding affects how a DNS service answers DNS queries. By default, the Berkeley Internet Name Domain (BIND) service integrated with IdM acts as both an <span class="emphasis"><em>authoritative</em></span> and a <span class="emphasis"><em>recursive</em></span> DNS server:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Authoritative DNS server</span></dt><dd>
							When a DNS client queries a name belonging to a DNS zone for which the IdM server is authoritative, BIND replies with data contained in the configured zone. Authoritative data always takes precedence over any other data.
						</dd><dt><span class="term">Recursive DNS server</span></dt><dd>
							When a DNS client queries a name for which the IdM server is not authoritative, BIND attempts to resolve the query using other DNS servers. If forwarders are not defined, BIND asks the root servers on the Internet and uses a recursive resolution algorithm to answer the DNS query.
						</dd></dl></div><p>
				In some cases, it is not desirable to let BIND contact other DNS servers directly and perform the recursion based on data available on the Internet. You can configure BIND to use another DNS server, a <span class="emphasis"><em>forwarder</em></span>, to resolve the query.
			</p><p>
				When you configure BIND to use a forwarder, queries and answers are forwarded back and forth between the IdM server and the forwarder, and the IdM server acts as the DNS cache for non-authoritative data.
			</p></section><section class="section" id="dns-forward-policies-in-idm_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.2. DNS forward policies in IdM</h3></div></div></div><p class="_abstract _abstract">
				IdM supports the <code class="literal">first</code> and <code class="literal">only</code> standard BIND forward policies, as well as the <code class="literal">none</code> IdM-specific forward policy.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Forward first <span class="emphasis"><em>(default)</em></span></span></dt><dd>
							The IdM BIND service forwards DNS queries to the configured forwarder. If a query fails because of a server error or timeout, BIND falls back to the recursive resolution using servers on the Internet. The <code class="literal">forward first</code> policy is the default policy, and it is suitable for optimizing DNS traffic.
						</dd><dt><span class="term">Forward only</span></dt><dd>
							The IdM BIND service forwards DNS queries to the configured forwarder. If a query fails because of a server error or timeout, BIND returns an error to the client. The <code class="literal">forward only</code> policy is recommended for environments with split DNS configuration.
						</dd><dt><span class="term">None <span class="emphasis"><em>(forwarding disabled)</em></span></span></dt><dd>
							DNS queries are not forwarded with the <code class="literal">none</code> forwarding policy. Disabling forwarding is only useful as a zone-specific override for global forwarding configuration. This option is the IdM equivalent of specifying an empty list of forwarders in BIND configuration.
						</dd></dl></div><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
					You cannot use forwarding to combine data in IdM with data from other DNS servers. You can only forward queries for specific subzones of the primary zone in IdM DNS.
				</p><p>
					By default, the BIND service does not forward queries to another server if the queried DNS name belongs to a zone for which the IdM server is authoritative. In such a situation, if the queried DNS name cannot be found in the IdM database, the <code class="literal">NXDOMAIN</code> answer is returned. Forwarding is not used.
				</p></div></rh-alert><div class="example" id="idm140464212100368"><p class="title"><strong>Example 30.1. Example Scenario</strong></p><div class="example-contents"><p>
					The IdM server is authoritative for the <span class="strong strong"><strong>test.example.</strong></span> DNS zone. BIND is configured to forward queries to the DNS server with the <span class="strong strong"><strong>192.0.2.254</strong></span> IP address.
				</p><p>
					When a client sends a query for the <span class="strong strong"><strong>nonexistent.test.example.</strong></span> DNS name, BIND detects that the IdM server is authoritative for the <span class="strong strong"><strong>test.example.</strong></span> zone and does not forward the query to the <span class="strong strong"><strong>192.0.2.254.</strong></span> server. As a result, the DNS client receives the <code class="literal">NXDomain</code> error message, informing the user that the queried domain does not exist.
				</p></div></div></section><section class="section" id="adding-a-global-forwarder-in-the-idm-web-ui_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.3. Adding a global forwarder in the IdM Web UI</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to add a global DNS forwarder in the Identity Management (IdM) Web UI.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in to the IdM WebUI as IdM administrator.
					</li><li class="listitem">
						You know the Internet Protocol (IP) address of the DNS server to forward queries to.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the IdM Web UI, select <code class="literal">Network Services</code> → <code class="literal">DNS Global Configuration</code> → <code class="literal">DNS</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/0672144496a40ee794aee64884827619/idm-dns-global-add1.png" alt="Selecting DNS Forward Zones from the DNS menu"></div></div></li><li class="listitem"><p class="simpara">
						In the <code class="literal">DNS Global Configuration</code> section, click <code class="literal">Add</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/5821348c67bda05b3fa201fe4c2056a8/idm-dns-global-add2.png" alt="Selecting the Add button"></div></div></li><li class="listitem"><p class="simpara">
						Specify the IP address of the DNS server that will receive forwarded DNS queries.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/661adad2f2da35fb1932817eaa627133/idm-dns-global-add3.png" alt="Entering the IP address of the global forwarder"></div></div></li><li class="listitem"><p class="simpara">
						Select the <code class="literal">Forward policy</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/5be40c86c82d7e08ae20a483530331ff/idm-dns-global-add4.png" alt="Selecting the DNS forward policy and saving the DNS global configuration"></div></div></li><li class="listitem">
						Click <code class="literal">Save</code> at the top of the window.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Select <code class="literal">Network Services</code> → <code class="literal">DNS Global Configuration</code> → <code class="literal">DNS</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/0672144496a40ee794aee64884827619/idm-dns-global-add1.png" alt="Selecting DNS Global Configuration in IdM Web UI"></div></div></li><li class="listitem"><p class="simpara">
						Verify that the global forwarder, with the forward policy you specified, is present and enabled in the IdM Web UI.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/671900ea29ba18303502fabeb5b6d555/idm-dns-global-add5.png" alt="Verifying the presence of the global forwarder"></div></div></li></ol></div></section><section class="section" id="adding-a-global-forwarder-in-the-cli_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.4. Adding a global forwarder in the CLI</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to add a global DNS forwarder by using the command line interface (CLI).
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as IdM administrator.
					</li><li class="listitem">
						You know the Internet Protocol (IP) address of the DNS server to forward queries to.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Use the <code class="literal">ipa dnsconfig-mod</code> command to add a new global forwarder. Specify the IP address of the DNS forwarder with the <code class="literal">--forwarder</code> option.
					</p><pre class="literallayout">[user@server ~]$ <span class="strong strong"><strong>ipa dnsconfig-mod --forwarder=<span class="emphasis"><em>10.10.0.1</em></span></strong></span>
Server will check DNS forwarder(s).
This may take some time, please wait ...
  Global forwarders: 10.10.0.1
  IPA DNS servers: server.example.com</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Use the <code class="literal">dnsconfig-show</code> command to display global forwarders.
					</p><pre class="literallayout">[user@server ~]$ ipa dnsconfig-show
  Global forwarders: 10.10.0.1
  IPA DNS servers: server.example.com</pre></li></ul></div></section><section class="section" id="adding-a-dns-forward-zone-in-the-idm-web-ui_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.5. Adding a DNS Forward Zone in the IdM Web UI</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to add a DNS forward zone in the Identity Management (IdM) Web UI.
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Do not use forward zones unless absolutely required. Forward zones are not a standard solution, and using them can lead to unexpected and problematic behavior. If you must use forward zones, limit their use to overriding a global forwarding configuration.
				</p><p>
					When creating a new DNS zone, Red Hat recommends to always use standard DNS delegation using nameserver (NS) records and to avoid forward zones. In most cases, using a global forwarder is sufficient, and forward zones are not necessary.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in to the IdM WebUI as IdM administrator.
					</li><li class="listitem">
						You know the Internet Protocol (IP) address of the DNS server to forward queries to.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the IdM Web UI, select <code class="literal">Network Services</code> → <code class="literal">DNS Forward Zones</code> → <code class="literal">DNS</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/8896b7e7ce96e74061098a3bbb9c8baa/idm-dns-forwardzone-add1.png" alt="Selecting DNS Forward Zones from the DNS menu"></div></div></li><li class="listitem"><p class="simpara">
						In the <code class="literal">DNS Forward Zones</code> section, click <code class="literal">Add</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/05f367791e031e11169faea727afcbbd/idm-dns-forwardzone-add2.png" alt="Selecting the Add button"></div></div></li><li class="listitem"><p class="simpara">
						In the <code class="literal">Add DNS forward zone</code> window, specify the forward zone name.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/e352a1fa831ab52e34d871f4076bf662/idm-dns-forwardzone-add3.png" alt="Entering the name of the new Forward Zone"></div></div></li><li class="listitem"><p class="simpara">
						Click the <code class="literal">Add</code> button and specify the IP address of a DNS server to receive the forwarding request. You can specify multiple forwarders per forward zone.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/e6f321514d42dfb7fa11ffc3d76a2c85/idm-dns-forwardzone-add4.png" alt="Specifying the IP address of the forwarder DNS server"></div></div></li><li class="listitem"><p class="simpara">
						Select the <code class="literal">Forward policy</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/a202dd8a63b1d2365e21cfa8d2712945/idm-dns-forwardzone-add5.png" alt="Choosing a Forward policy"></div></div></li><li class="listitem">
						Click <code class="literal">Add</code> at the bottom of the window to add the new forward zone.
					</li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						In the IdM Web UI, select <code class="literal">Network Services</code> → <code class="literal">DNS Forward Zones</code> → <code class="literal">DNS</code>.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/8896b7e7ce96e74061098a3bbb9c8baa/idm-dns-forwardzone-add1.png" alt="Selecting DNS Forward Zones from the DNS menu"></div></div></li><li class="listitem"><p class="simpara">
						Verify that the forward zone you created, with the forwarders and forward policy you specified, is present and enabled in the IdM Web UI.
					</p><div class="informalfigure"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/b05d65e2bbceb4a464b4e47477e61220/idm-dns-forwardzone-add6.png" alt="Verifying the new forward zone is present"></div></div></li></ol></div></section><section class="section" id="adding-a-dns-forward-zone-in-the-cli_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.6. Adding a DNS Forward Zone in the CLI</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to add a DNS forward zone by using the command line interface (CLI).
			</p><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
					Do not use forward zones unless absolutely required. Forward zones are not a standard solution, and using them can lead to unexpected and problematic behavior. If you must use forward zones, limit their use to overriding a global forwarding configuration.
				</p><p>
					When creating a new DNS zone, Red Hat recommends to always use standard DNS delegation using nameserver (NS) records and to avoid forward zones. In most cases, using a global forwarder is sufficient, and forward zones are not necessary.
				</p></div></rh-alert><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You are logged in as IdM administrator.
					</li><li class="listitem">
						You know the Internet Protocol (IP) address of the DNS server to forward queries to.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Procedure</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Use the <code class="literal">dnsforwardzone-add</code> command to add a new forward zone. Specify at least one forwarder with the <code class="literal">--forwarder</code> option if the forward policy is not <code class="literal">none</code>, and specify the forward policy with the <code class="literal">--forward-policy</code> option.
					</p><pre class="literallayout">[user@server ~]$ <span class="strong strong"><strong>ipa dnsforwardzone-add <span class="emphasis"><em>forward.example.com.</em></span> --forwarder=<span class="emphasis"><em>10.10.0.14</em></span> --forwarder=<span class="emphasis"><em>10.10.1.15</em></span> --forward-policy=first</strong></span>

Zone name: forward.example.com.
Zone forwarders: 10.10.0.14, 10.10.1.15
Forward policy: first</pre></li></ul></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Use the <code class="literal">dnsforwardzone-show</code> command to display the DNS forward zone you just created.
					</p><pre class="literallayout">[user@server ~]$ <span class="strong strong"><strong>ipa dnsforwardzone-show <span class="emphasis"><em>forward.example.com.</em></span></strong></span>

Zone name: forward.example.com.
Zone forwarders: 10.10.0.14, 10.10.1.15
Forward policy: first</pre></li></ul></div></section><section class="section" id="establishing-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.7. Establishing a DNS Global Forwarder in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to establish a DNS Global Forwarder in IdM.
			</p><p>
				In the example procedure below, the IdM administrator creates a DNS global forwarder to a DNS server with an Internet Protocol (IP) v4 address of <code class="literal">8.8.6.6</code> and IPv6 address of <code class="literal">2001:4860:4860::8800</code> on port <code class="literal">53</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">set-configuration.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp set-configuration.yml establish-global-forwarder.yml</pre></li><li class="listitem">
						Open the <code class="literal">establish-global-forwarder.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to establish a global forwarder in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Create a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">forwarders</code> section of the <code class="literal">ipadnsconfig</code> portion:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Change the first <code class="literal">ip_address</code> value to the IPv4 address of the global forwarder: <code class="literal">8.8.6.6</code>.
									</li><li class="listitem">
										Change the second <code class="literal">ip_address</code> value to the IPv6 address of the global forwarder: <code class="literal">2001:4860:4860::8800</code>.
									</li><li class="listitem">
										Verify the <code class="literal">port</code> value is set to <code class="literal">53</code>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Change the <code class="literal">forward_policy</code> to <code class="literal">first</code>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ol></div><pre class="literallayout">---
- name: Playbook to establish a global forwarder in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Create a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800
    ipadnsconfig:
      forwarders:
        - ip_address: 8.8.6.6
        - ip_address: 2001:4860:4860::8800
          port: 53
      forward_policy: first
      allow_sync_ptr: true</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file establish-global-forwarder.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.8. Ensuring the presence of a DNS global forwarder in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure the presence of a DNS global forwarder in IdM. In the example procedure below, the IdM administrator ensures the presence of a DNS global forwarder to a DNS server with an Internet Protocol (IP) v4 address of <code class="literal">7.7.9.9</code> and IP v6 address of <code class="literal">2001:db8::1:0</code> on port <code class="literal">53</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">forwarders-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp forwarders-absent.yml ensure-presence-of-a-global-forwarder.yml</pre></li><li class="listitem">
						Open the <code class="literal">ensure-presence-of-a-global-forwarder.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to ensure the presence of a global forwarder in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Ensure the presence of a DNS global forwarder to 7.7.9.9 and 2001:db8::1:0 on port 53</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">forwarders</code> section of the <code class="literal">ipadnsconfig</code> portion:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Change the first <code class="literal">ip_address</code> value to the IPv4 address of the global forwarder: <code class="literal">7.7.9.9</code>.
									</li><li class="listitem">
										Change the second <code class="literal">ip_address</code> value to the IPv6 address of the global forwarder: <code class="literal">2001:db8::1:0</code>.
									</li><li class="listitem">
										Verify the <code class="literal">port</code> value is set to <code class="literal">53</code>.
									</li></ol></div></li><li class="listitem"><p class="simpara">
								Change the <code class="literal">state</code> to <code class="literal">present</code>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ol></div><pre class="literallayout">---
- name: Playbook to ensure the presence of a global forwarder in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure the presence of a DNS global forwarder to 7.7.9.9 and 2001:db8::1:0 on port 53
    ipadnsconfig:
      forwarders:
        - ip_address: 7.7.9.9
        - ip_address: 2001:db8::1:0
          port: 53
      state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-of-a-global-forwarder.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li></ul></div></section><section class="section" id="ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.9. Ensuring the absence of a DNS global forwarder in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure the absence of a DNS global forwarder in IdM. In the example procedure below, the IdM administrator ensures the absence of a DNS global forwarder with an Internet Protocol (IP) v4 address of <code class="literal">8.8.6.6</code> and IP v6 address of <code class="literal">2001:4860:4860::8800</code> on port <code class="literal">53</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">forwarders-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp forwarders-absent.yml ensure-absence-of-a-global-forwarder.yml</pre></li><li class="listitem">
						Open the <code class="literal">ensure-absence-of-a-global-forwarder.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to ensure the absence of a global forwarder in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Ensure the absence of a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800 on port 53</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">forwarders</code> section of the <code class="literal">ipadnsconfig</code> portion:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Change the first <code class="literal">ip_address</code> value to the IPv4 address of the global forwarder: <code class="literal">8.8.6.6</code>.
									</li><li class="listitem">
										Change the second <code class="literal">ip_address</code> value to the IPv6 address of the global forwarder: <code class="literal">2001:4860:4860::8800</code>.
									</li><li class="listitem">
										Verify the <code class="literal">port</code> value is set to <code class="literal">53</code>.
									</li></ol></div></li><li class="listitem">
								Set the <code class="literal">action</code> variable to <code class="literal">member</code>.
							</li><li class="listitem">
								Verify the <code class="literal">state</code> is set to <code class="literal">absent</code>.
							</li></ol></div><p class="simpara">
						This the modified Ansible playbook file for the current example:
					</p><pre class="literallayout">---
- name: Playbook to ensure the absence of a global forwarder in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure the absence of a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800 on port 53
    ipadnsconfig:
      forwarders:
        - ip_address: 8.8.6.6
        - ip_address: 2001:4860:4860::8800
          port: 53
      action: member
      state: absent</pre><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
							If you only use the <code class="literal">state: absent</code> option in your playbook without also using <code class="literal">action: member</code>, the playbook fails.
						</p></div></rh-alert></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-absence-of-a-global-forwarder.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						<a class="link" href="#the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks" title="27.4. The action: member option in ipadnsconfig ansible-freeipa modules">The <code class="literal">action: member</code> option in ipadnsconfig ansible-freeipa modules</a>
					</li></ul></div></section><section class="section" id="ensuring-dns-global-forwarders-are-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.10. Ensuring DNS Global Forwarders are disabled in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure DNS Global Forwarders are disabled in IdM. In the example procedure below, the IdM administrator ensures that the forwarding policy for the global forwarder is set to <code class="literal">none</code>, which effectively disables the global forwarder.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Verify the contents of the <code class="literal">disable-global-forwarders.yml</code> Ansible playbook file which is already configured to disable all DNS global forwarders. For example:
					</p><pre class="literallayout">$ cat disable-global-forwarders.yml
---
- name: Playbook to disable global DNS forwarders
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Disable global forwarders.
    ipadnsconfig:
      forward_policy: none</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file disable-global-forwarders.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <code class="literal">README-dnsconfig.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.11. Ensuring the presence of a DNS Forward Zone in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure the presence of a DNS Forward Zone in IdM. In the example procedure below, the IdM administrator ensures the presence of a DNS forward zone for <code class="literal">example.com</code> to a DNS server with an Internet Protocol (IP) address of <code class="literal">8.8.8.8</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">forwarders-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp forwarders-absent.yml ensure-presence-forwardzone.yml</pre></li><li class="listitem">
						Open the <code class="literal">ensure-presence-forwardzone.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to ensure the presence of a dnsforwardzone in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Ensure presence of a dnsforwardzone for example.com to 8.8.8.8</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">ipadnsconfig</code> heading to <code class="literal">ipadnsforwardzone</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">ipadnsforwardzone</code> section:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Add the <code class="literal">ipaadmin_password</code> variable and set it to your IdM administrator password.
									</li><li class="listitem">
										Add the <code class="literal">name</code> variable and set it to <code class="literal">example.com</code>.
									</li><li class="listitem"><p class="simpara">
										In the <code class="literal">forwarders</code> section:
									</p><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem">
												Remove the <code class="literal">ip_address</code> and <code class="literal">port</code> lines.
											</li><li class="listitem"><p class="simpara">
												Add the IP address of the DNS server to receive forwarded requests by specifying it after a dash:
											</p><pre class="literallayout"><code class="literal">- 8.8.8.8</code></pre></li></ol></div></li><li class="listitem">
										Add the <code class="literal">forwardpolicy</code> variable and set it to <code class="literal">first</code>.
									</li><li class="listitem">
										Add the <code class="literal">skip_overlap_check</code> variable and set it to <code class="literal">true</code>.
									</li><li class="listitem">
										Change the <code class="literal">state</code> variable to <code class="literal">present</code>.
									</li></ol></div><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ol></div><pre class="literallayout">---
- name: Playbook to ensure the presence of a dnsforwardzone in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure the presence of a dnsforwardzone for example.com to 8.8.8.8
  ipadnsforwardzone:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: example.com
      forwarders:
          - 8.8.8.8
      forwardpolicy: first
      skip_overlap_check: true
      state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-forwardzone.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-dnsforwardzone.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li></ul></div></section><section class="section" id="ensuring-a-dns-forward-zone-has-multiple-forwarders-in-idm-using-ansible_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.12. Ensuring a DNS Forward Zone has multiple forwarders in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure a DNS Forward Zone in IdM has multiple forwarders. In the example procedure below, the IdM administrator ensures the DNS forward zone for <code class="literal">example.com</code> is forwarding to <code class="literal">8.8.8.8</code> and <code class="literal">4.4.4.4</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">forwarders-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp forwarders-absent.yml ensure-presence-multiple-forwarders.yml</pre></li><li class="listitem">
						Open the <code class="literal">ensure-presence-multiple-forwarders.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to ensure the presence of multiple forwarders in a dnsforwardzone in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Ensure presence of 8.8.8.8 and 4.4.4.4 forwarders in dnsforwardzone for example.com</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">ipadnsconfig</code> heading to <code class="literal">ipadnsforwardzone</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">ipadnsforwardzone</code> section:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Add the <code class="literal">ipaadmin_password</code> variable and set it to your IdM administrator password.
									</li><li class="listitem">
										Add the <code class="literal">name</code> variable and set it to <code class="literal">example.com</code>.
									</li><li class="listitem"><p class="simpara">
										In the <code class="literal">forwarders</code> section:
									</p><div class="orderedlist"><ol class="orderedlist" type="A"><li class="listitem">
												Remove the <code class="literal">ip_address</code> and <code class="literal">port</code> lines.
											</li><li class="listitem"><p class="simpara">
												Add the IP address of the DNS servers you want to ensure are present, preceded by a dash:
											</p><pre class="literallayout">- 8.8.8.8
- 4.4.4.4</pre></li></ol></div></li><li class="listitem">
										Change the state variable to present.
									</li></ol></div><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ol></div><pre class="literallayout">---
- name: name: Playbook to ensure the presence of multiple forwarders in a dnsforwardzone in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure presence of 8.8.8.8 and 4.4.4.4 forwarders in dnsforwardzone for example.com
  ipadnsforwardzone:
      ipaadmin_password: "{{ ipaadmin_password }}"
     name: example.com
      forwarders:
          - 8.8.8.8
          - 4.4.4.4
      state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-multiple-forwarders.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-dnsforwardzone.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li></ul></div></section><section class="section" id="ensuring-a-dns-forward-zone-is-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.13. Ensuring a DNS Forward Zone is disabled in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure a DNS Forward Zone is disabled in IdM. In the example procedure below, the IdM administrator ensures the DNS forward zone for <code class="literal">example.com</code> is disabled.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">forwarders-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp forwarders-absent.yml ensure-disabled-forwardzone.yml</pre></li><li class="listitem">
						Open the <code class="literal">ensure-disabled-forwardzone.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to ensure a dnsforwardzone is disabled in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Ensure a dnsforwardzone for example.com is disabled</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">ipadnsconfig</code> heading to <code class="literal">ipadnsforwardzone</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">ipadnsforwardzone</code> section:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Add the <code class="literal">ipaadmin_password</code> variable and set it to your IdM administrator password.
									</li><li class="listitem">
										Add the <code class="literal">name</code> variable and set it to <code class="literal">example.com</code>.
									</li><li class="listitem">
										Remove the entire <code class="literal">forwarders</code> section.
									</li><li class="listitem">
										Change the <code class="literal">state</code> variable to <code class="literal">disabled</code>.
									</li></ol></div><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ol></div><pre class="literallayout">---
- name: Playbook to ensure a dnsforwardzone is disabled in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure a dnsforwardzone for example.com is disabled
  ipadnsforwardzone:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: example.com
      state: disabled</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-disabled-forwardzone.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-dnsforwardzone.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li></ul></div></section><section class="section" id="ensuring-the-absence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm"><div class="titlepage"><div><div><h3 class="title">30.14. Ensuring the absence of a DNS Forward Zone in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure the absence of a DNS Forward Zone in IdM. In the example procedure below, the IdM administrator ensures the absence of a DNS forward zone for <code class="literal">example.com</code>.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig</code> directory:
					</p><pre class="literallayout">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig</pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and make sure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <code class="literal">server.idm.example.com</code>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <code class="literal">forwarders-absent.yml</code> Ansible playbook file. For example:
					</p><pre class="literallayout">$ cp forwarders-absent.yml ensure-absence-forwardzone.yml</pre></li><li class="listitem">
						Open the <code class="literal">ensure-absence-forwardzone.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								Change the <code class="literal">name</code> variable for the playbook to <code class="literal">Playbook to ensure the absence of a dnsforwardzone in IdM DNS</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">name</code> of the task to <code class="literal">Ensure the absence of a dnsforwardzone for example.com</code>.
							</li><li class="listitem">
								In the <code class="literal">tasks</code> section, change the <code class="literal">ipadnsconfig</code> heading to <code class="literal">ipadnsforwardzone</code>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">ipadnsforwardzone</code> section:
							</p><div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
										Add the <code class="literal">ipaadmin_password</code> variable and set it to your IdM administrator password.
									</li><li class="listitem">
										Add the <code class="literal">name</code> variable and set it to <code class="literal">example.com</code>.
									</li><li class="listitem">
										Remove the entire <code class="literal">forwarders</code> section.
									</li><li class="listitem">
										Leave the <code class="literal">state</code> variable as <code class="literal">absent</code>.
									</li></ol></div><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ol></div><pre class="literallayout">---
- name: Playbook to ensure the absence of a dnsforwardzone in IdM DNS
  hosts: ipaserver

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure the absence of a dnsforwardzone for example.com
    ipadnsforwardzone:
       ipaadmin_password: "{{ ipaadmin_password }}"
       name: example.com
       state: absent</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-absence-forwardzone.yml</pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-dnsforwardzone.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li></ul></div></section></section><section class="chapter" id="using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 31. Using Ansible to manage DNS records in IdM</h2></div></div></div><p class="_abstract _abstract">
			This chapter describes how to manage DNS records in Identity Management (IdM) using an Ansible playbook. As an IdM administrator, you can add, modify, and delete DNS records in IdM. The chapter contains the following sections:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-a-and-aaaa-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" title="31.3. Ensuring the presence of A and AAAA DNS records in IdM using Ansible">Ensuring the presence of A and AAAA DNS records in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-a-and-ptr-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" title="31.4. Ensuring the presence of A and PTR DNS records in IdM using Ansible">Ensuring the presence of A and PTR DNS records in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-multiple-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" title="31.5. Ensuring the presence of multiple DNS records in IdM using Ansible">Ensuring the presence of multiple DNS records in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-multiple-cname-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" title="31.6. Ensuring the presence of multiple CNAME records in IdM using Ansible">Ensuring the presence of multiple CNAME records in IdM using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#ensuring-the-presence-of-an-srv-record-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm" title="31.7. Ensuring the presence of an SRV record in IdM using Ansible">Ensuring the presence of an SRV record in IdM using Ansible</a>
				</li></ul></div><section class="section" id="dns-records-in-idm_using-ansible-to-manage-dns-records-in-idm"><div class="titlepage"><div><div><h3 class="title">31.1. DNS records in IdM</h3></div></div></div><p class="_abstract _abstract">
				Identity Management (IdM) supports many different DNS record types. The following four are used most frequently:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">A</span></dt><dd><p class="simpara">
							This is a basic map for a host name and an IPv4 address. The record name of an A record is a host name, such as <code class="literal">www</code>. The <code class="literal">IP Address</code> value of an A record is an IPv4 address, such as <code class="literal">192.0.2.1</code>.
						</p><p class="simpara">
							For more information about A records, see <a class="link" href="http://tools.ietf.org/html/rfc1035">RFC 1035</a>.
						</p></dd><dt><span class="term">AAAA</span></dt><dd><p class="simpara">
							This is a basic map for a host name and an IPv6 address. The record name of an AAAA record is a host name, such as <code class="literal">www</code>. The <code class="literal">IP Address</code> value is an IPv6 address, such as <code class="literal">2001:DB8::1111</code>.
						</p><p class="simpara">
							For more information about AAAA records, see <a class="link" href="http://tools.ietf.org/html/rfc3596">RFC 3596</a>.
						</p></dd><dt><span class="term">SRV</span></dt><dd><p class="simpara">
							<span class="emphasis"><em>Service (SRV) resource records</em></span> map service names to the DNS name of the server that is providing that particular service. For example, this record type can map a service like an LDAP directory to the server which manages it.
						</p><p class="simpara">
							The record name of an SRV record has the format <code class="literal"><span class="emphasis"><em>_service</em></span>.<span class="emphasis"><em>_protocol</em></span></code>, such as <code class="literal">_ldap._tcp</code>. The configuration options for SRV records include priority, weight, port number, and host name for the target service.
						</p><p class="simpara">
							For more information about SRV records, see <a class="link" href="http://tools.ietf.org/html/rfc2782">RFC 2782</a>.
						</p></dd><dt><span class="term">PTR</span></dt><dd><p class="simpara">
							A pointer record (PTR) adds a reverse DNS record, which maps an IP address to a domain name.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								All reverse DNS lookups for IPv4 addresses use reverse entries that are defined in the <code class="literal">in-addr.arpa.</code> domain. The reverse address, in human-readable form, is the exact reverse of the regular IP address, with the <code class="literal">in-addr.arpa.</code> domain appended to it. For example, for the network address <code class="literal">192.0.2.0/24</code>, the reverse zone is <code class="literal">2.0.192.in-addr.arpa</code>.
							</p></div></rh-alert><p class="simpara">
							The record name of a PTR must be in the standard format specified in <a class="link" href="http://tools.ietf.org/html/rfc1035#section-3.5">RFC 1035</a>, extended in <a class="link" href="http://tools.ietf.org/html/rfc2317">RFC 2317</a>, and <a class="link" href="https://tools.ietf.org/html/rfc3596#section-2.5">RFC 3596</a>. The host name value must be a canonical host name of the host for which you want to create the record.
						</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
								Reverse zones can also be configured for IPv6 addresses, with zones in the <code class="literal command">.ip6.arpa.</code> domain. For more information about IPv6 reverse zones, see <a class="link" href="http://www.ietf.org/rfc/rfc3596.txt">RFC 3596</a>.
							</p></div></rh-alert></dd></dl></div><p>
				When adding DNS resource records, note that many of the records require different data. For example, a CNAME record requires a host name, while an A record requires an IP address. In the IdM Web UI, the fields in the form for adding a new record are updated automatically to reflect what data is required for the currently selected type of record.
			</p></section><section class="section" id="common-ipa-dnsrecord-options_using-ansible-to-manage-dns-records-in-idm"><div class="titlepage"><div><div><h3 class="title">31.2. Common ipa dnsrecord-* options</h3></div></div></div><p class="_abstract _abstract">
				You can use the following options when adding, modifying and deleting the most common DNS resource record types in Identity Management (IdM):
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A (IPv4)
					</li><li class="listitem">
						AAAA (IPv6)
					</li><li class="listitem">
						SRV
					</li><li class="listitem">
						PTR
					</li></ul></div><p>
				In <code class="literal">Bash</code>, you can define multiple entries by listing the values in a comma-separated list inside curly braces, such as <code class="literal option">--⁠option={val1,val2,val3}</code>.
			</p><rh-table id="tab-common-ipa-dnsrecord-add-options_using-ansible-to-manage-dns-records-in-idm"><table class="lt-4-cols lt-7-rows"><caption>Table 31.1. General Record Options</caption><colgroup><col style="width: 50%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464224058144" scope="col"><span class="emphasis"><em>Option</em></span></th><th align="left" valign="top" id="idm140464224056896" scope="col"><span class="emphasis"><em>Description</em></span></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464224058144"> <p>
								<code class="literal option">--ttl</code>=<span class="emphasis"><em>number</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464224056896"> <p>
								Sets the time to live for the record.
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464224058144"> <p>
								<code class="literal option">--structured</code>
							</p>
							 </td><td align="left" valign="top" headers="idm140464224056896"> <p>
								Parses the raw DNS records and returns them in a structured format.
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140464224045248"><table class="lt-4-cols lt-7-rows"><caption>Table 31.2. "A" record options</caption><colgroup><col style="width: 17%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464224039488" scope="col"><span class="emphasis"><em>Option</em></span></th><th align="left" valign="top" id="idm140464224038240" scope="col"><span class="emphasis"><em>Description</em></span></th><th align="left" valign="top" id="idm140464224036992" scope="col"><span class="emphasis"><em>Examples</em></span></th></tr></thead><tbody><tr><td rowspan="2" align="left" valign="top" headers="idm140464224039488"> <p>
								<code class="literal option">--a-rec</code>=<span class="emphasis"><em>ARECORD</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464224038240"> <p>
								Passes a single A record or a list of A records.
							</p>
							 </td><td align="left" valign="top" headers="idm140464224036992"> <p>
								<code class="literal">ipa dnsrecord-add idm.example.com host1 --a-rec=192.168.122.123</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464224038240"> <p>
								Can create a wildcard A record with a given IP address.
							</p>
							 </td><td align="left" valign="top" headers="idm140464224036992"> <p>
								<code class="literal">ipa dnsrecord-add idm.example.com "*" --a-rec=192.168.122.123</code> <a href="#ftn.idm140464224024032" class="footnote"><sup class="footnote" id="idm140464224024032">[a]</sup></a>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464224039488"> <p>
								<code class="literal option">--a-ip-address</code>=<span class="emphasis"><em>string</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464224038240"> <p>
								Gives the IP address for the record. When creating a record, the option to specify the <code class="literal">A</code> record value is <code class="literal">--a-rec</code>. However, when modifying an <code class="literal">A</code> record, the <code class="literal">--a-rec</code> option is used to specify the current value for the <code class="literal">A</code> record. The new value is set with the <code class="literal">--a-ip-address</code> option.
							</p>
							 </td><td align="left" valign="top" headers="idm140464224036992"> <p>
								<code class="literal">ipa dnsrecord-mod idm.example.com --a-rec 192.168.122.123 --a-ip-address 192.168.122.124</code>
							</p>
							 </td></tr></tbody><tbody class="footnotes"><tr><td colspan="3"><div id="ftn.idm140464224024032" class="footnote"><div class="para"><a href="#idm140464224024032" class="simpara"><sup class="simpara">[a] </sup></a>
									The example creates a wildcard <code class="literal">A</code> record with the IP address of 192.0.2.123.
								</div></div></td></tr></tbody></table></rh-table><rh-table id="idm140464224011536"><table class="lt-4-cols lt-7-rows"><caption>Table 31.3. "AAAA" record options</caption><colgroup><col style="width: 17%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464224005776" scope="col"><span class="emphasis"><em>Option</em></span></th><th align="left" valign="top" id="idm140464224004528" scope="col"><span class="emphasis"><em>Description</em></span></th><th align="left" valign="top" id="idm140464224003280" scope="col"><span class="emphasis"><em>Example</em></span></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464224005776"> <p>
								<code class="literal option">--aaaa-rec</code>=<span class="emphasis"><em>AAAARECORD</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464224004528"> <p>
								Passes a single AAAA (IPv6) record or a list of AAAA records.
							</p>
							 </td><td align="left" valign="top" headers="idm140464224003280"> <p>
								<code class="literal">ipa dnsrecord-add idm.example.com www --aaaa-rec 2001:db8::1231:5675</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464224005776"> <p>
								<code class="literal option">--aaaa-ip-address</code>=<span class="emphasis"><em>string</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464224004528"> <p>
								Gives the IPv6 address for the record. When creating a record, the option to specify the <code class="literal">A</code> record value is <code class="literal">--aaaa-rec</code>. However, when modifying an <code class="literal">A</code> record, the <code class="literal">--aaaa-rec</code> option is used to specify the current value for the <code class="literal">A</code> record. The new value is set with the <code class="literal">--a-ip-address</code> option.
							</p>
							 </td><td align="left" valign="top" headers="idm140464224003280"> <p>
								<code class="literal">ipa dnsrecord-mod idm.example.com --aaaa-rec 2001:db8::1231:5675 --aaaa-ip-address 2001:db8::1231:5676</code>
							</p>
							 </td></tr></tbody></table></rh-table><rh-table id="idm140464223983840"><table class="lt-4-cols lt-7-rows"><caption>Table 31.4. "PTR" record options</caption><colgroup><col style="width: 17%; " class="col_1"><!--Empty--><col style="width: 50%; " class="col_2"><!--Empty--><col style="width: 33%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464214822832" scope="col"><span class="emphasis"><em>Option</em></span></th><th align="left" valign="top" id="idm140464214821584" scope="col"><span class="emphasis"><em>Description</em></span></th><th align="left" valign="top" id="idm140464214820336" scope="col"><span class="emphasis"><em>Example</em></span></th></tr></thead><tbody><tr><td rowspan="2" align="left" valign="top" headers="idm140464214822832"> <p>
								<code class="literal option">--ptr-rec</code>=<span class="emphasis"><em>PTRRECORD</em></span>
							</p>
							 </td><td rowspan="2" align="left" valign="top" headers="idm140464214821584"> <p>
								Passes a single PTR record or a list of PTR records. When adding the reverse DNS record, the zone name used with the <code class="literal">ipa dnsrecord-add</code> command is reversed, compared to the usage for adding other DNS records. Typically, the host IP address is the last octet of the IP address in a given network. The first example on the right adds a PTR record for <span class="strong strong"><strong>server4.idm.example.com</strong></span> with IPv4 address <span class="strong strong"><strong>192.168.122.4.</strong></span> The second example adds a reverse DNS entry to the <span class="strong strong"><strong>0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa.</strong></span> IPv6 reverse zone for the host <span class="strong strong"><strong>server2.example.com</strong></span> with the IP address <span class="strong strong"><strong>2001:DB8::1111</strong></span>.
							</p>
							 </td><td align="left" valign="top" headers="idm140464214820336"> <p>
								<code class="literal">ipa dnsrecord-add 122.168.192.in-addr.arpa 4 --ptr-rec server4.idm.example.com.</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214820336"> <p>
								<code class="literal">$ ipa dnsrecord-add 0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa. 1.1.1.0.0.0.0.0.0.0.0.0.0.0.0 --ptr-rec server2.idm.example.com.</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214822832"> <p>
								<code class="literal option">--ptr-hostname</code>=<span class="emphasis"><em>string</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214821584"> <p>
								Gives the host name for the record.
							</p>
							 </td><td align="left" valign="top" headers="idm140464214820336"> </td></tr></tbody></table></rh-table><rh-table id="idm140464214797168"><table class="lt-4-cols lt-7-rows"><caption>Table 31.5. "SRV" Record Options</caption><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 40%; " class="col_2"><!--Empty--><col style="width: 40%; " class="col_3"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464214791408" scope="col"><span class="emphasis"><em>Option</em></span></th><th align="left" valign="top" id="idm140464214790160" scope="col"><span class="emphasis"><em>Description</em></span></th><th align="left" valign="top" id="idm140464214788912" scope="col"><span class="emphasis"><em>Example</em></span></th></tr></thead><tbody><tr><td rowspan="2" align="left" valign="top" headers="idm140464214791408"> <p>
								<code class="literal option">--srv-rec</code>=<span class="emphasis"><em>SRVRECORD</em></span>
							</p>
							 </td><td rowspan="2" align="left" valign="top" headers="idm140464214790160"> <p>
								Passes a single SRV record or a list of SRV records. In the examples on the right, <span class="strong strong"><strong>_ldap._tcp</strong></span> defines the service type and the connection protocol for the SRV record. The <code class="literal">--srv-rec</code> option defines the priority, weight, port, and target values. The weight values of 51 and 49 in the examples add up to 100 and represent the probability, in percentages, that a particular record is used.
							</p>
							 </td><td align="left" valign="top" headers="idm140464214788912"> <p>
								<code class="literal"># ipa dnsrecord-add idm.example.com _ldap._tcp --srv-rec="0 51 389 server1.idm.example.com."</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214788912"> <p>
								<code class="literal"># ipa dnsrecord-add server.idm.example.com _ldap._tcp --srv-rec="1 49 389 server2.idm.example.com."</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214791408"> <p>
								<code class="literal option">--srv-priority</code>=<span class="emphasis"><em>number</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214790160"> <p>
								Sets the priority of the record. There can be multiple SRV records for a service type. The priority (0 - 65535) sets the rank of the record; the lower the number, the higher the priority. A service has to use the record with the highest priority first.
							</p>
							 </td><td align="left" valign="top" headers="idm140464214788912"> <p>
								<code class="literal"># ipa dnsrecord-mod server.idm.example.com _ldap._tcp --srv-rec="1 49 389 server2.idm.example.com." --srv-priority=0</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214791408"> <p>
								<code class="literal option">--srv-weight</code>=<span class="emphasis"><em>number</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214790160"> <p>
								Sets the weight of the record. This helps determine the order of SRV records with the same priority. The set weights should add up to 100, representing the probability (in percentages) that a particular record is used.
							</p>
							 </td><td align="left" valign="top" headers="idm140464214788912"> <p>
								<code class="literal"># ipa dnsrecord-mod server.idm.example.com _ldap._tcp --srv-rec="0 49 389 server2.idm.example.com." --srv-weight=60</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214791408"> <p>
								<code class="literal option">--srv-port</code>=<span class="emphasis"><em>number</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214790160"> <p>
								Gives the port for the service on the target host.
							</p>
							 </td><td align="left" valign="top" headers="idm140464214788912"> <p>
								<code class="literal"># ipa dnsrecord-mod server.idm.example.com _ldap._tcp --srv-rec="0 60 389 server2.idm.example.com." --srv-port=636</code>
							</p>
							 </td></tr><tr><td align="left" valign="top" headers="idm140464214791408"> <p>
								<code class="literal option">--srv-target</code>=<span class="emphasis"><em>string</em></span>
							</p>
							 </td><td align="left" valign="top" headers="idm140464214790160"> <p>
								Gives the domain name of the target host. This can be a single period (.) if the service is not available in the domain.
							</p>
							 </td><td align="left" valign="top" headers="idm140464214788912"> </td></tr></tbody></table></rh-table><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						Run <code class="literal command">ipa dnsrecord-add --help</code>.
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-a-and-aaaa-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm"><div class="titlepage"><div><div><h3 class="title">31.3. Ensuring the presence of A and AAAA DNS records in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that A and AAAA records for a particular IdM host are present. In the example used in the procedure below, an IdM administrator ensures the presence of A and AAAA records for <span class="strong strong"><strong>host1</strong></span> in the <span class="strong strong"><strong>idm.example.com</strong></span> DNS zone.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>idm.example.com</strong></span> zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_working-with-dns-in-identity-management">Using Ansible playbooks to manage IdM DNS zones</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>ensure-A-and-AAAA-records-are-present.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp ensure-A-and-AAAA-records-are-present.yml ensure-A-and-AAAA-records-are-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>ensure-A-and-AAAA-records-are-present-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnsrecord</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">zone_name</code> variable to <span class="strong strong"><strong>idm.example.com</strong></span>.
							</li><li class="listitem">
								In the <code class="literal">records</code> variable, set the <code class="literal">name</code> variable to <span class="strong strong"><strong>host1</strong></span>, and the <code class="literal">a_ip_address</code> variable to <span class="strong strong"><strong>192.168.122.123</strong></span>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">records</code> variable, set the <code class="literal">name</code> variable to <span class="strong strong"><strong>host1</strong></span>, and the <code class="literal">aaaa_ip_address</code> variable to <span class="strong strong"><strong>::1</strong></span>.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Ensure A and AAAA records are present
  hosts: ipaserver
  become: true
  gather_facts: false

  tasks:
  # Ensure A and AAAA records are present
  - name: Ensure that 'host1' has A and AAAA records.
    ipadnsrecord:
      ipaadmin_password: "{{ ipaadmin_password }}"
      zone_name: idm.example.com
      records:
      - name: host1
        a_ip_address: 192.168.122.123
      - name: host1
        aaaa_ip_address: ::1</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-A-and-AAAA-records-are-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-to-manage-dns-records-in-idm_working-with-dns-in-identity-management#dns-records-in-idm_using-ansible-to-manage-dns-records-in-idm">DNS records in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-dnsrecord.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-a-and-ptr-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm"><div class="titlepage"><div><div><h3 class="title">31.4. Ensuring the presence of A and PTR DNS records in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that an A record for a particular IdM host is present, with a corresponding PTR record. In the example used in the procedure below, an IdM administrator ensures the presence of A and PTR records for <span class="strong strong"><strong>host1</strong></span> with an IP address of <span class="strong strong"><strong>192.168.122.45</strong></span> in the <span class="strong strong"><strong>idm.example.com</strong></span> zone.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>idm.example.com</strong></span> DNS zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_working-with-dns-in-identity-management">Using Ansible playbooks to manage IdM DNS zones</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>ensure-dnsrecord-with-reverse-is-present.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp ensure-dnsrecord-with-reverse-is-present.yml ensure-dnsrecord-with-reverse-is-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>ensure-dnsrecord-with-reverse-is-present-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnsrecord</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>host1</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">zone_name</code> variable to <span class="strong strong"><strong>idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">ip_address</code> variable to <span class="strong strong"><strong>192.168.122.45</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">create_reverse</code> variable to <span class="strong strong"><strong>true</strong></span>.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Ensure DNS Record is present.
  hosts: ipaserver
  become: true
  gather_facts: false

  tasks:
  # Ensure that dns record is present
  - ipadnsrecord:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: host1
      zone_name: idm.example.com
      ip_address: 192.168.122.45
      create_reverse: true
      state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-dnsrecord-with-reverse-is-present-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#dns-records-in-idm_managing-dns-records-in-idm">DNS records in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-dnsrecord.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-multiple-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm"><div class="titlepage"><div><div><h3 class="title">31.5. Ensuring the presence of multiple DNS records in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				Follow this procedure to use an Ansible playbook to ensure that multiple values are associated with a particular IdM DNS record. In the example used in the procedure below, an IdM administrator ensures the presence of multiple A records for <span class="strong strong"><strong>host1</strong></span> in the <span class="strong strong"><strong>idm.example.com</strong></span> DNS zone.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>idm.example.com</strong></span> zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see <a class="link" href="#using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management" title="Chapter 28. Using Ansible playbooks to manage IdM DNS zones">Using Ansible playbooks to manage IdM DNS zones</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>ensure-presence-multiple-records.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp ensure-presence-multiple-records.yml ensure-presence-multiple-records-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>ensure-presence-multiple-records-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnsrecord</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								In the <code class="literal">records</code> section, set the <code class="literal">name</code> variable to <span class="strong strong"><strong>host1</strong></span>.
							</li><li class="listitem">
								In the <code class="literal">records</code> section, set the <code class="literal">zone_name</code> variable to <span class="strong strong"><strong>idm.example.com</strong></span>.
							</li><li class="listitem">
								In the <code class="literal">records</code> section, set the <code class="literal">a_rec</code> variable to <span class="strong strong"><strong>192.168.122.112</strong></span> and to <span class="strong strong"><strong>192.168.122.122</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Define a second record in the <code class="literal">records</code> section:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>host1</strong></span>.
									</li><li class="listitem">
										Set the <code class="literal">zone_name</code> variable to <span class="strong strong"><strong>idm.example.com</strong></span>.
									</li><li class="listitem">
										Set the <code class="literal">aaaa_rec</code> variable to <span class="strong strong"><strong>::1</strong></span>.
									</li></ul></div><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Test multiple DNS Records are present.
  hosts: ipaserver
  become: true
  gather_facts: false

  tasks:
  # Ensure that multiple dns records are present
  - ipadnsrecord:
      ipaadmin_password: "{{ ipaadmin_password }}"
      records:
        - name: host1
          zone_name: idm.example.com
          a_rec: 192.168.122.112
          a_rec: 192.168.122.122
        - name: host1
          zone_name: idm.example.com
          aaaa_rec: ::1</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-multiple-records-copy.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#dns-records-in-idm_managing-dns-records-in-idm">DNS records in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-dnsrecord.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-multiple-cname-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm"><div class="titlepage"><div><div><h3 class="title">31.6. Ensuring the presence of multiple CNAME records in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				A Canonical Name record (CNAME record) is a type of resource record in the Domain Name System (DNS) that maps one domain name, an alias, to another name, the canonical name.
			</p><p>
				You may find CNAME records useful when running multiple services from a single IP address: for example, an FTP service and a web service, each running on a different port.
			</p><p>
				Follow this procedure to use an Ansible playbook to ensure that multiple CNAME records are present in IdM DNS. In the example used in the procedure below, <span class="strong strong"><strong>host03</strong></span> is both an HTTP server and an FTP server. The IdM administrator ensures the presence of the <span class="strong strong"><strong>www</strong></span> and <span class="strong strong"><strong>ftp</strong></span> CNAME records for the <span class="strong strong"><strong>host03</strong></span> A record in the <span class="strong strong"><strong>idm.example.com</strong></span> zone.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>idm.example.com</strong></span> zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see <a class="link" href="#using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management" title="Chapter 28. Using Ansible playbooks to manage IdM DNS zones">Using Ansible playbooks to manage IdM DNS zones</a>.
					</li><li class="listitem">
						The <span class="strong strong"><strong>host03</strong></span> A record exists in the <span class="strong strong"><strong>idm.example.com</strong></span> zone.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>ensure-CNAME-record-is-present.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp ensure-CNAME-record-is-present.yml ensure-CNAME-record-is-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>ensure-CNAME-record-is-present-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnsrecord</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Optional: Adapt the description provided by the <code class="literal">name</code> of the play.
							</li><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">zone_name</code> variable to <span class="strong strong"><strong>idm.example.com</strong></span>.
							</li><li class="listitem"><p class="simpara">
								In the <code class="literal">records</code> variable section, set the following variables and values:
							</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
										Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>www</strong></span>.
									</li><li class="listitem">
										Set the <code class="literal">cname_hostname</code> variable to <span class="strong strong"><strong>host03</strong></span>.
									</li><li class="listitem">
										Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>ftp</strong></span>.
									</li><li class="listitem">
										Set the <code class="literal">cname_hostname</code> variable to <span class="strong strong"><strong>host03</strong></span>.
									</li></ul></div><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Ensure that 'www.idm.example.com' and 'ftp.idm.example.com' CNAME records point to 'host03.idm.example.com'.
  hosts: ipaserver
  become: true
  gather_facts: false

  tasks:
  - ipadnsrecord:
      ipaadmin_password: "{{ ipaadmin_password }}"
      zone_name: idm.example.com
      records:
      - name: www
        cname_hostname: host03
      - name: ftp
        cname_hostname: host03</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-CNAME-record-is-present.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						See the <code class="literal">README-dnsrecord.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory.
					</li><li class="listitem">
						See sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory.
					</li></ul></div></section><section class="section" id="ensuring-the-presence-of-an-srv-record-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm"><div class="titlepage"><div><div><h3 class="title">31.7. Ensuring the presence of an SRV record in IdM using Ansible</h3></div></div></div><p class="_abstract _abstract">
				A DNS service (SRV) record defines the hostname, port number, transport protocol, priority and weight of a service available in a domain. In Identity Management (IdM), you can use SRV records to locate IdM servers and replicas.
			</p><p>
				Follow this procedure to use an Ansible playbook to ensure that an SRV record is present in IdM DNS. In the example used in the procedure below, an IdM administrator ensures the presence of the <span class="strong strong"><strong>_kerberos._udp.idm.example.com</strong></span> SRV record with the value of <span class="strong strong"><strong>10 50 88 idm.example.com</strong></span>. This sets the following values:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						It sets the priority of the service to 10.
					</li><li class="listitem">
						It sets the weight of the service to 50.
					</li><li class="listitem">
						It sets the port to be used by the service to 88.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li><li class="listitem">
						You know the IdM administrator password.
					</li><li class="listitem">
						The <span class="strong strong"><strong>idm.example.com</strong></span> zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_working-with-dns-in-identity-management">Using Ansible playbooks to manage IdM DNS zones</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Navigate to the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord</strong></span></pre></li><li class="listitem"><p class="simpara">
						Open your inventory file and ensure that the IdM server that you want to configure is listed in the <code class="literal">[ipaserver]</code> section. For example, to instruct Ansible to configure <span class="strong strong"><strong>server.idm.example.com</strong></span>, enter:
					</p><pre class="literallayout">[ipaserver]
server.idm.example.com</pre></li><li class="listitem"><p class="simpara">
						Make a copy of the <span class="strong strong"><strong>ensure-SRV-record-is-present.yml</strong></span> Ansible playbook file. For example:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp ensure-SRV-record-is-present.yml ensure-SRV-record-is-present-copy.yml</strong></span></pre></li><li class="listitem">
						Open the <span class="strong strong"><strong>ensure-SRV-record-is-present-copy.yml</strong></span> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipadnsrecord</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to your IdM administrator password.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>_kerberos._udp.idm.example.com</strong></span>.
							</li><li class="listitem">
								Set the <code class="literal">srv_rec</code> variable to <span class="strong strong"><strong>'10 50 88 idm.example.com'</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Set the <code class="literal">zone_name</code> variable to <span class="strong strong"><strong>idm.example.com</strong></span>.
							</p><p class="simpara">
								This the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Test multiple DNS Records are present.
  hosts: ipaserver
  become: true
  gather_facts: false

  tasks:
  # Ensure a SRV record is present
  - ipadnsrecord:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: _kerberos._udp.idm.example.com
      srv_rec: ’10 50 88 idm.example.com’
      zone_name: idm.example.com
      state: present</pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-SRV-record-is-present.yml</strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#dns-records-in-idm_managing-dns-records-in-idm">DNS records in IdM</a>
					</li><li class="listitem">
						The <code class="literal">README-dnsrecord.md</code> file in the <code class="literal">/usr/share/doc/ansible-freeipa/</code> directory
					</li><li class="listitem">
						Sample Ansible playbooks in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord</code> directory
					</li></ul></div></section></section><section class="chapter" id="using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 32. Using Ansible to automount NFS shares for IdM users</h2></div></div></div><p class="_abstract _abstract">
			Automount is a way to manage, organize, and access directories across multiple systems. Automount automatically mounts a directory whenever access to it is requested. This works well within an Identity Management (IdM) domain as it allows you to share directories on clients within the domain easily.
		</p><p>
			You can use Ansible to configure NFS shares to be mounted automatically for IdM users logged in to IdM clients in an IdM location.
		</p><p>
			The example in this chapter uses the following scenario:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<span class="strong strong"><strong>nfs-server.idm.example.com</strong></span> is the fully-qualified domain name (FQDN) of a Network File System (NFS) server.
				</li><li class="listitem">
					<span class="strong strong"><strong>nfs-server.idm.example.com</strong></span> is an IdM client located in the <span class="strong strong"><strong>raleigh</strong></span> automount location.
				</li><li class="listitem">
					The NFS server exports the <span class="strong strong"><strong>/exports/project</strong></span> directory as read-write.
				</li><li class="listitem">
					Any IdM user belonging to the <span class="strong strong"><strong>developers</strong></span> group can access the contents of the exported directory as <span class="strong strong"><strong>/devel/project/</strong></span> on any IdM client that is located in the same <span class="strong strong"><strong>raleigh</strong></span> automount location as the NFS server.
				</li><li class="listitem">
					<span class="strong strong"><strong>idm-client.idm.example.com</strong></span> is an IdM client located in the <span class="strong strong"><strong>raleigh</strong></span> automount location.
				</li></ul></div><rh-alert class="admonition important" state="warning"><div class="admonition_header" slot="header">Important</div><div><p>
				If you want to use a Samba server instead of an NFS server to provide the shares for IdM clients, see the <a class="link" href="https://access.redhat.com/solutions/6596071">How do I configure kerberized CIFS mounts with Autofs in an IPA environment?</a> KCS solution.
			</p></div></rh-alert><p>
			 
		</p><p>
			The chapter contains the following sections:
		</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
					<a class="link" href="#autofs-and-automount-in-idm_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.1. Autofs and automount in IdM">Autofs and automount in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.2. Setting up an NFS server with Kerberos in a Red Hat Identity Management domain">Setting up an NFS server with Kerberos in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.3. Configuring automount locations, maps, and keys in IdM by using Ansible">Configuring automount locations, maps, and keys in IdM by using Ansible</a>
				</li><li class="listitem">
					<a class="link" href="#using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.4. Using Ansible to add IdM users to a group that owns NFS shares">Using Ansible to add IdM users to a group that owns NFS shares</a>
				</li><li class="listitem">
					<a class="link" href="#configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.5. Configuring automount on an IdM client">Configuring automount on an IdM client</a>
				</li><li class="listitem">
					<a class="link" href="#verifying-that-an-idm-user-can-access-nfs-shares-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.6. Verifying that an IdM user can access NFS shares on an IdM client">Verifying that an IdM user can access NFS shares on an IdM client</a>
				</li></ol></div><section class="section" id="autofs-and-automount-in-idm_using-ansible-to-automount-nfs-shares-for-idm-users"><div class="titlepage"><div><div><h3 class="title">32.1. Autofs and automount in IdM</h3></div></div></div><p class="_abstract _abstract">
				The <code class="literal">autofs</code> service automates the mounting of directories, as needed, by directing the <code class="literal">automount</code> daemon to mount directories when they are accessed. In addition, after a period of inactivity, <code class="literal">autofs</code> directs <code class="literal">automount</code> to unmount auto-mounted directories. Unlike static mounting, on-demand mounting saves system resources.
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">Automount maps</span></dt><dd><p class="simpara">
							On a system that utilizes <code class="literal">autofs</code>, the <code class="literal">automount</code> configuration is stored in several different files. The primary <code class="literal">automount</code> configuration file is <code class="literal">/etc/auto.master</code>, which contains the master mapping of <code class="literal">automount</code> mount points, and their associated resources, on a system. This mapping is known as <span class="emphasis"><em>automount maps</em></span>.
						</p><p class="simpara">
							The <code class="literal">/etc/auto.master</code> configuration file contains the <span class="emphasis"><em>master map</em></span>. It can contain references to other maps. These maps can either be direct or indirect. Direct maps use absolute path names for their mount points, while indirect maps use relative path names.
						</p></dd><dt><span class="term">Automount configuration in IdM</span></dt><dd><p class="simpara">
							While <code class="literal">automount</code> typically retrieves its map data from the local <code class="literal">/etc/auto.master</code> and associated files, it can also retrieve map data from other sources. One common source is an LDAP server. In the context of Identity Management (IdM), this is a 389 Directory Server.
						</p><p class="simpara">
							If a system that uses <code class="literal">autofs</code> is a client in an IdM domain, the <code class="literal">automount</code> configuration is not stored in local configuration files. Instead, the <code class="literal">autofs</code> configuration, such as maps, locations, and keys, is stored as LDAP entries in the IdM directory. For example, for the <code class="literal">idm.example.com</code> IdM domain, the default <span class="emphasis"><em>master map</em></span> is stored as follows:
						</p><pre class="literallayout">dn:
automountmapname=auto.master,cn=default,cn=automount,dc=idm,dc=example,dc=com
objectClass: automountMap
objectClass: top
automountMapName: auto.master</pre></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_file_systems/mounting-file-systems-on-demand_managing-file-systems">Mounting file systems on demand</a>
					</li></ul></div></section><section class="section" id="setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users"><div class="titlepage"><div><div><h3 class="title">32.2. Setting up an NFS server with Kerberos in a Red Hat Identity Management domain</h3></div></div></div><p class="_abstract _abstract">
				If you use Red Hat Identity Management (IdM), you can join your NFS server to the IdM domain. This enables you to centrally manage users and groups and to use Kerberos for authentication, integrity protection, and traffic encryption.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						The NFS server is <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_installing-an-idm-client_installing-identity-management">enrolled</a> in a Red Hat Identity Management (IdM) domain.
					</li><li class="listitem">
						The NFS server is running and configured.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Obtain a kerberos ticket as an IdM administrator:
					</p><pre class="literallayout"># <span class="strong strong"><strong>kinit admin</strong></span></pre></li><li class="listitem"><p class="simpara">
						Create a <code class="literal">nfs/&lt;FQDN&gt;</code> service principal:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa service-add <span class="emphasis"><em>nfs/nfs_server.idm.example.com</em></span></strong></span></pre></li><li class="listitem"><p class="simpara">
						Retrieve the <code class="literal">nfs</code> service principal from IdM, and store it in the <code class="literal">/etc/krb5.keytab</code> file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-getkeytab -s <span class="emphasis"><em>idm_server.idm.example.com</em></span> -p <span class="emphasis"><em>nfs/nfs_server.idm.example.com</em></span> -k /etc/krb5.keytab</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: Display the principals in the <code class="literal">/etc/krb5.keytab</code> file:
					</p><pre class="literallayout"># <span class="strong strong"><strong>klist -k /etc/krb5.keytab</strong></span>
Keytab name: FILE:/etc/krb5.keytab
KVNO Principal
---- --------------------------------------------------------------------------
   1 nfs/nfs_server.idm.example.com@IDM.EXAMPLE.COM
   1 nfs/nfs_server.idm.example.com@IDM.EXAMPLE.COM
   1 nfs/nfs_server.idm.example.com@IDM.EXAMPLE.COM
   1 nfs/nfs_server.idm.example.com@IDM.EXAMPLE.COM
   7 host/nfs_server.idm.example.com@IDM.EXAMPLE.COM
   7 host/nfs_server.idm.example.com@IDM.EXAMPLE.COM
   7 host/nfs_server.idm.example.com@IDM.EXAMPLE.COM
   7 host/nfs_server.idm.example.com@IDM.EXAMPLE.COM</pre><p class="simpara">
						By default, the IdM client adds the host principal to the <code class="literal">/etc/krb5.keytab</code> file when you join the host to the IdM domain. If the host principal is missing, use the <code class="literal"><span class="strong strong"><strong>ipa-getkeytab -s</strong></span> <span class="emphasis"><em>idm_server.idm.example.com</em></span> <span class="strong strong"><strong>-p</strong></span> <span class="emphasis"><em>host/nfs_server.idm.example.com</em></span> <span class="strong strong"><strong>-k /etc/krb5.keytab</strong></span></code> command to add it.
					</p></li><li class="listitem"><p class="simpara">
						Use the <code class="literal">ipa-client-automount</code> utility to configure mapping of IdM IDs:
					</p><pre class="literallayout">#  <span class="strong strong"><strong>ipa-client-automount</strong></span>
Searching for IPA server...
IPA server: DNS discovery
Location: default
Continue to configure the system with these values? [no]: <span class="strong strong"><strong>yes</strong></span>
Configured /etc/idmapd.conf
Restarting sssd, waiting for it to become available.
Started autofs</pre></li><li class="listitem"><p class="simpara">
						Update your <code class="literal">/etc/exports</code> file, and add the Kerberos security method to the client options. For example:
					</p><pre class="literallayout">/nfs/projects/      	192.0.2.0/24(rw,<span class="strong strong"><strong>sec=krb5i</strong></span>)</pre><p class="simpara">
						If you want that your clients can select from multiple security methods, specify them separated by colons:
					</p><pre class="literallayout">/nfs/projects/      	192.0.2.0/24(rw,<span class="strong strong"><strong>sec=krb5:krb5i:krb5p</strong></span>)</pre></li><li class="listitem"><p class="simpara">
						Reload the exported file systems:
					</p><pre class="literallayout"># <span class="strong strong"><strong>exportfs -r</strong></span></pre></li></ol></div></section><section class="section" id="configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users"><div class="titlepage"><div><div><h3 class="title">32.3. Configuring automount locations, maps, and keys in IdM by using Ansible</h3></div></div></div><p>
				As an Identity Management (IdM) system administrator, you can configure automount locations and maps in IdM so that IdM users in the specified locations can access shares exported by an NFS server by navigating to specific mount points on their hosts. Both the exported NFS server directory and the mount points are specified in the maps. In LDAP terms, a location is a container for such map entries.
			</p><p>
				The example describes how to use Ansible to configure the <span class="strong strong"><strong>raleigh</strong></span> location and a map that mounts the <span class="strong strong"><strong>nfs-server.idm.example.com:/exports/project</strong></span> share on the <span class="strong strong"><strong>/devel/project</strong></span> mount point on the IdM client as a read-write directory.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On your Ansible control node, navigate to your <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem"><p class="simpara">
						Copy the <code class="literal">automount-location-present.yml</code> Ansible playbook file located in the <code class="literal">/usr/share/doc/ansible-freeipa/playbooks/automount/</code> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cp /usr/share/doc/ansible-freeipa/playbooks/automount/automount-location-present.yml automount-location-map-and-key-present.yml</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">automount-location-map-and-key-present.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						Adapt the file by setting the following variables in the <code class="literal">ipaautomountlocation</code> task section:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
								Set the <code class="literal">ipaadmin_password</code> variable to the password of the IdM <code class="literal">admin</code>.
							</li><li class="listitem">
								Set the <code class="literal">name</code> variable to <span class="strong strong"><strong>raleigh</strong></span>.
							</li><li class="listitem"><p class="simpara">
								Ensure that the <code class="literal">state</code> variable is set to <code class="literal">present</code>.
							</p><p class="simpara">
								This is the modified Ansible playbook file for the current example:
							</p></li></ul></div><pre class="literallayout">---
- name: Automount location present example
  hosts: ipaserver
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure automount location is present
    ipaautomountlocation:
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: raleigh</strong></span>
      <span class="strong strong"><strong>state: present</strong></span></pre></li><li class="listitem"><p class="simpara">
						Continue editing the <code class="literal">automount-location-map-and-key-present.yml</code> file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								In the <code class="literal">tasks</code> section, add a task to ensure the presence of an automount map:
							</p><pre class="literallayout">[...]
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
[...]
  - name: ensure map named auto.devel in location raleigh is created
    <span class="strong strong"><strong>ipaautomountmap:</strong></span>
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: auto.devel</strong></span>
      <span class="strong strong"><strong>location: raleigh</strong></span>
      <span class="strong strong"><strong>state: present</strong></span></pre></li><li class="listitem"><p class="simpara">
								Add another task to add the mount point and NFS server information to the map:
							</p><pre class="literallayout">[...]
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
[...]
  - name: ensure automount key /devel/project is present
    <span class="strong strong"><strong>ipaautomountkey:</strong></span>
      <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>location: raleigh</strong></span>
      <span class="strong strong"><strong>mapname: auto.devel</strong></span>
      <span class="strong strong"><strong>key: /devel/project</strong></span>
      <span class="strong strong"><strong>info: nfs-server.idm.example.com:/exports/project</strong></span>
      <span class="strong strong"><strong>state: present</strong></span></pre></li><li class="listitem"><p class="simpara">
								Add another task to ensure <span class="strong strong"><strong>auto.devel</strong></span> is connected to <span class="strong strong"><strong>auto.master</strong></span>:
							</p><pre class="literallayout">[...]
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
[...]
- name: Ensure auto.devel is connected in auto.master:
  <span class="strong strong"><strong>ipaautomountkey:</strong></span>
    <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
    <span class="strong strong"><strong>location: raleigh</strong></span>
    <span class="strong strong"><strong>mapname: auto.map</strong></span>
    <span class="strong strong"><strong>key: /devel</strong></span>
    <span class="strong strong"><strong>info: auto.devel</strong></span>
    <span class="strong strong"><strong>state: present</strong></span></pre></li></ol></div></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook and inventory files:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory automount-location-map-and-key-present.yml</strong></span></pre></li></ol></div></section><section class="section" id="using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users"><div class="titlepage"><div><div><h3 class="title">32.4. Using Ansible to add IdM users to a group that owns NFS shares</h3></div></div></div><p class="_abstract _abstract">
				As an Identity Management (IdM) system administrator, you can use Ansible to create a group of users that is able to access NFS shares, and add IdM users to this group.
			</p><p>
				This example describes how to use an Ansible playbook to ensure that the <span class="strong strong"><strong>idm_user</strong></span> account belongs to the <span class="strong strong"><strong>developers</strong></span> group, so that <span class="strong strong"><strong>idm_user</strong></span> can access the <span class="strong strong"><strong>/exports/project</strong></span> NFS share.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> access to the <span class="strong strong"><strong>nfs-server.idm.example.com</strong></span> NFS server, which is an IdM client located in the <span class="strong strong"><strong>raleigh</strong></span> automount location.
					</li><li class="listitem">
						You know the IdM <code class="literal">admin</code> password.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li><li class="listitem"><p class="simpara">
						The target node, that is the node on which the <code class="literal">ansible-freeipa</code> module is executed, is part of the IdM domain as an IdM client, server or replica.
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								In <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span>, you have created the <code class="literal">automount-location-map-and-key-present.yml</code> file that already contains tasks from <a class="link" href="#configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.3. Configuring automount locations, maps, and keys in IdM by using Ansible">Configuring automount locations, maps, and keys in IdM by using Ansible</a>.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On your Ansible control node, navigate to the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>cd ~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span></pre></li><li class="listitem">
						Open the <code class="literal">automount-location-map-and-key-present.yml</code> file for editing.
					</li><li class="listitem"><p class="simpara">
						In the <code class="literal">tasks</code> section, add a task to ensure that the IdM <span class="strong strong"><strong>developers</strong></span> group exists and <span class="strong strong"><strong>idm_user</strong></span> is added to this group:
					</p><pre class="literallayout">[...]
  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
[...]
  - <span class="strong strong"><strong>ipagroup:</strong></span>
     <span class="strong strong"><strong>ipaadmin_password: "{{ ipaadmin_password }}"</strong></span>
      <span class="strong strong"><strong>name: developers</strong></span>
      <span class="strong strong"><strong>user:</strong></span>
      <span class="strong strong"><strong>- idm_user</strong></span>
      <span class="strong strong"><strong>state: present</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook and specify the playbook and inventory files:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory automount-location-map-and-key-present.yml</strong></span></pre></li><li class="listitem"><p class="simpara">
						On the NFS server, change the group ownership of the <span class="strong strong"><strong>/exports/project</strong></span> directory to <span class="strong strong"><strong>developers</strong></span> so that every IdM user in the group can access the directory:
					</p><pre class="literallayout"># <span class="strong strong"><strong>chgrp developers /exports/project</strong></span></pre></li></ol></div></section><section class="section" id="configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users"><div class="titlepage"><div><div><h3 class="title">32.5. Configuring automount on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				As an Identity Management (IdM) system administrator, you can configure automount services on an IdM client so that NFS shares configured for a location to which the client has been added are accessible to an IdM user automatically when the user logs in to the client. The example describes how to configure an IdM client to use automount services that are available in the <span class="strong strong"><strong>raleigh</strong></span> location.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <code class="literal">root</code> access to the IdM client.
					</li><li class="listitem">
						You are logged in as IdM administrator.
					</li><li class="listitem">
						The automount location exists. The example location is <span class="strong strong"><strong>raleigh</strong></span>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On the IdM client, enter the <code class="literal">ipa-client-automount</code> command and specify the location. Use the <code class="literal">-U</code> option to run the script unattended:
					</p><pre class="literallayout"># <span class="strong strong"><strong>ipa-client-automount --location raleigh -U</strong></span></pre></li><li class="listitem"><p class="simpara">
						Stop the autofs service, clear the SSSD cache, and start the autofs service to load the new configuration settings:
					</p><pre class="literallayout"># <span class="strong strong"><strong>systemctl stop autofs ; sss_cache -E ; systemctl start autofs</strong></span></pre></li></ol></div></section><section class="section" id="verifying-that-an-idm-user-can-access-nfs-shares-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users"><div class="titlepage"><div><div><h3 class="title">32.6. Verifying that an IdM user can access NFS shares on an IdM client</h3></div></div></div><p class="_abstract _abstract">
				As an Identity Management (IdM) system administrator, you can test if an IdM user that is a member of a specific group can access NFS shares when logged in to a specific IdM client.
			</p><p>
				In the example, the following scenario is tested:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						An IdM user named <span class="strong strong"><strong>idm_user</strong></span> belonging to the <span class="strong strong"><strong>developers</strong></span> group can read and write the contents of the files in the <span class="strong strong"><strong>/devel/project</strong></span> directory automounted on <span class="strong strong"><strong>idm-client.idm.example.com</strong></span>, an IdM client located in the <span class="strong strong"><strong>raleigh</strong></span> automount location.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						You have <a class="link" href="#setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.2. Setting up an NFS server with Kerberos in a Red Hat Identity Management domain">set up an NFS server with Kerberos on an IdM host</a>.
					</li><li class="listitem">
						You have <a class="link" href="#configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.3. Configuring automount locations, maps, and keys in IdM by using Ansible">configured automount locations, maps, and mount points in IdM</a> in which you configured how IdM users can access the NFS share.
					</li><li class="listitem">
						You have <a class="link" href="#using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.4. Using Ansible to add IdM users to a group that owns NFS shares">used Ansible to add IdM users to the developers group that owns the NFS shares</a>.
					</li><li class="listitem">
						You have <a class="link" href="#configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users" title="32.5. Configuring automount on an IdM client">configured automount on the IdM client</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Verify that the IdM user can access the <code class="literal">read-write</code> directory:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Connect to the IdM client as the IdM user:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ssh idm_user@idm-client.idm.example.com</strong></span>
Password:</pre></li><li class="listitem"><p class="simpara">
								Obtain the ticket-granting ticket (TGT) for the IdM user:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit idm_user</strong></span></pre></li><li class="listitem"><p class="simpara">
								Optional: View the group membership of the IdM user:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-show idm_user</strong></span>
  User login: idm_user
  [...]
  Member of groups: developers, ipausers</pre></li><li class="listitem"><p class="simpara">
								Navigate to the <span class="strong strong"><strong>/devel/project</strong></span> directory:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>cd /devel/project</strong></span></pre></li><li class="listitem"><p class="simpara">
								List the directory contents:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ls</strong></span>
rw_file</pre></li><li class="listitem"><p class="simpara">
								Add a line to the file in the directory to test the <code class="literal">write</code> permission:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>echo "idm_user can write into the file" &gt; rw_file</strong></span></pre></li><li class="listitem"><p class="simpara">
								Optional: View the updated contents of the file:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>cat rw_file</strong></span>
this is a read-write file
idm_user can write into the file</pre></li></ol></div><p class="simpara">
						The output confirms that <span class="strong strong"><strong>idm_user</strong></span> can write into the file.
					</p></li></ol></div></section></section><section class="chapter" id="using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 33. Using Ansible to integrate IdM with NIS domains and netgroups</h2></div></div></div><section class="section" id="nis-and-its-benefits_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups"><div class="titlepage"><div><div><h3 class="title">33.1. NIS and its benefits</h3></div></div></div><p>
				In UNIX environments, the network information service (NIS) is a common way to centrally manage identities and authentication. NIS, which was originally named <span class="strong strong"><strong>Yellow Pages</strong></span> (YP), centrally manages authentication and identity information such as:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Users and passwords
					</li><li class="listitem">
						Host names and IP addresses
					</li><li class="listitem">
						POSIX groups
					</li></ul></div><p>
				For modern network infrastructures, NIS is considered too insecure because, for example, it neither provides host authentication, nor is data sent encrypted over the network. To work around the problems, NIS is often integrated with other protocols to enhance security.
			</p><p>
				If you use Identity Management (IdM), you can use the NIS server plug-in to connect clients that cannot be fully migrated to IdM. IdM integrates netgroups and other NIS data into the IdM domain. Additionally, you can easily migrate user and host identities from a NIS domain to IdM.
			</p><p>
				Netgroups can be used everywhere that NIS groups are expected.
			</p><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" title="33.2. NIS in IdM">NIS in IdM</a>
					</li><li class="listitem">
						<a class="link" href="#nis-netgroups-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" title="33.3. NIS netgroups in IdM">NIS netgroups in IdM</a>
					</li><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/assembly_migrating-from-nis-to-identity-management_configuring-and-managing-idm#">Migrating from NIS to Identity Management</a>
					</li></ul></div></section><section class="section" id="nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups"><div class="titlepage"><div><div><h3 class="title">33.2. NIS in IdM</h3></div></div></div><div class="formalpara"><p class="title"><strong>NIS objects in IdM</strong></p><p>
					NIS objects are integrated and stored in the Directory Server back end in compliance with <a class="link" href="http://tools.ietf.org/html/rfc2307">RFC 2307</a>. IdM creates NIS objects in the LDAP directory and clients retrieve them through, for example, System Security Services Daemon (SSSD) or <code class="literal">nss_ldap</code> using an encrypted LDAP connection.
				</p></div><p>
				IdM manages netgroups, accounts, groups, hosts, and other data. IdM uses a NIS listener to map passwords, groups, and netgroups to IdM entries.
			</p><div class="formalpara"><p class="title"><strong>NIS Plug-ins in IdM</strong></p><p>
					For NIS support, IdM uses the following plug-ins provided in the <span class="strong strong"><strong><span class="package package">slapi-nis</span></strong></span> package:
				</p></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">NIS Server Plug-in</span></dt><dd>
							The NIS Server plug-in enables the IdM-integrated LDAP server to act as a NIS server for clients. In this role, Directory Server dynamically generates and updates NIS maps according to the configuration. Using the plug-in, IdM serves clients using the NIS protocol as an NIS server.
						</dd><dt><span class="term">Schema Compatibility Plug-in</span></dt><dd><p class="simpara">
							The Schema Compatibility plug-in enables the Directory Server back end to provide an alternate view of entries stored in part of the directory information tree (DIT). This includes adding, dropping, or renaming attribute values, and optionally retrieving values for attributes from multiple entries in the tree.
						</p><p class="simpara">
							For further details, see the <code class="literal">/usr/share/doc/slapi-nis-<span class="emphasis"><em>version</em></span>/sch-getting-started.txt</code> file.
						</p></dd></dl></div></section><section class="section" id="nis-netgroups-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups"><div class="titlepage"><div><div><h3 class="title">33.3. NIS netgroups in IdM</h3></div></div></div><p>
				NIS entities can be stored in netgroups. Compared to UNIX groups, netgroups provide support for:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Nested groups (groups as members of other groups).
					</li><li class="listitem">
						Grouping hosts.
					</li></ul></div><p>
				A netgroup defines a set of the following information: host, user, and domain. This set is called a <span class="strong strong"><strong>triple</strong></span>. These three fields can contain:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						A value.
					</li><li class="listitem">
						A dash (<code class="literal command">-</code>), which specifies "no valid value"
					</li><li class="listitem">
						No value. An empty field specifies a wildcard.
					</li></ul></div><pre class="screen">(<span class="emphasis"><em>host.example.com</em></span>,,<span class="emphasis"><em>nisdomain.example.com</em></span>)
(-,<span class="emphasis"><em>user</em></span>,<span class="emphasis"><em>nisdomain.example.com</em></span>)</pre><p>
				When a client requests a NIS netgroup, IdM translates the LDAP entry :
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						To a traditional NIS map and sends it to the client over the NIS protocol by using the NIS plug-in.
					</li><li class="listitem">
						To an LDAP format that is compliant with <a class="link" href="https://www.ietf.org/rfc/rfc2307.txt">RFC 2307</a> or RFC 2307bis.
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-a-netgroup-is-present_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups"><div class="titlepage"><div><div><h3 class="title">33.4. Using Ansible to ensure that a netgroup is present</h3></div></div></div><p>
				You can use an Ansible playbook to ensure that an IdM netgroup is present. The example describes how to ensure that the <span class="strong strong"><strong>TestNetgroup1</strong></span> group is present.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>netgroup-present.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA netgroup.
  hosts: ipaserver
  become: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure netgroup members are present
    ipanetgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: TestNetgroup1</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory_/netgroup-present.yml</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" title="33.2. NIS in IdM">NIS in IdM</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-netgroup.md</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/playbooks/netgroup</code>
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-members-are-present-in-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups"><div class="titlepage"><div><div><h3 class="title">33.5. Using Ansible to ensure that members are present in a netgroup</h3></div></div></div><p>
				You can use an Ansible playbook to ensure that IdM users, groups, and netgroups are members of a netgroup. The example describes how to ensure that the <span class="strong strong"><strong>TestNetgroup1</strong></span> group has the following members:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						The <span class="strong strong"><strong>user1</strong></span> and <span class="strong strong"><strong>user2</strong></span> IdM users
					</li><li class="listitem">
						The <span class="strong strong"><strong>group1</strong></span> IdM group
					</li><li class="listitem">
						The <span class="strong strong"><strong>admins</strong></span> netgroup
					</li><li class="listitem">
						An <span class="strong strong"><strong>idmclient1</strong></span> host that is an IdM client
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						The <span class="strong strong"><strong>TestNetgroup1</strong></span> IdM netgroup exists.
					</li><li class="listitem">
						The <span class="strong strong"><strong>user1</strong></span> and <span class="strong strong"><strong>user2</strong></span> IdM users exist.
					</li><li class="listitem">
						The <span class="strong strong"><strong>group1</strong></span> IdM group exists.
					</li><li class="listitem">
						The <span class="strong strong"><strong>admins</strong></span> IdM netgroup exists.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>IdM-members-present-in-a-netgroup.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA netgroup.
  hosts: ipaserver
  become: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure netgroup members are present
    ipanetgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: TestNetgroup1
      user: user1,user2
      group: group1
      host: idmclient1
      netgroup: admins
      action: member</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory_/IdM-members-present-in-a-netgroup.yml</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" title="33.2. NIS in IdM">NIS in IdM</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-netgroup.md</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/playbooks/netgroup</code>
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-a-member-is-absent-from-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups"><div class="titlepage"><div><div><h3 class="title">33.6. Using Ansible to ensure that a member is absent from a netgroup</h3></div></div></div><p>
				You can use an Ansible playbook to ensure that IdM users are members of a netgroup. The example describes how to ensure that the <span class="strong strong"><strong>TestNetgroup1</strong></span> group does not have the <span class="strong strong"><strong>user1</strong></span> IdM user among its members. netgroup
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li><li class="listitem">
						The <span class="strong strong"><strong>TestNetgroup1</strong></span> netgroup exists.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>IdM-member-absent-from-a-netgroup.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA netgroup.
  hosts: ipaserver
  become: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure netgroup user, "user1", is absent
    ipanetgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: TestNetgroup1
      user: "user1"
      action: member
      state: absent</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory_/IdM-member-absent-from-a-netgroup.yml</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" title="33.2. NIS in IdM">NIS in IdM</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-netgroup.md</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/playbooks/netgroup</code>
					</li></ul></div></section><section class="section" id="using-ansible-to-ensure-that-a-netgroup-is-absent_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups"><div class="titlepage"><div><div><h3 class="title">33.7. Using Ansible to ensure that a netgroup is absent</h3></div></div></div><p>
				You can use an Ansible playbook to ensure that a netgroup does not exist in Identity Management (IdM). The example describes how to ensure that the <span class="strong strong"><strong>TestNetgroup1</strong></span> group does not exist in your IdM domain.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
							</li><li class="listitem">
								You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Create your Ansible playbook file <span class="strong strong"><strong>netgroup-absent.yml</strong></span> with the following content:
					</p><pre class="literallayout">---
- name: Playbook to manage IPA netgroup.
  hosts: ipaserver
  become: no

  vars_files:
  - /home/user_name/MyPlaybooks/secret.yml
  tasks:
  - name: Ensure netgroup my_netgroup1 is absent
    ipanetgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: my_netgroup1
      state: absent</pre></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i <span class="emphasis"><em>path_to_inventory_directory/inventory.file</em></span> <span class="emphasis"><em>path_to_playbooks_directory_/netgroup-absent.yml</em></span></strong></span></pre></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups" title="33.2. NIS in IdM">NIS in IdM</a>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/README-netgroup.md</code>
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/ansible-freeipa/playbooks/netgroup</code>
					</li></ul></div></section></section><section class="chapter" id="using-ansible-to-configure-hbac-and-sudo-rules-in-idm_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 34. Using Ansible to configure HBAC and sudo rules in IdM</h2></div></div></div><p class="_abstract _abstract">
			Using host-based access control (HBAC) in Identity Management (IdM), you can define policies that restrict access to hosts or services based on the following:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The user attempting to log in and this user’s groups
				</li><li class="listitem">
					The host that a user is trying to access and the host groups to which that host belongs
				</li><li class="listitem">
					The service that is being used to access a host
				</li></ul></div><p>
			Using <code class="literal">sudo</code>, a user can run programs as another user, with different privileges, for example <code class="literal">root</code> privileges. In IdM, you can manage sudo rules centrally. You can define <code class="literal">sudo</code> rules based on user groups, host groups and command groups, as well as individual users, hosts and commands.
		</p><p>
			Complete this procedure to ensure the presence of the following HBAC and <code class="literal">sudo</code> rules for IdM users:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<span class="strong strong"><strong>jane</strong></span> can only access host <span class="strong strong"><strong>client01.idm.example.com</strong></span>.
				</li><li class="listitem">
					<span class="strong strong"><strong>john</strong></span> can only access host <span class="strong strong"><strong>client02.idm.example.com</strong></span>.
				</li><li class="listitem">
					Members of the <code class="literal">admins</code> group, which includes the default <code class="literal">admin</code> user as well as the regular <span class="strong strong"><strong>alice</strong></span> user, can access any IdM host.
				</li><li class="listitem"><p class="simpara">
					Members of the <code class="literal">admins</code> group can run <code class="literal">sudo</code> with the following commands on any IdM host:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							<code class="literal">/usr/sbin/reboot</code>
						</li><li class="listitem">
							<code class="literal">/usr/bin/less</code>
						</li><li class="listitem">
							<code class="literal">/usr/sbin/setenforce</code>
						</li></ul></div></li></ul></div><p>
			The following diagram represents the desired configuration described above:
		</p><div class="figure" id="idm140464223506352"><p class="title"><strong>Figure 34.1. IdM HBAC and SUDO rules diagram</strong></p><div class="figure-contents"><div class="mediaobject"><img src="https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/9ac887ea3137cab8794a4dde6fa5fb11/IdM_HBAC_and_SUDO_rules_diagram.png" alt="An image of IdM users and hosts showing different types of host access and sudo privileges for different users"></div></div></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
					On the control node:
				</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
							You are using Ansible version 2.15 or later.
						</li><li class="listitem">
							You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package.
						</li><li class="listitem">
							You have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory.
						</li><li class="listitem">
							You have stored your <code class="literal">ipaadmin_password</code> in the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault.
						</li></ul></div></li><li class="listitem">
					The users <span class="strong strong"><strong>jane</strong></span>, <span class="strong strong"><strong>john</strong></span> and <span class="strong strong"><strong>alice</strong></span> exist in IdM. Passwords are configured for these accounts.
				</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Create your Ansible playbook file <span class="strong strong"><strong>add-hbac-and-sudo-rules-to-idm.yml</strong></span> with the following content:
				</p><pre class="screen">---
- name: Playbook to manage IPA HBAC and SUDO rules
  hosts: ipaserver
  become: false
  gather_facts: false

  vars_files:
  - /home/&lt;user_name&gt;/MyPlaybooks/secret.yml

  module_defaults:
    ipahbacrule:
      ipaadmin_password: "{{ ipaadmin_password }}"
    ipagroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
    ipasudocmd:
      ipaadmin_password: "{{ ipaadmin_password }}"
    ipasudocmdgroup:
      ipaadmin_password: "{{ ipaadmin_password }}"
    ipasudorule:
      ipaadmin_password: "{{ ipaadmin_password }}"

  tasks:
  - name: HBAC Rule for Jane - can log in to client01
    ipahbacrule: # Creates the rule
      name: Jane_rule
      hbacsvc:
      - sshd
      - login
      host: # Host name
      - client01.idm.example.com
      user:
      - jane

  - name: HBAC Rule for John - can log in to client02
    ipahbacrule: # Creates the rule
      name: john_rule
      hbacsvc:
      - sshd
      - login
      host: # Host name
      - client02.idm.example.com
      user:
      - john

  - name: Add user member alice to group admins
    ipagroup:
      name: admins
      action: member
      user:
      - alice

  - name: HBAC Rule for IdM administrators
    ipahbacrule: # Rule to allow admins full access
      name: admin_access # Rule name
      servicecat: all # All services
      hostcat: all # All hosts
      group: # User group
      - admins

    - name: Add reboot command to SUDO
      ipasudocmd:
        name: /usr/sbin/reboot
        state: present
    - name: Add less command to SUDO
      ipasudocmd:
        name: /usr/bin/less
        state: present
    - name: Add setenforce command to SUDO
      ipasudocmd:
        name: /usr/sbin/setenforce
        state: present

  - name: Create a SUDO command group
    ipasudocmdgroup:
      name: cmd_grp_1
      description: "Group of important commands"
      sudocmd:
      - /usr/sbin/setenforce
      - /usr/bin/less
      - /usr/sbin/reboot
      action: sudocmdgroup
      state: present

  - name: Create a SUDO rule with a SUDO command group
    ipasudorule:
      name: sudo_rule_1
      allow_sudocmdgroup:
      - cmd_grp_1
      group: admins
      state: present

  - name: Disable allow_all HBAC Rule
    ipahbacrule: # Rule to allow admins full access
      name: allow_all # Rule name
      state: disabled # Disables rule to allow everyone the ability to login</pre></li><li class="listitem"><p class="simpara">
					Run the playbook:
				</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -i inventory add-hbac-and-sudo-rules-to-idm.yml</strong></span></pre></li></ol></div><div class="orderedlist"><p class="title"><strong>Verification</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
					Connect to client01 as the jane user:
				</p><pre class="literallayout"><span class="strong strong"><strong>~]$ ssh jane@client01</strong></span>
Password:

Last login: Fri Aug 11 15:32:18 2023 from 192.168.122.1
[jane@client01 ~]$</pre><p class="simpara">
					The output verifies that jane has logged in to client01.
				</p></li><li class="listitem"><p class="simpara">
					Try to connect to client02 as the jane user:
				</p><pre class="literallayout"><span class="strong strong"><strong>~]$ ssh jane@client02</strong></span>
Password:
Connection closed by 192.168.122.47 port 22</pre><p class="simpara">
					The output verifies that jane cannot log in to client02.
				</p></li><li class="listitem"><p class="simpara">
					Connect to client02 as the alice user:
				</p><pre class="literallayout"><span class="strong strong"><strong>~]$ ssh alice@client02</strong></span>
Password:

Last login: Fri Aug 10 16:13:43 2023 from 192.168.122.1</pre><p class="simpara">
					The output verifies that alice has logged in to client02.
				</p></li><li class="listitem"><p class="simpara">
					Try to view the contents of the <code class="literal">/etc/sssd/sssd.conf</code> file using <code class="literal">less</code> without invoking the superuser privileges:
				</p><pre class="literallayout">[alice@client02 ~]$ <span class="strong strong"><strong>less /etc/sssd/sssd.conf</strong></span>
/etc/sssd/sssd.conf: Permission denied</pre><p class="simpara">
					The attempt fails as the file is not readable by anyone except the owner of the file, which is <code class="literal">root</code>.
				</p></li><li class="listitem"><p class="simpara">
					Invoke the <code class="literal">root</code> privileges to view the contents of the <code class="literal">/etc/sssd/sssd.conf</code> file using <code class="literal">less</code>:
				</p><pre class="literallayout">[alice@client02 ~]$ <span class="strong strong"><strong>sudo less /etc/sssd/sssd.conf</strong></span>
[sudo] password for alice:

[domain/idm.example.com]

id_provider = ipa
ipa_server_mode = True
[...]</pre><p class="simpara">
					The output verifies that alice can execute the <code class="literal">less</code> command on the <code class="literal">/etc/sssd/sssd.conf</code> file.
				</p></li></ol></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
					<a class="link" href="#host-based-access-control-rules-in-idm_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks" title="21.1. Host-based access control rules in IdM">Host-based access control rules in IdM</a>
				</li><li class="listitem">
					<a class="link" href="#sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client" title="20.1. Sudo access on an IdM client">Sudo access on an IdM client</a>
				</li></ul></div></section><section class="chapter" id="using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 35. Using Ansible to delegate authentication for IdM users to external identity providers</h2></div></div></div><p class="_abstract _abstract">
			You can use the <code class="literal">idp</code> <code class="literal">ansible-freeipa</code> module to associate users with external identity providers (IdP) that support the OAuth 2 device authorization flow. If an IdP reference and an associated IdP user ID exist, you can use them to enable IdP authentication for an IdM user with the <code class="literal">user</code> <code class="literal">ansible-freeipa</code> module.
		</p><p>
			Afterward, if these users authenticate with the SSSD version available in RHEL 9.1 or later, they receive RHEL Identity Management (IdM) single sign-on capabilities with Kerberos tickets after performing authentication and authorization at the external IdP.
		</p><section class="section" id="con_the-benefits-of-connecting-idm-to-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers"><div class="titlepage"><div><div><h3 class="title">35.1. The benefits of connecting IdM to an external IdP</h3></div></div></div><p>
				As an administrator, you might want to allow users stored in an external identity source, such as a cloud services provider, to access RHEL systems joined to your Identity Management (IdM) environment. To achieve this, you can delegate the authentication and authorization process of issuing Kerberos tickets for these users to that external entity.
			</p><p>
				You can use this feature to expand IdM’s capabilities and allow users stored in external identity providers (IdPs) to access Linux systems managed by IdM.
			</p></section><section class="section" id="how-idm-incorporates-logins-via-external-idps_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers"><div class="titlepage"><div><div><h3 class="title">35.2. How IdM incorporates logins via external IdPs</h3></div></div></div><p class="_abstract _abstract">
				SSSD 2.7.0 contains the <code class="literal">sssd-idp</code> package, which implements the <code class="literal">idp</code> Kerberos pre-authentication method. This authentication method follows the OAuth 2.0 Device Authorization Grant flow to delegate authorization decisions to external IdPs:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						An IdM client user initiates OAuth 2.0 Device Authorization Grant flow, for example, by attempting to retrieve a Kerberos TGT with the <code class="literal">kinit</code> utility at the command line.
					</li><li class="listitem">
						A special code and website link are sent from the Authorization Server to the IdM KDC backend.
					</li><li class="listitem">
						The IdM client displays the link and the code to the user. In this example, the IdM client outputs the link and code on the command line.
					</li><li class="listitem"><p class="simpara">
						The user opens the website link in a browser, which can be on another host, a mobile phone, and so on:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
								The user enters the special code.
							</li><li class="listitem">
								If necessary, the user logs in to the OAuth 2.0-based IdP.
							</li><li class="listitem">
								The user is prompted to authorize the client to access information.
							</li></ol></div></li><li class="listitem">
						The user confirms access at the original device prompt. In this example, the user hits the <kbd class="keycap">Enter</kbd> key at the command line.
					</li><li class="listitem">
						The IdM KDC backend polls the OAuth 2.0 Authorization Server for access to user information.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>What is supported:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Logging in remotely via SSH with the <code class="literal">keyboard-interactive</code> authentication method enabled, which allows calling Pluggable Authentication Module (PAM) libraries.
					</li><li class="listitem">
						Logging in locally with the console via the <code class="literal">logind</code> service.
					</li><li class="listitem">
						Retrieving a Kerberos ticket-granting ticket (TGT) with the <code class="literal">kinit</code> utility.
					</li></ul></div><div class="itemizedlist"><p class="title"><strong>What is currently not supported:</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Logging in to the IdM WebUI directly. To log in to the IdM WebUI, you must first acquire a Kerberos ticket.
					</li><li class="listitem">
						Logging in to Cockpit WebUI directly. To log in to the Cockpit WebUI, you must first acquire a Kerberos ticket.
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://freeipa.readthedocs.io/en/latest/workshop/12-external-idp-support.html">Authentication against external Identity Providers</a>
					</li><li class="listitem">
						<a class="link" href="https://www.rfc-editor.org/rfc/rfc8628">RFC 8628: OAuth 2.0 Device Authorization Grant</a>
					</li></ul></div></section><section class="section" id="using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers"><div class="titlepage"><div><div><h3 class="title">35.3. Using Ansible to create a reference to an external identity provider</h3></div></div></div><p class="_abstract _abstract">
				To connect external identity providers (IdPs) to your Identity Management (IdM) environment, create IdP references in IdM. Complete this procedure to use the <code class="literal">idp</code> <code class="literal">ansible-freeipa</code> module to configure a reference to the <span class="strong strong"><strong>github</strong></span> external IdP.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						You have registered IdM as an OAuth application to your external IdP, and generated a client ID and client secret on the device that an IdM user will be using to authenticate to IdM. The example assumes that:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								<span class="strong strong"><strong>my_github_account_name</strong></span> is the github user whose account the IdM user will be using to authenticate to IdM.
							</li><li class="listitem">
								The <code class="literal">client ID</code> is <span class="strong strong"><strong>2efe1acffe9e8ab869f4</strong></span>.
							</li><li class="listitem">
								The <code class="literal">client secret</code> is <span class="strong strong"><strong>656a5228abc5f9545c85fa626aecbf69312d398c</strong></span>.
							</li></ul></div></li><li class="listitem">
						Your IdM servers are using RHEL 9.1 or later.
					</li><li class="listitem">
						Your IdM servers are using SSSD 2.7.0 or later.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								You are using RHEL 9.4 or later.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On your Ansible control node, create an <span class="strong strong"><strong>configure-external-idp-reference.yml</strong></span> playbook:
					</p><pre class="literallayout">---
- name: Configure external IdP
  hosts: ipaserver
  become: false
  gather_facts: false

  tasks:
  - name: Ensure a reference to github external provider is available
    ipaidp:
      ipaadmin_password: <span class="strong strong"><strong>"{{ ipaadmin_password }}"</strong></span>
      name: <span class="strong strong"><strong>github_idp</strong></span>
      provider: <span class="strong strong"><strong>github</strong></span>
      client_ID: <span class="strong strong"><strong>2efe1acffe9e8ab869f4</strong></span>
      secret: <span class="strong strong"><strong>656a5228abc5f9545c85fa626aecbf69312d398c</strong></span>
      idp_user_id: <span class="strong strong"><strong>my_github_account_name</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory configure-external-idp-reference.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						On an IdM client, verify that the output of the <code class="literal">ipa idp-show</code> command shows the IdP reference you have created.
					</p><pre class="literallayout">[idmuser@idmclient ~]$ <span class="strong strong"><strong>ipa idp-show <span class="emphasis"><em>github_idp</em></span></strong></span></pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Next steps</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="#using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" title="35.4. Using Ansible to enable an IdM user to authenticate via an external IdP">Using Ansible to enable an IdM user to authenticate via an external IdP</a>
					</li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-idp.md">idp</a> <code class="literal">ansible-freeipa</code> upstream documentation
					</li></ul></div></section><section class="section" id="using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers"><div class="titlepage"><div><div><h3 class="title">35.4. Using Ansible to enable an IdM user to authenticate via an external IdP</h3></div></div></div><p class="_abstract _abstract">
				You can use the <code class="literal">user</code> <code class="literal">ansible-freeipa</code> module to enable an Identity Management (IdM) user to authenticate via an external identity provider (IdP). To do that, associate the external IdP reference you have previously created with the IdM user account. Complete this procedure to use Ansible to associate an external IdP reference named <span class="strong strong"><strong>github_idp</strong></span> with the IdM user named <span class="strong strong"><strong>idm-user-with-external-idp</strong></span>. As a result of the procedure, the user is able to use the <span class="strong strong"><strong>my_github_account_name</strong></span> github identity to authenticate as <span class="strong strong"><strong>idm-user-with-external-idp</strong></span> to IdM.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM client and IdM servers are using RHEL 9.1 or later.
					</li><li class="listitem">
						Your IdM client and IdM servers are using SSSD 2.7.0 or later.
					</li><li class="listitem">
						You have created a reference to an external IdP in IdM. See <a class="link" href="#using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" title="35.3. Using Ansible to create a reference to an external identity provider">Using Ansible to create a reference to an external identity provider</a>.
					</li><li class="listitem"><p class="simpara">
						You have configured your Ansible control node to meet the following requirements:
					</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">
								You are using Ansible version 2.15 or later.
							</li><li class="listitem">
								You have installed the <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible"><code class="literal">ansible-freeipa</code></a> package on the Ansible controller.
							</li><li class="listitem">
								You are using RHEL 9.4 or later.
							</li><li class="listitem">
								The example assumes that in the <span class="strong strong"><strong>~/<span class="emphasis"><em>MyPlaybooks</em></span>/</strong></span> directory, you have created an <a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management">Ansible inventory file</a> with the fully-qualified domain name (FQDN) of the IdM server.
							</li><li class="listitem">
								The example assumes that the <span class="strong strong"><strong>secret.yml</strong></span> Ansible vault stores your <code class="literal">ipaadmin_password</code>.
							</li></ul></div></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						On your Ansible control node, create an <span class="strong strong"><strong>enable-user-to-authenticate-via-external-idp.yml</strong></span> playbook:
					</p><pre class="literallayout">---
- name: Ensure an IdM user uses an external IdP to authenticate to IdM
  hosts: ipaserver
  become: false
  gather_facts: false

  tasks:
  - name: Retrieve Github user ID
    ansible.builtin.uri:
      url: “https://api.github.com/users/my_github_account_name”
      method: GET
      headers:
        Accept: “application/vnd.github.v3+json”
    register: user_data

  - name: Ensure IdM user exists with an external IdP authentication
    ipauser:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: <span class="strong strong"><strong>idm-user-with-external-idp</strong></span>
      first: Example
      last: User
      userauthtype: <span class="strong strong"><strong>idp</strong></span>
      idp: <span class="strong strong"><strong>github_idp</strong></span>
      idp_user_id: <span class="strong strong"><strong>my_github_account_name</strong></span></pre></li><li class="listitem">
						Save the file.
					</li><li class="listitem"><p class="simpara">
						Run the Ansible playbook. Specify the playbook file, the file storing the password protecting the <span class="strong strong"><strong>secret.yml</strong></span> file, and the inventory file:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --vault-password-file=password_file -v -i inventory enable-user-to-authenticate-via-external-idp.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Log in to an IdM client and verify that the output of the <code class="literal">ipa user-show</code> command for the <span class="strong strong"><strong>idm-user-with-external-idp</strong></span> user displays references to the IdP:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ipa user-show idm-user-with-external-idp</strong></span>
User login: idm-user-with-external-idp
First name: Example
Last name: User
Home directory: /home/idm-user-with-external-idp
Login shell: /bin/sh
Principal name: idm-user-with-external-idp@idm.example.com
Principal alias: idm-user-with-external-idp@idm.example.com
Email address: idm-user-with-external-idp@idm.example.com
ID: 35000003
GID: 35000003
<span class="strong strong"><strong>User authentication types: idp</strong></span>
<span class="strong strong"><strong>External IdP configuration: github</strong></span>
<span class="strong strong"><strong>External IdP user identifier: idm-user-with-external-idp@idm.example.com</strong></span>
Account disabled: False
Password: False
Member of groups: ipausers
Kerberos keys available: False</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						The <a class="link" href="https://github.com/freeipa/ansible-freeipa/blob/master/README-idp.md">idp</a> <code class="literal">ansible-freeipa</code> upstream documentation
					</li></ul></div></section><section class="section" id="retrieving-an-idm-ticket-granting-ticket-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers"><div class="titlepage"><div><div><h3 class="title">35.5. Retrieving an IdM ticket-granting ticket as an external IdP user</h3></div></div></div><p class="_abstract _abstract">
				If you have delegated authentication for an Identity Management (IdM) user to an external identity provider (IdP), the IdM user can request a Kerberos ticket-granting ticket (TGT) by authenticating to the external IdP.
			</p><p>
				Complete this procedure to:
			</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
						Retrieve and store an anonymous Kerberos ticket locally.
					</li><li class="listitem">
						Request the TGT for the <span class="strong strong"><strong>idm-user-with-external-idp</strong></span> user by using <code class="literal">kinit</code> with the <code class="literal">-T</code> option to enable Flexible Authentication via Secure Tunneling (FAST) channel to provide a secure connection between the Kerberos client and Kerberos Distribution Center (KDC).
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM client and IdM servers use RHEL 9.1 or later.
					</li><li class="listitem">
						Your IdM client and IdM servers use SSSD 2.7.0 or later.
					</li><li class="listitem">
						You have created a reference to an external IdP in IdM. See <a class="link" href="#using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" title="35.3. Using Ansible to create a reference to an external identity provider">Using Ansible to create a reference to an external identity provider</a>.
					</li><li class="listitem">
						You have associated an external IdP reference with the user account. See <a class="link" href="#using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" title="35.4. Using Ansible to enable an IdM user to authenticate via an external IdP">Using Ansible to enable an IdM user to authenticate via an external IdP</a>.
					</li><li class="listitem">
						The user that you are initially logged in as has write permissions on a directory in the local filesystem.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Use Anonymous PKINIT to obtain a Kerberos ticket and store it in a file named <code class="literal">./fast.ccache</code>.
					</p><pre class="literallayout">$ <span class="strong strong"><strong>kinit -n -c ./fast.ccache</strong></span></pre></li><li class="listitem"><p class="simpara">
						Optional: View the retrieved ticket:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>klist -c fast.ccache</strong></span>
Ticket cache: FILE:fast.ccache
Default principal: WELLKNOWN/ANONYMOUS@WELLKNOWN:ANONYMOUS

Valid starting       Expires              Service principal
03/03/2024 13:36:37  03/04/2024 13:14:28  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM</pre></li><li class="listitem"><p class="simpara">
						Begin authenticating as the IdM user, using the <code class="literal">-T</code> option to enable the FAST communication channel.
					</p><pre class="literallayout">[root@client ~]# <span class="strong strong"><strong>kinit -T ./fast.ccache idm-user-with-external-idp</strong></span>
Authenticate at https://oauth2.idp.com:8443/auth/realms/master/device?user_code=YHMQ-XKTL and press ENTER.:</pre></li><li class="listitem">
						In a browser, authenticate as the user at the website provided in the command output.
					</li><li class="listitem">
						At the command line, press the <kbd class="keycap">Enter</kbd> key to finish the authentication process.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display your Kerberos ticket information and confirm that the line <code class="literal">config: pa_type</code> shows <code class="literal">152</code> for pre-authentication with an external IdP.
					</p><pre class="literallayout">[root@client ~]# <span class="strong strong"><strong>klist -C</strong></span>
Ticket cache: KCM:0:58420
Default principal: idm-user-with-external-idp@IDM.EXAMPLE.COM

Valid starting     Expires            Service principal
05/09/22 07:48:23  05/10/22 07:03:07  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM
config: fast_avail(krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM) = yes
08/17/2022 20:22:45  08/18/2022 20:22:43  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM
<span class="strong strong"><strong>config: pa_type(krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM) = 152</strong></span></pre><p class="simpara">
						The <code class="literal">pa_type = 152</code> indicates external IdP authentication.
					</p></li></ul></div></section><section class="section" id="logging-in-to-an-idm-client-via-ssh-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers"><div class="titlepage"><div><div><h3 class="title">35.6. Logging in to an IdM client via SSH as an external IdP user</h3></div></div></div><p class="_abstract _abstract">
				To log in to an IdM client via SSH as an external identity provider (IdP) user, begin the login process on the command linel. When prompted, perform the authentication process at the website associated with the IdP, and finish the process at the Identity Management (IdM) client.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						Your IdM client and IdM servers are using RHEL 9.1 or later.
					</li><li class="listitem">
						Your IdM client and IdM servers are using SSSD 2.7.0 or later.
					</li><li class="listitem">
						You have created a reference to an external IdP in IdM. See <a class="link" href="#using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" title="35.3. Using Ansible to create a reference to an external identity provider">Using Ansible to create a reference to an external identity provider</a>.
					</li><li class="listitem">
						You have associated an external IdP reference with the user account. See <a class="link" href="#using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers" title="35.4. Using Ansible to enable an IdM user to authenticate via an external IdP">Using Ansible to enable an IdM user to authenticate via an external IdP</a>.
					</li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Attempt to log in to the IdM client via SSH.
					</p><pre class="literallayout">[user@client ~]$ <span class="strong strong"><strong>ssh idm-user-with-external-idp@client.idm.example.com</strong></span>
(idm-user-with-external-idp@client.idm.example.com) Authenticate at https://oauth2.idp.com:8443/auth/realms/main/device?user_code=XYFL-ROYR and press ENTER.</pre></li><li class="listitem">
						In a browser, authenticate as the user at the website provided in the command output.
					</li><li class="listitem">
						At the command line, press the <kbd class="keycap">Enter</kbd> key to finish the authentication process.
					</li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Display your Kerberos ticket information and confirm that the line <code class="literal">config: pa_type</code> shows <code class="literal">152</code> for pre-authentication with an external IdP.
					</p><pre class="literallayout">[idm-user-with-external-idp@client ~]$ klist -C
Ticket cache: KCM:0:58420
Default principal: idm-user-with-external-idp@IDM.EXAMPLE.COM

Valid starting     Expires            Service principal
05/09/22 07:48:23  05/10/22 07:03:07  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM
config: fast_avail(krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM) = yes
08/17/2022 20:22:45  08/18/2022 20:22:43  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM
<span class="strong strong"><strong>config: pa_type(krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM) = 152</strong></span></pre></li></ul></div></section><section class="section" id="the-provider-option-in-the-ipaidp-ansible-module_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers"><div class="titlepage"><div><div><h3 class="title">35.7. The provider option in the ipaidp Ansible module</h3></div></div></div><p class="_abstract _abstract">
				The following identity providers (IdPs) support OAuth 2.0 device authorization grant flow:
			</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
						Microsoft Identity Platform, including Azure AD
					</li><li class="listitem">
						Google
					</li><li class="listitem">
						GitHub
					</li><li class="listitem">
						Keycloak, including Red Hat Single Sign-On (SSO)
					</li><li class="listitem">
						Okta
					</li></ul></div><p>
				When using the <code class="literal">idp</code> <code class="literal">ansible-freeipa</code> module to create a reference to one of these external IdPs, you can specify the IdP type with the <code class="literal">provider</code> option in your <code class="literal">ipaidp</code> <code class="literal">ansible-freeipa</code> playbook task, which expands into additional options as described below:
			</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">provider: microsoft</code></span></dt><dd><p class="simpara">
							Microsoft Azure IdPs allow parametrization based on the Azure tenant ID, which you can specify with the <code class="literal">organization</code> option. If you need support for the live.com IdP, specify the option <code class="literal">organization common</code>.
						</p><p class="simpara">
							Choosing <code class="literal">provider: microsoft</code> expands to use the following options. The value of the <code class="literal">organization</code> option replaces the string <code class="literal">${ipaidporg}</code> in the table.
						</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 67%; " class="col_2"><!--Empty--></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140464223945872" scope="col">Option</th><th style="text-align: left; vertical-align: top; " id="idm140464223944784" scope="col">Value</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223945872"> <p>
											<code class="literal">auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223944784"> <p>
											<code class="literal">https://login.microsoftonline.com/${ipaidporg}/oauth2/v2.0/authorize</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223945872"> <p>
											<code class="literal">dev_auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223944784"> <p>
											<code class="literal">https://login.microsoftonline.com/${ipaidporg}/oauth2/v2.0/devicecode</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223945872"> <p>
											<code class="literal">token_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223944784"> <p>
											<code class="literal">https://login.microsoftonline.com/${ipaidporg}/oauth2/v2.0/token</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223945872"> <p>
											<code class="literal">userinfo_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223944784"> <p>
											<code class="literal">https://graph.microsoft.com/oidc/userinfo</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223945872"> <p>
											<code class="literal">keys_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223944784"> <p>
											<code class="literal">https://login.microsoftonline.com/common/discovery/v2.0/keys</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223945872"> <p>
											<code class="literal">scope: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223944784"> <p>
											<code class="literal">openid email</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223945872"> <p>
											<code class="literal">idp_user_id: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223944784"> <p>
											<code class="literal">email</code>
										</p>
										 </td></tr></tbody></table></rh-table></dd><dt><span class="term"><code class="literal">provider: google</code></span></dt><dd><p class="simpara">
							Choosing <code class="literal">provider: google</code> expands to use the following options:
						</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 67%; " class="col_2"><!--Empty--></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140464223074544" scope="col">Option</th><th style="text-align: left; vertical-align: top; " id="idm140464223073456" scope="col">Value</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223074544"> <p>
											<code class="literal">auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223073456"> <p>
											<code class="literal">https://accounts.google.com/o/oauth2/auth</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223074544"> <p>
											<code class="literal">dev_auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223073456"> <p>
											<code class="literal">https://oauth2.googleapis.com/device/code</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223074544"> <p>
											<code class="literal">token_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223073456"> <p>
											<code class="literal">https://oauth2.googleapis.com/token</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223074544"> <p>
											<code class="literal">userinfo_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223073456"> <p>
											<code class="literal">https://openidconnect.googleapis.com/v1/userinfo</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223074544"> <p>
											<code class="literal">keys_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223073456"> <p>
											<code class="literal">https://www.googleapis.com/oauth2/v3/certs</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223074544"> <p>
											<code class="literal">scope: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223073456"> <p>
											<code class="literal">openid email</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223074544"> <p>
											<code class="literal">idp_user_id: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223073456"> <p>
											<code class="literal">email</code>
										</p>
										 </td></tr></tbody></table></rh-table></dd><dt><span class="term"><code class="literal">provider: github</code></span></dt><dd><p class="simpara">
							Choosing <code class="literal">provider: github</code> expands to use the following options:
						</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 67%; " class="col_2"><!--Empty--></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140464223032304" scope="col">Option</th><th style="text-align: left; vertical-align: top; " id="idm140464223031216" scope="col">Value</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223032304"> <p>
											<code class="literal">auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223031216"> <p>
											<code class="literal">https://github.com/login/oauth/authorize</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223032304"> <p>
											<code class="literal">dev_auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223031216"> <p>
											<code class="literal">https://github.com/login/device/code</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223032304"> <p>
											<code class="literal">token_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223031216"> <p>
											<code class="literal">https://github.com/login/oauth/access_token</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223032304"> <p>
											<code class="literal">userinfo_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223031216"> <p>
											<code class="literal">https://openidconnect.googleapis.com/v1/userinfo</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223032304"> <p>
											<code class="literal">keys_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223031216"> <p>
											<code class="literal">https://api.github.com/user</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223032304"> <p>
											<code class="literal">scope: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223031216"> <p>
											<code class="literal">user</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464223032304"> <p>
											<code class="literal">idp_user_id: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464223031216"> <p>
											<code class="literal">login</code>
										</p>
										 </td></tr></tbody></table></rh-table></dd><dt><span class="term"><code class="literal">provider: keycloak</code></span></dt><dd><p class="simpara">
							With Keycloak, you can define multiple realms or organizations. Since it is often a part of a custom deployment, both base URL and realm ID are required, and you can specify them with the <code class="literal">base_url</code> and <code class="literal">organization</code> options in your <code class="literal">ipaidp</code> playbook task:
						</p><pre class="literallayout">---
- name: Playbook to manage IPA idp
  hosts: ipaserver
  become: false

  tasks:
  - name: Ensure keycloak idp my-keycloak-idp is present using provider
    ipaidp:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: my-keycloak-idp
      provider: keycloak
      organization: <span class="strong strong"><strong>main</strong></span>
      base_url: <span class="strong strong"><strong>keycloak.domain.com:8443/auth</strong></span>
      client_id: my-keycloak-client-id</pre><p class="simpara">
							Choosing <code class="literal">provider: keycloak</code> expands to use the following options. The value you specify in the <code class="literal">base_url</code> option replaces the string <code class="literal">${ipaidpbaseurl}</code> in the table, and the value you specify for the <code class="literal">organization `option replaces the string `${ipaidporg}</code>.
						</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 67%; " class="col_2"><!--Empty--></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140464222983856" scope="col">Option</th><th style="text-align: left; vertical-align: top; " id="idm140464222982768" scope="col">Value</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222983856"> <p>
											<code class="literal">auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222982768"> <p>
											<code class="literal">https://${ipaidpbaseurl}/realms/${ipaidporg}/protocol/openid-connect/auth</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222983856"> <p>
											<code class="literal">dev_auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222982768"> <p>
											<code class="literal">https://${ipaidpbaseurl}/realms/${ipaidporg}/protocol/openid-connect/auth/device</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222983856"> <p>
											<code class="literal">token_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222982768"> <p>
											<code class="literal">https://${ipaidpbaseurl}/realms/${ipaidporg}/protocol/openid-connect/token</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222983856"> <p>
											<code class="literal">userinfo_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222982768"> <p>
											<code class="literal">https://${ipaidpbaseurl}/realms/${ipaidporg}/protocol/openid-connect/userinfo</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222983856"> <p>
											<code class="literal">scope: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222982768"> <p>
											<code class="literal">openid email</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222983856"> <p>
											<code class="literal">idp_user_id: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222982768"> <p>
											<code class="literal">email</code>
										</p>
										 </td></tr></tbody></table></rh-table></dd><dt><span class="term"><code class="literal">provider: okta</code></span></dt><dd><p class="simpara">
							After registering a new organization in Okta, a new base URL is associated with it. You can specify this base URL with the <code class="literal">base_url</code> option in the <code class="literal">ipaidp</code> playbook task:
						</p><pre class="literallayout">---
- name: Playbook to manage IPA idp
  hosts: ipaserver
  become: false

  tasks:
  - name: Ensure okta idp my-okta-idp is present using provider
    ipaidp:
      ipaadmin_password: "{{ ipaadmin_password }}"
      name: my-okta-idp
      provider: okta
      base_url: <span class="strong strong"><strong>dev-12345.okta.com</strong></span>
      client_id: my-okta-client-id</pre><p class="simpara">
							Choosing <code class="literal">provider: okta</code> expands to use the following options. The value you specify for the <code class="literal">base_url</code> option replaces the string <code class="literal">${ipaidpbaseurl}</code> in the table.
						</p><rh-table><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 33%; " class="col_1"><!--Empty--><col style="width: 67%; " class="col_2"><!--Empty--></colgroup><thead><tr><th style="text-align: left; vertical-align: top; " id="idm140464222941712" scope="col">Option</th><th style="text-align: left; vertical-align: top; " id="idm140464222940624" scope="col">Value</th></tr></thead><tbody><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222941712"> <p>
											<code class="literal">auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222940624"> <p>
											<code class="literal">https://${ipaidpbaseurl}/oauth2/v1/authorize</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222941712"> <p>
											<code class="literal">dev_auth_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222940624"> <p>
											<code class="literal">https://${ipaidpbaseurl}/oauth2/v1/device/authorize</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222941712"> <p>
											<code class="literal">token_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222940624"> <p>
											<code class="literal">https://${ipaidpbaseurl}/oauth2/v1/token</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222941712"> <p>
											<code class="literal">userinfo_uri: URI</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222940624"> <p>
											<code class="literal">https://${ipaidpbaseurl}/oauth2/v1/userinfo</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222941712"> <p>
											<code class="literal">scope: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222940624"> <p>
											<code class="literal">openid email</code>
										</p>
										 </td></tr><tr><td style="text-align: left; vertical-align: top; " headers="idm140464222941712"> <p>
											<code class="literal">idp_user_id: STR</code>
										</p>
										 </td><td style="text-align: left; vertical-align: top; " headers="idm140464222940624"> <p>
											<code class="literal">email</code>
										</p>
										 </td></tr></tbody></table></rh-table></dd></dl></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<a class="link" href="https://freeipa.readthedocs.io/en/latest/designs/external-idp/idp-api.html#pre-populated-idp-templates">Pre-populated IdP templates</a>
					</li></ul></div></section></section><section class="chapter" id="integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management"><div class="titlepage"><div><div><h2 class="title">Chapter 36. Joining RHEL systems to an Active Directory by using RHEL system roles</h2></div></div></div><p class="_abstract _abstract">
			If your organization uses Microsoft Active Directory (AD) to centrally manage users, groups, and other resources, you can join your Red Hat Enterprise Linux (RHEL) host to this AD. For example, AD users can then log into RHEL and you can make services on the RHEL host available for authenticated AD users. By using the <code class="literal">ad_integration</code> RHEL system role, you can automate the integration of Red Hat Enterprise Linux system into an Active Directory (AD) domain.
		</p><rh-alert class="admonition note" state="info"><div class="admonition_header" slot="header">Note</div><div><p>
				The <code class="literal">ad_integration</code> role is for deployments using direct AD integration without an Identity Management (IdM) environment. For IdM environments, use the <code class="literal">ansible-freeipa</code> roles.
			</p><p>
				The <code class="literal">ad_integration</code> system role is not included in the <code class="literal">ansible-freeipa</code> package. It is part of the <code class="literal">rhel-system-roles</code> package. You can install <code class="literal">rhel-system-roles</code> on systems with a <code class="literal">Red Hat Enterprise Linux Server</code> subscription attached.
			</p></div></rh-alert><section class="section" id="connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles"><div class="titlepage"><div><div><h3 class="title">36.1. Joining RHEL to an Active Directory domain by using the <code class="literal">ad_integration</code> RHEL system role</h3></div></div></div><p>
				You can use the <code class="literal">ad_integration</code> RHEL system role to automate the process of joining RHEL to an Active Directory (AD) domain.
			</p><div class="itemizedlist"><p class="title"><strong>Prerequisites</strong></p><ul class="itemizedlist" type="disc"><li class="listitem">
						<a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles">You have prepared the control node and the managed nodes</a>
					</li><li class="listitem">
						You are logged in to the control node as a user who can run playbooks on the managed nodes.
					</li><li class="listitem">
						The account you use to connect to the managed nodes has <code class="literal">sudo</code> permissions on them.
					</li><li class="listitem">
						The managed node uses a DNS server that can resolve AD DNS entries.
					</li><li class="listitem">
						Credentials of an AD account which has permissions to join computers to the domain.
					</li><li class="listitem"><p class="simpara">
						The managed node can establish connections to AD domain controllers by using the following ports:
					</p><rh-table><table class="gt-4-cols lt-7-rows"><colgroup><col style="width: 20%; " class="col_1"><!--Empty--><col style="width: 20%; " class="col_2"><!--Empty--><col style="width: 20%; " class="col_3"><!--Empty--><col style="width: 40%; " class="col_4"><!--Empty--></colgroup><thead><tr><th align="left" valign="top" id="idm140464222880608" scope="col">Source Ports</th><th align="left" valign="top" id="idm140464222879520" scope="col">Destination Port</th><th align="left" valign="top" id="idm140464222878432" scope="col">Protocol</th><th align="left" valign="top" id="idm140464222877344" scope="col">Service</th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										53
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										UDP and TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										DNS
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										389
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										UDP and TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										LDAP
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										636
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										LDAPS
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										88
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										UDP and TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										Kerberos
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										464
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										UDP and TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										Kerberos password change requests
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										3268
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										LDAP Global Catalog
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										3269
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										TCP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										LDAPS Global Catalog
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										123
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										UDP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										NTP (if time synchronization is enabled)
									</p>
									 </td></tr><tr><td align="left" valign="top" headers="idm140464222880608"> <p>
										1024 - 65535
									</p>
									 </td><td align="left" valign="top" headers="idm140464222879520"> <p>
										323
									</p>
									 </td><td align="left" valign="top" headers="idm140464222878432"> <p>
										UDP
									</p>
									 </td><td align="left" valign="top" headers="idm140464222877344"> <p>
										NTP (if time synchronization is enabled)
									</p>
									 </td></tr></tbody></table></rh-table></li></ul></div><div class="orderedlist"><p class="title"><strong>Procedure</strong></p><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
						Store your sensitive variables in an encrypted file:
					</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
								Create the vault:
							</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-vault create vault.yml</strong></span>
New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span>
Confirm New Vault password: <span class="emphasis"><em>&lt;vault_password&gt;</em></span></pre></li><li class="listitem"><p class="simpara">
								After the <code class="literal">ansible-vault create</code> command opens an editor, enter the sensitive data in the <code class="literal"><span class="emphasis"><em>&lt;key&gt;</em></span>: <span class="emphasis"><em>&lt;value&gt;</em></span></code> format:
							</p><pre class="programlisting language-ini">usr: administrator
pwd: <span class="emphasis"><em>&lt;password&gt;</em></span></pre></li><li class="listitem">
								Save the changes, and close the editor. Ansible encrypts the data in the vault.
							</li></ol></div></li><li class="listitem"><p class="simpara">
						Create a playbook file, for example <code class="literal">~/playbook.yml</code>, with the following content:
					</p><pre class="programlisting language-yaml">---
- name: Active Directory integration
  hosts: managed-node-01.example.com
  vars_files:
    - vault.yml
  tasks:
    - name: Join an Active Directory
      ansible.builtin.include_role:
        name: rhel-system-roles.ad_integration
      vars:
        ad_integration_user: "{{ usr }}"
        ad_integration_password: "{{ pwd }}"
        ad_integration_realm: "ad.example.com"
        ad_integration_allow_rc4_crypto: false
        ad_integration_timesync_source: "time_server.ad.example.com"</pre><p class="simpara">
						The settings specified in the example playbook include the following:
					</p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">ad_integration_allow_rc4_crypto: <span class="emphasis"><em>&lt;true|false&gt;</em></span></code></span></dt><dd><p class="simpara">
									Configures whether the role activates the <code class="literal">AD-SUPPORT</code> crypto policy on the managed node. By default, RHEL does not support the weak RC4 encryption but, if Kerberos in your AD still requires RC4, you can enable this encryption type by setting <code class="literal">ad_integration_allow_rc4_crypto: true</code>.
								</p><p class="simpara">
									Omit this the variable or set it to <code class="literal">false</code> if Kerberos uses AES encryption.
								</p></dd><dt><span class="term"><code class="literal">ad_integration_timesync_source: <span class="emphasis"><em>&lt;time_server&gt;</em></span></code></span></dt><dd>
									Specifies the NTP server to use for time synchronization. Kerberos requires a synchronized time among AD domain controllers and domain members to prevent replay attacks. If you omit this variable, the <code class="literal">ad_integration</code> role does not utilize the <code class="literal">timesync</code> RHEL system role to configure time synchronization on the managed node.
								</dd></dl></div><p class="simpara">
						For details about all variables used in the playbook, see the <code class="literal">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md</code> file on the control node.
					</p></li><li class="listitem"><p class="simpara">
						Validate the playbook syntax:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml</strong></span></pre><p class="simpara">
						Note that this command only validates the syntax and does not protect against a wrong but valid configuration.
					</p></li><li class="listitem"><p class="simpara">
						Run the playbook:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible-playbook --ask-vault-pass ~/playbook.yml</strong></span></pre></li></ol></div><div class="itemizedlist"><p class="title"><strong>Verification</strong></p><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
						Check if AD users, such as <code class="literal">administrator</code>, are available locally on the managed node:
					</p><pre class="literallayout">$ <span class="strong strong"><strong>ansible managed-node-01.example.com -m command -a 'getent passwd administrator@ad.example.com'</strong></span>
administrator@ad.example.com:*:1450400500:1450400513:Administrator:/home/administrator@ad.example.com:/bin/bash</pre></li></ul></div><div class="itemizedlist _additional-resources"><p class="title"><strong>Additional resources</strong></p><ul class="itemizedlist _additional-resources" type="disc"><li class="listitem">
						<code class="literal">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md</code> file
					</li><li class="listitem">
						<code class="literal">/usr/share/doc/rhel-system-roles/ad_integration/</code> directory
					</li><li class="listitem">
						<a class="link" href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles">Ansible vault</a>
					</li></ul></div></section></section><div><div xml:lang="en-US" class="legalnotice" id="idm140464232589344"><h2 class="legalnotice">Legal Notice</h2><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2024 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></body></section><!----></div></article><aside id="layout" class="span-xs-12 span-sm-2 span-md-2 content-format-selectors" aria-label="Select page format" data-v-8589d091><div class="sticky-top page-layout-options" data-v-8589d091><label for="page-format" data-v-8589d091>Format</label><select id="page-format" class="page-format-dropdown" data-v-8589d091><option class="page-type" value="html" data-v-8589d091>Multi-page</option><option selected class="page-type" value="html-single" data-v-8589d091>Single-page</option><option class="page-type" value="pdf" data-v-8589d091>View full doc as PDF</option></select></div><!----></aside></div><div class="btn-container hidden" data-v-8589d091><pf-button class="top-scroll-btn" icon="angle-up" icon-set="fas" icon-position="right" data-v-8589d091>Back to top</pf-button></div><!--]--><!--]--></main><rh-footer data-analytics-region="page-footer" data-v-97dd2752><a slot="logo" href="/en" data-analytics-category="Footer" data-analytics-text="Logo" data-v-97dd2752><img alt="Red Hat logo" src="/Logo-Red_Hat-Documentation-A-Reverse-RGB.svg" loading="lazy" width="222" height="40" data-v-97dd2752></a><rh-footer-social-link slot="social-links" icon="github" data-v-97dd2752><a href="https://github.com/redhat-documentation" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="LinkedIn" data-v-97dd2752>Github</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="reddit" data-v-97dd2752><a href="https://www.reddit.com/r/redhat/" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="YouTube" data-v-97dd2752>Reddit</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="youtube" data-v-97dd2752><a href="https://www.youtube.com/@redhat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Facebook" data-v-97dd2752>Youtube</a></rh-footer-social-link><rh-footer-social-link slot="social-links" icon="twitter" data-v-97dd2752><a href="https://twitter.com/RedHat" data-analytics-region="social-links-exit" data-analytics-category="Footer|social-links" data-analytics-text="Twitter" data-v-97dd2752>Twitter</a></rh-footer-social-link><h3 slot="links" data-analytics-text="Learn" data-v-97dd2752>Learn</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://developers.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Developer resources" data-v-97dd2752>Developer resources</a></li><li data-v-97dd2752><a href="https://cloud.redhat.com/learn" data-analytics-category="Footer|Learn" data-analytics-text="Cloud learning hub" data-v-97dd2752>Cloud learning hub</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/interactive-labs" data-analytics-category="Footer|Learn" data-analytics-text="Interactive labs" data-v-97dd2752>Interactive labs</a></li><li data-v-97dd2752><a href="https://www.redhat.com/services/training-and-certification" data-analytics-category="Footer|Learn" data-analytics-text="Training and certification" data-v-97dd2752>Training and certification</a></li><li data-v-97dd2752><a href="https://access.redhat.com/support" data-analytics-category="Footer|Learn" data-analytics-text="Customer support" data-v-97dd2752>Customer support</a></li><li data-v-97dd2752><a href="/products" data-analytics-category="Footer|Learn" data-analytics-text="See all documentation" data-v-97dd2752>See all documentation</a></li></ul><h3 slot="links" data-analytics-text="Try buy sell" data-v-97dd2752>Try, buy, &amp; sell</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/products/trials" data-analytics-category="Footer|Try buy sell" data-analytics-text="Product trial center" data-v-97dd2752>Product trial center</a></li><li data-v-97dd2752><a href="https://marketplace.redhat.com" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Marketplace" data-v-97dd2752>Red Hat Marketplace</a></li><li data-v-97dd2752><a href="https://catalog.redhat.com/" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Ecosystem Catalog" data-v-97dd2752>Red Hat Ecosystem Catalog</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/store" data-analytics-category="Footer|Try buy sell" data-analytics-text="Red Hat Store" data-v-97dd2752>Red Hat Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/japan-buy" data-analytics-category="Footer|Try buy sell" data-analytics-text="Buy online (Japan)" data-v-97dd2752>Buy online (Japan)</a></li></ul><h3 slot="links" data-analytics-text="Communities" data-v-97dd2752>Communities</h3><ul slot="links" data-v-97dd2752><li data-v-97dd2752><a href="https://access.redhat.com/community" data-analytics-category="Footer|Communities" data-analytics-text="Customer Portal Community" data-v-97dd2752>Customer Portal Community</a></li><li data-v-97dd2752><a href="https://www.redhat.com/events" data-analytics-category="Footer|Communities" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://www.redhat.com/about/our-community-contributions" data-analytics-category="Footer|Communities" data-analytics-text="How we contribute" data-v-97dd2752>How we contribute</a></li></ul><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat Documentation" data-v-97dd2752>About Red Hat Documentation</h3><p data-v-97dd2752>We help Red Hat users innovate and achieve their goals with our products and services with content they can trust.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="Making open source more inclusive" data-v-97dd2752>Making open source more inclusive</h3><p data-v-97dd2752>Red Hat is committed to replacing problematic language in our code, documentation, and web properties. For more details, see the <a href=" https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language" data-analytics-category="Footer|Making open source more inclusive" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a>.</p></rh-footer-block><rh-footer-block slot="main-secondary" data-v-97dd2752><h3 slot="header" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</h3><p data-v-97dd2752>We deliver hardened solutions that make it easier for enterprises to work across platforms and environments, from the core datacenter to the network edge.</p></rh-footer-block><rh-footer-universal slot="universal" data-v-97dd2752><h3 slot="links-primary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-primary" data-analytics-region="page-footer-bottom-primary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/company" data-analytics-category="Footer|Corporate" data-analytics-text="About Red Hat" data-v-97dd2752>About Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/jobs" data-analytics-category="Footer|Corporate" data-analytics-text="Jobs" data-v-97dd2752>Jobs</a></li><li data-v-97dd2752><a href="https://redhat.com/en/events" data-analytics-category="Footer|Corporate" data-analytics-text="Events" data-v-97dd2752>Events</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/office-locations" data-analytics-category="Footer|Corporate" data-analytics-text="Locations" data-v-97dd2752>Locations</a></li><li data-v-97dd2752><a href="https://redhat.com/en/contact" data-analytics-category="Footer|Corporate" data-analytics-text="Contact Red Hat" data-v-97dd2752>Contact Red Hat</a></li><li data-v-97dd2752><a href="https://redhat.com/en/blog" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Blog" data-v-97dd2752>Red Hat Blog</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/our-culture/diversity-equity-inclusion" data-analytics-category="Footer|Corporate" data-analytics-text="Diversity equity and inclusion" data-v-97dd2752>Diversity, equity, and inclusion</a></li><li data-v-97dd2752><a href="https://coolstuff.redhat.com/" data-analytics-category="Footer|Corporate" data-analytics-text="Cool Stuff Store" data-v-97dd2752>Cool Stuff Store</a></li><li data-v-97dd2752><a href="https://www.redhat.com/en/summit" data-analytics-category="Footer|Corporate" data-analytics-text="Red Hat Summit" data-v-97dd2752>Red Hat Summit</a></li></ul><span data-v-97dd2752 data-v-5f538988></span><rh-footer-copyright slot="links-secondary" data-v-97dd2752>© 2024 Red Hat, Inc.</rh-footer-copyright><h3 slot="links-secondary" data-analytics-text="Red Hat legal and privacy links" hidden data-v-97dd2752>Red Hat legal and privacy links</h3><ul slot="links-secondary" data-analytics-region="page-footer-bottom-secondary" data-v-97dd2752><li data-v-97dd2752><a href="https://redhat.com/en/about/privacy-policy" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Privacy statement" data-v-97dd2752>Privacy statement</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/terms-use" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Terms of use" data-v-97dd2752>Terms of use</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/all-policies-guidelines" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="All policies and guidelines" data-v-97dd2752>All policies and guidelines</a></li><li data-v-97dd2752><a href="https://redhat.com/en/about/digital-accessibility" data-analytics-category="Footer|Red Hat legal and privacy links" data-analytics-text="Digital accessibility" class="active" data-v-97dd2752>Digital accessibility</a></li><li data-v-97dd2752><span id="teconsent" data-v-97dd2752></span></li></ul></rh-footer-universal></rh-footer><div id="consent_blackbar" style="position:fixed;bottom:0;width:100%;z-index:5;padding:10px;"></div><!--]--><!--]--></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true">[["ShallowReactive",1],{"data":2,"state":1349,"once":1353,"_errors":1354,"serverRendered":15,"path":1356},["ShallowReactive",3],{"s8LoCEfG4A":4,"uUstF4AIyn":10,"Pn02PlJOas":1277,"rFVLKcOK8e":1348},[5,6,7,8,9],"fr-fr","en-us","zh-cn","ja-jp","ko-kr",{"name":11,"html":12,"type":-1,"toc":13,"breadcrumbs":1172,"error":18,"title":1180,"productName":1174,"productVersions":1189,"pagination":1218,"redirect":1258,"canonicalLinks":1259,"openShiftProducts":1261,"tocFromVolume":-1,"jumpLinks":1276},"Using Ansible to install and manage Identity Management","\u003Cbody>\u003Cdiv xml:lang=\"en-US\" class=\"book\" id=\"idm140464245800272\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv class=\"producttitle\">\u003Cspan class=\"productname\">Red Hat Enterprise Linux\u003C/span> \u003Cspan class=\"productnumber\">9\u003C/span>\u003C/div>\u003Cdiv>\u003Ch3 class=\"subtitle\">Using Ansible to maintain an IdM environment\u003C/h3>\u003C/div>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"authorgroup\">\u003Cspan class=\"orgname\">Red Hat\u003C/span> \u003Cspan class=\"orgdiv\">Customer Content Services\u003C/span>\u003C/div>\u003C/div>\u003Cdiv>\u003Ca href=\"#idm140464232589344\">Legal Notice\u003C/a>\u003C/div>\u003Cdiv>\u003Cdiv class=\"abstract\">\u003Cp class=\"title\">\u003Cstrong>Abstract\u003C/strong>\u003C/p>\u003Cdiv class=\"para\">\n\t\t\t\tRed Hat provides the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package to enable administrators to run Red Hat Identity Management (IdM) by using Ansible. You can use playbooks to install IdM and manage users, groups, hosts, access control, and configuration settings.\n\t\t\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003Chr/>\u003C/div>\u003Csection class=\"preface\" id=\"proc_providing-feedback-on-red-hat-documentation_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Providing feedback on Red Hat documentation\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWe appreciate your feedback on our documentation. Let us know how we can improve it.\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Submitting feedback through Jira (account required)\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tLog in to the \u003Ca class=\"link\" href=\"https://issues.redhat.com/projects/RHELDOCS/issues\">Jira\u003C/a> website.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> in the top navigation bar\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter a descriptive title in the \u003Cspan class=\"strong strong\">\u003Cstrong>Summary\u003C/strong>\u003C/span> field.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tEnter your suggestion for improvement in the \u003Cspan class=\"strong strong\">\u003Cstrong>Description\u003C/strong>\u003C/span> field. Include links to the relevant parts of the documentation.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Create\u003C/strong>\u003C/span> at the bottom of the dialogue.\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"ansible-terminology_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 1. Ansible terminology\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tThe chapters in this title use the official Ansible terminology. If you are not familiar with the terminology, read the \u003Ca class=\"link\" href=\"https://docs.ansible.com/\">official Ansible upstream documentation\u003C/a> before proceeding, especially the following sections:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/network/getting_started/basic_concepts.html\">Basic concepts in Ansible\u003C/a> section provides an overview of the most commonly used concepts in Ansible.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/index.html\">User guide\u003C/a> outlines the most common situations and questions when starting to use Ansible, such as using the command line; working with an inventory; interacting with data; writing tasks, plays, and playbooks; and executing playbooks.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#intro-inventory\">How to build your inventory\u003C/a> offers tips on how to design your inventory. An inventory is a list or a group of lists that Ansible uses to work against multiple managed nodes or hosts in your infrastructure.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/playbooks_intro.html\">Intro to playbooks\u003C/a> introduces the concept of an Ansible playbook as a repeatable and re-usable system for managing configurations, deploying machines, and deploying complex applications.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/2.9/user_guide/playbooks_reuse_roles.html\">Ansible roles\u003C/a> section explains how to automate loading variables, tasks, and handlers based on a known file structure.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html\">Glossary\u003C/a> explains terms that are used elsewhere in the Ansible documentation.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"installing-an-Identity-Management-server-using-an-Ansible-playbook_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 2. Installing an Identity Management server using an Ansible playbook\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tThe following sections describe how to configure a system as an IdM server by using \u003Ca class=\"link\" href=\"https://www.ansible.com/\">Ansible\u003C/a>. Configuring a system as an IdM server establishes an IdM domain and enables the system to offer IdM services to IdM clients. The deployment is managed by the \u003Ccode class=\"literal\">ipaserver\u003C/code> Ansible role.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tYou understand \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/index.html\">Ansible\u003C/a> and IdM concepts:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tAnsible roles\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tAnsible nodes\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tAnsible inventory\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tAnsible tasks\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tAnsible modules\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tAnsible plays and playbooks\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"ansible-and-its-advantages-for-installing-IdM_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.1. Ansible and its advantages for installing IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAnsible is an automation tool used to configure systems, deploy software, and perform rolling updates. Ansible includes support for Identity Management (IdM), and you can use Ansible modules to automate installation tasks such as the setup of an IdM server, replica, client, or an entire IdM topology.\n\t\t\t\u003C/p>\u003Ch5 id=\"advantages_of_using_ansible_to_install_idm\">Advantages of using Ansible to install IdM\u003C/h5>\u003Cp>\n\t\t\t\tThe following list presents advantages of installing Identity Management using Ansible in contrast to manual installation.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou do not need to log into the managed node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou do not need to configure settings on each host to be deployed individually. Instead, you can have one inventory file to deploy a complete cluster.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can reuse an inventory file later for management tasks, for example to add users and hosts. You can reuse an inventory file even for such tasks as are not related to IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/en/blog/automating-red-hat-identity-management-installation\">Automating Red Hat Identity Management installation\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/planning_identity_management/index\">Planning Identity Management\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#preparing-the-system-for-ipa-server-installation_installing-identity-management\">Preparing the system for IdM server installation\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"installing-the-ansible-freeipa-package_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.2. Installing the ansible-freeipa package\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe following procedure describes how to install the the \u003Ccode class=\"literal package\">ansible-freeipa\u003C/code> roles.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure that the controller is a Red Hat Enterprise Linux system with a valid subscription. If this is not the case, see the official Ansible documentation \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html\">Installation guide\u003C/a> for alternative installation instructions.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure that you can reach the managed node over the \u003Ccode class=\"literal\">SSH\u003C/code> protocol from the controller. Check that the managed node is listed in the \u003Ccode class=\"literal\">/root/.ssh/known_hosts\u003C/code> file of the controller.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tRun the following procedure on the Ansible controller.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnable the required repository:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>subscription-manager repos --enable rhel-9-for-x86_64-appstream-rpms\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the IdM Ansible roles:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>dnf install ansible-freeipa\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe roles are installed to the \u003Ccode class=\"literal\">/usr/share/ansible/roles/\u003C/code> directory.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ansible-roles-location-in-the-file-system_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.3. Ansible roles location in the file system\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tBy default, the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> roles are installed to the \u003Ccode class=\"literal\">/usr/share/ansible/roles/\u003C/code> directory. The structure of the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package is as follows:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/usr/share/ansible/roles/\u003C/code> directory stores the \u003Ccode class=\"literal\">ipaserver\u003C/code>, \u003Ccode class=\"literal\">ipareplica\u003C/code>, and \u003Ccode class=\"literal\">ipaclient\u003C/code> roles on the Ansible controller. Each role directory stores examples, a basic overview, the license and documentation about the role in a \u003Ccode class=\"literal\">README.md\u003C/code> Markdown file.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server]# \u003Cspan class=\"strong strong\">\u003Cstrong>ls -1 /usr/share/ansible/roles/\u003C/strong>\u003C/span>\nipaclient\nipareplica\nipaserver\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory stores the documentation about individual roles and the topology in \u003Ccode class=\"literal\">README.md\u003C/code> Markdown files. It also stores the \u003Ccode class=\"literal\">playbooks/\u003C/code> subdirectory.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server]# \u003Cspan class=\"strong strong\">\u003Cstrong>ls -1 /usr/share/doc/ansible-freeipa/\u003C/strong>\u003C/span>\nplaybooks\nREADME-client.md\nREADME.md\nREADME-replica.md\nREADME-server.md\nREADME-topology.md\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/\u003C/code> directory stores the example playbooks:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server]# \u003Cspan class=\"strong strong\">\u003Cstrong>ls -1 /usr/share/doc/ansible-freeipa/playbooks/\u003C/strong>\u003C/span>\ninstall-client.yml\ninstall-cluster.yml\ninstall-replica.yml\ninstall-server.yml\nuninstall-client.yml\nuninstall-cluster.yml\nuninstall-replica.yml\nuninstall-server.yml\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-integrated-ca-as-the-root-ca_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.4. Setting the parameters for a deployment with an integrated DNS and an integrated CA as the root CA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to configure the inventory file for installing an IdM server with an integrated CA as the root CA in an environment that uses the IdM integrated DNS solution.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe inventory in this procedure uses the \u003Ccode class=\"literal\">INI\u003C/code> format. You can, alternatively, use the \u003Ccode class=\"literal\">YAML\u003C/code> or \u003Ccode class=\"literal\">JSON\u003C/code> formats.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">~/MyPlaybooks/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ mkdir MyPlaybooks\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">~/MyPlaybooks/inventory\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the inventory file for editing. Specify the fully-qualified domain names (\u003Ccode class=\"literal\">FQDN\u003C/code>) of the host you want to use as an IdM server. Ensure that the \u003Ccode class=\"literal\">FQDN\u003C/code> meets the following criteria:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOnly alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe host name must be all lower-case.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSpecify the IdM domain and realm information.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify that you want to use integrated DNS by adding the following option:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Ccode class=\"literal\">ipaserver_setup_dns=true\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the DNS forwarding settings. Choose one of the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_auto_forwarders=true\u003C/code> option if you want the installer to use forwarders from the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file. Do not use this option if the nameserver specified in the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file is the localhost 127.0.0.1 address or if you are on a virtual private network and the DNS servers you are using are normally unreachable from the public internet.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_forwarders\u003C/code> option to specify your forwarders manually. The installation process adds the forwarder IP addresses to the \u003Ccode class=\"literal\">/etc/named.conf\u003C/code> file on the installed IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_no_forwarders=true\u003C/code> option to configure root DNS servers to be used instead.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tWith no DNS forwarders, your environment is isolated, and names from other DNS domains in your infrastructure are not resolved.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the DNS reverse record and zone settings. Choose from the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_allow_zone_overlap=true\u003C/code> option to allow the creation of a (reverse) zone even if the zone is already resolvable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_reverse_zones\u003C/code> option to specify your reverse zones manually.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_no_reverse=true\u003C/code> option if you do not want the installer to create a reverse DNS zone.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tUsing IdM to manage reverse zones is optional. You can use an external DNS service for this purpose instead.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSpecify the passwords for \u003Ccode class=\"literal\">admin\u003C/code> and for the \u003Ccode class=\"literal\">Directory Manager\u003C/code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Specify a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone to be used by the IdM server. If you do not set a custom zone, IdM will add its services to the default \u003Ccode class=\"literal\">firewalld\u003C/code> zone. The predefined default zone is \u003Ccode class=\"literal\">public\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe specified \u003Ccode class=\"literal\">firewalld\u003C/code> zone must exist and be permanent.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with the required server information (excluding the passwords)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=true\nipaserver_auto_forwarders=true\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with the required server information (including the passwords)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=true\nipaserver_auto_forwarders=true\nipaadmin_password=MySecretPassword123\nipadm_password=MySecretPassword234\n\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=true\nipaserver_auto_forwarders=true\nipaadmin_password=MySecretPassword123\nipadm_password=MySecretPassword234\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaserver_firewalld_zone=\u003Cspan class=\"emphasis\">\u003Cem>custom zone\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook to set up an IdM server using admin and Directory Manager passwords stored in an Ansible Vault file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">---\n- name: Playbook to configure IPA server\n  hosts: ipaserver\n  become: true\n  vars_files:\n  - playbook_sensitive_data.yml\n\n  roles:\n  - role: ipaserver\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook to set up an IdM server using admin and Directory Manager passwords from an inventory file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">---\n- name: Playbook to configure IPA server\n  hosts: ipaserver\n  become: true\n\n  roles:\n  - role: ipaserver\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tman \u003Ccode class=\"literal\">ipa-server-install(1)\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-server.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-the-parameters-for-a-deployment-with-external-dns-and-an-integrated-ca-as-the-root-ca_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.5. Setting the parameters for a deployment with external DNS and an integrated CA as the root CA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to configure the inventory file for installing an IdM server with an integrated CA as the root CA in an environment that uses an external DNS solution.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe inventory file in this procedure uses the \u003Ccode class=\"literal\">INI\u003C/code> format. You can, alternatively, use the \u003Ccode class=\"literal\">YAML\u003C/code> or \u003Ccode class=\"literal\">JSON\u003C/code> formats.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">~/MyPlaybooks/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ mkdir MyPlaybooks\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">~/MyPlaybooks/inventory\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the inventory file for editing. Specify the fully-qualified domain names (\u003Ccode class=\"literal\">FQDN\u003C/code>) of the host you want to use as an IdM server. Ensure that the \u003Ccode class=\"literal\">FQDN\u003C/code> meets the following criteria:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOnly alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe host name must be all lower-case.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSpecify the IdM domain and realm information.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMake sure that the \u003Ccode class=\"literal\">ipaserver_setup_dns\u003C/code> option is set to \u003Ccode class=\"literal\">no\u003C/code> or that it is absent.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSpecify the passwords for \u003Ccode class=\"literal\">admin\u003C/code> and for the \u003Ccode class=\"literal\">Directory Manager\u003C/code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Specify a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone to be used by the IdM server. If you do not set a custom zone, IdM will add its services to the default \u003Ccode class=\"literal\">firewalld\u003C/code> zone. The predefined default zone is \u003Ccode class=\"literal\">public\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe specified \u003Ccode class=\"literal\">firewalld\u003C/code> zone must exist and be permanent.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with the required server information (excluding the passwords)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=no\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with the required server information (including the passwords)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=no\nipaadmin_password=MySecretPassword123\nipadm_password=MySecretPassword234\n\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=no\nipaadmin_password=MySecretPassword123\nipadm_password=MySecretPassword234\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaserver_firewalld_zone=\u003Cspan class=\"emphasis\">\u003Cem>custom zone\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook to set up an IdM server using admin and Directory Manager passwords stored in an Ansible Vault file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">---\n- name: Playbook to configure IPA server\n  hosts: ipaserver\n  become: true\n  vars_files:\n  - playbook_sensitive_data.yml\n\n  roles:\n  - role: ipaserver\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook to set up an IdM server using admin and Directory Manager passwords from an inventory file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">---\n- name: Playbook to configure IPA server\n  hosts: ipaserver\n  become: true\n\n  roles:\n  - role: ipaserver\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tman \u003Ccode class=\"literal\">ipa-server-install(1)\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-server.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-an-IdM-server-with-an-integrated-CA-using-an-Ansible-playbook_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.6. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to deploy an IdM server with an integrated certificate authority (CA) as the root CA using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have set the parameters that correspond to your scenario by choosing one of the following procedures:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-integrated-ca-as-the-root-ca_server-ansible\" title=\"2.4. Setting the parameters for a deployment with an integrated DNS and an integrated CA as the root CA\">Procedure with integrated DNS\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#setting-the-parameters-for-a-deployment-with-external-dns-and-an-integrated-ca-as-the-root-ca_server-ansible\" title=\"2.5. Setting the parameters for a deployment with external DNS and an integrated CA as the root CA\">Procedure with external DNS\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-server.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChoose one of the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf your IdM deployment uses external DNS: add the DNS resource records contained in the \u003Ccode class=\"literal\">/tmp/ipa.system.records.UFRPto.db\u003C/code> file to the existing external DNS servers. The process of updating the DNS records varies depending on the particular DNS solution.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">...\nRestarting the KDC\n\u003Cspan class=\"strong strong\">\u003Cstrong>Please add records in this file to your DNS system: /tmp/ipa.system.records.UFRBto.db\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>Restarting the web server\u003C/strong>\u003C/span>\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe server installation is not complete until you add the DNS records to the existing DNS servers.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf your IdM deployment uses integrated DNS:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tAdd DNS delegation from the parent domain to the IdM DNS domain. For example, if the IdM DNS domain is \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>idm.example.com\u003C/em>\u003C/span>\u003C/code>, add a name server (NS) record to the \u003Ccode class=\"literal\">example.com\u003C/code> parent domain.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\tRepeat this step each time after an IdM DNS server is installed.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd an \u003Ccode class=\"literal\">_ntp._udp\u003C/code> service (SRV) record for your time server to your IdM DNS. The presence of the SRV record for the time server of the newly-installed IdM server in IdM DNS ensures that future replica and client installations are automatically configured to synchronize with the time server used by this primary IdM server.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-external-ca-as-the-root-ca_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.7. Setting the parameters for a deployment with an integrated DNS and an external CA as the root CA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to configure the inventory file for installing an IdM server with an external CA as the root CA in an environment that uses the IdM integrated DNS solution.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe inventory file in this procedure uses the \u003Ccode class=\"literal\">INI\u003C/code> format. You can, alternatively, use the \u003Ccode class=\"literal\">YAML\u003C/code> or \u003Ccode class=\"literal\">JSON\u003C/code> formats.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">~/MyPlaybooks/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ mkdir MyPlaybooks\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">~/MyPlaybooks/inventory\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the inventory file for editing. Specify the fully-qualified domain names (\u003Ccode class=\"literal\">FQDN\u003C/code>) of the host you want to use as an IdM server. Ensure that the \u003Ccode class=\"literal\">FQDN\u003C/code> meets the following criteria:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOnly alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe host name must be all lower-case.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSpecify the IdM domain and realm information.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify that you want to use integrated DNS by adding the following option:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Ccode class=\"literal\">ipaserver_setup_dns=true\u003C/code>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the DNS forwarding settings. Choose one of the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_auto_forwarders=true\u003C/code> option if you want the installation process to use forwarders from the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file. This option is not recommended if the nameserver specified in the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file is the localhost 127.0.0.1 address or if you are on a virtual private network and the DNS servers you are using are normally unreachable from the public internet.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_forwarders\u003C/code> option to specify your forwarders manually. The installation process adds the forwarder IP addresses to the \u003Ccode class=\"literal\">/etc/named.conf\u003C/code> file on the installed IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_no_forwarders=true\u003C/code> option to configure root DNS servers to be used instead.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tWith no DNS forwarders, your environment is isolated, and names from other DNS domains in your infrastructure are not resolved.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the DNS reverse record and zone settings. Choose from the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_allow_zone_overlap=true\u003C/code> option to allow the creation of a (reverse) zone even if the zone is already resolvable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_reverse_zones\u003C/code> option to specify your reverse zones manually.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver_no_reverse=true\u003C/code> option if you do not want the installation process to create a reverse DNS zone.\n\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tUsing IdM to manage reverse zones is optional. You can use an external DNS service for this purpose instead.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSpecify the passwords for \u003Ccode class=\"literal\">admin\u003C/code> and for the \u003Ccode class=\"literal\">Directory Manager\u003C/code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Specify a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone to be used by the IdM server. If you do not set a custom zone, IdM adds its services to the default \u003Ccode class=\"literal\">firewalld\u003C/code> zone. The predefined default zone is \u003Ccode class=\"literal\">public\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe specified \u003Ccode class=\"literal\">firewalld\u003C/code> zone must exist and be permanent.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with the required server information (excluding the passwords)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=true\nipaserver_auto_forwarders=true\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with the required server information (including the passwords)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=true\nipaserver_auto_forwarders=true\nipaadmin_password=MySecretPassword123\nipadm_password=MySecretPassword234\n\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=true\nipaserver_auto_forwarders=true\nipaadmin_password=MySecretPassword123\nipadm_password=MySecretPassword234\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaserver_firewalld_zone=\u003Cspan class=\"emphasis\">\u003Cem>custom zone\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook for the first step of the installation. Enter instructions for generating the certificate signing request (CSR) and copying it from the controller to the managed node.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to configure IPA server Step 1\n  hosts: ipaserver\n  become: true\n  vars_files:\n  - playbook_sensitive_data.yml\n  vars:\n    ipaserver_external_ca: true\n\n  roles:\n  - role: ipaserver\n    state: present\n\n  post_tasks:\n  - name: Copy CSR /root/ipa.csr from node to \"{{ groups.ipaserver[0] + '-ipa.csr' }}\"\n    fetch:\n      src: /root/ipa.csr\n      dest: \"{{ groups.ipaserver[0] + '-ipa.csr' }}\"\n      flat: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate another playbook for the final step of the installation.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to configure IPA server Step 2\n  hosts: ipaserver\n  become: true\n  vars_files:\n  - playbook_sensitive_data.yml\n  vars:\n    ipaserver_external_cert_files:\n      - \"/root/servercert20240601.pem\"\n      - \"/root/cacert.pem\"\n\n  pre_tasks:\n  - name: Copy \"{{ groups.ipaserver[0] }}-{{ item }}\" to \"/root/{{ item }}\" on node\n    ansible.builtin.copy:\n      src: \"{{ groups.ipaserver[0] }}-{{ item }}\"\n      dest: \"/root/{{ item }}\"\n      force: true\n    with_items:\n    - servercert20240601.pem\n    - cacert.pem\n\n  roles:\n  - role: ipaserver\n    state: present\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tman \u003Ccode class=\"literal\">ipa-server-install(1)\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-server.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-the-parameters-for-a-deployment-with-external-dns-and-an-external-ca-as-the-root-ca_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.8. Setting the parameters for a deployment with external DNS and an external CA as the root CA\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to configure the inventory file for installing an IdM server with an external CA as the root CA in an environment that uses an external DNS solution.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe inventory file in this procedure uses the \u003Ccode class=\"literal\">INI\u003C/code> format. You can, alternatively, use the \u003Ccode class=\"literal\">YAML\u003C/code> or \u003Ccode class=\"literal\">JSON\u003C/code> formats.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">~/MyPlaybooks/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ mkdir MyPlaybooks\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">~/MyPlaybooks/inventory\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the inventory file for editing. Specify the fully-qualified domain names (\u003Ccode class=\"literal\">FQDN\u003C/code>) of the host you want to use as an IdM server. Ensure that the \u003Ccode class=\"literal\">FQDN\u003C/code> meets the following criteria:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOnly alphanumeric characters and hyphens (-) are allowed. For example, underscores are not allowed and can cause DNS failures.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe host name must be all lower-case.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSpecify the IdM domain and realm information.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMake sure that the \u003Ccode class=\"literal\">ipaserver_setup_dns\u003C/code> option is set to \u003Ccode class=\"literal\">no\u003C/code> or that it is absent.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSpecify the passwords for \u003Ccode class=\"literal\">admin\u003C/code> and for the \u003Ccode class=\"literal\">Directory Manager\u003C/code>. Use the Ansible Vault to store the password, and reference the Vault file from the playbook file. Alternatively and less securely, specify the passwords directly in the inventory file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Specify a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone to be used by the IdM server. If you do not set a custom zone, IdM will add its services to the default \u003Ccode class=\"literal\">firewalld\u003C/code> zone. The predefined default zone is \u003Ccode class=\"literal\">public\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe specified \u003Ccode class=\"literal\">firewalld\u003C/code> zone must exist and be permanent.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with the required server information (excluding the passwords)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=no\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with the required server information (including the passwords)\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=no\nipaadmin_password=MySecretPassword123\nipadm_password=MySecretPassword234\n\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory file with a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[ipaserver:vars]\nipaserver_domain=idm.example.com\nipaserver_realm=IDM.EXAMPLE.COM\nipaserver_setup_dns=no\nipaadmin_password=MySecretPassword123\nipadm_password=MySecretPassword234\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaserver_firewalld_zone=\u003Cspan class=\"emphasis\">\u003Cem>custom zone\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook for the first step of the installation. Enter instructions for generating the certificate signing request (CSR) and copying it from the controller to the managed node.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to configure IPA server Step 1\n  hosts: ipaserver\n  become: true\n  vars_files:\n  - playbook_sensitive_data.yml\n  vars:\n    ipaserver_external_ca: true\n\n  roles:\n  - role: ipaserver\n    state: present\n\n  post_tasks:\n  - name: Copy CSR /root/ipa.csr from node to \"{{ groups.ipaserver[0] + '-ipa.csr' }}\"\n    fetch:\n      src: /root/ipa.csr\n      dest: \"{{ groups.ipaserver[0] + '-ipa.csr' }}\"\n      flat: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate another playbook for the final step of the installation.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to configure IPA server Step 2\n  hosts: ipaserver\n  become: true\n  vars_files:\n  - playbook_sensitive_data.yml\n  vars:\n    ipaserver_external_cert_files:\n      - \"/root/servercert20240601.pem\"\n      - \"/root/cacert.pem\"\n\n  pre_tasks:\n  - name: Copy \"{{ groups.ipaserver[0] }}-{{ item }}\" to \"/root/{{ item }}\" on node\n    ansible.builtin.copy:\n      src: \"{{ groups.ipaserver[0] }}-{{ item }}\"\n      dest: \"/root/{{ item }}\"\n      force: true\n    with_items:\n    - servercert20240601.pem\n    - cacert.pem\n\n  roles:\n  - role: ipaserver\n    state: present\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_installing-an-ipa-server-without-dns-with-external-ca_installing-identity-management\">Installing an IdM server: Without integrated DNS, with an external CA as the root CA\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tman \u003Ccode class=\"literal\">ipa-server-install(1)\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-server.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-an-IdM-server-with-an-external-CA-using-an-Ansible-playbook_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.9. Deploying an IdM server with an external CA as the root CA using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to deploy an IdM server with an external certificate authority (CA) as the root CA using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have set the parameters that correspond to your scenario by choosing one of the following procedures:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-external-ca-as-the-root-ca_server-ansible\" title=\"2.7. Setting the parameters for a deployment with an integrated DNS and an external CA as the root CA\">Procedure with integrated DNS\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#setting-the-parameters-for-a-deployment-with-external-dns-and-an-external-ca-as-the-root-ca_server-ansible\" title=\"2.8. Setting the parameters for a deployment with external DNS and an external CA as the root CA\">Procedure with external DNS\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook with the instructions for the first step of the installation, for example \u003Ccode class=\"literal\">install-server-step1.yml\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-server-step1.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLocate the \u003Ccode class=\"literal\">ipa.csr\u003C/code> certificate signing request file on the controller and submit it to the external CA.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPlace the IdM CA certificate signed by the external CA in the controller file system so that the playbook in the next step can find it.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook with the instructions for the final step of the installation, for example \u003Ccode class=\"literal\">install-server-step2.yml\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -v -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-server-step2.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChoose one of the following options:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf your IdM deployment uses external DNS: add the DNS resource records contained in the \u003Ccode class=\"literal\">/tmp/ipa.system.records.UFRPto.db\u003C/code> file to the existing external DNS servers. The process of updating the DNS records varies depending on the particular DNS solution.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">...\nRestarting the KDC\n\u003Cspan class=\"strong strong\">\u003Cstrong>Please add records in this file to your DNS system: /tmp/ipa.system.records.UFRBto.db\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>Restarting the web server\u003C/strong>\u003C/span>\n...\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe server installation is not complete until you add the DNS records to the existing DNS servers.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf your IdM deployment uses integrated DNS:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tAdd DNS delegation from the parent domain to the IdM DNS domain. For example, if the IdM DNS domain is \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>idm.example.com\u003C/em>\u003C/span>\u003C/code>, add a name server (NS) record to the \u003Ccode class=\"literal\">example.com\u003C/code> parent domain.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\tRepeat this step each time after an IdM DNS server is installed.\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd an \u003Ccode class=\"literal\">_ntp._udp\u003C/code> service (SRV) record for your time server to your IdM DNS. The presence of the SRV record for the time server of the newly-installed IdM server in IdM DNS ensures that future replica and client installations are automatically configured to synchronize with the time server used by this primary IdM server.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"uninstalling-an-idm-server-using-an-ansible-playbook_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.10. Uninstalling an IdM server using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn an existing Identity Management (IdM) deployment, \u003Cspan class=\"strong strong\">\u003Cstrong>replica\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>server\u003C/strong>\u003C/span> are interchangeable terms.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tComplete this procedure to uninstall an IdM replica using an Ansible playbook. In this example:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIdM configuration is uninstalled from \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> and the associated host entry are removed from the IdM topology.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tFor the \u003Ccode class=\"literal\">ipaserver_remove_from_topology\u003C/code> option to work, the system must be running on RHEL 9.3 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe system is running on RHEL 9.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>uninstall-server.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to uninstall an IdM replica\n  hosts: ipaserver\n  become: true\n\n  roles:\n  - role: ipaserver\n    ipaserver_remove_from_domain: true\n    state: absent\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipaserver_remove_from_domain\u003C/code> option unenrolls the host from the IdM topology.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf the removal of server123.idm.example.com should lead to a disconnected topology, the removal will be aborted. For more information, see \u003Ca class=\"link\" href=\"#using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible\" title=\"2.11. Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology\">Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUninstall the replica:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/inventory &lt;path_to_playbooks_directory&gt;/uninstall-server.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure that all name server (NS) DNS records pointing to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS. For more information on how to delete DNS records from IdM, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#deleting-dns-records-in-the-idm-cli_managing-dns-records-in-idm\">Deleting DNS records in the IdM CLI\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">2.11. Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn an existing Identity Management (IdM) deployment, \u003Cspan class=\"strong strong\">\u003Cstrong>replica\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>server\u003C/strong>\u003C/span> are interchangeable terms.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tComplete this procedure to uninstall an IdM replica using an Ansible playbook even if this results in a disconnected IdM topology. In the example, \u003Cspan class=\"strong strong\">\u003Cstrong>server456.idm.example.com\u003C/strong>\u003C/span> is used to remove the replica and the associated host entry with the FQDN of \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> from the topology, leaving certain replicas disconnected from \u003Cspan class=\"strong strong\">\u003Cstrong>server456.idm.example.com\u003C/strong>\u003C/span> and the rest of the topology.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf removing a replica from the topology using only the \u003Ccode class=\"literal\">remove_server_from_domain\u003C/code> does not result in a disconnected topology, no other options are required. If the result is a disconnected topology, you must specify which part of the domain you want to preserve. In that case, you must do the following:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSpecify the \u003Ccode class=\"literal\">ipaserver_remove_on_server\u003C/code> value.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSet \u003Ccode class=\"literal\">ipaserver_ignore_topology_disconnect\u003C/code> to True.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe system is running on RHEL 9.3 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the managed node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe system is running on 9 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>uninstall-server.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to uninstall an IdM replica\n  hosts: ipaserver\n  become: true\n\n  roles:\n  - role: ipaserver\n    ipaserver_remove_from_domain: true\n    ipaserver_remove_on_server: server456.idm.example.com\n    ipaserver_ignore_topology_disconnect: true\n    state: absent\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tUnder normal circumstances, if the removal of server123 does not result in a disconnected topology: if the value for \u003Ccode class=\"literal\">ipaserver_remove_on_server\u003C/code> is not set, the replica on which server123 is removed is automatically determined using the replication agreements of server123.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUninstall the replica:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/uninstall-server.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure that all name server (NS) DNS records pointing to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS. For more information on how to delete DNS records from IdM, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#deleting-dns-records-in-the-idm-cli_managing-dns-records-in-idm\">Deleting DNS records in the IdM CLI\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html#inventory-basics-formats-hosts-and-groups\">Inventory basics: formats, hosts, and groups\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can see sample Ansible playbooks for installing an IdM server and a list of possible variables in the \u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/tree/master/roles/ipaserver\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream documentation\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"installing-an-Identity-Management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 3. Installing an Identity Management replica using an Ansible playbook\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tConfiguring a system as an IdM replica by using \u003Ca class=\"link\" href=\"https://www.ansible.com/\">Ansible\u003C/a> enrolls it into an IdM domain and enables the system to use IdM services on IdM servers in the domain.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe deployment is managed by the \u003Ccode class=\"literal\">ipareplica\u003C/code> Ansible role. The role can use the autodiscovery mode for identifying the IdM servers, domain and other settings. However, if you deploy multiple replicas in a tier-like model, with different groups of replicas being deployed at different times, you must define specific servers or replicas for each group.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-the-ansible-freeipa-package_server-ansible\">ansible-freeipa\u003C/a> package on the Ansible control node.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou understand the general \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/index.html\">Ansible\u003C/a> and IdM concepts.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/planning_identity_management/index#planning-the-replica-topology_planning-identity-management\">planned the replica topology in your deployment\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.1. Specifying the base, server and client variables for installing the IdM replica\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to configure the inventory file for installing an IdM replica.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the inventory file for editing. Specify the fully-qualified domain names (FQDN) of the hosts to become IdM replicas. The FQDNs must be valid DNS names:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOnly numbers, alphabetic characters, and hyphens (\u003Ccode class=\"literal\">-\u003C/code>) are allowed. For example, underscores are not allowed and can cause DNS failures.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe host name must be all lower-case.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of a simple inventory hosts file with only the replicas' FQDN defined\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[ipareplicas]\nreplica1.idm.example.com\nreplica2.idm.example.com\nreplica3.idm.example.com\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the IdM server is already deployed and the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Provide additional information in the inventory file based on how you have designed your topology:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Scenario 1\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you want to avoid autodiscovery and have all replicas listed in the \u003Ccode class=\"literal\">[ipareplicas]\u003C/code> section use a specific IdM server, set the server in the \u003Ccode class=\"literal\">[ipaservers]\u003C/code> section of the inventory file.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example inventory hosts file with the FQDN of the IdM server and replicas defined\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[ipaservers]\nserver.idm.example.com\n\n[ipareplicas]\nreplica1.idm.example.com\nreplica2.idm.example.com\nreplica3.idm.example.com\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Scenario 2\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tAlternatively, if you want to avoid autodiscovery but want to deploy specific replicas with specific servers, set the servers for specific replicas individually in the \u003Ccode class=\"literal\">[ipareplicas]\u003C/code> section in the inventory file.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example inventory file with a specific IdM server defined for a specific replica\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[ipaservers]\nserver.idm.example.com\nreplica1.idm.example.com\n\n[ipareplicas]\nreplica2.idm.example.com\n\u003Cspan class=\"strong strong\">\u003Cstrong>replica3.idm.example.com ipareplica_servers=replica1.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIn the example above, \u003Ccode class=\"literal\">replica3.idm.example.com\u003C/code> uses the already deployed \u003Ccode class=\"literal\">replica1.idm.example.com\u003C/code> as its replication source.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Scenario 3\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you are deploying several replicas in one batch and time is a concern to you, multitier replica deployment can be useful for you. Define specific groups of replicas in the inventory file, for example \u003Ccode class=\"literal\">[ipareplicas_tier1]\u003C/code> and \u003Ccode class=\"literal\">[ipareplicas_tier2]\u003C/code>, and design separate plays for each group in the \u003Ccode class=\"literal\">install-replica.yml\u003C/code> playbook.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example inventory file with replica tiers defined\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[ipaservers]\nserver.idm.example.com\n\n\u003Cspan class=\"strong strong\">\u003Cstrong>[ipareplicas_tier1]\u003C/strong>\u003C/span>\nreplica1.idm.example.com\n\n\u003Cspan class=\"strong strong\">\u003Cstrong>[ipareplicas_tier2]\u003C/strong>\u003C/span>\nreplica2.idm.example.com \\ ipareplica_servers=replica1.idm.example.com,server.idm.example.com\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tThe first entry in \u003Ccode class=\"literal\">ipareplica_servers\u003C/code> will be used. The second entry will be used as a fallback option. When using multiple tiers for deploying IdM replicas, you must have separate tasks in the playbook to first deploy replicas from tier1 and then replicas from tier2:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of a playbook file with different plays for different replica groups\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">---\n- name: Playbook to configure IPA replicas (tier1)\n  hosts: ipareplicas_tier1\n  become: true\n\n  roles:\n  - role: ipareplica\n    state: present\n\n- name: Playbook to configure IPA replicas (tier2)\n  hosts: ipareplicas_tier2\n  become: true\n\n  roles:\n  - role: ipareplica\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Provide additional information regarding \u003Ccode class=\"literal\">firewalld\u003C/code> and DNS:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Scenario 1\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you want the replica to use a specified \u003Ccode class=\"literal\">firewalld\u003C/code> zone, for example an internal one, you can specify it in the inventory file. If you do not set a custom zone, IdM will add its services to the default \u003Ccode class=\"literal\">firewalld\u003C/code> zone. The predefined default zone is \u003Ccode class=\"literal\">public\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\tThe specified \u003Ccode class=\"literal\">firewalld\u003C/code> zone must exist and be permanent.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of a simple inventory hosts file with a custom \u003Ccode class=\"literal\">firewalld\u003C/code> zone\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[ipaservers]\nserver.idm.example.com\n\n[ipareplicas]\nreplica1.idm.example.com\nreplica2.idm.example.com\nreplica3.idm.example.com\n[...]\n\n[ipareplicas:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipareplica_firewalld_zone=\u003Cspan class=\"emphasis\">\u003Cem>custom zone\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Scenario 2\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tIf you want the replica to host the IdM DNS service, add the \u003Cspan class=\"strong strong\">\u003Cstrong>ipareplica_setup_dns=true\u003C/strong>\u003C/span> line to the \u003Ccode class=\"literal\">[ipareplicas:vars]\u003C/code> section. Additionally, specify if you want to use per-server DNS forwarders:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tTo configure per-server forwarders, add the \u003Ccode class=\"literal\">ipareplica_forwarders\u003C/code> variable and a list of strings to the \u003Ccode class=\"literal\">[ipareplicas:vars]\u003C/code> section, for example: \u003Cspan class=\"strong strong\">\u003Cstrong>ipareplica_forwarders=192.0.2.1,192.0.2.2\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tTo configure no per-server forwarders, add the following line to the \u003Ccode class=\"literal\">[ipareplicas:vars]\u003C/code> section: \u003Cspan class=\"strong strong\">\u003Cstrong>ipareplica_no_forwarders=true\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\tTo configure per-server forwarders based on the forwarders listed in the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file of the replica, add the \u003Ccode class=\"literal\">ipareplica_auto_forwarders\u003C/code> variable to the \u003Ccode class=\"literal\">[ipareplicas:vars]\u003C/code> section.\n\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example inventory file with instructions to set up DNS and per-server forwarders on the replicas\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[ipaservers]\nserver.idm.example.com\n\n[ipareplicas]\nreplica1.idm.example.com\nreplica2.idm.example.com\nreplica3.idm.example.com\n[...]\n\n[ipareplicas:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipareplica_setup_dns=true\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipareplica_forwarders=192.0.2.1,192.0.2.2\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Scenario 3\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tSpecify the DNS resolver using the \u003Ccode class=\"literal\">ipaclient_configure_dns_resolve\u003C/code> and \u003Ccode class=\"literal\">ipaclient_dns_servers\u003C/code> options (if available) to simplify cluster deployments. This is especially useful if your IdM deployment is using integrated DNS:\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>An inventory file snippet specifying a DNS resolver:\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[...]\n[ipaclient:vars]\nipaclient_configure_dns_resolver=true\nipaclient_dns_servers=192.168.100.1\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipaclient_dns_servers\u003C/code> list must contain only IP addresses. Host names are not allowed.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003C/dl>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/ipareplica/README.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.2. Specifying the credentials for installing the IdM replica using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to configure the authorization for installing the IdM replica.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the \u003Cspan class=\"strong strong\">\u003Cstrong>password of a user authorized to deploy replicas\u003C/strong>\u003C/span>, for example the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRed Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example \u003Ccode class=\"literal\">install-replica.yml\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook file using principal from inventory file and password from an Ansible Vault file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">- name: Playbook to configure IPA replicas\n  hosts: ipareplicas\n  become: true\n  vars_files:\n  - \u003Ccode class=\"literal\">playbook_sensitive_data.yml\u003C/code>\n\n  roles:\n  - role: ipareplica\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor details how to use Ansible Vault, see the official \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Ansible Vault\u003C/a> documentation.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLess securely, provide the credentials of \u003Ccode class=\"literal\">admin\u003C/code> directly in the inventory file. Use the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> option in the \u003Ccode class=\"literal\">[ipareplicas:vars]\u003C/code> section of the inventory file. The inventory file and the \u003Ccode class=\"literal\">install-replica.yml\u003C/code> playbook file can then look as follows:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example inventory hosts.replica file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[...]\n[ipareplicas:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password=Secret123\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook using principal and password from inventory file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">- name: Playbook to configure IPA replicas\n  hosts: ipareplicas\n  become: true\n\n  roles:\n  - role: ipareplica\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAlternatively but also less securely, provide the credentials of another user authorized to deploy a replica directly in the inventory file. To specify a different authorized user, use the \u003Ccode class=\"literal\">ipaadmin_principal\u003C/code> option for the user name, and the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> option for the password. The inventory file and the \u003Ccode class=\"literal\">install-replica.yml\u003C/code> playbook file can then look as follows:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example inventory hosts.replica file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">[...]\n[ipareplicas:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_principal=my_admin\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password=my_admin_secret123\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook using principal and password from inventory file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"literallayout\">- name: Playbook to configure IPA replicas\n  hosts: ipareplicas\n  become: true\n\n  roles:\n  - role: ipareplica\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tAs of RHEL 9.5, during the installation of an IdM replica, checking if the provided Kerberos principal has the required privilege also extends to checking user ID overrides. As a result, you can deploy a replica using the credentials of an AD administrator that is configured to act as an IdM administrator.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/ipareplica/README.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.3. Deploying an IdM replica using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to use an Ansible playbook to deploy an IdM replica.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-replica-using-an-ansible-playbook_installing-identity-management#specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible\">the inventory file for installing an IdM replica\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-replica-using-an-ansible-playbook_installing-identity-management#specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible\">the authorization for installing the IdM replica\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-replica.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"uninstalling-an-idm-replica-using-an-ansible-playbook_replica-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">3.4. Uninstalling an IdM replica using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn an existing Identity Management (IdM) deployment, \u003Cspan class=\"strong strong\">\u003Cstrong>replica\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>server\u003C/strong>\u003C/span> are interchangeable terms. For information on how to uninstall an IdM server, see \u003Ca class=\"link\" href=\"#uninstalling-an-idm-server-using-an-ansible-playbook_server-ansible\" title=\"2.10. Uninstalling an IdM server using an Ansible playbook\">Uninstalling an IdM server using an Ansible playbook\u003C/a> or \u003Ca class=\"link\" href=\"#using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible\" title=\"2.11. Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology\">Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/overview-of-identity-management-and-access-control-planning-identity-management#introduction-to-ipa-servers-and-clients_overview-of-idm-and-access-control\">Introduction to IdM servers and clients\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"installing-an-Identity-Management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 4. Installing an Identity Management client using an Ansible playbook\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tLearn more about how to configure a system as an Identity Management (IdM) client by using \u003Ca class=\"link\" href=\"https://www.ansible.com/\">Ansible\u003C/a>. Configuring a system as an IdM client enrolls it into an IdM domain and enables the system to use IdM services on IdM servers in the domain.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe deployment is managed by the \u003Ccode class=\"literal\">ipaclient\u003C/code> Ansible role. By default, the role uses the autodiscovery mode for identifying the IdM servers, domain and other settings. The role can be modified to have the Ansible playbook use the settings specified, for example in the inventory file.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-the-ansible-freeipa-package_server-ansible\">ansible-freeipa\u003C/a> package on the Ansible control node.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou understand the general \u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/index.html\">Ansible\u003C/a> and IdM concepts.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.1. Setting the parameters of the inventory file for the autodiscovery client installation mode\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo install an Identity Management (IdM) client using an Ansible playbook, configure the target host parameters in an inventory file, for example \u003Ccode class=\"literal\">inventory\u003C/code>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe information about the host\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe authorization for the task\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe inventory file can be in one of many formats, depending on the inventory plugins you have. The \u003Ccode class=\"literal\">INI-like\u003C/code> format is one of Ansible’s defaults and is used in the examples below.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo use smart cards with the graphical user interface in RHEL, ensure that you include the \u003Ccode class=\"literal\">ipaclient_mkhomedir\u003C/code> variable in your Ansible playbook.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen your \u003Ccode class=\"literal\">inventory\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the fully-qualified hostname (FQDN) of the host to become an IdM client. The fully qualified domain name must be a valid DNS name:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOnly numbers, alphabetic characters, and hyphens (\u003Ccode class=\"literal\">-\u003C/code>) are allowed. For example, underscores are not allowed and can cause DNS failures.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe host name must be all lower-case. No capital letters are allowed.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf the SRV records are set properly in the IdM DNS zone, the script automatically discovers all the other required values.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of a simple inventory hosts file with only the client FQDN defined\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[ipaclients]\nclient.idm.example.com\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the credentials for enrolling the client. The following authentication methods are available:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>password of a user authorized to enroll clients\u003C/strong>\u003C/span>. This is the default option.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tRed Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example \u003Ccode class=\"literal\">install-client.yml\u003C/code>, directly:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook file using principal from inventory file and password from an Ansible Vault file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">- name: Playbook to configure IPA clients with username/password\n  hosts: ipaclients\n  become: true\n  vars_files:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>playbook_sensitive_data.yml\u003C/strong>\u003C/span>\n\n  roles:\n  - role: ipaclient\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tLess securely, provide the credentials of \u003Ccode class=\"literal\">admin\u003C/code> using the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> option in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section of the \u003Ccode class=\"literal\">inventory/hosts\u003C/code> file. Alternatively, to specify a different authorized user, use the \u003Ccode class=\"literal\">ipaadmin_principal\u003C/code> option for the user name, and the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> option for the password. The \u003Ccode class=\"literal\">inventory/hosts\u003C/code> inventory file and the \u003Ccode class=\"literal\">install-client.yml\u003C/code> playbook file can then look as follows:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example inventory hosts file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[...]\n[ipaclients:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_principal=my_admin\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password=Secret123\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example Playbook using principal and password from inventory file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">- name: Playbook to unconfigure IPA clients\n  hosts: ipaclients\n  become: true\n\n  roles:\n  - role: ipaclient\n    state: true\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>client keytab\u003C/strong>\u003C/span> from the previous enrollment if it is still available.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis option is available if the system was previously enrolled as an Identity Management client. To use this authentication method, uncomment the \u003Ccode class=\"literal\">#ipaclient_keytab\u003C/code> option, specifying the path to the file storing the keytab, for example in the \u003Ccode class=\"literal\">[ipaclient:vars]\u003C/code> section of \u003Ccode class=\"literal\">inventory/hosts\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tA \u003Cspan class=\"strong strong\">\u003Cstrong>random, one-time password\u003C/strong>\u003C/span> (OTP) to be generated during the enrollment. To use this authentication method, use the \u003Ccode class=\"literal\">ipaclient_use_otp=true\u003C/code> option in your inventory file. For example, you can uncomment the \u003Ccode class=\"literal\">ipaclient_use_otp=true\u003C/code> option in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section of the \u003Ccode class=\"literal\">inventory/hosts\u003C/code> file. Note that with OTP you must also specify one of the following options:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>password of a user authorized to enroll clients\u003C/strong>\u003C/span>, for example by providing a value for \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section of the \u003Ccode class=\"literal\">inventory/hosts\u003C/code> file.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>admin keytab\u003C/strong>\u003C/span>, for example by providing a value for \u003Ccode class=\"literal\">ipaadmin_keytab\u003C/code> in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section of \u003Ccode class=\"literal\">inventory/hosts\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Specify the DNS resolver using the \u003Ccode class=\"literal\">ipaclient_configure_dns_resolve\u003C/code> and \u003Ccode class=\"literal\">ipaclient_dns_servers\u003C/code> options (if available) to simplify cluster deployments. This is especially useful if your IdM deployment is using integrated DNS:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>An inventory file snippet specifying a DNS resolver:\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[...]\n[ipaclients:vars]\nipaadmin_password: \"{{ ipaadmin_password }}\"\nipaclient_domain=idm.example.com\nipaclient_configure_dns_resolver=true\nipaclient_dns_servers=192.168.100.1\u003C/pre>\n\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipaclient_dns_servers\u003C/code> list must contain only IP addresses. Host names are not allowed.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tStarting with RHEL 9.3, you can also specify the \u003Ccode class=\"literal\">ipaclient_subid: true\u003C/code> option to have subid ranges configured for IdM users on the IdM level.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/ipaclient/README.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management/index#assembly_managing-subid-ranges-manually_configuring-and-managing-idm\">Managing subID ranges manually\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.2. Setting the parameters of the inventory file when autodiscovery is not possible during client installation\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tTo install an Identity Management client using an Ansible playbook, configure the target host parameters in an inventory file, for example \u003Ccode class=\"literal\">inventory/hosts\u003C/code>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe information about the host, the IdM server and the IdM domain or the IdM realm\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe authorization for the task\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe inventory file can be in one of many formats, depending on the inventory plugins you have. The \u003Ccode class=\"literal\">INI-like\u003C/code> format is one of Ansible’s defaults and is used in the examples below.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo use smart cards with the graphical user interface in RHEL, ensure that you include the \u003Ccode class=\"literal\">ipaclient_mkhomedir\u003C/code> variable in your Ansible playbook.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the fully-qualified hostname (FQDN) of the host to become an IdM client. The fully qualified domain name must be a valid DNS name:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOnly numbers, alphabetic characters, and hyphens (\u003Ccode class=\"literal\">-\u003C/code>) are allowed. For example, underscores are not allowed and can cause DNS failures.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe host name must be all lower-case. No capital letters are allowed.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify other options in the relevant sections of the \u003Ccode class=\"literal\">inventory/hosts\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe FQDN of the servers in the \u003Ccode class=\"literal\">[ipaservers]\u003C/code> section to indicate which IdM server the client will be enrolled with\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOne of the two following options:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipaclient_domain\u003C/code> option in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section to indicate the DNS domain name of the IdM server the client will be enrolled with\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">ipaclient_realm\u003C/code> option in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section to indicate the name of the Kerberos realm controlled by the IdM server\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example of an inventory hosts file with the client FQDN, the server FQDN and the domain defined\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[ipaclients]\n\u003Cspan class=\"strong strong\">\u003Cstrong>client.idm.example.com\u003C/strong>\u003C/span>\n\n[ipaservers]\n\u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>\n\n[ipaclients:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaclient_domain=idm.example.com\u003C/strong>\u003C/span>\n[...]\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the credentials for enrolling the client. The following authentication methods are available:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>password of a user authorized to enroll clients\u003C/strong>\u003C/span>. This is the default option.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tRed Hat recommends using the Ansible Vault to store the password, and referencing the Vault file from the playbook file, for example \u003Ccode class=\"literal\">install-client.yml\u003C/code>, directly:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example playbook file using principal from inventory file and password from an Ansible Vault file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">- name: Playbook to configure IPA clients with username/password\n  hosts: ipaclients\n  become: true\n  vars_files:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>playbook_sensitive_data.yml\u003C/strong>\u003C/span>\n\n  roles:\n  - role: ipaclient\n    state: present\u003C/pre>\n\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLess securely, the credentials of \u003Ccode class=\"literal\">admin\u003C/code> to be provided using the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> option in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section of the \u003Ccode class=\"literal\">inventory/hosts\u003C/code> file. Alternatively, to specify a different authorized user, use the \u003Ccode class=\"literal\">ipaadmin_principal\u003C/code> option for the user name, and the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> option for the password. The \u003Ccode class=\"literal\">install-client.yml\u003C/code> playbook file can then look as follows:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example inventory hosts file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">[...]\n[ipaclients:vars]\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_principal=my_admin\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password=Secret123\u003C/strong>\u003C/span>\u003C/pre>\n\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Example Playbook using principal and password from inventory file\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\t\t\n\u003Cpre class=\"screen\">- name: Playbook to unconfigure IPA clients\n  hosts: ipaclients\n  become: true\n\n  roles:\n  - role: ipaclient\n    state: true\u003C/pre>\n\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>client keytab\u003C/strong>\u003C/span> from the previous enrollment if it is still available:\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis option is available if the system was previously enrolled as an Identity Management client. To use this authentication method, uncomment the \u003Ccode class=\"literal\">ipaclient_keytab\u003C/code> option, specifying the path to the file storing the keytab, for example in the \u003Ccode class=\"literal\">[ipaclient:vars]\u003C/code> section of \u003Ccode class=\"literal\">inventory/hosts\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tA \u003Cspan class=\"strong strong\">\u003Cstrong>random, one-time password\u003C/strong>\u003C/span> (OTP) to be generated during the enrollment. To use this authentication method, use the \u003Ccode class=\"literal\">ipaclient_use_otp=true\u003C/code> option in your inventory file. For example, you can uncomment the \u003Ccode class=\"literal\">#ipaclient_use_otp=true\u003C/code> option in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section of the \u003Ccode class=\"literal\">inventory/hosts\u003C/code> file. Note that with OTP you must also specify one of the following options:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>password of a user authorized to enroll clients\u003C/strong>\u003C/span>, for example by providing a value for \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section of the \u003Ccode class=\"literal\">inventory/hosts\u003C/code> file.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>admin keytab\u003C/strong>\u003C/span>, for example by providing a value for \u003Ccode class=\"literal\">ipaadmin_keytab\u003C/code> in the \u003Ccode class=\"literal\">[ipaclients:vars]\u003C/code> section of \u003Ccode class=\"literal\">inventory/hosts\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tStarting with RHEL 9.3, you can also specify the \u003Ccode class=\"literal\">ipaclient_subid: true\u003C/code> option to have subid ranges configured for IdM users on the IdM level.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/ipaclient/README.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management/index#assembly_managing-subid-ranges-manually_configuring-and-managing-idm\">Managing subID ranges manually\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.3. Authorization options for IdM client enrollment using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can authorize IdM client enrollment by using any of the following methods:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA random, one-time password (OTP) + administrator password\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA random, one-time password (OTP) + an admin keytab\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe client keytab from the previous enrollment\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe password of a user authorized to enroll a client (\u003Ccode class=\"literal\">admin\u003C/code>) stored in an inventory file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe password of a user authorized to enroll a client (\u003Ccode class=\"literal\">admin\u003C/code>) stored in an Ansible vault\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIt is possible to have the OTP generated by an IdM administrator before the IdM client installation. In that case, you do not need any credentials for the installation other than the OTP itself.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following are sample inventory files for these methods:\n\t\t\t\u003C/p>\u003Crh-table id=\"sample-inventory-file_client-ansible\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 4.1. Sample inventory files\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 29%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 71%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464247438784\" scope=\"col\">Authorization option\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464247437696\" scope=\"col\">Inventory file\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247438784\"> \u003Cp>\n\t\t\t\t\t\t\t\tA random, one-time password (OTP) + administrator password\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247437696\">\n\u003Cpre class=\"screen\">[ipaclients:vars]\nipaadmin_password=Secret123\nipaclient_use_otp=true\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247438784\"> \u003Cp>\n\t\t\t\t\t\t\t\tA random, one-time password (OTP)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247437696\">\n\u003Cpre class=\"screen\">[ipaclients:vars]\nipaclient_otp=&lt;W5YpARl=7M.&gt;\u003C/pre>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tThis scenario assumes that the OTP was already generated by an IdM \u003Ccode class=\"literal\">admin\u003C/code> before the installation.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247438784\"> \u003Cp>\n\t\t\t\t\t\t\t\tA random, one-time password (OTP) + an admin keytab\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247437696\">\n\u003Cpre class=\"screen\">[ipaclients:vars]\nipaadmin_keytab=/root/admin.keytab\nipaclient_use_otp=true\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247438784\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe client keytab from the previous enrollment\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247437696\">\n\u003Cpre class=\"screen\">[ipaclients:vars]\nipaclient_keytab=/root/krb5.keytab\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247438784\"> \u003Cp>\n\t\t\t\t\t\t\t\tPassword of an \u003Ccode class=\"literal\">admin\u003C/code> user stored in an inventory file\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247437696\">\n\u003Cpre class=\"screen\">[ipaclients:vars]\nipaadmin_password=Secret123\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247438784\"> \u003Cp>\n\t\t\t\t\t\t\t\tPassword of an \u003Ccode class=\"literal\">admin\u003C/code> user stored in an Ansible vault file\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464247437696\">\n\u003Cpre class=\"screen\">[ipaclients:vars]\n[...]\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tIf you are using the password of an \u003Ccode class=\"literal\">admin\u003C/code> user stored in an Ansible vault file, the corresponding playbook file must have an additional \u003Ccode class=\"literal\">vars_files\u003C/code> directive:\n\t\t\t\u003C/p>\u003Crh-table id=\"user-password-stored-in-ansible-vault_client-ansible\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 4.2. User password stored in an Ansible vault\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 29%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 71%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464244897408\" scope=\"col\">Inventory file\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464244896320\" scope=\"col\">Playbook file\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464244897408\">\n\u003Cpre class=\"screen\">[ipaclients:vars]\n[...]\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464244896320\">\n\u003Cpre class=\"screen\">- name: Playbook to configure IPA clients\n  hosts: ipaclients\n  become: true\n  vars_files:\n  - ansible_vault_file.yml\n\n  roles:\n  - role: ipaclient\n    state: present\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tIn all the other authorization scenarios described above, a basic playbook file could look as follows:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">- name: Playbook to configure IPA clients\n  hosts: ipaclients\n  become: true\n\n  roles:\n  - role: ipaclient\n    state: true\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tAs of RHEL 9.2, in the two OTP authorization scenarios described above, the requesting of the administrator’s TGT by using the \u003Ccode class=\"literal\">kinit\u003C/code> command occurs on the first specified or discovered IdM server. Therefore, no additional modification of the Ansible control node is required. Before RHEL 9.2, the \u003Ccode class=\"literal\">krb5-workstation\u003C/code> package was required on the control node.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.4. Deploying an IdM client using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to use an Ansible playbook to deploy an IdM client in your IdM environment.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have set the parameters of the IdM client deployment to correspond to your deployment scenario:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management#setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible\">Setting the parameters of the inventory file for the autodiscovery client installation mode\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management#setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible\">Setting the parameters of the inventory file when autodiscovery is not possible during client installation\u003C/a>\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -v -i ~/MyPlaybooks/inventory ~/MyPlaybooks/install-client.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-the-one-time-password-method-in-ansible-to-install-an-idm-client_client-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.5. Using the one-time password method in Ansible to install an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can generate a one-time password (OTP) for a new host in Identity Management (IdM) and use it to enroll a system into the IdM domain. This procedure describes how to use Ansible to install an IdM client after generating an OTP for it on another IdM host.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis method of installing an IdM client is convenient if two system administrators with different privileges exist in your organisation:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOne that has the credentials of an IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAnother that has the required Ansible credentials, including \u003Ccode class=\"literal\">root\u003C/code> access to the host to become an IdM client.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe IdM administrator performs the first part of the procedure in which the OTP password is generated. The Ansible administrator performs the remaining part of the procedure in which the OTP is used to install an IdM client.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the IdM \u003Ccode class=\"literal\">admin\u003C/code> credentials or at least the \u003Ccode class=\"literal\">Host Enrollment\u003C/code> privilege and a permission to add DNS records in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured a user escalation method on the Ansible managed node to allow you to install an IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf your Ansible control node is running on RHEL 8.7 or earlier, you must be able to install packages on your Ansible control node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node is a Red Hat Enterprise Linux 9 system with a static IP address and a working package manager.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">SSH\u003C/code> to an IdM host as an IdM user with a role that has the \u003Ccode class=\"literal\">Host Enrollment\u003C/code> privilege and a permission to add DNS records:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>$ ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate an OTP for the new client:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[admin@server ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa host-add client.idm.example.com --ip-address=172.25.250.11 --random\u003C/strong>\u003C/span>\n --------------------------------------------------\n Added host \"client.idm.example.com\"\n --------------------------------------------------\n  Host name: client.idm.example.com\n  Random password: \u003Cspan class=\"strong strong\">\u003Cstrong>W5YpARl=7M.n\u003C/strong>\u003C/span>\n  Password: True\n  Keytab: False\n  Managed by: server.idm.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>--ip-address=\u003Cspan class=\"emphasis\">\u003Cem>&lt;your_host_ip_address&gt;\u003C/em>\u003C/span>\u003C/strong>\u003C/span> option adds the host to IdM DNS with the specified IP address.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tExit the IdM host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>exit\u003C/strong>\u003C/span>\nlogout\nConnection to server.idm.example.com closed.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the ansible controller, update the inventory file to include the random password:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[...]\n[ipaclients]\nclient.idm.example.com\n\n[ipaclients:vars]\nipaclient_domain=idm.example.com\n\u003Cspan class=\"strong strong\">\u003Cstrong>ipaclient_otp=W5YpARl=7M.n\u003C/strong>\u003C/span>\n[...]\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf your ansible controller is running RHEL ⇐ 9.1, install the \u003Ccode class=\"literal\">kinit\u003C/code> utility provided by the \u003Ccode class=\"literal\">krb5-workstation\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo dnf install krb5-workstation\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook to install the client:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -i inventory install-client.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"testing-an-Identity-Management-after-Ansible-installation_client-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.6. Testing an Identity Management client after Ansible installation\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe command-line interface (CLI) informs you that the \u003Ccode class=\"literal command\">ansible-playbook\u003C/code> command was successful, but you can also do your own test.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tTo test that the Identity Management client can obtain information about users defined on the server, check that you are able to resolve a user defined on the server. For example, to check the default \u003Ccode class=\"literal\">admin\u003C/code> user:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@client1 ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>id admin\u003C/strong>\u003C/span>\nuid=1254400000(admin) gid=1254400000(admins) groups=1254400000(admins)\u003C/pre>\u003Cp>\n\t\t\t\tTo test that authentication works correctly, \u003Ccode class=\"literal command\">su -\u003C/code> as another already existing IdM user:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@client1 ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>su - idm_user\u003C/strong>\u003C/span>\nLast login: Thu Oct 18 18:39:11 CEST 2018 from 192.168.122.1 on pts/0\n[idm_user@client1 ~]$\u003C/pre>\u003C/section>\u003Csection class=\"section\" id=\"uninstalling-an-IdM-client-using-an-Ansible-playbook_client-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">4.7. Uninstalling an IdM client using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tComplete this procedure to use an Ansible playbook to uninstall your host as an IdM client.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIdM administrator credentials.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node is a Red Hat Enterprise Linux 9 system with a static IP address.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook with the instructions to uninstall the client, for example \u003Ccode class=\"literal\">uninstall-client.yml\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -v -i ~/MyPlaybooks/inventory ~/MyPlaybooks/uninstall-client.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe uninstallation of the client only removes the basic IdM configuration from the host but leaves the configuration files on the host in case you decide to re-install the client. In addition, the uninstallation has the following limitations:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIt does not remove the client host entry from the IdM LDAP server. The uninstallation only unenrolls the host.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIt does not remove any services residing on the client from IdM.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIt does not remove the DNS entries for the client from the IdM server.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tIt does not remove the old principals for keytabs other than \u003Ccode class=\"literal\">/etc/krb5.keytab\u003C/code>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\tNote that the uninstallation does remove all certificates that were issued for the host by the IdM CA.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-client_installing-identity-management\">Uninstalling an IdM client\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 5. Preparing your environment for managing IdM using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tAs a system administrator managing Identity Management (IdM), when working with Red Hat Ansible Engine, it is good practice to do the following:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tKeep a subdirectory dedicated to Ansible playbooks in your home directory, for example \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tCopy and adapt sample Ansible playbooks from the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/*\u003C/code> and \u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/*\u003C/code> directories and subdirectories into your \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks\u003C/strong>\u003C/span> directory.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tInclude your inventory file in your \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks\u003C/strong>\u003C/span> directory.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tUsing this practice, you can find all your playbooks in one place.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tYou can run your \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> playbooks without invoking \u003Ccode class=\"literal\">root\u003C/code> privileges on the managed nodes. Exceptions include playbooks that use the \u003Ccode class=\"literal\">ipaserver\u003C/code>, \u003Ccode class=\"literal\">ipareplica\u003C/code>, \u003Ccode class=\"literal\">ipaclient\u003C/code>, \u003Ccode class=\"literal\">ipasmartcard_server\u003C/code>, \u003Ccode class=\"literal\">ipasmartcard_client\u003C/code> and \u003Ccode class=\"literal\">ipabackup\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> roles. These roles require privileged access to directories and the \u003Ccode class=\"literal\">dnf\u003C/code> software package manager.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\tThe playbooks in the Red Hat Enterprise Linux IdM documentation assume the following \u003Ca class=\"link\" href=\"#proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks\" title=\"5.1. Preparing a control node and managed nodes for managing IdM using Ansible playbooks\">security configuration\u003C/a>:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe IdM \u003Ccode class=\"literal\">admin\u003C/code> is your remote Ansible user on the managed nodes.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou store the IdM \u003Ccode class=\"literal\">admin\u003C/code> password encrypted in an Ansible vault.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou have placed the password that protects the Ansible vault in a password file.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou block access to the vault password file to everyone except your local ansible user.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tYou regularly remove and re-create the vault password file.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tConsider also \u003Ca class=\"link\" href=\"#con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks\" title=\"5.2. Different methods to provide the credentials required for ansible-freeipa playbooks\">alternative security configurations\u003C/a>.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.1. Preparing a control node and managed nodes for managing IdM using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to create the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks\u003C/strong>\u003C/span> directory and configure it so that you can use it to store and run Ansible playbooks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have installed an IdM server on your managed nodes, \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>replica.idm.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured DNS and networking so you can log in to the managed nodes, \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>server.idm.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>replica.idm.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>, directly from the control node.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange into the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/MyPlaybooks\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks/ansible.cfg\u003C/strong>\u003C/span> file with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[defaults]\ninventory = /home/\u003Cspan class=\"emphasis\">\u003Cem>your_username\u003C/em>\u003C/span>/MyPlaybooks/inventory\nremote_user = admin\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks/inventory\u003C/strong>\u003C/span> file with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[eu]\nserver.idm.example.com\n\n[us]\nreplica.idm.example.com\n\n[ipaserver:children]\neu\nus\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis configuration defines two host groups, \u003Cspan class=\"strong strong\">\u003Cstrong>eu\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>us\u003C/strong>\u003C/span>, for hosts in these locations. Additionally, this configuration defines the \u003Cspan class=\"strong strong\">\u003Cstrong>ipaserver\u003C/strong>\u003C/span> host group, which contains all hosts from the \u003Cspan class=\"strong strong\">\u003Cstrong>eu\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>us\u003C/strong>\u003C/span> groups.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Create an SSH public and private key. To simplify access in your test environment, do not set a password on the private key:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-keygen\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the SSH public key to the IdM \u003Ccode class=\"literal\">admin\u003C/code> account on each managed node:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-copy-id admin@server.idm.example.com\u003C/strong>\u003C/span>\n$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh-copy-id admin@replica.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThese commands require that you enter the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Cspan class=\"strong strong\">\u003Cstrong>password_file\u003C/strong>\u003C/span> file that contains the vault password:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>redhat\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange the permissions to modify the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>chmod 0600 password_file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault to store the IdM \u003Ccode class=\"literal\">admin\u003C/code> password:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConfigure \u003Cspan class=\"strong strong\">\u003Cstrong>password_file\u003C/strong>\u003C/span> to store the vault password:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create --vault-password-file=password_file secret.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tWhen prompted, enter the content of the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \u003Cspan class=\"emphasis\">\u003Cem>Secret123\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo use the encrypted \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in a playbook, you must use the \u003Ccode class=\"literal\">vars_file\u003C/code> directive. For example, a simple playbook to delete an IdM user can look as follows:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle users\n  hosts: ipaserver\n\n  \u003Cspan class=\"strong strong\">\u003Cstrong>vars_files:\u003C/strong>\u003C/span>\n  \u003Cspan class=\"strong strong\">\u003Cstrong>- /home/\u003Cspan class=\"emphasis\">\u003Cem>user_name\u003C/em>\u003C/span>/MyPlaybooks/secret.yml\u003C/strong>\u003C/span>\n\n  tasks:\n  - name: Delete user robot\n    ipauser:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      name: robot\n      state: absent\u003C/pre>\u003Cp>\n\t\t\t\t\tWhen executing a playbook, instruct Ansible use the vault password to decrypt \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> by adding the \u003Ccode class=\"literal\">--vault-password-file=\u003Cspan class=\"emphasis\">\u003Cem>password_file\u003C/em>\u003C/span>\u003C/code> option. For example:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -i inventory --vault-password-file=password_file del-user.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tFor security reasons, remove the vault password file at the end of each session, and repeat steps 6-8 at the start of each new session.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks\" title=\"5.2. Different methods to provide the credentials required for ansible-freeipa playbooks\">Different methods to provide the credentials required for ansible-freeipa playbooks\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management server using an Ansible playbook\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html\">How to build your inventory\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.2. Different methods to provide the credentials required for ansible-freeipa playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThere are advantages and disadvantages in the different methods for providing the credentials required for running playbooks that use \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> roles and modules.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Storing passwords in plain text in a playbook\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Benefits\u003C/strong>\u003C/span>:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNot being prompted all the time you run the playbook.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEasy to implement.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Drawbacks\u003C/strong>\u003C/span>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEveryone with access to the file can read the password. Setting wrong permissions and sharing the file, for example in an internal or external repository, can compromise security.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHigh maintenance work: if the password is changed, it needs to be changed in all playbooks.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Entering passwords interactively when you execute a playbook\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Benefits\u003C/strong>\u003C/span>:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo-one can steal the password as it is not stored anywhere.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can update the password easily.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEasy to implement.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Drawbacks\u003C/strong>\u003C/span>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf you are using Ansible playbooks in scripts, the requirement to enter the password interactively can be inconvenient.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Storing passwords in an Ansible vault and the vault password in a file:\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Benefits\u003C/strong>\u003C/span>:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user password is stored encrypted.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can update the user password easily, by creating a new Ansible vault.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can update the password file that protects the ansible vault easily, by using the \u003Ccode class=\"literal\">ansible-vault rekey --new-vault-password-file=NEW_VAULT_PASSWORD_FILE secret.yml\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf you are using Ansible playbooks in scripts, it is convenient not to have to enter the password protecting the Ansible vault interactively.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Drawbacks\u003C/strong>\u003C/span>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIt is vital that the file that contains the sensitive plain text password be protected through file permissions and other security measures.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Storing passwords in an Ansible vault and entering the vault password interactively\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Benefits\u003C/strong>\u003C/span>:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user password is stored encrypted.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo-one can steal the vault password as it is not stored anywhere.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can update the user password easily, by creating a new Ansible vault.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can update the vault password easily too, by using the \u003Ccode class=\"literal\">ansible-vault rekey \u003Cspan class=\"emphasis\">\u003Cem>file_name\u003C/em>\u003C/span>\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Drawbacks\u003C/strong>\u003C/span>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf you are using Ansible playbooks in scripts, the need to enter the vault password interactively can be inconvenient.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks\" title=\"5.1. Preparing a control node and managed nodes for managing IdM using Ansible playbooks\">Preparing a control node and managed nodes for managing IdM using Ansible playbooks\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.redhat.com/en/topics/security/what-is-zero-trust\">What is Zero trust?\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/vault_guide/index.html\">Protecting sensitive data with Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"con_the-inventory-plugin-in-ansible-freeipa_preparing-your-environment-for-managing-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">5.3. The inventory plugin in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">freeipa\u003C/code> inventory plugin to create dynamic inventories of Identity Management (IdM) servers to be used in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> playbooks. The plugin gathers data about the IdM servers in the domain, and selects only those that have a specified IdM server role or roles assigned. To use the plugin with the \u003Ccode class=\"literal\">ansible-playbook\u003C/code> command, set the value of the \u003Ccode class=\"literal\">-i\u003C/code> option to the inventory file that uses the \u003Ccode class=\"literal\">freeipa\u003C/code> plugin. As a result, the plays in the playbook are executed only against those servers that have the roles specified in the inventory file.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe example below describes how to use the \u003Ccode class=\"literal\">freeipa\u003C/code> plugin to determine the versions of the \u003Ccode class=\"literal\">bind\u003C/code> package on the IdM servers in the topology that have the DNS role.\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a file, for example \u003Cspan class=\"strong strong\">\u003Cstrong>inventory.yml\u003C/strong>\u003C/span>, to generate a dynamic inventory based on your selected IdM server role or roles. For example, to create an inventory of servers that have the IdM DNS server role:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\nplugin: freeipa\nserver: server.idm.example.com\nipaadmin_password: Secret123\nverify: ca.crt\nrole: DNS server\u003C/pre>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">server\u003C/code> defines the fully-qualified domain name of the host to start the scan.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">verify\u003C/code> defines the server TLS certificate file for verification.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">role\u003C/code> defines all the server roles that a host must have for the host to be returned.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook, for example \u003Cspan class=\"strong strong\">\u003Cstrong>bind-playbook.yml\u003C/strong>\u003C/span>, that you want to execute against the IdM servers identified by the \u003Ccode class=\"literal\">freeipa\u003C/code> inventory plugin. For example, to determine the release version of the \u003Ccode class=\"literal\">bind\u003C/code> package installed on the IdM DNS servers:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Check bind version\n  hosts: ipaservers\n\n  tasks:\n    - name: Query bind package version\n      package:\n        name: bind\n        state: present\n      register: bind_version\n\n    - name: Display bind release info\n      debug:\n        msg: \"Bind release: {{ bind_version.results[0].version }}\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t[Optional] Create a graph representation of the IdM servers identified by the plugin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-inventory -i inventory.yml --graph\u003C/strong>\u003C/span>\n@all:\n  |--@ungrouped\n  |--@ipaservers:\n  |  |--replica01.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the inventory.yml file as inventory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -i inventory.yml bind-playbook.yml\u003C/strong>\u003C/span>\n[...]\nTASK [Display bind release info] \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003Cspan class=\"strong strong\">\u003Cstrong>\u003C!--Empty-->\u003C/strong>\u003C/span>\u003C/strong>\u003C/span>\nok: [10.0.193.174] =&gt; {\n    \"msg\": \"Bind release: 9.20.3\"\n}\n[...]\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"configuring-global-IdM-settings-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 6. Configuring global IdM settings using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tUsing the Ansible \u003Ccode class=\"literal\">config\u003C/code> module, you can retrieve and set global configuration parameters for Identity Management (IdM).\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks\" title=\"6.1. Retrieving IdM configuration using an Ansible playbook\">Retrieving IdM configuration using an Ansible playbook\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-the-IdM-ca-renewal-server-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks\" title=\"6.2. Configuring the IdM CA renewal server using an Ansible playbook\">Configuring the IdM CA renewal server using an Ansible playbook\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-the-default-shell-for-IdM-users-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks\" title=\"6.3. Configuring the default shell for IdM users using an Ansible playbook\">Configuring the default shell for IdM users using an Ansible playbook\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-a-netbios-name-for-an-idm-domain-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks\" title=\"6.4. Configuring a NetBIOS name for an IdM domain by using Ansible\">Configuring a NETBIOS name for an IdM domain by using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-that-idm-users-and-groups-have-sids-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks\" title=\"6.5. Ensuring that IdM users and groups have SIDs by using Ansible\">Ensuring that IdM users and groups have SIDs by using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.1. Retrieving IdM configuration using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how you can use an Ansible playbook to retrieve information about the current global IdM configuration.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/config/retrieve-config.yml\u003C/code> Ansible playbook file for editing:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle global IdM configuration\n  hosts: ipaserver\n  become: no\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Query IPA global configuration\n    ipaconfig:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n    register: serverconfig\n\n  - debug:\n      msg: \"{{ serverconfig }}\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by changing the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe password of IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOther values, if necessary.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/config/retrieve-config.yml\u003C/strong>\u003C/span>\n[...]\nTASK [debug]\nok: [server.idm.example.com] =&gt; {\n    \"msg\": {\n        \"ansible_facts\": {\n            \"discovered_interpreter_\n        },\n        \"changed\": false,\n        \"config\": {\n            \"ca_renewal_master_server\": \"server.idm.example.com\",\n            \"configstring\": [\n                \"AllowNThash\",\n                \"KDC:Disable Last Success\"\n            ],\n            \"defaultgroup\": \"ipausers\",\n            \"defaultshell\": \"/bin/bash\",\n            \"emaildomain\": \"idm.example.com\",\n            \"enable_migration\": false,\n            \"groupsearch\": [\n                \"cn\",\n                \"description\"\n            ],\n            \"homedirectory\": \"/home\",\n            \"maxhostname\": \"64\",\n            \"maxusername\": \"64\",\n            \"pac_type\": [\n                \"MS-PAC\",\n                \"nfs:NONE\"\n            ],\n            \"pwdexpnotify\": \"4\",\n            \"searchrecordslimit\": \"100\",\n            \"searchtimelimit\": \"2\",\n            \"selinuxusermapdefault\": \"unconfined_u:s0-s0:c0.c1023\",\n            \"selinuxusermaporder\": [\n                \"guest_u:s0$xguest_u:s0$user_\n            ],\n            \"usersearch\": [\n                \"uid\",\n                \"givenname\",\n                \"sn\",\n                \"telephonenumber\",\n                \"ou\",\n                \"title\"\n            ]\n        },\n        \"failed\": false\n    }\n}\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-the-IdM-ca-renewal-server-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.2. Configuring the IdM CA renewal server using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn an Identity Management (IdM) deployment that uses an embedded certificate authority (CA), the CA renewal server maintains and renews IdM system certificates. It ensures robust IdM deployments.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor more details on the role of the IdM CA renewal server, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/fr-fr/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/ipa-ca-renewal_managing-certificates-in-idm\">Using IdM CA renewal server\u003C/a>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how you can use an Ansible playbook to configure the IdM CA renewal server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Identify the current IdM CA renewal server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa config-show | grep 'CA renewal'\u003C/strong>\u003C/span>\n  IPA CA renewal master: server.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/config/set-ca-renewal-master-server.yml\u003C/code> Ansible playbook file for editing:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle global DNS configuration\n  hosts: ipaserver\n  become: no\n  gather_facts: no\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: set ca_renewal_master_server\n    ipaconfig:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      ca_renewal_master_server: carenewal.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by changing:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe password of IdM administrator set by the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe name of the CA renewal server set by the \u003Ccode class=\"literal\">ca_renewal_master_server\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/config/set-ca-renewal-master-server.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tYou can verify that the CA renewal server has been changed:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as IdM administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest the identity of the IdM CA renewal server:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa config-show | grep ‘CA renewal’\u003C/strong>\u003C/span>\nIPA CA renewal master:  carenewal.idm.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output shows the \u003Cspan class=\"strong strong\">\u003Cstrong>carenewal.idm.example.com\u003C/strong>\u003C/span> server is the new CA renewal server.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-the-default-shell-for-IdM-users-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.3. Configuring the default shell for IdM users using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe shell is a program that accepts and interprets commands. Several shells are available in Red Hat Enterprise Linux (RHEL), such as \u003Ccode class=\"literal\">bash\u003C/code>, \u003Ccode class=\"literal\">sh\u003C/code>, \u003Ccode class=\"literal\">ksh\u003C/code>, \u003Ccode class=\"literal\">zsh\u003C/code>, \u003Ccode class=\"literal\">fish\u003C/code>, and others. \u003Ccode class=\"literal\">Bash\u003C/code>, or \u003Ccode class=\"literal\">/bin/bash\u003C/code>, is a popular shell on most Linux systems, and it is normally the default shell for user accounts on RHEL.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how you can use an Ansible playbook to configure \u003Ccode class=\"literal\">sh\u003C/code>, an alternative shell, as the default shell for IdM users.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: Use the \u003Ccode class=\"literal\">retrieve-config.yml\u003C/code> Ansible playbook to identify the current shell for IdM users. See \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/configuring-global-idm-settings-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management#retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks\">Retrieving IdM configuration using an Ansible playbook\u003C/a> for details.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/config/ensure-config-options-are-set.yml\u003C/code> Ansible playbook file for editing:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure some config options are set\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  # Set defaultlogin and maxusername\n  - ipaconfig:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      defaultshell: /bin/bash\n      maxusername: 64\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by changing the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe password of IdM administrator set by the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe default shell of the IdM users set by the \u003Ccode class=\"literal\">defaultshell\u003C/code> variable into \u003Ccode class=\"literal\">/bin/sh\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/config/ensure-config-options-are-set.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tYou can verify that the default user shell has been changed by starting a new session in IdM:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as IdM administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay the current shell:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[admin@server /]$ \u003Cspan class=\"strong strong\">\u003Cstrong>echo \"$SHELL\"\u003C/strong>\u003C/span>\n/bin/sh\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe logged-in user is using the \u003Ccode class=\"literal\">sh\u003C/code> shell.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-a-netbios-name-for-an-idm-domain-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.4. Configuring a NetBIOS name for an IdM domain by using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe NetBIOS name is used for Microsoft Windows' (SMB) type of sharing and messaging. You can use NetBIOS names to map a drive or connect to a printer.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use an Ansible playbook to configure a NetBIOS name for your Identity Management (IdM) domain.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package is installed.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Assumptions\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and that you know the vault file password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate a \u003Cspan class=\"emphasis\">\u003Cem>netbios-domain-name-present.yml\u003C/em>\u003C/span> Ansible playbook file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the following content to the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to change IdM domain netbios name\n  hosts: ipaserver\n  become: no\n  gather_facts: no\n\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n    - name: Set IdM domain netbios name\n      ipaconfig:\n        ipaadmin_password: \"{{ ipaadmin_password }}\"\n        netbios_name: IPADOM\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory \u003Cspan class=\"emphasis\">\u003Cem>netbios-domain-name-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen prompted, provide the vault file password.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/planning_identity_management/index#guidelines-for-configuring-netbios-names_planning-a-cross-forest-trust-between-idm-and-ad\">Guidelines for configuring NetBIOS names\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-that-idm-users-and-groups-have-sids-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.5. Ensuring that IdM users and groups have SIDs by using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe Identity Management (IdM) server can assign unique security identifiers (SIDs) to IdM users and groups internally, based on the data from the ID ranges of the local domain. The SIDs are stored in the user and group objects.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe goal of ensuring that IdM users and groups have SIDs is to allow the generation of the Privileged Attribute Certificate (PAC), which is the first step towards IdM-IdM trusts. If IdM users and groups have SIDs, IdM is able to issue Kerberos tickets with PAC data.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to achieve the following goals:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tGenerate SIDs for already existing IdM users and user groups.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnable the generation of SIDs for IdM new users and groups.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package is installed.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Assumptions\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and that you know the vault file password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate a \u003Cspan class=\"emphasis\">\u003Cem>sids-for-users-and-groups-present.yml\u003C/em>\u003C/span> Ansible playbook file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the following content to the file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure SIDs are enabled and users and groups have SIDs\n  hosts: ipaserver\n  become: no\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n    - name: Enable SID and generate users and groups SIDS\n      ipaconfig:\n        ipaadmin_password: \"{{ ipaadmin_password }}\"\n        enable_sid: true\n        add_sids: true\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">enable_sid\u003C/code> variable enables SID generation for future IdM users and groups. The \u003Ccode class=\"literal\">add_sids\u003C/code> variable generates SIDs for existing IdM users and groups.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tWhen using \u003Ccode class=\"literal\">add_sids: true\u003C/code>, you must also set the \u003Ccode class=\"literal\">enable_sid\u003C/code> variable to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory \u003Cspan class=\"emphasis\">\u003Cem>sids-for-users-and-groups-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tWhen prompted, provide the vault file password.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_and_managing_identity_management/index#con_the-role-of-security-and-relative-identifiers-in-idm-id-ranges_adjusting-id-ranges-manually\">The role of security and relative identifiers in IdM ID ranges\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">6.6. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">README-config.md\u003C/code> in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/config\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 7. Managing user accounts using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can manage users in IdM using Ansible playbooks. After presenting the \u003Ca class=\"link\" href=\"#user-life-cycle_managing-idm-users-using-Ansible-playbooks\" title=\"7.1. User life cycle\">user life cycle\u003C/a>, this chapter describes how to use Ansible playbooks for the following operations:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks\" title=\"7.2. Ensuring the presence of an IdM user using an Ansible playbook\">Ensuring the presence of a single user\u003C/a> listed directly in the \u003Ccode class=\"literal\">YML\u003C/code> file.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-multiple-IdM-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks\" title=\"7.3. Ensuring the presence of multiple IdM users using Ansible playbooks\">Ensuring the presence of multiple users\u003C/a> listed directly in the \u003Ccode class=\"literal\">YML\u003C/code> file.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-multiple-IdM-users-from-a-json-file-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks\" title=\"7.4. Ensuring the presence of multiple IdM users from a JSON file using Ansible playbooks\">Ensuring the presence of multiple users\u003C/a> listed in a \u003Ccode class=\"literal\">JSON\u003C/code> file that is referenced from the \u003Ccode class=\"literal\">YML\u003C/code> file.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks\" title=\"7.5. Ensuring the absence of users using Ansible playbooks\">Ensuring the absence of users\u003C/a> listed directly in the \u003Ccode class=\"literal\">YML\u003C/code> file.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"user-life-cycle_managing-idm-users-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.1. User life cycle\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdentity Management (IdM) supports three user account states:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Stage\u003C/strong>\u003C/span> users are not allowed to authenticate. This is an initial state. Some of the user account properties required for active users cannot be set, for example, group membership.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Active\u003C/strong>\u003C/span> users are allowed to authenticate. All required user account properties must be set in this state.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Preserved\u003C/strong>\u003C/span> users are former active users that are considered inactive and cannot authenticate to IdM. Preserved users retain most of the account properties they had as active users, but they are not part of any user groups.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\u003Cspan class=\"inlinemediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/163ee6fd905d1b3426a2b114cb7ee3a3/84_RHEL_IdM_0420_life-cycle.png\" alt=\"A flow chart displaying 4 items: Active users - Stage users - Preserved users - Deleted users. Arrows communicate the relationships between each kind of user: Active users can be &quot;preserved&quot; as Preserved users. Preserved users can be &quot;restored&quot; as Active users. Preserved users can be &quot;staged&quot; as Stage users and Stage users can be &quot;activated&quot; into Active users. All users can be deleted to become &quot;Deleted users&quot;.\"/>\u003C/span>\n\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can delete user entries permanently from the IdM database.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDeleted user accounts cannot be restored. When you delete a user account, all the information associated with the account is permanently lost.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tA new administrator can only be created by a user with administrator rights, such as the default admin user. If you accidentally delete all administrator accounts, the Directory Manager must create a new administrator manually in the Directory Server.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not delete the \u003Ccode class=\"literal\">admin\u003C/code> user. As \u003Ccode class=\"literal\">admin\u003C/code> is a pre-defined user required by IdM, this operation causes problems with certain commands. If you want to define and use an alternative admin user, disable the pre-defined \u003Ccode class=\"literal\">admin\u003C/code> user with \u003Ccode class=\"literal\">ipa user-disable admin\u003C/code> after you granted admin permissions to at least one different user.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not add local users to IdM. The Name Service Switch (NSS) always resolves IdM users and groups before resolving local users and groups. This means that, for example, IdM group membership does not work for local users.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.2. Ensuring the presence of an IdM user using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes ensuring the presence of a user in IdM using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the data of the user whose presence in IdM you want to ensure. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/user/add-user.yml\u003C/code> file. For example, to create user named \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span> and add \u003Cspan class=\"emphasis\">\u003Cem>Password123\u003C/em>\u003C/span> as the user password:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-java\">---\n- name: Playbook to handle users\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Create user idm_user\n    ipauser:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: idm_user\n      first: Alice\n      last: Acme\n      uid: 1000111\n      gid: 10011\n      phone: \"+555123457\"\n      email: idm_user@acme.com\n      passwordexpiration: \"2023-01-19 23:59:59\"\n      password: \"Password123\"\n      update_password: on_create\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou must use the following options to add a user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>name\u003C/strong>\u003C/span>: the login name\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>first\u003C/strong>\u003C/span>: the first name string\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>last\u003C/strong>\u003C/span>: the last name string\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor the full list of available user options, see the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-user.md\u003C/code> Markdown file.\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf you use the \u003Ccode class=\"literal\">update_password: on_create\u003C/code> option, Ansible only creates the user password when it creates the user. If the user is already created with a password, Ansible does not generate a new password.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/add-IdM-user.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can verify if the new user account exists in IdM by using the \u003Ccode class=\"literal\">ipa user-show\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as admin:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRequest a Kerberos ticket for admin:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRequest information about \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-show idm_user\u003C/strong>\u003C/span>\n  User login: idm_user\n  First name: Alice\n  Last name: Acme\n  ....\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe user named \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span> is present in IdM.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-multiple-IdM-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.3. Ensuring the presence of multiple IdM users using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes ensuring the presence of multiple users in IdM using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the data of the users whose presence you want to ensure in IdM. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/user/ensure-users-present.yml\u003C/code> file. For example, to create users \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span>, \u003Cspan class=\"emphasis\">\u003Cem>idm_user_2\u003C/em>\u003C/span>, and \u003Cspan class=\"emphasis\">\u003Cem>idm_user_3\u003C/em>\u003C/span>, and add \u003Cspan class=\"emphasis\">\u003Cem>Password123\u003C/em>\u003C/span> as the password of \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-java\">---\n- name: Playbook to handle users\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Create user idm_users\n    ipauser:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      users:\n      - name: idm_user_1\n        first: Alice\n        last: Acme\n        uid: 10001\n        gid: 10011\n        phone: \"+555123457\"\n        email: idm_user@acme.com\n        passwordexpiration: \"2023-01-19 23:59:59\"\n        password: \"Password123\"\n      - name: idm_user_2\n        first: Bob\n        last: Acme\n        uid: 100011\n        gid: 10011\n      - name: idm_user_3\n        first: Eve\n        last: Acme\n        uid: 1000111\n        gid: 10011\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf you do not specify the \u003Cspan class=\"strong strong\">\u003Cstrong>update_password: on_create\u003C/strong>\u003C/span> option, Ansible re-sets the user password every time the playbook is run: if the user has changed the password since the last time the playbook was run, Ansible re-sets password.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/add-users.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can verify if the user account exists in IdM by using the \u003Ccode class=\"literal\">ipa user-show\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as administrator:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh administrator@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay information about \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-show idm_user_1\u003C/strong>\u003C/span>\n  User login: idm_user_1\n  First name: Alice\n  Last name: Acme\n  Password: True\n  ....\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe user named \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span> is present in IdM.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-multiple-IdM-users-from-a-json-file-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.4. Ensuring the presence of multiple IdM users from a JSON file using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how you can ensure the presence of multiple users in IdM using an Ansible playbook. The users are stored in a \u003Ccode class=\"literal\">JSON\u003C/code> file.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary tasks. Reference the \u003Ccode class=\"literal\">JSON\u003C/code> file with the data of the users whose presence you want to ensure. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/ensure-users-present-ymlfile.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-java\">---\n- name: Ensure users' presence\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Include users.json\n    include_vars:\n      file: users.json\n\n  - name: Users present\n    ipauser:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      users: \"{{ users }}\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the \u003Ccode class=\"literal\">users.json\u003C/code> file, and add the IdM users into it. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/user/users.json\u003C/code> file. For example, to create users \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span>, \u003Cspan class=\"emphasis\">\u003Cem>idm_user_2\u003C/em>\u003C/span>, and \u003Cspan class=\"emphasis\">\u003Cem>idm_user_3\u003C/em>\u003C/span>, and add \u003Cspan class=\"emphasis\">\u003Cem>Password123\u003C/em>\u003C/span> as the password of \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-java\">{\n  \"users\": [\n   {\n    \"name\": \"idm_user_1\",\n    \"first\": \"Alice\",\n    \"last\": \"Acme\",\n    \"password\": \"Password123\"\n   },\n   {\n    \"name\": \"idm_user_2\",\n    \"first\": \"Bob\",\n    \"last\": \"Acme\"\n   },\n   {\n    \"name\": \"idm_user_3\",\n    \"first\": \"Eve\",\n    \"last\": \"Acme\"\n   }\n  ]\n}\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory\u003C/em>\u003C/span>/ensure-users-present-jsonfile.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou can verify if the user accounts are present in IdM using the \u003Ccode class=\"literal\">ipa user-show\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as administrator:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh administrator@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay information about \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-show idm_user_1\u003C/strong>\u003C/span>\n  User login: idm_user_1\n  First name: Alice\n  Last name: Acme\n  Password: True\n  ....\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe user named \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span> is present in IdM.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.5. Ensuring the absence of users using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how you can use an Ansible playbook to ensure that specific users are absent from IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the users whose absence from IdM you want to ensure. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/user/ensure-users-present.yml\u003C/code> file. For example, to delete users \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span>, \u003Cspan class=\"emphasis\">\u003Cem>idm_user_2\u003C/em>\u003C/span>, and \u003Cspan class=\"emphasis\">\u003Cem>idm_user_3\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-java\">---\n- name: Playbook to handle users\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Delete users idm_user_1, idm_user_2, idm_user_3\n    ipauser:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      users:\n      - name: idm_user_1\n      - name: idm_user_2\n      - name: idm_user_3\n      state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory\u003C/em>\u003C/span>/delete-users.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tYou can verify that the user accounts do not exist in IdM by using the \u003Ccode class=\"literal\">ipa user-show\u003C/code> command:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh administrator@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest information about \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-show idm_user_1\u003C/strong>\u003C/span>\nipa: ERROR: idm_user_1: user not found\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe user named \u003Cspan class=\"emphasis\">\u003Cem>idm_user_1\u003C/em>\u003C/span> does not exist in IdM.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_2\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">7.6. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-user.md\u003C/code> Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee sample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/user\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 8. Managing user groups using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThis section introduces user group management using Ansible playbooks.\n\t\t\u003C/p>\u003Cp>\n\t\t\tA user group is a set of users with common privileges, password policies, and other characteristics.\n\t\t\u003C/p>\u003Cp>\n\t\t\tA user group in Identity Management (IdM) can include:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tIdM users\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tother IdM user groups\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\texternal users, which are users that exist outside of IdM\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tThe section includes the following topics:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#the-different-group-types-in-idm_managing-user-groups-using-ansible-playbooks\" title=\"8.1. The different group types in IdM\">The different group types in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#direct-and-indirect-group-members_managing-user-groups-using-ansible-playbooks\" title=\"8.2. Direct and indirect group members\">Direct and indirect group members\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks\" title=\"8.3. Ensuring the presence of IdM groups and group members using Ansible playbooks\">Ensuring the presence of IdM groups and group members using Ansible playbooks\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_using-ansible-to-enable-ad-users-to-administer-idm_managing-user-groups-using-ansible-playbooks\" title=\"8.5. Using Ansible to enable AD users to administer IdM\">Using Ansible to enable AD users to administer IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks\" title=\"8.6. Ensuring the presence of member managers in IdM user groups using Ansible playbooks\">Ensuring the presence of member managers in IDM user groups using Ansible playbooks\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks\" title=\"8.7. Ensuring the absence of member managers in IdM user groups using Ansible playbooks\">Ensuring the absence of member managers in IDM user groups using Ansible playbooks\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"the-different-group-types-in-idm_managing-user-groups-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.1. The different group types in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdM supports the following types of groups:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">POSIX groups (the default)\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tPOSIX groups support Linux POSIX attributes for their members. Note that groups that interact with Active Directory cannot use POSIX attributes.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tPOSIX attributes identify users as separate entities. Examples of POSIX attributes relevant to users include \u003Ccode class=\"literal command\">uidNumber\u003C/code>, a user number (UID), and \u003Ccode class=\"literal command\">gidNumber\u003C/code>, a group number (GID).\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Non-POSIX groups\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tNon-POSIX groups do not support POSIX attributes. For example, these groups do not have a GID defined.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAll members of this type of group must belong to the IdM domain.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">External groups\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse external groups to add group members that exist in an identity store outside of the IdM domain, such as:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tA local system\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tAn Active Directory domain\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tA directory service\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tExternal groups do not support POSIX attributes. For example, these groups do not have a GID defined.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-table id=\"idm140464244540640\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 8.1. User groups created by default\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 80%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464244535792\" scope=\"col\">Group name\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464242152032\" scope=\"col\">Default group members\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464244535792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipausers\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464242152032\"> \u003Cp>\n\t\t\t\t\t\t\t\tAll IdM users\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464244535792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">admins\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464242152032\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsers with administrative privileges, including the default \u003Ccode class=\"literal\">admin\u003C/code> user\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464244535792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">editors\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464242152032\"> \u003Cp>\n\t\t\t\t\t\t\t\tThis is a legacy group that no longer has any special privileges\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464244535792\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">trust admins\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464242152032\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsers with privileges to manage the Active Directory trusts\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tWhen you add a user to a user group, the user gains the privileges and policies associated with the group. For example, to grant administrative privileges to a user, add the user to the \u003Ccode class=\"literal\">admins\u003C/code> group.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not delete the \u003Ccode class=\"literal\">admins\u003C/code> group. As \u003Ccode class=\"literal\">admins\u003C/code> is a pre-defined group required by IdM, this operation causes problems with certain commands.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tIn addition, IdM creates \u003Cspan class=\"emphasis\">\u003Cem>user private groups\u003C/em>\u003C/span> by default whenever a new user is created in IdM. For more information about private groups, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-groups-in-idm-cli_managing-users-groups-hosts#adding-users-without-a-user-private-group_managing-user-groups-in-idm-cli\">Adding users without a private group\u003C/a>.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"direct-and-indirect-group-members_managing-user-groups-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.2. Direct and indirect group members\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUser group attributes in IdM apply to both direct and indirect members: when group B is a member of group A, all users in group B are considered indirect members of group A.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, in the following diagram:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUser 1 and User 2 are \u003Cspan class=\"emphasis\">\u003Cem>direct members\u003C/em>\u003C/span> of group A.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUser 3, User 4, and User 5 are \u003Cspan class=\"emphasis\">\u003Cem>indirect members\u003C/em>\u003C/span> of group A.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"figure\" id=\"idm140464231199568\">\u003Cp class=\"title\">\u003Cstrong>Figure 8.1. Direct and Indirect Group Membership\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/cabd9971fadfd526f0a83c209e2b7f3b/84_RHEL_IdM_0420_user-group.png\" alt=\"A chart with Group A (with 2 users) and Group B (with 3 users). Group B is nested inside Group A so Group A contains a total of 5 users.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIf you set a password policy for user group A, the policy also applies to all users in user group B.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.3. Ensuring the presence of IdM groups and group members using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes ensuring the presence of IdM groups and group members - both users and user groups - using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe users you want to reference in your Ansible playbook exist in IdM. For details on ensuring the presence of users using Ansible, see \u003Ca class=\"link\" href=\"#managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 7. Managing user accounts using Ansible playbooks\">Managing user accounts using Ansible playbooks\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary user and group information:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-java\">---\n- name: Playbook to handle groups\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Create group ops with gid 1234\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: ops\n      gidnumber: 1234\n\n  - name: Create group sysops\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: sysops\n      user:\n      - idm_user\n\n  - name: Create group appops\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: appops\n\n  - name: Add group members sysops and appops to group ops\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: ops\n      group:\n      - sysops\n      - appops\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/add-group-members.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tYou can verify if the \u003Cspan class=\"strong strong\">\u003Cstrong>ops\u003C/strong>\u003C/span> group contains \u003Cspan class=\"strong strong\">\u003Cstrong>sysops\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>appops\u003C/strong>\u003C/span> as direct members and \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> as an indirect member by using the \u003Ccode class=\"literal\">ipa group-show\u003C/code> command:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about \u003Cspan class=\"emphasis\">\u003Cem>ops\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ipaserver]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa group-show ops\u003C/strong>\u003C/span>\n  Group name: ops\n  GID: 1234\n  Member groups: sysops, appops\n  Indirect Member users: idm_user\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>appops\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>sysops\u003C/strong>\u003C/span> groups - the latter including the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> user - exist in IdM.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-group.md\u003C/code> Markdown file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-add-multiple-idm-groups-in-a-single-task_managing-user-groups-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.4. Using Ansible to add multiple IdM groups in a single task\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipagroup\u003C/code> module to add, modify, and delete multiple Identity Management (IdM) user groups with a single Ansible task. For that, use the \u003Ccode class=\"literal\">groups\u003C/code> option of the \u003Ccode class=\"literal\">ipagroup\u003C/code> module.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUsing the \u003Ccode class=\"literal\">groups\u003C/code> option, you can also specify multiple group variables that only apply to a particular group. Define this group by the \u003Ccode class=\"literal\">name\u003C/code> variable, which is the only mandatory variable for the \u003Ccode class=\"literal\">groups\u003C/code> option.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to ensure the presence of the \u003Cspan class=\"strong strong\">\u003Cstrong>sysops\u003C/strong>\u003C/span> and the \u003Cspan class=\"strong strong\">\u003Cstrong>appops\u003C/strong>\u003C/span> groups in IdM in a single task. Define the sysops group as a nonposix group and the appops group as an external group.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using RHEL 9.3 and later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>add-nonposix-and-external-groups.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">---\n- name: Playbook to add nonposix and external groups\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Add nonposix group sysops and external group appops\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      groups:\n      - name: sysops\n        nonposix: true\n      - name: appops\n        external: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/add-nonposix-and-external-groups.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-group.md\">The group module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-ansible-to-enable-ad-users-to-administer-idm_managing-user-groups-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.5. Using Ansible to enable AD users to administer IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that a user ID override is present in an Identity Management (IdM) group. The user ID override is the override of an Active Directory (AD) user that you created in the Default Trust View after you established a trust with AD. As a result of running the playbook, an AD user, for example an AD administrator, is able to fully administer IdM without having two different accounts and passwords.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_trust_between_idm_and_ad/index\">installed a trust with AD\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user ID override of the AD user already exists in IdM. If it does not, create it with the \u003Ccode class=\"literal\">ipa idoverrideuser-add 'default trust view' \u003Cspan class=\"emphasis\">\u003Cem>ad_user@ad.example.com\u003C/em>\u003C/span>\u003C/code> command.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks\">group to which you are adding the user ID override already exists in IdM\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are using the 4.8.7 version of IdM or later. To view the version of IdM you have installed on your server, enter \u003Ccode class=\"literal\">ipa --version\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an \u003Ccode class=\"literal\">add-useridoverride-to-group.yml\u003C/code> playbook with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure presence of users in a group\n  hosts: ipaserver\n\n\n  - name: Ensure the ad_user@ad.example.com user ID override is a member of the admins group:\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: admins\n      idoverrideuser:\n      - ad_user@ad.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the example:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSecret123 is the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">admins\u003C/code> is the name of the IdM POSIX group to which you are adding the \u003Cspan class=\"strong strong\">\u003Cstrong>ad_user@ad.example.com\u003C/strong>\u003C/span> ID override. Members of this group have full administrator privileges.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>ad_user@ad.example.com\u003C/strong>\u003C/span> is the user ID override of an AD administrator. The user is stored in the AD domain with which a trust has been established.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory add-useridoverride-to-group.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/enabling-ad-users-to-administer-idm_managing-users-groups-hosts#id-overrides-for-ad-users_enabling-ad-users-to-administer-idm\">ID overrides for AD users\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t/usr/share/doc/ansible-freeipa/README-group.md\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t/usr/share/doc/ansible-freeipa/playbooks/user\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/assembly_using-id-views-for-active-directory-users_managing-users-groups-hosts\">Using ID views in Active Directory environments\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/enabling-ad-users-to-administer-idm_managing-users-groups-hosts\">Enabling AD users to administer IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.6. Ensuring the presence of member managers in IdM user groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes ensuring the presence of IdM member managers - both users and user groups - using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou must have the name of the user or group you are adding as member managers and the name of the group you want them to manage.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary user and group member management information:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle membership management\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure user test is present for group_a\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: group_a\n      membermanager_user: test\n\n  - name: Ensure group_admins is present for group_a\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: group_a\n      membermanager_group: group_admins\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/add-member-managers-user-groups.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tYou can verify if the \u003Cspan class=\"strong strong\">\u003Cstrong>group_a\u003C/strong>\u003C/span> group contains \u003Cspan class=\"strong strong\">\u003Cstrong>test\u003C/strong>\u003C/span> as a member manager and \u003Cspan class=\"strong strong\">\u003Cstrong>group_admins\u003C/strong>\u003C/span> is a member manager of \u003Cspan class=\"strong strong\">\u003Cstrong>group_a\u003C/strong>\u003C/span> by using the \u003Ccode class=\"literal\">ipa group-show\u003C/code> command:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about \u003Cspan class=\"emphasis\">\u003Cem>managergroup1\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ipaserver]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa group-show group_a\u003C/strong>\u003C/span>\n  Group name: group_a\n  GID: 1133400009\n  Membership managed by groups: group_admins\n  Membership managed by users: test\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa host-add-member-manager --help\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">ipa\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">8.7. Ensuring the absence of member managers in IdM user groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes ensuring the absence of IdM member managers - both users and user groups - using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou must have the name of the existing member manager user or group you are removing and the name of the group they are managing.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary user and group member management information:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-java\">---\n- name: Playbook to handle membership management\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure member manager user and group members are absent for group_a\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: group_a\n      membermanager_user: test\n      membermanager_group: group_admins\n      action: member\n      state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-member-managers-are-absent.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tYou can verify if the \u003Cspan class=\"strong strong\">\u003Cstrong>group_a\u003C/strong>\u003C/span> group does not contain \u003Cspan class=\"strong strong\">\u003Cstrong>test\u003C/strong>\u003C/span> as a member manager and \u003Cspan class=\"strong strong\">\u003Cstrong>group_admins\u003C/strong>\u003C/span> as a member manager of \u003Cspan class=\"strong strong\">\u003Cstrong>group_a\u003C/strong>\u003C/span> by using the \u003Ccode class=\"literal\">ipa group-show\u003C/code> command:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about group_a:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ipaserver]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa group-show group_a\u003C/strong>\u003C/span>\n  Group name: group_a\n  GID: 1133400009\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa host-remove-member-manager --help\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">ipa\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 9. Using Ansible to automate group membership in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tUsing automatic group membership, you can assign users and hosts user groups and host groups automatically, based on their attributes. For example, you can:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tDivide employees' user entries into groups based on the employees' manager, location, position or any other attribute. You can list all attributes by entering \u003Ccode class=\"literal\">ipa user-add --help\u003C/code> on the command-line.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tDivide hosts into groups based on their class, location, or any other attribute. You can list all attributes by entering \u003Ccode class=\"literal\">ipa host-add --help\u003C/code> on the command-line.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tAdd all users or all hosts to a single global group.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tYou can use Red Hat Ansible Engine to automate the management of automatic group membership in Identity Management (IdM).\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis section covers the following topics:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-present_using-ansible-to-automate-group-membership-in-idm\" title=\"9.1. Using Ansible to ensure that an automember rule for an IdM user group is present\">Using Ansible to ensure that an automember rule for an IdM user group is present\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-specified-condition-is-present-in-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm\" title=\"9.2. Using Ansible to ensure that a specified condition is present in an IdM user group automember rule\">Using Ansible to ensure that a condition is present in an IdM user group automember rule\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm\" title=\"9.3. Using Ansible to ensure that a condition is absent from an IdM user group automember rule\">Using Ansible to ensure that a condition is absent in an IdM user group automember rule\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-absent_using-ansible-to-automate-group-membership-in-idm\" title=\"9.4. Using Ansible to ensure that an automember rule for an IdM user group is absent\">Using Ansible to ensure that an automember rule for an IdM group is absent\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-condition-is-present-in-an-idm-host-group-automember-rule_using-ansible-to-automate-group-membership-in-idm\" title=\"9.5. Using Ansible to ensure that a condition is present in an IdM host group automember rule\">Using Ansible to ensure that a condition is present in an IdM host group automember rule\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-present_using-ansible-to-automate-group-membership-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.1. Using Ansible to ensure that an automember rule for an IdM user group is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure an \u003Ccode class=\"literal\">automember\u003C/code> rule for an Identity Management (IdM) group exists. In the example, the presence of an \u003Ccode class=\"literal\">automember\u003C/code> rule is ensured for the \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span> user group.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span> user group exists in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">automember-group-present.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/automember/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-group-present.yml automember-group-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">automember-group-present-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaautomember\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">automember_type\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>group\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Automember group present example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure group automember rule admins is present\n    ipaautomember:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: testing_group\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>automember_type: group\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-group-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"using-ansible-to-ensure-that-a-specified-condition-is-present-in-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.2. Using Ansible to ensure that a specified condition is present in an IdM user group automember rule\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"_abstract _abstract\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that a specified condition exists in an \u003Ccode class=\"literal\">automember\u003C/code> rule for an Identity Management (IdM) group. In the example, the presence of a UID-related condition in the \u003Ccode class=\"literal\">automember\u003C/code> rule is ensured for the \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span> group. By specifying the \u003Cspan class=\"strong strong\">\u003Cstrong>.*\u003C/strong>\u003C/span> condition, you ensure that all future IdM users automatically become members of the \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span> user group and automember user group rule exist in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">automember-hostgroup-rule-present.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/automember/\u003C/code> directory and name it, for example, \u003Cspan class=\"strong strong\">\u003Cstrong>automember-usergroup-rule-present.yml\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-hostgroup-rule-present.yml automember-usergroup-rule-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">automember-usergroup-rule-present.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by modifying the following parameters:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tRename the playbook to correspond to your use case, for example: \u003Cspan class=\"strong strong\">\u003Cstrong>Automember user group rule member present\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tRename the task to correspond to your use case, for example: \u003Cspan class=\"strong strong\">\u003Cstrong>Ensure an automember condition for a user group is present\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the following variables in the \u003Ccode class=\"literal\">ipaautomember\u003C/code> task section:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">automember_type\u003C/code> variable to \u003Ccode class=\"literal\">group\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">action\u003C/code> variable is set to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">inclusive\u003C/code> \u003Ccode class=\"literal\">key\u003C/code> variable to \u003Ccode class=\"literal\">UID\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">inclusive\u003C/code> \u003Ccode class=\"literal\">expression\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>.\u003C/strong>\u003C/span>*\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Automember user group rule member present\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure an automember condition for a user group is present\u003C/strong>\u003C/span>\n    ipaautomember:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: testing_group\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>automember_type: group\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\n      inclusive:\n        - \u003Cspan class=\"strong strong\">\u003Cstrong>key: UID\u003C/strong>\u003C/span>\n          \u003Cspan class=\"strong strong\">\u003Cstrong>expression: .\u003C/strong>\u003C/span>*\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-usergroup-rule-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in as an IdM administrator.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd a user, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add user101 --first user --last 101\u003C/strong>\u003C/span>\n-----------------------\nAdded user \"user101\"\n-----------------------\n  User login: user101\n  First name: user\n  Last name: 101\n  ...\n  \u003Cspan class=\"strong strong\">\u003Cstrong>Member of groups: ipausers, testing_group\u003C/strong>\u003C/span>\n  ...\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.3. Using Ansible to ensure that a condition is absent from an IdM user group automember rule\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"_abstract _abstract\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure a condition is absent from an \u003Ccode class=\"literal\">automember\u003C/code> rule for an Identity Management (IdM) group. In the example, the absence of a condition in the \u003Ccode class=\"literal\">automember\u003C/code> rule is ensured that specifies that users whose \u003Ccode class=\"literal\">initials\u003C/code> are \u003Cspan class=\"strong strong\">\u003Cstrong>dp\u003C/strong>\u003C/span> should be included. The automember rule is applied to the \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span> group. By applying the condition, you ensure that no future IdM user whose initials are \u003Cspan class=\"strong strong\">\u003Cstrong>dp\u003C/strong>\u003C/span> becomes a member of the \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span> user group and automember user group rule exist in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">automember-hostgroup-rule-absent.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/automember/\u003C/code> directory and name it, for example, \u003Cspan class=\"strong strong\">\u003Cstrong>automember-usergroup-rule-absent.yml\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-hostgroup-rule-absent.yml automember-usergroup-rule-absent.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">automember-usergroup-rule-absent.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by modifying the following parameters:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tRename the playbook to correspond to your use case, for example: \u003Cspan class=\"strong strong\">\u003Cstrong>Automember user group rule member absent\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tRename the task to correspond to your use case, for example: \u003Cspan class=\"strong strong\">\u003Cstrong>Ensure an automember condition for a user group is absent\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the following variables in the \u003Ccode class=\"literal\">ipaautomember\u003C/code> task section:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">automember_type\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>group\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">action\u003C/code> variable is set to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">inclusive\u003C/code> \u003Ccode class=\"literal\">key\u003C/code> variable to \u003Ccode class=\"literal\">initials\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">inclusive\u003C/code> \u003Ccode class=\"literal\">expression\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>dp\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Automember user group rule member absent\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure an automember condition for a user group is absent\u003C/strong>\u003C/span>\n    ipaautomember:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: testing_group\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>automember_type: group\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\n      inclusive:\n        - \u003Cspan class=\"strong strong\">\u003Cstrong>key: initials\u003C/strong>\u003C/span>\n          \u003Cspan class=\"strong strong\">\u003Cstrong>expression: dp\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-usergroup-rule-absent.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in as an IdM administrator.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the automember group:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa automember-show --type=group testing_group\u003C/strong>\u003C/span>\n Automember Rule: testing_group\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe absence of an \u003Ccode class=\"literal\">Inclusive Regex: initials=dp\u003C/code> entry in the output confirms that the \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span> automember rule does not contain the condition specified.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-absent_using-ansible-to-automate-group-membership-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.4. Using Ansible to ensure that an automember rule for an IdM user group is absent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"_abstract _abstract\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure an \u003Ccode class=\"literal\">automember\u003C/code> rule is absent for an Identity Management (IdM) group. In the example, the absence of an \u003Ccode class=\"literal\">automember\u003C/code> rule is ensured for the \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span> group.\n\t\t\t\t\u003C/p>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDeleting an automember rule also deletes all conditions associated with the rule. To remove only specific conditions from a rule, see \u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm\" title=\"9.3. Using Ansible to ensure that a condition is absent from an IdM user group automember rule\">Using Ansible to ensure that a condition is absent in an IdM user group automember rule\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">automember-group-absent.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/automember/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-group-absent.yml automember-group-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">automember-group-absent-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaautomember\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>testing_group\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">automember_type\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>group\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Automember group absent example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure group automember rule admins is absent\n    ipaautomember:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: testing_group\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>automember_type: group\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-group-absent.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-automember.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/automember\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-condition-is-present-in-an-idm-host-group-automember-rule_using-ansible-to-automate-group-membership-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">9.5. Using Ansible to ensure that a condition is present in an IdM host group automember rule\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use Ansible to ensure that a condition is present in an IdM host group automember rule. The example describes how to ensure that hosts with the \u003Ccode class=\"literal\">FQDN\u003C/code> of \u003Cspan class=\"strong strong\">\u003Cstrong>.*.idm.example.com\u003C/strong>\u003C/span> are members of the \u003Cspan class=\"strong strong\">\u003Cstrong>primary_dns_domain_hosts\u003C/strong>\u003C/span> host group and hosts whose \u003Ccode class=\"literal\">FQDN\u003C/code> is \u003Cspan class=\"strong strong\">\u003Cstrong>.*.example.org\u003C/strong>\u003C/span> are not members of the \u003Cspan class=\"strong strong\">\u003Cstrong>primary_dns_domain_hosts\u003C/strong>\u003C/span> host group.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>primary_dns_domain_hosts\u003C/strong>\u003C/span> host group and automember host group rule exist in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">automember-hostgroup-rule-present.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/automember/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/automember/automember-hostgroup-rule-present.yml automember-hostgroup-rule-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">automember-hostgroup-rule-present-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaautomember\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>primary_dns_domain_hosts\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">automember_type\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>hostgroup\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">action\u003C/code> variable is set to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">inclusive\u003C/code> \u003Ccode class=\"literal\">key\u003C/code> variable is set to \u003Ccode class=\"literal\">fqdn\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the corresponding \u003Ccode class=\"literal\">inclusive\u003C/code> \u003Ccode class=\"literal\">expression\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>.*.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">exclusive\u003C/code> \u003Ccode class=\"literal\">key\u003C/code> variable to \u003Ccode class=\"literal\">fqdn\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the corresponding \u003Ccode class=\"literal\">exclusive\u003C/code> \u003Ccode class=\"literal\">expression\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>.*.example.org\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Automember user group rule member present\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure an automember condition for a user group is present\n    ipaautomember:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: primary_dns_domain_hosts\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>automember_type: hostgroup\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\n      inclusive:\n        \u003Cspan class=\"strong strong\">\u003Cstrong>- key: fqdn\u003C/strong>\u003C/span>\n          \u003Cspan class=\"strong strong\">\u003Cstrong>expression: .*.idm.example.com\u003C/strong>\u003C/span>\n      exclusive:\n        - \u003Cspan class=\"strong strong\">\u003Cstrong>key: fqdn\u003C/strong>\u003C/span>\n          \u003Cspan class=\"strong strong\">\u003Cstrong>expression: .*.example.org\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory automember-hostgroup-rule-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-automember.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/automember\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 10. Using Ansible playbooks to manage self-service rules in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThis section introduces self-service rules in Identity Management (IdM) and describes how to create and edit self-service access rules using Ansible playbooks. Self-service access control rules allow an IdM entity to perform specified operations on its IdM Directory Server entry.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.1. Self-service access control in IdM\">Self-service access control in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-self-service-rule-is-present_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.2. Using Ansible to ensure that a self-service rule is present\">Using Ansible to ensure that a self-service rule is present\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-self-service-rule-is-absent_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.3. Using Ansible to ensure that a self-service rule is absent\">Using Ansible to ensure that a self-service rule is absent\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-self-service-rule-has-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.4. Using Ansible to ensure that a self-service rule has specific attributes\">Using Ansible to ensure that a self-service rule has specific attributes\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-self-service-rule-does-not-have-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.5. Using Ansible to ensure that a self-service rule does not have specific attributes\">Using Ansible to ensure that a self-service rule does not have specific attributes\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.1. Self-service access control in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tSelf-service access control rules define which operations an Identity Management (IdM) entity can perform on its IdM Directory Server entry: for example, IdM users have the ability to update their own passwords.\u003Cbr/>\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis method of control allows an authenticated IdM entity to edit specific attributes within its LDAP entry, but does not allow \u003Ccode class=\"literal\">add\u003C/code> or \u003Ccode class=\"literal\">delete\u003C/code> operations on the entire entry.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tBe careful when working with self-service access control rules: configuring access control rules improperly can inadvertently elevate an entity’s privileges.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-self-service-rule-is-present_using-ansible-playbooks-to-manage-self-service-rules-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.2. Using Ansible to ensure that a self-service rule is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to define self-service rules and ensure their presence on an Identity Management (IdM) server. In this example, the new \u003Cspan class=\"strong strong\">\u003Cstrong>Users can manage their own name details\u003C/strong>\u003C/span> rule grants users the ability to change their own \u003Ccode class=\"literal\">givenname\u003C/code>, \u003Ccode class=\"literal\">displayname\u003C/code>, \u003Ccode class=\"literal\">title\u003C/code> and \u003Ccode class=\"literal\">initials\u003C/code> attributes. This allows them to, for example, change their display name or initials if they want to.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">selfservice-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/selfservice/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/selfservice/selfservice-present.yml selfservice-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">selfservice-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaselfservice\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the new self-service rule.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">permission\u003C/code> variable to a comma-separated list of permissions to grant: \u003Ccode class=\"literal\">read\u003C/code> and \u003Ccode class=\"literal\">write\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attribute\u003C/code> variable to a list of attributes that users can manage themselves: \u003Ccode class=\"literal\">givenname\u003C/code>, \u003Ccode class=\"literal\">displayname\u003C/code>, \u003Ccode class=\"literal\">title\u003C/code>, and \u003Ccode class=\"literal\">initials\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Self-service present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure self-service rule \"Users can manage their own name details\" is present\n    ipaselfservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: \"Users can manage their own name details\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>permission: read, write\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>attribute:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- givenname\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- displayname\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- title\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- initials\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory selfservice-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.1. Self-service access control in IdM\">Self-service access control in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-selfservice.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/selfservice\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-self-service-rule-is-absent_using-ansible-playbooks-to-manage-self-service-rules-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.3. Using Ansible to ensure that a self-service rule is absent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure a specified self-service rule is absent from your IdM configuration. The example below describes how to make sure the \u003Cspan class=\"strong strong\">\u003Cstrong>Users can manage their own name details\u003C/strong>\u003C/span> self-service rule does not exist in IdM. This will ensure that users cannot, for example, change their own display name or initials.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">selfservice-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/selfservice/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/selfservice/selfservice-absent.yml selfservice-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">selfservice-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaselfservice\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the self-service rule.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Self-service absent\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure self-service rule \"Users can manage their own name details\" is absent\n    ipaselfservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: \"Users can manage their own name details\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory selfservice-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.1. Self-service access control in IdM\">Self-service access control in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-selfservice.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/selfservice\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-self-service-rule-has-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.4. Using Ansible to ensure that a self-service rule has specific attributes\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that an already existing self-service rule has specific settings. In the example, you ensure the \u003Cspan class=\"strong strong\">\u003Cstrong>Users can manage their own name details\u003C/strong>\u003C/span> self-service rule also has the \u003Ccode class=\"literal\">surname\u003C/code> member attribute.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>Users can manage their own name details\u003C/strong>\u003C/span> self-service rule exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">selfservice-member-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/selfservice/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/selfservice/selfservice-member-present.yml selfservice-member-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">selfservice-member-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaselfservice\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the self-service rule to modify.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attribute\u003C/code> variable to \u003Ccode class=\"literal\">surname\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Self-service member present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure selfservice \"Users can manage their own name details\" member attribute surname is present\n    ipaselfservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: \"Users can manage their own name details\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>attribute:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- surname\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory selfservice-member-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.1. Self-service access control in IdM\">Self-service access control in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-selfservice.md\u003C/code> file available in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/selfservice\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-self-service-rule-does-not-have-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">10.5. Using Ansible to ensure that a self-service rule does not have specific attributes\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that a self-service rule does not have specific settings. You can use this playbook to make sure a self-service rule does not grant undesired access. In the example, you ensure the \u003Cspan class=\"strong strong\">\u003Cstrong>Users can manage their own name details\u003C/strong>\u003C/span> self-service rule does not have the \u003Ccode class=\"literal\">givenname\u003C/code> and \u003Ccode class=\"literal\">surname\u003C/code> member attributes.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>Users can manage their own name details\u003C/strong>\u003C/span> self-service rule exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">selfservice-member-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/selfservice/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/selfservice/selfservice-member-absent.yml selfservice-member-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">selfservice-member-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaselfservice\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the self-service rule you want to modify.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attribute\u003C/code> variable to \u003Ccode class=\"literal\">givenname\u003C/code> and \u003Ccode class=\"literal\">surname\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Self-service member absent\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure selfservice \"Users can manage their own name details\" member attributes givenname and surname are absent\n    ipaselfservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: \"Users can manage their own name details\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>attribute:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- givenname\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- surname\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory selfservice-member-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm\" title=\"10.1. Self-service access control in IdM\">Self-service access control in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-selfservice.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/selfservice\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 11. Delegating permissions to user groups to manage users using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tDelegation is one of the access control methods in IdM, along with self-service rules and role-based access control (RBAC). You can use delegation to assign permissions to one group of users to manage entries for another group of users.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis section covers the following topics:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.1. Delegation rules\">Delegation rules\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#creating-an-ansible-inventory-file-for-idm_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.2. Creating an Ansible inventory file for IdM\">Creating the Ansible inventory file for IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_using-ansible-to-ensure-that-a-delegation-rule-is-present_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.3. Using Ansible to ensure that a delegation rule is present\">Using Ansible to ensure that a delegation rule is present\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_using-ansible-to-ensure-that-a-delegation-rule-is-absent_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.4. Using Ansible to ensure that a delegation rule is absent\">Using Ansible to ensure that a delegation rule is absent\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_using-ansible-to-ensure-that-a-delegation-rule-has-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.5. Using Ansible to ensure that a delegation rule has specific attributes\">Using Ansible to ensure that a delegation rule has specific attributes\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_using-ansible-to-ensure-that-a-delegation-rule-does-not-have-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.6. Using Ansible to ensure that a delegation rule does not have specific attributes\">Using Ansible to ensure that a delegation rule does not have specific attributes\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.1. Delegation rules\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can delegate permissions to user groups to manage users by creating \u003Cspan class=\"strong strong\">\u003Cstrong>delegation rules\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDelegation rules allow a specific user group to perform write (edit) operations on specific attributes for users in another user group. This form of access control rule is limited to editing the values of a subset of attributes you specify in a delegation rule; it does not grant the ability to add or remove whole entries or control over unspecified attributes.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDelegation rules grant permissions to existing user groups in IdM. You can use delegation to, for example, allow the \u003Ccode class=\"literal\">managers\u003C/code> user group to manage selected attributes of users in the \u003Ccode class=\"literal\">employees\u003C/code> user group.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"creating-an-ansible-inventory-file-for-idm_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.2. Creating an Ansible inventory file for IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tWhen working with Ansible, it is good practice to create, in your home directory, a subdirectory dedicated to Ansible playbooks that you copy and adapt from the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/*\u003C/code> and \u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/*\u003C/code> subdirectories. This practice has the following advantages:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can find all your playbooks in one place.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou can run your playbooks without invoking \u003Ccode class=\"literal\">root\u003C/code> privileges.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a directory for your Ansible configuration and playbooks in your home directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>mkdir ~/MyPlaybooks/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tChange into the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/MyPlaybooks\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks/ansible.cfg\u003C/strong>\u003C/span> file with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[defaults]\ninventory = /home/\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>/MyPlaybooks/inventory\n\n[privilege_escalation]\nbecome=True\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the \u003Cspan class=\"strong strong\">\u003Cstrong>~/MyPlaybooks/inventory\u003C/strong>\u003C/span> file with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[eu]\nserver.idm.example.com\n\n[us]\nreplica.idm.example.com\n\n[ipaserver:children]\neu\nus\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis configuration defines two host groups, \u003Cspan class=\"strong strong\">\u003Cstrong>eu\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>us\u003C/strong>\u003C/span>, for hosts in these locations. Additionally, this configuration defines the \u003Cspan class=\"strong strong\">\u003Cstrong>ipaserver\u003C/strong>\u003C/span> host group, which contains all hosts from the \u003Cspan class=\"strong strong\">\u003Cstrong>eu\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>us\u003C/strong>\u003C/span> groups.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-ansible-to-ensure-that-a-delegation-rule-is-present_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.3. Using Ansible to ensure that a delegation rule is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to define privileges for a new IdM delegation rule and ensure its presence. In the example, the new \u003Cspan class=\"strong strong\">\u003Cstrong>basic manager attributes\u003C/strong>\u003C/span> delegation rule grants the \u003Ccode class=\"literal\">managers\u003C/code> group the ability to read and write the following attributes for members of the \u003Ccode class=\"literal\">employees\u003C/code> group:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">businesscategory\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">departmentnumber\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">employeenumber\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">employeetype\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">delegation-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/delegation/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/delegation/delegation-present.yml delegation-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">delegation-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadelegation\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the new delegation rule.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">permission\u003C/code> variable to a comma-separated list of permissions to grant: \u003Ccode class=\"literal\">read\u003C/code> and \u003Ccode class=\"literal\">write\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attribute\u003C/code> variable to a list of attributes the delegated user group can manage: \u003Ccode class=\"literal\">businesscategory\u003C/code>, \u003Ccode class=\"literal\">departmentnumber\u003C/code>, \u003Ccode class=\"literal\">employeenumber\u003C/code>, and \u003Ccode class=\"literal\">employeetype\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">group\u003C/code> variable to the name of the group that is being given access to view or modify attributes.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">membergroup\u003C/code> variable to the name of the group whose attributes can be viewed or modified.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage a delegation rule\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure delegation \"basic manager attributes\" is present\n    ipadelegation:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: \"basic manager attributes\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>permission: read, write\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>attribute:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- businesscategory\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- departmentnumber\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- employeenumber\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- employeetype\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>group: managers\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>membergroup: employees\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/inventory delegation-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.1. Delegation rules\">Delegation rules\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-delegation.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/ipadelegation\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-ansible-to-ensure-that-a-delegation-rule-is-absent_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.4. Using Ansible to ensure that a delegation rule is absent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure a specified delegation rule is absent from your IdM configuration. The example below describes how to make sure the custom \u003Cspan class=\"strong strong\">\u003Cstrong>basic manager attributes\u003C/strong>\u003C/span> delegation rule does not exist in IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">delegation-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/delegation/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/delegation/delegation-present.yml delegation-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">delegation-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadelegation\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the delegation rule.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Delegation absent\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure delegation \"basic manager attributes\" is absent\n    ipadelegation:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: \"basic manager attributes\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/inventory delegation-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.1. Delegation rules\">Delegation rules\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-delegation.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/ipadelegation\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-ansible-to-ensure-that-a-delegation-rule-has-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.5. Using Ansible to ensure that a delegation rule has specific attributes\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that a delegation rule has specific settings. You can use this playbook to modify a delegation role you have previously created. In the example, you ensure the \u003Cspan class=\"strong strong\">\u003Cstrong>basic manager attributes\u003C/strong>\u003C/span> delegation rule only has the \u003Ccode class=\"literal\">departmentnumber\u003C/code> member attribute.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>basic manager attributes\u003C/strong>\u003C/span> delegation rule exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">delegation-member-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/delegation/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/delegation/delegation-member-present.yml delegation-member-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">delegation-member-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadelegation\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the delegation rule to modify.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attribute\u003C/code> variable to \u003Ccode class=\"literal\">departmentnumber\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Delegation member present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure delegation \"basic manager attributes\" member attribute departmentnumber is present\n    ipadelegation:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: \"basic manager attributes\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>attribute:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- departmentnumber\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/inventory delegation-member-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.1. Delegation rules\">Delegation rules\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-delegation.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/ipadelegation\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_using-ansible-to-ensure-that-a-delegation-rule-does-not-have-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">11.6. Using Ansible to ensure that a delegation rule does not have specific attributes\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that a delegation rule does not have specific settings. You can use this playbook to make sure a delegation role does not grant undesired access. In the example, you ensure the \u003Cspan class=\"strong strong\">\u003Cstrong>basic manager attributes\u003C/strong>\u003C/span> delegation rule does not have the \u003Ccode class=\"literal\">employeenumber\u003C/code> and \u003Ccode class=\"literal\">employeetype\u003C/code> member attributes.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>basic manager attributes\u003C/strong>\u003C/span> delegation rule exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">delegation-member-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/delegation/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/delegation/delegation-member-absent.yml delegation-member-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">delegation-member-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadelegation\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the delegation rule to modify.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attribute\u003C/code> variable to \u003Ccode class=\"literal\">employeenumber\u003C/code> and \u003Ccode class=\"literal\">employeetype\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Delegation member absent\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure delegation \"basic manager attributes\" member attributes employeenumber and employeetype are absent\n    ipadelegation:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: \"basic manager attributes\"\u003C/strong>\u003C/span>\n      attribute:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- employeenumber\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- employeetype\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/inventory delegation-member-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks\" title=\"11.1. Delegation rules\">Delegation rules\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-delegation.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/ipadelegation\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 12. Using Ansible playbooks to manage role-based access control in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tRole-based access control (RBAC) is a policy-neutral access-control mechanism defined around roles and privileges. The components of RBAC in Identity Management (IdM) are roles, privileges and permissions:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Permissions\u003C/strong>\u003C/span> grant the right to perform a specific task such as adding or deleting users, modifying a group, and enabling read-access.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Privileges\u003C/strong>\u003C/span> combine permissions, for example all the permissions needed to add a new user.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Roles\u003C/strong>\u003C/span> grant a set of privileges to users, user groups, hosts or host groups.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tEspecially in large companies, using RBAC can help create a hierarchical system of administrators with their individual areas of responsibility.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis chapter describes the following operations performed when managing RBAC using Ansible playbooks:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.1. Permissions in IdM\">Permissions in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#default-managed-permissions_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.2. Default managed permissions\">Default managed permissions\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.3. Privileges in IdM\">Privileges in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.4. Roles in IdM\">Roles in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#predefined-roles-in-identity-management_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.5. Predefined roles in Identity Management\">Predefined roles in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-idm-rbac-role-with-privileges-is-present_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.6. Using Ansible to ensure an IdM RBAC role with privileges is present\">Using Ansible to ensure an IdM RBAC role with privileges is present\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-idm-rbac-role-is-absent_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.7. Using Ansible to ensure an IdM RBAC role is absent\">Using Ansible to ensure an IdM RBAC role is absent\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-a-group-of-users-is-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.8. Using Ansible to ensure that a group of users is assigned to an IdM RBAC role\">Using Ansible to ensure that a group of users is assigned to an IdM RBAC role\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-that-specific-users-are-not-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.9. Using Ansible to ensure that specific users are not assigned to an IdM RBAC role\">Using Ansible to ensure that specific users are not assigned to an IdM RBAC role\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-a-service-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.10. Using Ansible to ensure a service is a member of an IdM RBAC role\">Using Ansible to ensure a service is a member of an IdM RBAC role\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-a-host-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.11. Using Ansible to ensure a host is a member of an IdM RBAC role\">Using Ansible to ensure a host is a member of an IdM RBAC role\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-a-host-group-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.12. Using Ansible to ensure a host group is a member of an IdM RBAC role\">Using Ansible to ensure a host group is a member of an IdM RBAC role\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.1. Permissions in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tPermissions are the lowest level unit of role-based access control, they define operations together with the LDAP entries to which those operations apply. Comparable to building blocks, permissions can be assigned to as many privileges as needed.\u003Cbr/> One or more \u003Cspan class=\"strong strong\">\u003Cstrong>rights\u003C/strong>\u003C/span> define what operations are allowed:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">write\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">read\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">search\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">compare\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">add\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">delete\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">all\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThese operations apply to three basic \u003Cspan class=\"strong strong\">\u003Cstrong>targets\u003C/strong>\u003C/span>:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">subtree\u003C/code>: a domain name (DN); the subtree under this DN\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">target filter\u003C/code>: an LDAP filter\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">target\u003C/code>: DN with possible wildcards to specify entries\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tAdditionally, the following convenience options set the corresponding attribute(s):\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">type\u003C/code>: a type of object (user, group, etc); sets \u003Ccode class=\"literal\">subtree\u003C/code> and \u003Ccode class=\"literal\">target filter\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">memberof\u003C/code>: members of a group; sets a \u003Ccode class=\"literal\">target filter\u003C/code>\n\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tSetting the \u003Ccode class=\"literal\">memberof\u003C/code> attribute permission is not applied if the target LDAP entry does not contain any reference to group membership.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">targetgroup\u003C/code>: grants access to modify a specific group (such as granting the rights to manage group membership); sets a \u003Ccode class=\"literal\">target\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tWith IdM permissions, you can control which users have access to which objects and even which attributes of these objects. IdM enables you to allow or block individual attributes or change the entire visibility of a specific IdM function, such as users, groups, or sudo, to all anonymous users, all authenticated users, or just a certain group of privileged users.\u003Cbr/> For example, the flexibility of this approach to permissions is useful for an administrator who wants to limit access of users or groups only to the specific sections these users or groups need to access and to make the other sections completely hidden to them.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tA permission cannot contain other permissions.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"default-managed-permissions_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.2. Default managed permissions\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tManaged permissions are permissions that come by default with IdM. They behave like other permissions created by the user, with the following differences:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou cannot delete them or modify their name, location, and target attributes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThey have three sets of attributes:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Default\u003C/strong>\u003C/span> attributes, the user cannot modify them, as they are managed by IdM\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Included\u003C/strong>\u003C/span> attributes, which are additional attributes added by the user\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Excluded\u003C/strong>\u003C/span> attributes, which are attributes removed by the user\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tA managed permission applies to all attributes that appear in the default and included attribute sets but not in the excluded set.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tWhile you cannot delete a managed permission, setting its bind type to permission and removing the managed permission from all privileges effectively disables it.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tNames of all managed permissions start with \u003Ccode class=\"literal\">System:\u003C/code>, for example \u003Ccode class=\"literal\">System: Add Sudo rule\u003C/code> or \u003Ccode class=\"literal\">System: Modify Services\u003C/code>. Earlier versions of IdM used a different scheme for default permissions. For example, the user could not delete them and was only able to assign them to privileges. Most of these default permissions have been turned into managed permissions, however, the following permissions still use the previous scheme:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd Automember Rebuild Membership Task\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd Configuration Sub-Entries\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd Replication Agreements\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCertificate Remove Hold\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tGet Certificates status from the CA\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRead DNA Range\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tModify DNA Range\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRead PassSync Managers Configuration\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tModify PassSync Managers Configuration\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRead Replication Agreements\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tModify Replication Agreements\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRemove Replication Agreements\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRead LDBM Database Configuration\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRequest Certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRequest Certificate ignoring CA ACLs\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRequest Certificates from a different host\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRetrieve Certificates from the CA\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRevoke Certificate\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tWrite IPA Configuration\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you attempt to modify a managed permission from the command line, the system does not allow you to change the attributes that you cannot modify, the command fails. If you attempt to modify a managed permission from the Web UI, the attributes that you cannot modify are disabled.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.3. Privileges in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA privilege is a group of permissions applicable to a role.\u003Cbr/> While a permission provides the rights to do a single operation, there are certain IdM tasks that require multiple permissions to succeed. Therefore, a privilege combines the different permissions required to perform a specific task.\u003Cbr/> For example, setting up an account for a new IdM user requires the following permissions:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreating a new user entry\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tResetting a user password\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdding the new user to the default IPA users group\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tCombining these three low-level tasks into a higher level task in the form of a custom privilege named, for example, \u003Cspan class=\"strong strong\">\u003Cstrong>Add User\u003C/strong>\u003C/span> makes it easier for a system administrator to manage roles. IdM already contains several default privileges. Apart from users and user groups, privileges are also assigned to hosts and host groups, as well as network services. This practice permits a fine-grained control of operations by a set of users on a set of hosts using specific network services.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tA privilege may not contain other privileges.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.4. Roles in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA role is a list of privileges that users specified for the role possess.\u003Cbr/> In effect, permissions grant the ability to perform given low-level tasks (such as creating a user entry and adding an entry to a group), privileges combine one or more of these permissions needed for a higher-level task (such as creating a new user in a given group). Roles gather privileges together as needed: for example, a User Administrator role would be able to add, modify, and delete users.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tRoles are used to classify permitted actions. They are not used as a tool to implement privilege separation or to protect from privilege escalation.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tRoles can not contain other roles.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"predefined-roles-in-identity-management_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.5. Predefined roles in Identity Management\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tRed Hat Identity Management provides the following range of pre-defined roles:\n\t\t\t\u003C/p>\u003Crh-table id=\"idm140464239121952\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 12.1. Predefined Roles in Identity Management\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464228067040\" scope=\"col\">Role\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464228065952\" scope=\"col\">Privilege\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464226069360\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228067040\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnrollment Administrator\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228065952\"> \u003Cp>\n\t\t\t\t\t\t\t\tHost Enrollment\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464226069360\"> \u003Cp>\n\t\t\t\t\t\t\t\tResponsible for client, or host, enrollment\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228067040\"> \u003Cp>\n\t\t\t\t\t\t\t\thelpdesk\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228065952\"> \u003Cp>\n\t\t\t\t\t\t\t\tModify Users and Reset passwords, Modify Group membership\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464226069360\"> \u003Cp>\n\t\t\t\t\t\t\t\tResponsible for performing simple user administration tasks\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228067040\"> \u003Cp>\n\t\t\t\t\t\t\t\tIT Security Specialist\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228065952\"> \u003Cp>\n\t\t\t\t\t\t\t\tNetgroups Administrators, HBAC Administrator, Sudo Administrator\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464226069360\"> \u003Cp>\n\t\t\t\t\t\t\t\tResponsible for managing security policy such as host-based access controls, sudo rules\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228067040\"> \u003Cp>\n\t\t\t\t\t\t\t\tIT Specialist\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228065952\"> \u003Cp>\n\t\t\t\t\t\t\t\tHost Administrators, Host Group Administrators, Service Administrators, Automount Administrators\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464226069360\"> \u003Cp>\n\t\t\t\t\t\t\t\tResponsible for managing hosts\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228067040\"> \u003Cp>\n\t\t\t\t\t\t\t\tSecurity Architect\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228065952\"> \u003Cp>\n\t\t\t\t\t\t\t\tDelegation Administrator, Replication Administrators, Write IPA Configuration, Password Policy Administrator\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464226069360\"> \u003Cp>\n\t\t\t\t\t\t\t\tResponsible for managing the Identity Management environment, creating trusts, creating replication agreements\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228067040\"> \u003Cp>\n\t\t\t\t\t\t\t\tUser Administrator\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464228065952\"> \u003Cp>\n\t\t\t\t\t\t\t\tUser Administrators, Group Administrators, Stage User Administrators\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464226069360\"> \u003Cp>\n\t\t\t\t\t\t\t\tResponsible for creating users and groups\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-idm-rbac-role-with-privileges-is-present_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.6. Using Ansible to ensure an IdM RBAC role with privileges is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo exercise more granular control over role-based access (RBAC) to resources in Identity Management (IdM) than the default roles provide, create a custom role.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to define privileges for a new IdM custom role and ensure its presence. In the example, the new \u003Cspan class=\"strong strong\">\u003Cstrong>user_and_host_administrator\u003C/strong>\u003C/span> role contains a unique combination of the following privileges that are present in IdM by default:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Group Administrators\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">User Administrators\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Stage User Administrators\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">Group Administrators\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">role-member-user-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/role/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-user-present.yml role-member-user-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">role-member-user-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">iparole\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the new role.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">privilege\u003C/code> list to the names of the IdM privileges that you want to include in the new role.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, set the \u003Ccode class=\"literal\">user\u003C/code> variable to the name of the user to whom you want to grant the new role.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, set the \u003Ccode class=\"literal\">group\u003C/code> variable to the name of the group to which you want to grant the new role.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA role with members.\n  hosts: ipaserver\n  become: true\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - iparole:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: user_and_host_administrator\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>user: idm_user01\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>group: idm_group01\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>privilege:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- Group Administrators\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- User Administrators\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- Stage User Administrators\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- Group Administrators\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/inventory role-member-user-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.4. Roles in IdM\">Roles in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-role\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/iparole\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-idm-rbac-role-is-absent_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.7. Using Ansible to ensure an IdM RBAC role is absent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator managing role-based access control (RBAC) in Identity Management (IdM), you may want to ensure the absence of an obsolete role so that no administrator assigns it to any user accidentally.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure a role is absent. The example below describes how to make sure the custom \u003Cspan class=\"strong strong\">\u003Cstrong>user_and_host_administrator\u003C/strong>\u003C/span> role does not exist in IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">role-is-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/role/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-is-absent.yml role-is-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">role-is-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">iparole\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the role.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA role with members.\n  hosts: ipaserver\n  become: true\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - iparole:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: user_and_host_administrator\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/inventory role-is-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.4. Roles in IdM\">Roles in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-role\u003C/code> Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/iparole\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-group-of-users-is-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.8. Using Ansible to ensure that a group of users is assigned to an IdM RBAC role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator managing role-based access control (RBAC) in Identity Management (IdM), you may want to assign a role to a specific group of users, for example junior administrators.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following example describes how to use an Ansible playbook to ensure the built-in IdM RBAC \u003Cspan class=\"strong strong\">\u003Cstrong>helpdesk\u003C/strong>\u003C/span> role is assigned to \u003Cspan class=\"strong strong\">\u003Cstrong>junior_sysadmins\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">role-member-group-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/role/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-group-present.yml role-member-group-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">role-member-group-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">iparole\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the role you want to assign.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">group\u003C/code> variable to the name of the group.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA role with members.\n  hosts: ipaserver\n  become: true\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - iparole:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: helpdesk\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>group: junior_sysadmins\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/inventory role-member-group-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.4. Roles in IdM\">Roles in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-role\u003C/code> Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/iparole\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-specific-users-are-not-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.9. Using Ansible to ensure that specific users are not assigned to an IdM RBAC role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator managing role-based access control (RBAC) in Identity Management (IdM), you may want to ensure that an RBAC role is not assigned to specific users after they have, for example, moved to different positions within the company.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that the users named \u003Cspan class=\"strong strong\">\u003Cstrong>user_01\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>user_02\u003C/strong>\u003C/span> are not assigned to the \u003Cspan class=\"strong strong\">\u003Cstrong>helpdesk\u003C/strong>\u003C/span> role.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">role-member-user-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/role/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-user-absent.yml role-member-user-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">role-member-user-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">iparole\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the role you want to assign.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">user\u003C/code> list to the names of the users.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA role with members.\n  hosts: ipaserver\n  become: true\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - iparole:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: helpdesk\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>user\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- user_01\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- user_02\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/inventory role-member-user-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.4. Roles in IdM\">Roles in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-role\u003C/code> Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/iparole\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-a-service-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.10. Using Ansible to ensure a service is a member of an IdM RBAC role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator managing role-based access control (RBAC) in Identity Management (IdM), you may want to ensure that a specific service that is enrolled into IdM is a member of a particular role. The following example describes how to ensure that the custom \u003Cspan class=\"strong strong\">\u003Cstrong>web_administrator\u003C/strong>\u003C/span> role can manage the \u003Ccode class=\"literal\">HTTP\u003C/code> service that is running on the \u003Cspan class=\"strong strong\">\u003Cstrong>client01.idm.example.com\u003C/strong>\u003C/span> server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>web_administrator\u003C/strong>\u003C/span> role exists in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client01.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> service exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">role-member-service-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/role/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-service-present-absent.yml role-member-service-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">role-member-service-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">iparole\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the role you want to assign.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">service\u003C/code> list to the name of the service.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA role with members.\n  hosts: ipaserver\n  become: true\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - iparole:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: web_administrator\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>service:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- HTTP/client01.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/inventory role-member-service-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.4. Roles in IdM\">Roles in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-role\u003C/code> Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/iparole\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-a-host-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.11. Using Ansible to ensure a host is a member of an IdM RBAC role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator managing role-based access control in Identity Management (IdM), you may want to ensure that a specific host or host group is associated with a specific role. The following example describes how to ensure that the custom \u003Cspan class=\"strong strong\">\u003Cstrong>web_administrator\u003C/strong>\u003C/span> role can manage the \u003Cspan class=\"strong strong\">\u003Cstrong>client01.idm.example.com\u003C/strong>\u003C/span> IdM host on which the \u003Ccode class=\"literal\">HTTP\u003C/code> service is running.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>web_administrator\u003C/strong>\u003C/span> role exists in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>client01.idm.example.com\u003C/strong>\u003C/span> host exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">role-member-host-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/role/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-host-present.yml role-member-host-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">role-member-host-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">iparole\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the role you want to assign.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">host\u003C/code> list to the name of the host.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA role with members.\n  hosts: ipaserver\n  become: true\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - iparole:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: web_administrator\u003C/strong>\u003C/span>\n      host:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- client01.idm.example.com\u003C/strong>\u003C/span>\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/inventory role-member-host-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.4. Roles in IdM\">Roles in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-role\u003C/code> Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/iparole\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-a-host-group-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">12.12. Using Ansible to ensure a host group is a member of an IdM RBAC role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator managing role-based access control in Identity Management (IdM), you may want to ensure that a specific host or host group is associated with a specific role. The following example describes how to ensure that the custom \u003Cspan class=\"strong strong\">\u003Cstrong>web_administrator\u003C/strong>\u003C/span> role can manage the \u003Cspan class=\"strong strong\">\u003Cstrong>web_servers\u003C/strong>\u003C/span> group of IdM hosts on which the \u003Ccode class=\"literal\">HTTP\u003C/code> service is running.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>web_administrator\u003C/strong>\u003C/span> role exists in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>web_servers\u003C/strong>\u003C/span> host group exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">role-member-hostgroup-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/role/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/role/role-member-hostgroup-present.yml role-member-hostgroup-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">role-member-hostgroup-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">iparole\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the role you want to assign.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">hostgroup\u003C/code> list to the name of the hostgroup.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA role with members.\n  hosts: ipaserver\n  become: true\n  gather_facts: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - iparole:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: web_administrator\u003C/strong>\u003C/span>\n      hostgroup:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- web_servers\u003C/strong>\u003C/span>\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i ~/\u003Cspan class=\"emphasis\">\u003Cem>&lt;MyPlaybooks&gt;\u003C/em>\u003C/span>/inventory role-member-hostgroup-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.ansible.com/ansible/latest/user_guide/vault.html\">Encrypting content with Ansible Vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.4. Roles in IdM\">Roles in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-role\u003C/code> Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/iparole\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 13. Using Ansible playbooks to manage RBAC privileges\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tRole-based access control (RBAC) is a policy-neutral access-control mechanism defined around roles, privileges, and permissions. Especially in large companies, using RBAC can help create a hierarchical system of administrators with their individual areas of responsibility.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis chapter describes the following operations for using Ansible playbooks to manage RBAC privileges in Identity Management (IdM):\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges\" title=\"13.1. Using Ansible to ensure a custom IdM RBAC privilege is present\">Using Ansible to ensure a custom RBAC privilege is present\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-member-permissions-are-present-in-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges\" title=\"13.2. Using Ansible to ensure member permissions are present in a custom IdM RBAC privilege\">Using Ansible to ensure member permissions are present in a custom IdM RBAC privilege\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-idm-rbac-privilege-does-not-include-a-permission_using-ansible-playbooks-to-manage-rbac-privileges\" title=\"13.3. Using Ansible to ensure an IdM RBAC privilege does not include a permission\">Using Ansible to ensure an IdM RBAC privilege does not include a permission\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-rename-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges\" title=\"13.4. Using Ansible to rename a custom IdM RBAC privilege\">Using Ansible to rename a custom IdM RBAC privilege\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-idm-rbac-privilege-is-absent_using-ansible-playbooks-to-manage-rbac-privileges\" title=\"13.5. Using Ansible to ensure an IdM RBAC privilege is absent\">Using Ansible to ensure an IdM RBAC privilege is absent\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tYou understand the \u003Ca class=\"link\" href=\"#using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 12. Using Ansible playbooks to manage role-based access control in IdM\">concepts and principles of RBAC\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.1. Using Ansible to ensure a custom IdM RBAC privilege is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo have a fully-functioning custom privilege in Identity Management (IdM) role-based access control (RBAC), you need to proceed in stages:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate a privilege with no permissions attached.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd permissions of your choice to the privilege.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe following procedure describes how to create an empty privilege using an Ansible playbook so that you can later add permissions to it. The example describes how to create a privilege named \u003Cspan class=\"strong strong\">\u003Cstrong>full_host_administration\u003C/strong>\u003C/span> that is meant to combine all IdM permissions related to host administration.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">privilege-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/privilege/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-present.yml privilege-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">privilege-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaprivilege\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the new privilege, \u003Cspan class=\"strong strong\">\u003Cstrong>full_host_administration\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptionally, describe the privilege using the \u003Ccode class=\"literal\">description\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Privilege present example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure privilege full_host_administration is present\n    ipaprivilege:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: full_host_administration\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>description: This privilege combines all IdM permissions related to host administration\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory privilege-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-member-permissions-are-present-in-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.2. Using Ansible to ensure member permissions are present in a custom IdM RBAC privilege\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo have a fully-functioning custom privilege in Identity Management (IdM) role-based access control (RBAC), you need to proceed in stages:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCreate a privilege with no permissions attached.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd permissions of your choice to the privilege.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to add permissions to a privilege created in the previous step. The example describes how to add all IdM permissions related to host administration to a privilege named \u003Cspan class=\"strong strong\">\u003Cstrong>full_host_administration\u003C/strong>\u003C/span>. By default, the permissions are distributed between the \u003Ccode class=\"literal\">Host Enrollment\u003C/code>, \u003Ccode class=\"literal\">Host Administrators\u003C/code> and \u003Ccode class=\"literal\">Host Group Administrator\u003C/code> privileges.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>full_host_administration\u003C/em>\u003C/span>\u003C/strong>\u003C/span> privilege exists. For information about how to create a privilege using Ansible, see \u003Ca class=\"link\" href=\"#using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges\" title=\"13.1. Using Ansible to ensure a custom IdM RBAC privilege is present\">Using Ansible to ensure a custom IdM RBAC privilege is present\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">privilege-member-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/privilege/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-member-present.yml privilege-member-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">privilege-member-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaprivilege\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the privilege.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">permission\u003C/code> list to the names of the permissions that you want to include in the privilege.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMake sure that the \u003Ccode class=\"literal\">action\u003C/code> variable is set to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Privilege member present example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure that permissions are present for the \"full_host_administration\" privilege\n    ipaprivilege:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: full_host_administration\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>permission:\u003C/strong>\u003C/span>\n      - \"System: Add krbPrincipalName to a Host\"\n      - \"System: Enroll a Host\"\n      - \"System: Manage Host Certificates\"\n      - \"System: Manage Host Enrollment Password\"\n      - \"System: Manage Host Keytab\"\n      - \"System: Manage Host Principals\"\n      - \"Retrieve Certificates from the CA\"\n      - \"Revoke Certificate\"\n      - \"System: Add Hosts\"\n      - \"System: Add krbPrincipalName to a Host\"\n      - \"System: Enroll a Host\"\n      - \"System: Manage Host Certificates\"\n      - \"System: Manage Host Enrollment Password\"\n      - \"System: Manage Host Keytab\"\n      - \"System: Manage Host Keytab Permissions\"\n      - \"System: Manage Host Principals\"\n      - \"System: Manage Host SSH Public Keys\"\n      - \"System: Manage Service Keytab\"\n      - \"System: Manage Service Keytab Permissions\"\n      - \"System: Modify Hosts\"\n      - \"System: Remove Hosts\"\n      - \"System: Add Hostgroups\"\n      - \"System: Modify Hostgroup Membership\"\n      - \"System: Modify Hostgroups\"\n      - \"System: Remove Hostgroups\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory privilege-member-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-idm-rbac-privilege-does-not-include-a-permission_using-ansible-playbooks-to-manage-rbac-privileges\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.3. Using Ansible to ensure an IdM RBAC privilege does not include a permission\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to remove a permission from a privilege. The example describes how to remove the \u003Ccode class=\"literal\">Request Certificates ignoring CA ACLs\u003C/code> permission from the default \u003Ccode class=\"literal\">Certificate Administrators\u003C/code> privilege because, for example, the administrator considers it a security risk.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">privilege-member-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/privilege/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-member-absent.yml privilege-member-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">privilege-member-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaprivilege\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the privilege.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">permission\u003C/code> list to the names of the permissions that you want to remove from the privilege.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMake sure that the \u003Ccode class=\"literal\">action\u003C/code> variable is set to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMake sure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Privilege absent example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure that the \"Request Certificate ignoring CA ACLs\" permission is absent from the \"Certificate Administrators\" privilege\n    ipaprivilege:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: Certificate Administrators\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>permission:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- \"Request Certificate ignoring CA ACLs\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory privilege-member-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-rename-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.4. Using Ansible to rename a custom IdM RBAC privilege\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to rename a privilege because, for example, you have removed a few permissions from it. As a result, the name of the privilege is no longer accurate. In the example, the administrator renames a \u003Cspan class=\"strong strong\">\u003Cstrong>full_host_administration\u003C/strong>\u003C/span> privilege to \u003Cspan class=\"strong strong\">\u003Cstrong>limited_host_administration\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>full_host_administration\u003C/em>\u003C/span>\u003C/strong>\u003C/span> privilege exists. For more information about how to add a privilege, see \u003Ca class=\"link\" href=\"#using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges\" title=\"13.1. Using Ansible to ensure a custom IdM RBAC privilege is present\">Using Ansible to ensure a custom IdM RBAC privilege is present\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">privilege-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/privilege/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-present.yml rename-privilege.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">rename-privilege.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaprivilege\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the current name of the privilege.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">rename\u003C/code> variable and set it to the new name of the privilege.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">state\u003C/code> variable and set it to \u003Ccode class=\"literal\">renamed\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRename the playbook itself, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- \u003Cspan class=\"strong strong\">\u003Cstrong>name: Rename a privilege\u003C/strong>\u003C/span>\n  hosts: ipaserver\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRename the task in the playbook, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[...]\ntasks:\n- \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure the full_host_administration privilege is renamed to limited_host_administration\u003C/strong>\u003C/span>\n  ipaprivilege:\n  [...]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- \u003Cspan class=\"strong strong\">\u003Cstrong>name: Rename a privilege\u003C/strong>\u003C/span>\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure the full_host_administration privilege is renamed to limited_host_administration\u003C/strong>\u003C/span>\n    ipaprivilege:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: full_host_administration\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>rename: limited_host_administration\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: renamed\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory rename-privilege.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-idm-rbac-privilege-is-absent_using-ansible-playbooks-to-manage-rbac-privileges\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.5. Using Ansible to ensure an IdM RBAC privilege is absent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control. The following procedure describes how to use an Ansible playbook to ensure that an RBAC privilege is absent. The example describes how to ensure that the \u003Ccode class=\"literal\">CA administrator\u003C/code> privilege is absent. As a result of the procedure, the \u003Ccode class=\"literal\">admin\u003C/code> administrator becomes the only user capable of managing certificate authorities in IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">privilege-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/privilege/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/privilege/privilege-absent.yml privilege-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">privilege-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaprivilege\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the privilege you want to remove.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMake sure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set it to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRename the task in the playbook, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[...]\ntasks:\n- \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure privilege \"CA administrator\" is absent\u003C/strong>\u003C/span>\n  ipaprivilege:\n  [...]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Privilege absent example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure privilege \"CA administrator\" is absent\u003C/strong>\u003C/span>\n    ipaprivilege:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: CA administrator\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory privilege-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_3\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">13.6. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.3. Privileges in IdM\">Privileges in IdM\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.1. Permissions in IdM\">Permissions in IdM\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-privilege\u003C/code> file available in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/ipaprivilege\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 14. Using Ansible playbooks to manage RBAC permissions in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tRole-based access control (RBAC) is a policy-neutral access control mechanism defined around roles, privileges, and permissions. Especially in large companies, using RBAC can help create a hierarchical system of administrators with their individual areas of responsibility.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis chapter describes the following operations performed when managing RBAC permissions in Identity Management (IdM) using Ansible playbooks:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-rbac-permission-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\" title=\"14.1. Using Ansible to ensure an RBAC permission is present\">Using Ansible to ensure an RBAC permission is present\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-rbac-permission-with-an-attribute-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\" title=\"14.2. Using Ansible to ensure an RBAC permission with an attribute is present\">Using Ansible to ensure an RBAC permission with an attribute is present\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-rbac-permission-is-absent_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\" title=\"14.3. Using Ansible to ensure an RBAC permission is absent\">Using Ansible to ensure an RBAC permission is absent\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-attribute-is-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\" title=\"14.4. Using Ansible to ensure an attribute is a member of an IdM RBAC permission\">Using Ansible to ensure an attribute is a member of an IdM RBAC permission\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-attribute-is-not-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\" title=\"14.5. Using Ansible to ensure an attribute is not a member of an IdM RBAC permission\">Using Ansible to ensure an attribute is not a member of an IdM RBAC permission\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-rename-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\" title=\"14.6. Using Ansible to rename an IdM RBAC permission\">Using Ansible to rename an IdM RBAC permission\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tYou understand the \u003Ca class=\"link\" href=\"#using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 12. Using Ansible playbooks to manage role-based access control in IdM\">concepts and principles of RBAC\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-rbac-permission-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.1. Using Ansible to ensure an RBAC permission is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure a permission is present in IdM so that it can be added to a privilege. The example describes how to ensure the following target state:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">MyPermission\u003C/code> permission exists.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">MyPermission\u003C/code> permission can only be applied to hosts.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA user granted a privilege that contains the permission can do all of the following possible operations on an entry:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tWrite\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tRead\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSearch\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tCompare\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdd\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">permission-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/permission/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-present.yml permission-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">permission-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipapermission\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the permission.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">object_type\u003C/code> variable to \u003Ccode class=\"literal\">host\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">right\u003C/code> variable to \u003Ccode class=\"literal\">all\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Permission present example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure that the \"MyPermission\" permission is present\u003C/strong>\u003C/span>\n    ipapermission:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: MyPermission\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>object_type: host\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>right: all\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-rbac-permission-with-an-attribute-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.2. Using Ansible to ensure an RBAC permission with an attribute is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure a permission is present in IdM so that it can be added to a privilege. The example describes how to ensure the following target state:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> permission exists.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> permission can only be used to add hosts.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA user granted a privilege that contains the permission can do all of the following possible operations on a host entry:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tWrite\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tRead\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSearch\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tCompare\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdd\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host entries created by a user that is granted a privilege that contains the \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> permission can have a \u003Ccode class=\"literal\">description\u003C/code> value.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe type of attribute that you can specify when creating or modifying a permission is not constrained by the IdM LDAP schema. However, specifying, for example, \u003Ccode class=\"literal\">attrs: car_licence\u003C/code> if the \u003Ccode class=\"literal\">object_type\u003C/code> is \u003Ccode class=\"literal\">host\u003C/code> later results in the \u003Ccode class=\"literal\">ipa: ERROR: attribute \"car-license\" not allowed\u003C/code> error message when you try to exercise the permission and add a specific car licence value to a host.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">permission-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/permission/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-present.yml permission-present-with-attribute.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">permission-present-with-attribute.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipapermission\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the permission.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">object_type\u003C/code> variable to \u003Ccode class=\"literal\">host\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">right\u003C/code> variable to \u003Ccode class=\"literal\">all\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attrs\u003C/code> variable to \u003Ccode class=\"literal\">description\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Permission present example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure that the \"MyPermission\" permission is present with an attribute\u003C/strong>\u003C/span>\n    ipapermission:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: MyPermission\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>object_type: host\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>right: all\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>attrs: description\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-present-with-attribute.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/user-schema\">User and group schema\u003C/a> in \u003Cspan class=\"emphasis\">\u003Cem>Linux Domain Identity, Authentication and Policy Guide\u003C/em>\u003C/span> in RHEL 7.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-rbac-permission-is-absent_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.3. Using Ansible to ensure an RBAC permission is absent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure a permission is absent in IdM so that it cannot be added to a privilege.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">permission-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/permission/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-absent.yml permission-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">permission-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipapermission\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the permission.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Permission absent example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure that the \"MyPermission\" permission is absent\u003C/strong>\u003C/span>\n    ipapermission:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: MyPermission\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-attribute-is-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.4. Using Ansible to ensure an attribute is a member of an IdM RBAC permission\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that an attribute is a member of an RBAC permission in IdM. As a result, a user with the permission can create entries that have the attribute.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe example describes how to ensure that the host entries created by a user with a privilege that contains the \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> permission can have \u003Ccode class=\"literal\">gecos\u003C/code> and \u003Ccode class=\"literal\">description\u003C/code> values.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe type of attribute that you can specify when creating or modifying a permission is not constrained by the IdM LDAP schema. However, specifying, for example, \u003Ccode class=\"literal\">attrs: car_licence\u003C/code> if the \u003Ccode class=\"literal\">object_type\u003C/code> is \u003Ccode class=\"literal\">host\u003C/code> later results in the \u003Ccode class=\"literal\">ipa: ERROR: attribute \"car-license\" not allowed\u003C/code> error message when you try to exercise the permission and add a specific car licence value to a host.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> permission exists.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">permission-member-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/permission/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-member-present.yml permission-member-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">permission-member-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipapermission\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the permission.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attrs\u003C/code> list to the \u003Ccode class=\"literal\">description\u003C/code> and \u003Ccode class=\"literal\">gecos\u003C/code> variables.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMake sure the \u003Ccode class=\"literal\">action\u003C/code> variable is set to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Permission member present example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure that the \"gecos\" and \"description\" attributes are present in \"MyPermission\"\u003C/strong>\u003C/span>\n    ipapermission:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: MyPermission\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>attrs:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- description\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- gecos\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-member-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-attribute-is-not-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.5. Using Ansible to ensure an attribute is not a member of an IdM RBAC permission\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control (RBAC).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that an attribute is not a member of an RBAC permission in IdM. As a result, when a user with the permission creates an entry in IdM LDAP, that entry cannot have a value associated with the attribute.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe example describes how to ensure the following target state:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> permission exists.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host entries created by a user with a privilege that contains the \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> permission cannot have the \u003Ccode class=\"literal\">description\u003C/code> attribute.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> permission exists.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">permission-member-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/permission/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-member-absent.yml permission-member-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">permission-member-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipapermission\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the permission.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">attrs\u003C/code> variable to \u003Ccode class=\"literal\">description\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMake sure the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Permission absent example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure that an attribute is not a member of \"MyPermission\"\u003C/strong>\u003C/span>\n    ipapermission:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: MyPermission\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>attrs: description\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-member-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-rename-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.6. Using Ansible to rename an IdM RBAC permission\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can customize the IdM role-based access control.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to rename a permission. The example describes how to rename \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> to \u003Cspan class=\"strong strong\">\u003Cstrong>MyNewPermission\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>MyPermission\u003C/strong>\u003C/span> exists in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>MyNewPermission\u003C/strong>\u003C/span> does not exist in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">permission-renamed.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/permission/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/permission/permission-renamed.yml permission-renamed-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">permission-renamed-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipapermission\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the permission.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Permission present example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Rename the \"MyPermission\" permission\u003C/strong>\u003C/span>\n    ipapermission:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: MyPermission\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>rename: MyNewPermission\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: renamed\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory permission-renamed-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_4\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">14.7. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.1. Permissions in IdM\">Permissions in IdM\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm\" title=\"12.3. Privileges in IdM\">Privileges in IdM\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-permission\u003C/code> file available in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/ipapermission\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 15. Using Ansible to manage the replication topology in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can maintain multiple Identity Management (IdM) servers and let them replicate each other for redundancy purposes to mitigate or prevent server loss. For example, if one server fails, the other servers keep providing services to the domain. You can also recover the lost server by creating a new replica based on one of the remaining servers.\n\t\t\u003C/p>\u003Cp>\n\t\t\tData stored on an IdM server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. The data that is replicated is stored in the topology \u003Ccode class=\"literal\">suffixes\u003C/code>. When two replicas have a replication agreement between their suffixes, the suffixes form a topology \u003Ccode class=\"literal\">segment\u003C/code>.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis chapter describes how to use Ansible to manage IdM replication agreements, topology segments, and topology suffixes.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-a-replication-agreement-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.1. Using Ansible to ensure a replication agreement exists in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tData stored on an Identity Management (IdM) server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. Replication agreements are always bilateral: the data is replicated from the first replica to the other one as well as from the other replica to the first one.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that a replication agreement of the \u003Ccode class=\"literal\">domain\u003C/code> type exists between \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>replica.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure that you understand the recommendations for designing your IdM topology listed in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#guidelines-for-connecting-idm-replicas-in-a-topology_planning-the-replica-topology\">Guidelines for connecting IdM replicas in a topology\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and that you have access to a file that stores the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">add-topologysegment.yml\u003C/code> Ansible playbook file provided by the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/add-topologysegment.yml add-topologysegment-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">add-topologysegment-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipatopologysegment\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIndicate that the value of the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable is defined in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">suffix\u003C/code> variable to either \u003Ccode class=\"literal\">domain\u003C/code> or \u003Ccode class=\"literal\">ca\u003C/code>, depending on what type of segment you want to add.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">left\u003C/code> variable to the name of the IdM server that you want to be the left node of the replication agreement.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">right\u003C/code> variable to the name of the IdM server that you want to be the right node of the replication agreement.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle topologysegment\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n- name: Add topology segment\n    ipatopologysegment:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>suffix: domain\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>left: server.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>right: replica.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory add-topologysegment-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology\">Explaining Replication Agreements, Topology Suffixes, and Topology Segments\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-topology.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/topology\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-replication-agreements-exist-between-multiple-idm-replicas_using-ansible-to-manage-the-replication-topology-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.2. Using Ansible to ensure replication agreements exist between multiple IdM replicas\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tData stored on an Identity Management (IdM) server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. Replication agreements are always bilateral: the data is replicated from the first replica to the other one as well as from the other replica to the first one.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to ensure replication agreements exist between multiple pairs of replicas in IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure that you understand the recommendations for designing your IdM topology listed in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#guidelines-for-connecting-idm-replicas-in-a-topology_planning-the-replica-topology\">Connecting the replicas in a topology\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and that you have access to a file that stores the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">add-topologysegments.yml\u003C/code> Ansible playbook file provided by the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/add-topologysegments.yml add-topologysegments-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">add-topologysegments-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">vars\u003C/code> section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIndicate that the value of the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable is defined in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor every topology segment, add a line in the \u003Ccode class=\"literal\">ipatopology_segments\u003C/code> section and set the following variables:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">suffix\u003C/code> variable to either \u003Ccode class=\"literal\">domain\u003C/code> or \u003Ccode class=\"literal\">ca\u003C/code>, depending on what type of segment you want to add.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">left\u003C/code> variable to the name of the IdM server that you want to be the left node of the replication agreement.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">right\u003C/code> variable to the name of the IdM server that you want to be the right node of the replication agreement.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section of the \u003Ccode class=\"literal\">add-topologysegments-copy.yml\u003C/code> file, ensure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Add topology segments\n  hosts: ipaserver\n  gather_facts: false\n\n  vars:\n    \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n    ipatopology_segments:\n    - {suffix: domain, left: \u003Cspan class=\"strong strong\">\u003Cstrong>replica1.idm.example.com\u003C/strong>\u003C/span> , right: \u003Cspan class=\"strong strong\">\u003Cstrong>replica2.idm.example.com\u003C/strong>\u003C/span> }\n    - {suffix: domain, left: \u003Cspan class=\"strong strong\">\u003Cstrong>replica2.idm.example.com\u003C/strong>\u003C/span> , right: \u003Cspan class=\"strong strong\">\u003Cstrong>replica3.idm.example.com\u003C/strong>\u003C/span> }\n    - {suffix: domain, left: \u003Cspan class=\"strong strong\">\u003Cstrong>replica3.idm.example.com\u003C/strong>\u003C/span> , right: \u003Cspan class=\"strong strong\">\u003Cstrong>replica4.idm.example.com\u003C/strong>\u003C/span> }\n    - {suffix: domain+ca, left: \u003Cspan class=\"strong strong\">\u003Cstrong>replica4.idm.example.com\u003C/strong>\u003C/span> , right: \u003Cspan class=\"strong strong\">\u003Cstrong>replica1.idm.example.com\u003C/strong>\u003C/span> }\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Add topology segment\n    ipatopologysegment:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      suffix: \"{{ item.suffix }}\"\n      name: \"{{ item.name | default(omit) }}\"\n      left: \"{{ item.left }}\"\n      right: \"{{ item.right }}\"\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\n    loop: \"{{ ipatopology_segments | default([]) }}\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory add-topologysegments-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology\">Explaining Replication Agreements, Topology Suffixes, and Topology Segments\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-topology.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/topology\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-check-if-a-replication-agreement-exists-between-two-replicas_using-ansible-to-manage-the-replication-topology-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.3. Using Ansible to check if a replication agreement exists between two replicas\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tData stored on an Identity Management (IdM) server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. Replication agreements are always bilateral: the data is replicated from the first replica to the other one as well as from the other replica to the first one.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to verify that replication agreements exist between multiple pairs of replicas in IdM. In contrast to \u003Ca class=\"link\" href=\"#using-ansible-to-ensure-a-replication-agreement-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm\" title=\"15.1. Using Ansible to ensure a replication agreement exists in IdM\">Using Ansible to ensure a replication agreement exists in IdM\u003C/a>, this procedure does not modify the existing configuration.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEnsure that you understand the recommendations for designing your Identity Management (IdM) topology listed in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#guidelines-for-connecting-idm-replicas-in-a-topology_planning-the-replica-topology\">Connecting the replicas in a topology\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and that you have access to a file that stores the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">check-topologysegments.yml\u003C/code> Ansible playbook file provided by the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/check-topologysegments.yml check-topologysegments-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">check-topologysegments-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">vars\u003C/code> section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIndicate that the value of the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable is defined in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tFor every topology segment, add a line in the \u003Ccode class=\"literal\">ipatopology_segments\u003C/code> section and set the following variables:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">suffix\u003C/code> variable to either \u003Ccode class=\"literal\">domain\u003C/code> or \u003Ccode class=\"literal\">ca\u003C/code>, depending on the type of segment you are adding.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">left\u003C/code> variable to the name of the IdM server that you want to be the left node of the replication agreement.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">right\u003C/code> variable to the name of the IdM server that you want to be the right node of the replication agreement.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section of the \u003Ccode class=\"literal\">check-topologysegments-copy.yml\u003C/code> file, ensure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Add topology segments\n  hosts: ipaserver\n  gather_facts: false\n\n  vars:\n    \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n    \u003Cspan class=\"strong strong\">\u003Cstrong>ipatopology_segments:\u003C/strong>\u003C/span>\n    - \u003Cspan class=\"strong strong\">\u003Cstrong>{suffix: domain, left: replica1.idm.example.com, right: replica2.idm.example.com }\u003C/strong>\u003C/span>\n    - \u003Cspan class=\"strong strong\">\u003Cstrong>{suffix: domain, left: replica2.idm.example.com , right: replica3.idm.example.com }\u003C/strong>\u003C/span>\n    - \u003Cspan class=\"strong strong\">\u003Cstrong>{suffix: domain, left: replica3.idm.example.com , right: replica4.idm.example.com }\u003C/strong>\u003C/span>\n    - \u003Cspan class=\"strong strong\">\u003Cstrong>{suffix: domain+ca, left: replica4.idm.example.com , right: replica1.idm.example.com }\u003C/strong>\u003C/span>\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Check topology segment\n    ipatopologysegment:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      suffix: \"{{ item.suffix }}\"\n      name: \"{{ item.name | default(omit) }}\"\n      left: \"{{ item.left }}\"\n      right: \"{{ item.right }}\"\n      state: \u003Cspan class=\"strong strong\">\u003Cstrong>checked\u003C/strong>\u003C/span>\n    loop: \"{{ ipatopology_segments | default([]) }}\"\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory check-topologysegments-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology\">Explaining Replication Agreements, Topology Suffixes, and Topology Segments\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-topology.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/topology\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-verify-that-a-topology-suffix-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.4. Using Ansible to verify that a topology suffix exists in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn the context of replication agreements in Identity Management (IdM), topology suffixes store the data that is replicated. IdM supports two types of topology suffixes: \u003Ccode class=\"literal\">domain\u003C/code> and \u003Ccode class=\"literal\">ca\u003C/code>. Each suffix represents a separate back end, a separate replication topology. When a replication agreement is configured, it joins two topology suffixes of the same type on two different servers.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">domain\u003C/code> suffix contains all domain-related data, such as data about users, groups, and policies. The \u003Ccode class=\"literal\">ca\u003C/code> suffix contains data for the Certificate System component. It is only present on servers with a certificate authority (CA) installed.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that a topology suffix exists in IdM. The example describes how to ensure that the \u003Ccode class=\"literal\">domain\u003C/code> suffix exists in IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and that you have access to a file that stores the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">verify-topologysuffix.yml\u003C/code> Ansible playbook file provided by the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/ verify-topologysuffix.yml verify-topologysuffix-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">verify-topologysuffix-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipatopologysuffix\u003C/code> section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIndicate that the value of the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable is defined in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">suffix\u003C/code> variable to \u003Ccode class=\"literal\">domain\u003C/code>. If you are verifying the presence of the \u003Ccode class=\"literal\">ca\u003C/code> suffix, set the variable to \u003Ccode class=\"literal\">ca\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">verified\u003C/code>. No other option is possible.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle topologysuffix\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Verify topology suffix\n    ipatopologysuffix:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>suffix: domain\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: verified\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory verify-topologysuffix-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology\">Explaining Replication Agreements, Topology Suffixes, and Topology Segments\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-topology.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/topology\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-reinitialize-an-idm-replica_using-ansible-to-manage-the-replication-topology-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.5. Using Ansible to reinitialize an IdM replica\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf a replica has been offline for a long period of time or its database has been corrupted, you can reinitialize it. Reinitialization refreshes the replica with an updated set of data. Reinitialization can, for example, be used if an authoritative restore from backup is required.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn contrast to replication updates, during which replicas only send changed entries to each other, reinitialization refreshes the whole database.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tThe local host on which you run the command is the reinitialized replica. To specify the replica from which the data is obtained, use the \u003Ccode class=\"literal\">direction\u003C/code> option.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use an Ansible playbook to reinitialize the \u003Ccode class=\"literal\">domain\u003C/code> data on \u003Cspan class=\"strong strong\">\u003Cstrong>replica.idm.example.com\u003C/strong>\u003C/span> from \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and that you have access to a file that stores the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">reinitialize-topologysegment.yml\u003C/code> Ansible playbook file provided by the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/reinitialize-topologysegment.yml reinitialize-topologysegment-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">reinitialize-topologysegment-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipatopologysegment\u003C/code> section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIndicate that the value of the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable is defined in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">suffix\u003C/code> variable to \u003Ccode class=\"literal\">domain\u003C/code>. If you are reinitializing the \u003Ccode class=\"literal\">ca\u003C/code> data, set the variable to \u003Ccode class=\"literal\">ca\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">left\u003C/code> variable to the left node of the replication agreement.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">right\u003C/code> variable to the right node of the replication agreement.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">direction\u003C/code> variable to the direction of the reinitializing data. The \u003Ccode class=\"literal\">left-to-right\u003C/code> direction means that data flows from the left node to the right node.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">reinitialized\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle topologysegment\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Reinitialize topology segment\n    ipatopologysegment:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>suffix: domain\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>left: server.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>right: replica.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>direction: left-to-right\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: reinitialized\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory reinitialize-topologysegment-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology\">Explaining Replication Agreements, Topology Suffixes, and Topology Segments\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-topology.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/topology\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-a-replication-agreement-is-absent-in-idm_using-ansible-to-manage-the-replication-topology-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.6. Using Ansible to ensure a replication agreement is absent in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tData stored on an Identity Management (IdM) server is replicated based on replication agreements: when two servers have a replication agreement configured, they share their data. Replication agreements are always bilateral: the data is replicated from the first replica to the other one as well as from the other replica to the first one.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to ensure a replication agreement between two replicas does not exist in IdM. The example describes how to ensure a replication agreement of the \u003Ccode class=\"literal\">domain\u003C/code> type does not exist between the \u003Cspan class=\"strong strong\">\u003Cstrong>replica01.idm.example.com\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>replica02.idm.example.com\u003C/strong>\u003C/span> IdM servers.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou understand the recommendations for designing your IdM topology listed in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#guidelines-for-connecting-idm-replicas-in-a-topology_planning-the-replica-topology\">Connecting the replicas in a topology\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and that you have access to a file that stores the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">delete-topologysegment.yml\u003C/code> Ansible playbook file provided by the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/topology/delete-topologysegment.yml delete-topologysegment-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">delete-topologysegment-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipatopologysegment\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIndicate that the value of the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable is defined in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">suffix\u003C/code> variable to \u003Ccode class=\"literal\">domain\u003C/code>. Alternatively, if you are ensuring that the \u003Ccode class=\"literal\">ca\u003C/code> data are not replicated between the left and right nodes, set the variable to \u003Ccode class=\"literal\">ca\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">left\u003C/code> variable to the name of the IdM server that is the left node of the replication agreement.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">right\u003C/code> variable to the name of the IdM server that is the right node of the replication agreement.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle topologysegment\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n- name: Delete topology segment\n    ipatopologysegment:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>suffix: domain\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>left: replica01.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>right: replica02.idm.example.com:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory delete-topologysegment-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_managing-replication-topology_installing-identity-management#assembly_explaining-replication-agreements-topology-suffixes-and-topology-segments_assembly_managing-replication-topology\">Explaining Replication Agreements, Topology Suffixes, and Topology Segments\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-topology.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/topology\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional-resources_using-ansible-to-manage-the-replication-topology-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">15.7. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/planning_identity_management/index#planning-the-replica-topology_planning-identity-management\">Planning the replica topology\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/installing_identity_management/index#installing-an-ipa-replica_installing-identity-management\">Installing an IdM replica\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 16. Managing IdM servers by using Ansible\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can use \u003Ccode class=\"literal\">Red Hat Ansible Engine\u003C/code> to manage the servers in your Identity Management (IdM) topology. You can use the \u003Ccode class=\"literal\">server\u003C/code> module in the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package to check the presence or absence of a server in the IdM topology. You can also hide any replica or make a replica visible.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe section contains the following topics:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#checking-that-an-idm-server-is-present-by-using-ansible_managing-idm-servers-by-using-ansible\" title=\"16.1. Checking that an IdM server is present by using Ansible\">Checking that an IdM server is present by using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-that-an-idm-server-is-absent-from-an-idm-topology-by-using-ansible_managing-idm-servers-by-using-ansible\" title=\"16.2. Ensuring that an IdM server is absent from an IdM topology by using Ansible\">Ensuring that an IdM server is absent from an IdM topology by using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-an-idm-server-despite-hosting-a-last-idm-server-role_managing-idm-servers-by-using-ansible\" title=\"16.3. Ensuring the absence of an IdM server despite hosting a last IdM server role\">Ensuring the absence of an IdM server despite hosting a last IdM server role\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-that-an-idm-server-is-absent-but-not-necessarily-disconnected-from-other-idm-servers_managing-idm-servers-by-using-ansible\" title=\"16.4. Ensuring that an IdM server is absent but not necessarily disconnected from other IdM servers\">Ensuring that an IdM server is absent but not necessarily disconnected from other IdM servers\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-that-an-existing-idm-server-is-hidden-using-an-ansible-playbook_managing-idm-servers-by-using-ansible\" title=\"16.5. Ensuring that an existing IdM server is hidden using an Ansible playbook\">Ensuring that an existing IdM server is hidden using an Ansible playbook\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-that-an-existing-idm-server-is-visible-using-an-ansible-playbook_managing-idm-servers-by-using-ansible\" title=\"16.6. Ensuring that an existing IdM server is visible by using an Ansible playbook\">Ensuring that an existing IdM server is visible using an Ansible playbook\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-that-an-existing-idm-server-has-an-idm-dns-location-assigned_managing-idm-servers-by-using-ansible\" title=\"16.7. Ensuring that an existing IdM server has an IdM DNS location assigned\">Ensuring that an existing IdM server has an IdM DNS location assigned\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-that-an-existing-idm-server-has-no-idm-dns-location-assigned_managing-idm-servers-by-using-ansible\" title=\"16.8. Ensuring that an existing IdM server has no IdM DNS location assigned\">Ensuring that an existing IdM server has no IdM DNS location assigned\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"checking-that-an-idm-server-is-present-by-using-ansible_managing-idm-servers-by-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.1. Checking that an IdM server is present by using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ipaserver\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module in an Ansible playbook to verify that an Identity Management (IdM) server exists.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ipaserver\u003C/code> Ansible module does not install the IdM server.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">SSH\u003C/code> connection from the control node to the IdM server defined in the inventory file is working correctly.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">server-present.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-present.yml server-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">server-present-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaserver\u003C/code> task section and save the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the \u003Ccode class=\"literal\">FQDN\u003C/code> of the server. The \u003Ccode class=\"literal\">FQDN\u003C/code> of the example server is \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Server present example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure server server123.idm.example.com is present\n    ipaserver:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: server123.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook file and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory server-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management server using an Ansible playbook\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-server.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-that-an-idm-server-is-absent-from-an-idm-topology-by-using-ansible_managing-idm-servers-by-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.2. Ensuring that an IdM server is absent from an IdM topology by using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse an Ansible playbook to ensure an Identity Management (IdM) server does not exist in an IdM topology, even as a host.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn contrast to the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipaserver\u003C/code> role, the \u003Ccode class=\"literal\">ipaserver\u003C/code> module used in this playbook does not uninstall IdM services from the server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">SSH\u003C/code> connection from the control node to the IdM server defined in the inventory file is working correctly.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">server-absent.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-absent.yml server-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">server-absent-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaserver\u003C/code> task section and save the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the \u003Ccode class=\"literal\">FQDN\u003C/code> of the server. The \u003Ccode class=\"literal\">FQDN\u003C/code> of the example server is \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Server absent example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure server server123.idm.example.com is absent\n    ipaserver:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: server123.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook file and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory server-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMake sure all name server (NS) DNS records pointing to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-server_installing-identity-management\">Uninstalling an IdM server\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-server.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-an-idm-server-despite-hosting-a-last-idm-server-role_managing-idm-servers-by-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.3. Ensuring the absence of an IdM server despite hosting a last IdM server role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use Ansible to ensure that an Identity Management (IdM) server is absent even if the last IdM service instance is running on the server. A certificate authority (CA), key recovery authority (KRA), or DNS server are all examples of IdM services.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition warning\" state=\"danger\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Warning\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you remove the last server that serves as a CA, KRA, or DNS server, you disrupt IdM functionality seriously. You can manually check which services are running on which IdM servers with the \u003Ccode class=\"literal\">ipa service-find\u003C/code> command. The principal name of a CA server is \u003Ccode class=\"literal\">dogtag/\u003Cspan class=\"emphasis\">\u003Cem>server_name\u003C/em>\u003C/span>/\u003Cspan class=\"emphasis\">\u003Cem>REALM_NAME\u003C/em>\u003C/span>\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tIn contrast to the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipaserver\u003C/code> role, the \u003Ccode class=\"literal\">ipaserver\u003C/code> module used in this playbook does not uninstall IdM services from the server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">SSH\u003C/code> connection from the control node to the IdM server defined in the inventory file is working correctly.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">server-absent-ignore-last-of-role.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-absent-ignore-last-of-role.yml server-absent-ignore-last-of-role-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">server-absent-ignore-last-of-role-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaserver\u003C/code> task section and save the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the \u003Ccode class=\"literal\">FQDN\u003C/code> of the server. The \u003Ccode class=\"literal\">FQDN\u003C/code> of the example server is \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">ignore_last_of_role\u003C/code> variable is set to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Server absent with last of role skip example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure server “server123.idm.example.com” is absent with last of role skip\n    ipaserver:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: server123.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ignore_last_of_role: true\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook file and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory server-absent-ignore-last-of-role-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMake sure all name server (NS) DNS records that point to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-server_installing-identity-management\">Uninstalling an IdM server\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-server.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-that-an-idm-server-is-absent-but-not-necessarily-disconnected-from-other-idm-servers_managing-idm-servers-by-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.4. Ensuring that an IdM server is absent but not necessarily disconnected from other IdM servers\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you are removing an Identity Management (IdM) server from the topology, you can keep its replication agreements intact with an Ansible playbook. The playbook also ensures that the IdM server does not exist in IdM, even as a host.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIgnoring a server’s replication agreements when removing it is only recommended when the other servers are dysfunctional servers that you are planning to remove anyway. Removing a server that serves as a central point in the topology can split your topology into two disconnected clusters.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tYou can remove a dysfunctional server from the topology with the \u003Ccode class=\"literal\">ipa server-del\u003C/code> command.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIf you remove the last server that serves as a certificate authority (CA), key recovery authority (KRA), or DNS server, you seriously disrupt the Identity Management (IdM) functionality. To prevent this problem, the playbook makes sure these services are running on another server in the domain before it uninstalls a server that serves as a CA, KRA, or DNS server.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tIn contrast to the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipaserver\u003C/code> role, the \u003Ccode class=\"literal\">ipaserver\u003C/code> module used in this playbook does not uninstall IdM services from the server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">SSH\u003C/code> connection from the control node to the IdM server defined in the inventory file is working correctly.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">server-absent-ignore_topology_disconnect.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-absent-ignore_topology_disconnect.yml server-absent-ignore_topology_disconnect-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">server-absent-ignore_topology_disconnect-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaserver\u003C/code> task section and save the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the \u003Ccode class=\"literal\">FQDN\u003C/code> of the server. The \u003Ccode class=\"literal\">FQDN\u003C/code> of the example server is \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">ignore_topology_disconnect\u003C/code> variable is set to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Server absent with ignoring topology disconnects example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure server “server123.idm.example.com” with ignoring topology disconnects\n    ipaserver:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: server123.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ignore_topology_disconnect: true\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook file and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory server-absent-ignore_topology_disconnect-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOptional: Make sure all name server (NS) DNS records pointing to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> are deleted from your DNS zones. This applies regardless of whether you use integrated DNS managed by IdM or external DNS.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-server_installing-identity-management\">Uninstalling an IdM server\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-server.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-that-an-existing-idm-server-is-hidden-using-an-ansible-playbook_managing-idm-servers-by-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.5. Ensuring that an existing IdM server is hidden using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module in an Ansible playbook to ensure that an existing Identity Management (IdM) server is hidden. Note that this playbook does not install the IdM server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">SSH\u003C/code> connection from the control node to the IdM server defined in the inventory file is working correctly.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">server-hidden.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-hidden.yml server-hidden-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">server-hidden-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaserver\u003C/code> task section and save the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the \u003Ccode class=\"literal\">FQDN\u003C/code> of the server. The \u003Ccode class=\"literal\">FQDN\u003C/code> of the example server is \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">hidden\u003C/code> variable is set to \u003Ccode class=\"literal\">True\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Server hidden example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure server server123.idm.example.com is hidden\n    ipaserver:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: server123.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>hidden: True\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook file and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory server-hidden-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management server using an Ansible playbook\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#the-hidden-replica-mode_planning-the-replica-topology\">The hidden replica mode\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-server.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-that-an-existing-idm-server-is-visible-using-an-ansible-playbook_managing-idm-servers-by-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.6. Ensuring that an existing IdM server is visible by using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module in an Ansible playbook to ensure that an existing Identity Management (IdM) server is visible. Note that this playbook does not install the IdM server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">SSH\u003C/code> connection from the control node to the IdM server defined in the inventory file is working correctly.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">server-not-hidden.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-not-hidden.yml server-not-hidden-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">server-not-hidden-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaserver\u003C/code> task section and save the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the \u003Ccode class=\"literal\">FQDN\u003C/code> of the server. The \u003Ccode class=\"literal\">FQDN\u003C/code> of the example server is \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">hidden\u003C/code> variable is set to \u003Ccode class=\"literal\">no\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Server not hidden example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure server server123.idm.example.com is not hidden\n    ipaserver:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: server123.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>hidden: no\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook file and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory server-not-hidden-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management server using an Ansible playbook\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#the-hidden-replica-mode_planning-the-replica-topology\">The hidden replica mode\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-server.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-that-an-existing-idm-server-has-an-idm-dns-location-assigned_managing-idm-servers-by-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.7. Ensuring that an existing IdM server has an IdM DNS location assigned\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module in an Ansible playbook to ensure that an existing Identity Management (IdM) server is assigned a specific IdM DNS location.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNote that the \u003Ccode class=\"literal\">ipaserver\u003C/code> Ansible module does not install the IdM server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM DNS location exists. The example location is \u003Cspan class=\"strong strong\">\u003Cstrong>germany\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to the server. The example server is \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">SSH\u003C/code> connection from the control node to the IdM server defined in the inventory file is working correctly.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">server-location.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-location.yml server-location-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">server-location-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaserver\u003C/code> task section and save the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">location\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>germany\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Server enabled example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure server server123.idm.example.com with location “germany” is present\n    ipaserver:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: server123.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>location: germany\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook file and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory server-location-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConnect to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> as \u003Ccode class=\"literal\">root\u003C/code> using \u003Ccode class=\"literal\">SSH\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>ssh root@server123.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">named-pkcs11\u003C/code> service on the server for the updates to take effect immediately:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server123.idm.example.com ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart named-pkcs11\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management server using an Ansible playbook\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm\" title=\"29.4. Using Ansible to ensure an IdM location is present\">Using Ansible to ensure an IdM location is present\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-server.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-that-an-existing-idm-server-has-no-idm-dns-location-assigned_managing-idm-servers-by-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">16.8. Ensuring that an existing IdM server has no IdM DNS location assigned\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tUse the \u003Ccode class=\"literal\">ipaserver\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module in an Ansible playbook to ensure that an existing Identity Management (IdM) server has no IdM DNS location assigned to it. Do not assign a DNS location to servers that change geographical location frequently. Note that the playbook does not install the IdM server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to the server. The example server is \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">SSH\u003C/code> connection from the control node to the IdM server defined in the inventory file is working correctly.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">server-no-location.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/server/server-no-location.yml server-no-location-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">server-no-location-copy.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaserver\u003C/code> task section and save the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">location\u003C/code> variable is set to \u003Cspan class=\"strong strong\">\u003Cstrong>””\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Server no location example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure server server123.idm.example.com is present with no location\n    ipaserver:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: server123.idm.example.com\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>location: “”\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook file and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory server-no-location-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tConnect to \u003Cspan class=\"strong strong\">\u003Cstrong>server123.idm.example.com\u003C/strong>\u003C/span> as \u003Ccode class=\"literal\">root\u003C/code> using \u003Ccode class=\"literal\">SSH\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>ssh root@server123.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the \u003Ccode class=\"literal\">named-pkcs11\u003C/code> service on the server for the updates to take effect immediately:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@server123.idm.example.com ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart named-pkcs11\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management server using an Ansible playbook\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 29. Using Ansible to manage DNS locations in IdM\">Using Ansible to manage DNS locations in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-server.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/server\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 17. Managing hosts using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAnsible is an automation tool used to configure systems, deploy software, and perform rolling updates. Ansible includes support for Identity Management (IdM), and you can use Ansible modules to automate host management.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe following concepts and operations are performed when managing hosts and host entries using Ansible playbooks:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-IdM-host-entry-with-FQDN-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\" title=\"17.1. Ensuring the presence of an IdM host entry with FQDN using Ansible playbooks\">Ensuring the presence of IdM host entries that are only defined by their \u003Ccode class=\"literal\">FQDNs\u003C/code>\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\" title=\"17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks\">Ensuring the presence of IdM host entries with IP addresses\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-multiple-IdM-host-entries-with-random-passwords-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\" title=\"17.3. Ensuring the presence of multiple IdM host entries with random passwords using Ansible playbooks\">Ensuring the presence of multiple IdM host entries with random passwords\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-IdM-host-entry-with-multiple-IP-addresses-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\" title=\"17.4. Ensuring the presence of an IdM host entry with multiple IP addresses using Ansible playbooks\">Ensuring the presence of an IdM host entry with multiple IP addresses\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-an-IdM-host-entry-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\" title=\"17.5. Ensuring the absence of an IdM host entry using Ansible playbooks\">Ensuring the absence of IdM host entries\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-IdM-host-entry-with-FQDN-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.1. Ensuring the presence of an IdM host entry with FQDN using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the presence of host entries in Identity Management (IdM) using Ansible playbooks. The host entries are only defined by their \u003Ccode class=\"literal\">fully-qualified domain names\u003C/code> (FQDNs).\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tSpecifying the \u003Ccode class=\"literal\">FQDN\u003C/code> name of the host is enough if at least one of the following conditions applies:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM server is not configured to manage DNS.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host does not have a static IP address or the IP address is not known at the time the host is configured. Adding a host defined only by an \u003Ccode class=\"literal\">FQDN\u003C/code> essentially creates a placeholder entry in the IdM DNS service. For example, laptops may be preconfigured as IdM clients, but they do not have IP addresses at the time they are configured. When the DNS service dynamically updates its records, the host’s current IP address is detected and its DNS record is updated.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tWithout Ansible, host entries are created in IdM using the \u003Ccode class=\"literal command\">ipa host-add\u003C/code> command. The result of adding a host to IdM is the state of the host being present in IdM. Because of the Ansible reliance on idempotence, to add a host to IdM using Ansible, you must create a playbook in which you define the state of the host as present: \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the \u003Ccode class=\"literal\">FQDN\u003C/code> of the host whose presence in IdM you want to ensure. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/host/add-host.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Host present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Host host01.idm.example.com present\n    ipahost:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: host01.idm.example.com\n      state: present\n      force: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-host-is-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe procedure results in a host entry in the IdM LDAP server being created but not in enrolling the host into the IdM Kerberos realm. For that, you must deploy the host as an IdM client. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management client using an Ansible playbook\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to your IdM server as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnter the \u003Ccode class=\"literal\">ipa host-show\u003C/code> command and specify the name of the host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa host-show host01.idm.example.com\u003C/strong>\u003C/span>\n  Host name: host01.idm.example.com\n  Principal name: host/host01.idm.example.com@IDM.EXAMPLE.COM\n  Principal alias: host/host01.idm.example.com@IDM.EXAMPLE.COM\n  Password: False\n  Keytab: False\n  Managed by: host01.idm.example.com\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe output confirms that \u003Cspan class=\"strong strong\">\u003Cstrong>host01.idm.example.com\u003C/strong>\u003C/span> exists in IdM.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the presence of host entries in Identity Management (IdM) using Ansible playbooks. The host entries are defined by their \u003Ccode class=\"literal\">fully-qualified domain names\u003C/code> (FQDNs) and their IP addresses.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tWithout Ansible, host entries are created in IdM using the \u003Ccode class=\"literal command\">ipa host-add\u003C/code> command. The result of adding a host to IdM is the state of the host being present in IdM. Because of the Ansible reliance on idempotence, to add a host to IdM using Ansible, you must create a playbook in which you define the state of the host as present: \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the \u003Ccode class=\"literal\">fully-qualified domain name\u003C/code> (FQDN) of the host whose presence in IdM you want to ensure. In addition, if the IdM server is configured to manage DNS and you know the IP address of the host, specify a value for the \u003Ccode class=\"literal\">ip_address\u003C/code> parameter. The IP address is necessary for the host to exist in the DNS resource records. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/host/host-present.yml\u003C/code> file. You can also include other, additional information:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Host present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure host01.idm.example.com is present\n    ipahost:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: host01.idm.example.com\n      description: Example host\n      ip_address: 192.168.0.123\n      locality: Lab\n      ns_host_location: Lab\n      ns_os_version: CentOS 7\n      ns_hardware_platform: Lenovo T61\n      mac_address:\n      - \"08:00:27:E3:B1:2D\"\n      - \"52:54:00:BD:97:1E\"\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-host-is-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe procedure results in a host entry in the IdM LDAP server being created but not in enrolling the host into the IdM Kerberos realm. For that, you must deploy the host as an IdM client. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management client using an Ansible playbook\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to your IdM server as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnter the \u003Ccode class=\"literal\">ipa host-show\u003C/code> command and specify the name of the host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa host-show host01.idm.example.com\u003C/strong>\u003C/span>\n  Host name: host01.idm.example.com\n  Description: Example host\n  Locality: Lab\n  Location: Lab\n  Platform: Lenovo T61\n  Operating system: CentOS 7\n  Principal name: host/host01.idm.example.com@IDM.EXAMPLE.COM\n  Principal alias: host/host01.idm.example.com@IDM.EXAMPLE.COM\n  MAC address: 08:00:27:E3:B1:2D, 52:54:00:BD:97:1E\n  Password: False\n  Keytab: False\n  Managed by: host01.idm.example.com\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe output confirms \u003Cspan class=\"strong strong\">\u003Cstrong>host01.idm.example.com\u003C/strong>\u003C/span> exists in IdM.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-multiple-IdM-host-entries-with-random-passwords-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.3. Ensuring the presence of multiple IdM host entries with random passwords using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">ipahost\u003C/code> module allows the system administrator to ensure the presence or absence of multiple host entries in IdM using just one Ansible task. Follow this procedure to ensure the presence of multiple host entries that are only defined by their \u003Ccode class=\"literal\">fully-qualified domain names\u003C/code> (FQDNs). Running the Ansible playbook generates random passwords for the hosts.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tWithout Ansible, host entries are created in IdM using the \u003Ccode class=\"literal command\">ipa host-add\u003C/code> command. The result of adding a host to IdM is the state of the host being present in IdM. Because of the Ansible reliance on idempotence, to add a host to IdM using Ansible, you must create a playbook in which you define the state of the host as present: \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the \u003Ccode class=\"literal\">fully-qualified domain name\u003C/code> (FQDN) of the hosts whose presence in IdM you want to ensure. To make the Ansible playbook generate a random password for each host even when the host already exists in IdM and \u003Ccode class=\"literal\">update_password\u003C/code> is limited to \u003Ccode class=\"literal\">on_create\u003C/code>, add the \u003Ccode class=\"literal\">random: true\u003C/code> and \u003Ccode class=\"literal\">force: true\u003C/code> options. To simplify this step, you can copy and modify the example from the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-host.md\u003C/code> Markdown file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Ensure hosts with random password\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Hosts host01.idm.example.com and host02.idm.example.com present with random passwords\n    ipahost:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      hosts:\n      - name: host01.idm.example.com\n        random: true\n        force: true\n      - name: host02.idm.example.com\n        random: true\n        force: true\n    register: ipahost\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-hosts-are-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n[...]\nTASK [Hosts host01.idm.example.com and host02.idm.example.com present with random passwords]\nchanged: [r8server.idm.example.com] =&gt; {\"changed\": true, \"host\": {\"host01.idm.example.com\": {\"randompassword\": \"0HoIRvjUdH0Ycbf6uYdWTxH\"}, \"host02.idm.example.com\": {\"randompassword\": \"5VdLgrf3wvojmACdHC3uA3s\"}}}\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo deploy the hosts as IdM clients using random, one-time passwords (OTPs), see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management#authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible\">Authorization options for IdM client enrollment using an Ansible playbook\u003C/a> or \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_installing-an-idm-client_installing-identity-management#proc_installing-a-client-by-using-a-one-time-password-interactive-installation_assembly_installing-an-idm-client\">Installing a client by using a one-time password: Interactive installation\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to your IdM server as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnter the \u003Ccode class=\"literal\">ipa host-show\u003C/code> command and specify the name of one of the hosts:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa host-show host01.idm.example.com\u003C/strong>\u003C/span>\n  Host name: host01.idm.example.com\n  Password: True\n  Keytab: False\n  Managed by: host01.idm.example.com\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe output confirms \u003Cspan class=\"strong strong\">\u003Cstrong>host01.idm.example.com\u003C/strong>\u003C/span> exists in IdM with a random password.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-IdM-host-entry-with-multiple-IP-addresses-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.4. Ensuring the presence of an IdM host entry with multiple IP addresses using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the presence of a host entry in Identity Management (IdM) using Ansible playbooks. The host entry is defined by its \u003Ccode class=\"literal\">fully-qualified domain name\u003C/code> (FQDN) and its multiple IP addresses.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn contrast to the \u003Ccode class=\"literal\">ipa host\u003C/code> utility, the Ansible \u003Ccode class=\"literal\">ipahost\u003C/code> module can ensure the presence or absence of several IPv4 and IPv6 addresses for a host. The \u003Ccode class=\"literal\">ipa host-mod\u003C/code> command cannot handle IP addresses.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file. Specify, as the \u003Ccode class=\"literal\">name\u003C/code> of the \u003Ccode class=\"literal\">ipahost\u003C/code> variable, the \u003Ccode class=\"literal\">fully-qualified domain name\u003C/code> (FQDN) of the host whose presence in IdM you want to ensure. Specify each of the multiple IPv4 and IPv6 \u003Ccode class=\"literal\">ip_address\u003C/code> values on a separate line by using the \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>ip_address\u003C/em>\u003C/span>\u003C/strong>\u003C/span> syntax. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/host/host-member-ipaddresses-present.yml\u003C/code> file. You can also include additional information:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Host member IP addresses present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure host101.example.com IP addresses present\n    ipahost:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: host01.idm.example.com\n      ip_address:\n      - 192.168.0.123\n      - fe80::20c:29ff:fe02:a1b3\n      - 192.168.0.124\n      - fe80::20c:29ff:fe02:a1b4\n      force: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-host-with-multiple-IP-addreses-is-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe procedure creates a host entry in the IdM LDAP server but does not enroll the host into the IdM Kerberos realm. For that, you must deploy the host as an IdM client. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_installing-identity-management\">Installing an Identity Management client using an Ansible playbook\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to your IdM server as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tEnter the \u003Ccode class=\"literal\">ipa host-show\u003C/code> command and specify the name of the host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa host-show host01.idm.example.com\u003C/strong>\u003C/span>\n  Principal name: host/host01.idm.example.com@IDM.EXAMPLE.COM\n  Principal alias: host/host01.idm.example.com@IDM.EXAMPLE.COM\n  Password: False\n  Keytab: False\n  Managed by: host01.idm.example.com\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output confirms that \u003Cspan class=\"strong strong\">\u003Cstrong>host01.idm.example.com\u003C/strong>\u003C/span> exists in IdM.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo verify that the multiple IP addresses of the host exist in the IdM DNS records, enter the \u003Ccode class=\"literal\">ipa dnsrecord-show\u003C/code> command and specify the following information:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe name of the IdM domain\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe name of the host\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa dnsrecord-show idm.example.com host01\u003C/strong>\u003C/span>\n[...]\n  Record name: host01\n  A record: 192.168.0.123, 192.168.0.124\n  AAAA record: fe80::20c:29ff:fe02:a1b3, fe80::20c:29ff:fe02:a1b4\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output confirms that all the IPv4 and IPv6 addresses specified in the playbook are correctly associated with the \u003Cspan class=\"strong strong\">\u003Cstrong>host01.idm.example.com\u003C/strong>\u003C/span> host entry.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-an-IdM-host-entry-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.5. Ensuring the absence of an IdM host entry using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the absence of host entries in Identity Management (IdM) using Ansible playbooks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIdM administrator credentials\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the \u003Ccode class=\"literal\">fully-qualified domain name\u003C/code> (FQDN) of the host whose absence from IdM you want to ensure. If your IdM domain has integrated DNS, use the \u003Ccode class=\"literal\">updatedns: true\u003C/code> option to remove the associated records of any kind for the host from the DNS.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTo simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/host/delete-host.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Host absent\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Host host01.idm.example.com absent\n    ipahost:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: host01.idm.example.com\n      updatedns: true\n      state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-host-absent.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe procedure results in:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe host not being present in the IdM Kerberos realm.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tThe host entry not being present in the IdM LDAP server.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\t\tTo remove the specific IdM configuration of system services, such as System Security Services Daemon (SSSD), from the client host itself, you must run the \u003Ccode class=\"literal\">ipa-client-install --uninstall\u003C/code> command on the client. For details, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/uninstalling-an-ipa-client_installing-identity-management\">Uninstalling an IdM client\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about \u003Cspan class=\"emphasis\">\u003Cem>host01.idm.example.com\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa host-show host01.idm.example.com\u003C/strong>\u003C/span>\nipa: ERROR: host01.idm.example.com: host not found\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe output confirms that the host does not exist in IdM.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_5\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">17.6. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-host.md\u003C/code> Markdown file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the additional playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/host\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 18. Managing host groups using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tTo learn more about \u003Ca class=\"link\" href=\"#host-groups-in-idm_managing-host-groups-using-Ansible-playbooks\" title=\"18.1. Host groups in IdM\">host groups in Identity Management\u003C/a> (IdM) and using Ansible to perform operations involving host groups in Identity Management (IdM), see the following:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#host-groups-in-idm_managing-host-groups-using-Ansible-playbooks\" title=\"18.1. Host groups in IdM\">Host groups in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.2. Ensuring the presence of IdM host groups using Ansible playbooks\">Ensuring the presence of IdM host groups\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-hosts-in-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.3. Ensuring the presence of hosts in IdM host groups using Ansible playbooks\">Ensuring the presence of hosts in IdM host groups\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#nesting-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.4. Nesting IdM host groups using Ansible playbooks\">Nesting IdM host groups\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-member-managers-in-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.5. Ensuring the presence of member managers in IDM host groups using Ansible Playbooks\">Ensuring the presence of member managers in IdM host groups\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-hosts-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.6. Ensuring the absence of hosts from IdM host groups using Ansible playbooks\">Ensuring the absence of hosts from IdM host groups\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-nested-host-groups-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.7. Ensuring the absence of nested host groups from IdM host groups using Ansible playbooks\">Ensuring the absence of nested host groups from IdM host groups\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-member-managers-from-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.9. Ensuring the absence of member managers from IdM host groups using Ansible playbooks\">Ensuring the absence of member managers from IdM host groups\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"host-groups-in-idm_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.1. Host groups in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdM host groups can be used to centralize control over important management tasks, particularly access control.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Definition of host groups\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tA host group is an entity that contains a set of IdM hosts with common access control rules and other characteristics. For example, you can define host groups based on company departments, physical locations, or access control requirements.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tA host group in IdM can include:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIdM servers and clients\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOther IdM host groups\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Host groups created by default\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tBy default, the IdM server creates the host group \u003Ccode class=\"literal\">ipaservers\u003C/code> for all IdM server hosts.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Direct and indirect group members\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tGroup attributes in IdM apply to both direct and indirect members: when host group B is a member of host group A, all members of host group B are considered indirect members of host group A.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.2. Ensuring the presence of IdM host groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFollow this procedure to ensure the presence of host groups in Identity Management (IdM) using Ansible playbooks.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tWithout Ansible, host group entries are created in IdM using the \u003Ccode class=\"literal command\">ipa hostgroup-add\u003C/code> command. The result of adding a host group to IdM is the state of the host group being present in IdM. Because of the Ansible reliance on idempotence, to add a host group to IdM using Ansible, you must create a playbook in which you define the state of the host group as present: \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it with the list of IdM servers to target:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary host group information. For example, to ensure the presence of a host group named \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span>, specify \u003Ccode class=\"literal\">name: databases\u003C/code> in the \u003Ccode class=\"literal\">- ipahostgroup\u003C/code> task. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/user/ensure-hostgroup-is-present.yml\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle hostgroups\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure host-group databases is present\n  - ipahostgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: databases\n      state: present\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the playbook, \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span> signifies a request to add the host group to IdM unless it already exists there.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-hostgroup-is-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest a Kerberos ticket for admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about the host group whose presence in IdM you wanted to ensure:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa hostgroup-show databases\u003C/strong>\u003C/span>\n  Host-group: databases\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group exists in IdM.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-hosts-in-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.3. Ensuring the presence of hosts in IdM host groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFollow this procedure to ensure the presence of hosts in host groups in Identity Management (IdM) using Ansible playbooks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe hosts you want to reference in your Ansible playbook exist in IdM. For details, see \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\" title=\"17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks\">Ensuring the presence of an IdM host entry using Ansible playbooks\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host groups you reference from the Ansible playbook file have been added to IdM. For details, see \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.2. Ensuring the presence of IdM host groups using Ansible playbooks\">Ensuring the presence of IdM host groups using Ansible playbooks\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it with the list of IdM servers to target:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary host information. Specify the name of the host group using the \u003Ccode class=\"literal\">name\u003C/code> parameter of the \u003Ccode class=\"literal\">ipahostgroup\u003C/code> variable. Specify the name of the host with the \u003Ccode class=\"literal\">host\u003C/code> parameter of the \u003Ccode class=\"literal\">ipahostgroup\u003C/code> variable. To simplify this step, you can copy and modify the examples in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/hostgroup/ensure-hosts-and-hostgroups-are-present-in-hostgroup.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle hostgroups\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure host-group databases is present\n  - ipahostgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: databases\n      host:\n      - db.idm.example.com\n      action: member\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis playbook adds the \u003Cspan class=\"strong strong\">\u003Cstrong>db.idm.example.com\u003C/strong>\u003C/span> host to the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group. The \u003Ccode class=\"literal\">action: member\u003C/code> line indicates that when the playbook is run, no attempt is made to add the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> group itself. Instead, only an attempt is made to add \u003Cspan class=\"strong strong\">\u003Cstrong>db.idm.example.com\u003C/strong>\u003C/span> to \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-hosts-or-hostgroups-are-present-in-hostgroup.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest a Kerberos ticket for admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about a host group to see which hosts are present in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa hostgroup-show databases\u003C/strong>\u003C/span>\n  Host-group: databases\n  Member hosts: db.idm.example.com\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>db.idm.example.com\u003C/strong>\u003C/span> host is present as a member of the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"nesting-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.4. Nesting IdM host groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFollow this procedure to ensure the presence of nested host groups in Identity Management (IdM) host groups using Ansible playbooks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host groups you reference from the Ansible playbook file exist in IdM. For details, see \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.2. Ensuring the presence of IdM host groups using Ansible playbooks\">Ensuring the presence of IdM host groups using Ansible playbooks\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it with the list of IdM servers to target:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary host group information. To ensure that a nested host group \u003Cspan class=\"emphasis\">\u003Cem>A\u003C/em>\u003C/span> exists in a host group \u003Cspan class=\"emphasis\">\u003Cem>B\u003C/em>\u003C/span>: in the Ansible playbook, specify, among the \u003Ccode class=\"literal\">- ipahostgroup\u003C/code> variables, the name of the host group \u003Cspan class=\"emphasis\">\u003Cem>B\u003C/em>\u003C/span> using the \u003Ccode class=\"literal\">name\u003C/code> variable. Specify the name of the nested hostgroup \u003Cspan class=\"emphasis\">\u003Cem>A\u003C/em>\u003C/span> with the \u003Ccode class=\"literal\">hostgroup\u003C/code> variable. To simplify this step, you can copy and modify the examples in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/hostgroup/ensure-hosts-and-hostgroups-are-present-in-hostgroup.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle hostgroups\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure hosts and hostgroups are present in existing databases hostgroup\n  - ipahostgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: databases\n      hostgroup:\n      - mysql-server\n      - oracle-server\n      action: member\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis Ansible playbook ensures the presence of the \u003Cspan class=\"strong strong\">\u003Cstrong>myqsl-server\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>oracle-server\u003C/strong>\u003C/span> host groups in the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group. The \u003Ccode class=\"literal\">action: member\u003C/code> line indicates that when the playbook is run, no attempt is made to add the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> group itself to IdM.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-hosts-or-hostgroups-are-present-in-hostgroup.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest a Kerberos ticket for admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about the host group in which nested host groups are present:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa hostgroup-show databases\u003C/strong>\u003C/span>\n  Host-group: databases\n  Member hosts: db.idm.example.com\n  Member host-groups: mysql-server, oracle-server\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>mysql-server\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>oracle-server\u003C/strong>\u003C/span> host groups exist in the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-member-managers-in-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.5. Ensuring the presence of member managers in IDM host groups using Ansible Playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe following procedure describes ensuring the presence of member managers in IdM hosts and host groups using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou must have the name of the host or host group you are adding as member managers and the name of the host group you want them to manage.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary host and host group member management information:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n\n- name: Playbook to handle host group membership management\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure member manager user example_member is present for group_name\n      ipahostgroup:\n        ipaadmin_password: \"{{ ipaadmin_password }}\"\n        name: group_name\n        membermanager_user: example_member\n\n  - name: Ensure member manager group project_admins is present for group_name\n      ipahostgroup:\n        ipaadmin_password: \"{{ ipaadmin_password }}\"\n        name: group_name\n        membermanager_group: project_admins\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/add-member-managers-host-groups.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tYou can verify if the \u003Cspan class=\"strong strong\">\u003Cstrong>group_name\u003C/strong>\u003C/span> group contains \u003Cspan class=\"strong strong\">\u003Cstrong>example_member\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>project_admins\u003C/strong>\u003C/span> as member managers by using the \u003Ccode class=\"literal\">ipa group-show\u003C/code> command:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about \u003Cspan class=\"emphasis\">\u003Cem>testhostgroup\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ipaserver]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa hostgroup-show group_name\u003C/strong>\u003C/span>\n  Host-group: group_name\n  Member hosts: server.idm.example.com\n  Member host-groups: testhostgroup2\n  Membership managed by groups: project_admins\n  Membership managed by users: example_member\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa hostgroup-add-member-manager --help\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">ipa\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-hosts-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.6. Ensuring the absence of hosts from IdM host groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFollow this procedure to ensure the absence of hosts from host groups in Identity Management (IdM) using Ansible playbooks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe hosts you want to reference in your Ansible playbook exist in IdM. For details, see \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks\" title=\"17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks\">Ensuring the presence of an IdM host entry using Ansible playbooks\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host groups you reference from the Ansible playbook file exist in IdM. For details, see \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.2. Ensuring the presence of IdM host groups using Ansible playbooks\">Ensuring the presence of IdM host groups using Ansible playbooks\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it with the list of IdM servers to target:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary host and host group information. Specify the name of the host group using the \u003Ccode class=\"literal\">name\u003C/code> parameter of the \u003Ccode class=\"literal\">ipahostgroup\u003C/code> variable. Specify the name of the host whose absence from the host group you want to ensure using the \u003Ccode class=\"literal\">host\u003C/code> parameter of the \u003Ccode class=\"literal\">ipahostgroup\u003C/code> variable. To simplify this step, you can copy and modify the examples in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/hostgroup/ensure-hosts-and-hostgroups-are-absent-in-hostgroup.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle hostgroups\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure host-group databases is absent\n  - ipahostgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: databases\n      host:\n      - db.idm.example.com\n      action: member\n      state: absent\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis playbook ensures the absence of the \u003Cspan class=\"strong strong\">\u003Cstrong>db.idm.example.com\u003C/strong>\u003C/span> host from the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group. The \u003Cspan class=\"strong strong\">\u003Cstrong>action: member\u003C/strong>\u003C/span> line indicates that when the playbook is run, no attempt is made to remove the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> group itself.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-hosts-or-hostgroups-are-absent-in-hostgroup.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest a Kerberos ticket for admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about the host group and the hosts it contains:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa hostgroup-show databases\u003C/strong>\u003C/span>\n  Host-group: databases\n  Member host-groups: mysql-server, oracle-server\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>db.idm.example.com\u003C/strong>\u003C/span> host does not exist in the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-nested-host-groups-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.7. Ensuring the absence of nested host groups from IdM host groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFollow this procedure to ensure the absence of nested host groups from outer host groups in Identity Management (IdM) using Ansible playbooks.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host groups you reference from the Ansible playbook file exist in IdM. For details, see \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\" title=\"18.2. Ensuring the presence of IdM host groups using Ansible playbooks\">Ensuring the presence of IdM host groups using Ansible playbooks\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it with the list of IdM servers to target:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary host group information. Specify, among the \u003Ccode class=\"literal\">- ipahostgroup\u003C/code> variables, the name of the outer host group using the \u003Ccode class=\"literal\">name\u003C/code> variable. Specify the name of the nested hostgroup with the \u003Ccode class=\"literal\">hostgroup\u003C/code> variable. To simplify this step, you can copy and modify the examples in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/hostgroup/ensure-hosts-and-hostgroups-are-absent-in-hostgroup.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle hostgroups\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure hosts and hostgroups are absent in existing databases hostgroup\n  - ipahostgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: databases\n      hostgroup:\n      - mysql-server\n      - oracle-server\n      action: member\n      state: absent\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis playbook makes sure that the \u003Cspan class=\"strong strong\">\u003Cstrong>mysql-server\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>oracle-server\u003C/strong>\u003C/span> host groups are absent from the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group. The \u003Ccode class=\"literal\">action: member\u003C/code> line indicates that when the playbook is run, no attempt is made to ensure the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> group itself is deleted from IdM.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-hosts-or-hostgroups-are-absent-in-hostgroup.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest a Kerberos ticket for admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about the host group from which nested host groups should be absent:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa hostgroup-show databases\u003C/strong>\u003C/span>\n  Host-group: databases\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe output confirms that the \u003Cspan class=\"strong strong\">\u003Cstrong>mysql-server\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>oracle-server\u003C/strong>\u003C/span> nested host groups are absent from the outer \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.8. Ensuring the absence of IdM host groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tFollow this procedure to ensure the absence of host groups in Identity Management (IdM) using Ansible playbooks.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tWithout Ansible, host group entries are removed from IdM using the \u003Ccode class=\"literal command\">ipa hostgroup-del\u003C/code> command. The result of removing a host group from IdM is the state of the host group being absent from IdM. Because of the Ansible reliance on idempotence, to remove a host group from IdM using Ansible, you must create a playbook in which you define the state of the host group as absent: \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it with the list of IdM servers to target:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary host group information. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/user/ensure-hostgroup-is-absent.yml\u003C/code> file.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle hostgroups\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - Ensure host-group databases is absent\n    ipahostgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: databases\n      state: absent\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis playbook ensures the absence of the \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group from IdM. The \u003Ccode class=\"literal\">state: absent\u003C/code> means a request to delete the host group from IdM unless it is already deleted.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-hostgroup-is-absent.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest a Kerberos ticket for admin:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\nPassword for admin@IDM.EXAMPLE.COM:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about the host group whose absence you ensured:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa hostgroup-show databases\u003C/strong>\u003C/span>\nipa: ERROR: databases: host group not found\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>databases\u003C/strong>\u003C/span> host group does not exist in IdM.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-member-managers-from-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">18.9. Ensuring the absence of member managers from IdM host groups using Ansible playbooks\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe following procedure describes ensuring the absence of member managers in IdM hosts and host groups using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou must have the name of the user or user group you are removing as member managers and the name of the host group they are managing.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an Ansible playbook file with the necessary host and host group member management information:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n\n- name: Playbook to handle host group membership management\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure member manager host and host group members are absent for group_name\n    ipahostgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: group_name\n      membermanager_user: example_member\n      membermanager_group: project_admins\n      action: member\n      state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-member-managers-host-groups-are-absent.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tYou can verify if the \u003Cspan class=\"strong strong\">\u003Cstrong>group_name\u003C/strong>\u003C/span> group does not contain \u003Cspan class=\"strong strong\">\u003Cstrong>example_member\u003C/strong>\u003C/span> or \u003Cspan class=\"strong strong\">\u003Cstrong>project_admins\u003C/strong>\u003C/span> as member managers by using the \u003Ccode class=\"literal\">ipa group-show\u003C/code> command:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into \u003Ccode class=\"literal\">ipaserver\u003C/code> as administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh admin@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\n[admin@server /]$\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay information about \u003Cspan class=\"emphasis\">\u003Cem>testhostgroup\u003C/em>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">ipaserver]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa hostgroup-show group_name\u003C/strong>\u003C/span>\n  Host-group: group_name\n  Member hosts: server.idm.example.com\n  Member host-groups: testhostgroup2\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ccode class=\"literal\">ipa hostgroup-add-member-manager --help\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">ipa\u003C/code> man page on your system.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 19. Defining IdM password policies\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThis chapter describes Identity Management (IdM) password policies and how to add a new password policy in IdM using an Ansible playbook.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"what-is-a-password-policy_defining-idm-password-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.1. What is a password policy\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA password policy is a set of rules that passwords must meet. For example, a password policy can define the minimum password length and the maximum password lifetime. All users affected by this policy are required to set a sufficiently long password and change it frequently enough to meet the specified conditions. In this way, password policies help reduce the risk of someone discovering and misusing a user’s password.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"password-policies-in-idm_defining-idm-password-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.2. Password policies in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tPasswords are the most common way for Identity Management (IdM) users to authenticate to the IdM Kerberos domain. Password policies define the requirements that these IdM user passwords must meet.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe IdM password policy is set in the underlying LDAP directory, but the Kerberos Key Distribution Center (KDC) enforces the password policy.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\t\u003Ca class=\"link\" href=\"#tab-password-policy-attributes_defining-idm-password-policies\" title=\"Table 19.1. Password Policy Attributes\">Password policy attributes\u003C/a> lists the attributes you can use to define a password policy in IdM.\n\t\t\t\u003C/p>\u003Crh-table id=\"tab-password-policy-attributes_defining-idm-password-policies\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 19.1. Password Policy Attributes\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 40%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 40%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464213311728\" scope=\"col\">Attribute\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464213310640\" scope=\"col\">Explanation\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464213309552\" scope=\"col\">Example\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213311728\"> \u003Cp>\n\t\t\t\t\t\t\t\tMax lifetime\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213310640\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe maximum amount of time in days that a password is valid before a user must reset it. The default value is 90 days.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tNote that if the attribute is set to 0, the password never expires.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213309552\"> \u003Cp>\n\t\t\t\t\t\t\t\tMax lifetime = 180\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tUser passwords are valid only for 180 days. After that, IdM prompts users to change them.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213311728\"> \u003Cp>\n\t\t\t\t\t\t\t\tMin lifetime\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213310640\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe minimum amount of time in hours that must pass between two password change operations.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213309552\"> \u003Cp>\n\t\t\t\t\t\t\t\tMin lifetime = 1\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tAfter users change their passwords, they must wait at least 1 hour before changing them again.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213311728\"> \u003Cp>\n\t\t\t\t\t\t\t\tHistory size\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213310640\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe number of previous passwords that are stored. A user cannot reuse a password from their password history but can reuse old passwords that are not stored.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213309552\"> \u003Cp>\n\t\t\t\t\t\t\t\tHistory size = 0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tIn this case, the password history is empty and users can reuse any of their previous passwords.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213311728\"> \u003Cp>\n\t\t\t\t\t\t\t\tCharacter classes\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213310640\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe number of different character classes the user must use in the password. The character classes are:\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* Uppercase characters\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* Lowercase characters\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* Digits\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* Special characters, such as comma (,), period (.), asterisk (*)\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* Other UTF-8 characters\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tUsing a character three or more times in a row decreases the character class by one. For example:\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* \u003Ccode class=\"literal\">Secret1\u003C/code> has 3 character classes: uppercase, lowercase, digits\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\t* \u003Ccode class=\"literal\">Secret111\u003C/code> has 2 character classes: uppercase, lowercase, digits, and a -1 penalty for using \u003Ccode class=\"literal\">1\u003C/code> repeatedly\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213309552\"> \u003Cp>\n\t\t\t\t\t\t\t\tCharacter classes = 0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tThe default number of classes required is 0. To configure the number, run the \u003Ccode class=\"literal command\">ipa pwpolicy-mod\u003C/code> command with the \u003Ccode class=\"literal option\">--minclasses\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tSee also the \u003Ca class=\"link\" href=\"#english-alphabet\" title=\"Important\">Important\u003C/a> note below this table.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213311728\"> \u003Cp>\n\t\t\t\t\t\t\t\tMin length\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213310640\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe minimum number of characters in a password.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tIf any of the \u003Ca class=\"link\" href=\"#additional-password-policy-options-in-idm_defining-idm-password-policies\" title=\"19.6. Additional password policy options in IdM\">additional password policy options\u003C/a> are set, then the minimum length of passwords is 6 characters.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213309552\"> \u003Cp>\n\t\t\t\t\t\t\t\tMin length = 8\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tUsers cannot use passwords shorter than 8 characters.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213311728\"> \u003Cp>\n\t\t\t\t\t\t\t\tMax failures\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213310640\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe maximum number of failed login attempts before IdM locks the user account.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213309552\"> \u003Cp>\n\t\t\t\t\t\t\t\tMax failures = 6\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tIdM locks the user account when the user enters a wrong password 7 times in a row.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213311728\"> \u003Cp>\n\t\t\t\t\t\t\t\tFailure reset interval\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213310640\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe amount of time in seconds after which IdM resets the current number of failed login attempts.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213309552\"> \u003Cp>\n\t\t\t\t\t\t\t\tFailure reset interval = 60\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tIf the user waits for more than 1 minute after the number of failed login attempts defined in \u003Ccode class=\"literal\">Max failures\u003C/code>, the user can attempt to log in again without risking a user account lock.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213311728\"> \u003Cp>\n\t\t\t\t\t\t\t\tLockout duration\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213310640\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe amount of time in seconds that the user account is locked after the number of failed login attempts defined in \u003Ccode class=\"literal\">Max failures\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464213309552\"> \u003Cp>\n\t\t\t\t\t\t\t\tLockout duration = 600\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tUsers with locked accounts are unable to log in for 10 minutes.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-alert class=\"admonition important\" id=\"english-alphabet\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tUse the English alphabet and common symbols for the character classes requirement if you have a diverse set of hardware that may not have access to international characters and symbols. For more information about character class policies in passwords, see \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/3143431\">What characters are valid in a password?\u003C/a> in Red Hat Knowledgebase.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"password-policy-priorities-in-idm_defining-idm-password-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.3. Password policy priorities in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPassword policies help reduce the risk of someone discovering and misusing a user’s password. The default password policy is the \u003Cspan class=\"emphasis\">\u003Cem>global password policy\u003C/em>\u003C/span>. You can also create additional group password policies. The global policy rules apply to all users without a group password policy. Group password policies apply to all members of the corresponding user group.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNote that only one password policy can be in effect at a time for any user. If a user has multiple password policies assigned, one of them takes precedence based on priority according to the following rules:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tEvery group password policy has a priority set. The lower the value, the higher the policy’s priority. The lowest supported value is \u003Ccode class=\"literal\">0\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf multiple password policies are applicable to a user, the policy with the lowest priority value takes precedence. All rules defined in other policies are ignored.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe password policy with the lowest priority value applies to all password policy attributes, even the attributes that are not defined in the policy.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tThe global password policy does not have a priority value set. It serves as a fallback policy when no group policy is set for a user. The global policy can never take precedence over a group policy.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe \u003Ccode class=\"literal\">ipa pwpolicy-show --user=user_name\u003C/code> command shows which policy is currently in effect for a particular user.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-a-password-policy-in-idm-using-an-ansible-playbook_defining-idm-password-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.4. Ensuring the presence of a password policy in IdM using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the presence of a password policy in Identity Management (IdM) using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn the default \u003Ccode class=\"literal\">global_policy\u003C/code> password policy in IdM, the number of different character classes in the password is set to 0. The history size is also set to 0.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to enforce a stronger password policy for an IdM group using an Ansible playbook.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can only define a password policy for an IdM group. You cannot define a password policy for an individual user.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe group for which you are ensuring the presence of a password policy exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define the \u003Ccode class=\"literal\">FQDN\u003C/code> of your IdM server in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file that defines the password policy whose presence you want to ensure. To simplify this step, copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/pwpolicy/pwpolicy_present.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure presence of pwpolicy for group ops\n    ipapwpolicy:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: ops\n      minlife: 7\n      maxlife: 49\n      history: 5\n      priority: 1\n      lockouttime: 300\n      minlength: 8\n      minclasses: 4\n      maxfail: 3\n      failinterval: 5\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details on what the individual variables mean, see \u003Ca class=\"link\" href=\"#tab-password-policy-attributes_defining-idm-password-policies\" title=\"Table 19.1. Password Policy Attributes\">Password policy attributes\u003C/a>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory_/new_pwpolicy_present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou have successfully used an Ansible playbook to ensure that a password policy for the \u003Cspan class=\"strong strong\">\u003Cstrong>ops\u003C/strong>\u003C/span> group is present in IdM.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe priority of the \u003Cspan class=\"strong strong\">\u003Cstrong>ops\u003C/strong>\u003C/span> password policy is set to \u003Cspan class=\"emphasis\">\u003Cem>1\u003C/em>\u003C/span>, whereas the \u003Cspan class=\"strong strong\">\u003Cstrong>global_policy\u003C/strong>\u003C/span> password policy has no priority set. For this reason, the \u003Cspan class=\"strong strong\">\u003Cstrong>ops\u003C/strong>\u003C/span> policy automatically supersedes \u003Cspan class=\"strong strong\">\u003Cstrong>global_policy\u003C/strong>\u003C/span> for the \u003Cspan class=\"strong strong\">\u003Cstrong>ops\u003C/strong>\u003C/span> group and is enforced immediately.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>global_policy\u003C/strong>\u003C/span> serves as a fallback policy when no group policy is set for a user, and it can never take precedence over a group policy.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-pwpolicy.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#password-policy-priorities-in-idm_defining-idm-password-policies\" title=\"19.3. Password policy priorities in IdM\">Password policy priorities in IdM\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-new-password-policy-in-idm_defining-idm-password-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.5. Adding a new password policy in IdM using the WebUI or the CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tPassword policies help reduce the risk of someone discovering and misusing a user’s password. The default password policy is the \u003Cspan class=\"emphasis\">\u003Cem>global password policy\u003C/em>\u003C/span>. You can also create additional group password policies.\n\t\t\t\u003C/p>\u003Csection class=\"section\" id=\"adding-a-new-password-policy-webui_adding-a-new-password-policy-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">19.5.1. Adding a new password policy in the IdM WebUI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tPassword policies help reduce the risk of someone discovering and misusing a user’s password. The default password policy is the \u003Cspan class=\"emphasis\">\u003Cem>global password policy\u003C/em>\u003C/span>. You can also create additional group password policies.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tA user group to which the policy applies.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tA priority assigned to the policy\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tLog in to the IdM Web UI.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/accessing_identity_management_services/accessing-the-ipa-web-ui-in-a-web-browser_accessing-idm-services\">https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/accessing_identity_management_services/accessing-the-ipa-web-ui-in-a-web-browser_accessing-idm-services\u003C/a>\n\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSelect \u003Cspan class=\"strong strong\">\u003Cstrong>Policy&gt;Password Policies\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tDefine the user group and priority.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to confirm.\n\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\t\tTo configure the attributes of the new password policy, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/defining-idm-password-policies_managing-users-groups-hosts#password-policies-in-idm_defining-idm-password-policies\">Password policies in IdM\u003C/a>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#password-policy-priorities-in-idm_defining-idm-password-policies\" title=\"19.3. Password policy priorities in IdM\">Password policy priorities in IdM\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-new-password-policy-in-the-idm-cli_adding-a-new-password-policy-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch4 class=\"title\">19.5.2. Adding a new password policy in the IdM CLI\u003C/h4>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\t\tPassword policies help reduce the risk of someone discovering and misusing a user’s password. The default password policy is the \u003Cspan class=\"emphasis\">\u003Cem>global password policy\u003C/em>\u003C/span>. You can also create additional group password policies.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tA user group to which the policy applies.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tA priority assigned to the policy\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tOpen terminal and connect to the IdM server.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tUse the \u003Cspan class=\"strong strong\">\u003Cstrong>ipa pwpolicy-add\u003C/strong>\u003C/span> command. Specify the user group and priority:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa pwpolicy-add\nGroup: group_name\nPriority: priority_level\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOptional. Use the \u003Cspan class=\"strong strong\">\u003Cstrong>ipa pwpolicy-find\u003C/strong>\u003C/span> command to verify that the policy has been successfully added:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa pwpolicy-find\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\t\tTo configure the attributes of the new password policy, see \u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/defining-idm-password-policies_managing-users-groups-hosts#password-policies-in-idm_defining-idm-password-policies\">Password policies in IdM\u003C/a>.\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#password-policy-priorities-in-idm_defining-idm-password-policies\" title=\"19.3. Password policy priorities in IdM\">Password policy priorities in IdM\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"section\" id=\"additional-password-policy-options-in-idm_defining-idm-password-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.6. Additional password policy options in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs an Identity Management (IdM) administrator, you can strengthen the default password requirements by enabling additional password policy options based on the \u003Ccode class=\"literal\">libpwquality\u003C/code> feature set. The additional password policy options include the following:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">--maxrepeat\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the maximum acceptable number of same consecutive characters in the new password.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">--maxsequence\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSpecifies the maximum length of monotonic character sequences in the new password. Examples of such a sequence are \u003Cspan class=\"strong strong\">\u003Cstrong>12345\u003C/strong>\u003C/span> or \u003Cspan class=\"strong strong\">\u003Cstrong>fedcb\u003C/strong>\u003C/span>. Most such passwords will not pass the simplicity check.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">--dictcheck\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIf nonzero, checks whether the password, with possible modifications, matches a word in a dictionary. Currently \u003Ccode class=\"literal\">libpwquality\u003C/code> performs the dictionary check using the \u003Ccode class=\"literal\">cracklib\u003C/code> library.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">--usercheck\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tIf nonzero, checks whether the password, with possible modifications, contains the user name in some form. It is not performed for user names shorter than 3 characters.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tYou cannot apply the additional password policy options to existing passwords. If you apply any of the additional options, IdM automatically sets the \u003Ccode class=\"literal\">--minlength\u003C/code> option, the minimum number of characters in a password, to \u003Cspan class=\"strong strong\">\u003Cstrong>6\u003C/strong>\u003C/span> characters.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIn a mixed environment with RHEL 7, RHEL 8, and RHEL 9 servers, you can enforce the additional password policy settings only on servers running on RHEL 8.4 and later. If a user is logged in to an IdM client and the IdM client is communicating with an IdM server running on RHEL 8.3 or earlier, then the new password policy requirements set by the system administrator will not be applied. To ensure consistent behavior, upgrade or update all servers to RHEL 8.4 and later.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources:\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#applying-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies\" title=\"19.7. Applying additional password policy options to an IdM group\">Applying additional password policies to an IdM group\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pwquality(3)\u003C/code> man page on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"applying-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.7. Applying additional password policy options to an IdM group\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to apply additional password policy options in Identity Management (IdM). The example describes how to strengthen the password policy for the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> group by making sure that the new passwords do not contain the users' respective user names and that the passwords contain no more than two identical characters in succession.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as an IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> group exists in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> password policy exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tApply the user name check to all new passwords suggested by the users in the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> group:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa pwpolicy-mod --usercheck=True managers\u003C/strong>\u003C/span>\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf you do not specify the name of the password policy, the default \u003Ccode class=\"literal\">global_policy\u003C/code> is modified.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSet the maximum number of identical consecutive characters to 2 in the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> password policy:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa pwpolicy-mod --maxrepeat=2 managers\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tA password now will not be accepted if it contains more than 2 identical consecutive characters. For example, the \u003Cspan class=\"strong strong\">\u003Cstrong>eR873mUi111YJQ\u003C/strong>\u003C/span> combination is unacceptable because it contains three \u003Cspan class=\"strong strong\">\u003Cstrong>1\u003C/strong>\u003C/span>s in succession.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd a test user named \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add test_user\u003C/strong>\u003C/span>\nFirst name: test\nLast name: user\n----------------------------\nAdded user \"test_user\"\n----------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the test user to the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> group:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the IdM Web UI, click \u003Cspan class=\"guimenu\">Identity\u003C/span> → \u003Cspan class=\"guisubmenu\">Groups\u003C/span> → \u003Cspan class=\"guimenuitem\">User Groups\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add users into user group 'managers'\u003C/strong>\u003C/span> page, check \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick the \u003Ccode class=\"literal\">&gt;\u003C/code> arrow to move the user to the \u003Ccode class=\"literal\">Prospective\u003C/code> column.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReset the password for the test user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tGo to \u003Cspan class=\"guimenu\">Identity\u003C/span> → \u003Cspan class=\"guimenuitem\">Users\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">Actions\u003C/code> menu, click \u003Ccode class=\"literal\">Reset Password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnter a temporary password for the user.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the command line, try to obtain a Kerberos ticket-granting ticket (TGT) for the \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit test_user\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnter the temporary password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe system informs you that you must change your password. Enter a password that contains the user name of \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Password expired. You must change it now.\nEnter new password:\nEnter it again:\nPassword change rejected: Password not changed.\nUnspecified password quality failure while trying to change password.\nPlease try again.\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tKerberos does not have fine-grained error password policy reporting and, in certain cases, does not provide a clear reason why a password was rejected.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe system informs you that the entered password was rejected. Enter a password that contains three or more identical characters in succession:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Password change rejected: Password not changed.\nUnspecified password quality failure while trying to change password.\nPlease try again.\n\nEnter new password:\nEnter it again:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe system informs you that the entered password was rejected. Enter a password that meets the criteria of the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> password policy:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Password change rejected: Password not changed.\nUnspecified password quality failure while trying to change password.\nPlease try again.\n\nEnter new password:\nEnter it again:\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the obtained TGT:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>klist\u003C/strong>\u003C/span>\nTicket cache: KCM:0:33945\nDefault principal: test_user@IDM.EXAMPLE.COM\n\nValid starting       Expires              Service principal\n07/07/2021 12:44:44  07/08/2021 12:44:44  krbtgt@IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> password policy now works correctly for users in the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> group.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#additional-password-policy-options-in-idm_defining-idm-password-policies\" title=\"19.6. Additional password policy options in IdM\">Additional password policies in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-apply-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">19.8. Using an Ansible playbook to apply additional password policy options to an IdM group\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use an Ansible playbook to apply additional password policy options to strengthen the password policy requirements for a specific IdM group. You can use the \u003Ccode class=\"literal\">maxrepeat\u003C/code>, \u003Ccode class=\"literal\">maxsequence\u003C/code>, \u003Ccode class=\"literal\">dictcheck\u003C/code> and \u003Ccode class=\"literal\">usercheck\u003C/code> password policy options for this purpose. The example describes how to set the following requirements for the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> group:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUsers' new passwords do not contain the users' respective user names.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe passwords contain no more than two identical characters in succession.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAny monotonic character sequences in the passwords are not longer than 3 characters. This means that the system does not accept a password with a sequence such as \u003Cspan class=\"strong strong\">\u003Cstrong>1234\u003C/strong>\u003C/span> or \u003Cspan class=\"strong strong\">\u003Cstrong>abcd\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe group for which you are ensuring the presence of a password policy exists in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>manager_pwpolicy_present.yml\u003C/strong>\u003C/span> that defines the password policy whose presence you want to ensure. To simplify this step, copy and modify the following example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure presence of usercheck and maxrepeat pwpolicy for group managers\n    ipapwpolicy:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: managers\n      usercheck: True\n      maxrepeat: 2\n      maxsequence: 3\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory_/manager_pwpolicy_present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd a test user named \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-add test_user\u003C/strong>\u003C/span>\nFirst name: test\nLast name: user\n----------------------------\nAdded user \"test_user\"\n----------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the test user to the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> group:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the IdM Web UI, click \u003Cspan class=\"guimenu\">Identity\u003C/span> → \u003Cspan class=\"guisubmenu\">Groups\u003C/span> → \u003Cspan class=\"guimenuitem\">User Groups\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add users into user group 'managers'\u003C/strong>\u003C/span> page, check \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick the \u003Ccode class=\"literal\">&gt;\u003C/code> arrow to move the user to the \u003Ccode class=\"literal\">Prospective\u003C/code> column.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReset the password for the test user:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tGo to \u003Cspan class=\"guimenu\">Identity\u003C/span> → \u003Cspan class=\"guimenuitem\">Users\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">Actions\u003C/code> menu, click \u003Ccode class=\"literal\">Reset Password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnter a temporary password for the user.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the command line, try to obtain a Kerberos ticket-granting ticket (TGT) for the \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit test_user\u003C/strong>\u003C/span>\u003C/pre>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnter the temporary password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe system informs you that you must change your password. Enter a password that contains the user name of \u003Cspan class=\"strong strong\">\u003Cstrong>test_user\u003C/strong>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Password expired. You must change it now.\nEnter new password:\nEnter it again:\nPassword change rejected: Password not changed.\nUnspecified password quality failure while trying to change password.\nPlease try again.\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tKerberos does not have fine-grained error password policy reporting and, in certain cases, does not provide a clear reason why a password was rejected.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe system informs you that the entered password was rejected. Enter a password that contains three or more identical characters in succession:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Password change rejected: Password not changed.\nUnspecified password quality failure while trying to change password.\nPlease try again.\n\nEnter new password:\nEnter it again:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe system informs you that the entered password was rejected. Enter a password that contains a monotonic character sequence longer than 3 characters. Examples of such sequences include \u003Cspan class=\"strong strong\">\u003Cstrong>1234\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>fedc\u003C/strong>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Password change rejected: Password not changed.\nUnspecified password quality failure while trying to change password.\nPlease try again.\n\nEnter new password:\nEnter it again:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe system informs you that the entered password was rejected. Enter a password that meets the criteria of the \u003Cspan class=\"strong strong\">\u003Cstrong>managers\u003C/strong>\u003C/span> password policy:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Password change rejected: Password not changed.\nUnspecified password quality failure while trying to change password.\nPlease try again.\n\nEnter new password:\nEnter it again:\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that you have obtained a TGT, which is only possible after having entered a valid password:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>klist\u003C/strong>\u003C/span>\nTicket cache: KCM:0:33945\nDefault principal: test_user@IDM.EXAMPLE.COM\n\nValid starting       Expires              Service principal\n07/07/2021 12:44:44  07/08/2021 12:44:44  krbtgt@IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#additional-password-policy-options-in-idm_defining-idm-password-policies\" title=\"19.6. Additional password policy options in IdM\">Additional password policies in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-pwpolicy.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/pwpolicy\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"granting-sudo-access-to-an-IdM-user-on-an-IdM-client_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 20. Granting sudo access to an IdM user on an IdM client\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tLearn more about granting \u003Ccode class=\"literal\">sudo\u003C/code> access to users in Identity Management.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.1. Sudo access on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tSystem administrators can grant \u003Ccode class=\"literal\">sudo\u003C/code> access to allow non-root users to execute administrative commands that are normally reserved for the \u003Ccode class=\"literal\">root\u003C/code> user. Consequently, when users need to perform an administrative command normally reserved for the \u003Ccode class=\"literal\">root\u003C/code> user, they precede that command with \u003Ccode class=\"literal\">sudo\u003C/code>. After entering their password, the command is executed as if they were the \u003Ccode class=\"literal\">root\u003C/code> user. To execute a \u003Ccode class=\"literal\">sudo\u003C/code> command as another user or group, such as a database service account, you can configure a \u003Cspan class=\"emphasis\">\u003Cem>RunAs alias\u003C/em>\u003C/span> for a \u003Ccode class=\"literal\">sudo\u003C/code> rule.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf a Red Hat Enterprise Linux (RHEL) 8 host is enrolled as an Identity Management (IdM) client, you can specify \u003Ccode class=\"literal\">sudo\u003C/code> rules defining which IdM users can perform which commands on the host in the following ways:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLocally in the \u003Ccode class=\"literal\">/etc/sudoers\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCentrally in IdM\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tYou can create a \u003Cspan class=\"strong strong\">\u003Cstrong>central \u003Ccode class=\"literal\">sudo\u003C/code> rule\u003C/strong>\u003C/span> for an IdM client using the command line interface (CLI) and the IdM Web UI.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can also configure password-less authentication for \u003Ccode class=\"literal\">sudo\u003C/code> using the Generic Security Service Application Programming Interface (GSSAPI), the native way for UNIX-based operating systems to access and authenticate Kerberos services. You can use the \u003Ccode class=\"literal\">pam_sss_gss.so\u003C/code> Pluggable Authentication Module (PAM) to invoke GSSAPI authentication via the SSSD service, allowing users to authenticate to the \u003Ccode class=\"literal\">sudo\u003C/code> command with a valid Kerberos ticket.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_basic_system_settings/managing-sudo-access_configuring-basic-system-settings\">Managing sudo access\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.2. Granting sudo access to an IdM user on an IdM client using the CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn Identity Management (IdM), you can grant \u003Ccode class=\"literal\">sudo\u003C/code> access for a specific command to an IdM user account on a specific IdM host. First, add a \u003Ccode class=\"literal\">sudo\u003C/code> command and then create a \u003Ccode class=\"literal\">sudo\u003C/code> rule for one or more commands.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFor example, complete this procedure to create the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span> \u003Ccode class=\"literal\">sudo\u003C/code> rule to grant the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> account the permission to run the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command on the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> machine.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a user account for \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the CLI, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line\">Adding users using the command line\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo local \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> account is present on the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> host. The \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> user is not listed in the local \u003Ccode class=\"literal\">/etc/passwd\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRetrieve a Kerberos ticket as the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command to the IdM database of \u003Ccode class=\"literal\">sudo\u003C/code> commands:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudocmd-add /usr/sbin/reboot\u003C/strong>\u003C/span>\n-------------------------------------\nAdded Sudo Command \"/usr/sbin/reboot\"\n-------------------------------------\n  Sudo Command: /usr/sbin/reboot\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">sudo\u003C/code> rule named \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add \u003Cspan class=\"emphasis\">\u003Cem>idm_user_reboot\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n---------------------------------\nAdded Sudo Rule \"idm_user_reboot\"\n---------------------------------\n  Rule name: idm_user_reboot\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command to the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span> rule:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-allow-command idm_user_reboot --sudocmds '/usr/sbin/reboot'\u003C/strong>\u003C/span>\n  Rule name: idm_user_reboot\n  Enabled: TRUE\n  Sudo Allow Commands: /usr/sbin/reboot\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tApply the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span> rule to the IdM \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-host idm_user_reboot --hosts idmclient.idm.example.com\u003C/strong>\u003C/span>\nRule name: idm_user_reboot\nEnabled: TRUE\nHosts: idmclient.idm.example.com\nSudo Allow Commands: /usr/sbin/reboot\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> account to the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span> rule:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-user idm_user_reboot --users idm_user\u003C/strong>\u003C/span>\nRule name: idm_user_reboot\nEnabled: TRUE\nUsers: idm_user\nHosts: idmclient.idm.example.com\nSudo Allow Commands: /usr/sbin/reboot\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Define the validity of the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span> rule:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo define the time at which a \u003Ccode class=\"literal\">sudo\u003C/code> rule starts to be valid, use the \u003Ccode class=\"literal\">ipa sudorule-mod \u003Cspan class=\"emphasis\">\u003Cem>sudo_rule_name\u003C/em>\u003C/span>\u003C/code> command with the \u003Ccode class=\"literal\">--setattr sudonotbefore=\u003Cspan class=\"emphasis\">\u003Cem>DATE\u003C/em>\u003C/span>\u003C/code> option. The \u003Cspan class=\"emphasis\">\u003Cem>DATE\u003C/em>\u003C/span> value must follow the \u003Cspan class=\"strong strong\">\u003Cstrong>yyyymmddHHMMSSZ\u003C/strong>\u003C/span> format, with seconds specified explicitly. For example, to set the start of the validity of the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span> rule to 31 December 2025 12:34:00, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-mod idm_user_reboot --setattr sudonotbefore=20251231123400Z\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTo define the time at which a sudo rule stops being valid, use the \u003Ccode class=\"literal\">--setattr sudonotafter=DATE\u003C/code> option. For example, to set the end of the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span> rule validity to 31 December 2026 12:34:00, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-mod idm_user_reboot --setattr sudonotafter=20261231123400Z\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tPropagating the changes from the server to the client can take a few minutes.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in to the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> host as the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> account.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay which \u003Ccode class=\"literal\">sudo\u003C/code> rules the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> account is allowed to perform.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -l\u003C/strong>\u003C/span>\nMatching Defaults entries for \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span>:\n    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,\n    env_reset, env_keep=\"COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS\",\n    env_keep+=\"MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\",\n    env_keep+=\"LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES\",\n    env_keep+=\"LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\",\n    env_keep+=\"LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME\",\n    secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\n\nUser \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> may run the following commands on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span>:\n    \u003Cspan class=\"strong strong\">\u003Cstrong>(root) /usr/sbin/reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReboot the machine using \u003Ccode class=\"literal\">sudo\u003C/code>. Enter the password for \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> when prompted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo /usr/sbin/reboot\u003C/strong>\u003C/span>\n[sudo] password for idm_user:\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_granting-sudo-access-to-an-ad-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.3. Granting sudo access to an AD user on an IdM client using the CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdentity Management (IdM) system administrators can use IdM user groups to set access permissions, host-based access control, \u003Ccode class=\"literal\">sudo\u003C/code> rules, and other controls on IdM users. IdM user groups grant and restrict access to IdM domain resources.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can add both Active Directory (AD) \u003Cspan class=\"emphasis\">\u003Cem>users\u003C/em>\u003C/span> and AD \u003Cspan class=\"emphasis\">\u003Cem>groups\u003C/em>\u003C/span> to IdM user groups. To do that:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd the AD users or groups to a \u003Cspan class=\"emphasis\">\u003Cem>non-POSIX\u003C/em>\u003C/span> external IdM group.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd the non-POSIX external IdM group to an IdM \u003Cspan class=\"emphasis\">\u003Cem>POSIX\u003C/em>\u003C/span> group.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou can then manage the privileges of the AD users by managing the privileges of the POSIX group. For example, you can grant \u003Ccode class=\"literal\">sudo\u003C/code> access for a specific command to an IdM POSIX user group on a specific IdM host.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tIt is also possible to add AD user groups as members to IdM external groups. This might make it easier to define policies for Windows users, by keeping the user and group management within the single AD realm.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo \u003Cspan class=\"strong strong\">\u003Cstrong>not\u003C/strong>\u003C/span> use ID overrides of AD users for SUDO rules in IdM. ID overrides of AD users represent only POSIX attributes of AD users, not AD users themselves.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tYou can add ID overrides as group members. However, you can only use this functionality to manage IdM resources in the IdM API. The possibility to add ID overrides as group members is not extended to POSIX environments and you therefore cannot use it for membership in \u003Ccode class=\"literal\">sudo\u003C/code> or host-based access control (HBAC) rules.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tFollow this procedure to create the \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users_reboot\u003C/strong>\u003C/span> \u003Ccode class=\"literal\">sudo\u003C/code> rule to grant the \u003Cspan class=\"strong strong\">\u003Cstrong>administrator@ad-domain.com\u003C/strong>\u003C/span> AD user the permission to run the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command on the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> IdM host, which is normally reserved for the \u003Ccode class=\"literal\">root\u003C/code> user. \u003Cspan class=\"strong strong\">\u003Cstrong>administrator@ad-domain.com\u003C/strong>\u003C/span> is a member of the \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users_external\u003C/strong>\u003C/span> non-POSIX group, which is, in turn, a member of the \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users\u003C/strong>\u003C/span> POSIX group.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have obtained the IdM \u003Ccode class=\"literal\">admin\u003C/code> Kerberos ticket-granting ticket (TGT).\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA cross-forest trust exists between the IdM domain and the \u003Cspan class=\"strong strong\">\u003Cstrong>ad-domain.com\u003C/strong>\u003C/span> AD domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo local \u003Cspan class=\"strong strong\">\u003Cstrong>administrator\u003C/strong>\u003C/span> account is present on the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> host: the \u003Cspan class=\"strong strong\">\u003Cstrong>administrator\u003C/strong>\u003C/span> user is not listed in the local \u003Ccode class=\"literal\">/etc/passwd\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate the \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>ad_users\u003C/em>\u003C/span>\u003C/strong>\u003C/span> group that contains the \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>ad_users_external\u003C/em>\u003C/span>\u003C/strong>\u003C/span> group with the \u003Cspan class=\"strong strong\">\u003Cstrong>administrator@ad-domain\u003C/strong>\u003C/span> member:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptional: Create or select a corresponding group in the AD domain to use to manage AD users in the IdM realm. You can use multiple AD groups and add them to different groups on the IdM side.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>ad_users_external\u003C/em>\u003C/span>\u003C/strong>\u003C/span> group and indicate that it contains members from outside the IdM domain by adding the \u003Ccode class=\"literal option\">--external\u003C/code> option:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa group-add --desc='AD users external map' ad_users_external --external\u003C/strong>\u003C/span>\n-------------------------------\nAdded group \"ad_users_external\"\n-------------------------------\n  Group name: ad_users_external\n  Description: AD users external map\u003C/pre>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\t\tEnsure that the external group that you specify here is an AD security group with a \u003Ccode class=\"literal\">global\u003C/code> or \u003Ccode class=\"literal\">universal\u003C/code> group scope as defined in the \u003Ca class=\"link\" href=\"https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups\">Active Directory security groups\u003C/a> document. For example, the \u003Cspan class=\"strong strong\">\u003Cstrong>Domain users\u003C/strong>\u003C/span> or \u003Cspan class=\"strong strong\">\u003Cstrong>Domain admins\u003C/strong>\u003C/span> AD security groups cannot be used because their group scope is \u003Ccode class=\"literal\">domain local\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users\u003C/strong>\u003C/span> group:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa group-add --desc='AD users' ad_users\u003C/strong>\u003C/span>\n----------------------\nAdded group \"ad_users\"\n----------------------\n  Group name: ad_users\n  Description: AD users\n  GID: 129600004\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the \u003Cspan class=\"strong strong\">\u003Cstrong>administrator@ad-domain.com\u003C/strong>\u003C/span> AD user to \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users_external\u003C/strong>\u003C/span> as an external member:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa group-add-member ad_users_external --external \"administrator@ad-domain.com\"\u003C/strong>\u003C/span>\n [member user]:\n [member group]:\n  Group name: ad_users_external\n  Description: AD users external map\n  External member: S-1-5-21-3655990580-1375374850-1633065477-513\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe AD user must be identified by a fully-qualified name, such as \u003Ccode class=\"literal\">DOMAIN\\user_name\u003C/code> or \u003Ccode class=\"literal\">user_name@DOMAIN\u003C/code>. The AD identity is then mapped to the AD SID for the user. The same applies to adding AD groups.\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users_external\u003C/strong>\u003C/span> to \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users\u003C/strong>\u003C/span> as a member:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@ipaserver ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa group-add-member ad_users --groups ad_users_external\u003C/strong>\u003C/span>\n  Group name: ad_users\n  Description: AD users\n  GID: 129600004\n  Member groups: ad_users_external\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGrant the members of \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users\u003C/strong>\u003C/span> the permission to run \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> on the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> host:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command to the IdM database of \u003Ccode class=\"literal\">sudo\u003C/code> commands:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudocmd-add /usr/sbin/reboot\u003C/strong>\u003C/span>\n-------------------------------------\nAdded Sudo Command \"/usr/sbin/reboot\"\n-------------------------------------\n  Sudo Command: /usr/sbin/reboot\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">sudo\u003C/code> rule named \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users_reboot\u003C/strong>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add \u003Cspan class=\"emphasis\">\u003Cem>ad_users_reboot\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n---------------------------------\nAdded Sudo Rule \"ad_users_reboot\"\n---------------------------------\n  Rule name: ad_users_reboot\n  Enabled: True\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command to the \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users_reboot\u003C/strong>\u003C/span> rule:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-allow-command ad_users_reboot --sudocmds '/usr/sbin/reboot'\u003C/strong>\u003C/span>\n  Rule name: ad_users_reboot\n  Enabled: True\n  Sudo Allow Commands: /usr/sbin/reboot\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tApply the \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users_reboot\u003C/strong>\u003C/span> rule to the IdM \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> host:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-host ad_users_reboot --hosts idmclient.idm.example.com\u003C/strong>\u003C/span>\nRule name: ad_users_reboot\nEnabled: True\nHosts: idmclient.idm.example.com\nSudo Allow Commands: /usr/sbin/reboot\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">ad_users\u003C/code> group to the \u003Cspan class=\"strong strong\">\u003Cstrong>ad_users_reboot\u003C/strong>\u003C/span> rule:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-user ad_users_reboot --groups ad_users\u003C/strong>\u003C/span>\nRule name: ad_users_reboot\nEnabled: TRUE\nUser Groups: ad_users\nHosts: idmclient.idm.example.com\nSudo Allow Commands: /usr/sbin/reboot\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tPropagating the changes from the server to the client can take a few minutes.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> host as \u003Cspan class=\"strong strong\">\u003Cstrong>administrator@ad-domain.com\u003C/strong>\u003C/span>, an indirect member of the \u003Ccode class=\"literal\">ad_users\u003C/code> group:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh administrator@ad-domain.com@ipaclient\u003C/strong>\u003C/span>\nPassword:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Display the \u003Ccode class=\"literal\">sudo\u003C/code> commands that \u003Ccode class=\"literal\">administrator@ad-domain.com\u003C/code> is allowed to execute:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[administrator@ad-domain.com@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -l\u003C/strong>\u003C/span>\nMatching Defaults entries for \u003Cspan class=\"strong strong\">\u003Cstrong>administrator@ad-domain.com\u003C/strong>\u003C/span> on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span>:\n    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,\n    env_reset, env_keep=\"COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS\",\n    env_keep+=\"MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\",\n    env_keep+=\"LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES\",\n    env_keep+=\"LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\",\n    env_keep+=\"LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME\",\n    secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\n\nUser \u003Cspan class=\"strong strong\">\u003Cstrong>administrator@ad-domain.com\u003C/strong>\u003C/span> may run the following commands on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span>:\n    \u003Cspan class=\"strong strong\">\u003Cstrong>(root) /usr/sbin/reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReboot the machine using \u003Ccode class=\"literal\">sudo\u003C/code>. Enter the password for \u003Ccode class=\"literal\">administrator@ad-domain.com\u003C/code> when prompted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[administrator@ad-domain.com@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo /usr/sbin/reboot\u003C/strong>\u003C/span>\n[sudo] password for administrator@ad-domain.com:\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html-single/windows_integration_guide/index#trust-win-groups\">Active Directory users and Identity Management groups\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://freeipa.readthedocs.io/en/latest/designs/adtrust/sudorules-with-ad-objects.html\">Include users and groups from a trusted Active Directory domain into SUDO rules\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.4. Granting sudo access to an IdM user on an IdM client using the IdM Web UI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn Identity Management (IdM), you can grant \u003Ccode class=\"literal\">sudo\u003C/code> access for a specific command to an IdM user account on a specific IdM host. First, add a \u003Ccode class=\"literal\">sudo\u003C/code> command and then create a \u003Ccode class=\"literal\">sudo\u003C/code> rule for one or more commands.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to create the \u003Ccode class=\"literal\">idm_user_reboot\u003C/code> sudo rule to grant the \u003Ccode class=\"literal\">idm_user\u003C/code> account the permission to run the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command on the \u003Ccode class=\"literal\">idmclient\u003C/code> machine.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a user account for \u003Ccode class=\"literal\">idm_user\u003C/code> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the command-line interface, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line\">Adding users using the command line\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo local \u003Ccode class=\"literal\">idm_user\u003C/code> account is present on the \u003Ccode class=\"literal\">idmclient\u003C/code> host. The \u003Ccode class=\"literal\">idm_user\u003C/code> user is not listed in the local \u003Ccode class=\"literal\">/etc/passwd\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command to the IdM database of \u003Ccode class=\"literal\">sudo\u003C/code> commands:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tNavigate to \u003Cspan class=\"strong strong\">\u003Cstrong>Policy\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo Commands\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> in the upper right corner to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add sudo command\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnter the command you want the user to be able to perform using \u003Ccode class=\"literal\">sudo\u003C/code>: \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"adding-IdM-sudo-command_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cp class=\"title\">\u003Cstrong>Figure 20.1. Adding IdM sudo command\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/9a1e57c1b7862f10d8e7fd8bc6392a7c/adding-IdM-sudo-command.png\" alt=\"A screenshot of a pop-up window labeled &quot;Add sudo command.&quot; There is a required field labeled &quot;Sudo command&quot; with contents &quot;/usr/sbin/reboot&quot;. A &quot;Description&quot; field is empty. The lower-right of the window has four buttons: &quot;Add&quot; - &quot;Add and Add Another&quot; - &quot;Add and Edit&quot; - &quot;Cancel&quot;.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the new \u003Ccode class=\"literal\">sudo\u003C/code> command entry to create a sudo rule to allow \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> to reboot the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> machine:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tNavigate to \u003Cspan class=\"strong strong\">\u003Cstrong>Policy\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo rules\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> in the upper right corner to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add sudo rule\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tEnter the name of the \u003Ccode class=\"literal\">sudo\u003C/code> rule: \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add and Edit\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Who\u003C/strong>\u003C/span> section, check the \u003Cspan class=\"strong strong\">\u003Cstrong>Specified Users and Groups\u003C/strong>\u003C/span> radio button.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>User category the rule applies to\u003C/strong>\u003C/span> subsection, click \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add users into sudo rule \"idm_user_reboot\"\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add users into sudo rule \"idm_user_reboot\"\u003C/strong>\u003C/span> dialog box in the \u003Cspan class=\"strong strong\">\u003Cstrong>Available\u003C/strong>\u003C/span> column, check the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> checkbox, and move it to the \u003Cspan class=\"strong strong\">\u003Cstrong>Prospective\u003C/strong>\u003C/span> column.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the host:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Access this host\u003C/strong>\u003C/span> section, check the \u003Cspan class=\"strong strong\">\u003Cstrong>Specified Hosts and Groups\u003C/strong>\u003C/span> radio button.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Host category this rule applies to\u003C/strong>\u003C/span> subsection, click \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add hosts into sudo rule \"idm_user_reboot\"\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add hosts into sudo rule \"idm_user_reboot\"\u003C/strong>\u003C/span> dialog box in the \u003Cspan class=\"strong strong\">\u003Cstrong>Available\u003C/strong>\u003C/span> column, check the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient.idm.example.com\u003C/strong>\u003C/span> checkbox, and move it to the \u003Cspan class=\"strong strong\">\u003Cstrong>Prospective\u003C/strong>\u003C/span> column.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the commands:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Command category the rule applies to\u003C/strong>\u003C/span> subsection of the \u003Cspan class=\"strong strong\">\u003Cstrong>Run Commands\u003C/strong>\u003C/span> section, check the \u003Cspan class=\"strong strong\">\u003Cstrong>Specified Commands and Groups\u003C/strong>\u003C/span> radio button.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo Allow Commands\u003C/strong>\u003C/span> subsection, click \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add allow sudo commands into sudo rule \"idm_user_reboot\"\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add allow sudo commands into sudo rule \"idm_user_reboot\"\u003C/strong>\u003C/span> dialog box in the \u003Cspan class=\"strong strong\">\u003Cstrong>Available\u003C/strong>\u003C/span> column, check the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> checkbox, and move it to the \u003Cspan class=\"strong strong\">\u003Cstrong>Prospective\u003C/strong>\u003C/span> column.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to return to the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_sudo_reboot\u003C/strong>\u003C/span> page.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"figure\" id=\"adding-IdM-sudo-rule_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cp class=\"title\">\u003Cstrong>Figure 20.2. Adding IdM sudo rule\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/3be5fa7d17bf8835989c8e9411a4c1c0/IdM-sudo-rule-WebUI.png\" alt=\"A screenshot of an overview of the sudo rule that was added. There is a &quot;Who&quot; section with a table of users the rule applies to. There is an &quot;Access this host&quot; section with a table of hosts that the rule applies to. There is a &quot;Run Commands&quot; section with a table of commands that pertain to the rule.\"/>\u003C/div>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Save\u003C/strong>\u003C/span> in the top left corner.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe new rule is enabled by default.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tPropagating the changes from the server to the client can take a few minutes.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in to \u003Ccode class=\"literal\">idmclient\u003C/code> as \u003Ccode class=\"literal\">idm_user\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReboot the machine using \u003Ccode class=\"literal\">sudo\u003C/code>. Enter the password for \u003Ccode class=\"literal\">idm_user\u003C/code> when prompted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo /usr/sbin/reboot\u003C/strong>\u003C/span>\n[sudo] password for idm_user:\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tIf the \u003Ccode class=\"literal\">sudo\u003C/code> rule is configured correctly, the machine reboots.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"proc_creating-a-sudo-rule-on-the-cli-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.5. Creating a sudo rule on the CLI that runs a command as a service account on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn IdM, you can configure a \u003Ccode class=\"literal\">sudo\u003C/code> rule with a \u003Cspan class=\"emphasis\">\u003Cem>RunAs alias\u003C/em>\u003C/span> to run a \u003Ccode class=\"literal\">sudo\u003C/code> command as another user or group. For example, you might have an IdM client that hosts a database application, and you need to run commands as the local service account that corresponds to that application.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUse this example to create a \u003Ccode class=\"literal\">sudo\u003C/code> rule on the command line called \u003Ccode class=\"literal\">run_third-party-app_report\u003C/code> to allow the \u003Ccode class=\"literal\">idm_user\u003C/code> account to run the \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code> command as the \u003Ccode class=\"literal\">thirdpartyapp\u003C/code> service account on the \u003Ccode class=\"literal\">idmclient\u003C/code> host.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a user account for \u003Ccode class=\"literal\">idm_user\u003C/code> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the CLI, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line\">Adding users using the command line\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo local \u003Ccode class=\"literal\">idm_user\u003C/code> account is present on the \u003Ccode class=\"literal\">idmclient\u003C/code> host. The \u003Ccode class=\"literal\">idm_user\u003C/code> user is not listed in the local \u003Ccode class=\"literal\">/etc/passwd\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have a custom application named \u003Ccode class=\"literal\">third-party-app\u003C/code> installed on the \u003Ccode class=\"literal\">idmclient\u003C/code> host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">report\u003C/code> command for the \u003Ccode class=\"literal\">third-party-app\u003C/code> application is installed in the \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a local service account named \u003Ccode class=\"literal\">thirdpartyapp\u003C/code> to execute commands for the \u003Ccode class=\"literal\">third-party-app\u003C/code> application.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRetrieve a Kerberos ticket as the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code> command to the IdM database of \u003Ccode class=\"literal\">sudo\u003C/code> commands:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudocmd-add /opt/third-party-app/bin/report\u003C/strong>\u003C/span>\n----------------------------------------------------\nAdded Sudo Command \"/opt/third-party-app/bin/report\"\n----------------------------------------------------\n  Sudo Command: /opt/third-party-app/bin/report\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">sudo\u003C/code> rule named \u003Ccode class=\"literal\">run_third-party-app_report\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add \u003Cspan class=\"emphasis\">\u003Cem>run_third-party-app_report\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n--------------------------------------------\nAdded Sudo Rule \"run_third-party-app_report\"\n--------------------------------------------\n  Rule name: run_third-party-app_report\n  Enabled: TRUE\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">--users=\u003Cspan class=\"emphasis\">\u003Cem>&lt;user&gt;\u003C/em>\u003C/span>\u003C/code> option to specify the RunAs user for the \u003Ccode class=\"literal\">sudorule-add-runasuser\u003C/code> command:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-runasuser \u003Cspan class=\"emphasis\">\u003Cem>run_third-party-app_report\u003C/em>\u003C/span> --users=\u003Cspan class=\"emphasis\">\u003Cem>thirdpartyapp\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n  Rule name: run_third-party-app_report\n  Enabled: TRUE\n  RunAs External User: thirdpartyapp\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe user (or group specified with the \u003Ccode class=\"literal\">--groups=*\u003C/code> option) can be external to IdM, such as a local service account or an Active Directory user. Do not add a \u003Ccode class=\"literal\">%\u003C/code> prefix for group names.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code> command to the \u003Ccode class=\"literal\">run_third-party-app_report\u003C/code> rule:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-allow-command run_third-party-app_report --sudocmds '/opt/third-party-app/bin/report'\u003C/strong>\u003C/span>\nRule name: run_third-party-app_report\nEnabled: TRUE\nSudo Allow Commands: /opt/third-party-app/bin/report\nRunAs External User: thirdpartyapp\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tApply the \u003Ccode class=\"literal\">run_third-party-app_report\u003C/code> rule to the IdM \u003Ccode class=\"literal\">idmclient\u003C/code> host:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-host run_third-party-app_report --hosts idmclient.idm.example.com\u003C/strong>\u003C/span>\nRule name: run_third-party-app_report\nEnabled: TRUE\nHosts: idmclient.idm.example.com\nSudo Allow Commands: /opt/third-party-app/bin/report\nRunAs External User: thirdpartyapp\n-------------------------\nNumber of members added 1\n-------------------------\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">idm_user\u003C/code> account to the \u003Ccode class=\"literal\">run_third-party-app_report\u003C/code> rule:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ipa sudorule-add-user run_third-party-app_report --users idm_user\u003C/strong>\u003C/span>\nRule name: run_third-party-app_report\nEnabled: TRUE\nUsers: idm_user\nHosts: idmclient.idm.example.com\nSudo Allow Commands: /opt/third-party-app/bin/report\nRunAs External User: thirdpartyapp\n-------------------------\nNumber of members added 1\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tPropagating the changes from the server to the client can take a few minutes.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in to the \u003Ccode class=\"literal\">idmclient\u003C/code> host as the \u003Ccode class=\"literal\">idm_user\u003C/code> account.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTest the new sudo rule:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay which \u003Ccode class=\"literal\">sudo\u003C/code> rules the \u003Ccode class=\"literal\">idm_user\u003C/code> account is allowed to perform.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -l\u003C/strong>\u003C/span>\nMatching Defaults entries for idm_user@idm.example.com on idmclient:\n    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,\n    env_reset, env_keep=\"COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS\",\n    env_keep+=\"MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\",\n    env_keep+=\"LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES\",\n    env_keep+=\"LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\",\n    env_keep+=\"LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME\",\n    secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\n\nUser idm_user@idm.example.com may run the following commands on idmclient:\n    \u003Cspan class=\"strong strong\">\u003Cstrong>(thirdpartyapp) /opt/third-party-app/bin/report\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">report\u003C/code> command as the \u003Ccode class=\"literal\">thirdpartyapp\u003C/code> service account.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -u \u003Cspan class=\"emphasis\">\u003Cem>thirdpartyapp\u003C/em>\u003C/span> /opt/third-party-app/bin/report\u003C/strong>\u003C/span>\n[sudo] password for idm_user@idm.example.com:\nExecuting report...\nReport successful.\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_creating-a-sudo-rule-in-the-idm-webui-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.6. Creating a sudo rule in the IdM WebUI that runs a command as a service account on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn IdM, you can configure a \u003Ccode class=\"literal\">sudo\u003C/code> rule with a \u003Cspan class=\"emphasis\">\u003Cem>RunAs alias\u003C/em>\u003C/span> to run a \u003Ccode class=\"literal\">sudo\u003C/code> command as another user or group. For example, you might have an IdM client that hosts a database application, and you need to run commands as the local service account that corresponds to that application.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUse this example to create a \u003Ccode class=\"literal\">sudo\u003C/code> rule in the IdM WebUI called \u003Ccode class=\"literal\">run_third-party-app_report\u003C/code> to allow the \u003Ccode class=\"literal\">idm_user\u003C/code> account to run the \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code> command as the \u003Ccode class=\"literal\">thirdpartyapp\u003C/code> service account on the \u003Ccode class=\"literal\">idmclient\u003C/code> host.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a user account for \u003Ccode class=\"literal\">idm_user\u003C/code> in IdM and unlocked the account by creating a password for the user. For details on adding a new IdM user using the CLI, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line\">Adding users using the command line\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo local \u003Ccode class=\"literal\">idm_user\u003C/code> account is present on the \u003Ccode class=\"literal\">idmclient\u003C/code> host. The \u003Ccode class=\"literal\">idm_user\u003C/code> user is not listed in the local \u003Ccode class=\"literal\">/etc/passwd\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have a custom application named \u003Ccode class=\"literal\">third-party-app\u003C/code> installed on the \u003Ccode class=\"literal\">idmclient\u003C/code> host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">report\u003C/code> command for the \u003Ccode class=\"literal\">third-party-app\u003C/code> application is installed in the \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a local service account named \u003Ccode class=\"literal\">thirdpartyapp\u003C/code> to execute commands for the \u003Ccode class=\"literal\">third-party-app\u003C/code> application.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code> command to the IdM database of \u003Ccode class=\"literal\">sudo\u003C/code> commands:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tNavigate to \u003Cspan class=\"strong strong\">\u003Cstrong>Policy\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo Commands\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> in the upper right corner to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add sudo command\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnter the command: \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/38569bcd46893efb28021dda70cb30dc/idm-sudo-rule-runas-command.png\" alt=\"A screenshot of a pop-up window labeled &quot;Add sudo command.&quot; There is a required field labeled &quot;Sudo command&quot; with contents &quot;/opt/third-party-app/bin/report&quot;. A &quot;Description&quot; field is empty. The lower-right of the window has four buttons: &quot;Add&quot; - &quot;Add and Add Another&quot; - &quot;Add and Edit&quot; - &quot;Cancel&quot;.\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the new \u003Ccode class=\"literal\">sudo\u003C/code> command entry to create the new \u003Ccode class=\"literal\">sudo\u003C/code> rule:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tNavigate to \u003Cspan class=\"strong strong\">\u003Cstrong>Policy\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo rules\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> in the upper right corner to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add sudo rule\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnter the name of the \u003Ccode class=\"literal\">sudo\u003C/code> rule: \u003Cspan class=\"strong strong\">\u003Cstrong>run_third-party-app_report\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/9851a7603c04519b9be8dc4303556240/idm-sudo-rule-runas-rule.png\" alt=\"A screenshot of a pop-up window labeled &quot;Add sudo rule.&quot; There is a required field labeled &quot;Rule name&quot; with contents &quot;run_third-party-app_report&quot;. The lower-right of the window has four buttons: &quot;Add&quot; - &quot;Add and Add Another&quot; - &quot;Add and Edit&quot; - &quot;Cancel&quot;.\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add and Edit\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Who\u003C/strong>\u003C/span> section, check the \u003Cspan class=\"strong strong\">\u003Cstrong>Specified Users and Groups\u003C/strong>\u003C/span> radio button.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>User category the rule applies to\u003C/strong>\u003C/span> subsection, click \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add users into sudo rule \"run_third-party-app_report\"\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add users into sudo rule \"run_third-party-app_report\"\u003C/strong>\u003C/span> dialog box in the \u003Cspan class=\"strong strong\">\u003Cstrong>Available\u003C/strong>\u003C/span> column, check the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> checkbox, and move it to the \u003Cspan class=\"strong strong\">\u003Cstrong>Prospective\u003C/strong>\u003C/span> column.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/27d4a17b3ecf6010c206a566a0b5d0f7/idm-sudo-rule-runas-user.png\" alt=\"A screenshot of a pop-up window labeled &quot;Add users into sudo rule.&quot; You can select users from an Available list on the left and move them to a Prospective column on the right. The lower-right of the window has two buttons: &quot;Add&quot; - &quot;Cancel&quot;.\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the host:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Access this host\u003C/strong>\u003C/span> section, check the \u003Cspan class=\"strong strong\">\u003Cstrong>Specified Hosts and Groups\u003C/strong>\u003C/span> radio button.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Host category this rule applies to\u003C/strong>\u003C/span> subsection, click \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add hosts into sudo rule \"run_third-party-app_report\"\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add hosts into sudo rule \"run_third-party-app_report\"\u003C/strong>\u003C/span> dialog box in the \u003Cspan class=\"strong strong\">\u003Cstrong>Available\u003C/strong>\u003C/span> column, check the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient.idm.example.com\u003C/strong>\u003C/span> checkbox, and move it to the \u003Cspan class=\"strong strong\">\u003Cstrong>Prospective\u003C/strong>\u003C/span> column.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/f00e257165b307caa6a17f528e1f7982/idm-sudo-rule-runas-host.png\" alt=\"A screenshot of a pop-up window labeled &quot;Add hosts into sudo rule.&quot; You can select hosts from an Available list on the left and move them to a Prospective column on the right. The lower-right of the window has two buttons: &quot;Add&quot; - &quot;Cancel&quot;.\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the commands:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Command category the rule applies to\u003C/strong>\u003C/span> subsection of the \u003Cspan class=\"strong strong\">\u003Cstrong>Run Commands\u003C/strong>\u003C/span> section, check the \u003Cspan class=\"strong strong\">\u003Cstrong>Specified Commands and Groups\u003C/strong>\u003C/span> radio button.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Sudo Allow Commands\u003C/strong>\u003C/span> subsection, click \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add allow sudo commands into sudo rule \"run_third-party-app_report\"\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add allow sudo commands into sudo rule \"run_third-party-app_report\"\u003C/strong>\u003C/span> dialog box in the \u003Cspan class=\"strong strong\">\u003Cstrong>Available\u003C/strong>\u003C/span> column, check the \u003Ccode class=\"literal\">/opt/third-party-app/bin/report\u003C/code> checkbox, and move it to the \u003Cspan class=\"strong strong\">\u003Cstrong>Prospective\u003C/strong>\u003C/span> column.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/2c36f0491d1c88cc71936d2a1eafb28d/idm-sudo-rule-runas-commandinrule.png\" alt=\"A screenshot of a pop-up window labeled &quot;Add allow sudo commands into sudo rule.&quot; You can select sudo commands from an Available list on the left and move them to a Prospective column on the right. The lower-right of the window has two buttons: &quot;Add&quot; - &quot;Cancel&quot;.\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to return to the \u003Cspan class=\"strong strong\">\u003Cstrong>run_third-party-app_report\u003C/strong>\u003C/span> page.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the RunAs user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>As Whom\u003C/strong>\u003C/span> section, check the \u003Cspan class=\"strong strong\">\u003Cstrong>Specified Users and Groups\u003C/strong>\u003C/span> radio button.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>RunAs Users\u003C/strong>\u003C/span> subsection, click \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to open the \u003Cspan class=\"strong strong\">\u003Cstrong>Add RunAs users into sudo rule \"run_third-party-app_report\"\u003C/strong>\u003C/span> dialog box.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Add RunAs users into sudo rule \"run_third-party-app_report\"\u003C/strong>\u003C/span> dialog box, enter the \u003Ccode class=\"literal\">thirdpartyapp\u003C/code> service account in the \u003Cspan class=\"strong strong\">\u003Cstrong>External\u003C/strong>\u003C/span> box and move it to the \u003Cspan class=\"strong strong\">\u003Cstrong>Prospective\u003C/strong>\u003C/span> column.\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/497802711769ecefebdacbb726cf8f9c/idm-sudo-rule-runas-runasuser.png\" alt=\"A screenshot of a dialog box where you can specify the &quot;thirdpartyapp&quot; service account as an external user.\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Add\u003C/strong>\u003C/span> to return to the \u003Cspan class=\"strong strong\">\u003Cstrong>run_third-party-app_report\u003C/strong>\u003C/span> page.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tClick \u003Cspan class=\"strong strong\">\u003Cstrong>Save\u003C/strong>\u003C/span> in the top left corner.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tThe new rule is enabled by default.\n\t\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"details-of-RunAs-sudo-rule_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cp class=\"title\">\u003Cstrong>Figure 20.3. Details of the sudo rule\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/fba1243a13c367506fa2a57e70f8bb25/idm-sudo-rule-runas-details.png\" alt=\"A screenshot of an overview of the sudo rule that was added. The &quot;Who&quot; section has an entry for &quot;idm_user.&quot; The &quot;Access this host&quot; section has &quot;idmclient.idm.example.com.&quot; The &quot;Run Commands&quot; section has the &quot;/opt/third-party-app/bin/report&quot; command. The &quot;As Whom&quot; section lists the &quot;thirdpartyapp&quot; account.\"/>\u003C/div>\u003C/div>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tPropagating the changes from the server to the client can take a few minutes.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in to the \u003Ccode class=\"literal\">idmclient\u003C/code> host as the \u003Ccode class=\"literal\">idm_user\u003C/code> account.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tTest the new sudo rule:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDisplay which \u003Ccode class=\"literal\">sudo\u003C/code> rules the \u003Ccode class=\"literal\">idm_user\u003C/code> account is allowed to perform.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -l\u003C/strong>\u003C/span>\nMatching Defaults entries for idm_user@idm.example.com on idmclient:\n    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,\n    env_reset, env_keep=\"COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS\",\n    env_keep+=\"MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\",\n    env_keep+=\"LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES\",\n    env_keep+=\"LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\",\n    env_keep+=\"LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME\",\n    secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\n\nUser idm_user@idm.example.com may run the following commands on idmclient:\n    \u003Cspan class=\"strong strong\">\u003Cstrong>(thirdpartyapp) /opt/third-party-app/bin/report\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRun the \u003Ccode class=\"literal\">report\u003C/code> command as the \u003Ccode class=\"literal\">thirdpartyapp\u003C/code> service account.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -u \u003Cspan class=\"emphasis\">\u003Cem>thirdpartyapp\u003C/em>\u003C/span> /opt/third-party-app/bin/report\u003C/strong>\u003C/span>\n[sudo] password for idm_user@idm.example.com:\nExecuting report...\nReport successful.\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_enabling-gssapi-authentication-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.7. Enabling GSSAPI authentication for sudo on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tEnable Generic Security Service Application Program Interface (GSSAPI) authentication on an IdM client for the \u003Ccode class=\"literal\">sudo\u003C/code> and \u003Ccode class=\"literal\">sudo -i\u003C/code> commands via the \u003Ccode class=\"literal\">pam_sss_gss.so\u003C/code> PAM module. With this configuration, IdM users can authenticate to the \u003Ccode class=\"literal\">sudo\u003C/code> command with their Kerberos ticket.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a \u003Ccode class=\"literal\">sudo\u003C/code> rule for an IdM user that applies to an IdM host. For this example, you have created the \u003Ccode class=\"literal\">idm_user_reboot\u003C/code> \u003Ccode class=\"literal\">sudo\u003C/code> rule to grant the \u003Ccode class=\"literal\">idm_user\u003C/code> account the permission to run the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command on the \u003Ccode class=\"literal\">idmclient\u003C/code> host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou need \u003Ccode class=\"literal\">root\u003C/code> privileges to modify the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file and PAM files in the \u003Ccode class=\"literal\">/etc/pam.d/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> configuration file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the following entry to the \u003Ccode class=\"literal\">[domain/\u003Cspan class=\"emphasis\">\u003Cem>&lt;domain_name&gt;\u003C/em>\u003C/span>]\u003C/code> section.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[domain/\u003Cspan class=\"emphasis\">\u003Cem>&lt;domain_name&gt;\u003C/em>\u003C/span>]\n\u003Cspan class=\"strong strong\">\u003Cstrong>pam_gssapi_services = sudo, sudo-i\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and close the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the SSSD service to load the configuration changes.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn RHEL 9.2 or later:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: Determine if you have selected the \u003Ccode class=\"literal\">sssd\u003C/code> \u003Ccode class=\"literal\">authselect\u003C/code> profile:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>authselect current\u003C/strong>\u003C/span>\nProfile ID: sssd\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the \u003Ccode class=\"literal\">sssd\u003C/code> \u003Ccode class=\"literal\">authselect\u003C/code> profile is selected, enable GSSAPI authentication:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>authselect enable-feature with-gssapi\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIf the \u003Ccode class=\"literal\">sssd\u003C/code> \u003Ccode class=\"literal\">authselect\u003C/code> profile is not selected, select it and enable GSSAPI authentication:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>authselect select sssd with-gssapi\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn RHEL 9.1 or earlier:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/pam.d/sudo\u003C/code> PAM configuration file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the following entry as the first line of the \u003Ccode class=\"literal\">auth\u003C/code> section in the \u003Ccode class=\"literal\">/etc/pam.d/sudo\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">#%PAM-1.0\n\u003Cspan class=\"strong strong\">\u003Cstrong>auth sufficient pam_sss_gss.so\u003C/strong>\u003C/span>\nauth       include      system-auth\naccount    include      system-auth\npassword   include      system-auth\nsession    include      system-auth\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave and close the \u003Ccode class=\"literal\">/etc/pam.d/sudo\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into the host as the \u003Ccode class=\"literal\">idm_user\u003C/code> account.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idm-client ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -l \u003Cspan class=\"emphasis\">\u003Cem>idm_user@idm.example.com\u003C/em>\u003C/span> localhost\u003C/strong>\u003C/span>\nidm_user@idm.example.com's password:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that you have a ticket-granting ticket as the \u003Ccode class=\"literal\">idm_user\u003C/code> account.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idmuser@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>klist\u003C/strong>\u003C/span>\nTicket cache: KCM:1366201107\nDefault principal: \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user@IDM.EXAMPLE.COM\u003C/strong>\u003C/span>\n\nValid starting       Expires              Service principal\n01/08/2021 09:11:48  01/08/2021 19:11:48  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\n\trenew until 01/15/2021 09:11:44\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If you do not have Kerberos credentials for the \u003Ccode class=\"literal\">idm_user\u003C/code> account, delete your current Kerberos credentials and request the correct ones.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>kdestroy -A\u003C/strong>\u003C/span>\n\n[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit idm_user@IDM.EXAMPLE.COM\u003C/strong>\u003C/span>\nPassword for \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user@idm.example.com\u003C/strong>\u003C/span>:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReboot the machine using \u003Ccode class=\"literal\">sudo\u003C/code>, without specifying a password.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo /usr/sbin/reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe GSSAPI entry in the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/overview-of-identity-management-and-access-control-planning-identity-management#IdM_terminology_overview-of-idm-and-access-control\">IdM terminology\u003C/a> listing\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\" title=\"20.4. Granting sudo access to an IdM user on an IdM client using the IdM Web UI\">Granting sudo access to an IdM user on an IdM client using IdM Web UI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\" title=\"20.2. Granting sudo access to an IdM user on an IdM client using the CLI\">Granting sudo access to an IdM user on an IdM client using the CLI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pam_sss_gss (8)\u003C/code> and \u003Ccode class=\"literal\">sssd.conf (5)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_enabling-gssapi-authentication-and-enforcing-kerberos-authentication-indicators-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.8. Enabling GSSAPI authentication and enforcing Kerberos authentication indicators for sudo on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tEnable Generic Security Service Application Program Interface (GSSAPI) authentication on an IdM client for the \u003Ccode class=\"literal\">sudo\u003C/code> and \u003Ccode class=\"literal\">sudo -i\u003C/code> commands via the \u003Ccode class=\"literal\">pam_sss_gss.so\u003C/code> PAM module. Additionally, only users who have logged in with a smart card will authenticate to those commands with their Kerberos ticket.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can use this procedure as a template to configure GSSAPI authentication with SSSD for other PAM-aware services, and further restrict access to only those users that have a specific authentication indicator attached to their Kerberos ticket.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a \u003Ccode class=\"literal\">sudo\u003C/code> rule for an IdM user that applies to an IdM host. For this example, you have created the \u003Ccode class=\"literal\">idm_user_reboot\u003C/code> \u003Ccode class=\"literal\">sudo\u003C/code> rule to grant the \u003Ccode class=\"literal\">idm_user\u003C/code> account the permission to run the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command on the \u003Ccode class=\"literal\">idmclient\u003C/code> host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have configured smart card authentication for the \u003Ccode class=\"literal\">idmclient\u003C/code> host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou need \u003Ccode class=\"literal\">root\u003C/code> privileges to modify the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file and PAM files in the \u003Ccode class=\"literal\">/etc/pam.d/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> configuration file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd the following entries to the \u003Ccode class=\"literal\">[domain/\u003Cspan class=\"emphasis\">\u003Cem>&lt;domain_name&gt;\u003C/em>\u003C/span>]\u003C/code> section.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[domain/\u003Cspan class=\"emphasis\">\u003Cem>&lt;domain_name&gt;\u003C/em>\u003C/span>]\n\u003Cspan class=\"strong strong\">\u003Cstrong>pam_gssapi_services = sudo, sudo-i\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>pam_gssapi_indicators_map = sudo:pkinit, sudo-i:pkinit\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and close the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRestart the SSSD service to load the configuration changes.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl restart sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn RHEL 9.2 or later:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDetermine if you have selected the \u003Ccode class=\"literal\">sssd\u003C/code> \u003Ccode class=\"literal\">authselect\u003C/code> profile:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>authselect current\u003C/strong>\u003C/span>\nProfile ID: sssd\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: Select the \u003Ccode class=\"literal\">sssd\u003C/code> \u003Ccode class=\"literal\">authselect\u003C/code> profile:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>authselect select sssd\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnable GSSAPI authentication:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>authselect enable-feature with-gssapi\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConfigure the system to authenticate only users with smart cards:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>authselect with-smartcard-required\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn RHEL 9.1 or earlier:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/pam.d/sudo\u003C/code> PAM configuration file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the following entry as the first line of the \u003Ccode class=\"literal\">auth\u003C/code> section in the \u003Ccode class=\"literal\">/etc/pam.d/sudo\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">#%PAM-1.0\n\u003Cspan class=\"strong strong\">\u003Cstrong>auth sufficient pam_sss_gss.so\u003C/strong>\u003C/span>\nauth       include      system-auth\naccount    include      system-auth\npassword   include      system-auth\nsession    include      system-auth\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave and close the \u003Ccode class=\"literal\">/etc/pam.d/sudo\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/etc/pam.d/sudo-i\u003C/code> PAM configuration file.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the following entry as the first line of the \u003Ccode class=\"literal\">auth\u003C/code> section in the \u003Ccode class=\"literal\">/etc/pam.d/sudo-i\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">#%PAM-1.0\n\u003Cspan class=\"strong strong\">\u003Cstrong>auth sufficient pam_sss_gss.so\u003C/strong>\u003C/span>\nauth       include      sudo\naccount    include      sudo\npassword   include      sudo\nsession    optional     pam_keyinit.so force revoke\nsession    include      sudo\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave and close the \u003Ccode class=\"literal\">/etc/pam.d/sudo-i\u003C/code> file.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog into the host as the \u003Ccode class=\"literal\">idm_user\u003C/code> account and authenticate with a smart card.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idmclient ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>ssh -l \u003Cspan class=\"emphasis\">\u003Cem>idm_user@idm.example.com\u003C/em>\u003C/span> localhost\u003C/strong>\u003C/span>\nPIN for smart_card\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that you have a ticket-granting ticket as the smart card user.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>klist\u003C/strong>\u003C/span>\nTicket cache: KEYRING:persistent:1358900015:krb_cache_TObtNMd\nDefault principal: \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user@IDM.EXAMPLE.COM\u003C/strong>\u003C/span>\n\nValid starting       Expires              Service principal\n02/15/2021 16:29:48  02/16/2021 02:29:48  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\n\trenew until 02/22/2021 16:29:44\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay which \u003Ccode class=\"literal\">sudo\u003C/code> rules the \u003Ccode class=\"literal\">idm_user\u003C/code> account is allowed to perform.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo -l\u003C/strong>\u003C/span>\nMatching Defaults entries for \u003Cspan class=\"strong strong\">\u003Cstrong>idmuser\u003C/strong>\u003C/span> on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span>:\n    !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin,\n    env_reset, env_keep=\"COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS\",\n    env_keep+=\"MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE\",\n    env_keep+=\"LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES\",\n    env_keep+=\"LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE\",\n    env_keep+=\"LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY KRB5CCNAME\",\n    secure_path=/sbin\\:/bin\\:/usr/sbin\\:/usr/bin\n\nUser \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> may run the following commands on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span>:\n    \u003Cspan class=\"strong strong\">\u003Cstrong>(root) /usr/sbin/reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReboot the machine using \u003Ccode class=\"literal\">sudo\u003C/code>, without specifying a password.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm_user@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo /usr/sbin/reboot\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/granting-sudo-access-to-an-idm-user-on-an-idm-client_using-ansible-to-install-and-manage-identity-management#ref_sssd-options-controlling-gssapi-authentication-for-pam-services_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">SSSD options controlling GSSAPI authentication for PAM services\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe GSSAPI entry in the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/planning_identity_management/overview-of-identity-management-and-access-control-planning-identity-management#IdM_terminology_overview-of-idm-and-access-control\">IdM terminology\u003C/a> listing\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_smart_card_authentication/configuring-idm-for-smart-card-auth_managing-smart-card-authentication\">Configuring Identity Management for smart card authentication\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-kerberos-ticket-policies_managing-users-groups-hosts#kerberos-authentication-indicators_managing-kerberos-ticket-policies\">Kerberos authentication indicators\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\" title=\"20.4. Granting sudo access to an IdM user on an IdM client using the IdM Web UI\">Granting sudo access to an IdM user on an IdM client using IdM Web UI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\" title=\"20.2. Granting sudo access to an IdM user on an IdM client using the CLI\">Granting sudo access to an IdM user on an IdM client using the CLI\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">pam_sss_gss (8)\u003C/code> and \u003Ccode class=\"literal\">sssd.conf (5)\u003C/code> man pages on your system\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ref_sssd-options-controlling-gssapi-authentication-for-pam-services_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.9. SSSD options controlling GSSAPI authentication for PAM services\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the following options for the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> configuration file to adjust the GSSAPI configuration within the SSSD service.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">pam_gssapi_services\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tGSSAPI authentication with SSSD is disabled by default. You can use this option to specify a comma-separated list of PAM services that are allowed to try GSSAPI authentication using the \u003Ccode class=\"literal\">pam_sss_gss.so\u003C/code> PAM module. To explicitly disable GSSAPI authentication, set this option to \u003Ccode class=\"literal\">-\u003C/code>.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">pam_gssapi_indicators_map\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis option only applies to Identity Management (IdM) domains. Use this option to list Kerberos authentication indicators that are required to grant PAM access to a service. Pairs must be in the format \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;PAM_service&gt;\u003C/em>\u003C/span>:_&lt;required_authentication_indicator&gt;_\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tValid authentication indicators are:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">otp\u003C/code> for two-factor authentication\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">radius\u003C/code> for RADIUS authentication\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">pkinit\u003C/code> for PKINIT, smart card, or certificate authentication\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">hardened\u003C/code> for hardened passwords\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">pam_gssapi_check_upn\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThis option is enabled and set to \u003Ccode class=\"literal\">true\u003C/code> by default. If this option is enabled, the SSSD service requires that the user name matches the Kerberos credentials. If \u003Ccode class=\"literal\">false\u003C/code>, the \u003Ccode class=\"literal\">pam_sss_gss.so\u003C/code> PAM module authenticates every user that is able to obtain the required service ticket.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Examples\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tThe following options enable Kerberos authentication for the \u003Ccode class=\"literal\">sudo\u003C/code> and \u003Ccode class=\"literal\">sudo-i\u003C/code> services, requires that \u003Ccode class=\"literal\">sudo\u003C/code> users authenticated with a one-time password, and user names must match the Kerberos principal. Because these settings are in the \u003Ccode class=\"literal\">[pam]\u003C/code> section, they apply to all domains:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cpre class=\"literallayout\">[pam]\n\u003Cspan class=\"strong strong\">\u003Cstrong>pam_gssapi_services\u003C/strong>\u003C/span> = \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>sudo\u003C/em>\u003C/span>, \u003Cspan class=\"emphasis\">\u003Cem>sudo-i\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>pam_gssapi_indicators_map\u003C/strong>\u003C/span> = \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>sudo:otp\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>pam_gssapi_check_upn\u003C/strong>\u003C/span> = \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>true\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003Cp>\n\t\t\t\tYou can also set these options in individual \u003Ccode class=\"literal\">[domain]\u003C/code> sections to overwrite any global values in the \u003Ccode class=\"literal\">[pam]\u003C/code> section. The following options apply different GSSAPI settings to each domain:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">For the \u003Ccode class=\"literal\">idm.example.com\u003C/code> domain\u003C/span>\u003C/dt>\u003Cdd>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tEnable GSSAPI authentication for the \u003Ccode class=\"literal\">sudo\u003C/code> and \u003Ccode class=\"literal\">sudo -i\u003C/code> services.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tRequire certificate or smart card authentication authenticators for the \u003Ccode class=\"literal\">sudo\u003C/code> command.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tRequire one-time password authentication authenticators for the \u003Ccode class=\"literal\">sudo -i\u003C/code> command.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tEnforce matching user names and Kerberos principals.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">For the \u003Ccode class=\"literal\">ad.example.com\u003C/code> domain\u003C/span>\u003C/dt>\u003Cdd>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tEnable GSSAPI authentication only for the \u003Ccode class=\"literal\">sudo\u003C/code> service.\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tDo not enforce matching user names and principals.\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003Cpre class=\"literallayout\">[domain/\u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>idm.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>]\npam_gssapi_services = \u003Cspan class=\"strong strong\">\u003Cstrong>sudo, sudo-i\u003C/strong>\u003C/span>\npam_gssapi_indicators_map = \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>sudo:pkinit\u003C/em>\u003C/span>\u003C/strong>\u003C/span>, \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>sudo-i:otp\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\npam_gssapi_check_upn = \u003Cspan class=\"strong strong\">\u003Cstrong>true\u003C/strong>\u003C/span>\n...\n\n[domain/\u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"emphasis\">\u003Cem>ad.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>]\npam_gssapi_services = \u003Cspan class=\"strong strong\">\u003Cstrong>sudo\u003C/strong>\u003C/span>\npam_gssapi_check_upn = \u003Cspan class=\"strong strong\">\u003Cstrong>false\u003C/strong>\u003C/span>\n...\u003C/pre>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-kerberos-ticket-policies_managing-users-groups-hosts#kerberos-authentication-indicators_managing-kerberos-ticket-policies\">Kerberos authentication indicators\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"proc_troubleshooting-gssapi-authentication-for-sudo_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.10. Troubleshooting GSSAPI authentication for sudo\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you are unable to authenticate to the \u003Ccode class=\"literal\">sudo\u003C/code> service with a Kerberos ticket from IdM, use the following scenarios to troubleshoot your configuration.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have enabled GSSAPI authentication for the \u003Ccode class=\"literal\">sudo\u003C/code> service. See \u003Ca class=\"link\" href=\"#proc_enabling-gssapi-authentication-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\" title=\"20.7. Enabling GSSAPI authentication for sudo on an IdM client\">Enabling GSSAPI authentication for sudo on an IdM client\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou need \u003Ccode class=\"literal\">root\u003C/code> privileges to modify the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file and PAM files in the \u003Ccode class=\"literal\">/etc/pam.d/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you see the following error, the Kerberos service might not able to resolve the correct realm for the service ticket based on the host name:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">Server not found in Kerberos database\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this situation, add the hostname directly to \u003Ccode class=\"literal\">[domain_realm]\u003C/code> section in the \u003Ccode class=\"literal\">/etc/krb5.conf\u003C/code> Kerberos configuration file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm-user@idm-client ~]$ cat /etc/krb5.conf\n...\n\n[domain_realm]\n .example.com = EXAMPLE.COM\n example.com = EXAMPLE.COM\n \u003Cspan class=\"strong strong\">\u003Cstrong>server.example.com = EXAMPLE.COM\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you see the following error, you do not have any Kerberos credentials:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">No Kerberos credentials available\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this situation, retrieve Kerberos credentials with the \u003Ccode class=\"literal\">kinit\u003C/code> utility or authenticate with SSSD:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm-user@idm-client ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit idm-user@IDM.EXAMPLE.COM\u003C/strong>\u003C/span>\nPassword for \u003Cspan class=\"strong strong\">\u003Cstrong>idm-user@idm.example.com\u003C/strong>\u003C/span>:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you see either of the following errors in the \u003Ccode class=\"literal\">/var/log/sssd/sssd_pam.log\u003C/code> log file, the Kerberos credentials do not match the username of the user currently logged in:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">User with UPN [\u003Cspan class=\"emphasis\">\u003Cem>&lt;UPN&gt;\u003C/em>\u003C/span>] was not found.\n\nUPN [\u003Cspan class=\"emphasis\">\u003Cem>&lt;UPN&gt;\u003C/em>\u003C/span>] does not match target user [\u003Cspan class=\"emphasis\">\u003Cem>&lt;username&gt;\u003C/em>\u003C/span>].\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn this situation, verify that you authenticated with SSSD, or consider disabling the \u003Ccode class=\"literal\">pam_gssapi_check_upn\u003C/code> option in the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm-user@idm-client ~]$ cat /etc/sssd/sssd.conf\n...\n\n\u003Cspan class=\"strong strong\">\u003Cstrong>pam_gssapi_check_upn = false\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor additional troubleshooting, you can enable debugging output for the \u003Ccode class=\"literal\">pam_sss_gss.so\u003C/code> PAM module.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">debug\u003C/code> option at the end of all \u003Ccode class=\"literal\">pam_sss_gss.so\u003C/code> entries in PAM files, such as \u003Ccode class=\"literal\">/etc/pam.d/sudo\u003C/code> and \u003Ccode class=\"literal\">/etc/pam.d/sudo-i\u003C/code>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@idm-client ~]# cat /etc/pam.d/sudo\n#%PAM-1.0\nauth       sufficient   pam_sss_gss.so   \u003Cspan class=\"strong strong\">\u003Cstrong>debug\u003C/strong>\u003C/span>\nauth       include      system-auth\naccount    include      system-auth\npassword   include      system-auth\nsession    include      system-auth\u003C/pre>\u003Cpre class=\"literallayout\">[root@idm-client ~]# cat /etc/pam.d/sudo-i\n#%PAM-1.0\nauth       sufficient   pam_sss_gss.so   \u003Cspan class=\"strong strong\">\u003Cstrong>debug\u003C/strong>\u003C/span>\nauth       include      sudo\naccount    include      sudo\npassword   include      sudo\nsession    optional     pam_keyinit.so force revoke\nsession    include      sudo\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tTry to authenticate with the \u003Ccode class=\"literal\">pam_sss_gss.so\u003C/code> module and review the console output. In this example, the user did not have any Kerberos credentials.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm-user@idm-client ~]$ sudo ls -l /etc/sssd/sssd.conf\npam_sss_gss: Initializing GSSAPI authentication with SSSD\npam_sss_gss: Switching euid from 0 to 1366201107\npam_sss_gss: Trying to establish security context\npam_sss_gss: SSSD User name: idm-user@idm.example.com\npam_sss_gss: User domain: idm.example.com\npam_sss_gss: User principal:\npam_sss_gss: Target name: host@idm.example.com\npam_sss_gss: Using ccache: KCM:\npam_sss_gss: Acquiring credentials, principal name will be derived\npam_sss_gss: Unable to read credentials from [KCM:] [maj:0xd0000, min:0x96c73ac3]\npam_sss_gss: GSSAPI: Unspecified GSS failure.  Minor code may provide more information\npam_sss_gss: \u003Cspan class=\"strong strong\">\u003Cstrong>GSSAPI: No credentials cache found\u003C/strong>\u003C/span>\npam_sss_gss: Switching euid from 1366200907 to 0\npam_sss_gss: \u003Cspan class=\"strong strong\">\u003Cstrong>System error [5]: Input/output error\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-an-Ansible-playbook-to-ensure-sudo-access-for-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">20.11. Using an Ansible playbook to ensure sudo access for an IdM user on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn Identity Management (IdM), you can ensure \u003Ccode class=\"literal\">sudo\u003C/code> access to a specific command is granted to an IdM user account on a specific IdM host.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to ensure a \u003Ccode class=\"literal\">sudo\u003C/code> rule named \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user_reboot\u003C/strong>\u003C/span> exists. The rule grants \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> the permission to run the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command on the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> machine.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks\" title=\"7.2. Ensuring the presence of an IdM user using an Ansible playbook\">ensured the presence of a user account for \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> in IdM and unlocked the account by creating a password for the user\u003C/a>. For details on adding a new IdM user using the command-line interface, see link: \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_idm_users_groups_hosts_and_access_control_rules/managing-user-accounts-using-the-command-line_managing-users-groups-hosts#adding-users-using-the-command-line_managing-idm-users-using-the-command-line\">Adding users using the command line\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo local \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> account exists on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span>. The \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> user is not listed in the \u003Ccode class=\"literal\">/etc/passwd\u003C/code> file on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaservers\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaservers]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd one or more \u003Ccode class=\"literal\">sudo\u003C/code> commands:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate an \u003Ccode class=\"literal\">ensure-reboot-sudocmd-is-present.yml\u003C/code> Ansible playbook that ensures the presence of the \u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code> command in the IdM database of \u003Ccode class=\"literal\">sudo\u003C/code> commands. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/sudocmd/ensure-sudocmd-is-present.yml\u003C/code> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage sudo command\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure sudo command is present\n  - ipasudocmd:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: /usr/sbin/reboot\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file path_to_playbooks_directory\u003C/em>\u003C/span>/ensure-reboot-sudocmd-is-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">sudo\u003C/code> rule that references the commands:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate an \u003Ccode class=\"literal\">ensure-sudorule-for-idmuser-on-idmclient-is-present.yml\u003C/code> Ansible playbook that uses the \u003Ccode class=\"literal\">sudo\u003C/code> command entry to ensure the presence of a sudo rule. The sudo rule allows \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> to reboot the \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> machine. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/sudorule/ensure-sudorule-is-present.yml\u003C/code> file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure a sudorule is present granting idm_user the permission to run /usr/sbin/reboot on idmclient\n  - ipasudorule:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: idm_user_reboot\n      description: A test sudo rule.\n      allow_sudocmd: /usr/sbin/reboot\n      host: idmclient.idm.example.com\n      user: idm_user\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file path_to_playbooks_directory\u003C/em>\u003C/span>/ensure-sudorule-for-idmuser-on-idmclient-is-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tTest that the \u003Ccode class=\"literal\">sudo\u003C/code> rule whose presence you have ensured on the IdM server works on \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> by verifying that \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> can reboot \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> using \u003Ccode class=\"literal\">sudo\u003C/code>. Note that it can take a few minutes for the changes made on the server to take effect on the client.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in to \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient\u003C/strong>\u003C/span> as \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReboot the machine using \u003Ccode class=\"literal\">sudo\u003C/code>. Enter the password for \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> when prompted:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo /usr/sbin/reboot\u003C/strong>\u003C/span>\n[sudo] password for idm_user:\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tIf \u003Ccode class=\"literal\">sudo\u003C/code> is configured correctly, the machine reboots.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-sudocmd.md\u003C/code>, \u003Ccode class=\"literal\">README-sudocmdgroup.md\u003C/code>, and \u003Ccode class=\"literal\">README-sudorule.md\u003C/code> files in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 21. Ensuring the presence of host-based access control rules in IdM using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAnsible is an automation tool used to configure systems, deploy software, and perform rolling updates. It includes support for Identity Management (IdM).\n\t\t\u003C/p>\u003Cp>\n\t\t\tLearn more about Identity Management (IdM) host-based access policies and how to define them using \u003Ca class=\"link\" href=\"https://docs.ansible.com\">Ansible\u003C/a>.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"host-based-access-control-rules-in-idm_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.1. Host-based access control rules in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tHost-based access control (HBAC) rules define which users or user groups can access which hosts or host groups by using which services or services in a service group. As a system administrator, you can use HBAC rules to achieve the following goals:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLimit access to a specified system in your domain to members of a specific user group.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAllow only a specific service to be used to access systems in your domain.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tBy default, IdM is configured with a default HBAC rule named \u003Cspan class=\"strong strong\">\u003Cstrong>allow_all\u003C/strong>\u003C/span>, which means universal access to every host for every user via every relevant service in the entire IdM domain.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can fine-tune access to different hosts by replacing the default \u003Cspan class=\"strong strong\">\u003Cstrong>allow_all\u003C/strong>\u003C/span> rule with your own set of HBAC rules. For centralized and simplified access control management, you can apply HBAC rules to user groups, host groups, or service groups instead of individual users, hosts, or services.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-hbac-rule-in-idm-using-an-ansible-playbook_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">21.2. Ensuring the presence of an HBAC rule in IdM using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the presence of a host-based access control (HBAC) rule in Identity Management (IdM) using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe users and user groups you want to use for your HBAC rule exist in IdM. See \u003Ca class=\"link\" href=\"#managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 7. Managing user accounts using Ansible playbooks\">Managing user accounts using Ansible playbooks\u003C/a> and \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks\" title=\"8.3. Ensuring the presence of IdM groups and group members using Ansible playbooks\">Ensuring the presence of IdM groups and group members using Ansible playbooks\u003C/a> for details.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe hosts and host groups to which you want to apply your HBAC rule exist in IdM. See \u003Ca class=\"link\" href=\"#managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 17. Managing hosts using Ansible playbooks\">Managing hosts using Ansible playbooks\u003C/a> and \u003Ca class=\"link\" href=\"#managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 18. Managing host groups using Ansible playbooks\">Managing host groups using Ansible playbooks\u003C/a> for details.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>, and define \u003Ccode class=\"literal\">ipaserver\u003C/code> in it:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file that defines the HBAC policy whose presence you want to ensure. To simplify this step, you can copy and modify the example in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/hbacrule/ensure-hbacrule-allhosts-present.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to handle hbacrules\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure idm_user can access client.idm.example.com via the sshd service\n  - ipahbacrule:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: login\n      user: idm_user\n      host: client.idm.example.com\n      hbacsvc:\n      - sshd\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory/ensure-new-hbacrule-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog in to the IdM Web UI as administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNavigate to \u003Cspan class=\"strong strong\">\u003Cstrong>Policy\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>Host-Based-Access-Control\u003C/strong>\u003C/span> → \u003Cspan class=\"strong strong\">\u003Cstrong>HBAC Test\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Who\u003C/strong>\u003C/span> tab, select idm_user.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Accessing\u003C/strong>\u003C/span> tab, select \u003Cspan class=\"strong strong\">\u003Cstrong>client.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Via service\u003C/strong>\u003C/span> tab, select \u003Cspan class=\"strong strong\">\u003Cstrong>sshd\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Rules\u003C/strong>\u003C/span> tab, select \u003Cspan class=\"strong strong\">\u003Cstrong>login\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn the \u003Cspan class=\"strong strong\">\u003Cstrong>Run test\u003C/strong>\u003C/span> tab, click the \u003Cspan class=\"strong strong\">\u003Cstrong>Run test\u003C/strong>\u003C/span> button. If you see ACCESS GRANTED, the HBAC rule is implemented successfully.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-hbacsvc.md\u003C/code>, \u003Ccode class=\"literal\">README-hbacsvcgroup.md\u003C/code>, and \u003Ccode class=\"literal\">README-hbacrule.md\u003C/code> files in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the playbooks in the subdirectories of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 22. Managing IdM certificates using Ansible\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to request, revoke, and retrieve SSL certificates for Identity Management (IdM) users, hosts and services. You can also restore a certificate that has been put on hold.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.1. Using Ansible to request SSL certificates for IdM hosts, services and users\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to request SSL certificates for Identity Management (IdM) users, hosts and services. They can then use these certificates to authenticate to IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to request a certificate for an HTTP server from an IdM certificate authority (CA) using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment has an integrated CA.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tGenerate a certificate-signing request (CSR) for your user, host or service. For example, to use the \u003Ccode class=\"literal\">openssl\u003C/code> utility to generate a CSR for the \u003Ccode class=\"literal\">HTTP\u003C/code> service running on client.idm.example.com, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>openssl req -new -newkey rsa:2048 -days 365 -nodes -keyout new.key -out new.csr -subj '/CN=client.idm.example.com,O=IDM.EXAMPLE.COM'\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAs a result, the CSR is stored in \u003Cspan class=\"strong strong\">\u003Cstrong>new.csr\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>request-certificate.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">---\n- name: Playbook to request a certificate\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Request a certificate for a web server\n    ipacert:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      state: requested\n      csr: |\n        -----BEGIN CERTIFICATE REQUEST-----\n        MIGYMEwCAQAwGTEXMBUGA1UEAwwOZnJlZWlwYSBydWxlcyEwKjAFBgMrZXADIQBs\n        HlqIr4b/XNK+K8QLJKIzfvuNK0buBhLz3LAzY7QDEqAAMAUGAytlcANBAF4oSCbA\n        5aIPukCidnZJdr491G4LBE+URecYXsPknwYb+V+ONnf5ycZHyaFv+jkUBFGFeDgU\n        SYaXm/gF8cDYjQI=\n        -----END CERTIFICATE REQUEST-----\n      principal: HTTP/client.idm.example.com\n    register: cert\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReplace the certificate request with the CSR from \u003Cspan class=\"strong strong\">\u003Cstrong>new.csr\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRequest the certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/request-certificate.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md\">The cert module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.2. Using Ansible to revoke SSL certificates for IdM hosts, services and users\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to revoke SSL certificates used by Identity Management (IdM) users, hosts and services to authenticate to IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to revoke a certificate for an HTTP server using an Ansible playbook. The reason for revoking the certificate is “keyCompromise”.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have obtained the serial number of the certificate, for example by entering the \u003Ccode class=\"literal\">openssl x509 -noout -text -in &lt;path_to_certificate&gt;\u003C/code> command. In this example, the serial number of the certificate is 123456789.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment has an integrated CA.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>revoke-certificate.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">---\n- name: Playbook to revoke a certificate\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Revoke a certificate for a web server\n    ipacert:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      serial_number: 123456789\n      revocation_reason: \"keyCompromise\"\n      state: revoked\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRevoke the certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/revoke-certificate.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md\">The cert module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://datatracker.ietf.org/doc/html/rfc5280#section-5.3.1\">Reason Code\u003C/a> in RFC 5280\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.3. Using Ansible to restore SSL certificates for IdM users, hosts, and services\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to restore a revoked SSL certificate previously used by an Identity Management (IdM) user, host or a service to authenticate to IdM.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can only restore a certificate that was put on hold. You may have put it on hold because, for example, you were not sure if the private key had been lost. However, now you have recovered the key and as you are certain that no-one has accessed it in the meantime, you want to reinstate the certificate.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tComplete this procedure to use an Ansible playbook to release a certificate for a service enrolled into IdM from hold. This example describes how to release a certificate for an HTTP service from hold.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM deployment has an integrated CA.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have obtained the serial number of the certificate, for example by entering the \u003Ccode class=\"literal\">openssl x509 -noout -text -in path/to/certificate\u003C/code> command. In this example, the certificate serial number is \u003Cspan class=\"strong strong\">\u003Cstrong>123456789\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>restore-certificate.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to restore a certificate\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Restore a certificate for a web service\n    ipacert:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>serial_number: 123456789\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: released\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/restore-certificate.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md\">The cert module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">22.4. Using Ansible to retrieve SSL certificates for IdM users, hosts, and services\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipacert\u003C/code> module to retrieve an SSL certificate issued for an Identity Management (IdM) user, host or a service, and store it in a file on the managed node.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have obtained the serial number of the certificate, for example by entering the \u003Ccode class=\"literal\">openssl x509 -noout -text -in &lt;path_to_certificate&gt;\u003C/code> command. In this example, the serial number of the certificate is 123456789, and the file in which you store the retrieved certificate is \u003Cspan class=\"strong strong\">\u003Cstrong>cert.pem\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>retrieve-certificate.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to retrieve a certificate and store it locally on the managed node\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Retrieve a certificate and save it to file 'cert.pem'\n    ipacert:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      serial_number: 123456789\n      certificate_out: cert.pem\n      state: retrieved\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRetrieve the certificate:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i &lt;path_to_inventory_directory&gt;/hosts &lt;path_to_playbooks_directory&gt;/retrieve-certificate.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-cert.md\">The cert module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"vaults-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 23. Vaults in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThis chapter describes vaults in Identity Management (IdM). It introduces the following topics:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#vaults-and-their-benefits_vaults-in-idm\" title=\"23.1. Vaults and their benefits\">The concept of the vault\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#vault-owners-members-and-administrators_vaults-in-idm\" title=\"23.2. Vault owners, members, and administrators\">The different roles associated with a vault\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#standard-symmetric-and-asymmetric-vaults_vaults-in-idm\" title=\"23.3. Standard, symmetric, and asymmetric vaults\">The different types of vaults available in IdM based on the level of security and access control\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#user-service-and-shared-vaults_vaults-in-idm\" title=\"23.4. User, service, and shared vaults\">The different types of vaults available in IdM based on ownership\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#vault-containers_vaults-in-idm\" title=\"23.5. Vault containers\">The concept of vault containers\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#basic-idm-vault-commands_vaults-in-idm\" title=\"23.6. Basic IdM vault commands\">The basic commands for managing vaults in IdM\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm\" title=\"23.7. Installing the Key Recovery Authority in IdM\">Installing the key recovery authority (KRA), which is a prerequisite for using vaults in IdM\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"vaults-and-their-benefits_vaults-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.1. Vaults and their benefits\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA vault is a useful feature for those Identity Management (IdM) users who want to keep all their sensitive data stored securely but conveniently in one place. There are various types of vaults and you should choose which vault to use based on your requirements.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tA vault is a secure location in (IdM) for storing, retrieving, sharing, and recovering a secret. A secret is security-sensitive data, usually authentication credentials, that only a limited group of people or entities can access. For example, secrets include:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPasswords\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPINs\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPrivate SSH keys\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tA vault is comparable to a password manager. Just like a password manager, a vault typically requires a user to generate and remember one primary password to unlock and access any information stored in the vault. However, a user can also decide to have a standard vault. A standard vault does not require the user to enter any password to access the secrets stored in the vault.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThe purpose of vaults in IdM is to store authentication credentials that allow you to authenticate to external, non-IdM-related services.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t\tOther important characteristics of the IdM vaults are:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tVaults are only accessible to the vault owner and those IdM users that the vault owner selects to be the vault members. In addition, the IdM administrator has access to the vault.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf a user does not have sufficient privileges to create a vault, an IdM administrator can create the vault and set the user as its owner.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUsers and services can access the secrets stored in a vault from any machine enrolled in the IdM domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOne vault can only contain one secret, for example, one file. However, the file itself can contain multiple secrets such as passwords, keytabs or certificates.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tVault is only available from the IdM command line (CLI), not from the IdM Web UI.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"vault-owners-members-and-administrators_vaults-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.2. Vault owners, members, and administrators\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdentity Management (IdM) distinguishes the following vault user types:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Vault owner\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tA vault owner is a user or service with basic management privileges on the vault. For example, a vault owner can modify the properties of the vault or add new vault members.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tEach vault must have at least one owner. A vault can also have multiple owners.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Vault member\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tA vault member is a user or service that can access a vault created by another user or service.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Vault administrator\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tVault administrators have unrestricted access to all vaults and are allowed to perform all vault operations.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tSymmetric and asymmetric vaults are protected with a password or key and apply special access control rules (see \u003Ca class=\"link\" href=\"#standard-symmetric-and-asymmetric-vaults_vaults-in-idm\" title=\"23.3. Standard, symmetric, and asymmetric vaults\">Vault types\u003C/a>). The administrator must meet these rules to:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAccess secrets in symmetric and asymmetric vaults.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange or reset the vault password or key.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tA vault administrator is any user with the \u003Ccode class=\"literal\">Vault Administrators\u003C/code> privilege. In the context of the role-based access control (RBAC) in IdM, a privilege is a group of permissions that you can apply to a role.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Vault User\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe vault user represents the user in whose container the vault is located. The \u003Ccode class=\"literal\">Vault user\u003C/code> information is displayed in the output of specific commands, such as \u003Ccode class=\"literal command\">ipa vault-show\u003C/code>:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ipa vault-show my_vault\n  Vault name: my_vault\n  Type: standard\n  Owner users: user\n  \u003Cspan class=\"emphasis\">\u003Cem>Vault user: user\u003C/em>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor details on vault containers and user vaults, see \u003Ca class=\"link\" href=\"#vault-containers_vaults-in-idm\" title=\"23.5. Vault containers\">Vault containers\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#standard-symmetric-and-asymmetric-vaults_vaults-in-idm\" title=\"23.3. Standard, symmetric, and asymmetric vaults\">Standard, symmetric and asymmetric vaults\u003C/a> for details on vault types.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"standard-symmetric-and-asymmetric-vaults_vaults-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.3. Standard, symmetric, and asymmetric vaults\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBased on the level of security and access control, IdM classifies vaults into the following types:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Standard vaults\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tVault owners and vault members can archive and retrieve the secrets without having to use a password or key.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Symmetric vaults\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSecrets in the vault are protected with a symmetric key. Vault owners and members can archive and retrieve the secrets, but they must provide the vault password.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Asymmetric vaults\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tSecrets in the vault are protected with an asymmetric key. Users archive the secret using a public key and retrieve it using a private key. Vault members can only archive secrets, while vault owners can do both, archive and retrieve secrets.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"user-service-and-shared-vaults_vaults-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.4. User, service, and shared vaults\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tBased on ownership, IdM classifies vaults into several types. The \u003Ca class=\"link\" href=\"#tab-idm-vaults-based-on-ownership_vaults-in-idm\" title=\"Table 23.1. IdM vaults based on ownership\">table below\u003C/a> contains information about each type, its owner and use.\n\t\t\t\u003C/p>\u003Crh-table id=\"tab-idm-vaults-based-on-ownership_vaults-in-idm\">\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccaption>Table 23.1. IdM vaults based on ownership\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 13%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 38%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464215843296\" scope=\"col\">Type\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464215842208\" scope=\"col\">Description\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464215841120\" scope=\"col\">Owner\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464212775632\" scope=\"col\">Note\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215843296\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>User vault\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215842208\"> \u003Cp>\n\t\t\t\t\t\t\t\tA private vault for a user\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215841120\"> \u003Cp>\n\t\t\t\t\t\t\t\tA single user\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212775632\"> \u003Cp>\n\t\t\t\t\t\t\t\tAny user can own one or more user vaults if allowed by IdM administrator\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215843296\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Service vault\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215842208\"> \u003Cp>\n\t\t\t\t\t\t\t\tA private vault for a service\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215841120\"> \u003Cp>\n\t\t\t\t\t\t\t\tA single service\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212775632\"> \u003Cp>\n\t\t\t\t\t\t\t\tAny service can own one or more user vaults if allowed by IdM administrator\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215843296\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>Shared vault\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215842208\"> \u003Cp>\n\t\t\t\t\t\t\t\tA vault shared by multiple users and services\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215841120\"> \u003Cp>\n\t\t\t\t\t\t\t\tThe vault administrator who created the vault\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212775632\"> \u003Cp>\n\t\t\t\t\t\t\t\tUsers and services can own one or more user vaults if allowed by IdM administrator. The vault administrators other than the one that created the vault also have full access to the vault.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"vault-containers_vaults-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.5. Vault containers\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA vault container is a collection of vaults. The \u003Ca class=\"link\" href=\"#tab-default-vault-containers-in-idm_vaults-in-idm\" title=\"Table 23.2. Default vault containers in IdM\">table below\u003C/a> lists the default vault containers that Identity Management (IdM) provides.\n\t\t\t\u003C/p>\u003Crh-table id=\"tab-default-vault-containers-in-idm_vaults-in-idm\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 23.2. Default vault containers in IdM\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 25%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 25%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464212740672\" scope=\"col\">Type\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464212739584\" scope=\"col\">Description\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464212738496\" scope=\"col\">Purpose\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212740672\"> \u003Cp>\n\t\t\t\t\t\t\t\tUser container\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212739584\"> \u003Cp>\n\t\t\t\t\t\t\t\tA private container for a user\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212738496\"> \u003Cp>\n\t\t\t\t\t\t\t\tStores user vaults for a particular user\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212740672\"> \u003Cp>\n\t\t\t\t\t\t\t\tService container\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212739584\"> \u003Cp>\n\t\t\t\t\t\t\t\tA private container for a service\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212738496\"> \u003Cp>\n\t\t\t\t\t\t\t\tStores service vaults for a particular service\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212740672\"> \u003Cp>\n\t\t\t\t\t\t\t\tShared container\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212739584\"> \u003Cp>\n\t\t\t\t\t\t\t\tA container for multiple users and services\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464212738496\"> \u003Cp>\n\t\t\t\t\t\t\t\tStores vaults that can be shared by multiple users or services\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cp>\n\t\t\t\tIdM creates user and service containers for each user or service automatically when the first private vault for the user or service is created. After the user or service is deleted, IdM removes the container and its contents.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"basic-idm-vault-commands_vaults-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.6. Basic IdM vault commands\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the basic commands outlined below to manage Identity Management (IdM) vaults. The \u003Ca class=\"link\" href=\"#tab-basic-idm-vault-commands-with-explanations_vaults-in-idm\" title=\"Table 23.3. Basic IdM vault commands with explanations\">table below\u003C/a> contains a list of \u003Ccode class=\"literal\">ipa vault-*\u003C/code> commands with the explanation of their purpose.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tBefore running any \u003Ccode class=\"literal\">ipa vault-*\u003C/code> command, install the Key Recovery Authority (KRA) certificate system component on one or more of the servers in your IdM domain. For details, see \u003Ca class=\"link\" href=\"#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm\" title=\"23.7. Installing the Key Recovery Authority in IdM\">Installing the Key Recovery Authority in IdM\u003C/a>.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-table id=\"tab-basic-idm-vault-commands-with-explanations_vaults-in-idm\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 23.3. Basic IdM vault commands with explanations\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 25%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 75%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464215079680\" scope=\"col\">Command\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464215078592\" scope=\"col\">Purpose\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215079680\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa help vault\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215078592\"> \u003Cp>\n\t\t\t\t\t\t\t\tDisplays conceptual information about IdM vaults and sample vault commands.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215079680\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa vault-add --help\u003C/code>, \u003Ccode class=\"literal\">ipa vault-find --help\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215078592\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdding the \u003Ccode class=\"literal\">--help\u003C/code> option to a specific \u003Ccode class=\"literal\">ipa vault-*\u003C/code> command displays the options and detailed help available for that command.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215079680\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa vault-show user_vault --user idm_user\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215078592\"> \u003Cp>\n\t\t\t\t\t\t\t\tWhen accessing a vault as a vault member, you must specify the vault owner. If you do not specify the vault owner, IdM informs you that it did not find the vault:\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \n\u003Cpre class=\"literallayout\">[admin@server ~]$ ipa vault-show user_vault\nipa: ERROR: user_vault: vault not found\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215079680\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa vault-show shared_vault --shared\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464215078592\"> \u003Cp>\n\t\t\t\t\t\t\t\tWhen accessing a shared vault, you must specify that the vault you want to access is a shared vault. Otherwise, IdM informs you it did not find the vault:\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \n\u003Cpre class=\"literallayout\">[admin@server ~]$ ipa vault-show shared_vault\nipa: ERROR: shared_vault: vault not found\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"installing-the-key-recovery-authority-component-in-idm_vaults-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">23.7. Installing the Key Recovery Authority in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to enable vaults in Identity Management (IdM) by installing the Key Recovery Authority (KRA) Certificate System (CS) component on a specific IdM server.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as \u003Ccode class=\"literal\">root\u003C/code> on the IdM server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn IdM certificate authority is installed on the IdM server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the \u003Ccode class=\"literal\">Directory Manager\u003C/code> credentials.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tInstall the KRA:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-kra-install\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou can install the first KRA of an IdM cluster on a hidden replica. However, installing additional KRAs requires temporarily activating the hidden replica before you install the KRA clone on a non-hidden replica. Then you can hide the originally hidden replica again.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tTo make the vault service highly available and resilient, install the KRA on two IdM servers or more. Maintaining multiple KRA servers prevents data loss.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/demoting-or-promoting-hidden-replicas_configuring-and-managing-idm\">Demoting or promoting hidden replicas\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/planning_identity_management/planning-the-replica-topology_planning-identity-management#the-hidden-replica-mode_planning-the-replica-topology\">The hidden replica mode\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 24. Using Ansible to manage IdM user vaults: storing and retrieving secrets\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThis chapter describes how to manage user vaults in Identity Management using the Ansible \u003Ccode class=\"literal\">vault\u003C/code> module. Specifically, it describes how a user can use Ansible playbooks to perform the following three consecutive actions:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets\" title=\"24.1. Ensuring the presence of a standard user vault in IdM using Ansible\">Create a user vault in IdM\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#archiving-a-secret-in-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets\" title=\"24.2. Archiving a secret in a standard user vault in IdM using Ansible\">Store a secret in the vault\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#retrieving-a-secret-from-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets\" title=\"24.3. Retrieving a secret from a standard user vault in IdM using Ansible\">Retrieve a secret from the vault\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tThe user can do the storing and the retrieving from two different IdM clients.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe Key Recovery Authority (KRA) Certificate System component has been installed on one or more of the servers in your IdM domain. For details, see \u003Ca class=\"link\" href=\"#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm\" title=\"23.7. Installing the Key Recovery Authority in IdM\">Installing the Key Recovery Authority in IdM\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.1. Ensuring the presence of a standard user vault in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to create a vault container with one or more private vaults to securely store sensitive information. In the example used in the procedure below, the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> user creates a vault of the standard type named \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>. The standard vault type ensures that \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> will not be required to authenticate when accessing the file. \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> will be able to retrieve the file from any IdM client to which the user is logged in.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">ansible-freeipa\u003C/a> package on the Ansible controller, that is the host on which you execute the steps in the procedure.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the password of \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/vault\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Cspan class=\"strong strong\">\u003Cstrong>inventory.file\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen \u003Cspan class=\"strong strong\">\u003Cstrong>inventory.file\u003C/strong>\u003C/span> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-standard-vault-is-present.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp ensure-standard-vault-is-present.yml ensure-standard-vault-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-standard-vault-is-present-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_principal\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">user\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">vault_type\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>standard\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - ipavault:\n      ipaadmin_principal: \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span>\n      ipaadmin_password: \u003Cspan class=\"emphasis\">\u003Cem>idm_user_password\u003C/em>\u003C/span>\n      user: \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span>\n      name: \u003Cspan class=\"emphasis\">\u003Cem>my_vault\u003C/em>\u003C/span>\n      vault_type: standard\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-standard-vault-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"archiving-a-secret-in-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.2. Archiving a secret in a standard user vault in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to store sensitive information in a personal vault. In the example used, the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> user archives a file with sensitive information named \u003Cspan class=\"strong strong\">\u003Cstrong>password.txt\u003C/strong>\u003C/span> in a vault named \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">ansible-freeipa\u003C/a> package on the Ansible controller, that is the host on which you execute the steps in the procedure.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the password of \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> is the owner, or at least a member user of \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have access to \u003Cspan class=\"strong strong\">\u003Cstrong>password.txt\u003C/strong>\u003C/span>, the secret that you want to archive in \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/vault\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>data-archive-in-symmetric-vault.yml\u003C/strong>\u003C/span> Ansible playbook file but replace \"symmetric\" by \"standard\". For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp data-archive-in-symmetric-vault.yml data-archive-in-standard-vault-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>data-archive-in-standard-vault-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_principal\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">user\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">in\u003C/code> variable to the full path to the file with sensitive information.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>member\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - ipavault:\n      ipaadmin_principal: \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span>\n      ipaadmin_password: \u003Cspan class=\"emphasis\">\u003Cem>idm_user_password\u003C/em>\u003C/span>\n      user: \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span>\n      name: \u003Cspan class=\"emphasis\">\u003Cem>my_vault\u003C/em>\u003C/span>\n      in: \u003Cspan class=\"emphasis\">\u003Cem>/usr/share/doc/ansible-freeipa/playbooks/vault/password.txt\u003C/em>\u003C/span>\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file data-archive-in-standard-vault-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"retrieving-a-secret-from-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">24.3. Retrieving a secret from a standard user vault in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to retrieve a secret from the user personal vault. In the example used in the procedure below, the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> user retrieves a file with sensitive data from a vault of the standard type named \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span> onto an IdM client named \u003Cspan class=\"strong strong\">\u003Cstrong>host01\u003C/strong>\u003C/span>. \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> does not have to authenticate when accessing the file. \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> can use Ansible to retrieve the file from any IdM client on which Ansible is installed.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the password of \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> is the owner of \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> has stored a secret in \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAnsible can write into the directory on the IdM host into which you want to retrieve the secret.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> can read from the directory on the IdM host into which you want to retrieve the secret.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/vault\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and mention, in a clearly defined section, the IdM client onto which you want to retrieve the secret. For example, to instruct Ansible to retrieve the secret onto \u003Cspan class=\"strong strong\">\u003Cstrong>host01.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipahost]\nhost01.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>retrive-data-symmetric-vault.yml\u003C/strong>\u003C/span> Ansible playbook file. Replace \"symmetric\" with \"standard\". For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp retrive-data-symmetric-vault.yml retrieve-data-standard-vault.yml-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>retrieve-data-standard-vault.yml-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdapt the file by setting the \u003Ccode class=\"literal\">hosts\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>ipahost\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_principal\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">user\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>my_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">out\u003C/code> variable to the full path of the file into which you want to export the secret.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>retrieved\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipahost\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - ipavault:\n      ipaadmin_principal: \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span>\n      ipaadmin_password: \u003Cspan class=\"emphasis\">\u003Cem>idm_user_password\u003C/em>\u003C/span>\n      user: \u003Cspan class=\"emphasis\">\u003Cem>idm_user\u003C/em>\u003C/span>\n      name: \u003Cspan class=\"emphasis\">\u003Cem>my_vault\u003C/em>\u003C/span>\n      out: \u003Cspan class=\"emphasis\">\u003Cem>/tmp/password_exported.txt\u003C/em>\u003C/span>\n      state: retrieved\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file retrieve-data-standard-vault.yml-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">SSH\u003C/code> to \u003Cspan class=\"strong strong\">\u003Cstrong>host01\u003C/strong>\u003C/span> as \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh user01@host01.idm.example.com\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tView the file specified by the \u003Ccode class=\"literal\">out\u003C/code> variable in the Ansible playbook file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ vim /tmp/password_exported.txt\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou can now see the exported secret.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more information about using Ansible to manage IdM vaults and user secrets and about playbook variables, see the README-vault.md Markdown file available in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory and the sample playbooks available in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 25. Using Ansible to manage IdM service vaults: storing and retrieving secrets\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThis section shows how an administrator can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">vault\u003C/code> module to securely store a service secret in a centralized location. The \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/using_ansible_to_install_and_manage_identity_management/index#vaults-in-idm_using-ansible-to-install-and-manage-identity-management\">vault\u003C/a> used in the example is asymmetric, which means that to use it, the administrator needs to perform the following steps:\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\tGenerate a private key using, for example, the \u003Ccode class=\"literal\">openssl\u003C/code> utility.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tGenerate a public key based on the private key.\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\tThe service secret is encrypted with the public key when an administrator archives it into the vault. Afterwards, a service instance hosted on a specific machine in the domain retrieves the secret using the private key. Only the service and the administrator are allowed to access the secret.\n\t\t\u003C/p>\u003Cp>\n\t\t\tIf the secret is compromised, the administrator can replace it in the service vault and then redistribute it to those individual service instances that have not been compromised.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe Key Recovery Authority (KRA) Certificate System component has been installed on one or more of the servers in your IdM domain. For details, see \u003Ca class=\"link\" href=\"#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm\" title=\"23.7. Installing the Key Recovery Authority in IdM\">Installing the Key Recovery Authority in IdM\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tThis section includes these procedures:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible\">Ensuring the presence of an asymmetric service vault in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.3. Storing an IdM service secret in an asymmetric vault using Ansible\">Storing an IdM service secret in an asymmetric vault using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.4. Retrieving a service secret for an IdM service using Ansible\">Retrieving a service secret for an IdM service using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#changing-an-idm-service-vault-secret-when-compromised-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.5. Changing an IdM service vault secret when compromised using Ansible\">Changing an IdM service vault secret when compromised using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tIn the procedures:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>admin\u003C/strong>\u003C/span> is the administrator who manages the service password.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>private-key-to-an-externally-signed-certificate.pem\u003C/strong>\u003C/span> is the file containing the service secret, in this case a private key to an externally signed certificate. Do not confuse this private key with the private key used to retrieve the secret from the vault.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span> is the vault created to store the service secret.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver1.idm.example.com\u003C/strong>\u003C/span> is the service that is the owner of the vault.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver2.idm.example.com\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver3.idm.example.com\u003C/strong>\u003C/span> are the vault member services.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>service-public.pem\u003C/strong>\u003C/span> is the service public key used to encrypt the password stored in \u003Cspan class=\"strong strong\">\u003Cstrong>password_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>service-private.pem\u003C/strong>\u003C/span> is the service private key used to decrypt the password stored in \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to create a service vault container with one or more private vaults to securely store sensitive information. In the example used in the procedure below, the administrator creates an asymmetric vault named \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>. This ensures that the vault members have to authenticate using a private key to retrieve the secret in the vault. The vault members will be able to retrieve the file from any IdM client.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the \u003Cspan class=\"strong strong\">\u003Cstrong>IdM administrator\u003C/strong>\u003C/span> password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/vault\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tObtain the public key of the service instance. For example, using the \u003Ccode class=\"literal\">openssl\u003C/code> utility:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tGenerate the \u003Ccode class=\"literal\">service-private.pem\u003C/code> private key.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl genrsa -out service-private.pem 2048\u003C/strong>\u003C/span>\nGenerating RSA private key, 2048 bit long modulus\n.+++\n...........................................+++\ne is 65537 (0x10001)\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tGenerate the \u003Ccode class=\"literal\">service-public.pem\u003C/code> public key based on the private key.\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl rsa -in service-private.pem -out service-public.pem -pubout\u003C/strong>\u003C/span>\nwriting RSA key\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Create an inventory file if it does not exist, for example \u003Cspan class=\"strong strong\">\u003Cstrong>inventory.file\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-asymmetric-vault-is-present.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp ensure-asymmetric-vault-is-present.yml ensure-asymmetric-service-vault-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-asymmetric-vault-is-present-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAdd a task that copies the \u003Cspan class=\"strong strong\">\u003Cstrong>service-public.pem\u003C/strong>\u003C/span> public key from the Ansible controller to the \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span> server.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tModify the rest of the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tDefine the name of the vault using the \u003Ccode class=\"literal\">name\u003C/code> variable, for example \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">vault_type\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>asymmetric\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">service\u003C/code> variable to the principal of the service that owns the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver1.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">public_key_file\u003C/code> to the location of your public key.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n  gather_facts: false\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Copy public key to ipaserver.\n    copy:\n      src: /path/to/service-public.pem\n      dest: /usr/share/doc/ansible-freeipa/playbooks/vault/service-public.pem\n      mode: 0600\n  - name: Add data to vault, from a LOCAL file.\n    ipavault:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: secret_vault\n      vault_type: asymmetric\n      service: HTTP/webserver1.idm.example.com\n      public_key_file: /usr/share/doc/ansible-freeipa/playbooks/vault/service-public.pem\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-asymmetric-service-vault-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-member-services-to-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.2. Adding member services to an asymmetric vault using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to add member services to a service vault so that they can all retrieve the secret stored in the vault. In the example used in the procedure below, the IdM administrator adds the \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver2.idm.example.com\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver3.idm.example.com\u003C/strong>\u003C/span> service principals to the \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span> vault that is owned by \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver1.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the \u003Cspan class=\"strong strong\">\u003Cstrong>IdM administrator\u003C/strong>\u003C/span> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible\">created an asymmetric vault\u003C/a> to store the service secret.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/vault\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Create an inventory file if it does not exist, for example \u003Cspan class=\"strong strong\">\u003Cstrong>inventory.file\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>data-archive-in-asymmetric-vault.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp data-archive-in-asymmetric-vault.yml add-services-to-an-asymmetric-vault.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>data-archive-in-asymmetric-vault-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tModify the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">service\u003C/code> variable to the service owner of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver1.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tDefine the services that you want to have access to the vault secret using the \u003Ccode class=\"literal\">services\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - ipavault:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: secret_vault\n      service: HTTP/webserver1.idm.example.com\n      services:\n      - HTTP/webserver2.idm.example.com\n      - HTTP/webserver3.idm.example.com\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file add-services-to-an-asymmetric-vault.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.3. Storing an IdM service secret in an asymmetric vault using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to store a secret in a service vault so that it can be later retrieved by the service. In the example used in the procedure below, the administrator stores a \u003Ccode class=\"literal\">PEM\u003C/code> file with the secret in an asymmetric vault named \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>. This ensures that the service will have to authenticate using a private key to retrieve the secret from the vault. The vault members will be able to retrieve the file from any IdM client.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the \u003Cspan class=\"strong strong\">\u003Cstrong>IdM administrator\u003C/strong>\u003C/span> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible\">created an asymmetric vault\u003C/a> to store the service secret.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe secret is stored locally on the Ansible controller, for example in the \u003Cspan class=\"strong strong\">\u003Cstrong>/usr/share/doc/ansible-freeipa/playbooks/vault/private-key-to-an-externally-signed-certificate.pem\u003C/strong>\u003C/span> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/vault\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Create an inventory file if it does not exist, for example \u003Cspan class=\"strong strong\">\u003Cstrong>inventory.file\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>data-archive-in-asymmetric-vault.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp data-archive-in-asymmetric-vault.yml data-archive-in-asymmetric-vault-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>data-archive-in-asymmetric-vault-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tModify the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">service\u003C/code> variable to the service owner of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver1.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">in\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>\"{{ lookup('file', 'private-key-to-an-externally-signed-certificate.pem') | b64encode }}\"\u003C/strong>\u003C/span>. This ensures that Ansible retrieves the file with the private key from the working directory on the Ansible controller rather than from the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - ipavault:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: secret_vault\n      service: HTTP/webserver1.idm.example.com\n      in: \"{{ lookup('file', 'private-key-to-an-externally-signed-certificate.pem') | b64encode }}\"\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file data-archive-in-asymmetric-vault-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.4. Retrieving a service secret for an IdM service using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to retrieve a secret from a service vault on behalf of the service. In the example used in the procedure below, running the playbook retrieves a \u003Ccode class=\"literal\">PEM\u003C/code> file with the secret from an asymmetric vault named \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>, and stores it in the specified location on all the hosts listed in the Ansible inventory file as \u003Ccode class=\"literal\">ipaservers\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe services authenticate to IdM using keytabs, and they authenticate to the vault using a private key. You can retrieve the file on behalf of the service from any IdM client on which \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> is installed.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible\">created an asymmetric vault\u003C/a> to store the service secret.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.3. Storing an IdM service secret in an asymmetric vault using Ansible\">archived the secret in the vault\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have stored the private key used to retrieve the service vault secret in the location specified by the \u003Ccode class=\"literal\">private_key_file\u003C/code> variable on the Ansible controller.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/vault\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Create an inventory file if it does not exist, for example \u003Cspan class=\"strong strong\">\u003Cstrong>inventory.file\u003C/strong>\u003C/span>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and define the following hosts:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tDefine your IdM server in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tDefine the hosts onto which you want to retrieve the secret in the \u003Ccode class=\"literal\">[webservers]\u003C/code> section. For example, to instruct Ansible to retrieve the secret to \u003Cspan class=\"strong strong\">\u003Cstrong>webserver1.idm.example.com\u003C/strong>\u003C/span>, \u003Cspan class=\"strong strong\">\u003Cstrong>webserver2.idm.example.com\u003C/strong>\u003C/span>, and \u003Cspan class=\"strong strong\">\u003Cstrong>webserver3.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[webservers]\nwebserver1.idm.example.com\nwebserver2.idm.example.com\nwebserver3.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>retrieve-data-asymmetric-vault.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp retrieve-data-asymmetric-vault.yml retrieve-data-asymmetric-vault-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>retrieve-data-asymmetric-vault-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tModify the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">service\u003C/code> variable to the service owner of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver1.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">private_key_file\u003C/code> variable to the location of the private key used to retrieve the service vault secret.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">out\u003C/code> variable to the location on the IdM server where you want to retrieve the \u003Cspan class=\"strong strong\">\u003Cstrong>private-key-to-an-externally-signed-certificate.pem\u003C/strong>\u003C/span> secret, for example the current working directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Retrieve data from vault\n  hosts: ipaserver\n  become: no\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Retrieve data from the service vault\n    ipavault:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: secret_vault\n      service: HTTP/webserver1.idm.example.com\n      vault_type: asymmetric\n      private_key: \"{{ lookup('file', 'service-private.pem') | b64encode }}\"\n      out: private-key-to-an-externally-signed-certificate.pem\n      state: retrieved\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd a section to the playbook that retrieves the data file from the IdM server to the Ansible controller:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Retrieve data from vault\n  hosts: ipaserver\n  become: no\n  gather_facts: false\n  tasks:\n[...]\n  - name: Retrieve data file\n    fetch:\n      src: private-key-to-an-externally-signed-certificate.pem\n      dest: ./\n      flat: true\n      mode: 0600\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd a section to the playbook that transfers the retrieved \u003Cspan class=\"strong strong\">\u003Cstrong>private-key-to-an-externally-signed-certificate.pem\u003C/strong>\u003C/span> file from the Ansible controller on to the webservers listed in the \u003Ccode class=\"literal\">webservers\u003C/code> section of the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Send data file to webservers\n  become: no\n  gather_facts: no\n  hosts: webservers\n  tasks:\n  - name: Send data to webservers\n    copy:\n      src: private-key-to-an-externally-signed-certificate.pem\n      dest: /etc/pki/tls/private/httpd.key\n      mode: 0444\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file retrieve-data-asymmetric-vault-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"changing-an-idm-service-vault-secret-when-compromised-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.5. Changing an IdM service vault secret when compromised using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to reuse an Ansible playbook to change the secret stored in a service vault when a service instance has been compromised. The scenario in the following example assumes that on \u003Cspan class=\"strong strong\">\u003Cstrong>webserver3.idm.example.com\u003C/strong>\u003C/span>, the retrieved secret has been compromised, but not the key to the asymmetric vault storing the secret. In the example, the administrator reuses the Ansible playbooks used when \u003Ca class=\"link\" href=\"#storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.3. Storing an IdM service secret in an asymmetric vault using Ansible\">storing a secret in an asymmetric vault\u003C/a> and \u003Ca class=\"link\" href=\"#retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.4. Retrieving a service secret for an IdM service using Ansible\">retrieving a secret from the asymmetric vault onto IdM hosts\u003C/a>. At the start of the procedure, the IdM administrator stores a new \u003Ccode class=\"literal\">PEM\u003C/code> file with a new secret in the asymmetric vault, adapts the inventory file so as not to retrieve the new secret on to the compromised web server, \u003Cspan class=\"strong strong\">\u003Cstrong>webserver3.idm.example.com\u003C/strong>\u003C/span>, and then re-runs the two procedures.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the \u003Cspan class=\"strong strong\">\u003Cstrong>IdM administrator\u003C/strong>\u003C/span> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets\" title=\"25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible\">created an asymmetric vault\u003C/a> to store the service secret.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have generated a new \u003Ccode class=\"literal\">httpd\u003C/code> key for the web services running on IdM hosts to replace the compromised old key.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe new \u003Ccode class=\"literal\">httpd\u003C/code> key is stored locally on the Ansible controller, for example in the \u003Cspan class=\"strong strong\">\u003Cstrong>/usr/share/doc/ansible-freeipa/playbooks/vault/private-key-to-an-externally-signed-certificate.pem\u003C/strong>\u003C/span> file.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/vault\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the following hosts are defined correctly:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IdM server in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe hosts onto which you want to retrieve the secret in the \u003Ccode class=\"literal\">[webservers]\u003C/code> section. For example, to instruct Ansible to retrieve the secret to \u003Cspan class=\"strong strong\">\u003Cstrong>webserver1.idm.example.com\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>webserver2.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\n\n[webservers]\nwebserver1.idm.example.com\nwebserver2.idm.example.com\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tMake sure that the list does not contain the compromised webserver, in the current example \u003Cspan class=\"strong strong\">\u003Cstrong>webserver3.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>data-archive-in-asymmetric-vault-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tModify the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">service\u003C/code> variable to the service owner of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">in\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>\"{{ lookup('file', 'new-private-key-to-an-externally-signed-certificate.pem') | b64encode }}\"\u003C/strong>\u003C/span>. This ensures that Ansible retrieves the file with the private key from the working directory on the Ansible controller rather than from the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Tests\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - ipavault:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: secret_vault\n      service: HTTP/webserver.idm.example.com\n      in: \"{{ lookup('file', 'new-private-key-to-an-externally-signed-certificate.pem') | b64encode }}\"\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file data-archive-in-asymmetric-vault-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>retrieve-data-asymmetric-vault-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tModify the file by setting the following variables in the \u003Ccode class=\"literal\">ipavault\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>secret_vault\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">service\u003C/code> variable to the service owner of the vault, for example \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/webserver1.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">private_key_file\u003C/code> variable to the location of the private key used to retrieve the service vault secret.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">out\u003C/code> variable to the location on the IdM server where you want to retrieve the \u003Cspan class=\"strong strong\">\u003Cstrong>new-private-key-to-an-externally-signed-certificate.pem\u003C/strong>\u003C/span> secret, for example the current working directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Retrieve data from vault\n  hosts: ipaserver\n  become: no\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Retrieve data from the service vault\n    ipavault:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: secret_vault\n      service: HTTP/webserver1.idm.example.com\n      vault_type: asymmetric\n      private_key: \"{{ lookup('file', 'service-private.pem') | b64encode }}\"\n      out: new-private-key-to-an-externally-signed-certificate.pem\n      state: retrieved\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd a section to the playbook that retrieves the data file from the IdM server to the Ansible controller:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Retrieve data from vault\n  hosts: ipaserver\n  become: true\n  gather_facts: false\n  tasks:\n[...]\n  - name: Retrieve data file\n    fetch:\n      src: new-private-key-to-an-externally-signed-certificate.pem\n      dest: ./\n      flat: true\n      mode: 0600\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdd a section to the playbook that transfers the retrieved \u003Cspan class=\"strong strong\">\u003Cstrong>new-private-key-to-an-externally-signed-certificate.pem\u003C/strong>\u003C/span> file from the Ansible controller on to the webservers listed in the \u003Ccode class=\"literal\">webservers\u003C/code> section of the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Send data file to webservers\n  become: true\n  gather_facts: no\n  hosts: webservers\n  tasks:\n  - name: Send data to webservers\n    copy:\n      src: new-private-key-to-an-externally-signed-certificate.pem\n      dest: /etc/pki/tls/private/httpd.key\n      mode: 0444\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file retrieve-data-asymmetric-vault-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_6\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">25.6. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the README-vault.md Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/vault/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 26. Ensuring the presence and absence of services in IdM using Ansible\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tWith the Ansible \u003Ccode class=\"literal\">service\u003C/code> module, Identity Management (IdM) administrator can ensure that specific services that are not native to IdM are present or absent in IdM. For example, you can use the \u003Ccode class=\"literal\">service\u003C/code> module to:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tCheck that a manually installed service is present on an IdM client and automatically install that service if it is absent. For details, see:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Ensuring the presence of an HTTP service in IdM on an IdM client.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-on-a-non-idm-client-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Ensuring the presence of an HTTP service in IdM on a non-IdM client.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-on-an-idm-client-without-dns-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Ensuring the presence of an HTTP service on an IdM client without DNS.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tCheck that a service enrolled in IdM has a certificate attached and automatically install that certificate if it is absent. For details, see:\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Ensuring the presence of an externally-signed certificate in an IdM service entry.\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tAllow IdM users and hosts to retrieve and create the service keytab. For details, see:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-create-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Allowing IdM users, groups, hosts, or host groups to create a keytab of a service.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-retrieve-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Allowing IdM users, groups, hosts, or host groups to retrieve a keytab of a service.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tAllow IdM users and hosts to add a Kerberos alias to a service. For details, see:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-a-kerberos-principal-alias-of-a-service-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Ensuring the presence of a Kerberos principal alias for a service.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tCheck that a service is not present on an IdM client and automatically remove that service if it is present. For details, see:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-absence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Ensuring the absence of an HTTP service in IdM on an IdM client.\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.1. Ensuring the presence of an HTTP service in IdM using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the presence of an HTTP server in IdM using an Ansible playbook.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system to host the HTTP service is an IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">inventory.file\u003C/code> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-copy.yml\u003C/code> Ansible playbook file for editing:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA service.\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure service is present\n  - ipaservice:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: HTTP/client.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the IdM administrator password defined by the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the name of your IdM client on which the HTTP service is running, as defined by the \u003Ccode class=\"literal\">name\u003C/code> variable of the \u003Ccode class=\"literal\">ipaservice\u003C/code> task.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and exit the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog into the IdM Web UI as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Identity\u003C/code> → \u003Ccode class=\"literal\">Services\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tIf \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> is listed in the \u003Cspan class=\"strong strong\">\u003Cstrong>Services\u003C/strong>\u003C/span> list, the Ansible playbook has been successfully added to IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo secure the communication between the HTTP server and browser clients, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs\">adding TLS encryption to an Apache HTTP Server\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo request a certificate for the HTTP service, see the procedure described in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/using-certmonger_managing-certificates-in-idm\">Obtaining an IdM certificate for a service using certmonger\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-multiple-services-in-idm-on-an-idm-client-using-a-single-ansible-task_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.2. Ensuring the presence of multiple services in IdM on an IdM client using a single Ansible task\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipaservice\u003C/code> module to add, modify, and delete multiple Identity Management (IdM) services with a single Ansible task. For that, use the \u003Ccode class=\"literal\">services\u003C/code> option of the \u003Ccode class=\"literal\">ipaservice\u003C/code> module.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tUsing the \u003Ccode class=\"literal\">services\u003C/code> option, you can also specify multiple service variables that only apply to a particular service. Define this service by the \u003Ccode class=\"literal\">name\u003C/code> variable, which is the only mandatory variable for the \u003Ccode class=\"literal\">services\u003C/code> option.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to ensure the presence of the \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client01.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> and the \u003Cspan class=\"strong strong\">\u003Cstrong>ftp/client02.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> services in IdM with a single task.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the control node:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using RHEL 9.3 and later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>add-http-and-ftp-services.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">---\n- name: Playbook to add multiple services in a single task\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n\n  tasks:\n  - name: Add HTTP and ftp services\n    ipaservice:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      services:\n      - name:  HTTP/client01.idm.example.com@IDM.EXAMPLE.COM\n      - name: ftp/client02.idm.example.com@IDM.EXAMPLE.COM\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory add-http-and-ftp-services.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-service.md\">The service module in \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream docs\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-http-service-in-idm-on-a-non-idm-client-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.3. Ensuring the presence of an HTTP service in IdM on a non-IdM client using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the presence of an HTTP server in IdM on a host that is not an IdM client using an Ansible playbook. By adding the HTTP server to IdM you are also adding the host to IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\">installed an HTTP service\u003C/a> on your host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host on which you have set up HTTP is not an IdM client. Otherwise, follow the steps in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">enrolled the HTTP service into IdM.\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe DNS A record - or the AAAA record if IPv6 is used - for the host is available.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIf the server runs RHEL 9.2 or later and the FIPS mode is enabled, clients must either support the Extended Master Secret (EMS) extension or use TLS 1.3. TLS 1.2 connections without EMS fail. For more information, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/7018256\">TLS extension \"Extended Master Secret\" enforced\u003C/a> Knowledgebase article.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">inventory.file\u003C/code> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the copied file, \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check-copy.yml\u003C/code>, for editing. Locate the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and \u003Ccode class=\"literal\">name\u003C/code> variables in the \u003Ccode class=\"literal\">ipaservice\u003C/code> task:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA service.\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure service is present\n  - ipaservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: HTTP/www2.example.com\u003C/strong>\u003C/span>\n      skip_host_check: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the host on which the HTTP service is running.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and exit the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-without-host-check-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog into the IdM Web UI as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Identity\u003C/code> → \u003Ccode class=\"literal\">Services\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou can now see \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> listed in the \u003Cspan class=\"strong strong\">\u003Cstrong>Services\u003C/strong>\u003C/span> list.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo secure the communication, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs\">adding TLS encryption to an Apache HTTP Server\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-http-service-on-an-idm-client-without-dns-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.4. Ensuring the presence of an HTTP service on an IdM client without DNS using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to ensure the presence of an HTTP server running on an IdM client that has no DNS entry using an Ansible playbook. The scenario implied is that the IdM host has no DNS A entry available - or no DNS AAAA entry if IPv6 is used instead of IPv4.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system to host the HTTP service is enrolled in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe DNS A or DNS AAAA record for the host may not exist. Otherwise, if the DNS record for the host does exist, follow the procedure in \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">Ensuring the presence of an HTTP service in IdM using an Ansible playbook.\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">inventory.file\u003C/code> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the copied file, \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force-copy.yml\u003C/code>, for editing. Locate the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> and \u003Ccode class=\"literal\">name\u003C/code> variables in the \u003Ccode class=\"literal\">ipaservice\u003C/code> task:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA service.\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure service is present\n  - ipaservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: HTTP/ihavenodns.info\u003C/strong>\u003C/span>\n      force: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the host on which the HTTP service is running.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and exit the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-is-present-with-host-force-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog into the IdM Web UI as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Identity\u003C/code> → \u003Ccode class=\"literal\">Services\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tYou can now see \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> listed in the \u003Cspan class=\"strong strong\">\u003Cstrong>Services\u003C/strong>\u003C/span> list.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo secure the communication, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#proc_adding-tls-encryption-to-an-apache-http-server-configuration_restricting-an-application-to-trust-a-subset-of-certs\">adding TLS encryption to an Apache HTTP Server\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.5. Ensuring the presence of an externally signed certificate in an IdM service entry using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">service\u003C/code> module to ensure that a certificate issued by an external certificate authority (CA) is attached to the IdM entry of the HTTP service. Having the certificate of an HTTP service signed by an external CA rather than the IdM CA is particularly useful if your IdM CA uses a self-signed certificate.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\">installed an HTTP service\u003C/a> on your host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">enrolled the HTTP service into IdM.\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have an externally signed certificate whose Subject corresponds to the principal of the HTTP service.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">inventory.file\u003C/code> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present.yml\u003C/code> file, for example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: If the certificate is in the Privacy Enhanced Mail (PEM) format, convert the certificate to the Distinguished Encoding Rules (DER) format for easier handling through the command-line interface (CLI):\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>openssl x509 -outform der -in cert1.pem -out cert1.der\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDecode the \u003Ccode class=\"literal\">DER\u003C/code> file to standard output using the \u003Ccode class=\"literal\">base64\u003C/code> command. Use the \u003Ccode class=\"literal\">-w0\u003C/code> option to disable wrapping:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>base64 cert1.der -w0\u003C/strong>\u003C/span>\nMIIC/zCCAeegAwIBAgIUV74O+4kXeg21o4vxfRRtyJm...\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCopy the certificate from the standard output to the clipboard.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present-copy.yml\u003C/code> file for editing and view its contents:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Service certificate present.\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure service certificate is present\n  - ipaservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      name: \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span>\n      certificate: |\n        - \u003Cspan class=\"strong strong\">\u003Cstrong>MIICBjCCAW8CFHnm32VcXaUDGfEGdDL/...\u003C/strong>\u003C/span>\n      [...]\n      action: member\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tReplace the certificate, defined using the \u003Ccode class=\"literal\">certificate\u003C/code> variable, with the certificate you copied from the CLI. Note that if you use the \u003Ccode class=\"literal\">certificate:\u003C/code> variable with the \"|\" pipe character as indicated, you can enter the certificate THIS WAY rather than having it to enter it in a single line. This makes reading the certificate easier.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the IdM administrator password, defined by the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the name of your IdM client on which the HTTP service is running, defined by the \u003Ccode class=\"literal\">name\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange any other relevant variables.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and exit the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-member-certificate-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog into the IdM Web UI as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Identity\u003C/code> → \u003Ccode class=\"literal\">Services\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick the name of the service with the newly added certificate, for example \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tIn the \u003Ccode class=\"literal\">Service Certificate\u003C/code> section on the right, you can now see the newly added certificate.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-create-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.6. Using an Ansible playbook to allow IdM users, groups, hosts, or host groups to create a keytab of a service\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA keytab is a file containing pairs of Kerberos principals and encrypted keys. Keytab files are commonly used to allow scripts to automatically authenticate using Kerberos, without requiring human interaction or access to password stored in a plain-text file. The script is then able to use the acquired credentials to access files stored on a remote system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAs an Identity Management (IdM) administrator, you can allow other users to retrieve or even create a keytab for a service running in IdM. By allowing specific users and user groups to create keytabs, you can delegate the administration of the service to them without sharing the IdM administrator password. This delegation provides a more fine-grained system administration.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to allow specific IdM users, user groups, hosts, and host groups to create a keytab for the HTTP service running on an IdM client. Specifically, it describes how you can allow the \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span> IdM user to create a keytab for the HTTP service running on an IdM client named \u003Cspan class=\"strong strong\">\u003Cstrong>client.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">enrolled the HTTP service into IdM.\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe system to host the HTTP service is an IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM users and user groups that you want to allow to create the keytab exist in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM hosts and host groups that you want to allow to create the keytab exist in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">inventory.file\u003C/code> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by changing the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IdM administrator password specified by the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe name of your IdM client on which the HTTP service is running. In the current example, it is \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe names of IdM users that are listed in the \u003Ccode class=\"literal\">allow_create_keytab_user:\u003C/code> section. In the current example, it is \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe names of IdM user groups that are listed in the \u003Ccode class=\"literal\">allow_create_keytab_group:\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe names of IdM hosts that are listed in the \u003Ccode class=\"literal\">allow_create_keytab_host:\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe names of IdM host groups that are listed in the \u003Ccode class=\"literal\">allow_create_keytab_hostgroup:\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe name of the task specified by the \u003Ccode class=\"literal\">name\u003C/code> variable in the \u003Ccode class=\"literal\">tasks\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter being adapted for the current example, the copied file looks like this:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Service member allow_create_keytab present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Service HTTP/client.idm.example.com members allow_create_keytab present for user01\n    ipaservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: HTTP/client.idm.example.com\u003C/strong>\u003C/span>\n      allow_create_keytab_user:\n      - \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span>\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_create_keytab-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSSH to an IdM server as an IdM user that has the privilege to create a keytab for the particular HTTP service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh user01@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipa-getkeytab\u003C/code> command to generate the new keytab for the HTTP service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-getkeytab -s server.idm.example.com -p HTTP/client.idm.example.com -k /etc/httpd/conf/krb5.keytab\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-s\u003C/code> option specifies a Key Distribution Center (KDC) server to generate the keytab.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-p\u003C/code> option specifies the principal whose keytab you want to create.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-k\u003C/code> option specifies the keytab file to append the new key to. The file will be created if it does not exist.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tIf the command does not result in an error, you have successfully created a keytab of \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span> as \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-retrieve-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.7. Using an Ansible playbook to allow IdM users, groups, hosts, or host groups to retrieve a keytab of a service\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA keytab is a file containing pairs of Kerberos principals and encrypted keys. Keytab files are commonly used to allow scripts to automatically authenticate using Kerberos, without requiring human interaction or access to a password stored in a plain-text file. The script is then able to use the acquired credentials to access files stored on a remote system.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tAs IdM administrator, you can allow other users to retrieve or even create a keytab for a service running in IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to allow specific IdM users, user groups, hosts, and host groups to retrieve a keytab for the HTTP service running on an IdM client. Specifically, it describes how to allow the \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span> IdM user to retrieve the keytab of the HTTP service running on \u003Cspan class=\"strong strong\">\u003Cstrong>client.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">enrolled the HTTP service into IdM.\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM users and user groups that you want to allow to retrieve the keytab exist in IdM.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM hosts and host groups that you want to allow to retrieve the keytab exist in IdM.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ touch \u003Cspan class=\"strong strong\">\u003Cstrong>inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">inventory.file\u003C/code> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the copied file, \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present-copy.yml\u003C/code>, for editing:\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable of the \u003Ccode class=\"literal\">ipaservice\u003C/code> task to the principal of the HTTP service. In the current example, it is \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span>\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSpecify the names of IdM users in the \u003Ccode class=\"literal\">allow_retrieve_keytab_group:\u003C/code> section. In the current example, it is \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSpecify the names of IdM user groups in the \u003Ccode class=\"literal\">allow_retrieve_keytab_group:\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSpecify the names of IdM hosts in the \u003Ccode class=\"literal\">allow_retrieve_keytab_group:\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSpecify the names of IdM host groups in the \u003Ccode class=\"literal\">allow_retrieve_keytab_group:\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSpecify the name of the task using the \u003Ccode class=\"literal\">name\u003C/code> variable in the \u003Ccode class=\"literal\">tasks\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter being adapted for the current example, the copied file looks like this:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Service member allow_retrieve_keytab present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Service HTTP/client.idm.example.com members allow_retrieve_keytab present for user01\n    ipaservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: HTTP/client.idm.example.com\u003C/strong>\u003C/span>\n      allow_retrieve_keytab_user:\n      - \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span>\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-member-allow_retrieve_keytab-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSSH to an IdM server as an IdM user with the privilege to retrieve a keytab for the HTTP service:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh user01@server.idm.example.com\u003C/strong>\u003C/span>\nPassword:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipa-getkeytab\u003C/code> command with the \u003Ccode class=\"literal\">-r\u003C/code> option to retrieve the keytab:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-getkeytab -r -s server.idm.example.com -p HTTP/client.idm.example.com -k /etc/httpd/conf/krb5.keytab\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-s\u003C/code> option specifies a Key Distribution Center (KDC) server from which you want to retrieve the keytab.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-p\u003C/code> option specifies the principal whose keytab you want to retrieve.\n\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">-k\u003C/code> option specifies the keytab file to which you want to append the retrieved key. The file will be created if it does not exist.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tIf the command does not result in an error, you have successfully retrieved a keytab of \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span> as \u003Cspan class=\"strong strong\">\u003Cstrong>user01\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-a-kerberos-principal-alias-of-a-service-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.8. Ensuring the presence of a Kerberos principal alias of a service using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIn some scenarios, it is beneficial for IdM administrator to enable IdM users, hosts, or services to authenticate against Kerberos applications using a Kerberos principal alias. These scenarios include:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user name changed, but the user should be able to log into the system using both the previous and new user names.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user needs to log in using the email address even if the IdM Kerberos realm differs from the email domain.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tFollow this procedure to create the principal alias of \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/mycompany.idm.example.com\u003C/strong>\u003C/span> for the HTTP service running on \u003Cspan class=\"strong strong\">\u003Cstrong>client.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_certificates_in_idm/restricting-an-application-to-trust-only-a-subset-of-certificates_managing-certificates-in-idm#setting-up-a-single-instance-apache-http-server_restricting-an-application-to-trust-a-subset-of-certs\">set up an HTTP service\u003C/a> on your host.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/ko-kr/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">enrolled the HTTP service into IdM.\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe host on which you have set up HTTP is an IdM client.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">inventory.file\u003C/code> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by changing the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IdM administrator password specified by the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe name of the service specified by the \u003Ccode class=\"literal\">name\u003C/code> variable. This is the canonical principal name of the service. In the current example, it is \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe Kerberos principal alias specified by the \u003Ccode class=\"literal\">principal\u003C/code> variable. This is the alias you want to add to the service defined by the \u003Ccode class=\"literal\">name\u003C/code> variable. In the current example, it is \u003Cspan class=\"strong strong\">\u003Cstrong>host/mycompany.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe name of the task specified by the \u003Ccode class=\"literal\">name\u003C/code> variable in the \u003Ccode class=\"literal\">tasks\u003C/code> section.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter being adapted for the current example, the copied file looks like this:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Service member principal present\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Service HTTP/client.idm.example.com member principals host/mycompany.idm.exmaple.com present\n    ipaservice:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: HTTP/client.idm.example.com\u003C/strong>\u003C/span>\n      principal:\n        - \u003Cspan class=\"strong strong\">\u003Cstrong>host/mycompany.idm.example.com\u003C/strong>\u003C/span>\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-member-principal-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tIf running the playbook results in 0 unreachable and 0 failed tasks, you have successfully created the \u003Cspan class=\"strong strong\">\u003Cstrong>host/mycompany.idm.example.com\u003C/strong>\u003C/span> Kerberos principal for the \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span> service.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/linux_domain_identity_authentication_and_policy_guide/managing-kerberos-aliases\">Managing Kerberos principal aliases for users, hosts, and services\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.9. Ensuring the absence of an HTTP service in IdM using an Ansible playbook\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to unenroll a service from IdM. More specifically, it describes how to use an Ansible playbook to ensure the absence of an HTTP server named \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com\u003C/strong>\u003C/span> in IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate an inventory file, for example \u003Ccode class=\"literal\">inventory.file\u003C/code>:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>touch inventory.file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">inventory.file\u003C/code> and define the IdM server that you want to configure in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent.yml /usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by changing the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe IdM administrator password defined by the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThe Kerberos principal of the HTTP service, as defined by the \u003Ccode class=\"literal\">name\u003C/code> variable of the \u003Ccode class=\"literal\">ipaservice\u003C/code> task.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter being adapted for the current example, the copied file looks like this:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA service.\n  hosts: ipaserver\n  gather_facts: false\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  # Ensure service is absent\n  - ipaservice:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: HTTP/client.idm.example.com\n      state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave and exit the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory\u003C/em>\u003C/span>/inventory.file /usr/share/doc/ansible-freeipa/playbooks/service/service-is-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLog into the IdM Web UI as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNavigate to \u003Ccode class=\"literal\">Identity\u003C/code> → \u003Ccode class=\"literal\">Services\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp>\n\t\t\t\tIf you cannot see the \u003Cspan class=\"strong strong\">\u003Cstrong>HTTP/client.idm.example.com@IDM.EXAMPLE.COM\u003C/strong>\u003C/span> service in the \u003Cspan class=\"strong strong\">\u003Cstrong>Services\u003C/strong>\u003C/span> list, you have successfully ensured its absence in IdM.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_7\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">26.10. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-service.md\u003C/code> Markdown file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee sample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/config\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 27. Managing global DNS configuration in IdM using Ansible playbooks\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tUsing the Red Hat Ansible Engine \u003Ccode class=\"literal\">dnsconfig\u003C/code> module, you can configure global configuration for Identity Management (IdM) DNS. Settings defined in global DNS configuration are applied to all IdM DNS servers. However, the global configuration has lower priority than the configuration for a specific IdM DNS zone.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe \u003Ccode class=\"literal\">dnsconfig\u003C/code> module supports the following variables:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe global forwarders, specifically their IP addresses and the port used for communication.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe global forwarding policy: only, first, or none. For more details on these types of DNS forward policies, see \u003Ca class=\"link\" href=\"#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.5. DNS forward policies in IdM\">DNS forward policies in IdM\u003C/a>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe synchronization of forward lookup and reverse lookup zones.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tDNS service is installed on the IdM server. For more information about how to install an IdM server with integrated DNS, see one of the following links:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-with-integrated-dns_installing-identity-management\">Installing an IdM server: With integrated DNS, with an integrated CA as the root CA\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-with-external-ca_installing-identity-management\">Installing an IdM server: With integrated DNS, with an external CA as the root CA\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-ipa-server-without-a-ca_installing-identity-management\">Installing an IdM server: With integrated DNS, without a CA\u003C/a>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t \u003Cbr/>\n\t\t\u003C/p>\u003Cp>\n\t\t\tThis chapter includes the following sections:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#how-idm-ensures-that-global-forwarders-from-etc-resolv-conf-are-not-removed-by-networkmanager_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.1. How IdM ensures that global forwarders from /etc/resolv.conf are not removed by NetworkManager\">How IdM ensures that global forwarders from /etc/resolv.conf are not removed by NetworkManager\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.2. Ensuring the presence of a DNS global forwarder in IdM using Ansible\">Ensuring the presence of a DNS global forwarder in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.3. Ensuring the absence of a DNS global forwarder in IdM using Ansible\">Ensuring the absence of a DNS global forwarder in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.4. The action: member option in ipadnsconfig ansible-freeipa modules\">The \u003Ccode class=\"literal\">action: member\u003C/code> option in ipadnsconfig ansible-freeipa modules\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tAn introduction to \u003Ca class=\"link\" href=\"#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.5. DNS forward policies in IdM\">DNS forward policies in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-an-ansible-playbook-to-ensure-that-the-forward-first-policy-is-set-in-idm-dns-global-configuration_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.6. Using an Ansible playbook to ensure that the forward first policy is set in IdM DNS global configuration\">Using an Ansible playbook to ensure that the forward first policy is set in IdM DNS global configuration\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-an-ansible-playbook-to-ensure-that-global-forwarders-are-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.7. Using an Ansible playbook to ensure that global forwarders are disabled in IdM DNS\">Using an Ansible playbook to ensure that global forwarders are disabled in IdM DNS\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-an-ansible-playbook-to-ensure-that-synchronization-of-forward-and-reverse-lookup-zones-is-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.8. Using an Ansible playbook to ensure that synchronization of forward and reverse lookup zones is disabled in IdM DNS\">Using an Ansible playbook to ensure that synchronization of forward and reverse lookup zones is disabled in IdM DNS\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"how-idm-ensures-that-global-forwarders-from-etc-resolv-conf-are-not-removed-by-networkmanager_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.1. How IdM ensures that global forwarders from /etc/resolv.conf are not removed by NetworkManager\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tInstalling Identity Management (IdM) with integrated DNS configures the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file to point to the \u003Ccode class=\"literal\">127.0.0.1\u003C/code> localhost address:\n\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># Generated by NetworkManager\nsearch idm.example.com\nnameserver 127.0.0.1\u003C/pre>\u003Cp>\n\t\t\t\tIn certain environments, such as networks that use \u003Ccode class=\"literal\">Dynamic Host Configuration Protocol\u003C/code> (DHCP), the \u003Ccode class=\"literal\">NetworkManager\u003C/code> service may revert changes to the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file. To make the DNS configuration persistent, the IdM DNS installation process also configures the \u003Ccode class=\"literal\">NetworkManager\u003C/code> service in the following way:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe DNS installation script creates an \u003Ccode class=\"literal\">/etc/NetworkManager/conf.d/zzz-ipa.conf\u003C/code> \u003Ccode class=\"literal\">NetworkManager\u003C/code> configuration file to control the search order and DNS server list:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># auto-generated by IPA installer\n[main]\ndns=default\n\n[global-dns]\nsearches=$DOMAIN\n\n[global-dns-domain-*]\nservers=127.0.0.1\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">NetworkManager\u003C/code> service is reloaded, which always creates the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file with the settings from the last file in the \u003Ccode class=\"literal\">/etc/NetworkManager/conf.d/\u003C/code> directory. This is in this case the \u003Ccode class=\"literal\">zzz-ipa.conf\u003C/code> file.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not modify the \u003Ccode class=\"literal\">/etc/resolv.conf\u003C/code> file manually.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.2. Ensuring the presence of a DNS global forwarder in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure the presence of a DNS global forwarder in IdM. In the example procedure below, the IdM administrator ensures the presence of a DNS global forwarder to a DNS server with an Internet Protocol (IP) v4 address of \u003Ccode class=\"literal\">7.7.9.9\u003C/code> and IP v6 address of \u003Ccode class=\"literal\">2001:db8::1:0\u003C/code> on port \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">forwarders-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp forwarders-absent.yml ensure-presence-of-a-global-forwarder.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">ensure-presence-of-a-global-forwarder.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to ensure the presence of a global forwarder in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Ensure the presence of a DNS global forwarder to 7.7.9.9 and 2001:db8::1:0 on port 53\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">forwarders\u003C/code> section of the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> portion:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the first \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv4 address of the global forwarder: \u003Ccode class=\"literal\">7.7.9.9\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the second \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv6 address of the global forwarder: \u003Ccode class=\"literal\">2001:db8::1:0\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tVerify the \u003Ccode class=\"literal\">port\u003C/code> value is set to \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">state\u003C/code> to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure the presence of a global forwarder in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure the presence of a DNS global forwarder to 7.7.9.9 and 2001:db8::1:0 on port 53\n    ipadnsconfig:\n      forwarders:\n        - ip_address: 7.7.9.9\n        - ip_address: 2001:db8::1:0\n          port: 53\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-of-a-global-forwarder.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.3. Ensuring the absence of a DNS global forwarder in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure the absence of a DNS global forwarder in IdM. In the example procedure below, the IdM administrator ensures the absence of a DNS global forwarder with an Internet Protocol (IP) v4 address of \u003Ccode class=\"literal\">8.8.6.6\u003C/code> and IP v6 address of \u003Ccode class=\"literal\">2001:4860:4860::8800\u003C/code> on port \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">forwarders-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp forwarders-absent.yml ensure-absence-of-a-global-forwarder.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">ensure-absence-of-a-global-forwarder.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to ensure the absence of a global forwarder in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Ensure the absence of a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800 on port 53\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">forwarders\u003C/code> section of the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> portion:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the first \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv4 address of the global forwarder: \u003Ccode class=\"literal\">8.8.6.6\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the second \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv6 address of the global forwarder: \u003Ccode class=\"literal\">2001:4860:4860::8800\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tVerify the \u003Ccode class=\"literal\">port\u003C/code> value is set to \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tVerify the \u003Ccode class=\"literal\">state\u003C/code> is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure the absence of a global forwarder in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure the absence of a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800 on port 53\n    ipadnsconfig:\n      forwarders:\n        - ip_address: 8.8.6.6\n        - ip_address: 2001:4860:4860::8800\n          port: 53\n      action: member\n      state: absent\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf you only use the \u003Ccode class=\"literal\">state: absent\u003C/code> option in your playbook without also using \u003Ccode class=\"literal\">action: member\u003C/code>, the playbook fails.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-absence-of-a-global-forwarder.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.4. The action: member option in ipadnsconfig ansible-freeipa modules\">The \u003Ccode class=\"literal\">action: member\u003C/code> option in ipadnsconfig ansible-freeipa modules\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.4. The \u003Ccode class=\"literal\">action: member\u003C/code> option in ipadnsconfig ansible-freeipa modules\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tExcluding global forwarders in Identity Management (IdM) by using the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> module requires using the \u003Ccode class=\"literal\">action: member\u003C/code> option in addition to the \u003Ccode class=\"literal\">state: absent\u003C/code> option. If you only use \u003Ccode class=\"literal\">state: absent\u003C/code> in your playbook without also using \u003Ccode class=\"literal\">action: member\u003C/code>, the playbook fails. Consequently, to remove all global forwarders, you must specify all of them individually in the playbook. In contrast, the \u003Ccode class=\"literal\">state: present\u003C/code> option does not require \u003Ccode class=\"literal\">action: member\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ca class=\"link\" href=\"#tab_ipadnsconfig-management-of-global-forwarders_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"Table 27.1. ipadnsconfig management of global forwarders\">following table\u003C/a> provides configuration examples for both adding and removing DNS global forwarders that demonstrate the correct use of the action: member option. The table shows, in each line:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe global forwarders configured before executing a playbook\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn excerpt from the playbook\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe global forwarders configured after executing the playbook\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-table id=\"tab_ipadnsconfig-management-of-global-forwarders_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 27.1. ipadnsconfig management of global forwarders\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 14%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 72%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 14%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464216052464\" scope=\"col\">Forwarders before\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464216051376\" scope=\"col\">Playbook excerpt\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464216050288\" scope=\"col\">Forwarders after\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216052464\"> \u003Cp>\n\t\t\t\t\t\t\t\t8.8.6.6\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216051376\">\n\u003Cpre class=\"screen\">[...]\ntasks:\n- name: Ensure the presence of DNS global forwarder 8.8.6.7\n  ipadnsconfig:\n    forwarders:\n      - ip_address: 8.8.6.7\n    state: present\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216050288\"> \u003Cp>\n\t\t\t\t\t\t\t\t8.8.6.7\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216052464\"> \u003Cp>\n\t\t\t\t\t\t\t\t8.8.6.6\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216051376\">\n\u003Cpre class=\"screen\">[...]\ntasks:\n- name: Ensure the presence of DNS global forwarder 8.8.6.7\n  ipadnsconfig:\n    forwarders:\n      - ip_address: 8.8.6.7\n    action: member\n    state: present\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216050288\"> \u003Cp>\n\t\t\t\t\t\t\t\t8.8.6.6, 8.8.6.7\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216052464\"> \u003Cp>\n\t\t\t\t\t\t\t\t8.8.6.6, 8.8.6.7\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216051376\">\n\u003Cpre class=\"screen\">[...]\ntasks:\n- name: Ensure the absence of DNS global forwarder 8.8.6.7\n  ipadnsconfig:\n    forwarders:\n      - ip_address: 8.8.6.7\n    state: absent\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216050288\"> \u003Cp>\n\t\t\t\t\t\t\t\tTrying to execute the playbook results in an error. The original configuration - 8.8.6.6, 8.8.6.7 - is left unchanged.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216052464\"> \u003Cp>\n\t\t\t\t\t\t\t\t8.8.6.6, 8.8.6.7\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216051376\">\n\u003Cpre class=\"screen\">[...]\ntasks:\n- name: Ensure the absence of DNS global forwarder 8.8.6.7\n  ipadnsconfig:\n    forwarders:\n      - ip_address: 8.8.6.7\n    action: member\n    state: absent\u003C/pre>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464216050288\"> \u003Cp>\n\t\t\t\t\t\t\t\t8.8.6.6\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/section>\u003Csection class=\"section\" id=\"dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.5. DNS forward policies in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdM supports the \u003Ccode class=\"literal\">first\u003C/code> and \u003Ccode class=\"literal\">only\u003C/code> standard BIND forward policies, as well as the \u003Ccode class=\"literal\">none\u003C/code> IdM-specific forward policy.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Forward first \u003Cspan class=\"emphasis\">\u003Cem>(default)\u003C/em>\u003C/span>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe IdM BIND service forwards DNS queries to the configured forwarder. If a query fails because of a server error or timeout, BIND falls back to the recursive resolution using servers on the Internet. The \u003Ccode class=\"literal\">forward first\u003C/code> policy is the default policy, and it is suitable for optimizing DNS traffic.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Forward only\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe IdM BIND service forwards DNS queries to the configured forwarder. If a query fails because of a server error or timeout, BIND returns an error to the client. The \u003Ccode class=\"literal\">forward only\u003C/code> policy is recommended for environments with split DNS configuration.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">None \u003Cspan class=\"emphasis\">\u003Cem>(forwarding disabled)\u003C/em>\u003C/span>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDNS queries are not forwarded with the \u003Ccode class=\"literal\">none\u003C/code> forwarding policy. Disabling forwarding is only useful as a zone-specific override for global forwarding configuration. This option is the IdM equivalent of specifying an empty list of forwarders in BIND configuration.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou cannot use forwarding to combine data in IdM with data from other DNS servers. You can only forward queries for specific subzones of the primary zone in IdM DNS.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBy default, the BIND service does not forward queries to another server if the queried DNS name belongs to a zone for which the IdM server is authoritative. In such a situation, if the queried DNS name cannot be found in the IdM database, the \u003Ccode class=\"literal\">NXDOMAIN\u003C/code> answer is returned. Forwarding is not used.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"example\" id=\"idm140464213715440\">\u003Cp class=\"title\">\u003Cstrong>Example 27.1. Example Scenario\u003C/strong>\u003C/p>\u003Cdiv class=\"example-contents\">\u003Cp>\n\t\t\t\t\tThe IdM server is authoritative for the \u003Cspan class=\"strong strong\">\u003Cstrong>test.example.\u003C/strong>\u003C/span> DNS zone. BIND is configured to forward queries to the DNS server with the \u003Cspan class=\"strong strong\">\u003Cstrong>192.0.2.254\u003C/strong>\u003C/span> IP address.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tWhen a client sends a query for the \u003Cspan class=\"strong strong\">\u003Cstrong>nonexistent.test.example.\u003C/strong>\u003C/span> DNS name, BIND detects that the IdM server is authoritative for the \u003Cspan class=\"strong strong\">\u003Cstrong>test.example.\u003C/strong>\u003C/span> zone and does not forward the query to the \u003Cspan class=\"strong strong\">\u003Cstrong>192.0.2.254.\u003C/strong>\u003C/span> server. As a result, the DNS client receives the \u003Ccode class=\"literal\">NXDomain\u003C/code> error message, informing the user that the queried domain does not exist.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-ensure-that-the-forward-first-policy-is-set-in-idm-dns-global-configuration_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.6. Using an Ansible playbook to ensure that the forward first policy is set in IdM DNS global configuration\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that global forwarding policy in IdM DNS is set to \u003Cspan class=\"strong strong\">\u003Cstrong>forward first\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you use the \u003Cspan class=\"strong strong\">\u003Cstrong>forward first\u003C/strong>\u003C/span> DNS forwarding policy, DNS queries are forwarded to the configured forwarder. If a query fails because of a server error or timeout, BIND falls back to the recursive resolution using servers on the Internet. The forward first policy is the default policy. It is suitable for traffic optimization.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM environment contains an integrated DNS server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>set-configuration.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp set-configuration.yml set-forward-policy-to-first.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>set-forward-policy-to-first.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">forward_policy\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>first\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDelete all the other lines of the original playbook that are irrelevant. This is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to set global forwarding policy to first\n  hosts: ipaserver\n  become: true\n\n  tasks:\n  - name: Set global forwarding policy to first.\n    ipadnsconfig:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      forward_policy: first\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file set-forward-policy-to-first.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.5. DNS forward policies in IdM\">DNS forward policies in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more sample playbooks, see the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-ensure-that-global-forwarders-are-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.7. Using an Ansible playbook to ensure that global forwarders are disabled in IdM DNS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that global forwarders are disabled in IdM DNS. The disabling is done by setting the \u003Ccode class=\"literal\">forward_policy\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>none\u003C/strong>\u003C/span>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tDisabling global forwarders causes DNS queries not to be forwarded. Disabling forwarding is only useful as a zone-specific override for global forwarding configuration. This option is the IdM equivalent of specifying an empty list of forwarders in BIND configuration.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM environment contains an integrated DNS server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>disable-global-forwarders.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp disable-global-forwarders.yml disable-global-forwarders-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>disable-global-forwarders-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">forward_policy\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>none\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to disable global DNS forwarders\n  hosts: ipaserver\n  become: true\n\n  tasks:\n  - name: Disable global forwarders.\n    ipadnsconfig:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      forward_policy: none\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file disable-global-forwarders-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.5. DNS forward policies in IdM\">DNS forward policies in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-ensure-that-synchronization-of-forward-and-reverse-lookup-zones-is-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">27.8. Using an Ansible playbook to ensure that synchronization of forward and reverse lookup zones is disabled in IdM DNS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that forward and reverse lookup zones are not synchronized in IdM DNS.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM environment contains an integrated DNS server.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>disallow-reverse-sync.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp disallow-reverse-sync.yml disallow-reverse-sync-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>disallow-reverse-sync-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">allow_sync_ptr\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>no\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to disallow reverse record synchronization\n  hosts: ipaserver\n  become: true\n\n  tasks:\n  - name: Disallow reverse record synchronization.\n    ipadnsconfig:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      allow_sync_ptr: no\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file disallow-reverse-sync-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tFor more sample playbooks, see the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 28. Using Ansible playbooks to manage IdM DNS zones\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAs Identity Management (IdM) administrator, you can manage how IdM DNS zones work using the \u003Ccode class=\"literal\">dnszone\u003C/code> module available in the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#supported-dns-zone-types_using-ansible-playbooks-to-manage-idm-dns-zones\" title=\"28.1. Supported DNS zone types\">What DNS zone types are supported in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones\" title=\"28.2. Configuration attributes of primary IdM DNS zones\">What DNS attributes you can configure in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-create-a-primary-zone-in-idm-dns_using-ansible-playbooks-to-manage-idm-dns-zones\" title=\"28.3. Using Ansible to create a primary zone in IdM DNS\">How to use an Ansible playbook to create a primary zone in IdM DNS\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-an-ansible-playbook-to-ensure-the-presence-of-a-primary-dns-zone-in-idm-with-multiple-variables_using-ansible-playbooks-to-manage-idm-dns-zones\" title=\"28.4. Using an Ansible playbook to ensure the presence of a primary DNS zone in IdM with multiple variables\">How to use an Ansible playbook to ensure the presence of a primary IdM DNS zone with multiple variables\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-an-ansible-playbook-to-ensure-the-presence-of-a-zone-for-reverse-dns-lookup-when-an-ip-address-is-given_using-ansible-playbooks-to-manage-idm-dns-zones\" title=\"28.5. Using an Ansible playbook to ensure the presence of a zone for reverse DNS lookup when an IP address is given\">How to use an Ansible playbook to ensure the presence of a zone for reverse DNS lookup when an IP address is given\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tDNS service is installed on the IdM server. For more information about how to use Red Hat Ansible Engine to install an IdM server with integrated DNS, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/installing_identity_management/index#installing-an-Identity-Management-server-using-an-Ansible-playbook_installing-identity-management\">Installing an Identity Management server using an Ansible playbook\u003C/a>.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"supported-dns-zone-types_using-ansible-playbooks-to-manage-idm-dns-zones\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.1. Supported DNS zone types\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdentity Management (IdM) supports two types of DNS zones: \u003Cspan class=\"emphasis\">\u003Cem>primary\u003C/em>\u003C/span> and \u003Cspan class=\"emphasis\">\u003Cem>forward\u003C/em>\u003C/span> zones. These two types of zones are described here, including an example scenario for DNS forwarding.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tThis guide uses the BIND terminology for zone types which is different from the terminology used for Microsoft Windows DNS. Primary zones in BIND serve the same purpose as \u003Cspan class=\"emphasis\">\u003Cem>forward lookup zones\u003C/em>\u003C/span> and \u003Cspan class=\"emphasis\">\u003Cem>reverse lookup zones\u003C/em>\u003C/span> in Microsoft Windows DNS. Forward zones in BIND serve the same purpose as \u003Cspan class=\"emphasis\">\u003Cem>conditional forwarders\u003C/em>\u003C/span> in Microsoft Windows DNS.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Primary DNS zones\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tPrimary DNS zones contain authoritative DNS data and can accept dynamic DNS updates. This behavior is equivalent to the \u003Ccode class=\"literal option\">type master\u003C/code> setting in standard BIND configuration. You can manage primary zones using the \u003Ccode class=\"literal command\">ipa dnszone-*\u003C/code> commands.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn compliance with standard DNS rules, every primary zone must contain \u003Ccode class=\"literal\">start of authority\u003C/code> (SOA) and \u003Ccode class=\"literal\">nameserver\u003C/code> (NS) records. IdM generates these records automatically when the DNS zone is created, but you must copy the NS records manually to the parent zone to create proper delegation.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIn accordance with standard BIND behavior, queries for names for which the server is not authoritative are forwarded to other DNS servers. These DNS servers, so called forwarders, may or may not be authoritative for the query.\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"example\" id=\"idm140464215546384\">\u003Cp class=\"title\">\u003Cstrong>Example 28.1. Example scenario for DNS forwarding\u003C/strong>\u003C/p>\u003Cdiv class=\"example-contents\">\u003Cp>\n\t\t\t\t\t\t\t\tThe IdM server contains the \u003Ccode class=\"literal\">test.example.\u003C/code> primary zone. This zone contains an NS delegation record for the \u003Ccode class=\"literal\">sub.test.example.\u003C/code> name. In addition, the \u003Ccode class=\"literal\">test.example.\u003C/code> zone is configured with the \u003Ccode class=\"literal\">192.0.2.254\u003C/code> forwarder IP address for the \u003Ccode class=\"literal\">sub.text.example\u003C/code> subzone.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\tA client querying the name \u003Ccode class=\"literal\">nonexistent.test.example.\u003C/code> receives the \u003Ccode class=\"literal\">NXDomain\u003C/code> answer, and no forwarding occurs because the IdM server is authoritative for this name.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\t\t\t\tOn the other hand, querying for the \u003Ccode class=\"literal\">host1.sub.test.example.\u003C/code> name is forwarded to the configured forwarder \u003Ccode class=\"literal\">192.0.2.254\u003C/code> because the IdM server is not authoritative for this name.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/div>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Forward DNS zones\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFrom the perspective of IdM, forward DNS zones do not contain any authoritative data. In fact, a forward \"zone\" usually only contains two pieces of information:\n\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tA domain name\n\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\tThe IP address of a DNS server associated with the domain\n\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tAll queries for names belonging to the domain defined are forwarded to the specified IP address. This behavior is equivalent to the \u003Ccode class=\"literal\">type forward\u003C/code> setting in standard BIND configuration. You can manage forward zones using the \u003Ccode class=\"literal command\">ipa dnsforwardzone-*\u003C/code> commands.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tForward DNS zones are especially useful in the context of IdM-Active Directory (AD) trusts. If the IdM DNS server is authoritative for the \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> zone and the AD DNS server is authoritative for the \u003Cspan class=\"strong strong\">\u003Cstrong>ad.example.com\u003C/strong>\u003C/span> zone, then \u003Cspan class=\"strong strong\">\u003Cstrong>ad.example.com\u003C/strong>\u003C/span> is a DNS forward zone for the \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> primary zone. That means that when a query comes from an IdM client for the IP address of \u003Cspan class=\"strong strong\">\u003Cstrong>somehost.ad.example.com\u003C/strong>\u003C/span>, the query is forwarded to an AD domain controller specified in the \u003Cspan class=\"strong strong\">\u003Cstrong>ad.example.com\u003C/strong>\u003C/span> IdM DNS forward zone.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.2. Configuration attributes of primary IdM DNS zones\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdentity Management (IdM) creates a new zone with certain default configuration, such as the refresh periods, transfer settings, or cache settings. In \u003Ca class=\"link\" href=\"#tab_idm-dns-zone-attributes_using-ansible-playbooks-to-manage-idm-dns-zones\" title=\"Table 28.1. IdM DNS zone attributes\">IdM DNS zone attributes\u003C/a>, you can find the attributes of the default zone configuration that you can modify using one of the following options:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">dnszone-mod\u003C/code> command in the command-line interface (CLI). For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#editing-the-configuration-of-a-primary-dns-zone-in-idm-cli_managing-dns-zones-in-idm\">Editing the configuration of a primary DNS zone in IdM CLI\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM Web UI. For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#editing-the-configuration-of-a-primary-dns-zone-in-idm-web-ui_managing-dns-zones-in-idm\">Editing the configuration of a primary DNS zone in IdM Web UI\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn Ansible playbook that uses the \u003Ccode class=\"literal\">ipadnszone\u003C/code> module. For more information, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management\">Managing DNS zones in IdM\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tAlong with setting the actual information for the zone, the settings define how the DNS server handles the \u003Cspan class=\"emphasis\">\u003Cem>start of authority\u003C/em>\u003C/span> (SOA) record entries and how it updates its records from the DNS name server.\n\t\t\t\u003C/p>\u003Crh-table id=\"tab_idm-dns-zone-attributes_using-ansible-playbooks-to-manage-idm-dns-zones\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 28.1. IdM DNS zone attributes\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 60%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214144448\" scope=\"col\">Attribute\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214143360\" scope=\"col\">ansible-freeipa variable\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214142304\" scope=\"col\">Description\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tAuthoritative name server\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">name_server\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the domain name of the primary DNS name server, also known as SOA MNAME.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tBy default, each IdM server advertises itself in the SOA MNAME field. Consequently, the value stored in LDAP using \u003Ccode class=\"literal option\">--name-server\u003C/code> is ignored.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tAdministrator e-mail address\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">admin_email\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the email address to use for the zone administrator. This defaults to the root account on the host.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tSOA serial\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">serial\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets a serial number in the SOA record. Note that IdM sets the version number automatically and users are not expected to modify it.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tSOA refresh\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">refresh\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the interval, in seconds, for a secondary DNS server to wait before requesting updates from the primary DNS server.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tSOA retry\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">retry\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the time, in seconds, to wait before retrying a failed refresh operation.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tSOA expire\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">expire\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the time, in seconds, that a secondary DNS server will try to perform a refresh update before ending the operation attempt.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tSOA minimum\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">minimum\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the time to live (TTL) value in seconds for negative caching according to \u003Ca class=\"link\" href=\"http://tools.ietf.org/html/rfc2308\">RFC 2308\u003C/a>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tSOA time to live\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">ttl\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets TTL in seconds for records at zone apex. In zone \u003Ccode class=\"literal\">example.com\u003C/code>, for example, all records (A, NS, or SOA) under name \u003Ccode class=\"literal\">example.com\u003C/code> are configured, but no other domain names, like \u003Ccode class=\"literal\">test.example.com\u003C/code>, are affected.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tDefault time to live\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">default_ttl\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the default time to live (TTL) value in seconds for negative caching for all values in a zone that never had an individual TTL value set before. Requires a restart of the \u003Ccode class=\"literal\">named-pkcs11\u003C/code> service on all IdM DNS servers after changes to take effect.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tBIND update policy\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">update_policy\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the permissions allowed to clients in the DNS zone.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tDynamic update\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">dynamic_update\u003C/code>=TRUE|FALSE\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tEnables dynamic updates to DNS records for clients.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tNote that if this is set to false, IdM client machines will not be able to add or update their IP address.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tAllow transfer\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">allow_transfer\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>string\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives a list of IP addresses or network names which are allowed to transfer the given zone, separated by semicolons (;).\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tZone transfers are disabled by default. The default \u003Ccode class=\"literal option\">allow_transfer\u003C/code> value is \u003Ccode class=\"literal\">none\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tAllow query\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">allow_query\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives a list of IP addresses or network names which are allowed to issue DNS queries, separated by semicolons (;).\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tAllow PTR sync\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">allow_sync_ptr\u003C/code>=1|0\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets whether A or AAAA records (forward records) for the zone will be automatically synchronized with the PTR (reverse) records.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tZone forwarders\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">forwarder\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>IP_address\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSpecifies a forwarder specifically configured for the DNS zone. This is separate from any global forwarders used in the IdM domain.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003Cp>\n\t\t\t\t\t\t\t\tTo specify multiple forwarders, use the option multiple times.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214144448\"> \u003Cp>\n\t\t\t\t\t\t\t\tForward policy\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214143360\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">forward_policy\u003C/code>=none|only|first\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214142304\"> \u003Cp>\n\t\t\t\t\t\t\t\tSpecifies the forward policy. For information about the supported policies, see \u003Ca class=\"link\" href=\"#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.5. DNS forward policies in IdM\">DNS forward policies in IdM\u003C/a>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-dnszone.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-create-a-primary-zone-in-idm-dns_using-ansible-playbooks-to-manage-idm-dns-zones\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.3. Using Ansible to create a primary zone in IdM DNS\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that a primary DNS zone exists. In the example used in the procedure below, you ensure the presence of the \u003Cspan class=\"strong strong\">\u003Cstrong>zone.idm.example.com\u003C/strong>\u003C/span> DNS zone.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>dnszone-present.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp dnszone-present.yml dnszone-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>dnszone-present-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnszone\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">zone_name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>zone.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Ensure dnszone present\n  hosts: ipaserver\n  become: true\n\n  tasks:\n  - name: Ensure zone is present.\n    ipadnszone:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      zone_name: zone.idm.example.com\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file dnszone-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#supported-dns-zone-types_managing-dns-zones-in-idm\">Supported DNS zone types\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnszone.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-ensure-the-presence-of-a-primary-dns-zone-in-idm-with-multiple-variables_using-ansible-playbooks-to-manage-idm-dns-zones\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.4. Using an Ansible playbook to ensure the presence of a primary DNS zone in IdM with multiple variables\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that a primary DNS zone exists. In the example used in the procedure below, an IdM administrator ensures the presence of the \u003Cspan class=\"strong strong\">\u003Cstrong>zone.idm.example.com\u003C/strong>\u003C/span> DNS zone. The Ansible playbook configures multiple parameters of the zone.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>dnszone-all-params.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp dnszone-all-params.yml dnszone-all-params-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>dnszone-all-params-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnszone\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">zone_name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>zone.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">allow_sync_ptr\u003C/code> variable to true if you want to allow the synchronization of forward and reverse records, that is the synchronization of A and AAAA records with PTR records.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">dynamic_update\u003C/code> variable to true to enable IdM client machines to add or update their IP addresses.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">dnssec\u003C/code> variable to true to allow inline DNSSEC signing of records in the zone.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">allow_transfer\u003C/code> variable to the IP addresses of secondary name servers in the zone.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">allow_query\u003C/code> variable to the IP addresses or networks that are allowed to issue queries.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">forwarders\u003C/code> variable to the IP addresses of global forwarders.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">serial\u003C/code> variable to the SOA record serial number.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tDefine the \u003Ccode class=\"literal\">refresh\u003C/code>, \u003Ccode class=\"literal\">retry\u003C/code>, \u003Ccode class=\"literal\">expire\u003C/code>, \u003Ccode class=\"literal\">minimum\u003C/code>, \u003Ccode class=\"literal\">ttl\u003C/code>, and \u003Ccode class=\"literal\">default_ttl\u003C/code> values for DNS records in the zone.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tDefine the NSEC3PARAM record for the zone using the \u003Ccode class=\"literal\">nsec3param_rec\u003C/code> variable.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">skip_overlap_check\u003C/code> variable to true to force DNS creation even if it overlaps with an existing zone.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">skip_nameserver_check\u003C/code> to true to force DNS zone creation even if the nameserver is not resolvable.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Ensure dnszone present\n  hosts: ipaserver\n  become: true\n\n  tasks:\n  - name: Ensure zone is present.\n    ipadnszone:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      zone_name: zone.idm.example.com\n      allow_sync_ptr: true\n      dynamic_update: true\n      dnssec: true\n      allow_transfer:\n        - 1.1.1.1\n        - 2.2.2.2\n      allow_query:\n        - 1.1.1.1\n        - 2.2.2.2\n      forwarders:\n        - ip_address: 8.8.8.8\n        - ip_address: 8.8.4.4\n          port: 52\n      serial: 1234\n      refresh: 3600\n      retry: 900\n      expire: 1209600\n      minimum: 3600\n      ttl: 60\n      default_ttl: 90\n      name_server: server.idm.example.com.\n      admin_email: admin.admin@idm.example.com\n      nsec3param_rec: \"1 7 100 0123456789abcdef\"\n      skip_overlap_check: true\n      skip_nameserver_check: true\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file dnszone-all-params-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#supported-dns-zone-types_managing-dns-zones-in-idm\">Supported DNS zone types\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee \u003Ca class=\"link\" href=\"#configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones\" title=\"28.2. Configuration attributes of primary IdM DNS zones\">Configuration attributes of primary IdM DNS zones\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-dnszone.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee sample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-an-ansible-playbook-to-ensure-the-presence-of-a-zone-for-reverse-dns-lookup-when-an-ip-address-is-given_using-ansible-playbooks-to-manage-idm-dns-zones\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">28.5. Using an Ansible playbook to ensure the presence of a zone for reverse DNS lookup when an IP address is given\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that a reverse DNS zone exists. In the example used in the procedure below, an IdM administrator ensures the presence of a reverse DNS lookup zone using the IP address and prefix length of an IdM host.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tProviding the prefix length of the IP address of your DNS server using the \u003Ccode class=\"literal\">name_from_ip\u003C/code> variable allows you to control the zone name. If you do not state the prefix length, the system queries DNS servers for zones and, based on the \u003Ccode class=\"literal\">name_from_ip\u003C/code> value of \u003Cspan class=\"strong strong\">\u003Cstrong>192.168.1.2\u003C/strong>\u003C/span>, the query can return any of the following DNS zones:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>1.168.192.in-addr.arpa.\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>168.192.in-addr.arpa.\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>192.in-addr.arpa.\u003C/strong>\u003C/span>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tBecause the zone returned by the query might not be what you expect, \u003Ccode class=\"literal\">name_from_ip\u003C/code> can only be used with the \u003Ccode class=\"literal\">state\u003C/code> option set to \u003Cspan class=\"strong strong\">\u003Cstrong>present\u003C/strong>\u003C/span> to prevent accidental removals of zones.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>dnszone-reverse-from-ip.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp dnszone-reverse-from-ip.yml dnszone-reverse-from-ip-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>dnszone-reverse-from-ip-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnszone\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name_from_ip\u003C/code> variable to the IP of your IdM nameserver, and provide its prefix length.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Ensure dnszone present\n  hosts: ipaserver\n  become: true\n\n  tasks:\n  - name: Ensure zone for reverse DNS lookup is present.\n    ipadnszone:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name_from_ip: 192.168.1.2/24\n      state: present\n    register: result\n  - name: Display inferred zone name.\n    debug:\n      msg: \"Zone name: {{ result.dnszone.name }}\"\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe playbook creates a zone for reverse DNS lookup from the \u003Cspan class=\"strong strong\">\u003Cstrong>192.168.1.2\u003C/strong>\u003C/span> IP address and its prefix length of 24. Next, the playbook displays the resulting zone name.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file dnszone-reverse-from-ip-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-zones-in-idm_working-with-dns-in-identity-management#supported-dns-zone-types_managing-dns-zones-in-idm\">Supported DNS zone types\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnszone.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnszone\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 29. Using Ansible to manage DNS locations in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAs Identity Management (IdM) administrator, you can manage IdM DNS locations using the \u003Ccode class=\"literal\">location\u003C/code> module available in the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package.\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#dns-based-service-discovery_using-ansible-to-manage-dns-locations-in-idm\" title=\"29.1. DNS-based service discovery\">DNS-based service discovery\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm\" title=\"29.2. Deployment considerations for DNS locations\">Deployment considerations for DNS locations\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#dns-time-to-live-ttl_using-ansible-to-manage-dns-locations-in-idm\" title=\"29.3. DNS time to live (TTL)\">DNS time to live (TTL)\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm\" title=\"29.4. Using Ansible to ensure an IdM location is present\">Using Ansible to ensure an IdM location is present\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-ensure-an-idm-location-is-absent_using-ansible-to-manage-dns-locations-in-idm\" title=\"29.5. Using Ansible to ensure an IdM location is absent\">Using Ansible to ensure an IdM location is absent\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"dns-based-service-discovery_using-ansible-to-manage-dns-locations-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.1. DNS-based service discovery\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tDNS-based service discovery is a process in which a client uses the DNS protocol to locate servers in a network that offer a specific service, such as \u003Ccode class=\"literal\">LDAP\u003C/code> or \u003Ccode class=\"literal\">Kerberos\u003C/code>. One typical type of operation is to allow clients to locate authentication servers within the closest network infrastructure, because they provide a higher throughput and lower network latency, lowering overall costs.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe major advantages of service discovery are:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo need for clients to be explicitly configured with names of nearby servers.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tDNS servers are used as central providers of policy. Clients using the same DNS server have access to the same policy about service providers and their preferred order.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIn an Identity Management (IdM) domain, DNS service records (SRV records) exist for \u003Ccode class=\"literal\">LDAP\u003C/code>, \u003Ccode class=\"literal\">Kerberos\u003C/code>, and other services. For example, the following command queries the DNS server for hosts providing a TCP-based \u003Ccode class=\"literal\">Kerberos\u003C/code> service in an IdM DNS domain:\n\t\t\t\u003C/p>\u003Cdiv class=\"example\" id=\"idm140464213974752\">\u003Cp class=\"title\">\u003Cstrong>Example 29.1. DNS location independent results\u003C/strong>\u003C/p>\u003Cdiv class=\"example-contents\">\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>dig -t SRV +short _kerberos._tcp.idm.example.com\u003C/strong>\u003C/span>\n0 100 88 idmserver-01.idm.example.com.\n0 100 88 idmserver-02.idm.example.com.\u003C/pre>\u003Cp>\n\t\t\t\t\tThe output contains the following information:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">0\u003C/code> (priority): Priority of the target host. A lower value is preferred.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">100\u003C/code> (weight). Specifies a relative weight for entries with the same priority. For further information, see \u003Ca class=\"link\" href=\"https://tools.ietf.org/html/rfc2782#page-3\">RFC 2782, section 3\u003C/a>.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">88\u003C/code> (port number): Port number of the service.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tCanonical name of the host providing the service.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIn the example, the two host names returned have the same priority and weight. In this case, the client uses a random entry from the result list.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWhen the client is, instead, configured to query a DNS server that is configured in a DNS location, the output differs. For IdM servers that are assigned to a location, tailored values are returned. In the example below, the client is configured to query a DNS server in the location \u003Ccode class=\"literal\">germany\u003C/code>:\n\t\t\t\u003C/p>\u003Cdiv class=\"example\" id=\"idm140464213962096\">\u003Cp class=\"title\">\u003Cstrong>Example 29.2. DNS location-based results\u003C/strong>\u003C/p>\u003Cdiv class=\"example-contents\">\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>dig -t SRV +short _kerberos._tcp.idm.example.com\u003C/strong>\u003C/span>\n_kerberos._tcp.germany._locations.idm.example.com.\n0 100 88 idmserver-01.idm.example.com.\n50 100 88 idmserver-02.idm.example.com.\u003C/pre>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tThe IdM DNS server automatically returns a DNS alias (CNAME) pointing to a DNS location specific SRV record which prefers local servers. This CNAME record is shown in the first line of the output. In the example, the host \u003Cspan class=\"strong strong\">\u003Cstrong>idmserver-01.idm.example.com\u003C/strong>\u003C/span> has the lowest priority value and is therefore preferred. The \u003Cspan class=\"strong strong\">\u003Cstrong>idmserver-02.idm.example.com\u003C/strong>\u003C/span> has a higher priority and thus is used only as backup for cases when the preferred host is unavailable.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.2. Deployment considerations for DNS locations\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdentity Management (IdM) can generate location-specific service (SRV) records when using the integrated DNS. Because each IdM DNS server generates location-specific SRV records, you have to install at least one IdM DNS server in each DNS location.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe client’s affinity to a DNS location is only defined by the DNS records received by the client. For this reason, you can combine IdM DNS servers with non-IdM DNS consumer servers and recursors if the clients doing DNS service discovery resolve location-specific records from IdM DNS servers.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn the majority of deployments with mixed IdM and non-IdM DNS services, DNS recursors select the closest IdM DNS server automatically by using round-trip time metrics. Typically, this ensures that clients using non-IdM DNS servers are getting records for the nearest DNS location and thus use the optimal set of IdM servers.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"dns-time-to-live-ttl_using-ansible-to-manage-dns-locations-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.3. DNS time to live (TTL)\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tClients can cache DNS resource records for an amount of time that is set in the zone’s configuration. Because of this caching, a client might not be able to receive the changes until the time to live (TTL) value expires. The default TTL value in Identity Management (IdM) is \u003Ccode class=\"literal\">1 day\u003C/code>.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf your client computers roam between sites, you should adapt the TTL value for your IdM DNS zone. Set the value to a lower value than the time clients need to roam between sites. This ensures that cached DNS entries on the client expire before they reconnect to another site and thus query the DNS server to refresh location-specific SRV records.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_working-with-dns-in-identity-management#configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones\">Configuration attributes of primary IdM DNS zones\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.4. Using Ansible to ensure an IdM location is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can configure IdM DNS locations to allow clients to locate authentication servers within the closest network infrastructure.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure a DNS location is present in IdM. The example describes how to ensure that the \u003Cspan class=\"strong strong\">\u003Cstrong>germany\u003C/strong>\u003C/span> DNS location is present in IdM. As a result, you can assign particular IdM servers to this location so that local IdM clients can use them to reduce server response time.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou understand the \u003Ca class=\"link\" href=\"#deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm\" title=\"29.2. Deployment considerations for DNS locations\">deployment considerations for DNS locations\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">location-present.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/location/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/location/location-present.yml location-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">location-present-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipalocation\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the location.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: location present example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure that the \"germany\" location is present\u003C/strong>\u003C/span>\n    ipalocation:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: germany\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory location-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-locations-in-idm_working-with-dns-in-identity-management#assigning-an-idm-server-to-a-dns-location-using-the-idm-web-ui_managing-dns-locations-in-idm\">Assigning an IdM server to a DNS location using the IdM Web UI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-locations-in-idm_working-with-dns-in-identity-management#assigning-an-idm-server-to-a-dns-location-using-the-idm-cli_managing-dns-locations-in-idm\">Assigning an IdM server to a DNS location using the IdM CLI\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-an-idm-location-is-absent_using-ansible-to-manage-dns-locations-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.5. Using Ansible to ensure an IdM location is absent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs a system administrator of Identity Management (IdM), you can configure IdM DNS locations to allow clients to locate authentication servers within the closest network infrastructure.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe following procedure describes how to use an Ansible playbook to ensure that a DNS location is absent in IdM. The example describes how to ensure that the \u003Cspan class=\"strong strong\">\u003Cstrong>germany\u003C/strong>\u003C/span> DNS location is absent in IdM. As a result, you cannot assign particular IdM servers to this location and local IdM clients cannot use them.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo IdM server is assigned to the \u003Cspan class=\"strong strong\">\u003Cstrong>germany\u003C/strong>\u003C/span> DNS location.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe example assumes that you have \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">created and configured\u003C/a> the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory as a central location to store copies of sample playbooks.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">location-absent.yml\u003C/code> file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/location/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/location/location-absent.yml location-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">location-absent-copy.yml\u003C/code> Ansible playbook file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipalocation\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tAdapt the \u003Ccode class=\"literal\">name\u003C/code> of the task to correspond to your use case.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM administrator.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to the name of the DNS location.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tMake sure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: location absent example\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>name: Ensure that the \"germany\" location is absent\u003C/strong>\u003C/span>\n    ipalocation:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: germany\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: absent\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory location-absent-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section _additional-resources\" id=\"additional_resources_8\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">29.6. Additional resources\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-location.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee sample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/location\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 30. Managing DNS forwarding in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tFollow these procedures to configure DNS global forwarders and DNS forward zones in the Identity Management (IdM) Web UI, the IdM CLI, and using Ansible:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#the-two-roles-of-an-idm-dns-server_managing-dns-forwarding-in-idm\" title=\"30.1. The two roles of an IdM DNS server\">The two roles of an IdM DNS server\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#dns-forward-policies-in-idm_managing-dns-forwarding-in-idm\" title=\"30.2. DNS forward policies in IdM\">DNS forward policies in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#adding-a-global-forwarder-in-the-idm-web-ui_managing-dns-forwarding-in-idm\" title=\"30.3. Adding a global forwarder in the IdM Web UI\">Adding a global forwarder in the IdM Web UI\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#adding-a-global-forwarder-in-the-cli_managing-dns-forwarding-in-idm\" title=\"30.4. Adding a global forwarder in the CLI\">Adding a global forwarder in the CLI\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#adding-a-dns-forward-zone-in-the-idm-web-ui_managing-dns-forwarding-in-idm\" title=\"30.5. Adding a DNS Forward Zone in the IdM Web UI\">Adding a DNS Forward Zone in the IdM Web UI\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#adding-a-dns-forward-zone-in-the-cli_managing-dns-forwarding-in-idm\" title=\"30.6. Adding a DNS Forward Zone in the CLI\">Adding a DNS Forward Zone in the CLI\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#establishing-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm\" title=\"30.7. Establishing a DNS Global Forwarder in IdM using Ansible\">Establishing a DNS Global Forwarder in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm\" title=\"30.8. Ensuring the presence of a DNS global forwarder in IdM using Ansible\">Ensuring the presence of a DNS global forwarder in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm\" title=\"30.9. Ensuring the absence of a DNS global forwarder in IdM using Ansible\">Ensuring the absence of a DNS global forwarder in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-dns-global-forwarders-are-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm\" title=\"30.10. Ensuring DNS Global Forwarders are disabled in IdM using Ansible\">Ensuring DNS Global Forwarders are disabled in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm\" title=\"30.11. Ensuring the presence of a DNS Forward Zone in IdM using Ansible\">Ensuring the presence of a DNS Forward Zone in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-a-dns-forward-zone-has-multiple-forwarders-in-idm-using-ansible_managing-dns-forwarding-in-idm\" title=\"30.12. Ensuring a DNS Forward Zone has multiple forwarders in IdM using Ansible\">Ensuring a DNS Forward Zone has multiple forwarders in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-a-dns-forward-zone-is-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm\" title=\"30.13. Ensuring a DNS Forward Zone is disabled in IdM using Ansible\">Ensuring a DNS Forward Zone is disabled in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-absence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm\" title=\"30.14. Ensuring the absence of a DNS Forward Zone in IdM using Ansible\">Ensuring the absence of a DNS Forward Zone in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"the-two-roles-of-an-idm-dns-server_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.1. The two roles of an IdM DNS server\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tDNS forwarding affects how a DNS service answers DNS queries. By default, the Berkeley Internet Name Domain (BIND) service integrated with IdM acts as both an \u003Cspan class=\"emphasis\">\u003Cem>authoritative\u003C/em>\u003C/span> and a \u003Cspan class=\"emphasis\">\u003Cem>recursive\u003C/em>\u003C/span> DNS server:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Authoritative DNS server\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tWhen a DNS client queries a name belonging to a DNS zone for which the IdM server is authoritative, BIND replies with data contained in the configured zone. Authoritative data always takes precedence over any other data.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Recursive DNS server\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tWhen a DNS client queries a name for which the IdM server is not authoritative, BIND attempts to resolve the query using other DNS servers. If forwarders are not defined, BIND asks the root servers on the Internet and uses a recursive resolution algorithm to answer the DNS query.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tIn some cases, it is not desirable to let BIND contact other DNS servers directly and perform the recursion based on data available on the Internet. You can configure BIND to use another DNS server, a \u003Cspan class=\"emphasis\">\u003Cem>forwarder\u003C/em>\u003C/span>, to resolve the query.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tWhen you configure BIND to use a forwarder, queries and answers are forwarded back and forth between the IdM server and the forwarder, and the IdM server acts as the DNS cache for non-authoritative data.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"dns-forward-policies-in-idm_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.2. DNS forward policies in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdM supports the \u003Ccode class=\"literal\">first\u003C/code> and \u003Ccode class=\"literal\">only\u003C/code> standard BIND forward policies, as well as the \u003Ccode class=\"literal\">none\u003C/code> IdM-specific forward policy.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Forward first \u003Cspan class=\"emphasis\">\u003Cem>(default)\u003C/em>\u003C/span>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe IdM BIND service forwards DNS queries to the configured forwarder. If a query fails because of a server error or timeout, BIND falls back to the recursive resolution using servers on the Internet. The \u003Ccode class=\"literal\">forward first\u003C/code> policy is the default policy, and it is suitable for optimizing DNS traffic.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Forward only\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe IdM BIND service forwards DNS queries to the configured forwarder. If a query fails because of a server error or timeout, BIND returns an error to the client. The \u003Ccode class=\"literal\">forward only\u003C/code> policy is recommended for environments with split DNS configuration.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">None \u003Cspan class=\"emphasis\">\u003Cem>(forwarding disabled)\u003C/em>\u003C/span>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tDNS queries are not forwarded with the \u003Ccode class=\"literal\">none\u003C/code> forwarding policy. Disabling forwarding is only useful as a zone-specific override for global forwarding configuration. This option is the IdM equivalent of specifying an empty list of forwarders in BIND configuration.\n\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tYou cannot use forwarding to combine data in IdM with data from other DNS servers. You can only forward queries for specific subzones of the primary zone in IdM DNS.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tBy default, the BIND service does not forward queries to another server if the queried DNS name belongs to a zone for which the IdM server is authoritative. In such a situation, if the queried DNS name cannot be found in the IdM database, the \u003Ccode class=\"literal\">NXDOMAIN\u003C/code> answer is returned. Forwarding is not used.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"example\" id=\"idm140464212100368\">\u003Cp class=\"title\">\u003Cstrong>Example 30.1. Example Scenario\u003C/strong>\u003C/p>\u003Cdiv class=\"example-contents\">\u003Cp>\n\t\t\t\t\tThe IdM server is authoritative for the \u003Cspan class=\"strong strong\">\u003Cstrong>test.example.\u003C/strong>\u003C/span> DNS zone. BIND is configured to forward queries to the DNS server with the \u003Cspan class=\"strong strong\">\u003Cstrong>192.0.2.254\u003C/strong>\u003C/span> IP address.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tWhen a client sends a query for the \u003Cspan class=\"strong strong\">\u003Cstrong>nonexistent.test.example.\u003C/strong>\u003C/span> DNS name, BIND detects that the IdM server is authoritative for the \u003Cspan class=\"strong strong\">\u003Cstrong>test.example.\u003C/strong>\u003C/span> zone and does not forward the query to the \u003Cspan class=\"strong strong\">\u003Cstrong>192.0.2.254.\u003C/strong>\u003C/span> server. As a result, the DNS client receives the \u003Ccode class=\"literal\">NXDomain\u003C/code> error message, informing the user that the queried domain does not exist.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-global-forwarder-in-the-idm-web-ui_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.3. Adding a global forwarder in the IdM Web UI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to add a global DNS forwarder in the Identity Management (IdM) Web UI.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the IdM WebUI as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the Internet Protocol (IP) address of the DNS server to forward queries to.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the IdM Web UI, select \u003Ccode class=\"literal\">Network Services\u003C/code> → \u003Ccode class=\"literal\">DNS Global Configuration\u003C/code> → \u003Ccode class=\"literal\">DNS\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/0672144496a40ee794aee64884827619/idm-dns-global-add1.png\" alt=\"Selecting DNS Forward Zones from the DNS menu\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">DNS Global Configuration\u003C/code> section, click \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/5821348c67bda05b3fa201fe4c2056a8/idm-dns-global-add2.png\" alt=\"Selecting the Add button\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSpecify the IP address of the DNS server that will receive forwarded DNS queries.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/661adad2f2da35fb1932817eaa627133/idm-dns-global-add3.png\" alt=\"Entering the IP address of the global forwarder\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSelect the \u003Ccode class=\"literal\">Forward policy\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/5be40c86c82d7e08ae20a483530331ff/idm-dns-global-add4.png\" alt=\"Selecting the DNS forward policy and saving the DNS global configuration\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Save\u003C/code> at the top of the window.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSelect \u003Ccode class=\"literal\">Network Services\u003C/code> → \u003Ccode class=\"literal\">DNS Global Configuration\u003C/code> → \u003Ccode class=\"literal\">DNS\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/0672144496a40ee794aee64884827619/idm-dns-global-add1.png\" alt=\"Selecting DNS Global Configuration in IdM Web UI\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the global forwarder, with the forward policy you specified, is present and enabled in the IdM Web UI.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/671900ea29ba18303502fabeb5b6d555/idm-dns-global-add5.png\" alt=\"Verifying the presence of the global forwarder\"/>\u003C/div>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-global-forwarder-in-the-cli_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.4. Adding a global forwarder in the CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to add a global DNS forwarder by using the command line interface (CLI).\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the Internet Protocol (IP) address of the DNS server to forward queries to.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipa dnsconfig-mod\u003C/code> command to add a new global forwarder. Specify the IP address of the DNS forwarder with the \u003Ccode class=\"literal\">--forwarder\u003C/code> option.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa dnsconfig-mod --forwarder=\u003Cspan class=\"emphasis\">\u003Cem>10.10.0.1\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\nServer will check DNS forwarder(s).\nThis may take some time, please wait ...\n  Global forwarders: 10.10.0.1\n  IPA DNS servers: server.example.com\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">dnsconfig-show\u003C/code> command to display global forwarders.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ ipa dnsconfig-show\n  Global forwarders: 10.10.0.1\n  IPA DNS servers: server.example.com\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-dns-forward-zone-in-the-idm-web-ui_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.5. Adding a DNS Forward Zone in the IdM Web UI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to add a DNS forward zone in the Identity Management (IdM) Web UI.\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not use forward zones unless absolutely required. Forward zones are not a standard solution, and using them can lead to unexpected and problematic behavior. If you must use forward zones, limit their use to overriding a global forwarding configuration.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tWhen creating a new DNS zone, Red Hat recommends to always use standard DNS delegation using nameserver (NS) records and to avoid forward zones. In most cases, using a global forwarder is sufficient, and forward zones are not necessary.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the IdM WebUI as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the Internet Protocol (IP) address of the DNS server to forward queries to.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the IdM Web UI, select \u003Ccode class=\"literal\">Network Services\u003C/code> → \u003Ccode class=\"literal\">DNS Forward Zones\u003C/code> → \u003Ccode class=\"literal\">DNS\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/8896b7e7ce96e74061098a3bbb9c8baa/idm-dns-forwardzone-add1.png\" alt=\"Selecting DNS Forward Zones from the DNS menu\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">DNS Forward Zones\u003C/code> section, click \u003Ccode class=\"literal\">Add\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/05f367791e031e11169faea727afcbbd/idm-dns-forwardzone-add2.png\" alt=\"Selecting the Add button\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">Add DNS forward zone\u003C/code> window, specify the forward zone name.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/e352a1fa831ab52e34d871f4076bf662/idm-dns-forwardzone-add3.png\" alt=\"Entering the name of the new Forward Zone\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tClick the \u003Ccode class=\"literal\">Add\u003C/code> button and specify the IP address of a DNS server to receive the forwarding request. You can specify multiple forwarders per forward zone.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/e6f321514d42dfb7fa11ffc3d76a2c85/idm-dns-forwardzone-add4.png\" alt=\"Specifying the IP address of the forwarder DNS server\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tSelect the \u003Ccode class=\"literal\">Forward policy\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/a202dd8a63b1d2365e21cfa8d2712945/idm-dns-forwardzone-add5.png\" alt=\"Choosing a Forward policy\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tClick \u003Ccode class=\"literal\">Add\u003C/code> at the bottom of the window to add the new forward zone.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the IdM Web UI, select \u003Ccode class=\"literal\">Network Services\u003C/code> → \u003Ccode class=\"literal\">DNS Forward Zones\u003C/code> → \u003Ccode class=\"literal\">DNS\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/8896b7e7ce96e74061098a3bbb9c8baa/idm-dns-forwardzone-add1.png\" alt=\"Selecting DNS Forward Zones from the DNS menu\"/>\u003C/div>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the forward zone you created, with the forwarders and forward policy you specified, is present and enabled in the IdM Web UI.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"informalfigure\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/b05d65e2bbceb4a464b4e47477e61220/idm-dns-forwardzone-add6.png\" alt=\"Verifying the new forward zone is present\"/>\u003C/div>\u003C/div>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"adding-a-dns-forward-zone-in-the-cli_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.6. Adding a DNS Forward Zone in the CLI\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to add a DNS forward zone by using the command line interface (CLI).\n\t\t\t\u003C/p>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\tDo not use forward zones unless absolutely required. Forward zones are not a standard solution, and using them can lead to unexpected and problematic behavior. If you must use forward zones, limit their use to overriding a global forwarding configuration.\n\t\t\t\t\u003C/p>\u003Cp>\n\t\t\t\t\tWhen creating a new DNS zone, Red Hat recommends to always use standard DNS delegation using nameserver (NS) records and to avoid forward zones. In most cases, using a global forwarder is sufficient, and forward zones are not necessary.\n\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the Internet Protocol (IP) address of the DNS server to forward queries to.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">dnsforwardzone-add\u003C/code> command to add a new forward zone. Specify at least one forwarder with the \u003Ccode class=\"literal\">--forwarder\u003C/code> option if the forward policy is not \u003Ccode class=\"literal\">none\u003C/code>, and specify the forward policy with the \u003Ccode class=\"literal\">--forward-policy\u003C/code> option.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa dnsforwardzone-add \u003Cspan class=\"emphasis\">\u003Cem>forward.example.com.\u003C/em>\u003C/span> --forwarder=\u003Cspan class=\"emphasis\">\u003Cem>10.10.0.14\u003C/em>\u003C/span> --forwarder=\u003Cspan class=\"emphasis\">\u003Cem>10.10.1.15\u003C/em>\u003C/span> --forward-policy=first\u003C/strong>\u003C/span>\n\nZone name: forward.example.com.\nZone forwarders: 10.10.0.14, 10.10.1.15\nForward policy: first\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">dnsforwardzone-show\u003C/code> command to display the DNS forward zone you just created.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@server ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa dnsforwardzone-show \u003Cspan class=\"emphasis\">\u003Cem>forward.example.com.\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\n\nZone name: forward.example.com.\nZone forwarders: 10.10.0.14, 10.10.1.15\nForward policy: first\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"establishing-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.7. Establishing a DNS Global Forwarder in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to establish a DNS Global Forwarder in IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn the example procedure below, the IdM administrator creates a DNS global forwarder to a DNS server with an Internet Protocol (IP) v4 address of \u003Ccode class=\"literal\">8.8.6.6\u003C/code> and IPv6 address of \u003Ccode class=\"literal\">2001:4860:4860::8800\u003C/code> on port \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">set-configuration.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp set-configuration.yml establish-global-forwarder.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">establish-global-forwarder.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to establish a global forwarder in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Create a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">forwarders\u003C/code> section of the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> portion:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the first \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv4 address of the global forwarder: \u003Ccode class=\"literal\">8.8.6.6\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the second \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv6 address of the global forwarder: \u003Ccode class=\"literal\">2001:4860:4860::8800\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tVerify the \u003Ccode class=\"literal\">port\u003C/code> value is set to \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">forward_policy\u003C/code> to \u003Ccode class=\"literal\">first\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to establish a global forwarder in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Create a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800\n    ipadnsconfig:\n      forwarders:\n        - ip_address: 8.8.6.6\n        - ip_address: 2001:4860:4860::8800\n          port: 53\n      forward_policy: first\n      allow_sync_ptr: true\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file establish-global-forwarder.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.8. Ensuring the presence of a DNS global forwarder in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure the presence of a DNS global forwarder in IdM. In the example procedure below, the IdM administrator ensures the presence of a DNS global forwarder to a DNS server with an Internet Protocol (IP) v4 address of \u003Ccode class=\"literal\">7.7.9.9\u003C/code> and IP v6 address of \u003Ccode class=\"literal\">2001:db8::1:0\u003C/code> on port \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">forwarders-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp forwarders-absent.yml ensure-presence-of-a-global-forwarder.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">ensure-presence-of-a-global-forwarder.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to ensure the presence of a global forwarder in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Ensure the presence of a DNS global forwarder to 7.7.9.9 and 2001:db8::1:0 on port 53\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">forwarders\u003C/code> section of the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> portion:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the first \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv4 address of the global forwarder: \u003Ccode class=\"literal\">7.7.9.9\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the second \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv6 address of the global forwarder: \u003Ccode class=\"literal\">2001:db8::1:0\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tVerify the \u003Ccode class=\"literal\">port\u003C/code> value is set to \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">state\u003C/code> to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure the presence of a global forwarder in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure the presence of a DNS global forwarder to 7.7.9.9 and 2001:db8::1:0 on port 53\n    ipadnsconfig:\n      forwarders:\n        - ip_address: 7.7.9.9\n        - ip_address: 2001:db8::1:0\n          port: 53\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-of-a-global-forwarder.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.9. Ensuring the absence of a DNS global forwarder in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure the absence of a DNS global forwarder in IdM. In the example procedure below, the IdM administrator ensures the absence of a DNS global forwarder with an Internet Protocol (IP) v4 address of \u003Ccode class=\"literal\">8.8.6.6\u003C/code> and IP v6 address of \u003Ccode class=\"literal\">2001:4860:4860::8800\u003C/code> on port \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">forwarders-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp forwarders-absent.yml ensure-absence-of-a-global-forwarder.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">ensure-absence-of-a-global-forwarder.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to ensure the absence of a global forwarder in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Ensure the absence of a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800 on port 53\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">forwarders\u003C/code> section of the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> portion:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the first \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv4 address of the global forwarder: \u003Ccode class=\"literal\">8.8.6.6\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the second \u003Ccode class=\"literal\">ip_address\u003C/code> value to the IPv6 address of the global forwarder: \u003Ccode class=\"literal\">2001:4860:4860::8800\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tVerify the \u003Ccode class=\"literal\">port\u003C/code> value is set to \u003Ccode class=\"literal\">53\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">action\u003C/code> variable to \u003Ccode class=\"literal\">member\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tVerify the \u003Ccode class=\"literal\">state\u003C/code> is set to \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure the absence of a global forwarder in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure the absence of a DNS global forwarder to 8.8.6.6 and 2001:4860:4860::8800 on port 53\n    ipadnsconfig:\n      forwarders:\n        - ip_address: 8.8.6.6\n        - ip_address: 2001:4860:4860::8800\n          port: 53\n      action: member\n      state: absent\u003C/pre>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\tIf you only use the \u003Ccode class=\"literal\">state: absent\u003C/code> option in your playbook without also using \u003Ccode class=\"literal\">action: member\u003C/code>, the playbook fails.\n\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-absence-of-a-global-forwarder.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks\" title=\"27.4. The action: member option in ipadnsconfig ansible-freeipa modules\">The \u003Ccode class=\"literal\">action: member\u003C/code> option in ipadnsconfig ansible-freeipa modules\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-dns-global-forwarders-are-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.10. Ensuring DNS Global Forwarders are disabled in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure DNS Global Forwarders are disabled in IdM. In the example procedure below, the IdM administrator ensures that the forwarding policy for the global forwarder is set to \u003Ccode class=\"literal\">none\u003C/code>, which effectively disables the global forwarder.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify the contents of the \u003Ccode class=\"literal\">disable-global-forwarders.yml\u003C/code> Ansible playbook file which is already configured to disable all DNS global forwarders. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cat disable-global-forwarders.yml\n---\n- name: Playbook to disable global DNS forwarders\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Disable global forwarders.\n    ipadnsconfig:\n      forward_policy: none\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file disable-global-forwarders.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsconfig.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.11. Ensuring the presence of a DNS Forward Zone in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure the presence of a DNS Forward Zone in IdM. In the example procedure below, the IdM administrator ensures the presence of a DNS forward zone for \u003Ccode class=\"literal\">example.com\u003C/code> to a DNS server with an Internet Protocol (IP) address of \u003Ccode class=\"literal\">8.8.8.8\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">forwarders-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp forwarders-absent.yml ensure-presence-forwardzone.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">ensure-presence-forwardzone.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to ensure the presence of a dnsforwardzone in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Ensure presence of a dnsforwardzone for example.com to 8.8.8.8\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> heading to \u003Ccode class=\"literal\">ipadnsforwardzone\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">ipadnsforwardzone\u003C/code> section:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable and set it to your IdM administrator password.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">name\u003C/code> variable and set it to \u003Ccode class=\"literal\">example.com\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">forwarders\u003C/code> section:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"A\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tRemove the \u003Ccode class=\"literal\">ip_address\u003C/code> and \u003Ccode class=\"literal\">port\u003C/code> lines.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\tAdd the IP address of the DNS server to receive forwarded requests by specifying it after a dash:\n\t\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Ccode class=\"literal\">- 8.8.8.8\u003C/code>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">forwardpolicy\u003C/code> variable and set it to \u003Ccode class=\"literal\">first\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">skip_overlap_check\u003C/code> variable and set it to \u003Ccode class=\"literal\">true\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure the presence of a dnsforwardzone in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure the presence of a dnsforwardzone for example.com to 8.8.8.8\n  ipadnsforwardzone:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: example.com\n      forwarders:\n          - 8.8.8.8\n      forwardpolicy: first\n      skip_overlap_check: true\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-forwardzone.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-dnsforwardzone.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-a-dns-forward-zone-has-multiple-forwarders-in-idm-using-ansible_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.12. Ensuring a DNS Forward Zone has multiple forwarders in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure a DNS Forward Zone in IdM has multiple forwarders. In the example procedure below, the IdM administrator ensures the DNS forward zone for \u003Ccode class=\"literal\">example.com\u003C/code> is forwarding to \u003Ccode class=\"literal\">8.8.8.8\u003C/code> and \u003Ccode class=\"literal\">4.4.4.4\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">forwarders-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp forwarders-absent.yml ensure-presence-multiple-forwarders.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">ensure-presence-multiple-forwarders.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to ensure the presence of multiple forwarders in a dnsforwardzone in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Ensure presence of 8.8.8.8 and 4.4.4.4 forwarders in dnsforwardzone for example.com\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> heading to \u003Ccode class=\"literal\">ipadnsforwardzone\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">ipadnsforwardzone\u003C/code> section:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable and set it to your IdM administrator password.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">name\u003C/code> variable and set it to \u003Ccode class=\"literal\">example.com\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">forwarders\u003C/code> section:\n\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"A\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\t\t\tRemove the \u003Ccode class=\"literal\">ip_address\u003C/code> and \u003Ccode class=\"literal\">port\u003C/code> lines.\n\t\t\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\t\t\t\tAdd the IP address of the DNS servers you want to ensure are present, preceded by a dash:\n\t\t\t\t\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">- 8.8.8.8\n- 4.4.4.4\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the state variable to present.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: name: Playbook to ensure the presence of multiple forwarders in a dnsforwardzone in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure presence of 8.8.8.8 and 4.4.4.4 forwarders in dnsforwardzone for example.com\n  ipadnsforwardzone:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n     name: example.com\n      forwarders:\n          - 8.8.8.8\n          - 4.4.4.4\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-multiple-forwarders.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-dnsforwardzone.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-a-dns-forward-zone-is-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.13. Ensuring a DNS Forward Zone is disabled in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure a DNS Forward Zone is disabled in IdM. In the example procedure below, the IdM administrator ensures the DNS forward zone for \u003Ccode class=\"literal\">example.com\u003C/code> is disabled.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">forwarders-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp forwarders-absent.yml ensure-disabled-forwardzone.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">ensure-disabled-forwardzone.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to ensure a dnsforwardzone is disabled in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Ensure a dnsforwardzone for example.com is disabled\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> heading to \u003Ccode class=\"literal\">ipadnsforwardzone\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">ipadnsforwardzone\u003C/code> section:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable and set it to your IdM administrator password.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">name\u003C/code> variable and set it to \u003Ccode class=\"literal\">example.com\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tRemove the entire \u003Ccode class=\"literal\">forwarders\u003C/code> section.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">state\u003C/code> variable to \u003Ccode class=\"literal\">disabled\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure a dnsforwardzone is disabled in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure a dnsforwardzone for example.com is disabled\n  ipadnsforwardzone:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: example.com\n      state: disabled\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-disabled-forwardzone.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-dnsforwardzone.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-absence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">30.14. Ensuring the absence of a DNS Forward Zone in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure the absence of a DNS Forward Zone in IdM. In the example procedure below, the IdM administrator ensures the absence of a DNS forward zone for \u003Ccode class=\"literal\">example.com\u003C/code>.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cd /usr/share/doc/ansible-freeipa/playbooks/dnsconfig\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and make sure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Ccode class=\"literal\">server.idm.example.com\u003C/code>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Ccode class=\"literal\">forwarders-absent.yml\u003C/code> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ cp forwarders-absent.yml ensure-absence-forwardzone.yml\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">ensure-absence-forwardzone.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tChange the \u003Ccode class=\"literal\">name\u003C/code> variable for the playbook to \u003Ccode class=\"literal\">Playbook to ensure the absence of a dnsforwardzone in IdM DNS\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">name\u003C/code> of the task to \u003Ccode class=\"literal\">Ensure the absence of a dnsforwardzone for example.com\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, change the \u003Ccode class=\"literal\">ipadnsconfig\u003C/code> heading to \u003Ccode class=\"literal\">ipadnsforwardzone\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">ipadnsforwardzone\u003C/code> section:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"i\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable and set it to your IdM administrator password.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tAdd the \u003Ccode class=\"literal\">name\u003C/code> variable and set it to \u003Ccode class=\"literal\">example.com\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tRemove the entire \u003Ccode class=\"literal\">forwarders\u003C/code> section.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tLeave the \u003Ccode class=\"literal\">state\u003C/code> variable as \u003Ccode class=\"literal\">absent\u003C/code>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Playbook to ensure the absence of a dnsforwardzone in IdM DNS\n  hosts: ipaserver\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure the absence of a dnsforwardzone for example.com\n    ipadnsforwardzone:\n       ipaadmin_password: \"{{ ipaadmin_password }}\"\n       name: example.com\n       state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-absence-forwardzone.yml\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-dnsforwardzone.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 31. Using Ansible to manage DNS records in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tThis chapter describes how to manage DNS records in Identity Management (IdM) using an Ansible playbook. As an IdM administrator, you can add, modify, and delete DNS records in IdM. The chapter contains the following sections:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-a-and-aaaa-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\" title=\"31.3. Ensuring the presence of A and AAAA DNS records in IdM using Ansible\">Ensuring the presence of A and AAAA DNS records in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-a-and-ptr-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\" title=\"31.4. Ensuring the presence of A and PTR DNS records in IdM using Ansible\">Ensuring the presence of A and PTR DNS records in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-multiple-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\" title=\"31.5. Ensuring the presence of multiple DNS records in IdM using Ansible\">Ensuring the presence of multiple DNS records in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-multiple-cname-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\" title=\"31.6. Ensuring the presence of multiple CNAME records in IdM using Ansible\">Ensuring the presence of multiple CNAME records in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#ensuring-the-presence-of-an-srv-record-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\" title=\"31.7. Ensuring the presence of an SRV record in IdM using Ansible\">Ensuring the presence of an SRV record in IdM using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Csection class=\"section\" id=\"dns-records-in-idm_using-ansible-to-manage-dns-records-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.1. DNS records in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIdentity Management (IdM) supports many different DNS record types. The following four are used most frequently:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">A\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis is a basic map for a host name and an IPv4 address. The record name of an A record is a host name, such as \u003Ccode class=\"literal\">www\u003C/code>. The \u003Ccode class=\"literal\">IP Address\u003C/code> value of an A record is an IPv4 address, such as \u003Ccode class=\"literal\">192.0.2.1\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor more information about A records, see \u003Ca class=\"link\" href=\"http://tools.ietf.org/html/rfc1035\">RFC 1035\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">AAAA\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThis is a basic map for a host name and an IPv6 address. The record name of an AAAA record is a host name, such as \u003Ccode class=\"literal\">www\u003C/code>. The \u003Ccode class=\"literal\">IP Address\u003C/code> value is an IPv6 address, such as \u003Ccode class=\"literal\">2001:DB8::1111\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor more information about AAAA records, see \u003Ca class=\"link\" href=\"http://tools.ietf.org/html/rfc3596\">RFC 3596\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">SRV\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\u003Cspan class=\"emphasis\">\u003Cem>Service (SRV) resource records\u003C/em>\u003C/span> map service names to the DNS name of the server that is providing that particular service. For example, this record type can map a service like an LDAP directory to the server which manages it.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe record name of an SRV record has the format \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>_service\u003C/em>\u003C/span>.\u003Cspan class=\"emphasis\">\u003Cem>_protocol\u003C/em>\u003C/span>\u003C/code>, such as \u003Ccode class=\"literal\">_ldap._tcp\u003C/code>. The configuration options for SRV records include priority, weight, port number, and host name for the target service.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor more information about SRV records, see \u003Ca class=\"link\" href=\"http://tools.ietf.org/html/rfc2782\">RFC 2782\u003C/a>.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">PTR\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tA pointer record (PTR) adds a reverse DNS record, which maps an IP address to a domain name.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tAll reverse DNS lookups for IPv4 addresses use reverse entries that are defined in the \u003Ccode class=\"literal\">in-addr.arpa.\u003C/code> domain. The reverse address, in human-readable form, is the exact reverse of the regular IP address, with the \u003Ccode class=\"literal\">in-addr.arpa.\u003C/code> domain appended to it. For example, for the network address \u003Ccode class=\"literal\">192.0.2.0/24\u003C/code>, the reverse zone is \u003Ccode class=\"literal\">2.0.192.in-addr.arpa\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe record name of a PTR must be in the standard format specified in \u003Ca class=\"link\" href=\"http://tools.ietf.org/html/rfc1035#section-3.5\">RFC 1035\u003C/a>, extended in \u003Ca class=\"link\" href=\"http://tools.ietf.org/html/rfc2317\">RFC 2317\u003C/a>, and \u003Ca class=\"link\" href=\"https://tools.ietf.org/html/rfc3596#section-2.5\">RFC 3596\u003C/a>. The host name value must be a canonical host name of the host for which you want to create the record.\n\t\t\t\t\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\t\t\t\t\tReverse zones can also be configured for IPv6 addresses, with zones in the \u003Ccode class=\"literal command\">.ip6.arpa.\u003C/code> domain. For more information about IPv6 reverse zones, see \u003Ca class=\"link\" href=\"http://www.ietf.org/rfc/rfc3596.txt\">RFC 3596\u003C/a>.\n\t\t\t\t\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003C/dd>\u003C/dl>\u003C/div>\u003Cp>\n\t\t\t\tWhen adding DNS resource records, note that many of the records require different data. For example, a CNAME record requires a host name, while an A record requires an IP address. In the IdM Web UI, the fields in the form for adding a new record are updated automatically to reflect what data is required for the currently selected type of record.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"common-ipa-dnsrecord-options_using-ansible-to-manage-dns-records-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.2. Common ipa dnsrecord-* options\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the following options when adding, modifying and deleting the most common DNS resource record types in Identity Management (IdM):\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA (IPv4)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAAAA (IPv6)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSRV\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPTR\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tIn \u003Ccode class=\"literal\">Bash\u003C/code>, you can define multiple entries by listing the values in a comma-separated list inside curly braces, such as \u003Ccode class=\"literal option\">--⁠option={val1,val2,val3}\u003C/code>.\n\t\t\t\u003C/p>\u003Crh-table id=\"tab-common-ipa-dnsrecord-add-options_using-ansible-to-manage-dns-records-in-idm\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 31.1. General Record Options\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 50%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464224058144\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Option\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464224056896\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Description\u003C/em>\u003C/span>\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224058144\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--ttl\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>number\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224056896\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the time to live for the record.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224058144\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--structured\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224056896\"> \u003Cp>\n\t\t\t\t\t\t\t\tParses the raw DNS records and returns them in a structured format.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140464224045248\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 31.2. \"A\" record options\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 17%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464224039488\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Option\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464224038240\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Description\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464224036992\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Examples\u003C/em>\u003C/span>\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd rowspan=\"2\" align=\"left\" valign=\"top\" headers=\"idm140464224039488\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--a-rec\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>ARECORD\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224038240\"> \u003Cp>\n\t\t\t\t\t\t\t\tPasses a single A record or a list of A records.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224036992\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa dnsrecord-add idm.example.com host1 --a-rec=192.168.122.123\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224038240\"> \u003Cp>\n\t\t\t\t\t\t\t\tCan create a wildcard A record with a given IP address.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224036992\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa dnsrecord-add idm.example.com \"*\" --a-rec=192.168.122.123\u003C/code> \u003Ca href=\"#ftn.idm140464224024032\" class=\"footnote\">\u003Csup class=\"footnote\" id=\"idm140464224024032\">[a]\u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224039488\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--a-ip-address\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>string\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224038240\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives the IP address for the record. When creating a record, the option to specify the \u003Ccode class=\"literal\">A\u003C/code> record value is \u003Ccode class=\"literal\">--a-rec\u003C/code>. However, when modifying an \u003Ccode class=\"literal\">A\u003C/code> record, the \u003Ccode class=\"literal\">--a-rec\u003C/code> option is used to specify the current value for the \u003Ccode class=\"literal\">A\u003C/code> record. The new value is set with the \u003Ccode class=\"literal\">--a-ip-address\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224036992\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa dnsrecord-mod idm.example.com --a-rec 192.168.122.123 --a-ip-address 192.168.122.124\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003Ctbody class=\"footnotes\">\u003Ctr>\u003Ctd colspan=\"3\">\u003Cdiv id=\"ftn.idm140464224024032\" class=\"footnote\">\u003Cdiv class=\"para\">\u003Ca href=\"#idm140464224024032\" class=\"simpara\">\u003Csup class=\"simpara\">[a] \u003C/sup>\u003C/a>\n\t\t\t\t\t\t\t\t\tThe example creates a wildcard \u003Ccode class=\"literal\">A\u003C/code> record with the IP address of 192.0.2.123.\n\t\t\t\t\t\t\t\t\u003C/div>\u003C/div>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140464224011536\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 31.3. \"AAAA\" record options\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 17%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464224005776\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Option\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464224004528\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Description\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464224003280\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Example\u003C/em>\u003C/span>\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224005776\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--aaaa-rec\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>AAAARECORD\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224004528\"> \u003Cp>\n\t\t\t\t\t\t\t\tPasses a single AAAA (IPv6) record or a list of AAAA records.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224003280\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa dnsrecord-add idm.example.com www --aaaa-rec 2001:db8::1231:5675\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224005776\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--aaaa-ip-address\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>string\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224004528\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives the IPv6 address for the record. When creating a record, the option to specify the \u003Ccode class=\"literal\">A\u003C/code> record value is \u003Ccode class=\"literal\">--aaaa-rec\u003C/code>. However, when modifying an \u003Ccode class=\"literal\">A\u003C/code> record, the \u003Ccode class=\"literal\">--aaaa-rec\u003C/code> option is used to specify the current value for the \u003Ccode class=\"literal\">A\u003C/code> record. The new value is set with the \u003Ccode class=\"literal\">--a-ip-address\u003C/code> option.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464224003280\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa dnsrecord-mod idm.example.com --aaaa-rec 2001:db8::1231:5675 --aaaa-ip-address 2001:db8::1231:5676\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140464223983840\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 31.4. \"PTR\" record options\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 17%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 50%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 33%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214822832\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Option\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214821584\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Description\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214820336\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Example\u003C/em>\u003C/span>\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd rowspan=\"2\" align=\"left\" valign=\"top\" headers=\"idm140464214822832\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--ptr-rec\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>PTRRECORD\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd rowspan=\"2\" align=\"left\" valign=\"top\" headers=\"idm140464214821584\"> \u003Cp>\n\t\t\t\t\t\t\t\tPasses a single PTR record or a list of PTR records. When adding the reverse DNS record, the zone name used with the \u003Ccode class=\"literal\">ipa dnsrecord-add\u003C/code> command is reversed, compared to the usage for adding other DNS records. Typically, the host IP address is the last octet of the IP address in a given network. The first example on the right adds a PTR record for \u003Cspan class=\"strong strong\">\u003Cstrong>server4.idm.example.com\u003C/strong>\u003C/span> with IPv4 address \u003Cspan class=\"strong strong\">\u003Cstrong>192.168.122.4.\u003C/strong>\u003C/span> The second example adds a reverse DNS entry to the \u003Cspan class=\"strong strong\">\u003Cstrong>0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa.\u003C/strong>\u003C/span> IPv6 reverse zone for the host \u003Cspan class=\"strong strong\">\u003Cstrong>server2.example.com\u003C/strong>\u003C/span> with the IP address \u003Cspan class=\"strong strong\">\u003Cstrong>2001:DB8::1111\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214820336\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">ipa dnsrecord-add 122.168.192.in-addr.arpa 4 --ptr-rec server4.idm.example.com.\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214820336\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">$ ipa dnsrecord-add 0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa. 1.1.1.0.0.0.0.0.0.0.0.0.0.0.0 --ptr-rec server2.idm.example.com.\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214822832\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--ptr-hostname\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>string\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214821584\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives the host name for the record.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214820336\"> \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Crh-table id=\"idm140464214797168\">\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccaption>Table 31.5. \"SRV\" Record Options\u003C/caption>\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 40%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 40%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214791408\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Option\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214790160\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Description\u003C/em>\u003C/span>\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464214788912\" scope=\"col\">\u003Cspan class=\"emphasis\">\u003Cem>Example\u003C/em>\u003C/span>\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd rowspan=\"2\" align=\"left\" valign=\"top\" headers=\"idm140464214791408\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--srv-rec\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>SRVRECORD\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd rowspan=\"2\" align=\"left\" valign=\"top\" headers=\"idm140464214790160\"> \u003Cp>\n\t\t\t\t\t\t\t\tPasses a single SRV record or a list of SRV records. In the examples on the right, \u003Cspan class=\"strong strong\">\u003Cstrong>_ldap._tcp\u003C/strong>\u003C/span> defines the service type and the connection protocol for the SRV record. The \u003Ccode class=\"literal\">--srv-rec\u003C/code> option defines the priority, weight, port, and target values. The weight values of 51 and 49 in the examples add up to 100 and represent the probability, in percentages, that a particular record is used.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214788912\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\"># ipa dnsrecord-add idm.example.com _ldap._tcp --srv-rec=\"0 51 389 server1.idm.example.com.\"\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214788912\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\"># ipa dnsrecord-add server.idm.example.com _ldap._tcp --srv-rec=\"1 49 389 server2.idm.example.com.\"\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214791408\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--srv-priority\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>number\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214790160\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the priority of the record. There can be multiple SRV records for a service type. The priority (0 - 65535) sets the rank of the record; the lower the number, the higher the priority. A service has to use the record with the highest priority first.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214788912\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\"># ipa dnsrecord-mod server.idm.example.com _ldap._tcp --srv-rec=\"1 49 389 server2.idm.example.com.\" --srv-priority=0\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214791408\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--srv-weight\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>number\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214790160\"> \u003Cp>\n\t\t\t\t\t\t\t\tSets the weight of the record. This helps determine the order of SRV records with the same priority. The set weights should add up to 100, representing the probability (in percentages) that a particular record is used.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214788912\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\"># ipa dnsrecord-mod server.idm.example.com _ldap._tcp --srv-rec=\"0 49 389 server2.idm.example.com.\" --srv-weight=60\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214791408\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--srv-port\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>number\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214790160\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives the port for the service on the target host.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214788912\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\"># ipa dnsrecord-mod server.idm.example.com _ldap._tcp --srv-rec=\"0 60 389 server2.idm.example.com.\" --srv-port=636\u003C/code>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214791408\"> \u003Cp>\n\t\t\t\t\t\t\t\t\u003Ccode class=\"literal option\">--srv-target\u003C/code>=\u003Cspan class=\"emphasis\">\u003Cem>string\u003C/em>\u003C/span>\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214790160\"> \u003Cp>\n\t\t\t\t\t\t\t\tGives the domain name of the target host. This can be a single period (.) if the service is not available in the domain.\n\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464214788912\"> \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRun \u003Ccode class=\"literal command\">ipa dnsrecord-add --help\u003C/code>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-a-and-aaaa-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.3. Ensuring the presence of A and AAAA DNS records in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that A and AAAA records for a particular IdM host are present. In the example used in the procedure below, an IdM administrator ensures the presence of A and AAAA records for \u003Cspan class=\"strong strong\">\u003Cstrong>host1\u003C/strong>\u003C/span> in the \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> DNS zone.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_working-with-dns-in-identity-management\">Using Ansible playbooks to manage IdM DNS zones\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-A-and-AAAA-records-are-present.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp ensure-A-and-AAAA-records-are-present.yml ensure-A-and-AAAA-records-are-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-A-and-AAAA-records-are-present-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnsrecord\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">zone_name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">records\u003C/code> variable, set the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>host1\u003C/strong>\u003C/span>, and the \u003Ccode class=\"literal\">a_ip_address\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>192.168.122.123\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">records\u003C/code> variable, set the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>host1\u003C/strong>\u003C/span>, and the \u003Ccode class=\"literal\">aaaa_ip_address\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>::1\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Ensure A and AAAA records are present\n  hosts: ipaserver\n  become: true\n  gather_facts: false\n\n  tasks:\n  # Ensure A and AAAA records are present\n  - name: Ensure that 'host1' has A and AAAA records.\n    ipadnsrecord:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      zone_name: idm.example.com\n      records:\n      - name: host1\n        a_ip_address: 192.168.122.123\n      - name: host1\n        aaaa_ip_address: ::1\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-A-and-AAAA-records-are-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-to-manage-dns-records-in-idm_working-with-dns-in-identity-management#dns-records-in-idm_using-ansible-to-manage-dns-records-in-idm\">DNS records in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsrecord.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-a-and-ptr-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.4. Ensuring the presence of A and PTR DNS records in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that an A record for a particular IdM host is present, with a corresponding PTR record. In the example used in the procedure below, an IdM administrator ensures the presence of A and PTR records for \u003Cspan class=\"strong strong\">\u003Cstrong>host1\u003C/strong>\u003C/span> with an IP address of \u003Cspan class=\"strong strong\">\u003Cstrong>192.168.122.45\u003C/strong>\u003C/span> in the \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> zone.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> DNS zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_working-with-dns-in-identity-management\">Using Ansible playbooks to manage IdM DNS zones\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-dnsrecord-with-reverse-is-present.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp ensure-dnsrecord-with-reverse-is-present.yml ensure-dnsrecord-with-reverse-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-dnsrecord-with-reverse-is-present-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnsrecord\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>host1\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">zone_name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ip_address\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>192.168.122.45\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">create_reverse\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>true\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Ensure DNS Record is present.\n  hosts: ipaserver\n  become: true\n  gather_facts: false\n\n  tasks:\n  # Ensure that dns record is present\n  - ipadnsrecord:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: host1\n      zone_name: idm.example.com\n      ip_address: 192.168.122.45\n      create_reverse: true\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-dnsrecord-with-reverse-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#dns-records-in-idm_managing-dns-records-in-idm\">DNS records in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsrecord.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-multiple-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.5. Ensuring the presence of multiple DNS records in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that multiple values are associated with a particular IdM DNS record. In the example used in the procedure below, an IdM administrator ensures the presence of multiple A records for \u003Cspan class=\"strong strong\">\u003Cstrong>host1\u003C/strong>\u003C/span> in the \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> DNS zone.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see \u003Ca class=\"link\" href=\"#using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 28. Using Ansible playbooks to manage IdM DNS zones\">Using Ansible playbooks to manage IdM DNS zones\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-presence-multiple-records.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp ensure-presence-multiple-records.yml ensure-presence-multiple-records-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-presence-multiple-records-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnsrecord\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">records\u003C/code> section, set the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>host1\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">records\u003C/code> section, set the \u003Ccode class=\"literal\">zone_name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">records\u003C/code> section, set the \u003Ccode class=\"literal\">a_rec\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>192.168.122.112\u003C/strong>\u003C/span> and to \u003Cspan class=\"strong strong\">\u003Cstrong>192.168.122.122\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tDefine a second record in the \u003Ccode class=\"literal\">records\u003C/code> section:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>host1\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">zone_name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">aaaa_rec\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>::1\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Test multiple DNS Records are present.\n  hosts: ipaserver\n  become: true\n  gather_facts: false\n\n  tasks:\n  # Ensure that multiple dns records are present\n  - ipadnsrecord:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      records:\n        - name: host1\n          zone_name: idm.example.com\n          a_rec: 192.168.122.112\n          a_rec: 192.168.122.122\n        - name: host1\n          zone_name: idm.example.com\n          aaaa_rec: ::1\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-presence-multiple-records-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#dns-records-in-idm_managing-dns-records-in-idm\">DNS records in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsrecord.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-multiple-cname-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.6. Ensuring the presence of multiple CNAME records in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA Canonical Name record (CNAME record) is a type of resource record in the Domain Name System (DNS) that maps one domain name, an alias, to another name, the canonical name.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou may find CNAME records useful when running multiple services from a single IP address: for example, an FTP service and a web service, each running on a different port.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that multiple CNAME records are present in IdM DNS. In the example used in the procedure below, \u003Cspan class=\"strong strong\">\u003Cstrong>host03\u003C/strong>\u003C/span> is both an HTTP server and an FTP server. The IdM administrator ensures the presence of the \u003Cspan class=\"strong strong\">\u003Cstrong>www\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>ftp\u003C/strong>\u003C/span> CNAME records for the \u003Cspan class=\"strong strong\">\u003Cstrong>host03\u003C/strong>\u003C/span> A record in the \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> zone.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see \u003Ca class=\"link\" href=\"#using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management\" title=\"Chapter 28. Using Ansible playbooks to manage IdM DNS zones\">Using Ansible playbooks to manage IdM DNS zones\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>host03\u003C/strong>\u003C/span> A record exists in the \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> zone.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-CNAME-record-is-present.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp ensure-CNAME-record-is-present.yml ensure-CNAME-record-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-CNAME-record-is-present-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnsrecord\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tOptional: Adapt the description provided by the \u003Ccode class=\"literal\">name\u003C/code> of the play.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">zone_name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">records\u003C/code> variable section, set the following variables and values:\n\t\t\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>www\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">cname_hostname\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>host03\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>ftp\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">cname_hostname\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>host03\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Ensure that 'www.idm.example.com' and 'ftp.idm.example.com' CNAME records point to 'host03.idm.example.com'.\n  hosts: ipaserver\n  become: true\n  gather_facts: false\n\n  tasks:\n  - ipadnsrecord:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      zone_name: idm.example.com\n      records:\n      - name: www\n        cname_hostname: host03\n      - name: ftp\n        cname_hostname: host03\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-CNAME-record-is-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee the \u003Ccode class=\"literal\">README-dnsrecord.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSee sample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"ensuring-the-presence-of-an-srv-record-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">31.7. Ensuring the presence of an SRV record in IdM using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tA DNS service (SRV) record defines the hostname, port number, transport protocol, priority and weight of a service available in a domain. In Identity Management (IdM), you can use SRV records to locate IdM servers and replicas.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tFollow this procedure to use an Ansible playbook to ensure that an SRV record is present in IdM DNS. In the example used in the procedure below, an IdM administrator ensures the presence of the \u003Cspan class=\"strong strong\">\u003Cstrong>_kerberos._udp.idm.example.com\u003C/strong>\u003C/span> SRV record with the value of \u003Cspan class=\"strong strong\">\u003Cstrong>10 50 88 idm.example.com\u003C/strong>\u003C/span>. This sets the following values:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIt sets the priority of the service to 10.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIt sets the weight of the service to 50.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIt sets the port to be used by the service to 88.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM administrator password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span> zone exists and is managed by IdM DNS. For more information about adding a primary DNS zone in IdM DNS, see \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_working-with-dns-in-identity-management\">Using Ansible playbooks to manage IdM DNS zones\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNavigate to the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOpen your inventory file and ensure that the IdM server that you want to configure is listed in the \u003Ccode class=\"literal\">[ipaserver]\u003C/code> section. For example, to instruct Ansible to configure \u003Cspan class=\"strong strong\">\u003Cstrong>server.idm.example.com\u003C/strong>\u003C/span>, enter:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[ipaserver]\nserver.idm.example.com\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tMake a copy of the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-SRV-record-is-present.yml\u003C/strong>\u003C/span> Ansible playbook file. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp ensure-SRV-record-is-present.yml ensure-SRV-record-is-present-copy.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Cspan class=\"strong strong\">\u003Cstrong>ensure-SRV-record-is-present-copy.yml\u003C/strong>\u003C/span> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipadnsrecord\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to your IdM administrator password.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>_kerberos._udp.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">srv_rec\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>'10 50 88 idm.example.com'\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">zone_name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Test multiple DNS Records are present.\n  hosts: ipaserver\n  become: true\n  gather_facts: false\n\n  tasks:\n  # Ensure a SRV record is present\n  - ipadnsrecord:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: _kerberos._udp.idm.example.com\n      srv_rec: ’10 50 88 idm.example.com’\n      zone_name: idm.example.com\n      state: present\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory.file ensure-SRV-record-is-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/working_with_dns_in_identity_management/managing-dns-records-in-idm_working-with-dns-in-identity-management#dns-records-in-idm_managing-dns-records-in-idm\">DNS records in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">README-dnsrecord.md\u003C/code> file in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSample Ansible playbooks in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/dnsrecord\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 32. Using Ansible to automount NFS shares for IdM users\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tAutomount is a way to manage, organize, and access directories across multiple systems. Automount automatically mounts a directory whenever access to it is requested. This works well within an Identity Management (IdM) domain as it allows you to share directories on clients within the domain easily.\n\t\t\u003C/p>\u003Cp>\n\t\t\tYou can use Ansible to configure NFS shares to be mounted automatically for IdM users logged in to IdM clients in an IdM location.\n\t\t\u003C/p>\u003Cp>\n\t\t\tThe example in this chapter uses the following scenario:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>nfs-server.idm.example.com\u003C/strong>\u003C/span> is the fully-qualified domain name (FQDN) of a Network File System (NFS) server.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>nfs-server.idm.example.com\u003C/strong>\u003C/span> is an IdM client located in the \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span> automount location.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe NFS server exports the \u003Cspan class=\"strong strong\">\u003Cstrong>/exports/project\u003C/strong>\u003C/span> directory as read-write.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tAny IdM user belonging to the \u003Cspan class=\"strong strong\">\u003Cstrong>developers\u003C/strong>\u003C/span> group can access the contents of the exported directory as \u003Cspan class=\"strong strong\">\u003Cstrong>/devel/project/\u003C/strong>\u003C/span> on any IdM client that is located in the same \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span> automount location as the NFS server.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>idm-client.idm.example.com\u003C/strong>\u003C/span> is an IdM client located in the \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span> automount location.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Crh-alert class=\"admonition important\" state=\"warning\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Important\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tIf you want to use a Samba server instead of an NFS server to provide the shares for IdM clients, see the \u003Ca class=\"link\" href=\"https://access.redhat.com/solutions/6596071\">How do I configure kerberized CIFS mounts with Autofs in an IPA environment?\u003C/a> KCS solution.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Cp>\n\t\t\t \n\t\t\u003C/p>\u003Cp>\n\t\t\tThe chapter contains the following sections:\n\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#autofs-and-automount-in-idm_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.1. Autofs and automount in IdM\">Autofs and automount in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.2. Setting up an NFS server with Kerberos in a Red Hat Identity Management domain\">Setting up an NFS server with Kerberos in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.3. Configuring automount locations, maps, and keys in IdM by using Ansible\">Configuring automount locations, maps, and keys in IdM by using Ansible\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.4. Using Ansible to add IdM users to a group that owns NFS shares\">Using Ansible to add IdM users to a group that owns NFS shares\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.5. Configuring automount on an IdM client\">Configuring automount on an IdM client\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#verifying-that-an-idm-user-can-access-nfs-shares-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.6. Verifying that an IdM user can access NFS shares on an IdM client\">Verifying that an IdM user can access NFS shares on an IdM client\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Csection class=\"section\" id=\"autofs-and-automount-in-idm_using-ansible-to-automount-nfs-shares-for-idm-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">32.1. Autofs and automount in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe \u003Ccode class=\"literal\">autofs\u003C/code> service automates the mounting of directories, as needed, by directing the \u003Ccode class=\"literal\">automount\u003C/code> daemon to mount directories when they are accessed. In addition, after a period of inactivity, \u003Ccode class=\"literal\">autofs\u003C/code> directs \u003Ccode class=\"literal\">automount\u003C/code> to unmount auto-mounted directories. Unlike static mounting, on-demand mounting saves system resources.\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">Automount maps\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tOn a system that utilizes \u003Ccode class=\"literal\">autofs\u003C/code>, the \u003Ccode class=\"literal\">automount\u003C/code> configuration is stored in several different files. The primary \u003Ccode class=\"literal\">automount\u003C/code> configuration file is \u003Ccode class=\"literal\">/etc/auto.master\u003C/code>, which contains the master mapping of \u003Ccode class=\"literal\">automount\u003C/code> mount points, and their associated resources, on a system. This mapping is known as \u003Cspan class=\"emphasis\">\u003Cem>automount maps\u003C/em>\u003C/span>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">/etc/auto.master\u003C/code> configuration file contains the \u003Cspan class=\"emphasis\">\u003Cem>master map\u003C/em>\u003C/span>. It can contain references to other maps. These maps can either be direct or indirect. Direct maps use absolute path names for their mount points, while indirect maps use relative path names.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Automount configuration in IdM\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tWhile \u003Ccode class=\"literal\">automount\u003C/code> typically retrieves its map data from the local \u003Ccode class=\"literal\">/etc/auto.master\u003C/code> and associated files, it can also retrieve map data from other sources. One common source is an LDAP server. In the context of Identity Management (IdM), this is a 389 Directory Server.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tIf a system that uses \u003Ccode class=\"literal\">autofs\u003C/code> is a client in an IdM domain, the \u003Ccode class=\"literal\">automount\u003C/code> configuration is not stored in local configuration files. Instead, the \u003Ccode class=\"literal\">autofs\u003C/code> configuration, such as maps, locations, and keys, is stored as LDAP entries in the IdM directory. For example, for the \u003Ccode class=\"literal\">idm.example.com\u003C/code> IdM domain, the default \u003Cspan class=\"emphasis\">\u003Cem>master map\u003C/em>\u003C/span> is stored as follows:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">dn:\nautomountmapname=auto.master,cn=default,cn=automount,dc=idm,dc=example,dc=com\nobjectClass: automountMap\nobjectClass: top\nautomountMapName: auto.master\u003C/pre>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/managing_file_systems/mounting-file-systems-on-demand_managing-file-systems\">Mounting file systems on demand\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">32.2. Setting up an NFS server with Kerberos in a Red Hat Identity Management domain\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you use Red Hat Identity Management (IdM), you can join your NFS server to the IdM domain. This enables you to centrally manage users and groups and to use Kerberos for authentication, integrity protection, and traffic encryption.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe NFS server is \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/assembly_installing-an-idm-client_installing-identity-management\">enrolled\u003C/a> in a Red Hat Identity Management (IdM) domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe NFS server is running and configured.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tObtain a kerberos ticket as an IdM administrator:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>kinit admin\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a \u003Ccode class=\"literal\">nfs/&lt;FQDN&gt;\u003C/code> service principal:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa service-add \u003Cspan class=\"emphasis\">\u003Cem>nfs/nfs_server.idm.example.com\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRetrieve the \u003Ccode class=\"literal\">nfs\u003C/code> service principal from IdM, and store it in the \u003Ccode class=\"literal\">/etc/krb5.keytab\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-getkeytab -s \u003Cspan class=\"emphasis\">\u003Cem>idm_server.idm.example.com\u003C/em>\u003C/span> -p \u003Cspan class=\"emphasis\">\u003Cem>nfs/nfs_server.idm.example.com\u003C/em>\u003C/span> -k /etc/krb5.keytab\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: Display the principals in the \u003Ccode class=\"literal\">/etc/krb5.keytab\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>klist -k /etc/krb5.keytab\u003C/strong>\u003C/span>\nKeytab name: FILE:/etc/krb5.keytab\nKVNO Principal\n---- --------------------------------------------------------------------------\n   1 nfs/nfs_server.idm.example.com@IDM.EXAMPLE.COM\n   1 nfs/nfs_server.idm.example.com@IDM.EXAMPLE.COM\n   1 nfs/nfs_server.idm.example.com@IDM.EXAMPLE.COM\n   1 nfs/nfs_server.idm.example.com@IDM.EXAMPLE.COM\n   7 host/nfs_server.idm.example.com@IDM.EXAMPLE.COM\n   7 host/nfs_server.idm.example.com@IDM.EXAMPLE.COM\n   7 host/nfs_server.idm.example.com@IDM.EXAMPLE.COM\n   7 host/nfs_server.idm.example.com@IDM.EXAMPLE.COM\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBy default, the IdM client adds the host principal to the \u003Ccode class=\"literal\">/etc/krb5.keytab\u003C/code> file when you join the host to the IdM domain. If the host principal is missing, use the \u003Ccode class=\"literal\">\u003Cspan class=\"strong strong\">\u003Cstrong>ipa-getkeytab -s\u003C/strong>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>idm_server.idm.example.com\u003C/em>\u003C/span> \u003Cspan class=\"strong strong\">\u003Cstrong>-p\u003C/strong>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>host/nfs_server.idm.example.com\u003C/em>\u003C/span> \u003Cspan class=\"strong strong\">\u003Cstrong>-k /etc/krb5.keytab\u003C/strong>\u003C/span>\u003C/code> command to add it.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse the \u003Ccode class=\"literal\">ipa-client-automount\u003C/code> utility to configure mapping of IdM IDs:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">#  \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-client-automount\u003C/strong>\u003C/span>\nSearching for IPA server...\nIPA server: DNS discovery\nLocation: default\nContinue to configure the system with these values? [no]: \u003Cspan class=\"strong strong\">\u003Cstrong>yes\u003C/strong>\u003C/span>\nConfigured /etc/idmapd.conf\nRestarting sssd, waiting for it to become available.\nStarted autofs\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUpdate your \u003Ccode class=\"literal\">/etc/exports\u003C/code> file, and add the Kerberos security method to the client options. For example:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">/nfs/projects/      \t192.0.2.0/24(rw,\u003Cspan class=\"strong strong\">\u003Cstrong>sec=krb5i\u003C/strong>\u003C/span>)\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIf you want that your clients can select from multiple security methods, specify them separated by colons:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">/nfs/projects/      \t192.0.2.0/24(rw,\u003Cspan class=\"strong strong\">\u003Cstrong>sec=krb5:krb5i:krb5p\u003C/strong>\u003C/span>)\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tReload the exported file systems:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>exportfs -r\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">32.3. Configuring automount locations, maps, and keys in IdM by using Ansible\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs an Identity Management (IdM) system administrator, you can configure automount locations and maps in IdM so that IdM users in the specified locations can access shares exported by an NFS server by navigating to specific mount points on their hosts. Both the exported NFS server directory and the mount points are specified in the maps. In LDAP terms, a location is a container for such map entries.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe example describes how to use Ansible to configure the \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span> location and a map that mounts the \u003Cspan class=\"strong strong\">\u003Cstrong>nfs-server.idm.example.com:/exports/project\u003C/strong>\u003C/span> share on the \u003Cspan class=\"strong strong\">\u003Cstrong>/devel/project\u003C/strong>\u003C/span> mount point on the IdM client as a read-write directory.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your Ansible control node, navigate to your \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCopy the \u003Ccode class=\"literal\">automount-location-present.yml\u003C/code> Ansible playbook file located in the \u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/automount/\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cp /usr/share/doc/ansible-freeipa/playbooks/automount/automount-location-present.yml automount-location-map-and-key-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">automount-location-map-and-key-present.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAdapt the file by setting the following variables in the \u003Ccode class=\"literal\">ipaautomountlocation\u003C/code> task section:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> variable to the password of the IdM \u003Ccode class=\"literal\">admin\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSet the \u003Ccode class=\"literal\">name\u003C/code> variable to \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tEnsure that the \u003Ccode class=\"literal\">state\u003C/code> variable is set to \u003Ccode class=\"literal\">present\u003C/code>.\n\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tThis is the modified Ansible playbook file for the current example:\n\t\t\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"literallayout\">---\n- name: Automount location present example\n  hosts: ipaserver\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure automount location is present\n    ipaautomountlocation:\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: raleigh\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tContinue editing the \u003Ccode class=\"literal\">automount-location-map-and-key-present.yml\u003C/code> file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, add a task to ensure the presence of an automount map:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[...]\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n[...]\n  - name: ensure map named auto.devel in location raleigh is created\n    \u003Cspan class=\"strong strong\">\u003Cstrong>ipaautomountmap:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: auto.devel\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>location: raleigh\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd another task to add the mount point and NFS server information to the map:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[...]\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n[...]\n  - name: ensure automount key /devel/project is present\n    \u003Cspan class=\"strong strong\">\u003Cstrong>ipaautomountkey:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>location: raleigh\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>mapname: auto.devel\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>key: /devel/project\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>info: nfs-server.idm.example.com:/exports/project\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd another task to ensure \u003Cspan class=\"strong strong\">\u003Cstrong>auto.devel\u003C/strong>\u003C/span> is connected to \u003Cspan class=\"strong strong\">\u003Cstrong>auto.master\u003C/strong>\u003C/span>:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[...]\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n[...]\n- name: Ensure auto.devel is connected in auto.master:\n  \u003Cspan class=\"strong strong\">\u003Cstrong>ipaautomountkey:\u003C/strong>\u003C/span>\n    \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n    \u003Cspan class=\"strong strong\">\u003Cstrong>location: raleigh\u003C/strong>\u003C/span>\n    \u003Cspan class=\"strong strong\">\u003Cstrong>mapname: auto.map\u003C/strong>\u003C/span>\n    \u003Cspan class=\"strong strong\">\u003Cstrong>key: /devel\u003C/strong>\u003C/span>\n    \u003Cspan class=\"strong strong\">\u003Cstrong>info: auto.devel\u003C/strong>\u003C/span>\n    \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook and inventory files:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory automount-location-map-and-key-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">32.4. Using Ansible to add IdM users to a group that owns NFS shares\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs an Identity Management (IdM) system administrator, you can use Ansible to create a group of users that is able to access NFS shares, and add IdM users to this group.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThis example describes how to use an Ansible playbook to ensure that the \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> account belongs to the \u003Cspan class=\"strong strong\">\u003Cstrong>developers\u003C/strong>\u003C/span> group, so that \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> can access the \u003Cspan class=\"strong strong\">\u003Cstrong>/exports/project\u003C/strong>\u003C/span> NFS share.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to the \u003Cspan class=\"strong strong\">\u003Cstrong>nfs-server.idm.example.com\u003C/strong>\u003C/span> NFS server, which is an IdM client located in the \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span> automount location.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou know the IdM \u003Ccode class=\"literal\">admin\u003C/code> password.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe target node, that is the node on which the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module is executed, is part of the IdM domain as an IdM client, server or replica.\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIn \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>, you have created the \u003Ccode class=\"literal\">automount-location-map-and-key-present.yml\u003C/code> file that already contains tasks from \u003Ca class=\"link\" href=\"#configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.3. Configuring automount locations, maps, and keys in IdM by using Ansible\">Configuring automount locations, maps, and keys in IdM by using Ansible\u003C/a>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your Ansible control node, navigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd ~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOpen the \u003Ccode class=\"literal\">automount-location-map-and-key-present.yml\u003C/code> file for editing.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tIn the \u003Ccode class=\"literal\">tasks\u003C/code> section, add a task to ensure that the IdM \u003Cspan class=\"strong strong\">\u003Cstrong>developers\u003C/strong>\u003C/span> group exists and \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> is added to this group:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[...]\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n[...]\n  - \u003Cspan class=\"strong strong\">\u003Cstrong>ipagroup:\u003C/strong>\u003C/span>\n     \u003Cspan class=\"strong strong\">\u003Cstrong>ipaadmin_password: \"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>name: developers\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>user:\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>- idm_user\u003C/strong>\u003C/span>\n      \u003Cspan class=\"strong strong\">\u003Cstrong>state: present\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook and specify the playbook and inventory files:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory automount-location-map-and-key-present.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the NFS server, change the group ownership of the \u003Cspan class=\"strong strong\">\u003Cstrong>/exports/project\u003C/strong>\u003C/span> directory to \u003Cspan class=\"strong strong\">\u003Cstrong>developers\u003C/strong>\u003C/span> so that every IdM user in the group can access the directory:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>chgrp developers /exports/project\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">32.5. Configuring automount on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs an Identity Management (IdM) system administrator, you can configure automount services on an IdM client so that NFS shares configured for a location to which the client has been added are accessible to an IdM user automatically when the user logs in to the client. The example describes how to configure an IdM client to use automount services that are available in the \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span> location.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ccode class=\"literal\">root\u003C/code> access to the IdM client.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in as IdM administrator.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe automount location exists. The example location is \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn the IdM client, enter the \u003Ccode class=\"literal\">ipa-client-automount\u003C/code> command and specify the location. Use the \u003Ccode class=\"literal\">-U\u003C/code> option to run the script unattended:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>ipa-client-automount --location raleigh -U\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStop the autofs service, clear the SSSD cache, and start the autofs service to load the new configuration settings:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\"># \u003Cspan class=\"strong strong\">\u003Cstrong>systemctl stop autofs ; sss_cache -E ; systemctl start autofs\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"verifying-that-an-idm-user-can-access-nfs-shares-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">32.6. Verifying that an IdM user can access NFS shares on an IdM client\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tAs an Identity Management (IdM) system administrator, you can test if an IdM user that is a member of a specific group can access NFS shares when logged in to a specific IdM client.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIn the example, the following scenario is tested:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn IdM user named \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> belonging to the \u003Cspan class=\"strong strong\">\u003Cstrong>developers\u003C/strong>\u003C/span> group can read and write the contents of the files in the \u003Cspan class=\"strong strong\">\u003Cstrong>/devel/project\u003C/strong>\u003C/span> directory automounted on \u003Cspan class=\"strong strong\">\u003Cstrong>idm-client.idm.example.com\u003C/strong>\u003C/span>, an IdM client located in the \u003Cspan class=\"strong strong\">\u003Cstrong>raleigh\u003C/strong>\u003C/span> automount location.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.2. Setting up an NFS server with Kerberos in a Red Hat Identity Management domain\">set up an NFS server with Kerberos on an IdM host\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.3. Configuring automount locations, maps, and keys in IdM by using Ansible\">configured automount locations, maps, and mount points in IdM\u003C/a> in which you configured how IdM users can access the NFS share.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.4. Using Ansible to add IdM users to a group that owns NFS shares\">used Ansible to add IdM users to the developers group that owns the NFS shares\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have \u003Ca class=\"link\" href=\"#configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users\" title=\"32.5. Configuring automount on an IdM client\">configured automount on the IdM client\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tVerify that the IdM user can access the \u003Ccode class=\"literal\">read-write\u003C/code> directory:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tConnect to the IdM client as the IdM user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh idm_user@idm-client.idm.example.com\u003C/strong>\u003C/span>\nPassword:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tObtain the ticket-granting ticket (TGT) for the IdM user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit idm_user\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: View the group membership of the IdM user:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-show idm_user\u003C/strong>\u003C/span>\n  User login: idm_user\n  [...]\n  Member of groups: developers, ipausers\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tNavigate to the \u003Cspan class=\"strong strong\">\u003Cstrong>/devel/project\u003C/strong>\u003C/span> directory:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cd /devel/project\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tList the directory contents:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ls\u003C/strong>\u003C/span>\nrw_file\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAdd a line to the file in the directory to test the \u003Ccode class=\"literal\">write\u003C/code> permission:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>echo \"idm_user can write into the file\" &gt; rw_file\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tOptional: View the updated contents of the file:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>cat rw_file\u003C/strong>\u003C/span>\nthis is a read-write file\nidm_user can write into the file\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe output confirms that \u003Cspan class=\"strong strong\">\u003Cstrong>idm_user\u003C/strong>\u003C/span> can write into the file.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 33. Using Ansible to integrate IdM with NIS domains and netgroups\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Csection class=\"section\" id=\"nis-and-its-benefits_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">33.1. NIS and its benefits\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tIn UNIX environments, the network information service (NIS) is a common way to centrally manage identities and authentication. NIS, which was originally named \u003Cspan class=\"strong strong\">\u003Cstrong>Yellow Pages\u003C/strong>\u003C/span> (YP), centrally manages authentication and identity information such as:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tUsers and passwords\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tHost names and IP addresses\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tPOSIX groups\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tFor modern network infrastructures, NIS is considered too insecure because, for example, it neither provides host authentication, nor is data sent encrypted over the network. To work around the problems, NIS is often integrated with other protocols to enhance security.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tIf you use Identity Management (IdM), you can use the NIS server plug-in to connect clients that cannot be fully migrated to IdM. IdM integrates netgroups and other NIS data into the IdM domain. Additionally, you can easily migrate user and host identities from a NIS domain to IdM.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tNetgroups can be used everywhere that NIS groups are expected.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\" title=\"33.2. NIS in IdM\">NIS in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#nis-netgroups-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\" title=\"33.3. NIS netgroups in IdM\">NIS netgroups in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/configuring_and_managing_identity_management/assembly_migrating-from-nis-to-identity-management_configuring-and-managing-idm#\">Migrating from NIS to Identity Management\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">33.2. NIS in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>NIS objects in IdM\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tNIS objects are integrated and stored in the Directory Server back end in compliance with \u003Ca class=\"link\" href=\"http://tools.ietf.org/html/rfc2307\">RFC 2307\u003C/a>. IdM creates NIS objects in the LDAP directory and clients retrieve them through, for example, System Security Services Daemon (SSSD) or \u003Ccode class=\"literal\">nss_ldap\u003C/code> using an encrypted LDAP connection.\n\t\t\t\t\u003C/p>\u003C/div>\u003Cp>\n\t\t\t\tIdM manages netgroups, accounts, groups, hosts, and other data. IdM uses a NIS listener to map passwords, groups, and netgroups to IdM entries.\n\t\t\t\u003C/p>\u003Cdiv class=\"formalpara\">\u003Cp class=\"title\">\u003Cstrong>NIS Plug-ins in IdM\u003C/strong>\u003C/p>\u003Cp>\n\t\t\t\t\tFor NIS support, IdM uses the following plug-ins provided in the \u003Cspan class=\"strong strong\">\u003Cstrong>\u003Cspan class=\"package package\">slapi-nis\u003C/span>\u003C/strong>\u003C/span> package:\n\t\t\t\t\u003C/p>\u003C/div>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">NIS Server Plug-in\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\tThe NIS Server plug-in enables the IdM-integrated LDAP server to act as a NIS server for clients. In this role, Directory Server dynamically generates and updates NIS maps according to the configuration. Using the plug-in, IdM serves clients using the NIS protocol as an NIS server.\n\t\t\t\t\t\t\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">Schema Compatibility Plug-in\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tThe Schema Compatibility plug-in enables the Directory Server back end to provide an alternate view of entries stored in part of the directory information tree (DIT). This includes adding, dropping, or renaming attribute values, and optionally retrieving values for attributes from multiple entries in the tree.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tFor further details, see the \u003Ccode class=\"literal\">/usr/share/doc/slapi-nis-\u003Cspan class=\"emphasis\">\u003Cem>version\u003C/em>\u003C/span>/sch-getting-started.txt\u003C/code> file.\n\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003C/dl>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"nis-netgroups-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">33.3. NIS netgroups in IdM\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tNIS entities can be stored in netgroups. Compared to UNIX groups, netgroups provide support for:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNested groups (groups as members of other groups).\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tGrouping hosts.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tA netgroup defines a set of the following information: host, user, and domain. This set is called a \u003Cspan class=\"strong strong\">\u003Cstrong>triple\u003C/strong>\u003C/span>. These three fields can contain:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA value.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA dash (\u003Ccode class=\"literal command\">-\u003C/code>), which specifies \"no valid value\"\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tNo value. An empty field specifies a wildcard.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cpre class=\"screen\">(\u003Cspan class=\"emphasis\">\u003Cem>host.example.com\u003C/em>\u003C/span>,,\u003Cspan class=\"emphasis\">\u003Cem>nisdomain.example.com\u003C/em>\u003C/span>)\n(-,\u003Cspan class=\"emphasis\">\u003Cem>user\u003C/em>\u003C/span>,\u003Cspan class=\"emphasis\">\u003Cem>nisdomain.example.com\u003C/em>\u003C/span>)\u003C/pre>\u003Cp>\n\t\t\t\tWhen a client requests a NIS netgroup, IdM translates the LDAP entry :\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo a traditional NIS map and sends it to the client over the NIS protocol by using the NIS plug-in.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tTo an LDAP format that is compliant with \u003Ca class=\"link\" href=\"https://www.ietf.org/rfc/rfc2307.txt\">RFC 2307\u003C/a> or RFC 2307bis.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-netgroup-is-present_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">33.4. Using Ansible to ensure that a netgroup is present\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use an Ansible playbook to ensure that an IdM netgroup is present. The example describes how to ensure that the \u003Cspan class=\"strong strong\">\u003Cstrong>TestNetgroup1\u003C/strong>\u003C/span> group is present.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>netgroup-present.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA netgroup.\n  hosts: ipaserver\n  become: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure netgroup members are present\n    ipanetgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: TestNetgroup1\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory_/netgroup-present.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\" title=\"33.2. NIS in IdM\">NIS in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-netgroup.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/netgroup\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-members-are-present-in-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">33.5. Using Ansible to ensure that members are present in a netgroup\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use an Ansible playbook to ensure that IdM users, groups, and netgroups are members of a netgroup. The example describes how to ensure that the \u003Cspan class=\"strong strong\">\u003Cstrong>TestNetgroup1\u003C/strong>\u003C/span> group has the following members:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>user1\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>user2\u003C/strong>\u003C/span> IdM users\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>group1\u003C/strong>\u003C/span> IdM group\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>admins\u003C/strong>\u003C/span> netgroup\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn \u003Cspan class=\"strong strong\">\u003Cstrong>idmclient1\u003C/strong>\u003C/span> host that is an IdM client\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>TestNetgroup1\u003C/strong>\u003C/span> IdM netgroup exists.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>user1\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>user2\u003C/strong>\u003C/span> IdM users exist.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>group1\u003C/strong>\u003C/span> IdM group exists.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>admins\u003C/strong>\u003C/span> IdM netgroup exists.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>IdM-members-present-in-a-netgroup.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA netgroup.\n  hosts: ipaserver\n  become: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure netgroup members are present\n    ipanetgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: TestNetgroup1\n      user: user1,user2\n      group: group1\n      host: idmclient1\n      netgroup: admins\n      action: member\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory_/IdM-members-present-in-a-netgroup.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\" title=\"33.2. NIS in IdM\">NIS in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-netgroup.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/netgroup\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-member-is-absent-from-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">33.6. Using Ansible to ensure that a member is absent from a netgroup\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use an Ansible playbook to ensure that IdM users are members of a netgroup. The example describes how to ensure that the \u003Cspan class=\"strong strong\">\u003Cstrong>TestNetgroup1\u003C/strong>\u003C/span> group does not have the \u003Cspan class=\"strong strong\">\u003Cstrong>user1\u003C/strong>\u003C/span> IdM user among its members. netgroup\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Cspan class=\"strong strong\">\u003Cstrong>TestNetgroup1\u003C/strong>\u003C/span> netgroup exists.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>IdM-member-absent-from-a-netgroup.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA netgroup.\n  hosts: ipaserver\n  become: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure netgroup user, \"user1\", is absent\n    ipanetgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: TestNetgroup1\n      user: \"user1\"\n      action: member\n      state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory_/IdM-member-absent-from-a-netgroup.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\" title=\"33.2. NIS in IdM\">NIS in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-netgroup.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/netgroup\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-ensure-that-a-netgroup-is-absent_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">33.7. Using Ansible to ensure that a netgroup is absent\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use an Ansible playbook to ensure that a netgroup does not exist in Identity Management (IdM). The example describes how to ensure that the \u003Cspan class=\"strong strong\">\u003Cstrong>TestNetgroup1\u003C/strong>\u003C/span> group does not exist in your IdM domain.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>netgroup-absent.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA netgroup.\n  hosts: ipaserver\n  become: no\n\n  vars_files:\n  - /home/user_name/MyPlaybooks/secret.yml\n  tasks:\n  - name: Ensure netgroup my_netgroup1 is absent\n    ipanetgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: my_netgroup1\n      state: absent\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i \u003Cspan class=\"emphasis\">\u003Cem>path_to_inventory_directory/inventory.file\u003C/em>\u003C/span> \u003Cspan class=\"emphasis\">\u003Cem>path_to_playbooks_directory_/netgroup-absent.yml\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups\" title=\"33.2. NIS in IdM\">NIS in IdM\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/README-netgroup.md\u003C/code>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/ansible-freeipa/playbooks/netgroup\u003C/code>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-configure-hbac-and-sudo-rules-in-idm_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 34. Using Ansible to configure HBAC and sudo rules in IdM\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tUsing host-based access control (HBAC) in Identity Management (IdM), you can define policies that restrict access to hosts or services based on the following:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\tThe user attempting to log in and this user’s groups\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe host that a user is trying to access and the host groups to which that host belongs\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe service that is being used to access a host\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tUsing \u003Ccode class=\"literal\">sudo\u003C/code>, a user can run programs as another user, with different privileges, for example \u003Ccode class=\"literal\">root\u003C/code> privileges. In IdM, you can manage sudo rules centrally. You can define \u003Ccode class=\"literal\">sudo\u003C/code> rules based on user groups, host groups and command groups, as well as individual users, hosts and commands.\n\t\t\u003C/p>\u003Cp>\n\t\t\tComplete this procedure to ensure the presence of the following HBAC and \u003Ccode class=\"literal\">sudo\u003C/code> rules for IdM users:\n\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>jane\u003C/strong>\u003C/span> can only access host \u003Cspan class=\"strong strong\">\u003Cstrong>client01.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>john\u003C/strong>\u003C/span> can only access host \u003Cspan class=\"strong strong\">\u003Cstrong>client02.idm.example.com\u003C/strong>\u003C/span>.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tMembers of the \u003Ccode class=\"literal\">admins\u003C/code> group, which includes the default \u003Ccode class=\"literal\">admin\u003C/code> user as well as the regular \u003Cspan class=\"strong strong\">\u003Cstrong>alice\u003C/strong>\u003C/span> user, can access any IdM host.\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tMembers of the \u003Ccode class=\"literal\">admins\u003C/code> group can run \u003Ccode class=\"literal\">sudo\u003C/code> with the following commands on any IdM host:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/sbin/reboot\u003C/code>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/bin/less\u003C/code>\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/sbin/setenforce\u003C/code>\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\tThe following diagram represents the desired configuration described above:\n\t\t\u003C/p>\u003Cdiv class=\"figure\" id=\"idm140464223506352\">\u003Cp class=\"title\">\u003Cstrong>Figure 34.1. IdM HBAC and SUDO rules diagram\u003C/strong>\u003C/p>\u003Cdiv class=\"figure-contents\">\u003Cdiv class=\"mediaobject\">\u003Cimg src=\"https://access.redhat.com/webassets/avalon/d/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US/images/9ac887ea3137cab8794a4dde6fa5fb11/IdM_HBAC_and_SUDO_rules_diagram.png\" alt=\"An image of IdM users and hosts showing different types of host access and sudo privileges for different users\"/>\u003C/div>\u003C/div>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tOn the control node:\n\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory.\n\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\tYou have stored your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code> in the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault.\n\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\tThe users \u003Cspan class=\"strong strong\">\u003Cstrong>jane\u003C/strong>\u003C/span>, \u003Cspan class=\"strong strong\">\u003Cstrong>john\u003C/strong>\u003C/span> and \u003Cspan class=\"strong strong\">\u003Cstrong>alice\u003C/strong>\u003C/span> exist in IdM. Passwords are configured for these accounts.\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tCreate your Ansible playbook file \u003Cspan class=\"strong strong\">\u003Cstrong>add-hbac-and-sudo-rules-to-idm.yml\u003C/strong>\u003C/span> with the following content:\n\t\t\t\t\u003C/p>\u003Cpre class=\"screen\">---\n- name: Playbook to manage IPA HBAC and SUDO rules\n  hosts: ipaserver\n  become: false\n  gather_facts: false\n\n  vars_files:\n  - /home/&lt;user_name&gt;/MyPlaybooks/secret.yml\n\n  module_defaults:\n    ipahbacrule:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n    ipagroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n    ipasudocmd:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n    ipasudocmdgroup:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n    ipasudorule:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n\n  tasks:\n  - name: HBAC Rule for Jane - can log in to client01\n    ipahbacrule: # Creates the rule\n      name: Jane_rule\n      hbacsvc:\n      - sshd\n      - login\n      host: # Host name\n      - client01.idm.example.com\n      user:\n      - jane\n\n  - name: HBAC Rule for John - can log in to client02\n    ipahbacrule: # Creates the rule\n      name: john_rule\n      hbacsvc:\n      - sshd\n      - login\n      host: # Host name\n      - client02.idm.example.com\n      user:\n      - john\n\n  - name: Add user member alice to group admins\n    ipagroup:\n      name: admins\n      action: member\n      user:\n      - alice\n\n  - name: HBAC Rule for IdM administrators\n    ipahbacrule: # Rule to allow admins full access\n      name: admin_access # Rule name\n      servicecat: all # All services\n      hostcat: all # All hosts\n      group: # User group\n      - admins\n\n    - name: Add reboot command to SUDO\n      ipasudocmd:\n        name: /usr/sbin/reboot\n        state: present\n    - name: Add less command to SUDO\n      ipasudocmd:\n        name: /usr/bin/less\n        state: present\n    - name: Add setenforce command to SUDO\n      ipasudocmd:\n        name: /usr/sbin/setenforce\n        state: present\n\n  - name: Create a SUDO command group\n    ipasudocmdgroup:\n      name: cmd_grp_1\n      description: \"Group of important commands\"\n      sudocmd:\n      - /usr/sbin/setenforce\n      - /usr/bin/less\n      - /usr/sbin/reboot\n      action: sudocmdgroup\n      state: present\n\n  - name: Create a SUDO rule with a SUDO command group\n    ipasudorule:\n      name: sudo_rule_1\n      allow_sudocmdgroup:\n      - cmd_grp_1\n      group: admins\n      state: present\n\n  - name: Disable allow_all HBAC Rule\n    ipahbacrule: # Rule to allow admins full access\n      name: allow_all # Rule name\n      state: disabled # Disables rule to allow everyone the ability to login\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tRun the playbook:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -i inventory add-hbac-and-sudo-rules-to-idm.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tConnect to client01 as the jane user:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>~]$ ssh jane@client01\u003C/strong>\u003C/span>\nPassword:\n\nLast login: Fri Aug 11 15:32:18 2023 from 192.168.122.1\n[jane@client01 ~]$\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tThe output verifies that jane has logged in to client01.\n\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tTry to connect to client02 as the jane user:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>~]$ ssh jane@client02\u003C/strong>\u003C/span>\nPassword:\nConnection closed by 192.168.122.47 port 22\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tThe output verifies that jane cannot log in to client02.\n\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tConnect to client02 as the alice user:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">\u003Cspan class=\"strong strong\">\u003Cstrong>~]$ ssh alice@client02\u003C/strong>\u003C/span>\nPassword:\n\nLast login: Fri Aug 10 16:13:43 2023 from 192.168.122.1\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tThe output verifies that alice has logged in to client02.\n\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tTry to view the contents of the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file using \u003Ccode class=\"literal\">less\u003C/code> without invoking the superuser privileges:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[alice@client02 ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>less /etc/sssd/sssd.conf\u003C/strong>\u003C/span>\n/etc/sssd/sssd.conf: Permission denied\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tThe attempt fails as the file is not readable by anyone except the owner of the file, which is \u003Ccode class=\"literal\">root\u003C/code>.\n\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\tInvoke the \u003Ccode class=\"literal\">root\u003C/code> privileges to view the contents of the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file using \u003Ccode class=\"literal\">less\u003C/code>:\n\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[alice@client02 ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>sudo less /etc/sssd/sssd.conf\u003C/strong>\u003C/span>\n[sudo] password for alice:\n\n[domain/idm.example.com]\n\nid_provider = ipa\nipa_server_mode = True\n[...]\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\tThe output verifies that alice can execute the \u003Ccode class=\"literal\">less\u003C/code> command on the \u003Ccode class=\"literal\">/etc/sssd/sssd.conf\u003C/code> file.\n\t\t\t\t\u003C/p>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#host-based-access-control-rules-in-idm_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks\" title=\"21.1. Host-based access control rules in IdM\">Host-based access control rules in IdM\u003C/a>\n\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\u003Ca class=\"link\" href=\"#sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client\" title=\"20.1. Sudo access on an IdM client\">Sudo access on an IdM client\u003C/a>\n\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"chapter\" id=\"using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 35. Using Ansible to delegate authentication for IdM users to external identity providers\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tYou can use the \u003Ccode class=\"literal\">idp\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module to associate users with external identity providers (IdP) that support the OAuth 2 device authorization flow. If an IdP reference and an associated IdP user ID exist, you can use them to enable IdP authentication for an IdM user with the \u003Ccode class=\"literal\">user\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module.\n\t\t\u003C/p>\u003Cp>\n\t\t\tAfterward, if these users authenticate with the SSSD version available in RHEL 9.1 or later, they receive RHEL Identity Management (IdM) single sign-on capabilities with Kerberos tickets after performing authentication and authorization at the external IdP.\n\t\t\u003C/p>\u003Csection class=\"section\" id=\"con_the-benefits-of-connecting-idm-to-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">35.1. The benefits of connecting IdM to an external IdP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tAs an administrator, you might want to allow users stored in an external identity source, such as a cloud services provider, to access RHEL systems joined to your Identity Management (IdM) environment. To achieve this, you can delegate the authentication and authorization process of issuing Kerberos tickets for these users to that external entity.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tYou can use this feature to expand IdM’s capabilities and allow users stored in external identity providers (IdPs) to access Linux systems managed by IdM.\n\t\t\t\u003C/p>\u003C/section>\u003Csection class=\"section\" id=\"how-idm-incorporates-logins-via-external-idps_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">35.2. How IdM incorporates logins via external IdPs\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tSSSD 2.7.0 contains the \u003Ccode class=\"literal\">sssd-idp\u003C/code> package, which implements the \u003Ccode class=\"literal\">idp\u003C/code> Kerberos pre-authentication method. This authentication method follows the OAuth 2.0 Device Authorization Grant flow to delegate authorization decisions to external IdPs:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAn IdM client user initiates OAuth 2.0 Device Authorization Grant flow, for example, by attempting to retrieve a Kerberos TGT with the \u003Ccode class=\"literal\">kinit\u003C/code> utility at the command line.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tA special code and website link are sent from the Authorization Server to the IdM KDC backend.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM client displays the link and the code to the user. In this example, the IdM client outputs the link and code on the command line.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe user opens the website link in a browser, which can be on another host, a mobile phone, and so on:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe user enters the special code.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tIf necessary, the user logs in to the OAuth 2.0-based IdP.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe user is prompted to authorize the client to access information.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user confirms access at the original device prompt. In this example, the user hits the \u003Ckbd class=\"keycap\">Enter\u003C/kbd> key at the command line.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe IdM KDC backend polls the OAuth 2.0 Authorization Server for access to user information.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>What is supported:\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLogging in remotely via SSH with the \u003Ccode class=\"literal\">keyboard-interactive\u003C/code> authentication method enabled, which allows calling Pluggable Authentication Module (PAM) libraries.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLogging in locally with the console via the \u003Ccode class=\"literal\">logind\u003C/code> service.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRetrieving a Kerberos ticket-granting ticket (TGT) with the \u003Ccode class=\"literal\">kinit\u003C/code> utility.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>What is currently not supported:\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLogging in to the IdM WebUI directly. To log in to the IdM WebUI, you must first acquire a Kerberos ticket.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tLogging in to Cockpit WebUI directly. To log in to the Cockpit WebUI, you must first acquire a Kerberos ticket.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://freeipa.readthedocs.io/en/latest/workshop/12-external-idp-support.html\">Authentication against external Identity Providers\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://www.rfc-editor.org/rfc/rfc8628\">RFC 8628: OAuth 2.0 Device Authorization Grant\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">35.3. Using Ansible to create a reference to an external identity provider\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo connect external identity providers (IdPs) to your Identity Management (IdM) environment, create IdP references in IdM. Complete this procedure to use the \u003Ccode class=\"literal\">idp\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module to configure a reference to the \u003Cspan class=\"strong strong\">\u003Cstrong>github\u003C/strong>\u003C/span> external IdP.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have registered IdM as an OAuth application to your external IdP, and generated a client ID and client secret on the device that an IdM user will be using to authenticate to IdM. The example assumes that:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\t\u003Cspan class=\"strong strong\">\u003Cstrong>my_github_account_name\u003C/strong>\u003C/span> is the github user whose account the IdM user will be using to authenticate to IdM.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">client ID\u003C/code> is \u003Cspan class=\"strong strong\">\u003Cstrong>2efe1acffe9e8ab869f4\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe \u003Ccode class=\"literal\">client secret\u003C/code> is \u003Cspan class=\"strong strong\">\u003Cstrong>656a5228abc5f9545c85fa626aecbf69312d398c\u003C/strong>\u003C/span>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM servers are using RHEL 9.1 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM servers are using SSSD 2.7.0 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using RHEL 9.4 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your Ansible control node, create an \u003Cspan class=\"strong strong\">\u003Cstrong>configure-external-idp-reference.yml\u003C/strong>\u003C/span> playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Configure external IdP\n  hosts: ipaserver\n  become: false\n  gather_facts: false\n\n  tasks:\n  - name: Ensure a reference to github external provider is available\n    ipaidp:\n      ipaadmin_password: \u003Cspan class=\"strong strong\">\u003Cstrong>\"{{ ipaadmin_password }}\"\u003C/strong>\u003C/span>\n      name: \u003Cspan class=\"strong strong\">\u003Cstrong>github_idp\u003C/strong>\u003C/span>\n      provider: \u003Cspan class=\"strong strong\">\u003Cstrong>github\u003C/strong>\u003C/span>\n      client_ID: \u003Cspan class=\"strong strong\">\u003Cstrong>2efe1acffe9e8ab869f4\u003C/strong>\u003C/span>\n      secret: \u003Cspan class=\"strong strong\">\u003Cstrong>656a5228abc5f9545c85fa626aecbf69312d398c\u003C/strong>\u003C/span>\n      idp_user_id: \u003Cspan class=\"strong strong\">\u003Cstrong>my_github_account_name\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory configure-external-idp-reference.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn an IdM client, verify that the output of the \u003Ccode class=\"literal\">ipa idp-show\u003C/code> command shows the IdP reference you have created.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idmuser@idmclient ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa idp-show \u003Cspan class=\"emphasis\">\u003Cem>github_idp\u003C/em>\u003C/span>\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Next steps\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"#using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\" title=\"35.4. Using Ansible to enable an IdM user to authenticate via an external IdP\">Using Ansible to enable an IdM user to authenticate via an external IdP\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-idp.md\">idp\u003C/a> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream documentation\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">35.4. Using Ansible to enable an IdM user to authenticate via an external IdP\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">user\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module to enable an Identity Management (IdM) user to authenticate via an external identity provider (IdP). To do that, associate the external IdP reference you have previously created with the IdM user account. Complete this procedure to use Ansible to associate an external IdP reference named \u003Cspan class=\"strong strong\">\u003Cstrong>github_idp\u003C/strong>\u003C/span> with the IdM user named \u003Cspan class=\"strong strong\">\u003Cstrong>idm-user-with-external-idp\u003C/strong>\u003C/span>. As a result of the procedure, the user is able to use the \u003Cspan class=\"strong strong\">\u003Cstrong>my_github_account_name\u003C/strong>\u003C/span> github identity to authenticate as \u003Cspan class=\"strong strong\">\u003Cstrong>idm-user-with-external-idp\u003C/strong>\u003C/span> to IdM.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM client and IdM servers are using RHEL 9.1 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM client and IdM servers are using SSSD 2.7.0 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a reference to an external IdP in IdM. See \u003Ca class=\"link\" href=\"#using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\" title=\"35.3. Using Ansible to create a reference to an external identity provider\">Using Ansible to create a reference to an external identity provider\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tYou have configured your Ansible control node to meet the following requirements:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"circle\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using Ansible version 2.15 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou have installed the \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/installing_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_installing-identity-management#installing-the-ansible-freeipa-package_server-ansible\">\u003Ccode class=\"literal\">ansible-freeipa\u003C/code>\u003C/a> package on the Ansible controller.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tYou are using RHEL 9.4 or later.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that in the \u003Cspan class=\"strong strong\">\u003Cstrong>~/\u003Cspan class=\"emphasis\">\u003Cem>MyPlaybooks\u003C/em>\u003C/span>/\u003C/strong>\u003C/span> directory, you have created an \u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management\">Ansible inventory file\u003C/a> with the fully-qualified domain name (FQDN) of the IdM server.\n\t\t\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tThe example assumes that the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> Ansible vault stores your \u003Ccode class=\"literal\">ipaadmin_password\u003C/code>.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOn your Ansible control node, create an \u003Cspan class=\"strong strong\">\u003Cstrong>enable-user-to-authenticate-via-external-idp.yml\u003C/strong>\u003C/span> playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Ensure an IdM user uses an external IdP to authenticate to IdM\n  hosts: ipaserver\n  become: false\n  gather_facts: false\n\n  tasks:\n  - name: Retrieve Github user ID\n    ansible.builtin.uri:\n      url: “https://api.github.com/users/my_github_account_name”\n      method: GET\n      headers:\n        Accept: “application/vnd.github.v3+json”\n    register: user_data\n\n  - name: Ensure IdM user exists with an external IdP authentication\n    ipauser:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: \u003Cspan class=\"strong strong\">\u003Cstrong>idm-user-with-external-idp\u003C/strong>\u003C/span>\n      first: Example\n      last: User\n      userauthtype: \u003Cspan class=\"strong strong\">\u003Cstrong>idp\u003C/strong>\u003C/span>\n      idp: \u003Cspan class=\"strong strong\">\u003Cstrong>github_idp\u003C/strong>\u003C/span>\n      idp_user_id: \u003Cspan class=\"strong strong\">\u003Cstrong>my_github_account_name\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tSave the file.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the Ansible playbook. Specify the playbook file, the file storing the password protecting the \u003Cspan class=\"strong strong\">\u003Cstrong>secret.yml\u003C/strong>\u003C/span> file, and the inventory file:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --vault-password-file=password_file -v -i inventory enable-user-to-authenticate-via-external-idp.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tLog in to an IdM client and verify that the output of the \u003Ccode class=\"literal\">ipa user-show\u003C/code> command for the \u003Cspan class=\"strong strong\">\u003Cstrong>idm-user-with-external-idp\u003C/strong>\u003C/span> user displays references to the IdP:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ipa user-show idm-user-with-external-idp\u003C/strong>\u003C/span>\nUser login: idm-user-with-external-idp\nFirst name: Example\nLast name: User\nHome directory: /home/idm-user-with-external-idp\nLogin shell: /bin/sh\nPrincipal name: idm-user-with-external-idp@idm.example.com\nPrincipal alias: idm-user-with-external-idp@idm.example.com\nEmail address: idm-user-with-external-idp@idm.example.com\nID: 35000003\nGID: 35000003\n\u003Cspan class=\"strong strong\">\u003Cstrong>User authentication types: idp\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>External IdP configuration: github\u003C/strong>\u003C/span>\n\u003Cspan class=\"strong strong\">\u003Cstrong>External IdP user identifier: idm-user-with-external-idp@idm.example.com\u003C/strong>\u003C/span>\nAccount disabled: False\nPassword: False\nMember of groups: ipausers\nKerberos keys available: False\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe \u003Ca class=\"link\" href=\"https://github.com/freeipa/ansible-freeipa/blob/master/README-idp.md\">idp\u003C/a> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> upstream documentation\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"retrieving-an-idm-ticket-granting-ticket-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">35.5. Retrieving an IdM ticket-granting ticket as an external IdP user\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tIf you have delegated authentication for an Identity Management (IdM) user to an external identity provider (IdP), the IdM user can request a Kerberos ticket-granting ticket (TGT) by authenticating to the external IdP.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tComplete this procedure to:\n\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRetrieve and store an anonymous Kerberos ticket locally.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tRequest the TGT for the \u003Cspan class=\"strong strong\">\u003Cstrong>idm-user-with-external-idp\u003C/strong>\u003C/span> user by using \u003Ccode class=\"literal\">kinit\u003C/code> with the \u003Ccode class=\"literal\">-T\u003C/code> option to enable Flexible Authentication via Secure Tunneling (FAST) channel to provide a secure connection between the Kerberos client and Kerberos Distribution Center (KDC).\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM client and IdM servers use RHEL 9.1 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM client and IdM servers use SSSD 2.7.0 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a reference to an external IdP in IdM. See \u003Ca class=\"link\" href=\"#using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\" title=\"35.3. Using Ansible to create a reference to an external identity provider\">Using Ansible to create a reference to an external identity provider\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have associated an external IdP reference with the user account. See \u003Ca class=\"link\" href=\"#using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\" title=\"35.4. Using Ansible to enable an IdM user to authenticate via an external IdP\">Using Ansible to enable an IdM user to authenticate via an external IdP\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe user that you are initially logged in as has write permissions on a directory in the local filesystem.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tUse Anonymous PKINIT to obtain a Kerberos ticket and store it in a file named \u003Ccode class=\"literal\">./fast.ccache\u003C/code>.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>kinit -n -c ./fast.ccache\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tOptional: View the retrieved ticket:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>klist -c fast.ccache\u003C/strong>\u003C/span>\nTicket cache: FILE:fast.ccache\nDefault principal: WELLKNOWN/ANONYMOUS@WELLKNOWN:ANONYMOUS\n\nValid starting       Expires              Service principal\n03/03/2024 13:36:37  03/04/2024 13:14:28  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tBegin authenticating as the IdM user, using the \u003Ccode class=\"literal\">-T\u003C/code> option to enable the FAST communication channel.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@client ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>kinit -T ./fast.ccache idm-user-with-external-idp\u003C/strong>\u003C/span>\nAuthenticate at https://oauth2.idp.com:8443/auth/realms/master/device?user_code=YHMQ-XKTL and press ENTER.:\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn a browser, authenticate as the user at the website provided in the command output.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAt the command line, press the \u003Ckbd class=\"keycap\">Enter\u003C/kbd> key to finish the authentication process.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay your Kerberos ticket information and confirm that the line \u003Ccode class=\"literal\">config: pa_type\u003C/code> shows \u003Ccode class=\"literal\">152\u003C/code> for pre-authentication with an external IdP.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[root@client ~]# \u003Cspan class=\"strong strong\">\u003Cstrong>klist -C\u003C/strong>\u003C/span>\nTicket cache: KCM:0:58420\nDefault principal: idm-user-with-external-idp@IDM.EXAMPLE.COM\n\nValid starting     Expires            Service principal\n05/09/22 07:48:23  05/10/22 07:03:07  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\nconfig: fast_avail(krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM) = yes\n08/17/2022 20:22:45  08/18/2022 20:22:43  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\n\u003Cspan class=\"strong strong\">\u003Cstrong>config: pa_type(krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM) = 152\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe \u003Ccode class=\"literal\">pa_type = 152\u003C/code> indicates external IdP authentication.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"logging-in-to-an-idm-client-via-ssh-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">35.6. Logging in to an IdM client via SSH as an external IdP user\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tTo log in to an IdM client via SSH as an external identity provider (IdP) user, begin the login process on the command linel. When prompted, perform the authentication process at the website associated with the IdP, and finish the process at the Identity Management (IdM) client.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM client and IdM servers are using RHEL 9.1 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYour IdM client and IdM servers are using SSSD 2.7.0 or later.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have created a reference to an external IdP in IdM. See \u003Ca class=\"link\" href=\"#using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\" title=\"35.3. Using Ansible to create a reference to an external identity provider\">Using Ansible to create a reference to an external identity provider\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou have associated an external IdP reference with the user account. See \u003Ca class=\"link\" href=\"#using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\" title=\"35.4. Using Ansible to enable an IdM user to authenticate via an external IdP\">Using Ansible to enable an IdM user to authenticate via an external IdP\u003C/a>.\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tAttempt to log in to the IdM client via SSH.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[user@client ~]$ \u003Cspan class=\"strong strong\">\u003Cstrong>ssh idm-user-with-external-idp@client.idm.example.com\u003C/strong>\u003C/span>\n(idm-user-with-external-idp@client.idm.example.com) Authenticate at https://oauth2.idp.com:8443/auth/realms/main/device?user_code=XYFL-ROYR and press ENTER.\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tIn a browser, authenticate as the user at the website provided in the command output.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tAt the command line, press the \u003Ckbd class=\"keycap\">Enter\u003C/kbd> key to finish the authentication process.\n\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tDisplay your Kerberos ticket information and confirm that the line \u003Ccode class=\"literal\">config: pa_type\u003C/code> shows \u003Ccode class=\"literal\">152\u003C/code> for pre-authentication with an external IdP.\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">[idm-user-with-external-idp@client ~]$ klist -C\nTicket cache: KCM:0:58420\nDefault principal: idm-user-with-external-idp@IDM.EXAMPLE.COM\n\nValid starting     Expires            Service principal\n05/09/22 07:48:23  05/10/22 07:03:07  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\nconfig: fast_avail(krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM) = yes\n08/17/2022 20:22:45  08/18/2022 20:22:43  krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM\n\u003Cspan class=\"strong strong\">\u003Cstrong>config: pa_type(krbtgt/IDM.EXAMPLE.COM@IDM.EXAMPLE.COM) = 152\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003Csection class=\"section\" id=\"the-provider-option-in-the-ipaidp-ansible-module_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">35.7. The provider option in the ipaidp Ansible module\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\t\tThe following identity providers (IdPs) support OAuth 2.0 device authorization grant flow:\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\tMicrosoft Identity Platform, including Azure AD\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tGoogle\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tGitHub\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tKeycloak, including Red Hat Single Sign-On (SSO)\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tOkta\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003Cp>\n\t\t\t\tWhen using the \u003Ccode class=\"literal\">idp\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> module to create a reference to one of these external IdPs, you can specify the IdP type with the \u003Ccode class=\"literal\">provider\u003C/code> option in your \u003Ccode class=\"literal\">ipaidp\u003C/code> \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> playbook task, which expands into additional options as described below:\n\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">provider: microsoft\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tMicrosoft Azure IdPs allow parametrization based on the Azure tenant ID, which you can specify with the \u003Ccode class=\"literal\">organization\u003C/code> option. If you need support for the live.com IdP, specify the option \u003Ccode class=\"literal\">organization common\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tChoosing \u003Ccode class=\"literal\">provider: microsoft\u003C/code> expands to use the following options. The value of the \u003Ccode class=\"literal\">organization\u003C/code> option replaces the string \u003Ccode class=\"literal\">${ipaidporg}\u003C/code> in the table.\n\t\t\t\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 67%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464223945872\" scope=\"col\">Option\u003C/th>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464223944784\" scope=\"col\">Value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223945872\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223944784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://login.microsoftonline.com/${ipaidporg}/oauth2/v2.0/authorize\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223945872\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">dev_auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223944784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://login.microsoftonline.com/${ipaidporg}/oauth2/v2.0/devicecode\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223945872\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">token_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223944784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://login.microsoftonline.com/${ipaidporg}/oauth2/v2.0/token\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223945872\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">userinfo_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223944784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://graph.microsoft.com/oidc/userinfo\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223945872\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">keys_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223944784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://login.microsoftonline.com/common/discovery/v2.0/keys\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223945872\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">scope: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223944784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">openid email\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223945872\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">idp_user_id: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223944784\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">email\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">provider: google\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tChoosing \u003Ccode class=\"literal\">provider: google\u003C/code> expands to use the following options:\n\t\t\t\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 67%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464223074544\" scope=\"col\">Option\u003C/th>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464223073456\" scope=\"col\">Value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223074544\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223073456\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://accounts.google.com/o/oauth2/auth\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223074544\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">dev_auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223073456\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://oauth2.googleapis.com/device/code\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223074544\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">token_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223073456\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://oauth2.googleapis.com/token\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223074544\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">userinfo_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223073456\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://openidconnect.googleapis.com/v1/userinfo\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223074544\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">keys_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223073456\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://www.googleapis.com/oauth2/v3/certs\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223074544\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">scope: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223073456\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">openid email\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223074544\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">idp_user_id: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223073456\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">email\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">provider: github\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tChoosing \u003Ccode class=\"literal\">provider: github\u003C/code> expands to use the following options:\n\t\t\t\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 67%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464223032304\" scope=\"col\">Option\u003C/th>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464223031216\" scope=\"col\">Value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223032304\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223031216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://github.com/login/oauth/authorize\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223032304\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">dev_auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223031216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://github.com/login/device/code\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223032304\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">token_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223031216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://github.com/login/oauth/access_token\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223032304\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">userinfo_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223031216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://openidconnect.googleapis.com/v1/userinfo\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223032304\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">keys_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223031216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://api.github.com/user\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223032304\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">scope: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223031216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">user\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223032304\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">idp_user_id: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464223031216\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">login\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">provider: keycloak\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tWith Keycloak, you can define multiple realms or organizations. Since it is often a part of a custom deployment, both base URL and realm ID are required, and you can specify them with the \u003Ccode class=\"literal\">base_url\u003C/code> and \u003Ccode class=\"literal\">organization\u003C/code> options in your \u003Ccode class=\"literal\">ipaidp\u003C/code> playbook task:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA idp\n  hosts: ipaserver\n  become: false\n\n  tasks:\n  - name: Ensure keycloak idp my-keycloak-idp is present using provider\n    ipaidp:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: my-keycloak-idp\n      provider: keycloak\n      organization: \u003Cspan class=\"strong strong\">\u003Cstrong>main\u003C/strong>\u003C/span>\n      base_url: \u003Cspan class=\"strong strong\">\u003Cstrong>keycloak.domain.com:8443/auth\u003C/strong>\u003C/span>\n      client_id: my-keycloak-client-id\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tChoosing \u003Ccode class=\"literal\">provider: keycloak\u003C/code> expands to use the following options. The value you specify in the \u003Ccode class=\"literal\">base_url\u003C/code> option replaces the string \u003Ccode class=\"literal\">${ipaidpbaseurl}\u003C/code> in the table, and the value you specify for the \u003Ccode class=\"literal\">organization `option replaces the string `${ipaidporg}\u003C/code>.\n\t\t\t\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 67%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464222983856\" scope=\"col\">Option\u003C/th>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464222982768\" scope=\"col\">Value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222983856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222982768\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://${ipaidpbaseurl}/realms/${ipaidporg}/protocol/openid-connect/auth\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222983856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">dev_auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222982768\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://${ipaidpbaseurl}/realms/${ipaidporg}/protocol/openid-connect/auth/device\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222983856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">token_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222982768\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://${ipaidpbaseurl}/realms/${ipaidporg}/protocol/openid-connect/token\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222983856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">userinfo_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222982768\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://${ipaidpbaseurl}/realms/${ipaidporg}/protocol/openid-connect/userinfo\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222983856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">scope: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222982768\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">openid email\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222983856\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">idp_user_id: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222982768\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">email\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">provider: okta\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tAfter registering a new organization in Okta, a new base URL is associated with it. You can specify this base URL with the \u003Ccode class=\"literal\">base_url\u003C/code> option in the \u003Ccode class=\"literal\">ipaidp\u003C/code> playbook task:\n\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">---\n- name: Playbook to manage IPA idp\n  hosts: ipaserver\n  become: false\n\n  tasks:\n  - name: Ensure okta idp my-okta-idp is present using provider\n    ipaidp:\n      ipaadmin_password: \"{{ ipaadmin_password }}\"\n      name: my-okta-idp\n      provider: okta\n      base_url: \u003Cspan class=\"strong strong\">\u003Cstrong>dev-12345.okta.com\u003C/strong>\u003C/span>\n      client_id: my-okta-client-id\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\tChoosing \u003Ccode class=\"literal\">provider: okta\u003C/code> expands to use the following options. The value you specify for the \u003Ccode class=\"literal\">base_url\u003C/code> option replaces the string \u003Ccode class=\"literal\">${ipaidpbaseurl}\u003C/code> in the table.\n\t\t\t\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"lt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 33%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 67%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464222941712\" scope=\"col\">Option\u003C/th>\u003Cth style=\"text-align: left; vertical-align: top; \" id=\"idm140464222940624\" scope=\"col\">Value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222941712\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222940624\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://${ipaidpbaseurl}/oauth2/v1/authorize\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222941712\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">dev_auth_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222940624\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://${ipaidpbaseurl}/oauth2/v1/device/authorize\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222941712\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">token_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222940624\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://${ipaidpbaseurl}/oauth2/v1/token\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222941712\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">userinfo_uri: URI\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222940624\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">https://${ipaidpbaseurl}/oauth2/v1/userinfo\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222941712\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">scope: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222940624\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">openid email\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222941712\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">idp_user_id: STR\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd style=\"text-align: left; vertical-align: top; \" headers=\"idm140464222940624\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t\t\u003Ccode class=\"literal\">email\u003C/code>\n\t\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/dd>\u003C/dl>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://freeipa.readthedocs.io/en/latest/designs/external-idp/idp-api.html#pre-populated-idp-templates\">Pre-populated IdP templates\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Csection class=\"chapter\" id=\"integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch2 class=\"title\">Chapter 36. Joining RHEL systems to an Active Directory by using RHEL system roles\u003C/h2>\u003C/div>\u003C/div>\u003C/div>\u003Cp class=\"_abstract _abstract\">\n\t\t\tIf your organization uses Microsoft Active Directory (AD) to centrally manage users, groups, and other resources, you can join your Red Hat Enterprise Linux (RHEL) host to this AD. For example, AD users can then log into RHEL and you can make services on the RHEL host available for authenticated AD users. By using the \u003Ccode class=\"literal\">ad_integration\u003C/code> RHEL system role, you can automate the integration of Red Hat Enterprise Linux system into an Active Directory (AD) domain.\n\t\t\u003C/p>\u003Crh-alert class=\"admonition note\" state=\"info\">\u003Cdiv class=\"admonition_header\" slot=\"header\">Note\u003C/div>\u003Cdiv>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">ad_integration\u003C/code> role is for deployments using direct AD integration without an Identity Management (IdM) environment. For IdM environments, use the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> roles.\n\t\t\t\u003C/p>\u003Cp>\n\t\t\t\tThe \u003Ccode class=\"literal\">ad_integration\u003C/code> system role is not included in the \u003Ccode class=\"literal\">ansible-freeipa\u003C/code> package. It is part of the \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> package. You can install \u003Ccode class=\"literal\">rhel-system-roles\u003C/code> on systems with a \u003Ccode class=\"literal\">Red Hat Enterprise Linux Server\u003C/code> subscription attached.\n\t\t\t\u003C/p>\u003C/div>\u003C/rh-alert>\u003Csection class=\"section\" id=\"connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles\">\u003Cdiv class=\"titlepage\">\u003Cdiv>\u003Cdiv>\u003Ch3 class=\"title\">36.1. Joining RHEL to an Active Directory domain by using the \u003Ccode class=\"literal\">ad_integration\u003C/code> RHEL system role\u003C/h3>\u003C/div>\u003C/div>\u003C/div>\u003Cp>\n\t\t\t\tYou can use the \u003Ccode class=\"literal\">ad_integration\u003C/code> RHEL system role to automate the process of joining RHEL to an Active Directory (AD) domain.\n\t\t\t\u003C/p>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Prerequisites\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/assembly_preparing-a-control-node-and-managed-nodes-to-use-rhel-system-roles_automating-system-administration-by-using-rhel-system-roles\">You have prepared the control node and the managed nodes\u003C/a>\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tYou are logged in to the control node as a user who can run playbooks on the managed nodes.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe account you use to connect to the managed nodes has \u003Ccode class=\"literal\">sudo\u003C/code> permissions on them.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tThe managed node uses a DNS server that can resolve AD DNS entries.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\tCredentials of an AD account which has permissions to join computers to the domain.\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe managed node can establish connections to AD domain controllers by using the following ports:\n\t\t\t\t\t\u003C/p>\u003Crh-table>\u003Ctable class=\"gt-4-cols lt-7-rows\">\u003Ccolgroup>\u003Ccol style=\"width: 20%; \" class=\"col_1\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_2\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 20%; \" class=\"col_3\">\u003C!--Empty-->\u003C/col>\u003Ccol style=\"width: 40%; \" class=\"col_4\">\u003C!--Empty-->\u003C/col>\u003C/colgroup>\u003Cthead>\u003Ctr>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464222880608\" scope=\"col\">Source Ports\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464222879520\" scope=\"col\">Destination Port\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464222878432\" scope=\"col\">Protocol\u003C/th>\u003Cth align=\"left\" valign=\"top\" id=\"idm140464222877344\" scope=\"col\">Service\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t53\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP and TCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tDNS\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t389\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP and TCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tLDAP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t636\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tTCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tLDAPS\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t88\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP and TCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tKerberos\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t464\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP and TCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tKerberos password change requests\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t3268\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tTCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tLDAP Global Catalog\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t3269\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tTCP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tLDAPS Global Catalog\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t123\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tNTP (if time synchronization is enabled)\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003Ctr>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222880608\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t1024 - 65535\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222879520\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\t323\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222878432\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tUDP\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003Ctd align=\"left\" valign=\"top\" headers=\"idm140464222877344\"> \u003Cp>\n\t\t\t\t\t\t\t\t\t\tNTP (if time synchronization is enabled)\n\t\t\t\t\t\t\t\t\t\u003C/p>\n\t\t\t\t\t\t\t\t\t \u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\u003C/rh-table>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"orderedlist\">\u003Cp class=\"title\">\u003Cstrong>Procedure\u003C/strong>\u003C/p>\u003Col class=\"orderedlist\" type=\"1\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tStore your sensitive variables in an encrypted file:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"orderedlist\">\u003Col class=\"orderedlist\" type=\"a\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tCreate the vault:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-vault create vault.yml\u003C/strong>\u003C/span>\nNew Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\nConfirm New Vault password: \u003Cspan class=\"emphasis\">\u003Cem>&lt;vault_password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\tAfter the \u003Ccode class=\"literal\">ansible-vault create\u003C/code> command opens an editor, enter the sensitive data in the \u003Ccode class=\"literal\">\u003Cspan class=\"emphasis\">\u003Cem>&lt;key&gt;\u003C/em>\u003C/span>: \u003Cspan class=\"emphasis\">\u003Cem>&lt;value&gt;\u003C/em>\u003C/span>\u003C/code> format:\n\t\t\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-ini\">usr: administrator\npwd: \u003Cspan class=\"emphasis\">\u003Cem>&lt;password&gt;\u003C/em>\u003C/span>\u003C/pre>\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\t\tSave the changes, and close the editor. Ansible encrypts the data in the vault.\n\t\t\t\t\t\t\t\u003C/li>\u003C/ol>\u003C/div>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCreate a playbook file, for example \u003Ccode class=\"literal\">~/playbook.yml\u003C/code>, with the following content:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"programlisting language-yaml\">---\n- name: Active Directory integration\n  hosts: managed-node-01.example.com\n  vars_files:\n    - vault.yml\n  tasks:\n    - name: Join an Active Directory\n      ansible.builtin.include_role:\n        name: rhel-system-roles.ad_integration\n      vars:\n        ad_integration_user: \"{{ usr }}\"\n        ad_integration_password: \"{{ pwd }}\"\n        ad_integration_realm: \"ad.example.com\"\n        ad_integration_allow_rc4_crypto: false\n        ad_integration_timesync_source: \"time_server.ad.example.com\"\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tThe settings specified in the example playbook include the following:\n\t\t\t\t\t\u003C/p>\u003Cdiv class=\"variablelist\">\u003Cdl class=\"variablelist\">\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ad_integration_allow_rc4_crypto: \u003Cspan class=\"emphasis\">\u003Cem>&lt;true|false&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tConfigures whether the role activates the \u003Ccode class=\"literal\">AD-SUPPORT\u003C/code> crypto policy on the managed node. By default, RHEL does not support the weak RC4 encryption but, if Kerberos in your AD still requires RC4, you can enable this encryption type by setting \u003Ccode class=\"literal\">ad_integration_allow_rc4_crypto: true\u003C/code>.\n\t\t\t\t\t\t\t\t\u003C/p>\u003Cp class=\"simpara\">\n\t\t\t\t\t\t\t\t\tOmit this the variable or set it to \u003Ccode class=\"literal\">false\u003C/code> if Kerberos uses AES encryption.\n\t\t\t\t\t\t\t\t\u003C/p>\u003C/dd>\u003Cdt>\u003Cspan class=\"term\">\u003Ccode class=\"literal\">ad_integration_timesync_source: \u003Cspan class=\"emphasis\">\u003Cem>&lt;time_server&gt;\u003C/em>\u003C/span>\u003C/code>\u003C/span>\u003C/dt>\u003Cdd>\n\t\t\t\t\t\t\t\t\tSpecifies the NTP server to use for time synchronization. Kerberos requires a synchronized time among AD domain controllers and domain members to prevent replay attacks. If you omit this variable, the \u003Ccode class=\"literal\">ad_integration\u003C/code> role does not utilize the \u003Ccode class=\"literal\">timesync\u003C/code> RHEL system role to configure time synchronization on the managed node.\n\t\t\t\t\t\t\t\t\u003C/dd>\u003C/dl>\u003C/div>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tFor details about all variables used in the playbook, see the \u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md\u003C/code> file on the control node.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tValidate the playbook syntax:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass --syntax-check ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003Cp class=\"simpara\">\n\t\t\t\t\t\tNote that this command only validates the syntax and does not protect against a wrong but valid configuration.\n\t\t\t\t\t\u003C/p>\u003C/li>\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tRun the playbook:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible-playbook --ask-vault-pass ~/playbook.yml\u003C/strong>\u003C/span>\u003C/pre>\u003C/li>\u003C/ol>\u003C/div>\u003Cdiv class=\"itemizedlist\">\u003Cp class=\"title\">\u003Cstrong>Verification\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist\" type=\"disc\">\u003Cli class=\"listitem\">\u003Cp class=\"simpara\">\n\t\t\t\t\t\tCheck if AD users, such as \u003Ccode class=\"literal\">administrator\u003C/code>, are available locally on the managed node:\n\t\t\t\t\t\u003C/p>\u003Cpre class=\"literallayout\">$ \u003Cspan class=\"strong strong\">\u003Cstrong>ansible managed-node-01.example.com -m command -a 'getent passwd administrator@ad.example.com'\u003C/strong>\u003C/span>\nadministrator@ad.example.com:*:1450400500:1450400513:Administrator:/home/administrator@ad.example.com:/bin/bash\u003C/pre>\u003C/li>\u003C/ul>\u003C/div>\u003Cdiv class=\"itemizedlist _additional-resources\">\u003Cp class=\"title\">\u003Cstrong>Additional resources\u003C/strong>\u003C/p>\u003Cul class=\"itemizedlist _additional-resources\" type=\"disc\">\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/ansible/roles/rhel-system-roles.ad_integration/README.md\u003C/code> file\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ccode class=\"literal\">/usr/share/doc/rhel-system-roles/ad_integration/\u003C/code> directory\n\t\t\t\t\t\u003C/li>\u003Cli class=\"listitem\">\n\t\t\t\t\t\t\u003Ca class=\"link\" href=\"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html/automating_system_administration_by_using_rhel_system_roles/ansible-vault_automating-system-administration-by-using-rhel-system-roles\">Ansible vault\u003C/a>\n\t\t\t\t\t\u003C/li>\u003C/ul>\u003C/div>\u003C/section>\u003C/section>\u003Cdiv>\u003Cdiv xml:lang=\"en-US\" class=\"legalnotice\" id=\"idm140464232589344\">\u003Ch2 class=\"legalnotice\">Legal Notice\u003C/h2>\u003Cdiv class=\"para\">\n\t\tCopyright \u003Cspan class=\"trademark\">\u003C!--Empty-->\u003C/span>© 2024 Red Hat, Inc.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license (\"CC-BY-SA\"). An explanation of CC-BY-SA is available at \u003Ca class=\"uri\" href=\"http://creativecommons.org/licenses/by-sa/3.0/\">http://creativecommons.org/licenses/by-sa/3.0/\u003C/a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tRed Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Linux\u003C/span>® is the registered trademark of Linus Torvalds in the United States and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Java\u003C/span>® is a registered trademark of Oracle and/or its affiliates.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">XFS\u003C/span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">MySQL\u003C/span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\t\u003Cspan class=\"trademark\">Node.js\u003C/span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tThe \u003Cspan class=\"trademark\">OpenStack\u003C/span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.\n\t\u003C/div>\u003Cdiv class=\"para\">\n\t\tAll other trademarks are the property of their respective owners.\n\t\u003C/div>\u003C/div>\u003C/div>\u003C/div>\u003C/body>",[14,21,26,31,89,111,145,162,192,222,255,280,306,336,390,420,454,488,526,557,600,647,698,713,735,769,787,817,863,901,927,957,1019,1053,1083,1117,1122,1156,1166],{"title":11,"visible":15,"weight":16,"urlFragment":17,"anchor":18,"singlePageAnchor":18,"docTitle":19,"url":20},true,1,"index",null,"using_ansible_to_install_and_manage_identity_management","#",{"title":22,"visible":15,"weight":23,"urlFragment":24,"anchor":18,"singlePageAnchor":24,"docTitle":19,"url":25},"Providing feedback on Red Hat documentation",2,"proc_providing-feedback-on-red-hat-documentation_using-ansible-to-install-and-manage-identity-management","#proc_providing-feedback-on-red-hat-documentation_using-ansible-to-install-and-manage-identity-management",{"title":27,"visible":15,"weight":28,"urlFragment":29,"anchor":18,"singlePageAnchor":29,"docTitle":19,"url":30},"1. Ansible terminology",3,"ansible-terminology_using-ansible-to-install-and-manage-identity-management","#ansible-terminology_using-ansible-to-install-and-manage-identity-management",{"title":32,"visible":15,"weight":33,"urlFragment":34,"anchor":18,"singlePageAnchor":35,"sections":36,"docTitle":19,"url":88},"2. Installing an Identity Management server using an Ansible playbook",4,"installing-an-identity-management-server-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management","installing-an-Identity-Management-server-using-an-Ansible-playbook_using-ansible-to-install-and-manage-identity-management",[37,41,45,49,53,58,63,68,73,78,83],{"title":38,"visible":15,"weight":16,"urlFragment":34,"anchor":39,"singlePageAnchor":39,"docTitle":19,"url":40},"2.1. Ansible and its advantages for installing IdM","ansible-and-its-advantages-for-installing-IdM_server-ansible","#ansible-and-its-advantages-for-installing-IdM_server-ansible",{"title":42,"visible":15,"weight":23,"urlFragment":34,"anchor":43,"singlePageAnchor":43,"docTitle":19,"url":44},"2.2. Installing the ansible-freeipa package","installing-the-ansible-freeipa-package_server-ansible","#installing-the-ansible-freeipa-package_server-ansible",{"title":46,"visible":15,"weight":28,"urlFragment":34,"anchor":47,"singlePageAnchor":47,"docTitle":19,"url":48},"2.3. Ansible roles location in the file system","ansible-roles-location-in-the-file-system_server-ansible","#ansible-roles-location-in-the-file-system_server-ansible",{"title":50,"visible":15,"weight":33,"urlFragment":34,"anchor":51,"singlePageAnchor":51,"docTitle":19,"url":52},"2.4. Setting the parameters for a deployment with an integrated DNS and an integrated CA as the root CA","setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-integrated-ca-as-the-root-ca_server-ansible","#setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-integrated-ca-as-the-root-ca_server-ansible",{"title":54,"visible":15,"weight":55,"urlFragment":34,"anchor":56,"singlePageAnchor":56,"docTitle":19,"url":57},"2.5. Setting the parameters for a deployment with external DNS and an integrated CA as the root CA",5,"setting-the-parameters-for-a-deployment-with-external-dns-and-an-integrated-ca-as-the-root-ca_server-ansible","#setting-the-parameters-for-a-deployment-with-external-dns-and-an-integrated-ca-as-the-root-ca_server-ansible",{"title":59,"visible":15,"weight":60,"urlFragment":34,"anchor":61,"singlePageAnchor":61,"docTitle":19,"url":62},"2.6. Deploying an IdM server with an integrated CA as the root CA using an Ansible playbook",6,"deploying-an-IdM-server-with-an-integrated-CA-using-an-Ansible-playbook_server-ansible","#deploying-an-IdM-server-with-an-integrated-CA-using-an-Ansible-playbook_server-ansible",{"title":64,"visible":15,"weight":65,"urlFragment":34,"anchor":66,"singlePageAnchor":66,"docTitle":19,"url":67},"2.7. Setting the parameters for a deployment with an integrated DNS and an external CA as the root CA",7,"setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-external-ca-as-the-root-ca_server-ansible","#setting-the-parameters-for-a-deployment-with-an-integrated-dns-and-an-external-ca-as-the-root-ca_server-ansible",{"title":69,"visible":15,"weight":70,"urlFragment":34,"anchor":71,"singlePageAnchor":71,"docTitle":19,"url":72},"2.8. Setting the parameters for a deployment with external DNS and an external CA as the root CA",8,"setting-the-parameters-for-a-deployment-with-external-dns-and-an-external-ca-as-the-root-ca_server-ansible","#setting-the-parameters-for-a-deployment-with-external-dns-and-an-external-ca-as-the-root-ca_server-ansible",{"title":74,"visible":15,"weight":75,"urlFragment":34,"anchor":76,"singlePageAnchor":76,"docTitle":19,"url":77},"2.9. Deploying an IdM server with an external CA as the root CA using an Ansible playbook",9,"deploying-an-IdM-server-with-an-external-CA-using-an-Ansible-playbook_server-ansible","#deploying-an-IdM-server-with-an-external-CA-using-an-Ansible-playbook_server-ansible",{"title":79,"visible":15,"weight":80,"urlFragment":34,"anchor":81,"singlePageAnchor":81,"docTitle":19,"url":82},"2.10. Uninstalling an IdM server using an Ansible playbook",10,"uninstalling-an-idm-server-using-an-ansible-playbook_server-ansible","#uninstalling-an-idm-server-using-an-ansible-playbook_server-ansible",{"title":84,"visible":15,"weight":85,"urlFragment":34,"anchor":86,"singlePageAnchor":86,"docTitle":19,"url":87},"2.11. Using an Ansible playbook to uninstall an IdM server even if this leads to a disconnected topology",11,"using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible","#using-an-ansible-playbook-to-uninstall-an-idm-server-even-if-this-leads-to-a-disconnected-topology_server-ansible","#installing-an-Identity-Management-server-using-an-Ansible-playbook_using-ansible-to-install-and-manage-identity-management",{"title":90,"visible":15,"weight":55,"urlFragment":91,"anchor":18,"singlePageAnchor":92,"sections":93,"docTitle":19,"url":110},"3. Installing an Identity Management replica using an Ansible playbook","installing-an-identity-management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management","installing-an-Identity-Management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management",[94,98,102,106],{"title":95,"visible":15,"weight":16,"urlFragment":91,"anchor":96,"singlePageAnchor":96,"docTitle":19,"url":97},"3.1. Specifying the base, server and client variables for installing the IdM replica","specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible","#specifying-the-base-server-and-client-variables-for-installing-the-IdM-replica_replica-ansible",{"title":99,"visible":15,"weight":23,"urlFragment":91,"anchor":100,"singlePageAnchor":100,"docTitle":19,"url":101},"3.2. Specifying the credentials for installing the IdM replica using an Ansible playbook","specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible","#specifying-the-credentials-for-installing-the-replica-using-an-ansible-playbook_replica-ansible",{"title":103,"visible":15,"weight":28,"urlFragment":91,"anchor":104,"singlePageAnchor":104,"docTitle":19,"url":105},"3.3. Deploying an IdM replica using an Ansible playbook","deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible","#deploying-an-IdM-replica-using-an-Ansible-playbook_replica-ansible",{"title":107,"visible":15,"weight":33,"urlFragment":91,"anchor":108,"singlePageAnchor":108,"docTitle":19,"url":109},"3.4. Uninstalling an IdM replica using an Ansible playbook","uninstalling-an-idm-replica-using-an-ansible-playbook_replica-ansible","#uninstalling-an-idm-replica-using-an-ansible-playbook_replica-ansible","#installing-an-Identity-Management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management",{"title":112,"visible":15,"weight":60,"urlFragment":113,"anchor":18,"singlePageAnchor":114,"sections":115,"docTitle":19,"url":144},"4. Installing an Identity Management client using an Ansible playbook","installing-an-identity-management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management","installing-an-Identity-Management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management",[116,120,124,128,132,136,140],{"title":117,"visible":15,"weight":16,"urlFragment":113,"anchor":118,"singlePageAnchor":118,"docTitle":19,"url":119},"4.1. Setting the parameters of the inventory file for the autodiscovery client installation mode","setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible","#setting-the-parameters-of-the-inventory-file-for-the-autodiscovery-client-installation-mode_client-ansible",{"title":121,"visible":15,"weight":23,"urlFragment":113,"anchor":122,"singlePageAnchor":122,"docTitle":19,"url":123},"4.2. Setting the parameters of the inventory file when autodiscovery is not possible during client installation","setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible","#setting-the-parameters-of-the-inventory-file-when-autodiscovery-is-not-possible-during-client-installation_client-ansible",{"title":125,"visible":15,"weight":28,"urlFragment":113,"anchor":126,"singlePageAnchor":126,"docTitle":19,"url":127},"4.3. Authorization options for IdM client enrollment using an Ansible playbook","authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible","#authorization-options-for-idm-client-enrollment-using-an-ansible-playbook_client-ansible",{"title":129,"visible":15,"weight":33,"urlFragment":113,"anchor":130,"singlePageAnchor":130,"docTitle":19,"url":131},"4.4. Deploying an IdM client using an Ansible playbook","deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible","#deploying-an-IdM-client-using-an-Ansible-playbook_client-ansible",{"title":133,"visible":15,"weight":55,"urlFragment":113,"anchor":134,"singlePageAnchor":134,"docTitle":19,"url":135},"4.5. Using the one-time password method in Ansible to install an IdM client","using-the-one-time-password-method-in-ansible-to-install-an-idm-client_client-ansible","#using-the-one-time-password-method-in-ansible-to-install-an-idm-client_client-ansible",{"title":137,"visible":15,"weight":60,"urlFragment":113,"anchor":138,"singlePageAnchor":138,"docTitle":19,"url":139},"4.6. Testing an Identity Management client after Ansible installation","testing-an-Identity-Management-after-Ansible-installation_client-ansible","#testing-an-Identity-Management-after-Ansible-installation_client-ansible",{"title":141,"visible":15,"weight":65,"urlFragment":113,"anchor":142,"singlePageAnchor":142,"docTitle":19,"url":143},"4.7. Uninstalling an IdM client using an Ansible playbook","uninstalling-an-IdM-client-using-an-Ansible-playbook_client-ansible","#uninstalling-an-IdM-client-using-an-Ansible-playbook_client-ansible","#installing-an-Identity-Management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management",{"title":146,"visible":15,"weight":65,"urlFragment":147,"anchor":18,"singlePageAnchor":147,"sections":148,"docTitle":19,"url":161},"5. Preparing your environment for managing IdM using Ansible playbooks","preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[149,153,157],{"title":150,"visible":15,"weight":16,"urlFragment":147,"anchor":151,"singlePageAnchor":151,"docTitle":19,"url":152},"5.1. Preparing a control node and managed nodes for managing IdM using Ansible playbooks","proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks","#proc_preparing-a-control-node-and-managed-nodes-for-managing-idm-using-ansible-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks",{"title":154,"visible":15,"weight":23,"urlFragment":147,"anchor":155,"singlePageAnchor":155,"docTitle":19,"url":156},"5.2. Different methods to provide the credentials required for ansible-freeipa playbooks","con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks","#con_different-methods-to-provide-the-credentials-required-for-ansible-freeipa-playbooks_preparing-your-environment-for-managing-idm-using-ansible-playbooks",{"title":158,"visible":15,"weight":28,"urlFragment":147,"anchor":159,"singlePageAnchor":159,"docTitle":19,"url":160},"5.3. The inventory plugin in ansible-freeipa","con_the-inventory-plugin-in-ansible-freeipa_preparing-your-environment-for-managing-idm-using-ansible-playbooks","#con_the-inventory-plugin-in-ansible-freeipa_preparing-your-environment-for-managing-idm-using-ansible-playbooks","#preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":163,"visible":15,"weight":70,"urlFragment":164,"anchor":18,"singlePageAnchor":165,"sections":166,"docTitle":19,"url":191},"6. Configuring global IdM settings using Ansible playbooks","configuring-global-idm-settings-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management","configuring-global-IdM-settings-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[167,171,175,179,183,187],{"title":168,"visible":15,"weight":16,"urlFragment":164,"anchor":169,"singlePageAnchor":169,"docTitle":19,"url":170},"6.1. Retrieving IdM configuration using an Ansible playbook","retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks","#retrieving-IdM-configuration-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks",{"title":172,"visible":15,"weight":23,"urlFragment":164,"anchor":173,"singlePageAnchor":173,"docTitle":19,"url":174},"6.2. Configuring the IdM CA renewal server using an Ansible playbook","configuring-the-IdM-ca-renewal-server-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks","#configuring-the-IdM-ca-renewal-server-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks",{"title":176,"visible":15,"weight":28,"urlFragment":164,"anchor":177,"singlePageAnchor":177,"docTitle":19,"url":178},"6.3. Configuring the default shell for IdM users using an Ansible playbook","configuring-the-default-shell-for-IdM-users-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks","#configuring-the-default-shell-for-IdM-users-using-an-Ansible-playbook_configuring-global-idm-settings-using-ansible-playbooks",{"title":180,"visible":15,"weight":33,"urlFragment":164,"anchor":181,"singlePageAnchor":181,"docTitle":19,"url":182},"6.4. Configuring a NetBIOS name for an IdM domain by using Ansible","configuring-a-netbios-name-for-an-idm-domain-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks","#configuring-a-netbios-name-for-an-idm-domain-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks",{"title":184,"visible":15,"weight":55,"urlFragment":164,"anchor":185,"singlePageAnchor":185,"docTitle":19,"url":186},"6.5. Ensuring that IdM users and groups have SIDs by using Ansible","ensuring-that-idm-users-and-groups-have-sids-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks","#ensuring-that-idm-users-and-groups-have-sids-by-using-ansible_configuring-global-idm-settings-using-ansible-playbooks",{"title":188,"visible":15,"weight":60,"urlFragment":164,"anchor":189,"singlePageAnchor":189,"docTitle":19,"url":190},"6.6. Additional resources","additional_resources","#additional_resources","#configuring-global-IdM-settings-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":193,"visible":15,"weight":75,"urlFragment":194,"anchor":18,"singlePageAnchor":195,"sections":196,"docTitle":19,"url":221},"7. Managing user accounts using Ansible playbooks","managing-user-accounts-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management","managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[197,201,205,209,213,217],{"title":198,"visible":15,"weight":16,"urlFragment":194,"anchor":199,"singlePageAnchor":199,"docTitle":19,"url":200},"7.1. User life cycle","user-life-cycle_managing-idm-users-using-Ansible-playbooks","#user-life-cycle_managing-idm-users-using-Ansible-playbooks",{"title":202,"visible":15,"weight":23,"urlFragment":194,"anchor":203,"singlePageAnchor":203,"docTitle":19,"url":204},"7.2. Ensuring the presence of an IdM user using an Ansible playbook","ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks","#ensuring-the-presence-of-an-IdM-user-using-an-Ansible-playbook_managing-idm-users-using-Ansible-playbooks",{"title":206,"visible":15,"weight":28,"urlFragment":194,"anchor":207,"singlePageAnchor":207,"docTitle":19,"url":208},"7.3. Ensuring the presence of multiple IdM users using Ansible playbooks","ensuring-the-presence-of-multiple-IdM-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks","#ensuring-the-presence-of-multiple-IdM-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks",{"title":210,"visible":15,"weight":33,"urlFragment":194,"anchor":211,"singlePageAnchor":211,"docTitle":19,"url":212},"7.4. Ensuring the presence of multiple IdM users from a JSON file using Ansible playbooks","ensuring-the-presence-of-multiple-IdM-users-from-a-json-file-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks","#ensuring-the-presence-of-multiple-IdM-users-from-a-json-file-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks",{"title":214,"visible":15,"weight":55,"urlFragment":194,"anchor":215,"singlePageAnchor":215,"docTitle":19,"url":216},"7.5. Ensuring the absence of users using Ansible playbooks","ensuring-the-absence-of-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks","#ensuring-the-absence-of-users-using-Ansible-playbooks_managing-idm-users-using-Ansible-playbooks",{"title":218,"visible":15,"weight":60,"urlFragment":194,"anchor":219,"singlePageAnchor":219,"docTitle":19,"url":220},"7.6. Additional resources","additional_resources_2","#additional_resources_2","#managing-user-accounts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":223,"visible":15,"weight":80,"urlFragment":224,"anchor":18,"singlePageAnchor":224,"sections":225,"docTitle":19,"url":254},"8. Managing user groups using Ansible playbooks","managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[226,230,234,238,242,246,250],{"title":227,"visible":15,"weight":16,"urlFragment":224,"anchor":228,"singlePageAnchor":228,"docTitle":19,"url":229},"8.1. The different group types in IdM","the-different-group-types-in-idm_managing-user-groups-using-ansible-playbooks","#the-different-group-types-in-idm_managing-user-groups-using-ansible-playbooks",{"title":231,"visible":15,"weight":23,"urlFragment":224,"anchor":232,"singlePageAnchor":232,"docTitle":19,"url":233},"8.2. Direct and indirect group members","direct-and-indirect-group-members_managing-user-groups-using-ansible-playbooks","#direct-and-indirect-group-members_managing-user-groups-using-ansible-playbooks",{"title":235,"visible":15,"weight":28,"urlFragment":224,"anchor":236,"singlePageAnchor":236,"docTitle":19,"url":237},"8.3. Ensuring the presence of IdM groups and group members using Ansible playbooks","ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks","#ensuring-the-presence-of-IdM-groups-and-group-members-using-Ansible-playbooks_managing-user-groups-using-ansible-playbooks",{"title":239,"visible":15,"weight":33,"urlFragment":224,"anchor":240,"singlePageAnchor":240,"docTitle":19,"url":241},"8.4. Using Ansible to add multiple IdM groups in a single task","using-ansible-to-add-multiple-idm-groups-in-a-single-task_managing-user-groups-using-ansible-playbooks","#using-ansible-to-add-multiple-idm-groups-in-a-single-task_managing-user-groups-using-ansible-playbooks",{"title":243,"visible":15,"weight":55,"urlFragment":224,"anchor":244,"singlePageAnchor":244,"docTitle":19,"url":245},"8.5. Using Ansible to enable AD users to administer IdM","proc_using-ansible-to-enable-ad-users-to-administer-idm_managing-user-groups-using-ansible-playbooks","#proc_using-ansible-to-enable-ad-users-to-administer-idm_managing-user-groups-using-ansible-playbooks",{"title":247,"visible":15,"weight":60,"urlFragment":224,"anchor":248,"singlePageAnchor":248,"docTitle":19,"url":249},"8.6. Ensuring the presence of member managers in IdM user groups using Ansible playbooks","ensuring-the-presence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks","#ensuring-the-presence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks",{"title":251,"visible":15,"weight":65,"urlFragment":224,"anchor":252,"singlePageAnchor":252,"docTitle":19,"url":253},"8.7. Ensuring the absence of member managers in IdM user groups using Ansible playbooks","ensuring-the-absence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks","#ensuring-the-absence-of-member-managers-in-idm-user-groups-using-ansible-playbooks_managing-user-groups-using-ansible-playbooks","#managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":256,"visible":15,"weight":85,"urlFragment":257,"anchor":18,"singlePageAnchor":257,"sections":258,"docTitle":19,"url":279},"9. Using Ansible to automate group membership in IdM","using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management",[259,263,267,271,275],{"title":260,"visible":15,"weight":16,"urlFragment":257,"anchor":261,"singlePageAnchor":261,"docTitle":19,"url":262},"9.1. Using Ansible to ensure that an automember rule for an IdM user group is present","using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-present_using-ansible-to-automate-group-membership-in-idm","#using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-present_using-ansible-to-automate-group-membership-in-idm",{"title":264,"visible":15,"weight":23,"urlFragment":257,"anchor":265,"singlePageAnchor":265,"docTitle":19,"url":266},"9.2. Using Ansible to ensure that a specified condition is present in an IdM user group automember rule","using-ansible-to-ensure-that-a-specified-condition-is-present-in-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm","#using-ansible-to-ensure-that-a-specified-condition-is-present-in-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm",{"title":268,"visible":15,"weight":28,"urlFragment":257,"anchor":269,"singlePageAnchor":269,"docTitle":19,"url":270},"9.3. Using Ansible to ensure that a condition is absent from an IdM user group automember rule","using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm","#using-ansible-to-ensure-that-a-condition-is-absent-from-an-idm-user-group-automember-rule_using-ansible-to-automate-group-membership-in-idm",{"title":272,"visible":15,"weight":33,"urlFragment":257,"anchor":273,"singlePageAnchor":273,"docTitle":19,"url":274},"9.4. Using Ansible to ensure that an automember rule for an IdM user group is absent","using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-absent_using-ansible-to-automate-group-membership-in-idm","#using-ansible-to-ensure-that-an-automember-rule-for-an-idm-user-group-is-absent_using-ansible-to-automate-group-membership-in-idm",{"title":276,"visible":15,"weight":55,"urlFragment":257,"anchor":277,"singlePageAnchor":277,"docTitle":19,"url":278},"9.5. Using Ansible to ensure that a condition is present in an IdM host group automember rule","using-ansible-to-ensure-that-a-condition-is-present-in-an-idm-host-group-automember-rule_using-ansible-to-automate-group-membership-in-idm","#using-ansible-to-ensure-that-a-condition-is-present-in-an-idm-host-group-automember-rule_using-ansible-to-automate-group-membership-in-idm","#using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":281,"visible":15,"weight":282,"urlFragment":283,"anchor":18,"singlePageAnchor":283,"sections":284,"docTitle":19,"url":305},"10. Using Ansible playbooks to manage self-service rules in IdM",12,"using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management",[285,289,293,297,301],{"title":286,"visible":15,"weight":16,"urlFragment":283,"anchor":287,"singlePageAnchor":287,"docTitle":19,"url":288},"10.1. Self-service access control in IdM","self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm","#self-service-access-control-in-idm_using-ansible-playbooks-to-manage-self-service-rules-in-idm",{"title":290,"visible":15,"weight":23,"urlFragment":283,"anchor":291,"singlePageAnchor":291,"docTitle":19,"url":292},"10.2. Using Ansible to ensure that a self-service rule is present","using-ansible-to-ensure-that-a-self-service-rule-is-present_using-ansible-playbooks-to-manage-self-service-rules-in-idm","#using-ansible-to-ensure-that-a-self-service-rule-is-present_using-ansible-playbooks-to-manage-self-service-rules-in-idm",{"title":294,"visible":15,"weight":28,"urlFragment":283,"anchor":295,"singlePageAnchor":295,"docTitle":19,"url":296},"10.3. Using Ansible to ensure that a self-service rule is absent","using-ansible-to-ensure-that-a-self-service-rule-is-absent_using-ansible-playbooks-to-manage-self-service-rules-in-idm","#using-ansible-to-ensure-that-a-self-service-rule-is-absent_using-ansible-playbooks-to-manage-self-service-rules-in-idm",{"title":298,"visible":15,"weight":33,"urlFragment":283,"anchor":299,"singlePageAnchor":299,"docTitle":19,"url":300},"10.4. Using Ansible to ensure that a self-service rule has specific attributes","using-ansible-to-ensure-that-a-self-service-rule-has-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm","#using-ansible-to-ensure-that-a-self-service-rule-has-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm",{"title":302,"visible":15,"weight":55,"urlFragment":283,"anchor":303,"singlePageAnchor":303,"docTitle":19,"url":304},"10.5. Using Ansible to ensure that a self-service rule does not have specific attributes","using-ansible-to-ensure-that-a-self-service-rule-does-not-have-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm","#using-ansible-to-ensure-that-a-self-service-rule-does-not-have-specific-attributes_using-ansible-playbooks-to-manage-self-service-rules-in-idm","#using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":307,"visible":15,"weight":308,"urlFragment":309,"anchor":18,"singlePageAnchor":309,"sections":310,"docTitle":19,"url":335},"11. Delegating permissions to user groups to manage users using Ansible playbooks",13,"assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[311,315,319,323,327,331],{"title":312,"visible":15,"weight":16,"urlFragment":309,"anchor":313,"singlePageAnchor":313,"docTitle":19,"url":314},"11.1. Delegation rules","delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks","#delegation-rules_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks",{"title":316,"visible":15,"weight":23,"urlFragment":309,"anchor":317,"singlePageAnchor":317,"docTitle":19,"url":318},"11.2. Creating an Ansible inventory file for IdM","creating-an-ansible-inventory-file-for-idm_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks","#creating-an-ansible-inventory-file-for-idm_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks",{"title":320,"visible":15,"weight":28,"urlFragment":309,"anchor":321,"singlePageAnchor":321,"docTitle":19,"url":322},"11.3. Using Ansible to ensure that a delegation rule is present","proc_using-ansible-to-ensure-that-a-delegation-rule-is-present_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks","#proc_using-ansible-to-ensure-that-a-delegation-rule-is-present_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks",{"title":324,"visible":15,"weight":33,"urlFragment":309,"anchor":325,"singlePageAnchor":325,"docTitle":19,"url":326},"11.4. Using Ansible to ensure that a delegation rule is absent","proc_using-ansible-to-ensure-that-a-delegation-rule-is-absent_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks","#proc_using-ansible-to-ensure-that-a-delegation-rule-is-absent_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks",{"title":328,"visible":15,"weight":55,"urlFragment":309,"anchor":329,"singlePageAnchor":329,"docTitle":19,"url":330},"11.5. Using Ansible to ensure that a delegation rule has specific attributes","proc_using-ansible-to-ensure-that-a-delegation-rule-has-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks","#proc_using-ansible-to-ensure-that-a-delegation-rule-has-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks",{"title":332,"visible":15,"weight":60,"urlFragment":309,"anchor":333,"singlePageAnchor":333,"docTitle":19,"url":334},"11.6. Using Ansible to ensure that a delegation rule does not have specific attributes","proc_using-ansible-to-ensure-that-a-delegation-rule-does-not-have-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks","#proc_using-ansible-to-ensure-that-a-delegation-rule-does-not-have-specific-attributes_assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks","#assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":337,"visible":15,"weight":338,"urlFragment":339,"anchor":18,"singlePageAnchor":339,"sections":340,"docTitle":19,"url":389},"12. Using Ansible playbooks to manage role-based access control in IdM",14,"using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management",[341,345,349,353,357,361,365,369,373,377,381,385],{"title":342,"visible":15,"weight":16,"urlFragment":339,"anchor":343,"singlePageAnchor":343,"docTitle":19,"url":344},"12.1. Permissions in IdM","permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#permissions-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":346,"visible":15,"weight":23,"urlFragment":339,"anchor":347,"singlePageAnchor":347,"docTitle":19,"url":348},"12.2. Default managed permissions","default-managed-permissions_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#default-managed-permissions_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":350,"visible":15,"weight":28,"urlFragment":339,"anchor":351,"singlePageAnchor":351,"docTitle":19,"url":352},"12.3. Privileges in IdM","privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#privileges-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":354,"visible":15,"weight":33,"urlFragment":339,"anchor":355,"singlePageAnchor":355,"docTitle":19,"url":356},"12.4. Roles in IdM","roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#roles-in-idm_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":358,"visible":15,"weight":55,"urlFragment":339,"anchor":359,"singlePageAnchor":359,"docTitle":19,"url":360},"12.5. Predefined roles in Identity Management","predefined-roles-in-identity-management_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#predefined-roles-in-identity-management_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":362,"visible":15,"weight":60,"urlFragment":339,"anchor":363,"singlePageAnchor":363,"docTitle":19,"url":364},"12.6. Using Ansible to ensure an IdM RBAC role with privileges is present","using-ansible-to-ensure-an-idm-rbac-role-with-privileges-is-present_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#using-ansible-to-ensure-an-idm-rbac-role-with-privileges-is-present_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":366,"visible":15,"weight":65,"urlFragment":339,"anchor":367,"singlePageAnchor":367,"docTitle":19,"url":368},"12.7. Using Ansible to ensure an IdM RBAC role is absent","using-ansible-to-ensure-an-idm-rbac-role-is-absent_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#using-ansible-to-ensure-an-idm-rbac-role-is-absent_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":370,"visible":15,"weight":70,"urlFragment":339,"anchor":371,"singlePageAnchor":371,"docTitle":19,"url":372},"12.8. Using Ansible to ensure that a group of users is assigned to an IdM RBAC role","using-ansible-to-ensure-that-a-group-of-users-is-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#using-ansible-to-ensure-that-a-group-of-users-is-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":374,"visible":15,"weight":75,"urlFragment":339,"anchor":375,"singlePageAnchor":375,"docTitle":19,"url":376},"12.9. Using Ansible to ensure that specific users are not assigned to an IdM RBAC role","using-ansible-to-ensure-that-specific-users-are-not-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#using-ansible-to-ensure-that-specific-users-are-not-assigned-to-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":378,"visible":15,"weight":80,"urlFragment":339,"anchor":379,"singlePageAnchor":379,"docTitle":19,"url":380},"12.10. Using Ansible to ensure a service is a member of an IdM RBAC role","using-ansible-to-ensure-a-service-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#using-ansible-to-ensure-a-service-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":382,"visible":15,"weight":85,"urlFragment":339,"anchor":383,"singlePageAnchor":383,"docTitle":19,"url":384},"12.11. Using Ansible to ensure a host is a member of an IdM RBAC role","using-ansible-to-ensure-a-host-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#using-ansible-to-ensure-a-host-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm",{"title":386,"visible":15,"weight":282,"urlFragment":339,"anchor":387,"singlePageAnchor":387,"docTitle":19,"url":388},"12.12. Using Ansible to ensure a host group is a member of an IdM RBAC role","using-ansible-to-ensure-a-host-group-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#using-ansible-to-ensure-a-host-group-is-a-member-of-an-idm-rbac-role_using-ansible-playbooks-to-manage-role-based-access-control-in-idm","#using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":391,"visible":15,"weight":392,"urlFragment":393,"anchor":18,"singlePageAnchor":393,"sections":394,"docTitle":19,"url":419},"13. Using Ansible playbooks to manage RBAC privileges",15,"using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management",[395,399,403,407,411,415],{"title":396,"visible":15,"weight":16,"urlFragment":393,"anchor":397,"singlePageAnchor":397,"docTitle":19,"url":398},"13.1. Using Ansible to ensure a custom IdM RBAC privilege is present","using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges","#using-ansible-to-ensure-a-custom-idm-rbac-privilege-is-present_using-ansible-playbooks-to-manage-rbac-privileges",{"title":400,"visible":15,"weight":23,"urlFragment":393,"anchor":401,"singlePageAnchor":401,"docTitle":19,"url":402},"13.2. Using Ansible to ensure member permissions are present in a custom IdM RBAC privilege","using-ansible-to-ensure-member-permissions-are-present-in-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges","#using-ansible-to-ensure-member-permissions-are-present-in-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges",{"title":404,"visible":15,"weight":28,"urlFragment":393,"anchor":405,"singlePageAnchor":405,"docTitle":19,"url":406},"13.3. Using Ansible to ensure an IdM RBAC privilege does not include a permission","using-ansible-to-ensure-an-idm-rbac-privilege-does-not-include-a-permission_using-ansible-playbooks-to-manage-rbac-privileges","#using-ansible-to-ensure-an-idm-rbac-privilege-does-not-include-a-permission_using-ansible-playbooks-to-manage-rbac-privileges",{"title":408,"visible":15,"weight":33,"urlFragment":393,"anchor":409,"singlePageAnchor":409,"docTitle":19,"url":410},"13.4. Using Ansible to rename a custom IdM RBAC privilege","using-ansible-to-rename-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges","#using-ansible-to-rename-a-custom-idm-rbac-privilege_using-ansible-playbooks-to-manage-rbac-privileges",{"title":412,"visible":15,"weight":55,"urlFragment":393,"anchor":413,"singlePageAnchor":413,"docTitle":19,"url":414},"13.5. Using Ansible to ensure an IdM RBAC privilege is absent","using-ansible-to-ensure-an-idm-rbac-privilege-is-absent_using-ansible-playbooks-to-manage-rbac-privileges","#using-ansible-to-ensure-an-idm-rbac-privilege-is-absent_using-ansible-playbooks-to-manage-rbac-privileges",{"title":416,"visible":15,"weight":60,"urlFragment":393,"anchor":417,"singlePageAnchor":417,"docTitle":19,"url":418},"13.6. Additional resources","additional_resources_3","#additional_resources_3","#using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management",{"title":421,"visible":15,"weight":422,"urlFragment":423,"anchor":18,"singlePageAnchor":423,"sections":424,"docTitle":19,"url":453},"14. Using Ansible playbooks to manage RBAC permissions in IdM",16,"using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management",[425,429,433,437,441,445,449],{"title":426,"visible":15,"weight":16,"urlFragment":423,"anchor":427,"singlePageAnchor":427,"docTitle":19,"url":428},"14.1. Using Ansible to ensure an RBAC permission is present","using-ansible-to-ensure-an-rbac-permission-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm","#using-ansible-to-ensure-an-rbac-permission-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm",{"title":430,"visible":15,"weight":23,"urlFragment":423,"anchor":431,"singlePageAnchor":431,"docTitle":19,"url":432},"14.2. Using Ansible to ensure an RBAC permission with an attribute is present","using-ansible-to-ensure-an-rbac-permission-with-an-attribute-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm","#using-ansible-to-ensure-an-rbac-permission-with-an-attribute-is-present_using-ansible-playbooks-to-manage-rbac-permissions-in-idm",{"title":434,"visible":15,"weight":28,"urlFragment":423,"anchor":435,"singlePageAnchor":435,"docTitle":19,"url":436},"14.3. Using Ansible to ensure an RBAC permission is absent","using-ansible-to-ensure-an-rbac-permission-is-absent_using-ansible-playbooks-to-manage-rbac-permissions-in-idm","#using-ansible-to-ensure-an-rbac-permission-is-absent_using-ansible-playbooks-to-manage-rbac-permissions-in-idm",{"title":438,"visible":15,"weight":33,"urlFragment":423,"anchor":439,"singlePageAnchor":439,"docTitle":19,"url":440},"14.4. Using Ansible to ensure an attribute is a member of an IdM RBAC permission","using-ansible-to-ensure-an-attribute-is-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm","#using-ansible-to-ensure-an-attribute-is-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm",{"title":442,"visible":15,"weight":55,"urlFragment":423,"anchor":443,"singlePageAnchor":443,"docTitle":19,"url":444},"14.5. Using Ansible to ensure an attribute is not a member of an IdM RBAC permission","using-ansible-to-ensure-an-attribute-is-not-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm","#using-ansible-to-ensure-an-attribute-is-not-a-member-of-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm",{"title":446,"visible":15,"weight":60,"urlFragment":423,"anchor":447,"singlePageAnchor":447,"docTitle":19,"url":448},"14.6. Using Ansible to rename an IdM RBAC permission","using-ansible-to-rename-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm","#using-ansible-to-rename-an-idm-rbac-permission_using-ansible-playbooks-to-manage-rbac-permissions-in-idm",{"title":450,"visible":15,"weight":65,"urlFragment":423,"anchor":451,"singlePageAnchor":451,"docTitle":19,"url":452},"14.7. Additional resources","additional_resources_4","#additional_resources_4","#using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":455,"visible":15,"weight":456,"urlFragment":457,"anchor":18,"singlePageAnchor":457,"sections":458,"docTitle":19,"url":487},"15. Using Ansible to manage the replication topology in IdM",17,"using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management",[459,463,467,471,475,479,483],{"title":460,"visible":15,"weight":16,"urlFragment":457,"anchor":461,"singlePageAnchor":461,"docTitle":19,"url":462},"15.1. Using Ansible to ensure a replication agreement exists in IdM","using-ansible-to-ensure-a-replication-agreement-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm","#using-ansible-to-ensure-a-replication-agreement-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm",{"title":464,"visible":15,"weight":23,"urlFragment":457,"anchor":465,"singlePageAnchor":465,"docTitle":19,"url":466},"15.2. Using Ansible to ensure replication agreements exist between multiple IdM replicas","using-ansible-to-ensure-replication-agreements-exist-between-multiple-idm-replicas_using-ansible-to-manage-the-replication-topology-in-idm","#using-ansible-to-ensure-replication-agreements-exist-between-multiple-idm-replicas_using-ansible-to-manage-the-replication-topology-in-idm",{"title":468,"visible":15,"weight":28,"urlFragment":457,"anchor":469,"singlePageAnchor":469,"docTitle":19,"url":470},"15.3. Using Ansible to check if a replication agreement exists between two replicas","using-ansible-to-check-if-a-replication-agreement-exists-between-two-replicas_using-ansible-to-manage-the-replication-topology-in-idm","#using-ansible-to-check-if-a-replication-agreement-exists-between-two-replicas_using-ansible-to-manage-the-replication-topology-in-idm",{"title":472,"visible":15,"weight":33,"urlFragment":457,"anchor":473,"singlePageAnchor":473,"docTitle":19,"url":474},"15.4. Using Ansible to verify that a topology suffix exists in IdM","using-ansible-to-verify-that-a-topology-suffix-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm","#using-ansible-to-verify-that-a-topology-suffix-exists-in-idm_using-ansible-to-manage-the-replication-topology-in-idm",{"title":476,"visible":15,"weight":55,"urlFragment":457,"anchor":477,"singlePageAnchor":477,"docTitle":19,"url":478},"15.5. Using Ansible to reinitialize an IdM replica","using-ansible-to-reinitialize-an-idm-replica_using-ansible-to-manage-the-replication-topology-in-idm","#using-ansible-to-reinitialize-an-idm-replica_using-ansible-to-manage-the-replication-topology-in-idm",{"title":480,"visible":15,"weight":60,"urlFragment":457,"anchor":481,"singlePageAnchor":481,"docTitle":19,"url":482},"15.6. Using Ansible to ensure a replication agreement is absent in IdM","using-ansible-to-ensure-a-replication-agreement-is-absent-in-idm_using-ansible-to-manage-the-replication-topology-in-idm","#using-ansible-to-ensure-a-replication-agreement-is-absent-in-idm_using-ansible-to-manage-the-replication-topology-in-idm",{"title":484,"visible":15,"weight":65,"urlFragment":457,"anchor":485,"singlePageAnchor":485,"docTitle":19,"url":486},"15.7. Additional resources","additional-resources_using-ansible-to-manage-the-replication-topology-in-idm","#additional-resources_using-ansible-to-manage-the-replication-topology-in-idm","#using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":489,"visible":15,"weight":490,"urlFragment":491,"anchor":18,"singlePageAnchor":491,"sections":492,"docTitle":19,"url":525},"16. Managing IdM servers by using Ansible",18,"managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management",[493,497,501,505,509,513,517,521],{"title":494,"visible":15,"weight":16,"urlFragment":491,"anchor":495,"singlePageAnchor":495,"docTitle":19,"url":496},"16.1. Checking that an IdM server is present by using Ansible","checking-that-an-idm-server-is-present-by-using-ansible_managing-idm-servers-by-using-ansible","#checking-that-an-idm-server-is-present-by-using-ansible_managing-idm-servers-by-using-ansible",{"title":498,"visible":15,"weight":23,"urlFragment":491,"anchor":499,"singlePageAnchor":499,"docTitle":19,"url":500},"16.2. Ensuring that an IdM server is absent from an IdM topology by using Ansible","ensuring-that-an-idm-server-is-absent-from-an-idm-topology-by-using-ansible_managing-idm-servers-by-using-ansible","#ensuring-that-an-idm-server-is-absent-from-an-idm-topology-by-using-ansible_managing-idm-servers-by-using-ansible",{"title":502,"visible":15,"weight":28,"urlFragment":491,"anchor":503,"singlePageAnchor":503,"docTitle":19,"url":504},"16.3. Ensuring the absence of an IdM server despite hosting a last IdM server role","ensuring-the-absence-of-an-idm-server-despite-hosting-a-last-idm-server-role_managing-idm-servers-by-using-ansible","#ensuring-the-absence-of-an-idm-server-despite-hosting-a-last-idm-server-role_managing-idm-servers-by-using-ansible",{"title":506,"visible":15,"weight":33,"urlFragment":491,"anchor":507,"singlePageAnchor":507,"docTitle":19,"url":508},"16.4. Ensuring that an IdM server is absent but not necessarily disconnected from other IdM servers","ensuring-that-an-idm-server-is-absent-but-not-necessarily-disconnected-from-other-idm-servers_managing-idm-servers-by-using-ansible","#ensuring-that-an-idm-server-is-absent-but-not-necessarily-disconnected-from-other-idm-servers_managing-idm-servers-by-using-ansible",{"title":510,"visible":15,"weight":55,"urlFragment":491,"anchor":511,"singlePageAnchor":511,"docTitle":19,"url":512},"16.5. Ensuring that an existing IdM server is hidden using an Ansible playbook","ensuring-that-an-existing-idm-server-is-hidden-using-an-ansible-playbook_managing-idm-servers-by-using-ansible","#ensuring-that-an-existing-idm-server-is-hidden-using-an-ansible-playbook_managing-idm-servers-by-using-ansible",{"title":514,"visible":15,"weight":60,"urlFragment":491,"anchor":515,"singlePageAnchor":515,"docTitle":19,"url":516},"16.6. Ensuring that an existing IdM server is visible by using an Ansible playbook","ensuring-that-an-existing-idm-server-is-visible-using-an-ansible-playbook_managing-idm-servers-by-using-ansible","#ensuring-that-an-existing-idm-server-is-visible-using-an-ansible-playbook_managing-idm-servers-by-using-ansible",{"title":518,"visible":15,"weight":65,"urlFragment":491,"anchor":519,"singlePageAnchor":519,"docTitle":19,"url":520},"16.7. Ensuring that an existing IdM server has an IdM DNS location assigned","ensuring-that-an-existing-idm-server-has-an-idm-dns-location-assigned_managing-idm-servers-by-using-ansible","#ensuring-that-an-existing-idm-server-has-an-idm-dns-location-assigned_managing-idm-servers-by-using-ansible",{"title":522,"visible":15,"weight":70,"urlFragment":491,"anchor":523,"singlePageAnchor":523,"docTitle":19,"url":524},"16.8. Ensuring that an existing IdM server has no IdM DNS location assigned","ensuring-that-an-existing-idm-server-has-no-idm-dns-location-assigned_managing-idm-servers-by-using-ansible","#ensuring-that-an-existing-idm-server-has-no-idm-dns-location-assigned_managing-idm-servers-by-using-ansible","#managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management",{"title":527,"visible":15,"weight":528,"urlFragment":529,"anchor":18,"singlePageAnchor":530,"sections":531,"docTitle":19,"url":556},"17. Managing hosts using Ansible playbooks",19,"managing-hosts-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management","managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[532,536,540,544,548,552],{"title":533,"visible":15,"weight":16,"urlFragment":529,"anchor":534,"singlePageAnchor":534,"docTitle":19,"url":535},"17.1. Ensuring the presence of an IdM host entry with FQDN using Ansible playbooks","ensuring-the-presence-of-an-IdM-host-entry-with-FQDN-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks","#ensuring-the-presence-of-an-IdM-host-entry-with-FQDN-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks",{"title":537,"visible":15,"weight":23,"urlFragment":529,"anchor":538,"singlePageAnchor":538,"docTitle":19,"url":539},"17.2. Ensuring the presence of an IdM host entry with DNS information using Ansible playbooks","ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks","#ensuring-the-presence-of-an-IdM-host-entry-with-DNS-information-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks",{"title":541,"visible":15,"weight":28,"urlFragment":529,"anchor":542,"singlePageAnchor":542,"docTitle":19,"url":543},"17.3. Ensuring the presence of multiple IdM host entries with random passwords using Ansible playbooks","ensuring-the-presence-of-multiple-IdM-host-entries-with-random-passwords-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks","#ensuring-the-presence-of-multiple-IdM-host-entries-with-random-passwords-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks",{"title":545,"visible":15,"weight":33,"urlFragment":529,"anchor":546,"singlePageAnchor":546,"docTitle":19,"url":547},"17.4. Ensuring the presence of an IdM host entry with multiple IP addresses using Ansible playbooks","ensuring-the-presence-of-an-IdM-host-entry-with-multiple-IP-addresses-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks","#ensuring-the-presence-of-an-IdM-host-entry-with-multiple-IP-addresses-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks",{"title":549,"visible":15,"weight":55,"urlFragment":529,"anchor":550,"singlePageAnchor":550,"docTitle":19,"url":551},"17.5. Ensuring the absence of an IdM host entry using Ansible playbooks","ensuring-the-absence-of-an-IdM-host-entry-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks","#ensuring-the-absence-of-an-IdM-host-entry-using-Ansible-playbooks_managing-hosts-using-Ansible-playbooks",{"title":553,"visible":15,"weight":60,"urlFragment":529,"anchor":554,"singlePageAnchor":554,"docTitle":19,"url":555},"17.6. Additional resources","additional_resources_5","#additional_resources_5","#managing-hosts-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":558,"visible":15,"weight":559,"urlFragment":560,"anchor":18,"singlePageAnchor":561,"sections":562,"docTitle":19,"url":599},"18. Managing host groups using Ansible playbooks",20,"managing-host-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management","managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[563,567,571,575,579,583,587,591,595],{"title":564,"visible":15,"weight":16,"urlFragment":560,"anchor":565,"singlePageAnchor":565,"docTitle":19,"url":566},"18.1. Host groups in IdM","host-groups-in-idm_managing-host-groups-using-Ansible-playbooks","#host-groups-in-idm_managing-host-groups-using-Ansible-playbooks",{"title":568,"visible":15,"weight":23,"urlFragment":560,"anchor":569,"singlePageAnchor":569,"docTitle":19,"url":570},"18.2. Ensuring the presence of IdM host groups using Ansible playbooks","ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#ensuring-the-presence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks",{"title":572,"visible":15,"weight":28,"urlFragment":560,"anchor":573,"singlePageAnchor":573,"docTitle":19,"url":574},"18.3. Ensuring the presence of hosts in IdM host groups using Ansible playbooks","ensuring-the-presence-of-hosts-in-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#ensuring-the-presence-of-hosts-in-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks",{"title":576,"visible":15,"weight":33,"urlFragment":560,"anchor":577,"singlePageAnchor":577,"docTitle":19,"url":578},"18.4. Nesting IdM host groups using Ansible playbooks","nesting-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#nesting-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks",{"title":580,"visible":15,"weight":55,"urlFragment":560,"anchor":581,"singlePageAnchor":581,"docTitle":19,"url":582},"18.5. Ensuring the presence of member managers in IDM host groups using Ansible Playbooks","ensuring-the-presence-of-member-managers-in-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#ensuring-the-presence-of-member-managers-in-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks",{"title":584,"visible":15,"weight":60,"urlFragment":560,"anchor":585,"singlePageAnchor":585,"docTitle":19,"url":586},"18.6. Ensuring the absence of hosts from IdM host groups using Ansible playbooks","ensuring-the-absence-of-hosts-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#ensuring-the-absence-of-hosts-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks",{"title":588,"visible":15,"weight":65,"urlFragment":560,"anchor":589,"singlePageAnchor":589,"docTitle":19,"url":590},"18.7. Ensuring the absence of nested host groups from IdM host groups using Ansible playbooks","ensuring-the-absence-of-nested-host-groups-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#ensuring-the-absence-of-nested-host-groups-from-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks",{"title":592,"visible":15,"weight":70,"urlFragment":560,"anchor":593,"singlePageAnchor":593,"docTitle":19,"url":594},"18.8. Ensuring the absence of IdM host groups using Ansible playbooks","ensuring-the-absence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#ensuring-the-absence-of-IdM-host-groups-using-Ansible-playbooks_managing-host-groups-using-Ansible-playbooks",{"title":596,"visible":15,"weight":75,"urlFragment":560,"anchor":597,"singlePageAnchor":597,"docTitle":19,"url":598},"18.9. Ensuring the absence of member managers from IdM host groups using Ansible playbooks","ensuring-the-absence-of-member-managers-from-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#ensuring-the-absence-of-member-managers-from-idm-host-groups-using-ansible-playbooks_managing-host-groups-using-Ansible-playbooks","#managing-host-groups-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":601,"visible":15,"weight":602,"urlFragment":603,"anchor":18,"singlePageAnchor":603,"sections":604,"docTitle":19,"url":646},"19. Defining IdM password policies",21,"defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management",[605,609,613,617,621,634,638,642],{"title":606,"visible":15,"weight":16,"urlFragment":603,"anchor":607,"singlePageAnchor":607,"docTitle":19,"url":608},"19.1. What is a password policy","what-is-a-password-policy_defining-idm-password-policies","#what-is-a-password-policy_defining-idm-password-policies",{"title":610,"visible":15,"weight":23,"urlFragment":603,"anchor":611,"singlePageAnchor":611,"docTitle":19,"url":612},"19.2. Password policies in IdM","password-policies-in-idm_defining-idm-password-policies","#password-policies-in-idm_defining-idm-password-policies",{"title":614,"visible":15,"weight":28,"urlFragment":603,"anchor":615,"singlePageAnchor":615,"docTitle":19,"url":616},"19.3. Password policy priorities in IdM","password-policy-priorities-in-idm_defining-idm-password-policies","#password-policy-priorities-in-idm_defining-idm-password-policies",{"title":618,"visible":15,"weight":33,"urlFragment":603,"anchor":619,"singlePageAnchor":619,"docTitle":19,"url":620},"19.4. Ensuring the presence of a password policy in IdM using an Ansible playbook","ensuring-the-presence-of-a-password-policy-in-idm-using-an-ansible-playbook_defining-idm-password-policies","#ensuring-the-presence-of-a-password-policy-in-idm-using-an-ansible-playbook_defining-idm-password-policies",{"title":622,"visible":15,"weight":55,"urlFragment":603,"anchor":623,"singlePageAnchor":623,"sections":624,"docTitle":19,"url":633},"19.5. Adding a new password policy in IdM using the WebUI or the CLI","adding-a-new-password-policy-in-idm_defining-idm-password-policies",[625,629],{"title":626,"visible":15,"weight":16,"urlFragment":603,"anchor":627,"singlePageAnchor":627,"docTitle":19,"url":628},"19.5.1. Adding a new password policy in the IdM WebUI","adding-a-new-password-policy-webui_adding-a-new-password-policy-in-idm","#adding-a-new-password-policy-webui_adding-a-new-password-policy-in-idm",{"title":630,"visible":15,"weight":23,"urlFragment":603,"anchor":631,"singlePageAnchor":631,"docTitle":19,"url":632},"19.5.2. Adding a new password policy in the IdM CLI","adding-a-new-password-policy-in-the-idm-cli_adding-a-new-password-policy-in-idm","#adding-a-new-password-policy-in-the-idm-cli_adding-a-new-password-policy-in-idm","#adding-a-new-password-policy-in-idm_defining-idm-password-policies",{"title":635,"visible":15,"weight":60,"urlFragment":603,"anchor":636,"singlePageAnchor":636,"docTitle":19,"url":637},"19.6. Additional password policy options in IdM","additional-password-policy-options-in-idm_defining-idm-password-policies","#additional-password-policy-options-in-idm_defining-idm-password-policies",{"title":639,"visible":15,"weight":65,"urlFragment":603,"anchor":640,"singlePageAnchor":640,"docTitle":19,"url":641},"19.7. Applying additional password policy options to an IdM group","applying-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies","#applying-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies",{"title":643,"visible":15,"weight":70,"urlFragment":603,"anchor":644,"singlePageAnchor":644,"docTitle":19,"url":645},"19.8. Using an Ansible playbook to apply additional password policy options to an IdM group","using-an-ansible-playbook-to-apply-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies","#using-an-ansible-playbook-to-apply-additional-password-policy-options-to-an-idm-group_defining-idm-password-policies","#defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management",{"title":648,"visible":15,"weight":649,"urlFragment":650,"anchor":18,"singlePageAnchor":651,"sections":652,"docTitle":19,"url":697},"20. Granting sudo access to an IdM user on an IdM client",22,"granting-sudo-access-to-an-idm-user-on-an-idm-client_using-ansible-to-install-and-manage-identity-management","granting-sudo-access-to-an-IdM-user-on-an-IdM-client_using-ansible-to-install-and-manage-identity-management",[653,657,661,665,669,673,677,681,685,689,693],{"title":654,"visible":15,"weight":16,"urlFragment":650,"anchor":655,"singlePageAnchor":655,"docTitle":19,"url":656},"20.1. Sudo access on an IdM client","sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#sudo-access-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":658,"visible":15,"weight":23,"urlFragment":650,"anchor":659,"singlePageAnchor":659,"docTitle":19,"url":660},"20.2. Granting sudo access to an IdM user on an IdM client using the CLI","proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#proc_granting-sudo-access-to-an-idm-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":662,"visible":15,"weight":28,"urlFragment":650,"anchor":663,"singlePageAnchor":663,"docTitle":19,"url":664},"20.3. Granting sudo access to an AD user on an IdM client using the CLI","proc_granting-sudo-access-to-an-ad-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#proc_granting-sudo-access-to-an-ad-user-on-an-idm-client-using-the-cli_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":666,"visible":15,"weight":33,"urlFragment":650,"anchor":667,"singlePageAnchor":667,"docTitle":19,"url":668},"20.4. Granting sudo access to an IdM user on an IdM client using the IdM Web UI","using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#using-IdM-Web-UI-to-grant-sudo-access-to-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":670,"visible":15,"weight":55,"urlFragment":650,"anchor":671,"singlePageAnchor":671,"docTitle":19,"url":672},"20.5. Creating a sudo rule on the CLI that runs a command as a service account on an IdM client","proc_creating-a-sudo-rule-on-the-cli-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#proc_creating-a-sudo-rule-on-the-cli-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":674,"visible":15,"weight":60,"urlFragment":650,"anchor":675,"singlePageAnchor":675,"docTitle":19,"url":676},"20.6. Creating a sudo rule in the IdM WebUI that runs a command as a service account on an IdM client","proc_creating-a-sudo-rule-in-the-idm-webui-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#proc_creating-a-sudo-rule-in-the-idm-webui-that-runs-a-command-as-a-service-account-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":678,"visible":15,"weight":65,"urlFragment":650,"anchor":679,"singlePageAnchor":679,"docTitle":19,"url":680},"20.7. Enabling GSSAPI authentication for sudo on an IdM client","proc_enabling-gssapi-authentication-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#proc_enabling-gssapi-authentication-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":682,"visible":15,"weight":70,"urlFragment":650,"anchor":683,"singlePageAnchor":683,"docTitle":19,"url":684},"20.8. Enabling GSSAPI authentication and enforcing Kerberos authentication indicators for sudo on an IdM client","proc_enabling-gssapi-authentication-and-enforcing-kerberos-authentication-indicators-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#proc_enabling-gssapi-authentication-and-enforcing-kerberos-authentication-indicators-for-sudo-on-an-idm-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":686,"visible":15,"weight":75,"urlFragment":650,"anchor":687,"singlePageAnchor":687,"docTitle":19,"url":688},"20.9. SSSD options controlling GSSAPI authentication for PAM services","ref_sssd-options-controlling-gssapi-authentication-for-pam-services_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#ref_sssd-options-controlling-gssapi-authentication-for-pam-services_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":690,"visible":15,"weight":80,"urlFragment":650,"anchor":691,"singlePageAnchor":691,"docTitle":19,"url":692},"20.10. Troubleshooting GSSAPI authentication for sudo","proc_troubleshooting-gssapi-authentication-for-sudo_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#proc_troubleshooting-gssapi-authentication-for-sudo_granting-sudo-access-to-an-IdM-user-on-an-IdM-client",{"title":694,"visible":15,"weight":85,"urlFragment":650,"anchor":695,"singlePageAnchor":695,"docTitle":19,"url":696},"20.11. Using an Ansible playbook to ensure sudo access for an IdM user on an IdM client","using-an-Ansible-playbook-to-ensure-sudo-access-for-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#using-an-Ansible-playbook-to-ensure-sudo-access-for-an-IdM-user-on-an-IdM-client_granting-sudo-access-to-an-IdM-user-on-an-IdM-client","#granting-sudo-access-to-an-IdM-user-on-an-IdM-client_using-ansible-to-install-and-manage-identity-management",{"title":699,"visible":15,"weight":700,"urlFragment":701,"anchor":18,"singlePageAnchor":702,"sections":703,"docTitle":19,"url":712},"21. Ensuring the presence of host-based access control rules in IdM using Ansible playbooks",23,"ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management","ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[704,708],{"title":705,"visible":15,"weight":16,"urlFragment":701,"anchor":706,"singlePageAnchor":706,"docTitle":19,"url":707},"21.1. Host-based access control rules in IdM","host-based-access-control-rules-in-idm_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks","#host-based-access-control-rules-in-idm_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks",{"title":709,"visible":15,"weight":23,"urlFragment":701,"anchor":710,"singlePageAnchor":710,"docTitle":19,"url":711},"21.2. Ensuring the presence of an HBAC rule in IdM using an Ansible playbook","ensuring-the-presence-of-an-hbac-rule-in-idm-using-an-ansible-playbook_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks","#ensuring-the-presence-of-an-hbac-rule-in-idm-using-an-ansible-playbook_ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks","#ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-Ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":714,"visible":15,"weight":715,"urlFragment":716,"anchor":18,"singlePageAnchor":716,"sections":717,"docTitle":19,"url":734},"22. Managing IdM certificates using Ansible",24,"managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management",[718,722,726,730],{"title":719,"visible":15,"weight":16,"urlFragment":716,"anchor":720,"singlePageAnchor":720,"docTitle":19,"url":721},"22.1. Using Ansible to request SSL certificates for IdM hosts, services and users","using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible","#using-ansible-to-request-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible",{"title":723,"visible":15,"weight":23,"urlFragment":716,"anchor":724,"singlePageAnchor":724,"docTitle":19,"url":725},"22.2. Using Ansible to revoke SSL certificates for IdM hosts, services and users","using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible","#using-ansible-to-revoke-ssl-certificates-for-idm-hosts-services-and-users_managing-idm-certificates-using-ansible",{"title":727,"visible":15,"weight":28,"urlFragment":716,"anchor":728,"singlePageAnchor":728,"docTitle":19,"url":729},"22.3. Using Ansible to restore SSL certificates for IdM users, hosts, and services","using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible","#using-ansible-to-restore-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible",{"title":731,"visible":15,"weight":33,"urlFragment":716,"anchor":732,"singlePageAnchor":732,"docTitle":19,"url":733},"22.4. Using Ansible to retrieve SSL certificates for IdM users, hosts, and services","using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible","#using-ansible-to-retrieve-ssl-certificates-for-idm-users-hosts-and-services_managing-idm-certificates-using-ansible","#managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management",{"title":736,"visible":15,"weight":737,"urlFragment":738,"anchor":18,"singlePageAnchor":738,"sections":739,"docTitle":19,"url":768},"23. Vaults in IdM",25,"vaults-in-idm_using-ansible-to-install-and-manage-identity-management",[740,744,748,752,756,760,764],{"title":741,"visible":15,"weight":16,"urlFragment":738,"anchor":742,"singlePageAnchor":742,"docTitle":19,"url":743},"23.1. Vaults and their benefits","vaults-and-their-benefits_vaults-in-idm","#vaults-and-their-benefits_vaults-in-idm",{"title":745,"visible":15,"weight":23,"urlFragment":738,"anchor":746,"singlePageAnchor":746,"docTitle":19,"url":747},"23.2. Vault owners, members, and administrators","vault-owners-members-and-administrators_vaults-in-idm","#vault-owners-members-and-administrators_vaults-in-idm",{"title":749,"visible":15,"weight":28,"urlFragment":738,"anchor":750,"singlePageAnchor":750,"docTitle":19,"url":751},"23.3. Standard, symmetric, and asymmetric vaults","standard-symmetric-and-asymmetric-vaults_vaults-in-idm","#standard-symmetric-and-asymmetric-vaults_vaults-in-idm",{"title":753,"visible":15,"weight":33,"urlFragment":738,"anchor":754,"singlePageAnchor":754,"docTitle":19,"url":755},"23.4. User, service, and shared vaults","user-service-and-shared-vaults_vaults-in-idm","#user-service-and-shared-vaults_vaults-in-idm",{"title":757,"visible":15,"weight":55,"urlFragment":738,"anchor":758,"singlePageAnchor":758,"docTitle":19,"url":759},"23.5. Vault containers","vault-containers_vaults-in-idm","#vault-containers_vaults-in-idm",{"title":761,"visible":15,"weight":60,"urlFragment":738,"anchor":762,"singlePageAnchor":762,"docTitle":19,"url":763},"23.6. Basic IdM vault commands","basic-idm-vault-commands_vaults-in-idm","#basic-idm-vault-commands_vaults-in-idm",{"title":765,"visible":15,"weight":65,"urlFragment":738,"anchor":766,"singlePageAnchor":766,"docTitle":19,"url":767},"23.7. Installing the Key Recovery Authority in IdM","installing-the-key-recovery-authority-component-in-idm_vaults-in-idm","#installing-the-key-recovery-authority-component-in-idm_vaults-in-idm","#vaults-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":770,"visible":15,"weight":771,"urlFragment":772,"anchor":18,"singlePageAnchor":772,"sections":773,"docTitle":19,"url":786},"24. Using Ansible to manage IdM user vaults: storing and retrieving secrets",26,"using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management",[774,778,782],{"title":775,"visible":15,"weight":16,"urlFragment":772,"anchor":776,"singlePageAnchor":776,"docTitle":19,"url":777},"24.1. Ensuring the presence of a standard user vault in IdM using Ansible","ensuring-the-presence-of-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets","#ensuring-the-presence-of-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets",{"title":779,"visible":15,"weight":23,"urlFragment":772,"anchor":780,"singlePageAnchor":780,"docTitle":19,"url":781},"24.2. Archiving a secret in a standard user vault in IdM using Ansible","archiving-a-secret-in-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets","#archiving-a-secret-in-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets",{"title":783,"visible":15,"weight":28,"urlFragment":772,"anchor":784,"singlePageAnchor":784,"docTitle":19,"url":785},"24.3. Retrieving a secret from a standard user vault in IdM using Ansible","retrieving-a-secret-from-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets","#retrieving-a-secret-from-a-standard-user-vault-in-idm-using-ansible_using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets","#using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management",{"title":788,"visible":15,"weight":789,"urlFragment":790,"anchor":18,"singlePageAnchor":790,"sections":791,"docTitle":19,"url":816},"25. Using Ansible to manage IdM service vaults: storing and retrieving secrets",27,"using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management",[792,796,800,804,808,812],{"title":793,"visible":15,"weight":16,"urlFragment":790,"anchor":794,"singlePageAnchor":794,"docTitle":19,"url":795},"25.1. Ensuring the presence of an asymmetric service vault in IdM using Ansible","ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets","#ensuring-the-presence-of-an-asymmetric-service-vault-in-idm-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets",{"title":797,"visible":15,"weight":23,"urlFragment":790,"anchor":798,"singlePageAnchor":798,"docTitle":19,"url":799},"25.2. Adding member services to an asymmetric vault using Ansible","adding-member-services-to-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets","#adding-member-services-to-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets",{"title":801,"visible":15,"weight":28,"urlFragment":790,"anchor":802,"singlePageAnchor":802,"docTitle":19,"url":803},"25.3. Storing an IdM service secret in an asymmetric vault using Ansible","storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets","#storing-an-idm-service-secret-in-an-asymmetric-vault-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets",{"title":805,"visible":15,"weight":33,"urlFragment":790,"anchor":806,"singlePageAnchor":806,"docTitle":19,"url":807},"25.4. Retrieving a service secret for an IdM service using Ansible","retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets","#retrieving-a-service-secret-for-an-idm-service-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets",{"title":809,"visible":15,"weight":55,"urlFragment":790,"anchor":810,"singlePageAnchor":810,"docTitle":19,"url":811},"25.5. Changing an IdM service vault secret when compromised using Ansible","changing-an-idm-service-vault-secret-when-compromised-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets","#changing-an-idm-service-vault-secret-when-compromised-using-ansible_using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets",{"title":813,"visible":15,"weight":60,"urlFragment":790,"anchor":814,"singlePageAnchor":814,"docTitle":19,"url":815},"25.6. Additional resources","additional_resources_6","#additional_resources_6","#using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management",{"title":818,"visible":15,"weight":819,"urlFragment":820,"anchor":18,"singlePageAnchor":820,"sections":821,"docTitle":19,"url":862},"26. Ensuring the presence and absence of services in IdM using Ansible",28,"ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management",[822,826,830,834,838,842,846,850,854,858],{"title":823,"visible":15,"weight":16,"urlFragment":820,"anchor":824,"singlePageAnchor":824,"docTitle":19,"url":825},"26.1. Ensuring the presence of an HTTP service in IdM using an Ansible playbook","ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#ensuring-the-presence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":827,"visible":15,"weight":23,"urlFragment":820,"anchor":828,"singlePageAnchor":828,"docTitle":19,"url":829},"26.2. Ensuring the presence of multiple services in IdM on an IdM client using a single Ansible task","ensuring-the-presence-of-multiple-services-in-idm-on-an-idm-client-using-a-single-ansible-task_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#ensuring-the-presence-of-multiple-services-in-idm-on-an-idm-client-using-a-single-ansible-task_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":831,"visible":15,"weight":28,"urlFragment":820,"anchor":832,"singlePageAnchor":832,"docTitle":19,"url":833},"26.3. Ensuring the presence of an HTTP service in IdM on a non-IdM client using an Ansible playbook","ensuring-the-presence-of-an-http-service-in-idm-on-a-non-idm-client-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#ensuring-the-presence-of-an-http-service-in-idm-on-a-non-idm-client-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":835,"visible":15,"weight":33,"urlFragment":820,"anchor":836,"singlePageAnchor":836,"docTitle":19,"url":837},"26.4. Ensuring the presence of an HTTP service on an IdM client without DNS using an Ansible playbook","ensuring-the-presence-of-an-http-service-on-an-idm-client-without-dns-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#ensuring-the-presence-of-an-http-service-on-an-idm-client-without-dns-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":839,"visible":15,"weight":55,"urlFragment":820,"anchor":840,"singlePageAnchor":840,"docTitle":19,"url":841},"26.5. Ensuring the presence of an externally signed certificate in an IdM service entry using an Ansible playbook","ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#ensuring-the-presence-of-an-externally-signed-certificate-in-an-idm-service-entry-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":843,"visible":15,"weight":60,"urlFragment":820,"anchor":844,"singlePageAnchor":844,"docTitle":19,"url":845},"26.6. Using an Ansible playbook to allow IdM users, groups, hosts, or host groups to create a keytab of a service","using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-create-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-create-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":847,"visible":15,"weight":65,"urlFragment":820,"anchor":848,"singlePageAnchor":848,"docTitle":19,"url":849},"26.7. Using an Ansible playbook to allow IdM users, groups, hosts, or host groups to retrieve a keytab of a service","using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-retrieve-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#using-an-ansible-playbook-to-allow-idm-users-groups-hosts-or-host-groups-to-retrieve-a-keytab-of-a-service_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":851,"visible":15,"weight":70,"urlFragment":820,"anchor":852,"singlePageAnchor":852,"docTitle":19,"url":853},"26.8. Ensuring the presence of a Kerberos principal alias of a service using an Ansible playbook","ensuring-the-presence-of-a-kerberos-principal-alias-of-a-service-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#ensuring-the-presence-of-a-kerberos-principal-alias-of-a-service-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":855,"visible":15,"weight":75,"urlFragment":820,"anchor":856,"singlePageAnchor":856,"docTitle":19,"url":857},"26.9. Ensuring the absence of an HTTP service in IdM using an Ansible playbook","ensuring-the-absence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible","#ensuring-the-absence-of-an-http-service-in-idm-using-an-ansible-playbook_ensuring-the-presence-and-absence-of-services-in-idm-using-ansible",{"title":859,"visible":15,"weight":80,"urlFragment":820,"anchor":860,"singlePageAnchor":860,"docTitle":19,"url":861},"26.10. Additional resources","additional_resources_7","#additional_resources_7","#ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management",{"title":864,"visible":15,"weight":865,"urlFragment":866,"anchor":18,"singlePageAnchor":866,"sections":867,"docTitle":19,"url":900},"27. Managing global DNS configuration in IdM using Ansible playbooks",29,"managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management",[868,872,876,880,884,888,892,896],{"title":869,"visible":15,"weight":16,"urlFragment":866,"anchor":870,"singlePageAnchor":870,"docTitle":19,"url":871},"27.1. How IdM ensures that global forwarders from /etc/resolv.conf are not removed by NetworkManager","how-idm-ensures-that-global-forwarders-from-etc-resolv-conf-are-not-removed-by-networkmanager_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#how-idm-ensures-that-global-forwarders-from-etc-resolv-conf-are-not-removed-by-networkmanager_managing-global-dns-configuration-in-idm-using-ansible-playbooks",{"title":873,"visible":15,"weight":23,"urlFragment":866,"anchor":874,"singlePageAnchor":874,"docTitle":19,"url":875},"27.2. Ensuring the presence of a DNS global forwarder in IdM using Ansible","ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks",{"title":877,"visible":15,"weight":28,"urlFragment":866,"anchor":878,"singlePageAnchor":878,"docTitle":19,"url":879},"27.3. Ensuring the absence of a DNS global forwarder in IdM using Ansible","ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-global-dns-configuration-in-idm-using-ansible-playbooks",{"title":881,"visible":15,"weight":33,"urlFragment":866,"anchor":882,"singlePageAnchor":882,"docTitle":19,"url":883},"27.4. The action: member option in ipadnsconfig ansible-freeipa modules","the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#the-action-member-option-in-ipadnsconfig-ansible-freeipa-modules_managing-global-dns-configuration-in-idm-using-ansible-playbooks",{"title":885,"visible":15,"weight":55,"urlFragment":866,"anchor":886,"singlePageAnchor":886,"docTitle":19,"url":887},"27.5. DNS forward policies in IdM","dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#dns-forward-policies-in-idm_managing-global-dns-configuration-in-idm-using-ansible-playbooks",{"title":889,"visible":15,"weight":60,"urlFragment":866,"anchor":890,"singlePageAnchor":890,"docTitle":19,"url":891},"27.6. Using an Ansible playbook to ensure that the forward first policy is set in IdM DNS global configuration","using-an-ansible-playbook-to-ensure-that-the-forward-first-policy-is-set-in-idm-dns-global-configuration_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#using-an-ansible-playbook-to-ensure-that-the-forward-first-policy-is-set-in-idm-dns-global-configuration_managing-global-dns-configuration-in-idm-using-ansible-playbooks",{"title":893,"visible":15,"weight":65,"urlFragment":866,"anchor":894,"singlePageAnchor":894,"docTitle":19,"url":895},"27.7. Using an Ansible playbook to ensure that global forwarders are disabled in IdM DNS","using-an-ansible-playbook-to-ensure-that-global-forwarders-are-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#using-an-ansible-playbook-to-ensure-that-global-forwarders-are-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks",{"title":897,"visible":15,"weight":70,"urlFragment":866,"anchor":898,"singlePageAnchor":898,"docTitle":19,"url":899},"27.8. Using an Ansible playbook to ensure that synchronization of forward and reverse lookup zones is disabled in IdM DNS","using-an-ansible-playbook-to-ensure-that-synchronization-of-forward-and-reverse-lookup-zones-is-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#using-an-ansible-playbook-to-ensure-that-synchronization-of-forward-and-reverse-lookup-zones-is-disabled-in-idm-dns_managing-global-dns-configuration-in-idm-using-ansible-playbooks","#managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management",{"title":902,"visible":15,"weight":903,"urlFragment":904,"anchor":18,"singlePageAnchor":904,"sections":905,"docTitle":19,"url":926},"28. Using Ansible playbooks to manage IdM DNS zones",30,"using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management",[906,910,914,918,922],{"title":907,"visible":15,"weight":16,"urlFragment":904,"anchor":908,"singlePageAnchor":908,"docTitle":19,"url":909},"28.1. Supported DNS zone types","supported-dns-zone-types_using-ansible-playbooks-to-manage-idm-dns-zones","#supported-dns-zone-types_using-ansible-playbooks-to-manage-idm-dns-zones",{"title":911,"visible":15,"weight":23,"urlFragment":904,"anchor":912,"singlePageAnchor":912,"docTitle":19,"url":913},"28.2. Configuration attributes of primary IdM DNS zones","configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones","#configuration-attributes-of-primary-idm-dns-zones_using-ansible-playbooks-to-manage-idm-dns-zones",{"title":915,"visible":15,"weight":28,"urlFragment":904,"anchor":916,"singlePageAnchor":916,"docTitle":19,"url":917},"28.3. Using Ansible to create a primary zone in IdM DNS","using-ansible-to-create-a-primary-zone-in-idm-dns_using-ansible-playbooks-to-manage-idm-dns-zones","#using-ansible-to-create-a-primary-zone-in-idm-dns_using-ansible-playbooks-to-manage-idm-dns-zones",{"title":919,"visible":15,"weight":33,"urlFragment":904,"anchor":920,"singlePageAnchor":920,"docTitle":19,"url":921},"28.4. Using an Ansible playbook to ensure the presence of a primary DNS zone in IdM with multiple variables","using-an-ansible-playbook-to-ensure-the-presence-of-a-primary-dns-zone-in-idm-with-multiple-variables_using-ansible-playbooks-to-manage-idm-dns-zones","#using-an-ansible-playbook-to-ensure-the-presence-of-a-primary-dns-zone-in-idm-with-multiple-variables_using-ansible-playbooks-to-manage-idm-dns-zones",{"title":923,"visible":15,"weight":55,"urlFragment":904,"anchor":924,"singlePageAnchor":924,"docTitle":19,"url":925},"28.5. Using an Ansible playbook to ensure the presence of a zone for reverse DNS lookup when an IP address is given","using-an-ansible-playbook-to-ensure-the-presence-of-a-zone-for-reverse-dns-lookup-when-an-ip-address-is-given_using-ansible-playbooks-to-manage-idm-dns-zones","#using-an-ansible-playbook-to-ensure-the-presence-of-a-zone-for-reverse-dns-lookup-when-an-ip-address-is-given_using-ansible-playbooks-to-manage-idm-dns-zones","#using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management",{"title":928,"visible":15,"weight":929,"urlFragment":930,"anchor":18,"singlePageAnchor":930,"sections":931,"docTitle":19,"url":956},"29. Using Ansible to manage DNS locations in IdM",31,"using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management",[932,936,940,944,948,952],{"title":933,"visible":15,"weight":16,"urlFragment":930,"anchor":934,"singlePageAnchor":934,"docTitle":19,"url":935},"29.1. DNS-based service discovery","dns-based-service-discovery_using-ansible-to-manage-dns-locations-in-idm","#dns-based-service-discovery_using-ansible-to-manage-dns-locations-in-idm",{"title":937,"visible":15,"weight":23,"urlFragment":930,"anchor":938,"singlePageAnchor":938,"docTitle":19,"url":939},"29.2. Deployment considerations for DNS locations","deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm","#deployment-considerations-for-dns-locations_using-ansible-to-manage-dns-locations-in-idm",{"title":941,"visible":15,"weight":28,"urlFragment":930,"anchor":942,"singlePageAnchor":942,"docTitle":19,"url":943},"29.3. DNS time to live (TTL)","dns-time-to-live-ttl_using-ansible-to-manage-dns-locations-in-idm","#dns-time-to-live-ttl_using-ansible-to-manage-dns-locations-in-idm",{"title":945,"visible":15,"weight":33,"urlFragment":930,"anchor":946,"singlePageAnchor":946,"docTitle":19,"url":947},"29.4. Using Ansible to ensure an IdM location is present","using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm","#using-ansible-to-ensure-an-idm-location-is-present_using-ansible-to-manage-dns-locations-in-idm",{"title":949,"visible":15,"weight":55,"urlFragment":930,"anchor":950,"singlePageAnchor":950,"docTitle":19,"url":951},"29.5. Using Ansible to ensure an IdM location is absent","using-ansible-to-ensure-an-idm-location-is-absent_using-ansible-to-manage-dns-locations-in-idm","#using-ansible-to-ensure-an-idm-location-is-absent_using-ansible-to-manage-dns-locations-in-idm",{"title":953,"visible":15,"weight":60,"urlFragment":930,"anchor":954,"singlePageAnchor":954,"docTitle":19,"url":955},"29.6. Additional resources","additional_resources_8","#additional_resources_8","#using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":958,"visible":15,"weight":959,"urlFragment":960,"anchor":18,"singlePageAnchor":960,"sections":961,"docTitle":19,"url":1018},"30. Managing DNS forwarding in IdM",32,"managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management",[962,966,970,974,978,982,986,990,994,998,1002,1006,1010,1014],{"title":963,"visible":15,"weight":16,"urlFragment":960,"anchor":964,"singlePageAnchor":964,"docTitle":19,"url":965},"30.1. The two roles of an IdM DNS server","the-two-roles-of-an-idm-dns-server_managing-dns-forwarding-in-idm","#the-two-roles-of-an-idm-dns-server_managing-dns-forwarding-in-idm",{"title":967,"visible":15,"weight":23,"urlFragment":960,"anchor":968,"singlePageAnchor":968,"docTitle":19,"url":969},"30.2. DNS forward policies in IdM","dns-forward-policies-in-idm_managing-dns-forwarding-in-idm","#dns-forward-policies-in-idm_managing-dns-forwarding-in-idm",{"title":971,"visible":15,"weight":28,"urlFragment":960,"anchor":972,"singlePageAnchor":972,"docTitle":19,"url":973},"30.3. Adding a global forwarder in the IdM Web UI","adding-a-global-forwarder-in-the-idm-web-ui_managing-dns-forwarding-in-idm","#adding-a-global-forwarder-in-the-idm-web-ui_managing-dns-forwarding-in-idm",{"title":975,"visible":15,"weight":33,"urlFragment":960,"anchor":976,"singlePageAnchor":976,"docTitle":19,"url":977},"30.4. Adding a global forwarder in the CLI","adding-a-global-forwarder-in-the-cli_managing-dns-forwarding-in-idm","#adding-a-global-forwarder-in-the-cli_managing-dns-forwarding-in-idm",{"title":979,"visible":15,"weight":55,"urlFragment":960,"anchor":980,"singlePageAnchor":980,"docTitle":19,"url":981},"30.5. Adding a DNS Forward Zone in the IdM Web UI","adding-a-dns-forward-zone-in-the-idm-web-ui_managing-dns-forwarding-in-idm","#adding-a-dns-forward-zone-in-the-idm-web-ui_managing-dns-forwarding-in-idm",{"title":983,"visible":15,"weight":60,"urlFragment":960,"anchor":984,"singlePageAnchor":984,"docTitle":19,"url":985},"30.6. Adding a DNS Forward Zone in the CLI","adding-a-dns-forward-zone-in-the-cli_managing-dns-forwarding-in-idm","#adding-a-dns-forward-zone-in-the-cli_managing-dns-forwarding-in-idm",{"title":987,"visible":15,"weight":65,"urlFragment":960,"anchor":988,"singlePageAnchor":988,"docTitle":19,"url":989},"30.7. Establishing a DNS Global Forwarder in IdM using Ansible","establishing-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm","#establishing-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm",{"title":991,"visible":15,"weight":70,"urlFragment":960,"anchor":992,"singlePageAnchor":992,"docTitle":19,"url":993},"30.8. Ensuring the presence of a DNS global forwarder in IdM using Ansible","ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm","#ensuring-the-presence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm",{"title":995,"visible":15,"weight":75,"urlFragment":960,"anchor":996,"singlePageAnchor":996,"docTitle":19,"url":997},"30.9. Ensuring the absence of a DNS global forwarder in IdM using Ansible","ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm","#ensuring-the-absence-of-a-dns-global-forwarder-in-idm-using-ansible_managing-dns-forwarding-in-idm",{"title":999,"visible":15,"weight":80,"urlFragment":960,"anchor":1000,"singlePageAnchor":1000,"docTitle":19,"url":1001},"30.10. Ensuring DNS Global Forwarders are disabled in IdM using Ansible","ensuring-dns-global-forwarders-are-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm","#ensuring-dns-global-forwarders-are-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm",{"title":1003,"visible":15,"weight":85,"urlFragment":960,"anchor":1004,"singlePageAnchor":1004,"docTitle":19,"url":1005},"30.11. Ensuring the presence of a DNS Forward Zone in IdM using Ansible","ensuring-the-presence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm","#ensuring-the-presence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm",{"title":1007,"visible":15,"weight":282,"urlFragment":960,"anchor":1008,"singlePageAnchor":1008,"docTitle":19,"url":1009},"30.12. Ensuring a DNS Forward Zone has multiple forwarders in IdM using Ansible","ensuring-a-dns-forward-zone-has-multiple-forwarders-in-idm-using-ansible_managing-dns-forwarding-in-idm","#ensuring-a-dns-forward-zone-has-multiple-forwarders-in-idm-using-ansible_managing-dns-forwarding-in-idm",{"title":1011,"visible":15,"weight":308,"urlFragment":960,"anchor":1012,"singlePageAnchor":1012,"docTitle":19,"url":1013},"30.13. Ensuring a DNS Forward Zone is disabled in IdM using Ansible","ensuring-a-dns-forward-zone-is-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm","#ensuring-a-dns-forward-zone-is-disabled-in-idm-using-ansible_managing-dns-forwarding-in-idm",{"title":1015,"visible":15,"weight":338,"urlFragment":960,"anchor":1016,"singlePageAnchor":1016,"docTitle":19,"url":1017},"30.14. Ensuring the absence of a DNS Forward Zone in IdM using Ansible","ensuring-the-absence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm","#ensuring-the-absence-of-a-dns-forward-zone-in-idm-using-ansible_managing-dns-forwarding-in-idm","#managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":1020,"visible":15,"weight":1021,"urlFragment":1022,"anchor":18,"singlePageAnchor":1022,"sections":1023,"docTitle":19,"url":1052},"31. Using Ansible to manage DNS records in IdM",33,"using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management",[1024,1028,1032,1036,1040,1044,1048],{"title":1025,"visible":15,"weight":16,"urlFragment":1022,"anchor":1026,"singlePageAnchor":1026,"docTitle":19,"url":1027},"31.1. DNS records in IdM","dns-records-in-idm_using-ansible-to-manage-dns-records-in-idm","#dns-records-in-idm_using-ansible-to-manage-dns-records-in-idm",{"title":1029,"visible":15,"weight":23,"urlFragment":1022,"anchor":1030,"singlePageAnchor":1030,"docTitle":19,"url":1031},"31.2. Common ipa dnsrecord-* options","common-ipa-dnsrecord-options_using-ansible-to-manage-dns-records-in-idm","#common-ipa-dnsrecord-options_using-ansible-to-manage-dns-records-in-idm",{"title":1033,"visible":15,"weight":28,"urlFragment":1022,"anchor":1034,"singlePageAnchor":1034,"docTitle":19,"url":1035},"31.3. Ensuring the presence of A and AAAA DNS records in IdM using Ansible","ensuring-the-presence-of-a-and-aaaa-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm","#ensuring-the-presence-of-a-and-aaaa-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm",{"title":1037,"visible":15,"weight":33,"urlFragment":1022,"anchor":1038,"singlePageAnchor":1038,"docTitle":19,"url":1039},"31.4. Ensuring the presence of A and PTR DNS records in IdM using Ansible","ensuring-the-presence-of-a-and-ptr-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm","#ensuring-the-presence-of-a-and-ptr-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm",{"title":1041,"visible":15,"weight":55,"urlFragment":1022,"anchor":1042,"singlePageAnchor":1042,"docTitle":19,"url":1043},"31.5. Ensuring the presence of multiple DNS records in IdM using Ansible","ensuring-the-presence-of-multiple-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm","#ensuring-the-presence-of-multiple-dns-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm",{"title":1045,"visible":15,"weight":60,"urlFragment":1022,"anchor":1046,"singlePageAnchor":1046,"docTitle":19,"url":1047},"31.6. Ensuring the presence of multiple CNAME records in IdM using Ansible","ensuring-the-presence-of-multiple-cname-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm","#ensuring-the-presence-of-multiple-cname-records-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm",{"title":1049,"visible":15,"weight":65,"urlFragment":1022,"anchor":1050,"singlePageAnchor":1050,"docTitle":19,"url":1051},"31.7. Ensuring the presence of an SRV record in IdM using Ansible","ensuring-the-presence-of-an-srv-record-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm","#ensuring-the-presence-of-an-srv-record-in-idm-using-ansible_using-ansible-to-manage-dns-records-in-idm","#using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":1054,"visible":15,"weight":1055,"urlFragment":1056,"anchor":18,"singlePageAnchor":1056,"sections":1057,"docTitle":19,"url":1082},"32. Using Ansible to automount NFS shares for IdM users",34,"using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management",[1058,1062,1066,1070,1074,1078],{"title":1059,"visible":15,"weight":16,"urlFragment":1056,"anchor":1060,"singlePageAnchor":1060,"docTitle":19,"url":1061},"32.1. Autofs and automount in IdM","autofs-and-automount-in-idm_using-ansible-to-automount-nfs-shares-for-idm-users","#autofs-and-automount-in-idm_using-ansible-to-automount-nfs-shares-for-idm-users",{"title":1063,"visible":15,"weight":23,"urlFragment":1056,"anchor":1064,"singlePageAnchor":1064,"docTitle":19,"url":1065},"32.2. Setting up an NFS server with Kerberos in a Red Hat Identity Management domain","setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users","#setting-up-an-nfs-server-with-kerberos-in-a-red-hat-identity-management-domain_using-ansible-to-automount-nfs-shares-for-idm-users",{"title":1067,"visible":15,"weight":28,"urlFragment":1056,"anchor":1068,"singlePageAnchor":1068,"docTitle":19,"url":1069},"32.3. Configuring automount locations, maps, and keys in IdM by using Ansible","configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users","#configuring-automount-locations-maps-and-keys-in-idm-by-using-ansible_using-ansible-to-automount-nfs-shares-for-idm-users",{"title":1071,"visible":15,"weight":33,"urlFragment":1056,"anchor":1072,"singlePageAnchor":1072,"docTitle":19,"url":1073},"32.4. Using Ansible to add IdM users to a group that owns NFS shares","using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users","#using-ansible-to-add-idm-users-to-a-group-that-owns-nfs-shares_using-ansible-to-automount-nfs-shares-for-idm-users",{"title":1075,"visible":15,"weight":55,"urlFragment":1056,"anchor":1076,"singlePageAnchor":1076,"docTitle":19,"url":1077},"32.5. Configuring automount on an IdM client","configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users","#configuring-automount-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users",{"title":1079,"visible":15,"weight":60,"urlFragment":1056,"anchor":1080,"singlePageAnchor":1080,"docTitle":19,"url":1081},"32.6. Verifying that an IdM user can access NFS shares on an IdM client","verifying-that-an-idm-user-can-access-nfs-shares-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users","#verifying-that-an-idm-user-can-access-nfs-shares-on-an-idm-client_using-ansible-to-automount-nfs-shares-for-idm-users","#using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management",{"title":1084,"visible":15,"weight":1085,"urlFragment":1086,"anchor":18,"singlePageAnchor":1086,"sections":1087,"docTitle":19,"url":1116},"33. Using Ansible to integrate IdM with NIS domains and netgroups",35,"using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management",[1088,1092,1096,1100,1104,1108,1112],{"title":1089,"visible":15,"weight":16,"urlFragment":1086,"anchor":1090,"singlePageAnchor":1090,"docTitle":19,"url":1091},"33.1. NIS and its benefits","nis-and-its-benefits_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups","#nis-and-its-benefits_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups",{"title":1093,"visible":15,"weight":23,"urlFragment":1086,"anchor":1094,"singlePageAnchor":1094,"docTitle":19,"url":1095},"33.2. NIS in IdM","nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups","#nis-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups",{"title":1097,"visible":15,"weight":28,"urlFragment":1086,"anchor":1098,"singlePageAnchor":1098,"docTitle":19,"url":1099},"33.3. NIS netgroups in IdM","nis-netgroups-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups","#nis-netgroups-in-idm_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups",{"title":1101,"visible":15,"weight":33,"urlFragment":1086,"anchor":1102,"singlePageAnchor":1102,"docTitle":19,"url":1103},"33.4. Using Ansible to ensure that a netgroup is present","using-ansible-to-ensure-that-a-netgroup-is-present_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups","#using-ansible-to-ensure-that-a-netgroup-is-present_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups",{"title":1105,"visible":15,"weight":55,"urlFragment":1086,"anchor":1106,"singlePageAnchor":1106,"docTitle":19,"url":1107},"33.5. Using Ansible to ensure that members are present in a netgroup","using-ansible-to-ensure-that-members-are-present-in-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups","#using-ansible-to-ensure-that-members-are-present-in-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups",{"title":1109,"visible":15,"weight":60,"urlFragment":1086,"anchor":1110,"singlePageAnchor":1110,"docTitle":19,"url":1111},"33.6. Using Ansible to ensure that a member is absent from a netgroup","using-ansible-to-ensure-that-a-member-is-absent-from-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups","#using-ansible-to-ensure-that-a-member-is-absent-from-a-netgroup_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups",{"title":1113,"visible":15,"weight":65,"urlFragment":1086,"anchor":1114,"singlePageAnchor":1114,"docTitle":19,"url":1115},"33.7. Using Ansible to ensure that a netgroup is absent","using-ansible-to-ensure-that-a-netgroup-is-absent_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups","#using-ansible-to-ensure-that-a-netgroup-is-absent_using-ansible-to-integrate-idm-with-nis-domains-and-netgroups","#using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management",{"title":1118,"visible":15,"weight":1119,"urlFragment":1120,"anchor":18,"singlePageAnchor":1120,"docTitle":19,"url":1121},"34. Using Ansible to configure HBAC and sudo rules in IdM",36,"using-ansible-to-configure-hbac-and-sudo-rules-in-idm_using-ansible-to-install-and-manage-identity-management","#using-ansible-to-configure-hbac-and-sudo-rules-in-idm_using-ansible-to-install-and-manage-identity-management",{"title":1123,"visible":15,"weight":1124,"urlFragment":1125,"anchor":18,"singlePageAnchor":1125,"sections":1126,"docTitle":19,"url":1155},"35. Using Ansible to delegate authentication for IdM users to external identity providers",37,"using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management",[1127,1131,1135,1139,1143,1147,1151],{"title":1128,"visible":15,"weight":16,"urlFragment":1125,"anchor":1129,"singlePageAnchor":1129,"docTitle":19,"url":1130},"35.1. The benefits of connecting IdM to an external IdP","con_the-benefits-of-connecting-idm-to-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers","#con_the-benefits-of-connecting-idm-to-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers",{"title":1132,"visible":15,"weight":23,"urlFragment":1125,"anchor":1133,"singlePageAnchor":1133,"docTitle":19,"url":1134},"35.2. How IdM incorporates logins via external IdPs","how-idm-incorporates-logins-via-external-idps_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers","#how-idm-incorporates-logins-via-external-idps_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers",{"title":1136,"visible":15,"weight":28,"urlFragment":1125,"anchor":1137,"singlePageAnchor":1137,"docTitle":19,"url":1138},"35.3. Using Ansible to create a reference to an external identity provider","using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers","#using-ansible-to-create-a-reference-to-an-external-identity-provider_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers",{"title":1140,"visible":15,"weight":33,"urlFragment":1125,"anchor":1141,"singlePageAnchor":1141,"docTitle":19,"url":1142},"35.4. Using Ansible to enable an IdM user to authenticate via an external IdP","using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers","#using-ansible-to-enable-an-idm-user-to-authenticate-via-an-external-idp_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers",{"title":1144,"visible":15,"weight":55,"urlFragment":1125,"anchor":1145,"singlePageAnchor":1145,"docTitle":19,"url":1146},"35.5. Retrieving an IdM ticket-granting ticket as an external IdP user","retrieving-an-idm-ticket-granting-ticket-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers","#retrieving-an-idm-ticket-granting-ticket-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers",{"title":1148,"visible":15,"weight":60,"urlFragment":1125,"anchor":1149,"singlePageAnchor":1149,"docTitle":19,"url":1150},"35.6. Logging in to an IdM client via SSH as an external IdP user","logging-in-to-an-idm-client-via-ssh-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers","#logging-in-to-an-idm-client-via-ssh-as-an-external-idp-user_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers",{"title":1152,"visible":15,"weight":65,"urlFragment":1125,"anchor":1153,"singlePageAnchor":1153,"docTitle":19,"url":1154},"35.7. The provider option in the ipaidp Ansible module","the-provider-option-in-the-ipaidp-ansible-module_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers","#the-provider-option-in-the-ipaidp-ansible-module_using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers","#using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management",{"title":1157,"visible":15,"weight":1158,"urlFragment":1159,"anchor":18,"singlePageAnchor":1159,"sections":1160,"docTitle":19,"url":1165},"36. Joining RHEL systems to an Active Directory by using RHEL system roles",38,"integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management",[1161],{"title":1162,"visible":15,"weight":16,"urlFragment":1159,"anchor":1163,"singlePageAnchor":1163,"docTitle":19,"url":1164},"36.1. Joining RHEL to an Active Directory domain by using the ad_integration RHEL system role","connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles","#connecting-a-rhel-system-directly-to-ad-using-the-ad-integration-system-role_integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles","#integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management",{"title":1167,"visible":15,"weight":1168,"urlFragment":1169,"anchor":18,"singlePageAnchor":1170,"docTitle":19,"url":1171},"Legal Notice",39,"legal-notice","idm140464232589344","#idm140464232589344",[1173,1176,1179],{"text":1174,"link":1175},"Red Hat Enterprise Linux","/documentation/red_hat_enterprise_linux/",{"text":1177,"link":1178},"9","/documentation/red_hat_enterprise_linux/9/",{"text":11},{"name":11,"translations":1181,"productVersion":1182,"singlePage":1183,"pdf":1186,"publishingStatus":1188},[5,6,7,8,9],{"name":1177},{"contentUrl":1184,"name":11,"new":1185,"url":19},"https://d2bhdhkti9t3uj.cloudfront.net/html/bda69e0e-db6b-47fd-863d-11407fc8db56/59368cd762a8eeb298c21dc75c868d50.html","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/html-single/using_ansible_to_install_and_manage_identity_management/index",{"url":1187},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9/pdf/using_ansible_to_install_and_manage_identity_management/Red_Hat_Enterprise_Linux-9-Using_Ansible_to_install_and_manage_Identity_Management-en-US.pdf","PUBLISHED",[1190,1195,1198,1202,1206,1210,1214],{"name":1191,"new":1192,"url":1193,"urlAliases":1194},"10.0-Beta","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/10-beta","10-beta",[],{"name":1177,"new":1196,"url":1177,"urlAliases":1197},"https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/9",[],{"name":1199,"new":1200,"url":1199,"urlAliases":1201},"8","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/8",[],{"name":1203,"new":1204,"url":1203,"urlAliases":1205},"7","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7",[],{"name":1207,"new":1208,"url":1207,"urlAliases":1209},"6","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/6",[],{"name":1211,"new":1212,"url":1211,"urlAliases":1213},"5","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/5",[],{"name":1215,"new":1216,"url":1215,"urlAliases":1217},"4","https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/4",[],{"using_ansible_to_install_and_manage_identity_management/index":1219,"using_ansible_to_install_and_manage_identity_management/proc_providing-feedback-on-red-hat-documentation_using-ansible-to-install-and-manage-identity-management":1220,"using_ansible_to_install_and_manage_identity_management/ansible-terminology_using-ansible-to-install-and-manage-identity-management":1221,"using_ansible_to_install_and_manage_identity_management/installing-an-identity-management-server-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management":1222,"using_ansible_to_install_and_manage_identity_management/installing-an-identity-management-replica-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management":1223,"using_ansible_to_install_and_manage_identity_management/installing-an-identity-management-client-using-an-ansible-playbook_using-ansible-to-install-and-manage-identity-management":1224,"using_ansible_to_install_and_manage_identity_management/preparing-your-environment-for-managing-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1225,"using_ansible_to_install_and_manage_identity_management/configuring-global-idm-settings-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1226,"using_ansible_to_install_and_manage_identity_management/managing-user-accounts-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1227,"using_ansible_to_install_and_manage_identity_management/managing-user-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1228,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-automate-group-membership-in-idm_using-ansible-to-install-and-manage-identity-management":1229,"using_ansible_to_install_and_manage_identity_management/using-ansible-playbooks-to-manage-self-service-rules-in-idm_using-ansible-to-install-and-manage-identity-management":1230,"using_ansible_to_install_and_manage_identity_management/assembly_delegating-permissions-to-user-groups-to-manage-users-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1231,"using_ansible_to_install_and_manage_identity_management/using-ansible-playbooks-to-manage-role-based-access-control-in-idm_using-ansible-to-install-and-manage-identity-management":1232,"using_ansible_to_install_and_manage_identity_management/using-ansible-playbooks-to-manage-rbac-privilegesusing-ansible-to-install-and-manage-identity-management":1233,"using_ansible_to_install_and_manage_identity_management/using-ansible-playbooks-to-manage-rbac-permissions-in-idm_using-ansible-to-install-and-manage-identity-management":1234,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-manage-the-replication-topology-in-idm_using-ansible-to-install-and-manage-identity-management":1235,"using_ansible_to_install_and_manage_identity_management/managing-idm-servers-by-using-ansible_using-ansible-to-install-and-manage-identity-management":1236,"using_ansible_to_install_and_manage_identity_management/managing-hosts-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1237,"using_ansible_to_install_and_manage_identity_management/managing-host-groups-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1238,"using_ansible_to_install_and_manage_identity_management/defining-idm-password-policies_using-ansible-to-install-and-manage-identity-management":1239,"using_ansible_to_install_and_manage_identity_management/granting-sudo-access-to-an-idm-user-on-an-idm-client_using-ansible-to-install-and-manage-identity-management":1240,"using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-of-host-based-access-control-rules-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1241,"using_ansible_to_install_and_manage_identity_management/managing-idm-certificates-using-ansible_using-ansible-to-install-and-manage-identity-management":1242,"using_ansible_to_install_and_manage_identity_management/vaults-in-idm_using-ansible-to-install-and-manage-identity-management":1243,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-manage-idm-user-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management":1244,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-manage-idm-service-vaults-storing-and-retrieving-secrets_using-ansible-to-install-and-manage-identity-management":1245,"using_ansible_to_install_and_manage_identity_management/ensuring-the-presence-and-absence-of-services-in-idm-using-ansible_using-ansible-to-install-and-manage-identity-management":1246,"using_ansible_to_install_and_manage_identity_management/managing-global-dns-configuration-in-idm-using-ansible-playbooks_using-ansible-to-install-and-manage-identity-management":1247,"using_ansible_to_install_and_manage_identity_management/using-ansible-playbooks-to-manage-idm-dns-zones_using-ansible-to-install-and-manage-identity-management":1248,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-manage-dns-locations-in-idm_using-ansible-to-install-and-manage-identity-management":1249,"using_ansible_to_install_and_manage_identity_management/managing-dns-forwarding-in-idm_using-ansible-to-install-and-manage-identity-management":1250,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-manage-dns-records-in-idm_using-ansible-to-install-and-manage-identity-management":1251,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-automount-nfs-shares-for-idm-users_using-ansible-to-install-and-manage-identity-management":1252,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-integrate-idm-with-nis-domains-and-netgroups_using-ansible-to-install-and-manage-identity-management":1253,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-configure-hbac-and-sudo-rules-in-idm_using-ansible-to-install-and-manage-identity-management":1254,"using_ansible_to_install_and_manage_identity_management/using-ansible-to-delegate-authentication-for-idm-users-to-external-identity-providers_using-ansible-to-install-and-manage-identity-management":1255,"using_ansible_to_install_and_manage_identity_management/integrating-rhel-systems-into-ad-directly-with-ansible-using-rhel-system-roles_using-ansible-to-install-and-manage-identity-management":1256,"using_ansible_to_install_and_manage_identity_management/legal-notice":1257},{"prevt":18,"next":24},{"prevt":17,"next":29},{"prevt":24,"next":34},{"prevt":18,"next":34},{"prevt":18,"next":91},{"prevt":18,"next":113},{"prevt":18,"next":147},{"prevt":18,"next":164},{"prevt":18,"next":194},{"prevt":18,"next":224},{"prevt":18,"next":257},{"prevt":18,"next":283},{"prevt":18,"next":309},{"prevt":18,"next":339},{"prevt":18,"next":393},{"prevt":18,"next":423},{"prevt":18,"next":457},{"prevt":18,"next":491},{"prevt":18,"next":529},{"prevt":18,"next":560},{"prevt":18,"next":603},{"prevt":18,"next":650},{"prevt":18,"next":701},{"prevt":18,"next":716},{"prevt":18,"next":738},{"prevt":18,"next":772},{"prevt":18,"next":790},{"prevt":18,"next":820},{"prevt":18,"next":866},{"prevt":18,"next":904},{"prevt":18,"next":930},{"prevt":18,"next":960},{"prevt":18,"next":1022},{"prevt":18,"next":1056},{"prevt":18,"next":1086},{"prevt":1086,"next":1125},{"prevt":18,"next":1125},{"prevt":18,"next":18},{"prevt":1159,"next":18},{"product":18,"version":18},{"using_ansible_to_install_and_manage_identity_management":1260},[1185],{"products":1262},[1263,1264,1265,1266,1267,1268,1269,1270,1271,1272,1273,1274,1275],"builds_for_red_hat_openshift","migration_toolkit_for_virtualization","openshift_container_platform","openshift_sandboxed_containers","red_hat_advanced_cluster_security_for_kubernetes","red_hat_advanced_cluster_management_for_kubernetes","red_hat_openshift_data_foundation","red_hat_openshift_dev_spaces","red_hat_openshift_gitops","red_hat_openshift_local","red_hat_openshift_pipelines","red_hat_openshift_serverless","workload_availability_for_red_hat_openshift",[],{"default":1278},[1279,1288,1294,1303,1311,1319,1326,1334,1341],{"nid":1280,"type":1281,"langcode":1282,"Published":16,"title":1283,"Created":1284,"Updated":1285,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":1286,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":1287},580,"rebrand banner","en","OpenShift Container Storage is now OpenShift Data Foundation starting with version 4.9.","2023-01-11 15:38:32","2023-01-11 15:40:04","/documentation/red_hat_openshift_container_storage\r\n/documentation/red_hat_openshift_container_storage/\r\n/documentation/red_hat_openshift_container_storage/*","internal:/documentation/red_hat_openshift_data_foundation/",{"nid":1289,"type":1281,"langcode":1282,"Published":16,"title":1283,"Created":1290,"Updated":1291,"body_value":18,"field_documentation banner_text_value":18,"field_documentation banner_text_format":18,"field_paths_value":1292,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":1293},581,"2023-01-11 15:41:31","2023-01-11 15:42:04","/documentation/red_hat_openshift_data_foundation/4.9\r\n/documentation/red_hat_openshift_data_foundation/4.9/\r\n/documentation/red_hat_openshift_data_foundation/4.9/*\r\n/documentation/red_hat_openshift_data_foundation/4.10\r\n/documentation/red_hat_openshift_data_foundation/4.10/\r\n/documentation/red_hat_openshift_data_foundation/4.10/*\r\n/documentation/red_hat_openshift_data_foundation/4.11\r\n/documentation/red_hat_openshift_data_foundation/4.11/\r\n/documentation/red_hat_openshift_data_foundation/4.11/*","internal:/documentation/red_hat_openshift_container_storage/",{"nid":1295,"type":1296,"langcode":1282,"Published":16,"title":1297,"Created":1298,"Updated":1299,"body_value":18,"field_documentation banner_text_value":1300,"field_documentation banner_text_format":1301,"field_paths_value":1302,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},582,"developer preview banner","MicroShift is Developer Preview software only","2023-01-11 15:50:24","2023-01-30 19:00:52","\u003Cp slot=header>MicroShift is Developer Preview software only.\u003C/p>For more information about the support scope of Red Hat Developer Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/devpreview/\">Developer Preview Support Scope\u003C/a>.","documentation banner","/documentation/microshift/4.12\r\n/documentation/microshift/4.12/*\r\n/documentation/red_hat_build_of_microshift/4.12\r\n/documentation/red_hat_build_of_microshift/4.12/*",{"nid":1304,"type":1305,"langcode":1282,"Published":16,"title":1306,"Created":1307,"Updated":1308,"body_value":18,"field_documentation banner_text_value":1309,"field_documentation banner_text_format":1301,"field_paths_value":1310,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},583,"obsolete documentation banner","RHACS EOL - DAT-3433","2023-01-23 16:36:43","2023-01-23 16:39:14","\u003Cp slot=header>You are viewing documentation for a release that is no longer maintained. To view the documentation for the most recent version, see the \u003Ca href=\"/documentation/red_hat_advanced_cluster_security_for_kubernetes/\">latest RHACS docs\u003C/a>.\u003C/p>","/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.69/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.70/*\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71\r\n/documentation/red_hat_advanced_cluster_security_for_kubernetes/3.71/*",{"nid":1312,"type":1313,"langcode":1282,"Published":16,"title":1314,"Created":1315,"Updated":1316,"body_value":18,"field_documentation banner_text_value":1317,"field_documentation banner_text_format":1301,"field_paths_value":1318,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},584,"end of life banner","EOL banner for RHV","2023-05-23 14:58:05","2023-05-24 15:19:42","\u003Cp slot=header>The Red Hat Virtualization\u003C/p>Maintenance Phase runs until August 31, 2024, followed by the Extended Life Phase with no more software fixes through August 31, 2026. See \u003Ca href=\"https://access.redhat.com/articles/6975303\">Migration Paths for OpenShift Container Platform deployed on Red Hat Virtualization\u003C/a> for details.","/documentation/red_hat_virtualization/4.4",{"nid":1320,"type":1313,"langcode":1282,"Published":16,"title":1321,"Created":1322,"Updated":1323,"body_value":18,"field_documentation banner_text_value":1324,"field_documentation banner_text_format":1301,"field_paths_value":1325,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},585,"RHHI-V EOL","2023-06-01 16:52:57","2023-06-01 17:03:44","\u003Cp slot=header>Red Hat Hyperconverged Infrastructure for Virtualization\u003C/p> is in the \u003Ca href=\"https://access.redhat.com/support/policy/updates/rhhiv\">Maintenance Support Phase\u003C/a> of its lifecycle until October 31, 2024. After that date, the product will be End of Life. See the \u003Ca href=\"https://access.redhat.com/announcements/6972521\">RHHI-V announcement\u003C/a> for next steps.","/documentation/red_hat_hyperconverged_infrastructure_for_virtualization/1.8",{"nid":1327,"type":1328,"langcode":1282,"Published":16,"title":1329,"Created":1330,"Updated":1331,"body_value":18,"field_documentation banner_text_value":1332,"field_documentation banner_text_format":1301,"field_paths_value":1333,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},586,"preview banner","MicroShift is Technology Preview software only","2024-03-18 16:53:05","2024-03-18 16:54:56","\u003Cp slot=header>MicroShift is Technology Preview software only.\u003C/p>For more information about the support scope of Red Hat Technology Preview software, see \u003Ca href=\"https://access.redhat.com/support/offerings/techpreview/\">Technology Preview Support Scope\u003C/a>.","/documentation/red_hat_build_of_microshift/4.13\r\n/documentation/red_hat_build_of_microshift/4.13/*",{"nid":1335,"type":1328,"langcode":1282,"Published":16,"title":1336,"Created":1337,"Updated":1338,"body_value":18,"field_documentation banner_text_value":1339,"field_documentation banner_text_format":1301,"field_paths_value":1340,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},588,"Ansible 2.5 upgrade limitation","2024-09-30 16:53:05","2024-10-28 16:54:56","\u003Cp slot=\"header\">Support added for upgrades from 2.4\u003C/p>Ansible Automation Platform 2.5-3, released on October 28, 2024, adds support for upgrades from 2.4. See the upgrade documentation for more information.","",{"nid":1342,"alertType":1343,"type":1344,"langcode":1282,"Published":16,"title":1345,"Created":1340,"Updated":1340,"body_value":18,"field_documentation banner_text_value":1346,"field_documentation banner_text_format":1301,"field_paths_value":1347,"field_documentation_training_url_uri":18,"field_title_title_id":18,"field_rebrand banner_link_uri":18},587,"warning","Warning banner","Red Hat build of Apache Camel K","\u003Cp slot=header>Red Hat Camel K is deprecated\u003C/p>Red Hat Camel K is deprecated and the End of Life date for this product is June 30, 2025. For help migrating to the current go-to solution, \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel\">Red Hat build of Apache Camel\u003C/a>, see the \u003Ca target=_blank href=\"https://docs.redhat.com/en/documentation/red_hat_build_of_apache_camel_k/1.10.7/html/migration_guide_camel_k_to_camel_extensions_for_quarkus/index\">Migration Guide\u003C/a>.","/documentation/red_hat_build_of_apache_camel_k/*",{"product":1174},["Reactive",1350],{"$snuxt-i18n-meta":1351,"$sisLoading":1352,"$sisSinglePage":15,"$sisInFocusMode":1352,"$smobileTocOpen":1352,"$sisLargeTOC":1352,"$scurrentChapter":17,"$scurrentSection":17,"$scurrentSubSection":1340},{},false,["Set"],["ShallowReactive",1355],{"s8LoCEfG4A":18,"rFVLKcOK8e":18,"uUstF4AIyn":18,"MdHNSZP4nR":18,"Pn02PlJOas":18},"/en/documentation/red_hat_enterprise_linux/9/html-single/using_ansible_to_install_and_manage_identity_management/index"]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{contentEnv:"",collectFeedback:true,i18n:{baseUrl:"",defaultLocale:"en",defaultDirection:"ltr",strategy:"prefix",lazy:false,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:false,differentDomains:false,trailingSlash:false,configLocales:[{code:"en",name:"English",iso:"en-US"},{code:"fr",name:"Français",iso:"fr-FR"},{code:"ko",name:"한국어",iso:"ko-KR"},{code:"ja",name:"日本語",iso:"ja-JP"},{code:"zh-cn",name:"中文 (中国)",iso:"zh-CN"},{code:"de",name:"Deutsch",iso:"de_DE"},{code:"it",name:"Italiano",iso:"it_IT"},{code:"pt-br",name:"Português",iso:"pt_BR"},{code:"es",name:"Español",iso:"es-ES"}],locales:{en:{domain:""},fr:{domain:""},ko:{domain:""},ja:{domain:""},"zh-cn":{domain:""},de:{domain:""},it:{domain:""},"pt-br":{domain:""},es:{domain:""}},detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",switchLocalePathLinkSSR:false,autoImportTranslationFunctions:false}}},app:{baseURL:"/",buildId:"5ff82c51-785e-4a7d-aca6-77d6692e8c7a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>
